---

title: Deep tissue focal fluorescence imaging with digitally time-reversed ultrasound-encoded light
abstract: A device and method for performing fluorescence imaging with digitally time reversed ultrasound encoded light, using a source of ultrasound waves, a coherent light source, a digital optical phase conjugation (DOPC) device comprising a camera and a spatial light modulator (SLM), a detector of fluorescence, and one or more computers, to obtain an output that at least approximates an interaction between a complete time reversed field, of all of the encoded light's fields, and the scattering medium.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09313423&OS=09313423&RS=09313423
owner: London School of Hygiene & Tropical Medicine
number: 09313423
owner_city: London
owner_country: GB
publication_date: 20130327
---
This application claims priority under 35 U.S.C. 119 e to the following and commonly assigned U.S. patent application 

U.S. Provisional Patent Application Ser. No. 61 616 347 filed on Mar. 27 2012 by Ying Min Wang Benjamin Judkewitz Charles A. DiMarzio and Changhuei Yang entitled DEEP TISSUE FLUORESCENCE IMAGING USING DIGITALLY TIME REVERSED ULTRASOUND ENCODED LIGHT which application is incorporated by reference herein.

This application is related to the following and commonly assigned patent applications which applications are incorporated by reference herein 

U.S. Utility patent application Ser. No. 12 886 320 filed on Sep. 20 2010 by Zahid Yaqoob Emily McDowell and Changhuei Yang entitled OPTICAL PHASE PROCESSING IN A SCATTERING MEDIUM which application is a divisional of U.S. Utility patent application Ser. No. 11 868 394 filed on Oct. 5 2007 by Zahid Yaqoob Emily McDowell and Changhuei Yang entitled TURBIDITY ELIMINATION USING OPTICAL PHASE CONJUGATION AND ITS APPLICATIONS which application claims priority under 35 U.S.C. 119 e to commonly assigned U.S. Provisional Patent Application Ser. No. 60 850 356 filed on Oct. 6 2006 by Zahid Yaqoob Emily McDowell and Changhuei Yang entitled TURBIDITY ELIMINATION USING OPTICAL PHASE CONJUGATION AND ITS APPLICATIONS 

U.S. patent application Ser. No. 12 943 857 filed on Nov. 10 2010 by Changhuei Yang and Meng Cui entitled TURBIDITY SUPPRESSION BY OPTICAL PHASE CONJUGATION USING A SPATIAL LIGHT MODULATOR which application claims the benefit under 35 U.S.C. 119 e of the following and commonly assigned U.S. provisional patent applications which are incorporated by reference herein 

a. Provisional Application Ser. No. 61 259 975 filed on Nov. 10 2009 by Changhuei Yang and Meng Cui entitled APPROACHES FOR BUILDING COMPACT FLUORESCENCE MICROSCOPES 

b. Provisional Application Ser. No. 61 260 316 filed on Nov. 11 2009 by Changhuei Yang and Meng Cui entitled APPLICATIONS OF TURBIDITY SUPPRESSION BY OPTICAL PHASE CONJUGATION 

c. Provisional Patent Application Ser. No. 61 376 202 filed on Aug. 23 2010 by Meng Cui and Changhuei Yang entitled OPTICAL PHASE CONJUGATION 4PI MICROSCOPE and

d. Provisional Application Ser. No. 61 355 328 filed on Jun. 16 2010 by Meng Cui Ying Min Wang and Changhuei Yang entitled ACOUSTIC ASSISTED PHASE CONJUGATE OPTICAL TOMOGRAPHY 

U.S. Utility application Ser. No. 12 943 841 filed on Nov. 10 2010 by Meng Cui Ying Min Wang Changhuei Yang and Charles DiMarzio entitled ACOUSTIC ASSISTED PHASE CONJUGATE OPTICAL TOMOGRAPHY which application claims priority under 35 U.S.C. 119 e to and commonly assigned U.S. Provisional Application Ser. No. 61 355 328 filed on Jun. 16 2010 by Meng Cui Ying Min Wang and Changhuei Yang entitled ACOUSTIC ASSISTED PHASE CONJUGATE OPTICAL TOMOGRAPHY U.S. Provisional Application Ser. No. 61 259 975 filed on Nov. 10 2009 by Changhuei Yang and Meng Cui entitled APPROACHES FOR BUILDING COMPACT FLUORESCENCE MICROSCOPES U.S. Provisional Application Ser. No. 61 260 316 filed on Nov. 11 2009 by Changhuei Yang and Meng Cui entitled APPLICATIONS OF TURBIDITY SUPPRESSION BY OPTICAL PHASE CONJUGATION and U.S. Provisional Patent Application Ser. No. 61 376 202 filed on Aug. 23 2010 by Meng Cui and Changhuei Yang entitled OPTICAL PHASE CONJUGATION 4PI MICROSCOPE and

U.S. Utility application Ser. No. 13 157 194 filed on Jun. 9 2011 by Meng Cui Ying Min Wang and Changhuei Yang entitled ITERATIVE TIME REVERSAL ENHANCED TRANSMISSION SOLVING APPROACH which application claims the benefit under 35 U.S.C. 119 e of Provisional Application Ser. No. 61 355 326 filed on Jun. 16 2010 by Meng Cui Ying Min Wang and Changhuei Yang entitled ITERATIVE TIME REVERSAL ENHANCED TRANSMISSION SOLVING APPROACH .

This invention was made with Government support under W31P4Q 11 1 0008 awarded by DARPA and under OD007307 and EB012255 awarded by the National Institutes of Health. The Government has certain rights in this invention.

 Note This application references a number of different publications as indicated throughout the specification by one or more reference numbers in superscript . A list of these different publications ordered according to these reference numbers can be found below in the section entitled References. Each of these publications is incorporated by reference herein. 

Realizing high resolution fluorescence imaging within scattering biological tissues is a central goal in biomedical imaging. Considerable efforts have been made to extend the imaging depth of optical methods but focal excitation of fluorescence has so far been fundamentally limited to a depth of one transport mean free path or approximately one millimeter in most biological samples. This is because conventional focusing approaches treat scattered light as noise and select for the ballistic light component which exponentially decreases with depth. However scattered light contains important information about the sample which can in fact be utilized. When light passes through scattering samples its wavefront is seemingly randomized but the randomization occurs in a deterministic and time symmetric way. These properties of elastic light scattering have recently been used to focus light through turbid samples by iterative wavefront optimizationand by time reversal using optical phase conjugation. These methods are in many ways analogous to adaptive optics methods used in astronomy to cancel out the effect of atmospheric scattering. However in contrast to astronomy where it is sufficient to image through a turbid medium the atmosphere the goal of biomedical imaging is to image inside.

To achieve focusing inside tissues Xu et. al.proposed a scheme termed time reversal of ultrasound encoded light TRUE which combines optical phase conjugationwith ultrasound encoding. They used focused ultrasound which is much less scattered than light in biological tissues to create a virtual source of light frequency shifted by the acousto optic effect. Scattered light emanating from this source was then time reversed by a photorefractive crystal acting as a phase conjugate mirror. Xu et. al.inferred the formation of a time reversed optical focus from a line scan across millimeter scale absorbers embedded in tissue mimicking phantoms.

While promising improved absorption contrast the use of this technique for high resolution fluorescence imaging in biological tissues remains fundamentally challenging. Because of the low ultrasound modulation efficiency the phase conjugate mirror has to provide orders of magnitude higher than unity gain to excite detectable fluorescence. This requirement cannot be met by traditional phase conjugate mirrors based on photorefractive crystals whose gain is typically much less than one.

Moreover the significant challenge of undesired background illumination due to partial phase conjugation needs to be addressed. With complete time reversal the TRUE focusing technique can be conceptually represented as photons retracing their paths back to the location of the virtual source. However this view disregards the wave nature of light complete time reversal requires full control over phase amplitude and polarization of the entire scattered field over the full solid angle which is fundamentally unfeasible see Section I.1 . As a result even with perfectly aligned optics and noise free recording of the scattered wavefront the time reversed focus is necessarily accompanied by a backgroundwhich would obscure the fluorescence signal originating at the desired optical focus.

One or more embodiments of the present invention present a new strategy to overcome these challenges by combining digital phase conjugationwith dynamic wavefront manipulation. The formation of an optical focus can be directly visualized exciting fluorescence between layers of highly scattering tissue. This provides confirmation of the presence of the accompanying background predicted by theory that can be dynamically reproduced and subtracted. This digital background cancellation procedure along with the high phase conjugate gain and resolution of one or more embodiments of the technique enable the first demonstration of focused fluorescence imaging 2.5 millimeters deep inside biological tissue.

Fluorescence imaging is one of the most important research tools in biomedical sciences. However scattering of light severely impedes imaging of thick biological samples beyond the ballistic regime.

One or more embodiments of the invention directly show focusing and high resolution fluorescence imaging deep inside biological tissues by digitally time reversing ultrasound tagged light with high optical gain 5 10 . We confirm the presence of a time reversed optical focus along with a diffuse background a corollary of partial phase conjugation and develop an approach for dynamic background cancellation.

To illustrate the potential of our method one or more embodiments image complex fluorescent objects and tumor microtissues at an unprecedented depth of 2.5 mm in biological tissues at a lateral resolution of 36 m by 52 m and at an axial resolution of 657 m.

The results set the stage for a range of deep tissue imaging applications in biomedical research and medical diagnostics.

For example one or more embodiments of the present invention include a method for irradiating a scattering medium comprising 

 b collecting a portion of the encoded light comprising one or more encoded fields in a digital optical phase conjugation DOPC device comprising a spatial light modulator connected to a camera 

 c producing in the DOPC device one or more time reversed fields that are phase conjugates of the encoded fields of the portion of the encoded light 

 d irradiating the scattering medium with the time reversed fields wherein the time reversed fields include a desired component that converges back to the one or more regions and a background component due to incomplete time reversal resulting from only the portion of the encoded light being collected 

 e detecting on a detector output radiation based on an interaction between the time reversed fields and the scattering medium e.g. fluorescence to produce a first detected signal 

 f irradiating the scattering medium with one or more background fields that at least approximate the background component 

 g detecting on the detector output radiation based on an interaction between the background fields and the scattering medium e.g. fluorescence to produce a second detected signal and

 d subtracting in a computer the second detected signal from the first detected signal to obtain an output that at least approximates an interaction between a complete time reversed field of all of the encoded light s fields and the scattering medium. The output can be used to image the scattering medium.

The method can further comprise transmitting one or more of the signals from a source of signals and to one or more regions of a scattering medium transmitting input light from a laser and through the one or more regions of the scattering medium concurrently with the signals wherein the signals at least partially modulate the input light into modulated light to form the encoded light as the input light passes through the one or more regions of the scattering medium concurrently with the signals collecting in the DOPC device the portion of the modulated light transmitted out of scattering medium as collected modulated light computing one or more digital phase conjugate fields that are phase conjugates of the collected modulated light s fields irradiating the one or more regions with the time reversed fields comprising the digital phase conjugate fields and modifying the digital phase conjugate fields to produce the background fields.

The method can further comprise measuring a phase map of the collected modulated light wherein the computing comprises digitally phase conjugating the phase map to produce a phase conjugate map and the modifying comprises digital manipulation of the phase conjugate map in a computer.

The method can further comprise splitting light from the laser into the input light and reference light both having a frequency of the light modulating using a modulator the reference light with a signal frequency wherein the signals also have the signal frequency and modulate the input light with the signal frequency to form the modulated light combining the reference light and a portion of the modulated light that has exited the scattering medium such that the reference light and the collected modulated light interfere and form an interference pattern on the camera measuring the phase map of the collected modulated light using the interference pattern and a computer displaying on the SLM s display placed at an image plane of the camera the phase conjugate map irradiating the scattering medium with time reversed light comprising the time reversed fields by guiding the reference light wherein the reference light reflects off the SLM display displaying the phase conjugate map to form the time reversed light modifying the phase conjugate map into a digitally manipulated phase conjugate map by the digital manipulation displaying on the SLM s display placed at an image plane of the camera the digitally manipulated phase conjugate map irradiating the scattering medium with background light comprising the background fields by guiding the reference light wherein the reference light reflects off the SLM display displaying the digitally manipulated phase conjugate map to form the background light and wherein the scattering medium is supported by a holder.

The digital manipulation can comprise digitally shifting the phase conjugate map by a plurality of pixels of the SLM.

The digital manipulation can comprise dividing the phase conjugate map into sub regions and phase shifting every other sub region by a plurality of degrees.

The digital manipulation can comprise compensating for curvature of the SLM and randomly alternating between at least two trigger delays between the light comprising pulsed light and the signals comprising pulsed ultrasound waves to counter a phase drift between a non modulated background comprising the input light passing through the regions and that is not modulated and the reference light wherein the phase drift leads to an added artificial signal on the phase map.

The signals can comprise ultrasound waves generated by an ultrasound transducer and focused such that the one or more regions comprise one or more ultrasound foci of the ultrasound waves.

One or more embodiments of the invention further disclose an apparatus for illuminating imaging or irradiating a scattering medium and method for fabricating the same.

 c a holder for supporting a scattering medium wherein the ultrasound transducer the laser and the holder are connected such that i the ultrasound transducer transmits ultrasound waves to one or more foci in one or more regions of the scattering medium ii the laser transmits input light to the foci in the one or more regions of the scattering medium concurrently with the ultrasound waves and iii the ultrasound waves at least partially frequency shift the input light into modulated light as the input light passes through the foci concurrently with the ultrasound waves 

 d a Digital Optical Phase Conjugation DOPC device comprising a digital programmable spatial light modulator SLM connected to and imaged onto a digital camera wherein 

 f a computer connected to the detector wherein the computer subtracts the second detected signal from the first detected signal to obtain an output that at least approximates an interaction between a complete time reversed field of all of the encoded light s fields and the scattering medium.

In one embodiment the camera comprises an analog digital dynamic range of at least 16 bits the SLM comprises a resolution of at least 1920 by 1080 pixels and an input frame rate of at least 60 Hz the DOPC device outputs output light comprising the time reversed fields with a power having a gain of at least 10as compared to a power of the modulated light collected by the DOPC and a response time of the apparatus is faster than 6.7 seconds or a decorrelation time of the scattering medium wherein the response time is a time between the ultrasound waves at least partially frequency shifting the input light into modulated light and the detector detecting radiation transmitted from the scattering medium in response to the background fields.

In the following description of the preferred embodiment reference is made to the accompanying drawings which form a part hereof and in which is shown by way of illustration a specific embodiment in which the invention may be practiced. It is to be understood that other embodiments may be utilized and structural changes may be made without departing from the scope of the present invention.

Since the technique selectively records and phase conjugates the frequency shifted light the size of the ultrasound modulated volume determines the resolution of the phase conjugated optical focus. illustrates the use a high numerical aperture focused ultrasound with a calculated focal width of 34 m. To further confine the ultrasound modulated volume along the axis of ultrasound propagation both the ultrasound source and the laser are operated in pulsed modesuch that light only enters the sample when the ultrasound pulse has reached the target modulation volume calculated resolution along the axis of ultrasound propagation 54 m .

Inside the sample a fraction of the light was frequency shifted to f fby an ultrasound transducer element size 6.35 mm focal length 6 mm V3330 Olympus NDT USA operated at f 45 MHz. To achieve maximal resolution along the axis of ultrasound propagation the transducer was driven with short pulses pulse length 1 cycle at 45 MHz 55 V peak to peak triggered by the laser Q switch signal at a fixed delay such that the ultrasound pulses coincided with the laser pulses at the ultrasound focus the trigger delay was jittered by 5.5 ns to minimize the detection of coherent effects between ultrasound tagged and untagged light see Section II.3 .

To scan the ultrasound focus the transducer was mounted on a three axis computer controlled micromanipulator Sutter Instruments USA . After passing through the sample the scattered beam was recombined with the reference beam horizontally polarized which had also been frequency shifted by fby an acousto optic modulator AFM 502 A1 IntraAction USA . After passing a horizontally aligned polarizer and another beamsplitter the combined beams reached the surface of a phase only spatial light modulator SLM vis PLUTO Holoeye Germany carefully aligned 1 1 pixel to pixel match to the image plane of a high dynamic range sCMOS camera pco.edge PCO AG Germany . The lens used to image the SLM onto the sCMOS camera was a commercial compound lens Nikon Micro Nikkor 105 mm f 2.8 .

Compared to the digital optical phase conjugation system first described by Cui and Yang one or more embodiments of our improved digital optical phase conjugation DOPC system directly imaged SLM pixels onto CCD pixels and thus enabled reliable alignment and day to day quality assurance see below . Since the image in this embodiment had to be reflected by a beamsplitter we chose a plate beamsplitter High Energy Nd YAG 50 50 Newport Corporation CA whose reflective surface faced both SLM and camera to avoid image aberrations and ensure precise alignment.

With traditional phase conjugate mirrors the power in the phase conjugated beam P is proportional to the power in the signal beam P . This proportionality is referred to as the gain of the phase conjugate mirror 

Because of the low ultrasound modulation efficiency and the small area ratio between ultrasound focus and scattered wavefront the scattered light field reaching the phase conjugate mirror consists mostly of light that is not frequency shifted f and a minute fraction in the setup of 10 10of the total power of frequency shifted ultrasound tagged light f f . Therefore to excite detectable fluorescence at the optical phase conjugate focus a phase conjugate mirror with a gain orders of magnitude larger than unity is required. This is currently not achievable by traditional phase conjugate mirrors even with advanced phase conjugation schemes.

To selectively phase conjugate only the frequency shifted light with high gain the setup of implements an improved digital optical phase conjugation scheme DOPC that consists of a high dynamic range sCMOS camera and a high resolution phase only spatial light modulator SLM . The scattered ultrasound tagged light field interferes with an equally frequency shifted reference beam f f and is imaged onto the sCMOS camera. Using digital phase shifting holography the phase of the frequency shifted wavefront x y with respect to the reference beam is measured. By reflecting off a phase only spatial light modulator displaying a phase conjugate map x y at the image plane of the camera the same reference beam is modulated to become a phase conjugate beam that is sent back into the sample . The phase conjugate beam traverses back through the tissue sample to converge at the location of the ultrasound focus resulting in an optical focus deep inside the tissue sample.

In the DOPC setup of the power in the phase conjugate light that leaves the DOPC setup is only dependent on the power in the reference beam that reflects off the SLM displaying the phase conjugate map thus the DOPC is fundamentally not limited in terms of gain Eq. 1 . One or more embodiments have adjusted the intensity of the reference beam during playback to achieve a gain of 5 10 such that the phase conjugate focus contains sufficient energy to excite fluorescence that can be collected and detected outside of the tissue by a photomultiplier tube PMT .

Theoretically with complete phase conjugation the light field within the ultrasound focus can be reconstructed without error see Section II.1 below . However the assumption of complete phase conjugation breaks down in practice real phase conjugate mirrors whether based on photorefractive crystals or spatial light modulators have finite etendue and can only intercept a fraction of the output wavefront. As a result a background always exists in the case of partial phase conjugation. In a random scattering medium the ratio of the peak intensity of the phase conjugate focus to the average intensity of the accompanying background the peak to background ratio PBR can be analytically derived. Following the framework of Vellekoop et. al. we find that the peak to background ratio is determined by the number of optical modes intercepted and time reversed by the phase conjugate mirror N and the number of input modes in the ultrasound focus M see Section II.2 below . When both phase and amplitude of the scattered field are time reversed a case similar to the use of traditional phase conjugate mirrors the peak to background ratio is 

When only the phase of the scattered field is time reversed a case similar to our technique employing the DOPC the peak to background ratio for large N is 

Since N is finite in a real phase conjugation setup a phase conjugate background is inevitable. In the experimental setup of N is limited by the number of optical modes imaged onto the spatial light modulator and the fact that only the horizontally polarized component is measured and time reversed. The diffuse background that inevitably results can excite fluorophores outside of the focus contributing to noise in the detected fluorescence signal. Because of its spatial extent the total background excitation can drown the desired focal fluorescence signal detected by a single channel PMT outside the sample. Our experiments show that this background though indeed significant can be dynamically subtracted by digital manipulation of the measured phase conjugate map allowing us to realize high resolution focal fluorescence imaging in biological tissues.

As discussed in the above the diffuse background seen in is to be expected because of the lack of complete control of the entire light field in a phase conjugation experiment. We further observed that the diffuse background was concentrated around the focus an effect that was also reported by Vellekoop and colleagues when focusing light through a layer of highly scattering zinc oxide particles. As the number of speckles in the focus increases see Section I.1 the presence of this background drastically reduces the contrast at the focus and poses a critical challenge to optical focusing using time reversal. With the DOPC system however the ability to digitally manipulate the phase conjugate field allows for the possibility of playing back a light field that closely mimics the background thus enabling background subtraction.

Accurate background subtraction requires better understanding of the cause of its spatial localization. One possible explanation of this effect is that it is caused by correlations in the scattering transmission matrix. Thus like the fidelity of the optical phase conjugate focus the presence of a concentrated background would depend on the precise alignment of the sample with the phase conjugated beam. Alternatively the observed background could be caused by the macroscopic concentration of diffuse light around the target area an effect that would be expected to be more prominent in highly forward scattering samples such as biological tissues and that would be invariant to microscopic misalignments of the sample.

Performing time reversal and subtracting the background in this manner for each location of the focus we scanned the position of the ultrasound transducer and confirmed that the optical focus followed the locations of the ultrasound focus as shown in which are successive frames of a movie.

In contrast shows a well resolved image of the bead collected using time reversed light. To obtain the image the ultrasound focus was scanned in the XY plane and an optical focus obtained by phase conjugation was formed at each scan position indicated by the blue dots. Background subtraction by dynamic digital phase map manipulation was performed at every step. Since the bead is smaller than the ultrasound focus the imaged size of the bead effectively estimates the three dimensional resolution of the imaging system. The profiles in each dimension corresponding to the X Y and Z dimensions respectively were fit by Gaussian point spread functions with widths of 36 3 m and 56 5 m full width at half maximum respectively in the plane perpendicular to the axis of light propagation and 657 169 m along the axis of light propagation values 95 confidence of fit .

The deep tissue imaging capability of the system of can be demonstrated by raster scanning a known complex feature.

One or more embodiments of the invention also obtained images of tumor microtissues embedded in tissues. The microtissues are arranged in a 500 m thin patch of polyacrylamide gel embedded between two pieces of chicken tissue each 2.5 mm thick. shows an epifluorescence image of the tumors. The tumors embedded between ex vivo tissue are not resolved with epifluorescence imaging . In contrast the tumors imaged with the method of are well resolved and the differential fluorescence intensities of the tumors are also reflected in the image .

Frozen ex vivo chicken breast tissue was cut into 2.5 mm thick slices and embedded in 10 polyacrylamide gel inside an open top quartz glass sample cuvette with four polished sides Starna Cells CA . The tissue slices had a measured scattering coefficient of 30 mm see also . Using the previously published anisotropyof g 0.965 we calculated the reduced scattering coefficient as 1 g 30 mm 1 0.965 1.05 mm. This is in agreement with the widely referenced approximate value of 1 mm see e.g. .

The fluorescent beads measured in were fabricated as follows. Polyacrylamide gel PAA was polymerized using 4 ml phosphate buffered saline 1.5 ml Acrylamide 0.4 ml Bis acrylamide 62.5 l Ammonium persulfate and 25 l Tetramethylethylenediamine. Polyacrylamide beads containing quantum dots Qtracker 655 Non targeted Quantum Dots Invitrogen were made using a reverse micelle protocol modified from Beningo and Wangwith a starting concentration of 200 nM quantum dots in the aqueous phase. The beads obtained varied in size and were strained through a 40 m cell strainer Biologix USA . The actual sizes of the beads used in all experiments were determined by observation under a fluorescence microscope.

The CIT feature of was made by polymerizing clear PAA 500 m thick on a SU 8 mold designed in house manufactured by the Stanford Microfluidics Foundry . The patterned depression in the clear PAA gel was then filled with PAA containing quantum dots Qtracker 705 Non targeted Quantum Dots Invitrogen with a starting concentration of 1 M in the aqueous phase.

Cancer microtissues obtained by the hanging drop technique using HepG2 cells were custom ordered from InSphero AG Switzerland . The spheroids were fixed with 2 PFA Sigma Aldrich USA washed with 50 mM borate buffer saline Thermo Scientific USA permeabilized with 0.1 Triton X 100 Sigma Aldrich USA and stained with DY 521XL long stokes shift NHS ester dye Dyomics Germany that binds to the proteins in the cancer microtissues. The concentration of the staining solution was 14 nM. Based on calibration with known fluorophore concentrations we estimated the resulting stain concentration in the tumor to be 5 M. The tumor microtissues were arranged and embedded in a 500 m thin PAA gel patch.

The scattering coefficient of the chicken tissue was measured interferometrically with a Mach Zehnder interferometer. Since only ballistic light will significantly interfere with the reference beam the reduction in amplitude of the fringes with and without a sample in the sample beam path can be used to find the scattering coefficient.

The reliability of digital optical phase conjugation critically depends not only on the precise alignment of SLM and camera but also on the SLM curvature and reference beam aberrations. Both of these effects can be compensated for digitally by finding a compensation phase map for the SLM that when displayed time reverses the reference beam. Because a time reversed beam would trace its path back through the spatial filter the SM fiber the compensation map was optimized by maximizing the power of the light that returned back through the single mode fiber measured by a photodiode .

In one or more embodiments at each scan position phase recording was achieved in a phase shifting digital holography setup the ultrasound pulse was cycled through four phases 0 2 2 . 10 30 frames were recorded at 30 frames second for each phase and averaged resulting in four intensity maps I I I and I which were used to reconstruct the complex field according to E I I i I I . The phase map was calculated as tan Re E Im E or Arg E . To minimize artifacts introduced by slow phase fluctuations of the reference beam the acquisition of the intensity maps was interleaved by cycling through all four phases for each block of four sequential frames acquired by the sCMOS camera exposure time 28 ms frame rate 30 Hz . To achieve sufficiently fast cycling and between frame switching an arbitrary function generator AFG 3252 Tektronix USA generated two output signals one 45 MHz sinusoidal cycle with phase shift of 0 or 2 which were each inverted by a RF 180 power splitter Mini circuits USA to obtain the four phase shifted signals. A microcontroller board Arduino Italy obtained from SparkFun Electronics USA connected to an RF switch Mini circuits USA was programmed to select the appropriate phase for each frame acquired by the sCMOS camera. Throughout the phase recording the SLM displayed a flat all 0 phase map. An acquisition cycle took 6.7 s pixel. For complete timing information see .

In abbreviations are Spatial light modulator SLM Ultrasound Transducer in sample beam path UST Acousto optic modulator in reference beam path AOM Photomultiplier PMT Data acquisition device DAQ 2 for sequential camera exposures from frame to frame the phase is cycled between 0 2 and 3 2. Frames corresponding to each respective phase are averaged. The averaged data for each phase shift is used for the calculation of the phase maps. The total duration for acquisition of each data point is 6.7 seconds.

For an analysis the coherence length limits detection of scattered photons see . The Effects of coherence length Only those scattered photons whose path lengths have not spread beyond the laser coherence length in the case of 7 mm will be detected by the phase shifting holography scheme. To confirm that most of the scattered photons fall within this window we ran a single layer Monte Carlo simulation of photon transport where a 0.8 mm wide FWHM collimated gaussian beam was incident on a 5 mm 3 cube of tissue mimicking the two 2.5 mm thick slabs in our experiments s 30 mm g 0.965 . We launched 106 photons in this simulation. a shows a 2D projection of the normalized photon flux. The path length distribution of the photons leaving the exit face is plotted in b . We find that 79 of the scattered photons fall within a 7 mm window thus confirming that the majority of the photons will be detected and time reversed. Scale bar 500 m.

A typical ultrasound tagged phase map recorded on the CCD contained N 8 10modes area of the sensor divided by speckle autocorrelation area . Together with an estimated M of the ultrasound focus of 1 2 10we obtained an upper bound for the peak to background ratio of 60 Eq. 3 .

The time reversed beam was obtained by reflecting the blank reference beam off the spatial light modulator displaying the measured phase conjugate map. The backscattered fluorescence excited by the time reversed optical focus was reflected off a dichroic mirror and detected by a single channel PMT fitted with the appropriate bandpass filters Semrock 650 40 710 40 or 675 67 for Qtracker 655 Qtracker 705 or DY 521XL long stokes shift NHS ester dye respectively .

Because of the dependence of our system on precise alignment mechanical stability and low drift we included a parallel sample beam path to asses and assure the performance of our setup on a day to day basis. Consisting of ground glass diffusers and an additional observing camera it was analogous to the setups previously used by our group to demonstrate turbidity suppression by phase conjugation.

With the sample beam turned on we acquired images of the speckle field on the sCMOS camera at a rate of 1 frame second for 180 seconds. We measured the correlation of the first frame with each subsequent frame and defined the decorrelation time as the time after which the correlation fell below 1 1 e.

We represent the ultrasound modulated speckles in the plane of the Ultrasound US focus A by the electric field E. Upon further propagation through scattering tissue and free space the ultrasound modulated field at the detection plane B is Eq 4.

where Tis the complete transmission matrix with complex transmission values describing the propagation of Efrom the plane containing the US focus A to the detection plane B . In the case of perfect phase conjugation where the full solid angle of the scattered wavefront is intercepted and time reversed Tis unitary lossless and time symmetric. Thus the phase conjugated field back at plane A E is described by Eq 5

recovering the ultrasound modulated field at plane A where denotes complex conjugate and denotes the complex transpose of a matrix . Therefore theoretically the electric field of the speckles in the ultrasound focus can be faithfully reconstructed without error when the scattered field is completely time reversed.

Because of the finite etendue of real phase conjugate mirrors only a fraction of the scattered wavefront intercepted is time reversed. As a result the transmission matrix is no longer unitary. In a random scattering medium the transmission matrix can instead be approximated by a random matrix with elements independently drawn from a circular complex Gaussian distribution with 0 and . Using the framework and methods developed by Vellekoop et. al. we show that a background always exists in the case of partial phase conjugation.

Furthermore the expected ratio of the peak intensity of the phase conjugate focus and its background can be found. We consider two cases phase and amplitude time reversal and phase only time reversal. The former is relevant to the general case of phase conjugation using photorefractive crystals and digital phase conjugate mirrors with phase and amplitude controls the latter is specific for the embodiment our system illustrated in where only the phase of the scattered field is time reversed.

In both cases we describe M input channels speckles in the ultrasound focus at plane A as a vector with elements . We let tbe the complex elements of the transmission matrix mapping each of the M input channels speckles to the N possible output modes intercepted by the finite area phase conjugate mirror at plane B where the output channels are represented by the a vector with elements . We consider first a system with only one non zero input mode corresponding to a single mode source . Without the loss of generality we let this non zero input mode be . Thus we obtain

Assuming the phase conjugate mirror has unit reflectivity and invoking the time symmetric property of the transmission matrix the phase conjugate is

determined by the transmission properties of the turbid medium. In a random scattering medium the ensemble average of can be found by considering the statistics of the circular Gaussian distribution and in so recognizing that a itself follows the Gamma distribution N 2 . We thus obtain 4 1 Eq 9

We will now show that the elements at plane A with zero input will have non zero phase conjugate intensities i.e. 

constituting a phase conjugate background. We let the transmission through channel n at plane B back to any input mode m 1 at plane A be t. Upon playback of the phase conjugate field for the intensity at plane A where m 1 is

It is clear then that there is a non zero average background intensity associated with the phase conjugated speckle and that the ratio of that phase conjugated speckle to its background is 

When there are M non zero inputs this result is scaled by M such that the focal peak to background ratio PBR is

Experimentally N is related to the number of uncorrelated speckles intercepted by the phase conjugate mirror and its upper limit is determined by the number of pixels on the spatial light modulator M is the number of speckles modulated by the ultrasound and thus decreases as the ultrasound focus decreases.

In the case where a phase only phase conjugate mirror is used the phase conjugated electric field and intensity of the input speckle respectively are

and the derivations of PBRfollows exactly that of Vellekoop et. al. for the case of iterative wavefront optimization to multiple targets through scattering medium obtaining for N 1 

The technique illustrated in relies on the detection of 45 MHz ultrasound frequency shifted light in the presence of a large background of non shifted light. While the reference beam equally frequency shifted by 45 MHz interferes with US tagged light interference of the reference beam with the non shifted light occurs at a beating frequency of 45 MHz cycle time 22.2 ns . This beating usually averages out during the much longer integration time of a Complementary Metal Oxide Semiconductor CMOS camera. But if the illumination is pulsed the pulse duration approaches one beating cycle or less and the phase of the beating is locked to the laser trigger output the interference between the non shifted beam and the shifted beam may nevertheless be detected. This wouldn t be desirable in the embodiment of since a small phase drift between the non shifted beam and the reference beam would lead to an added artificial signal on the phase map we measure. To ensure that such coherent effects between the non shifted beam and the frequency shifted beam are not detected on our camera we randomly alternate between two trigger delays of a time difference that corresponds to half a 45 MHz beating cycle 11.1 ns or 5.5 ns . A microcontroller randomly chooses a jitter for each laser sync output pulse at a rate of 20 kHz and the jitter is added to the trigger delay of ultrasound transducer as well as reference beam AOM. The relative phase between ultrasound shifted light and the reference beam therefore remains unaffected.

Block represents providing a holder stage or translation stage for supporting the scattering medium. The holder can comprise a mechanism to hold the scattering medium e.g. biological tissue or cells . The holder can be attached to translation stage for moving the scattering medium relative to the UT laser DOPC etc.

Block represents positioning providing configuring a source of signals such that the source of signals can propagate transmit one or more signals to one or more regions of the scattering medium wherein the signals have a signal frequency. The signal source can comprise an acoustic or ultrasound wave generator e.g. an UT transducer generating ultrasound signals or waves.

The step can further comprise providing one or more ultrasound lenses positioned to focus ultrasound waves from the ultrasound transducer such that the one or more regions comprise one or more ultrasound foci of the ultrasound waves at a depth of at least 2.5 millimeters below a surface of the tissue through which input light see Block enters the tissue.

Block represents positioning providing configuring a coherent light or electromagnetic EM radiation source e.g. laser such that the coherent light source can propagate transmit input light or EM radiation through the one or more regions of the scattering medium concurrently with the signals. The positioning providing configuring can be such that the signals at least partially modulate the input light into modulated light or EM radiation as the input light or EM radiation passes through the one or more regions of the scattering medium concurrently with the signals. The step can comprise positioning a first beam splitter to split light from the coherent light source into the input light and reference light both having the frequency of the light.

Block represents providing positioning a modulator e.g. acousto optic modulator and or signal generator to modulate or frequency shift the reference light with a signal frequency into modulated reference light. The signals produced in Block also have the signal frequency and modulate the input light with the same signal frequency.

Block represents providing fabricating and or positioning a Digital Optical Phase Conjugation DOPC device such that the DOPC device collects at least a portion of the modulated light that has exited the scattering medium as collected modulated light.

The DOPC device can comprise a spatial light modulator SLM connected to and imaged on a digital camera or sensor.

The SLM and the sensor can be connected such that the SLM s pixels are aligned with and directly imaged onto the sensor s pixels such that one SLM pixel is imaged onto one sensor pixel.

The step can comprise positioning one or more second beam splitters wherein one of the second beam splitters is positioned to combine the modulated reference light and a portion of the modulated light that has exited the scattering medium such that the modulated reference light and the collected modulated light interfere and form an interference pattern on the camera.

Block represents providing configuring programming one or more computers e.g. any personal computer such as Dell T and or one or more processors such that the one or more computers processors 

For example illustrates how a computer connected to the DOPC can be configured to measure compute one or more phases of the collected modulated light and compute a phase map of the collected modulated light using the interference pattern using a digital phase shifting holography technique.

Block illustrates sequentially introducing phase shifts differences between the modulated reference beam that is a plane wave and the modulated light that has exited the scattering medium. The phase shifts can include a sequence of 0 2 and 3 2 radian shifts between the modulated reference beam and the modulated light see Section II. 11 phase recording thereby producing four interference patterns sequentially on the camera. In one embodiment a microcontroller board Arduino Italy obtained from SparkFun Electronics USA connected to an RF switch Mini circuits USA was programmed to select the appropriate phase for each frame acquired by the sCMOS camera and an arbitrary function generator AFG 3252 Tektronix USA generated two output signals one 45 MHz sinusoidal cycle with phase shift of 0 or 2 which were each inverted by a RF 180 power splitter Mini circuits USA to obtain the four phase shifted signals. The output signals from the function generator and the RF power splitter can be used to modulate the UT transducer to modulate the input sample light thereby introducing the phase shifts between the input sample light and the reference beam. Alternatively the output signals from the function generator and RF power splitter can be used in conjunction with an acousto optic modulator to modulate the reference light thereby introducing the phase shifts between the input sample light and the reference beam.

The camera is aligned precisely with the SLM such that when the scattered wavefront of the modulated input sample light interfered with the frequency shifted reference beam the camera measures the phase of the scattered wavefront at the plane of the SLM.

Block represents receiving in a computer or processor the interference pattern data for the four phase shifts produced and measured in Block . The computer equates the interferometric data at each pixel position x y on the SLM where I x y is the intensity at pixel x y for zero phase difference I x y is the intensity at pixel x y for phase difference I x y is the intensity at pixel x y for 2 phase difference I x y is the intensity at pixel x y for 3 2 phase difference E x y is the electric field amplitude of the scattered beam comprising the modulated light that has exited the scattering medium E is the electric field amplitude of the reference light and is the phase at the SLM pixel of the scattered beam comprising the modulated light. The electric field Eof the scattered light comprising modulated light and the electric field Eof the reference beam can be described as follows exp exp 

Block represents calculating the e.g. complex electric field of the modulated light at the position of the SLM pixels. The complex electric field is calculated as 

The phase can be calculated as tan Re E Im E . Thus the computer can control the DOPC and phase shifts to measure the phase map phase as a function of pixel position x y on the SLM using a digital phase shifting holography technique.

Block represents using a computer processor receiving the complex electric field to compute a phase conjugate map comprising phase conjugates of the phase map. For example the computer can obtain calculate the complex conjugate E of the complex electric field E obtained in Block and obtain the phase of the complex conjugate electric field using tan Re E Im E thereby obtaining the digital phase conjugate map phase conjugate as a function of pixel position x y on the SLM .

Block represents a computer processor receiving the digital phase conjugate map obtained in Block and modifying the phase conjugates by phase shifting one or more of the phase conjugates by one or more amounts see e.g. section 1.4 . For example the computer can modify the phase conjugate map by digitally manipulating the phase conjugate map to form a digitally manipulated phase conjugate map. The modifying can produce the background field s that approximate the background component.

The laser and the UT transducer can be triggered by a computer to emit light and signals respectively. For example the computer can comprise randomly alternating between at least two trigger delays between the light comprising pulsed light and the signals comprising pulsed ultrasound waves. The alternating see section II.3 can counter a phase drift between a background comprising the input light passing through the regions and that is not modulated and the reference light. The phase drift leads to an undesirable added artificial signal on the phase map.

Block represents providing programming and positioning the DOPC device to sequentially irradiate the one or more regions first with the output time reversed light comprising the time reversed fields comprising desired component that converges to the regions and background component and then with the light comprising background fields only. One of the second beamsplitters can be positioned to guide the modulated reference light wherein the reference light reflects off the SLM s display displaying the phase conjugate map and then the digitally manipulated phase conjugate map to form the output light. Accordingly dependent on careful pixel to pixel alignment between the camera s pixels and the SLM s pixels the SLM can faithfully playback a phase conjugate copy of what is recorded on the camera.

Block represents positioning a detector wherein the detector detects one or more resulting outputs e.g. fluorescence that are based on an interaction between the output light and the one or more regions of the scattering medium. The detector detects radiation transmitted from the scattering medium in response to the time reversed fields to produce a first detected signal and 2 the detector detects radiation transmitted from the scattering medium in response to the background fields to produce a second detected signal.

A computer one of the computers processors in Block or an additional computer can be connected to the detector wherein the computer subtracts the second detected signal from the first detected signal to obtain an output that at least approximates an interaction between a complete time reversed field of all of the encoded light s fields and the scattering medium. The output can have a peak to background ratio of no more than 5.5.

In one example the apparatus comprises a an ultrasound transducer V3330 Olympus NDT b a laser e.g. Navigator SpectraPhysics USA and c a holder for supporting a scattering medium wherein the ultrasound transducer the laser and the holder are connected such that 

The apparatus can further comprise a first beam splitter positioned to split light from the laser into the input light and reference light both having a frequency of the light.

The DOPC device can comprise a digital programmable spatial light modulator SLM e.g. VIS Pluto Holoeye connected to and imaged e.g. using a Nikon Micro Nikkor 105 mm f 2.8 compound lens onto a digital camera e.g. pco.edge wherein 

The apparatus can further comprise a detector e.g. single channel photomultiplier tube connected to the holder wherein the detector detects radiation transmitted from the scattering medium in response to the output light.

In one embodiment the camera comprises an analog digital dynamic range of at least 16 bits the SLM comprises a resolution of at least 1920 by 1080 pixels and an input frame rate of at least 60 Hz and he DOPC device outputs the output light having the time reversed fields with a power having a gain of at least 10 as compared to a power of the modulated light collected by the DOPC.

A response time of the apparatus can be faster than 6.7 seconds or faster than a decorrelation time of the scattering medium wherein the response time is a time between the encoding and the irradiating with the background fields that produces the second detected signals.

In another embodiment the response time is a time between the ultrasound waves at least partially frequency shifting the input light into modulated light and the detector detecting radiation transmitted from the scattering medium in response to the background fields.

The modifying and a focus of the signals can be such that the output light s lateral resolution is at most 36 m by 52 m and the output light s axial resolution is at most 657 m.

Block represents propagating transmitting one or more signals from a source of signals and to one or more regions of the scattering medium wherein the signals have a signal frequency.

For example the scattering medium can be tissue and the regions can be positioned at a depth of at least 2.5 millimeters below a surface of the tissue. One or more of the signals can comprise one or more acoustic or ultrasound waves generated by one or more acoustic wave sources e.g. UT transducer . The ultrasound waves can be focused such that the one or more regions comprise one or more ultrasound foci of the ultrasound waves.

Block represents propagating transmitting input light from a coherent light source laser and through the one or more regions of the scattering medium concurrently with the signals wherein the signals at least partially modulate the input light into modulated light as the input light passes through the one or more regions of the scattering medium concurrently with the signals. The step can comprise splitting light from a laser and using a beamsplitter into the input light and reference light both having the frequency of the light.

Block represents modulating in a modulator the reference light with the signal frequency to form modulated reference light i.e. wherein the signals modulate the input light with the same signal frequency .

Block represents collecting in a digital optical phase conjugation DOPC device at least a portion of the encoded modulated light that has exited the scattering medium as collected modulated light. The step can comprise combining the modulated reference light and a portion of the modulated light that has exited the scattering medium such that the reference light and the collected modulated light interfere and form an interference pattern on a camera in the DOPC.

Block represents measuring a phase map or phases of the collected modulated light. The step can comprise measuring the phase map or phases of the collected modulated light using the interference pattern and a computer e.g. using digital phase shifting holography .

Block represents producing digitally computing or obtaining time reversed phase conjugate fields phases that are phase conjugates of the collected modulated light s fields phases.

The step can comprise at least partially digitally phase conjugating one or more electric fields and or wavefronts E W and or phases of the collected modulated light to form one or more digitally phase conjugated wavefronts or electric fields E W . The phase conjugating can comprise shaping or modifying a phase and or amplitude of the collected modulated light to produce one or more wavefronts electric fields that are one or more phase conjugates of one or more wavefronts electric fields of the collected modulated light. In one or more embodiments only the phase is shaped or modified to produce the phase conjugate.

The at least partially digitally phase conjugating can comprise digitally phase conjugating the phase map e.g. in a computer to produce a phase conjugate map.

Block represents irradiating the scattering medium with the time reversed fields wherein the time reversed fields include a desired component that converges back to the one or more regions and a background component due to incomplete time reversal resulting from only the portion of the encoded light being collected. The step can comprise displaying on the SLM s display placed at an image plane of the camera the phase conjugate map and guiding e.g. using a beamsplitter the reference light wherein the reference light reflects off the SLM display displaying the phase conjugate map to form the time reversed light comprising the time reversed fields.

For example the output time reversed light fields can be used to excite fluorescent agents in the one or more regions thereby producing fluorescence.

For example the time reversed light fields can be used to excite fluorescent agents or photosensitizing agents in the one or more regions wherein the excited fluorescent agents or photosensitizing agents induce biochemical reactions in the one or more regions of the scattering medium.

Block represents detecting on a detector output radiation based on an interaction between the time reversed fields and the scattering medium to produce a first detected signal.

Block represents modifying the phase conjugate fields to form modified phase conjugate fields. The modifying can modify the digital phase conjugate fields to produce the background fields that estimate approximate at least approximate or replicate the background component. The modifying can comprise digital manipulation of the phase conjugate map in a computer.

The digital manipulation can comprise digitally shifting the phase conjugate map by a plurality of pixels of the SLM.

The digital manipulation can comprise dividing the phase conjugate map into sub regions and phase shifting every other sub region by a plurality of degrees.

The modifying can phase shifting one or more of the phase conjugate phases by one or more amounts to remove the desired component that converges to the foci.

Block represents irradiating the scattering medium with the one or more background fields that at least approximate the background component. The step can comprise displaying on the SLM s display placed at an image plane of the camera the digitally manipulated phase conjugate map and guiding e.g. using a beamsplitter the reference light wherein the reference light reflects off the SLM display displaying the digitally manipulated phase conjugate map to form the background light comprising the background fields.

Block represents detecting on a detector output radiation based on an interaction between the background fields and the scattering medium to produce a second detected signal.

Block represents subtracting in a computer the second detected signal from the first detected signal to obtain an output that at least approximates an interaction between a complete time reversed field of all of the encoded light s fields and the scattering medium.

Accordingly the irradiating with the time reversed fields background fields can image the scattering medium. For example the detecting and subtracting can be used to construct an image the scattering medium using the fluorescence caused by the irradiation with the time reversed light corrected for adjusted by minus the background. In one or more embodiments the scattering medium can have a scattering coefficient of at least 30 mm.

Accordingly one or more embodiments of can 1 play back irradiate the scattering medium with the phase conjugate field that contains a background due to incomplete time reversal e.g. focus background 2 detect signals excited by this phase conjugate field 3 modify the phase conjugate field to obtain the field that estimates the background field or results in an approximation of the background field 4 irradiate with the modified field produced in 3 4 detect signals excited by the modified field and 5 subtract signal from 4 from signals in 2 to obtain signal from the phase conjugate focus.

In one embodiment the computer operates by the general purpose processor A performing instructions defined by the computer program under control of an operating system . The computer program and or the operating system may be stored in the memory and may interface with the user and or other devices to accept input and commands and based on such input and commands and the instructions defined by the computer program and operating system to provide output and results.

Output results may be presented on the display or provided to another device for presentation or further processing or action. In one embodiment the display comprises a liquid crystal display LCD having a plurality of separately addressable liquid crystals. Alternatively the display may comprise a light emitting diode LED display having clusters of red green and blue diodes driven together to form full color pixels. Each liquid crystal or pixel of the display changes to an opaque or translucent state to form a part of the image on the display in response to the data or information generated by the processor from the application of the instructions of the computer program and or operating system to the input and commands. The image may be provided through a graphical user interface GUI module . Although the GUI module is depicted as a separate module the instructions performing the GUI functions can be resident or distributed in the operating system the computer program or implemented with special purpose memory and processors.

In one or more embodiments the display is integrated with into the computer and comprises a multi touch device having a touch sensing surface e.g. track pod or touch screen with the ability to recognize the presence of two or more points of contact with the surface. Examples of multi touch devices include mobile devices or smartphones e.g. iPhone Nexus S Droid devices etc. tablet computers e.g. iPad HP Touchpad portable handheld game music video player console devices e.g. iPod Touch MP3 players Nintendo 3DS PlayStation Portable etc. touch tables and walls e.g. where an image is projected through acrylic and or glass and the image is then backlit with LEDs .

Some or all of the operations performed by the computer according to the computer program instructions may be implemented in a special purpose processor B. In this embodiment the some or all of the computer program instructions may be implemented via firmware instructions stored in a read only memory ROM a programmable read only memory PROM or flash memory within the special purpose processor B or in memory . The special purpose processor B may also be hardwired through circuit design to perform some or all of the operations to implement the present invention. Further the special purpose processor B may be a hybrid processor which includes dedicated circuitry for performing a subset of functions and other circuits for performing more general functions such as responding to computer program instructions. In one embodiment the special purpose processor B is an application specific integrated circuit ASIC .

The computer may also implement a compiler that allows an application or computer program written in a programming language such as COBOL Pascal C FORTRAN or other language to be translated into processor readable code. Alternatively the compiler may be an interpreter that executes instructions source code directly translates source code into an intermediate representation that is executed or that executes stored precompiled code. Such source code may be written in a variety of programming languages such as Java Perl Basic etc. After completion the application or computer program accesses and manipulates data accepted from I O devices and stored in the memory of the computer using the relationships and logic that were generated using the compiler .

The computer also optionally comprises an external communication device such as a modem satellite link Ethernet card or other device for accepting input from and providing output to other computers .

In one embodiment instructions implementing the operating system the computer program and the compiler are tangibly embodied in a non transient computer readable medium e.g. data storage device which could include one or more fixed or removable data storage devices such as a zip drive floppy disc drive hard drive CD ROM drive tape drive etc. Further the operating system and the computer program are comprised of computer program instructions which when accessed read and executed by the computer cause the computer to perform the steps necessary to implement and or use the present invention or to load the program of instructions into a memory thus creating a special purpose data structure causing the computer to operate as a specially programmed computer executing the method steps described herein. Computer program and or operating instructions may also be tangibly embodied in memory thereby making a computer program product or article of manufacture according to the invention. As such the terms article of manufacture program storage device and computer program product as used herein are intended to encompass a computer program accessible from any computer readable device or media.

Of course those skilled in the art will recognize that any combination of the above components or any number of different components peripherals and other devices may be used with the computer .

For example the processors or may execute algorithm program in the computers of block or as necessary to implement to steps of Blocks . The apparatus can further comprise one or more computer readable storage media encoded with one or more computer program instructions which when accessed by the computers cause the computers to load the program instructions to a memory therein creating a special purpose data structure causing the computers to operate as a specially programmed computer executing the functions of computing the phase map phase conjugating the phase map and digitally manipulating the phase maps and triggering delays.

A network such as the Internet connects clients to server computers . Network may utilize ethernet coaxial cable wireless communications radio frequency RF etc. to connect and provide the communication between clients and servers . Clients may execute a client application or web browser and communicate with server computers executing web servers . Such a web browser is typically a program such as MICROSOFT INTERNET EXPLORER MOZILLA FIREFOX OPERA APPLE SAFARI etc. Further the software executing on clients may be downloaded from server computer to client computers and installed as a plug in or ACTIVEX control of a web browser. Accordingly clients may utilize ACTIVEX components component object model COM or distributed COM DCOM components to provide a user interface on a display of client . The web server is typically a program such as MICROSOFT S INTERNET INFORMATION SERVER .

Web server may host an Active Server Page ASP or Internet Server Application Programming Interface ISAPI application which may be executing scripts. The scripts invoke objects that execute business logic referred to as business objects . The business objects then manipulate data in database through a database management system DBMS . Alternatively database may be part of or connected directly to client instead of communicating obtaining the information from database across network . When a developer encapsulates the business functionality into objects the system may be referred to as a component object model COM system. Accordingly the scripts executing on web server and or application invoke COM objects that implement the business logic. Further server may utilize MICROSOFT S Transaction Server MTS to access required data stored in database via an interface such as ADO Active Data Objects OLE DB Object Linking and Embedding DataBase or ODBC Open DataBase Connectivity .

Generally these components all comprise logic and or data that is embodied in or retrievable from device medium signal or carrier e.g. a data storage device a data communications device a remote computer or device coupled to the computer via a network or via another data communications device etc. Moreover this logic and or data when read executed and or interpreted results in the steps necessary to implement and or use the present invention being performed.

Although the terms user computer client computer and or server computer are referred to herein it is understood that such computers and may be interchangeable and may further include thin client devices with limited or full processing capabilities portable devices such as cell phones notebook computers pocket computers multi touch devices and or any other devices with suitable processing communication and input output capability.

Of course those skilled in the art will recognize that any combination of the above components or any number of different components peripherals and other devices may be used with computers and .

Embodiments of the invention are implemented as a software application on a client or server computer . Further as described above the client or server computer may comprise a thin client device or a portable device that has a multi touch based display.

Focal fluorescence imaging in biological tissues beyond one transport mean free path is one of the most challenging frontiers in biomedical optics. In this study we provide the first demonstration of focal fluorescence imaging in the diffusive regime with time reversal of ultrasound tagged light. We implemented a digital optical phase conjugation DOPC system with high gain to directly observe the time reversed optical focus and the accompanying phase conjugate background. We took advantage of the capabilities of the DOPC to digitally manipulate the phase conjugate map to dynamically estimate and subtract the fluorescence contribution of the phase conjugate background that would otherwise obscure the focal fluorescence signal. Using this technique we characterized the point spread function of the system of as having an anisotropic lateral resolution of 34 m by 52 m and an axial resolution of 657 m. Furthermore we illustrated the capabilities of our method by successfully imaging fluorescent objects 2.5 mm deep in er vivo tissue equivalent to about 75 scattering mean free paths.

As confirmed by our results the imaging resolution perpendicular to the axis of light propagation is determined by the ultrasound focal volume. The system s resolution can therefore be improved by utilizing an ultrasound transducer with a higher central frequency and a higher numerical aperture. However some expected tradeoffs should be noted. Higher frequency ultrasound is more strongly attenuated in biological tissues thus reducing the practical focusing depth of the ultrasound. Additionally a smaller modulation volume would further diminish the population of the frequency shifted light and increase the challenge of detecting a small signal on top of a large background during phase measurement. However these issues can be addressed by the development of faster higher dynamic range cameras and with advanced filtering methods. The point spread function along the axis of light propagation is limited by the angular spread of the focused light cone. Since the angular spread is a function of illumination geometry and tissue scattering the resolution could be improved by using high numerical aperture illumination or counter intuitively by imaging thicker more scattering samples. Finally the resolution along the axis of light propagation could further be improved by taking advantage of multiphoton excitation.

We estimate that at the plane of the time reversed focus less than 1 of the energy is within the focus. This means that 99 of the remaining energy is spread over the diffuse background which if uncorrected can obscure focal fluorescence signal. In inhomogeneous fluorescent samples we showed that dynamic background subtraction effectively uncouples the focal fluorescence signal from that excited by the background. In some applications like photodynamic therapy where the goal is to deliver more light into the focus a further increase in peak to background ratio may be desirable. There are two ways to achieve a higher peak to background ratio. First the number of optical modes N intercepted by the DOPC can be increased by increasing the number of pixels on the SLM. Second the number of optical modes in the ultrasound focus M can be decreased by decreasing the size of the ultrasound focus.

Because our methods are based on optical time reversal it relies on mechanical stability of the sample. The acquisition cycle per pixel should therefore be faster or on the same order of magnitude as the speckle decorrelation of the tissue. This condition is easily met in er vivo experiments our current pixel acquisition time 6.7 s was shorter than the decorrelation time of the sample 41 s . For in vivo applications decorrelation times are typically much faster published values range from millisecond scaleto second scale depending on tissue type and immobilization strategies. For such applications the pixel acquisition time would have to be reduced accordingly. We anticipate that this will ultimately be possible with the use of faster spatial light modulators and the continuing development of faster higher dynamic range cameras. In all our experiments the irradiance of the laser beam at the sample was less than 10 mW mm. The laser power would have to be decreased or the diameter of the beam increased to meet clinical safety standards 2 mW mm . Taken together such improvements would ultimately enable a wide range of in vivo applications including molecular imaging early cancer diagnosis photodynamic therapy and targeted excitation of optogenetic tools in deep tissues.

Further information on one or more embodiments of the invention can be found Wang Y. M. B. Judkewitz et al. 2012 . 3 928.

This concludes the description of the preferred embodiment of the present invention. The foregoing description of one or more embodiments of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form disclosed. Many modifications and variations are possible in light of the above teaching. It is intended that the scope of the invention be limited not by this detailed description but rather by the claims appended hereto.

