---

title: Systems and methods for adaptive blind mode equalization
abstract: A blind mode adaptive equalizer system to recover the in general complex valued data symbols from the signal transmitted over time-varying dispersive wireless channels is disclosed comprising an adaptive communication receiver for the demodulation and detection of digitally modulated signals received over wireless communication channels exhibiting multipath and fading, the receiver comprising an RF front end, an RF to complex baseband converter, a band limiting matched filter, a channel gain normalizer, a blind mode adaptive equalizer with hierarchical structure, an initial data segment recovery circuit, a differential decoder, a complex baseband to data bit mapper, and an error correction code decoder and de-interleaver.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09094253&OS=09094253&RS=09094253
owner: 
number: 09094253
owner_city: 
owner_country: 
publication_date: 20131119
---
This divisional application claims priority from U.S. application Ser. No. 13 434 498 filed Mar. 29 2012 incorporated by reference in its entirety.

Broadband wireless systems are currently in a rapid evolutionary phase in terms of development of various technologies development of various applications deployment of various services and generation of many important standards in the field. The increasing demand on various services justifies the need for the transmission of data on various communication channels at the highest possible data rates. The multipath and fading characteristics of the wireless channels result in various distortions the most important of those being the inter symbol interference ISI especially at relatively high data rates. Adaptive equalizers are employed to mitigate the ISI introduced by the time varying dispersive channels and possibly arising from other sources. In one class of adaptive equalizers a training sequence known to the receiver is transmitted that is used by adaptive equalizer for adjusting the equalizer parameter vector to a value that results in a relatively small residual ISI. After the training sequence the data is transmitted during which period the equalizer continues to adapt to slow channel variations using decision directed method.

Among the various algorithms to adapt the equalizer parameter vector are the recursive least squares RLS algorithm weighted Kaman filter LMS algorithm and the quantized state QS algorithm the last one taught by Kumar et. al. in Adaptive Equalization Via Fast Quantized State Methods IEEE Transactions on Communications Vol. COM 29 No. 10 October 1981. Kumar at. al. teach orthogonalization process to arrive at fast and computationally efficient identification algorithms in State Inverse and Decorrelated State Stochastic Approximation Automatica Vol. 16 May 1980. The training approach however is not desirable in many communication applications such as those involving video conference type of applications that will require a training sequence every time a different speaker talks. Moreover the need for training sequence results in a significant reduction in capacity as for example in GSM standard a very significant part of each frame is used for the equalizer training sequence. Also if during the decision directed mode the equalizer deviates significantly due to burst of noise or interference all the subsequent data will be erroneously received by the receiver until the loss of equalization is detected and the training sequence is retransmitted and so on.

There are many other applications where the equalizers are applied as in antenna beam forming adaptive antenna focusing of the antenna radio astronomy navigation etc. For example Kumar et. al. teach in Method and Apparatus for Reducing Multipath Signal Error Using Deconvolution U.S. Pat. No. 5 918 161 June 1999 an equalizer approach for a very different problem of precise elimination of the multipath error in the range measurement in GPS receiver. In all of the various applications of equalizers and due to various considerations such as the logistics and efficiency of systems it has been of great interest to have the equalizer adapt without the need for a training sequence. Such equalizers are the termed the blind mode equalizers.

Among some of the approaches to blind mode equalization are the Sato s algorithm and Goddard s algorithm that are similar to the LMS and RLS algorithms respectively except that these may not have any training period. Kumar in Convergence of A Decision Directed Adaptive Equalizer Proceedings of the 22nd IEEE Conference on Decision and Control 1983 Vol. 22 teaches a technique wherein an intentional noise with relatively high variance is injected into the decision directed adaptive algorithm with the noise variance reduced as the convergence progressed and shows that the domain of convergence of the blind mode equalizer was considerably increased with the increase in the noise variance at the start of the algorithm. The technique taught by Kumar is analogous to the annealing in the steel process industry and in fact the term simulated annealing was coined after the introduction by Kumar. Lambert et. al. teach the estimation of the channel impulse response from the detected data in Forward Inverse Blind Equalization 1995 Conference Record of the 28th Asilomar Conference on Signals Systems and Computers Vol. 2 1995. Another blind mode equalization method applicable to the case where the modulated data symbols have a constant envelope and known as constant modulus algorithm CMA taught by Goddard in Self recovering Equalization and Carrier Tracking in Two Dimensional Data Communication System IEEE Transactions on Communications vol. 28 No. 11 pp. 1867 1875 November 1980 is based on minimization of the difference between the magnitude square of the estimate of the estimate of the data symbol and a constant that may be selected to be 1.

The prior blind mode equalizers have a relatively long convergence period and are not universally applicable in terms of the channels to be equalized and in some cases methods such as the one based on polyspectra analysis are computationally very expensive. The CMA method is limited to only constant envelope modulation schemes such as M phase shift keying MPSK and thus are not applicable to modulation schemes such as M quadrature amplitude modulation MQAM and M amplitude shift keying MASK modulation that are extensively used in wireless communication systems due to their desirable characteristics. Tsuie et. al. in Selective Slicing Equalizer Pub. No. US 2008 0260017 A1 Oct. 23 2008 taught a selective slicing equalizer wherein in a decision feedback equalizer configuration the input to the feedback path may be selected either from the combiner output or the output of the slicer depending upon the combiner output.

The prior blind mode equalization techniques may involve local minima to which the algorithm may converge resulting in high residual ISI. Thus it is desirable to have blind mode adaptive equalizers that are robust and not converging to any local minima have wide applicability without for example restriction of constant modulus signals are relatively fast in convergence and are computationally efficient. The equalizers of this invention possess these and various other benefits.

Various embodiments described herein are directed to methods and systems for blind mode adaptive equalizer system to recover the in general complex valued data symbols from a signal transmitted over time varying dispersive wireless channels. For example various embodiments may utilize an architecture comprised of a channel gain normalizer comprised of a channel signal power estimator a channel gain estimator and a parameter estimator for providing nearly constant average power output and for adjusting the dominant tap of the normalized channel to close to 1 a blind mode equalizer with hierarchical structure BMAEHS comprised of a level 1 adaptive system and a level 2 adaptive system for the equalization of the normalized channel output and an initial data recovery for recovery of the data symbols received during the initial convergence period of the BMAEHS and pre appending the recovered symbols to the output of the BMAEHS providing a continuous stream of all the equalized symbols.

The level 1 adaptive system of the BMAEHS is further comprised of an equalizer filter providing the linear estimate of the data symbol the decision device providing the detected data symbol an adaptation block generating the equalizer parameter vector on the basis of a first correction signal generated within the adaptation block and a second correction signal inputted from the level 2 adaptive system. The cascade of the equalizer filter and the decision device is referred to as the equalizer. The first correction vector is based on the error between the input and output of the decision device. However in the blind mode of adaptation the first error may converge to a relatively small value resulting in a false convergence or convergence to one of the local minima that are implicitly present due to the nature of the manner of generation of the first error. To eliminate this possibility the level 2 adaptive system estimates a modeling error incurred by the equalizer. The modeling error is generated by first obtaining an independent estimate of the channel impulse response based on the output of the decision device and the channel output and determining the modeling error as the deviation of the impulse response of the composite system comprised of the equalizer filter and the estimate of the channel impulse response from the ideal impulse comprised of all but one of its elements equal to 0. In case the equalizer tends to converge to a false minimum the magnitude of the modeling error gets large and the level 2 adaptive system generates the second correction signal to keep the modeling error small and thereby avoiding convergence to a false or local minimum.

In the invented architecture the channel gain estimator is to normalize the output of the channel so as to match the level of the normalized signal with the levels of the slicers present in the decision device thereby resulting in increased convergence rate during the initial convergence phase of the algorithm. This is particularly important when the modulated signal contains at least part of the information encoded in the amplitude of the signal as for example is the case with the MQAM and MASK modulation schemes.

In another one of the various architectures of the invention for blind mode adaptive equalizer system the BMAEHS is additionally comprised of an orthogonalizer wherein the two correction signals generated in level 1 and level 2 adaptive systems are first normalized to have an equal mean squared norms and wherein the orthogonalizer provides a composite orthogonalized correction signal vector to the equalizer. The process of orthogonalization results in introducing certain independence among the sequence of correction signal vectors. The orthogonalization may result in fast convergence speeds in blind mode similar to those in the equalizers with training sequence.

In another one of the various architectures of the invention for blind mode adaptive equalizer system the BMAEHS is replaced by a cascade of multiple equalizer stages with multiplicity m greater than 1 and with each equalizer stage selected to be one of the BMAEHS or the simpler blind mode adaptive equalizer BMAE . In the architecture the input to the ith equalizer stage is the linear estimate of data symbol generated by the i 1 th equalizer stage and the detected data symbol from the i 1 th equalizer stage provides the training sequence to the ith equalizer stage during the initial convergence period of the ith equalizer stage for i 2 . . . m. In one of the embodiments of the architecture m 2 with the first equalizer stage selected to be a BMAEHS and the second equalizer stage selected to be a BMAE. In the cascaded architecture the BMAEHS ensures convergence bringing the residual ISI to a relatively small error such that the next equalizer stage may employ a relatively simple LMS algorithm for example. The equivalent length of the cascade equalizer is the sum of the lengths of the m stages and the mean squared error in the estimation of the data symbol depends upon the total length of the equalizer the cascaded architecture has the advantage or reduced computational requirements without a significant loss in convergence speed as the computational requirement may vary more than linearly with the length of the equalizer 

Various architectures of the invention use a linear equalizer or a decision feedback equalizer in the level 1 adaptive system. In one of the various architectures of the invention FFT implementation is used for the generation of the second correction signal resulting in a further significant reduction in the computational requirements.

In various embodiments of the invention an adaptive communication receiver for the demodulation and detection of digitally modulated signals received over wireless communication channels exhibiting multipath and fading is described with the receiver comprised of an RF front end an RF to complex baseband converter a band limiting matched filter a channel gain normalizer a blind mode adaptive equalizer with hierarchical structure an initial data segment recovery circuit a differential decoder a complex baseband to data bit mapper and an error correction code decoder and de interleaver providing the information data at the output of the receiver without the requirements of any training sequence.

The differential decoder in the adaptive receiver performs the function that is inverse to that of the encoder in the transmitter. The differential encoder is for providing protection against phase ambiguity with the number of phase ambiguities equal to the order of rotational symmetry of the signal constellation of the baseband symbols. The phase ambiguities may be introduced due to the blind mode of the equalization. The number of phase ambiguities for the MQAM signal is 4 for any M equal to N2 with N equal to any integer power of 2 for example M 16 or 64. The architecture for the differential encoder is comprised of a phase threshold device for providing the reference phase for the sector to which the baseband symbol belongs a differential phase encoder an adder to modify the output of the differential phase encoder by a difference phase a complex exponential function block and a multiplier to modulate the amplitude of the baseband symbol onto the output of the complex exponential function block and applies to various modulation schemes. The architecture presented for the decoder is similar to that of the differential encoder and is for performing the function that is inverse to that of the encoder.

In various embodiments of the invention an adaptive beam former system is described with the system comprised of an antenna array a bank of RF front ends receiving signals from the antenna array elements and a bank of RF to baseband converters with their outputs inputted to the adaptive digital beam former that is further comprised of an adaptive combiner a combiner gain normalizer a decision device and a multilevel adaptation block for receiving data symbols transmitted form a source in a blind mode without the need for any training sequence and without the restriction of a constant modulus on the transmitted data.

The following description is provided to enable any person skilled in the art to make and use the invention and sets forth the best modes contemplated by the inventor of carrying out his invention. Various modifications however will remain readily apparent to those skilled in the art since the generic principles of the present invention have been defined herein specifically to provide systems and methods for blind mode equalization of signals received over time varying dispersive channels and for recovering the data symbols transmitted from a source in blind mode with adaptive beamformers.

In 2a H denotes the matrix conjugate transpose operation and denotes the complex conjugate operation.

Referring to the noisy channel output signal zis input to the channel gain normalizer block . The channel gain normalizer estimates the average signal power at the output of the discrete time channel and normalizes the noisy channel output signal such that the signal power at the output of the channel gain normalize remains equal to some desired value even in the presence of the time varying impulse response of the discrete time channel as is the case with the fading dispersive channels in digital communication systems. The output of the channel gain normalize is given by

Referring to the output of the channel gain normalize block zis input to the level 1 adaptive system of the blind mode adaptive equalizer with hierarchical structure BMAEHS that provides the detected data symbols aat time k M M 1 . . . with N K Mdenoting the equalizer delay. The level 1 adaptive system is comprised of an equalizer filter with a time varying equalizer parameter vector of length N N N 1 for some positive integers Nand Nwhere Nand Nmay be selected to be equal an adaptation block that adjusts the equalizer parameter vector and the decision device that detects the data symbol from the input signal present at the input of the decision device based on the decision function . In various embodiments of the invention the equalizer filter may be a linear or a decision feedback filter or a more general nonlinear equalizer filter characterized by a time varying parameter vector . In one of the various embodiments of the invention with the decision feedback equalizer the detected symbol ais fed back to the equalizer filter via the delay block that introduces a delay of one sample as shown in . The output of the delay is inputted to the equalizer filter . In one of the various embodiments of the invention with the linear equalizer the equalizer state vector is comprised of the equalizer input zand the various delayed versions of zand is given by 5 

In an alternative embodiment of the invention with the case of the decision feedback equalizer filter the equalizer state vector is also comprised of the various delayed versions of detected symbol a. Referring to the gain normalizer output also referred to as the normalized channel output z is input to the delay that introduces a delay of Ksamples in the input and provides the delayed version zto the model error estimator and the correction signal generator MEECGS block of the level 2 adaptive system . Referring to the detected data symbol at the output of the decision device and the equalizer parameter vector are input to MEECGS block . The MEECGS block estimates the channel impulse response vector from the detected symbol aand the delayed normalized channel output z determines any modeling error made by the level 1 adaptive system and generates the correction signal to mitigate such a modeling error.

In the process of the blind mode equalization by the BMAEHS the estimate of the data symbols aduring the initial period of convergence of the BMAEHS of length Nhas relatively high probability of error. The initial period of convergence Nis the time taken by the BMAEHS to achieve some relatively small mean squared equalizer error measured after the first N 1 samples at the output of the channel gain normalize are inputted to the BMAEHS and may be selected to be about 100 200 samples. The data symbols during the initial convergence period are recovered by the initial data recovery block of .

Referring to the output of the channel gain normalize zis inputted to the quantizer block . The quantizer may quantize the input samples to n 1 bits with ndenoting the number of magnitude bits at the quantizer output so as to minimize the memory requirements for storing the initial segment of the channel gain normalizer output. The number of quantizer bits may be selected on the basis of the signal to noise power ratio expected at the noisy channel output signal so that the variance of the quantization noise is relatively small compared to the variance of the channel noise. The signal to quantization noise power ratio is given approximately by 6 n 1 dB and a value of nequal to 3 may be adequate. In various other embodiments of the invention the quantizer may be eliminated and the channel gain normalizer output zmay be directly inputted to the delay .

Referring to the output of the quantizer zis inputted to the delay that introduces a delay of Nsamples. The output of the delay is inputted to the fixed equalizer . The fixed equalizer is comprised of the cascade of the equalizer filter and the decision device blocks similar to the equalizer filter and the decision device blocks respectively of the BMAEHS . As shown in initially the switch Sis in open position and the fixed equalizer parameter vector remains fixed at 0 . . . 010 . . . 0 until the switch Sis closed. At k K N N N the switch Sis closed and the fixed equalizer parameter vector is set equal to the equalizer parameter vector at the time of closing the switch and remains fixed for k K N. The output of the fixed equalizer a 

M K N is connected to the position 2 of the switch S. Referring to the detected symbol ais input to the delay that introduces a delay of Nsamples. The output of the delay equal to ais connected to the position 3 of the switch S. The position 1 of the switch S is connected to the ground. For k K

Referring to the sequence of baseband symbols bis input to the differential encoder block . The differential encoder block transforms the sequence of baseband symbols binto another complex valued sequence of data symbols awherein the signal constellation of ais same as that of the sequence b. For example for the case of the QPSK modulation with a a ja both aand amay take possible values Aand A. The differential encoder protects the information data against possible phase ambiguity introduced at the receiver. The phase ambiguity may arise for example in the generation of the reference carrier signal not shown using nonlinear processing of the received signal as by the use of a fourth power nonlinearity in the case of QPSK modulation. The phase ambiguity may also occur in the use of the blind mode adaptive equalizer and may have a value of 2 n M with n 0 1 . . . M 1 for the case of MPSK modulation with M 4 for the QPSK modulation. More generally the number of phase ambiguities arising due to the blind mode equalizer may be equal to the number of distinct phase rotations of the signal constellation diagram that leaves the signal constellation diagram invariant.

Referring to the sequence of the data symbols aat the output of the differential encoder is inputted to the band limiting filter . The band limiting filter may be a square root raised cosine filter used to minimize the bandwidth required for the transmission of the modulated RF signal. With the use of the square root raised cosine filter the absolute bandwidth of the filtered signal uat the output of the band limiting filter is reduced to R 1 r 2 where Ris the symbol rate of the data symbols aand r with 0

Referring to the RF signal at the output of the wireless channel is received by the receive antenna providing the received RF signal v t to the input of the RF front end block of receiver . The RF front end block may be comprised of a low noise amplifier LNA RF band pass filter other amplifier stages and possibly conversion from RF to IF and provides the amplified RF signal v t at the output of the RF front end block. The receive antenna and the RF front end block may introduce additive noise including the thermal noise into the signal RF signal in the process of receiving and amplifying the RF signal at the output of the wireless channel. Referring to the amplified RF signal is inputted to the RF to complex baseband converter block that down converts the RF signal to the complex baseband signal . The RF to complex baseband converter block may be comprised of a RF to IF down converter the IF to complex baseband converter and an analog to digital converter. The complex baseband signal vat the output of the RF to complex baseband converter block is inputted to band limiting matched filter block that may be comprised of a band limiting filter that is matched to the band limiting filter used at the transmitter and a down sampler. For the case of square root raised cosine filter used as the band limiting filter at the transmitter the band limiting filter at the receiver is also the same square root raised cosine filter at the transmitter. The design of the band limiting matched filter block and various other preceding blocks both in the transmitter and receiver are well known to those skilled in the art of the field of this invention.

Referring to the output z with denoting some reference positive integer of the band limiting matched filter block is inputted to the blind mode adaptive equalizer system . The blind mode adaptive equalizer system is comprised of the channel gain normalizer the blind mode adaptive equalizer with hierarchical structure BMAEHS and the initial data segment recovery circuit . The details of the blind mode adaptive equalizer system are shown in . The cascade of the various blocks comprised of the band limiting filter complex baseband to RF converter the RF back end and the transmit antenna at the transmitter wireless communication channel and the receive antenna the RF front end RF to complex baseband converter and the band limiting matched filter at the receiver may be modeled by the cascade comprised of an equivalent discrete time channel with input symbols awith denoting some positive reference integer wherein a channel noise nis added to the output of the channel as shown in . The equivalent discrete time channel may have some unknown impulse response that models the combined response of all the blocks in the said cascade.

Referring to the channel gain normalizer estimates the average signal power at the output of the equivalent discrete time channel and normalizes the noisy channel output such that the signal power at the output of the channel gain normalizer remains equal to some desired value even in the presence of the time varying impulse response of the discrete time channel as is the case with the fading dispersive channels in the digital communication system of the . The BMAEHS mitigates the impact of the inter symbol interference that may be caused by the multipath propagation in the wireless channel without requiring any knowledge of the channel impulse response or the need of any training sequence. The detected symbols during the initial convergence time of the BMAEHS may have relatively large distortion. The initial data segment recovery block of reconstructs the detected symbols during the initial convergence time based on the converged parameters of the BMAEHS and pre appends to the detected symbols at the output of the BMAEHS after the initial convergence time thereby mitigating the ISI from the initial data segment as well. The sequence of the final detected data symbols awith Ndenoting the initial convergence time for the BMAEHS and Ma positive integer the output of the blind mode adaptive equalizer system are inputted to the differential decoder block . The differential decoder block performs an inverse operation to that performed in the differential encoder block at the transmitter generating the sequence of the detected baseband symbols bat the output.

In 6 S denotes the order of rotational symmetry of the signal constellation diagram of the baseband signal bequal to the number of distinct phase rotations of the signal constellation diagram that leave the signal constellation unchanged and is equal to the number of phase ambiguities that may be introduced by the blind mode equalizer. In 6 i 0 1 . . . S 1 are the S threshold levels of the phase threshold device .

For illustration shows the signal constellation diagram of the 16 QAM signal that has order of rotational symmetry S equal to 4 with the possible phase ambiguities equal to 0 2 3 2 as the rotation of the signal constellation diagram by any of the four values 0 2 3 2 leaves the signal constellation unchanged. The threshold levels for the 16 QAM signal are given by. 0 2 3 2. The range of the phase given by 

In 8 x denotes the highest integer that is smaller than x for any real x. The use of mod 2 block in is to avoid possible numerical build up of the accumulator output phase by keeping the accumulator output within the range 0 to 2 for all values of time k.

Referring to the phase accumulator output is inputted to the adder that adds the phase providing the output to the adder . Referring to for the case of 16QAM constellation 4 and takes possible values 0 2 3 2. The output of the phase accumulator can also have 0 2 3 2 as the only possible values. The output of the differential phase encoder has 4 3 4 5 4 7 4 as the only possible values.

Referring to the signal is subtracted from the signal by the adder providing the output to the adder that adds 208 to the differential phase encoder output providing the phase of the encoded signal at the output. The phase is inputted to the block providing the output exp j j square root over 1 to the multiplier . Referring to the baseband symbol bis inputted to the absolute value block that provides the absolute value b to the multiplier . The output a b exp j j square root over 1 of the multiplier is the differentially encoded data symbol a. The process of differential encoding leaves the magnitude of the symbol unchanged with a b and with only the symbol phase modified.

As an example of the differential encoding process illustrates the encoding for the 16QAM signal. In the subscript k on various symbols has been dropped for clarity. Referring to the signal point b A j2A j square root over 1 marked by the symbol in is encoded into the signal point a A j2A j square root over 1 marked by the symbol in the figure. Referring to the phase is equal to 4 with the corresponding phase equal to 0. In the illustration of is equal to resulting in phase equal to . Addition of 4 to results in the phase equal to 5 4 that is equal to . Addition of phase equal to tan 3 1 4 0.15 to the phase 5 4 results in 1.4 as shown in . With the magnitude of agiven by a A square root over 10 the encoded data symbol a A square root over 10 exp j1.4 j square root over 1 is obtained as shown in by the symbol . For the case of the PSK signals the phase threshold device D is bypassed with the output equal to the phase and with the phase equal to 0.

Referring to the detected data symbol ais inputted to the absolute value block providing the absolute value a to the multiplier . The output is inputted to the block providing the output exp j j square root over 1 to the multiplier . The multiplier provides the data detected symbol b a exp j j square root over 1 at the multiplier output.

Referring to the detected baseband symbols are input to the complex baseband to data bit mapper that maps the complex baseband symbols into groups of m binary bits each based on the mapping used in the complex baseband modulator block at the transmitter. The sequence of the detected coded data bits at the output of the complex baseband to data bit mapper block is inputted to the error correction code decoder and deinterleaver block that performs inverse operations to those performed in the error correction code encoder and interleaver block at the transmitter and provides the detected information data sequence circumflex over d at the output. In some communication systems the band limiting filter may intentionally introduce some ISI caused by selecting the symbol rate to be higher than the Nyquist rate so as to increase the channel capacity. The blind mode adaptive equalizer system of will also mitigate the ISI arising both due to the intentionally introduced ISI and that arising from the wireless channel.

From 10 the value of is given by 1 1 k 0 1 . . . . The outputs of the accumulators 1 and 2 blocks and are inputted to divider that divides the output of the accumulator by the output of the accumulator providing the average power estimate P at the output of the divider .

Referring to the average power estimate Pis input to the adder that subtracts the estimate of the noise variance 2circumflex over from Presulting in the estimate Pof the signal power at the discrete time channel output. The noise variance estimate may be some a priori estimate of the channel noise variance or may be set equal to 0. The signal power estimate Pis input to the divider that has its other input made equal to the desired signal power P E a with E denoting the expected value operator. The desired signal power may be normalized by an arbitrary positive constant for example by Awith Asimultaneously normalizing the threshold levels in 23 24 of the decision device and the expected value E a in 14 15 . The divider block divides the signal power estimate Pby Pand outputs the result P P P. The divider output Prepresenting the discrete time channel power gain is input to the square root block that provides the channel gain G square root over P at the output of the square root block. The channel gain Gis made available to the multiplier . The initial convergence rate of the BMAEHS may be increased by adjusting the channel gain Gby a factor that is derived on the basis of the statistics of the detected symbol aat the output of the BMAEHS. The adjustment factor is derived such that the expected value of the magnitude of the real and imaginary components of a a ja j square root over 1 approach E a and a a a ja respectively with convergence where E denotes the expected value operation. Referring to the detected symbol ais inputted to the absolute value block . where in the operation of the absolute value block for any complex valued argument z is defined by square root over 1 real 11 

For example when both aand atake possible values Aand 3Awith equiprobable distribution then 22 square root over 1 15 

Referring to the output of the divider e E a may measure the deviation of the magnitude of the real and imaginary components of the BMAEHS output from the expected values E a and E a respectively. The magnitude error eis inputted to the multiplier that multiplies eby a relatively small positive number providing the output equal to ethe input of the adder . The output of the adder is inputted to the delay . The output of the delay is inputted to the adder that provides the output according to 1 2 . . . 1 16 

The output of the adder is inputted to the up sampler block that increases the sampling rate by a factor nusing sample hold. The output of the sampler block is inputted to the multiplier that adjusts the channel gain estimate Gby providing the output Gto the divider .

Referring to the noisy channel output zis input to delay block that introduces a delay of Nsamples that is the number of samples required to provide a good initial estimate of Gand may be selected equal to 50. The output of the delay block is input to the divider that normalizes the delay block output by the modified channel gain Gproviding the normalized channel output z k K 0 1 . . . with K N.

The parameter matches the amplitude of the real and imaginary components of the normalized channel output to the threshold levels of the slicers in the decision device thereby also making the probability distribution of the detected data symbols aequal to the probability distribution of the data symbols a. This can also be achieved in an alternative embodiment of the invention by making the dominant center element hof the normalized channel impulse response equal to 1. For the case when both the data symbols and the channel impulse response vector are real valued the parameter may be estimated in terms of the channel dispersion defined as

For the case of weakly dispersive channels wherein d is much smaller compared to 1 may be estimated to be 1. For the case of data symbols having constant amplitude as is the case for example with MPSK modulation the parameter may also be set to 1. In the more general case of the complex valued data symbols with non constant amplitude in alternative embodiments of the invention the parameter may be estimated adaptively so as to make the dominant element of the normalized channel impulse response approach 1. An algorithm that minimizes the difference between the dominant element hand 1 is given by

In various embodiments of the invention the equalizer filter in the equalizer filter block may be a linear a decision feedback or a more general nonlinear equalizer filter based on the equalizer parameter vector that provides the linear estimate of the data symbol on the basis of the normalized channel output z.

The selection of the decision function depends upon the probability distribution of the data symbols a a j a with j square root over 1 and with aand adenoting the real and imaginary components of a. For example for the case of the discrete type of the probability distribution of the data symbols awith both the real and imaginary components aand aof ataking possible values from the finite sets and respectively and where the components aand aare statistically independent as is the case for example for the MQAM modulated signals the decision function may be given by 20 . 20 In 20 the functions and may be the slicer functions. For the specific case when both the sets and are equal to the set 1 3 . . . N 1 Afor some integer N and positive real number A the two slicer functions x and x with x real are identical and are given by 21 . sgn 21 In 21 sgn x is the signum function given by

The decision function described by 20 24 for example applies to the case where ais obtained as a result of MQAM modulation in the digital communication system of with the number of points in the signal constellation M N. For other modulation schemes and different probability distributions of the data symbol other appropriate decision functions may be employed. For the specific case of M 4 corresponding to the QPSK modulation the decision function in 20 reduces to sgn sgn 25 

For the case of MPSK modulation with M 4 the decision device may comprise of a normalizer that normalizes the complex data symbol by its magnitude with the normalized data symbol operated by the decision function in 20 24 .

Referring to the linear estimate is subtracted from aby the adder providing the error signal e a . The error signal eis input to the conjugate block . The output of the conjugate block e is multiplied by a positive scalar in the multiplier . The output of the multiplier is input to the N weight correction multipliers wcm . . . wcmwherein it multiplies the normalized channel output zand its various delayed versions z . . . zgenerating the N components of with the first correction vector given by 26 . 26a 0 1 . . . 26b 

Referring to the second parameter correction vector generated by the MEECGS for LEQ block is multiplied by a positive scalar by the multiplier . The multiplier output is connected to the vector to scalar converter that provides the N components of the vector given by w . . . w . . . wat the output of the vector to scalar converter . The outputs of the wcm . . . wcmmultipliers and the N components of the vector are both input to N adders wca . . . wca. Referring to the equalizer parameter components . . . . . . at the outputs of the N delay elements are input to the wca adders . The wca adders add the equalizer parameter components . . . . . . to the outputs of the wcm . . . wcmmultipliers and subtract the N components of the vector from the results of the addition providing the updated version of the N components of the equalizer parameter vector at the outputs of the N wca adders . The output of the N wca adders are connected to the N delay elements . The outputs of the N delay elements are equal to the equalizer parameter vector components . . . . . . that are inputted to the N conjugate blocks .

Referring to the detected symbol ais inputted to the channel estimator . The normalized channel output zis input to the delay block that introduces a delay of Ksamples providing the delayed version zto the input of the channel estimator . The channel estimator provides the estimate of the channel impulse response vector at the output of the channel estimator. The equalizer parameters . . . . . . are input to the scalar to vector converter that provides the equalizer vector to the correction signal generator for LEQ . The estimate of the channel impulse response vector is input to the correction signal generator that provides the second correction signal vector to the multiplier . The correction signal generator convolves the estimate of the channel impulse response vector with the equalizer parameter vector to obtain the convolved vector . The difference between the vector obtained by convolving the estimate of the channel impulse response vector with the equalizer parameter vector and the ideal impulse response vector

The equalizer parameter update algorithm implemented in may be described by 27a b 27a 0 1 . . . 27b The first correction signal vector may be based on the minimization of the stochastic function a with respect to the parameter vector and is equal to 0.5 times the negative of the gradient of the stochastic function with respect to . In the absence of the second correction signal vector the update algorithm in 27a reduces to the decision directed version of the LMS algorithm.

In various other embodiments of the invention the first correction signal vector may be derived on the basis of the optimization of the objective function in 28 

In various other embodiments of the invention the first correction signal vector may be based on the one of the quantized state algorithms such as the QS1 algorithm given by 31a 0 1 . . . 31b The vector is obtained by replacing both the real and imaginary components of the various components of the vector with the 1 bit quantized versions. The icomponent of is given by 31c . sgn Re sgn Im square root over 1 . . . 0 31c In 31c sgn x for x real is the signum function defined in 22 and Re z and Im z denote the real and imaginary components of z for any complex variable z.

Referring to the output z for any integer k of the channel gain normalizer block in may be expressed as 32a 

In an alternative embodiment of the invention an exponentially data weighted Kaman filter algorithm may be used. The Kaman filter minimizes the conditional error variance in the estimate of the channel impulse response given by E z z . . . z where E denotes the expected value operator. The exponentially data weighted Kaman filter algorithm is given by 37a r 37b 37c The equations 37a 37c may be initialized at k 0 with similar initialization as for the RLS algorithm of 36 . Equations 37a and 37b may be combined into the following equivalent form 37d In equations 37b 37d rr 2 denotes the variance of the noise nin 32a equal to the noise nnormalized by the modified channel gain G.

In another embodiment of the invention one of the class of quantized state algorithms may be used for the estimation of . The quantized state algorithms possess advantages in terms of the computational requirements. For example the quantized state QS1 algorithm is given by 38a 0 1 . . . 38b where in 38 is obtained from by replacing both the real and imaginary components of each component of by their respective signs taking values 1 or 1. Multiplication of by the matrix Pin 38b requires only additions instead of both additions and multiplications thus significantly reducing the computational requirements. Referring to in the blind mode equalizer system the channel input aappearing in the state vector in 34 38 is replaced by the detected symbol a. The state vector in the equations 34 38 is replaced by its estimate given by 39 The resulting modified RLS algorithm is given by 40a 0 1 . . . 40b 

In one of the various preferred embodiments of the invention the modified RLS algorithm 40a 40b is used for the estimation of the channel impulse response . In various alternative embodiments the Kaman filter algorithms in 37 or the quantized state algorithm in 38 with the state vector replaced with the estimate may be used for the estimation of the channel impulse response .

Referring to the M hca adders are inputted with the M components . . . . . . of the channel impulse response vector at the outputs of the M delay elements and with the outputs of the M hcm multipliers . The hca adders add the M channel impulse response vector components . . . to the corresponding M outputs of the hcm . . . hcmmultipliers providing the updated version of the M components of the channel impulse response vector at the outputs of the M hca adders . The outputs of the M hca adders are connected to the inputs of the M delay elements with the outputs of the delay elements connected to the M conjugate blocks . The estimate of the channel impulse response vector may be initialized at k 1 by the vector 0 . . . 010 . . . 0 .

Referring to the detected symbol aand its various delayed versions a . . . aare input to the scalar to vector converter providing the channel state vector a . . . a. . . a at the output of the scalar to vector converter . Referring to the channel state vector is input to the gain update block that provides the gain vector K k to the vector to scalar converter . Referring to the channel state vector and the matrix Pare input to the matrix Pupdate block that evaluates the updated matrix Paccording to equation 36b and provides the updated matrix Pto the delay . The output of the delay equal to Pis inputted to the matrix Pupdate block . The matrix Pupdate block is initialized with input P I where is some positive number and Iis the M M identity matrix. The matrix Pand the channel state vector are input to the matrix multiplier that provides the gain vector K P at the output. The gain vector Kis inputted to the vector to scalar converter .

With the channel impulse response vector h. . . hhh. . . h of length M 2M 1 and w . . . w w w . . . w of length N 2N 1 the composite system comprised of the cascade of the channel and the equalizer has an impulse response of length K N M 1 with K 2K 1 K N M 1 41 The elements of the vector are obtained by the discrete convolution of the sequences h . . . h h h . . . h and w . . . w w w . . . w. For simplicity of notations the sequences are also represented as vectors and respectively with the similar notations for the other sequences. The convolution operation can also be expressed in the following matrix vector form 42 With N Mas is usually the case the K N matrix H in 42 may be written in the following partitioned form

In one of the various embodiments of the BMAEHS equalizer of the invention the second correction signal vector is selected as 0 1 . . . 56 In 56 is given by 44d with hreplaced by its estimate for i M . . . 0 . . . M. In various other embodiments of the invention the second correction signal vector may be obtained from the optimization of the in 52 and given by 0 1 . . . 57 

From the definition of the matrix H in 44 the vector in 51 and 55 can also be obtained by the convolution of the channel impulse response with the equalizer parameter vector . Similarly the pre multiplication by Hin 51 can be evaluated by the convolution of with and discarding 2M 2 elements from the resulting vector of size K M 1 N 2M 2 more specifically M 1 elements are discarded from each end of the resulting vector where is the vector obtained by reversing the order of the elements in i.e. 58 An equivalent form for the update of the equalizer parameter vector is given by 59a Tr 0 1 . . . 59b In 59 the operator Tr denotes the truncation of the vector to length N by deleting M 1 elements from each side of the vector appearing in its argument. In 59b is the vector obtained from . by appending N M zeros to each side of with 0 . . . 0 0 . . . 0 . Similarly the convolution version of the algorithm in 55 is given by Tr 60a 0 1 . . . 60b In various alternative embodiments of the invention second correction signal vector may be generated by 61 as Tr 61a 0 1 . . . 61b In 61a is obtained from 58 after replacing hwith for i M . . . 0 M.

In order to minimize the impact of the equalizer on the input noise variance 2 a term proportional to may be added to the optimization function in 52 with the resulting objective function given by

The convolution operation in the iterative algorithms 59 60 and 65 can be performed equivalently in terms of the discrete Fourier transform DFT or the fast Fourier transform FFT operations. The FFT operation results in a circular convolution hence for proper convolution operation the individual vectors to be convolved are zero padded with an appropriate number of zeros. Also the FFT of can be related to the FFT of if a zero is appended at the beginning of the vector . Therefore a vector of length N M 2 is defined by

The discrete Fourier transform in 70 can be implemented by the fast Fourier transform algorithm resulting in significant reduction in the number of required arithmetic operations. Defining 71 with denoting the component wise multiplication then the inverse discrete Fourier transform IDFT of is given by

i 0 1 . . . K 2 . The IFFT block evaluates the K 3 point IFFT of the K 3 inputs . The last M 2 outputs of the IFFT block are discarded.

Referring to the first N M and the last N M of the remaining N outputs of the IFFT block denoted by . . . . . . are inputted to the respective 2 N M inputs of the scalar to vector converter . The M components of the IFFT block . . . are inputted to the inputs of the M fta adders fta . . . ftathat subtract the complex conjugate of the . . . . . . respectively provided by the conjugate block from the inputs provided by the IFFT block by the adders . The outputs . . . . . . of the vector to scalar converter are provided to the conjugate block . Referring to the outputs of the M fta adders are inputted to the scalar to vector converter that provides the vector

In one of the various alternative embodiments of the invention the equalizer filter in the BMAEHS of may be selected as the decision feedback equalizer DFE filter. In the decision feedback equalizer some of the components of the equalizer state vector are replaced by the detected symbols that are available at the instance of detecting the present symbol a. The equalizer parameter vector update algorithm is given by 80a 80b 0 1 . . . 80c In 80 the dimension N of the equalizer parameter vector is given by N N N 1 with Ndenoting the number of components of the equalizer parameter state vector that are equal to the previous detected symbols. The second correction signal vector in 80a is generated so as to minimize the modeling error in the equalizer and minimizes the norm of the vector that is equal to the difference between the impulse response vector of the cascade of the channel and the equalizer and the vector 0 . . . 010 . . . 0 of appropriate dimension. An expression for the impulse response is obtained by first splitting the equalizer parameter vector as 81a 81b 

For relatively low probability of error in the detection of a a afor most of the times and the impulse response vector of the cascade of the channel and the equalizer may be approximated by

With the application of 84b the second correction signal vector may be written in the equivalent form in 86 .

Referring to the detected symbol ais input to the cascade of Ndelays providing the Ndelayed versions of adenoted by a . . . aat their respective outputs. The Ndelayed versions of aare input to the Nwm multipliers wm . . . wmand are multiplied by complex conjugates of the last Ncomponents of the equalizer parameter vector . . . in the Nwm multipliers generating the respective products at the outputs of the Nwm multipliers. The outputs of the Nwm multipliers are input to the summer that provides the linear estimate of the data symbol at the output. The components z . . . z a . . . aof the state vector are inputted to the wcm multipliers wcm . . . wcmthat multiply the components of by e with the outputs of the multipliers constituting the components of the vector made available to the N wca adders wca . . . wca. Referring to the linear estimate and the detected symbol aare inputted to the adder that provides the error signal e a to the input of the conjugate block . The output of the conjugate block is multiplied by the scalar in the multiplier with the output inputted to the N wcm multipliers wcm . . . wcm.

Referring to the detected symbol ais inputted to the channel estimator . The normalized channel output zis input to the delay block that introduces a delay of Ksamples providing the delayed version zto the input of the channel estimator . The channel estimator provides the estimate of the channel impulse response vector at the output of the channel estimator. The equalizer parameters . . . . . . are input to the scalar to vector converter that provides the equalizer vector to the correction signal generator for DFE block . The estimate of the channel impulse response vector is input to the correction signal generator for DFE block that provides the second correction signal vector to the multiplier . The correction signal generator for DFE estimates the impulse response of the cascade of the channel and the equalizer. The difference between the vector and the ideal impulse response vector

The correction signal generator block generates the second correction signal on the basis of the modeling error vector and is given by 85 86 . The second correction signal is inputted to the adaptation block B for adjusting the equalizer parameter vector at time k 1. The decision feedback equalizer parameter algorithm implemented by the adaptation block B of is described by 80 . Referring to the second correction signal is multiplied by a positive scalar providing the product to the vector to serial converter . The outputs . . . are inputted to the N wca adders . The outputs of the N wca adders constituting the components of the updated equalizer parameter vector are inputted to the N delays . The outputs of the N delays are inputted to the N conjugate blocks .

Referring to the vector is inputted to the vector to scalar converter that provides the components . . . at the output of the vector to scalar converter . The components . . . and the components . . . of the vector are inputted to the adders ga . . . ga. The Ngaadder i 1 2 . . . Nprovides the sum at the adder output. The outputs of the Nga adders are input to the scalar to vector converter that provides the vector at the output. Referring to the vectors and are inputted to the vector concatenator that concatenates the input vectors in to the vector of size K N 1 at the output of the vector concatenator and provides the result to the matrix multiplier . The matrix from the matrix collator block is input to the transpose block that provides the matrix to the input of the matrix multiplier . The matrix multiplier provides the product at the matrix multiplier output and makes the result available to the vector concatenator 2. The vector is inputted to the vector concatenator 2 that concatenates it with the vector providing the concatenated vector to the conjugate block . The output of the conjugate block is equal to the second correction signal according to 86 .

The convergence rate of the equalizer parameter vector update algorithm in 27 to 31 may be significantly increased by the application of the orthogonalization procedure In the orthogonalization procedure the sequence of the correction signal vectors is modified such that in the modified sequence the correction signal vectors at successive time instances k are nearly orthogonal resulting in increased convergence rate. In one of the various embodiments of the invention the BMAEHS block of is modified by an orthogonalizer.

Referring to the orthogonalizer provides the orthogonalized correction signal vector Kat the output of the orthogonalizer evaluated according to equation 87a b 87a 0 1 . . . 87b 

In 87b the matrix Qmay be set equal to Iwith E equal to some positive scalar and Identing the N N identity matrix. In 87b is an exponential data weighting coefficient with 0

Referring to the normalized correction signal vector is input to the matrix multiplier wherein is pre multiplied by the matrix Q. The matrix Qis made available to the matrix multiplier by the output of the delay . The output of the matrix multiplier is input to the matrix multiplier . The normalized correction signal vector is input to the conjugate transpose block that provides the row vector to the input of the matrix multiplier . The matrix multiplier output equal to Q is inputted to the matrix multiplier and to the conjugate transpose block . The matrix multiplier output equal to Q is input to the adder that adds the constant to the input . The output of the adder equal to Q is input to the inverter that makes the result equal to 1 Q available to the input of the matrix multiplier . The matrix multiplier output equal to K Q Q Q constitutes the orthogonalized correction signal vector K. The output of the matrix multiplier and the output of transpose block equal to Qare inputted to the matrix multiplier that provides the matrix product Q Q Q at the output of the matrix multiplier . The outputs of the delay and that of the matrix multiplier are input to the adder that provides the difference between the two inputs at the output of the adder. The output of the adder is normalized by the constant in the multiplier . The output of the multiplier constitutes the updated matrix Qthat is input to the delay . The output of the delay equal to Qis input to the multiplier .

Referring to the normalized channel output zis input to the delay block that introduces a delay of Ksamples providing the delayed version zto the input of the channel estimator . The detected symbol afrom the output of the decision device is made available to the channel estimator . The channel estimator provides the estimate of the channel impulse response vector at the output of the channel estimator and to the input of the correction signal generator . In one of the various embodiments of the invention the equalizer filter in is the linear equalizer filter and the correction signal generator block is the same as the correction signal generator block for LEQ of for the BMAEHS with the linear equalizer. The correction signal generator convolves the estimate of the channel impulse response vector with the equalizer parameter vector to obtain the convolved vector . The difference between the vector obtained by convolving the estimate of the channel impulse response vector with the equalizer parameter vector and the ideal impulse response vector may provide a measure of the modeling error incurred by the equalizer. A large deviation of the convolved response from the ideal impulse response implies a relatively large modeling error. The correction signal generator block generates the second correction signal vector on the basis of the modeling error vector . The second correction signal vector is inputted to the correction signal vectors normalizer block .

In an alternative embodiment of the invention the equalizer filter in is the decision feedback equalizer filter and the correction signal generator block is the same as the correction signal generator block DFE of for the BMAEHS with the decision feedback equalizer. The correction signal generator block evaluates the second correction signal vector and makes it available to the correction signal vectors normalize .

Referring to the orthogonalized correction signal vector Kavailable at the output of the orthogonalizer is inputted to the multiplier that multiplies the vector Kby a positive scalar . The scalar may be selected to be either a constant or may be a function of k. For example may be equal to 1 1 for some positive scalar and with 0

Referring to the second correction signal vector is input the mean square 2 estimator that is comprised of the norm square block the adder the delay the multiplier and the divider . The operation of the mean square 2 estimator is similar to that of the mean square 1 estimator and provides the result qevaluated according to 89c d to the square root block that provides the output square root over q to the divider . The second correction signal vector is input to the divider that normalized the second correction signal vector providing the second normalized correction signal vector square root over q at the output of the divider . 0 1 . . . 89c 1 1 1 1 89d 

Referring to in various embodiments of the invention positive scalars and therein may alternatively be selected according to square root over square root over 90 with pand qevaluated according to 89 . In 90 is some positive scalar.

The equalizer total error variance equal to E a a with E denoting the expected value operator is in general dependent upon the size N of the equalizer parameter vector. Increasing N may result in the reduction of the equalizer total error variance however it requires a higher computational complexity. For the BMAEHS of the invention the dominant term in the number of computations per iteration of the equalizer parameter update algorithm is proportional to N. Thus doubling the size N of the equalizer parameter vector for example results in an increase in the number of computations by factor of four. The BMAEHS reduces the equalizer total error variance to a relatively small value even for a relatively small value of N for example with N in the range of 10 20.

The equalizer total error variance can be further reduced while keeping the total number of computations required per iteration to a minimum by adding a second equalizer in cascade with the BMAEHS. The equalizer total error variance E a a achieved by the BMAEHS after the initial convergence period is relatively small implying the convolution of the channel impulse response vector with the equalizer parameter vector is close to the discrete impulse vector 0 . . . 010 . . . 0 . The linear estimate of the data symbol may be considered to be the output of an unknown equivalent channel with impulse response vector with the input to the equivalent channel equal to a.

Referring to the normalized channel output zis input to the BMAEHS block that provides the detected symbol aat the output. Referring to the detected data symbol aand the linear estimate of the data symbol that is equal to z are inputted to the blind mode adaptive equalizer 2 . Referring to the linear estimate of the data symbol is input to the equalizer filter 2 with the equalizer parameter vector . . . . . . and with the length of the equalizer 2 equal to N N N 1. In one of the various embodiments of the invention the equalizer 2 in the blind mode adaptive equalizer 2 block is a linear equalizer with N N with its block diagram same as that given in . In various other embodiments of the invention the equalizer 2 may be a decision feedback equalizer. The equalizer 2 is initialized with the initial parameter vector estimate 0 . . . 010 . . . 0 . The state vector of equalizer 2 given by z . . . z . . . z is input to the adaptation block 2 of the blind mode adaptive equalizer 2 .

Referring to the block diagram of the adaptation block 2 of the blind mode adaptive equalizer 2 is similar to that of adaptation block given by with the second correction signal vector in the figure possibly set to 0. The parameter update equation for the adaptation block 2 is given by 0 1 . . . 91a 0 . . . 010 . . . 0 92b 

The iteration in 91a is performed by the adaptation block for k 0. However the equalizer 2 parameter vector in the blind mode adaptive equalizer 2 is frozen at the initial condition during the first N iterations of 91a and is updated after the initial N iteration of 91a by the output of switch S3 by closing the switch S after the initial N iteration of 91a at k M N N N where Nand N are the convergence periods of the BMAEHS and the blind mode adaptive equalizer 2 respectively. The convergence period Nis the time taken by the equalizer in the BMAEHS to achieve some relatively small mean square error after the first Nsamples of the normalized channel output is inputted into the equalizer and may be selected to be about 100 200 samples. The convergence period N of the blind mode adaptive equalizer 2 is similarly defined.

Referring to the linear estimate of the data symbol is input to the decision device that provides the second detected data symbol aat the output of the device according to the decision function D that may be given by 20 25 . The detected data symbol ais connected to the input 2 of the switch S. The detected data symbol afrom the BMAEHS is inputted to the delay that provides a delayed version of the detected data symbol ato the position 1 of the switch S. The output of the switch S is connected to the position 1 of the switch S for k M

One of the various embodiments of the invention relates to the problem of adaptive beam former for recovering data symbol transmitted form a source in a blind mode. shows the embodiment of the invention for the problem of adaptive digital beam former. As shown in the Figure a source transmitter inputs an RF signal obtained by the baseband to RF conversion not shown of the source data symbols ato the transmit antenna for transmission. The transmitted RF signal is received by an array of N antennas a . . . n. The outputs of the antennas v t . . . v t are input to the N RF front end blocks a . . . n. The outputs of the N front end blocks V t . . . v t are inputted to the respective N RF to baseband complex converters a . . . n. The complex baseband signals v . . . vare inputted to the adaptive digital beam former that provides the detected source data symbols aat the output. Referring to the complex baseband signals v . . . vare inputted to the N multipliers a . . . n. The N multipliers a . . . n multiply the inputs by the respective weights . . . made available by the multilevel adaptation block . The outputs of the multipliers z . . . zare summed by the adder providing the signal sat the output. The adder output sis inputted to the combiner gain normalizer block providing the linear estimate of the data symbol to the decision device. The block diagram of the combiner gain normalizer block is similar to that of the channel gain normalizer of except that the input zto the block is replaced by the input s. The decision device is similar to that given by the block 11 of .

Referring to the multilevel adaptation block generates the first correction signal vector wto minimize the error between and aby minimizing the function

The second correction signal vector wis derived on the basis of the model error. Referring to the complex baseband signal vector is given by 97 In 97 g g . . . g is a scalar gain times the antenna array direction vector and is the noise vector. From 93 and 97 one obtains 98 Thus ignoring the noise term in 8 the linear estimate of the data symbol will be equal to aif 1 and the difference is the model error. Thus the model error is minimized by the minimization of the function 1 99 The gradient of Iwith respect to is given by

In 101 may be selected to be some a priori estimate of and Pset equal to I for some scalar 0 with I denoting the N N identity matrix. In 101 Kis the Kaman gain matrix Pis the filter error covariance matrix Rdenotes the covariance matrix of the noise vector appearing in 97 and is the exponential data weighting coefficient with 0

For the special case of uncorrelated spatial noise Ris a diagonal matrix with R rI and with rdenoting the variance of each component of . With the matrix Pselected to be a diagonal matrix and Ra diagonal matrix Pfrom 101c is also diagonal for all k 0. With Pdiagonal with P pI for some scalar p 0 equation 101c may be simplified to

The robustness of the adaptive beam former may be further increased by simultaneously maximizing the signal to noise power ratio at the combiner output by maximizing the signal power at the output of the combiner while keeping the norm of the combiner weight vector close to 1. Equivalently the objective function Igiven by 103 is minimized with respect to . 1 103 In 103 is some positive weighting scalar. The gradient of Iin 103 with respect to is given by 1 104 

From 104 a third correction signal vector is given by 1 105 The update algorithm implemented by the multilevel adaptation block is given by 1 1 106a 0 1 . . . 106b with the combiner gain Ginputted by block updated according to 101 and and equal to some small positive scalars to achieve convergence of 106 . The initial estimate in 106a may be some a priori estimate of .

Various modifications and other embodiments of the invention applicable to various problems in Engineering and other fields will be readily apparent to those skilled in the art in the field of invention. For example the architecture of the beam former can also be applied to the problem of diversity combining. In various other possible modifications the level 1 adaptive system of can be modified to include the constant modulus algorithm in those cases where the data symbol have constant modulus to provide additional robustness to the CMA based equalizers. As another example the adaptive digital beam former architecture can be generalized to the case of broadband source wherein the various antenna gains and combiner weights are replaced by digital filters similar to the equalizer filter of . The equalizer architectures of the invention can be readily modified and applied to various fields where an equalizer or combiner architecture is applicable but without the requirements of any training sequences. Examples of such fields include radio astronomy seismology digital audio signal processing and so on.

It is to be understood that the figures and descriptions of the present invention have been simplified to illustrate elements that are relevant for a clear understanding of the present invention while eliminating other elements for purposes of clarity. Those of ordinary skill in the art will recognize that these and other elements may be desirable. However because such elements are well known in the art and because they do not facilitate a better understanding of the present invention a discussion of such elements is not provided herein.

In general it will be apparent to one of ordinary skill in the art that at least some of the embodiments described herein including for example all of the modules of may be implemented in many different embodiments of software firmware and or hardware for example based on Field Programmable Gate Array FPGA chips or implemented in Application Specific Integrated Circuits ASICS . The software and firmware code may be executed by a computer or computing device comprising a processor e.g. a DSP or any other similar processing circuit including for example the computing device described below. The processor may be in communication with memory or another computer readable medium comprising the software code. The software code or specialized control hardware that may be used to implement embodiments is not limiting. For example embodiments described herein may be implemented in computer software using any suitable computer software language type using for example conventional or object oriented techniques. Such software may be stored on any type of suitable computer readable medium or media such as for example a magnetic or optical storage medium. According to various embodiments the software may be firmware stored at an EEPROM and or other non volatile memory associated a DSP or other similar processing circuit. The operation and behavior of the embodiments may be described without specific reference to specific software code or specialized hardware components. The absence of such specific references is feasible because it is clearly understood that artisans of ordinary skill would be able to design software and control hardware to implement the embodiments based on the present description with no more than reasonable effort and without undue experimentation.

In the example of the computing device comprises one or more processor circuits or processing units one or more memory circuits and or storage circuit component s and one or more input output I O circuit devices . Additionally the computing device comprises a bus that allows the various circuit components and devices to communicate with one another. The bus represents one or more of any of several types of bus structures including a memory bus or memory controller a peripheral bus an accelerated graphics port and a processor or local bus using any of a variety of bus architectures. The bus may comprise wired and or wireless buses. The processing unit may be responsible for executing various software programs such as system programs applications programs and or program modules blocks to provide computing and processing operations for the computing device . The processing unit may be responsible for performing various voice and data communications operations for the computing device such as transmitting and receiving voice and data information over one or more wired or wireless communications channels. Although the processing unit of the computing device is shown in the context of a single processor architecture it may be appreciated that the computing device may use any suitable processor architecture and or any suitable number of processors in accordance with the described embodiments. In one embodiment the processing unit may be implemented using a single integrated processor. The processing unit may be implemented as a host central processing unit CPU using any suitable processor circuit or logic device circuit such as a as a general purpose processor. The processing unit also may be implemented as a chip multiprocessor CMP dedicated processor embedded processor media processor input output I O processor co processor microprocessor controller microcontroller application specific integrated circuit ASIC field programmable gate array FPGA programmable logic device PLD or other processing device in accordance with the described embodiments.

As shown the processing unit may be coupled to the memory and or storage component s through the bus . The bus may comprise any suitable interface and or bus architecture for allowing the processing unit to access the memory and or storage component s . Although the memory and or storage component s may be shown as being separate from the processing unit for purposes of illustration it is worthy to note that in various embodiments some portion or the entire memory and or storage component s may be included on the same integrated circuit as the processing unit . Alternatively some portion or the entire memory and or storage component s may be disposed on an integrated circuit or other medium e.g. hard disk drive external to the integrated circuit of the processing unit . In various embodiments the computing device may comprise an expansion slot to support a multimedia and or memory card for example. The memory and or storage component s represent one or more computer readable media. The memory and or storage component s may be implemented using any computer readable media capable of storing data such as volatile or non volatile memory removable or non removable memory erasable or non erasable memory writeable or re writeable memory and so forth. The memory and or storage component s may comprise volatile media e.g. random access memory RAM and or nonvolatile media e.g. read only memory ROM Flash memory optical disks magnetic disks and the like . The memory and or storage component s may comprise fixed media e.g. RAM ROM a fixed hard drive etc. as well as removable media e.g. a Flash memory drive a removable hard drive an optical disk . Examples of computer readable storage media may include without limitation RAM dynamic RAM DRAM Double Data Rate DRAM DDRAM synchronous DRAM SDRAM static RAM SRAM read only memory ROM programmable ROM PROM erasable programmable ROM EPROM electrically erasable programmable ROM EEPROM flash memory e.g. NOR or NAND flash memory content addressable memory CAM polymer memory e.g. ferroelectric polymer memory phase change memory ovonic memory ferroelectric memory silicon oxide nitride oxide silicon SONOS memory magnetic or optical cards or any other type of media suitable for storing information.

The one or more I O devices allow a user to enter commands and information to the computing device and also allow information to be presented to the user and or other components or devices. Examples of input devices include data ports analog to digital converters ADCs digital to analog converters DACs a keyboard a cursor control device e.g. a mouse a microphone a scanner and the like. Examples of output devices include data ports ADC s DAC s a display device e.g. a monitor or projector speakers a printer a network card . The computing device may comprise an alphanumeric keypad coupled to the processing unit . The keypad may comprise for example a QWERTY key layout and an integrated number dial pad. The computing device may comprise a display coupled to the processing unit . The display may comprise any suitable visual interface for displaying content to a user of the computing device . In one embodiment for example the display may be implemented by a liquid crystal display LCD such as a touch sensitive color e.g. 76 bit color thin film transistor TFT LCD screen. The touch sensitive LCD may be used with a stylus and or a handwriting recognizer program.

The processing unit may be arranged to provide processing or computing resources to the computing device . For example the processing unit may be responsible for executing various software programs including system programs such as operating system OS and application programs. System programs generally may assist in the running of the computing device and may be directly responsible for controlling integrating and managing the individual hardware components of the computer system. The OS may be implemented for example as a Microsoft Windows OS Symbian OS Embedix OS Linux OS Binary Run time Environment for Wireless BREW OS JavaOS or other suitable OS in accordance with the described embodiments. The computing device may comprise other system programs such as device drivers programming tools utility programs software libraries application programming interfaces APIs and so forth.

In various embodiments disclosed herein a single component may be replaced by multiple components and multiple components may be replaced by a single component to perform a given function or functions. Except where such substitution would not be operative such substitution is within the intended scope of the embodiments.

