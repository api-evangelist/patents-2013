---

title: System and method for protecting computer resources from unauthorized access using isolated environment
abstract: Disclosed system and methods for protecting computer resources from unauthorized access. The system provides a library of handler functions that control access of applications to protected resources on a computer device. The system associates a security policy with the library to handler functions. The security policy specifies access rules for accessing protected resources by the applications. The system also modifies applications to access the library of handler functions instead of corresponding application program interface (API) functions of the computer device. When a handler function receives an API function call from a modified application, it may determine if the received API function call complies with the access rules. When the API function call complies with the access rules, the handler function performs the API function call from the application to the protected resources. When the API function call violates the access rules, the handler function block that API function call.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09147069&OS=09147069&RS=09147069
owner: AO Kaspersky Lab
number: 09147069
owner_city: Moscow
owner_country: RU
publication_date: 20130927
---
This application claims benefit of priority under 35 U.S.C. 119 a d to a Russian Application No. 2012156432 filed on Dec. 25 2012 which is incorporated by reference herein.

The disclosure relates generally to the field of information security and more specifically to systems and methods for protecting computer resources from unauthorized access by applications placed in an isolated environment.

The number of mobile communication devices is constantly growing and they have penetrated into all areas of human life. The most popular of these are telephones smartphones notebooks tablets and navigation systems. Mobile devices are primarily used for communication and entertainment. In parallel with the development of these devices new wireless communication systems networks and protocols are also being developed. The transmission of data from one device to another and the exchange of information are tasks that even an inexperienced users can perform without difficulty. But the development of new technologies brings not only benefits but also creates problems.

On one hand the development of mobile devices and wireless communication systems simplifies human interaction facilitates exchange of information and erases geographical boundaries. On the other hand new technologies create new security problems. The ease of copying and exchanging of information causes leaks whether deliberate or accidental of confidential personal or business information from organization networks. Therefore information security specialists responsible for administration of information security infrastructure need to extra vigilant in protecting corporate IT systems in order prevent information leaks and various security breaches.

In addition the growth in popularity of mobile platforms such as Android and iOS is attracting the attention of hackers who have various goals from a desire to play jokes or show off to the theft of confidential information for the purpose of extortion and blackmail. As a result of this computer threats such as viruses worms and other types of malware which were previously characteristic of desktop computers are beginning to appear on mobile platforms as well. New threats unique to mobile devices are also appearing such as Trojan horses which after being installed on a mobile device send SMS messages to telephone numbers or use geolocation services to track the movements of the device user.

In light of the foregoing it is becoming apparent that proactive steps must be taken to reduce the risk of information leaks and protect the users of mobile devices and organizations from unauthorized access by cybercriminals. Security measures for both individual users and organizations have migrated from desktop computers to mobile devices and generally have a narrowly focused local nature and are based on possible scenarios leading to the transfer of information from the informational environment of an organization. The three main scenarios are network local and due to the loss of a data storage medium. Different methods have been developed to address these problems. However the current security solutions are ineffective and in certain cases hard to implement across different mobile platforms and devices due to their narrow local focus and lack of a general technical design concept.

Disclosed system method and computer program product for protecting computer resources from leaks and unauthorized access. In one aspect of the invention the system provides a library of handler functions that control access of applications to protected resources on a computer device. The protected resources may include network resources file system operating system and other applications or programs. The system associates a security policy with the library to handler functions. The security policy specifies access rules for accessing protected resources by the applications. The system also modifies applications to access the library of handler functions instead of corresponding application program interface API functions of the computer device. When a handler function receives an API function call from a modified application it may determine if the received API function call complies with the access rules. When the API function call complies with the access rules the handler function performs the API function call from the application to the protected resources. When the API function call violates the access rules the handler function block that API function call.

In another aspect the system may modify the application by replacing one or more classes or methods of the application that perform API function calls to the protected resources with one or more function calls to corresponding handler functions contained in the library. The replacement of classes or methods of the application may include replacing one or more classes or methods contained in an application file having .dex extension.

In another aspect the system may modify the application by placing the application into an isolated environment such as a container.

Yet in another aspect the system may place a plurality of applications into the container and associate the same security policy with all applications in the container.

In another aspect the protected resources may be encrypted and the handler function may be configured to decrypt encrypted data and transmit decrypted data to the application.

The above simplified summary of example aspects serves to provide a basic understanding of the invention. This summary is not an extensive overview of all contemplated aspects and is intended to neither identify key or critical elements of all aspects nor delineate the scope of any or all aspects of the invention. Its sole purpose is to present one or more aspects in a simplified form as a prelude to the more detailed description of the invention that follows. To the accomplishment of the foregoing the one or more aspects of the invention include the features described and particularly pointed out in the claims.

Example aspects of the present invention are described herein in the context of systems methods and computer program products protecting computer resources from unauthorized access. Those of ordinary skill in the art will realize that the following description is illustrative only and is not intended to be in any way limiting. Other aspects will readily suggest themselves to those skilled in the art having the benefit of this disclosure. Reference will now be made in detail to implementations of the example aspects as illustrated in the accompanying drawings. The same reference indicators will be used to the extent possible throughout the drawings and the following description to refer to the same or like items.

Modern solutions in the field of protection of an organization s data on the whole handle the task placed on them but the proposed systems have many components consist of different modules are hard to configure and are poorly interconnected with each other. The present invention makes it possible to create a single system that makes it possible to provide secure exchange of data within an organization in the framework of a unified security concept i.e. to solve all the problems confronting specialists in the field of information security by adopting a single approach rather than solving each problem separately with a narrow focus. In particular the present invention will enable a transmittal of information between mobile communication devices without fear of information leaks or divulging of business or state secrets. The invention will also provide protection against threats emanating from malware.

In order to provide security for the data transmission network of an organization it is necessary to oversee all of the data being transmitted within the organization keep track of devices getting into the organization s network from the outside and keep track of events on devices and the data with which these devices are working. Any given mobile device is generally under the control of a mobile operating system hereafter OS the most popular mobile OS being Google Android Apple iOS Symbian BlackBerryOS WindowsPhone and so on. The applications installed on the devices afford access to the resources of the mobile device and to the communication ports via interfaces that are provided by the operating system. Therefore it is necessary to monitor the installed applications or the portion of applications that are critical to the needs of the security policy. Under this definition come all applications working with critical organizational data where critical data means data requiring protection due to possible loss or damage if it should be deliberately or accidentally divulged altered or lost. It also includes data whose loss may adversely affect the operation of the organization. The security policy is a set of guiding principles rules procedures and practical approaches in the area of information security that govern the management protection and distribution of valuable information. An example of such a policy is presented below 

allowing the application to access the network only through an encrypted channel rerouting of traffic through a special channel 

mandatory user authentication by login and password through company server for using the application and access to data 

limiting access to data depending on location of the device time of day surrounding devices e.g. allow it only in the office within the visibility of a particular WiFi network and only through this network 

forced removal of all corporate data and closure of access to company resources in the event of detection of a virus or receiving an unauthorized access to the system of the device 

forced removal of all corporate data in containers in the event of loss of a device or a person leaving the company.

The resources of a mobile device include those means of the processing system of a device that can be assigned to the process of data processing for a particular time slot. The primary resources of a computer system are the processors areas of RAM memory sets of data and peripheral devices. The interface provided by the operating system to interact with the resources of the device is realized as an API application programming interface function. In this way the application can interact with the network perform operations with files with memory and so on. According to one aspect of the invention one approach for monitoring and controlling access of applications to the critical resources of a mobile device is via modification of the code of the application that call critical API functions of the OS. Here and afterwards by the term critical is meant actions or entities as defined by the security policy.

In one aspect a group of two or more applications may be placed in the same container . Such applications may include applications with similar functionality which may be covered by the same security policy associated with the container

The modification provides control over the critical activity of an application. The modification may be done at the stage of loading the application or the copy of an already installed application may be modified. If a critical action is attempted the application will not be able to perform it since the original class has been replaced by the class described in the library . Therefore the corresponding method will first be called up from the library and a check will be done for compliance of the action being performed with the security policy. If the critical action does not violate the rules specified in the policy the original method will be called up. For example a security policy of the organization prohibits certain applications to send short text messages from a mobile device. The system of the present invention may be used to intercept attempts by applications to send text messages. In this case the following methods i.e. functions will be critical to the operation of the application 

To control access of the application to these methods the application calls to the above listed methods may be modified. After placing the application in the container the critical methods may be replaced in the application. For example the method 

The description of these methods may be found in the library of handler functions where a check is performed to make sure that the requirements of the security policy associated with the given application are fulfilled. Following is an example handler function s for the above method 

This example code function contains description of three handler functions used to replace the original critical methods. Each of the functions checks to make sure the parameters used are permitted. If the requirements of the security policy are fulfilled the original methods are called up. If the arguments do not withstand the check the transmission of the text message will be halted in the given example. It is also possible not only to halt the message but also to send an empty message warn the user close the application and so on.

In one aspect the system of the present invention may be used to provide security during transmission of information within an organization. There are a limited number of applications with which the employees of the corporation work but an employee can also use other applications on his mobile device for personal needs and so it is necessary to divide the applications into at least two groups and determine safety policies for each group. A security policy is established for applications that work even partly with confidential data data constituting a business or state secret such as a ban on sending data in unprotected form a ban on copying on removable media and so on while no such restrictions are placed on the other applications. Examples of protected applications can be the following 

utilities for monitoring and control of business processes of the company financial system control of purchasing assets etc. 

In one aspect the system of the present invention may be used to ensure that a security policy is implemented on mobile devices connected to the corporate network. For example all critical applications may be placed in containers which may have a security policy associated therewith which will ensure that all applications placed in the container comply with the associated security policy which will be a required condition for working with the protected data on the corporate network. In one aspect the applications may be placed in a container on a corporate server and the user may obtain the container of application directly from the server. One example method for creating a container of applications for use one a mobile device is provided next a user of the mobile device sends a request for access to the corporate network from the mobile device such as a request to the system administrators a specially formulated request to the security server and so on on the basis of the request the level of rights and the set of applications needed by the user in order to work are determined and a container is generated containing all necessary applications configured in accordance with an appropriate security policy the security policy may be individually configured for each particular user and may be dynamically updated the container is then copied to the user s device in one aspect the data inside the container may be encrypted and the channels of interaction of the isolated environment with the outside world are also protected access to the container is allowed only by means of authorization.

In one aspect the user can obtain protected applications from outside of the corporate network and place in a container only applications needed for work directly on the user device. To do that in one aspect of the invention the user may obtain a specially designed tool kit from the network which is used to modify user selected application as explained above place the modified applications in to one or more containers and configure appropriate security policies for each container based on for example type or functionality of the applications placed in each container. As explained above the container may also include appropriate library of handler functions that check application calls for compliance with associated security policies and block or allow application calls to critical network resources.

System memory may include a read only memory ROM and random access memory RAM . Memory may be implemented as in DRAM dynamic RAM EPROM EEPROM Flash or other type of memory architecture. ROM stores a basic input output system BIOS containing the basic routines that help to transfer information between the components of computer system such as during start up. RAM stores operating system OS such as Windows XP Professional or other type of operating system that is responsible for management and coordination of processes and allocation and sharing of hardware resources in computer system . Memory also stores applications and programs . Memory also stores various runtime data used by programs .

Computer system may further include hard disk drive s such as SATA HOD and optical disk drive s for reading from or writing to a removable optical disk such as a CD ROM DVD ROM or other optical media. Drives and and their associated computer readable media provide non volatile storage of computer readable instructions data structures applications and program modules subroutines that implement algorithms and methods disclosed herein. Although the exemplary computer system employs magnetic and optical disks it should be appreciated by those skilled in the art that other types of computer readable media that can store data accessible by a computer system such as magnetic cassettes flash memory cards digital video disks RAMs ROMs EPROMs and other types of memory may also be used in alternative aspects of the computer system .

Computer system further includes a plurality of serial ports such as Universal Serial Bus USB for connecting data input device s such as keyboard mouse touch pad and other. Serial ports may be also be used to connect data output device s such as printer scanner and other as well as other peripheral device s such as external data storage devices and the like. System may also include graphics card such as nVidia Geforce GT 240M or other video card for interfacing with a monitor or other video reproduction device. System may also include an audio card for reproducing sound via internal or external speakers . In addition system may include network card s such as Ethernet WiFi GSM Bluetooth or other wired wireless or cellular network interface for connecting computer system to network such as the Internet.

In various aspects the systems and methods described herein may be implemented in hardware software firmware or any combination thereof. If implemented in software the methods may be stored as one or more instructions or code on a non transitory computer readable medium. Computer readable medium includes data storage. By way of example and not limitation such computer readable medium can comprise RAM ROM EEPROM CD ROM Flash memory or other types of electric magnetic or optical storage medium or any other medium that can be used to carry or store desired program code in the form of instructions or data structures and that can be accessed by a processor of a general purpose computer.

In various aspects the systems and methods described in the present disclosure in terms of modules. The term module as used herein means a real world device component or arrangement of components implemented using hardware such as by an application specific integrated circuit ASIC or field programmable gate array FPGA for example or as a combination of hardware and software such as by a microprocessor system and a set of instructions to implement the module s functionality which while being executed transform the microprocessor system into a special purpose device. A module can also be implemented as a combination of the two with certain functions facilitated by hardware alone and other functions facilitated by a combination of hardware and software. In certain implementations at least a portion and in some cases all of a module can be executed on the processor of a general purpose computer such as the one described in greater detail in above . Accordingly each module can be realized in a variety of suitable configurations and should not be limited to any particular implementation exemplified herein.

In the interest of clarity not all of the routine features of the aspects are disclosed herein. It will be appreciated that in the development of any actual implementation of the invention numerous implementation specific decisions must be made in order to achieve the developer s specific goals and that these specific goals will vary for different implementations and different developers. It will be appreciated that such a development effort might be complex and time consuming but would nevertheless be a routine undertaking of engineering for those of ordinary skill in the art having the benefit of this disclosure.

Furthermore it is to be understood that the phraseology or terminology used herein is for the purpose of description and not of restriction such that the terminology or phraseology of the present specification is to be interpreted by the skilled in the art in light of the teachings and guidance presented herein in combination with the knowledge of the skilled in the relevant art s . Moreover it is not intended for any term in the specification or claims to be ascribed an uncommon or special meaning unless explicitly set forth as such.

The various aspects disclosed herein encompass present and future known equivalents to the known components referred to herein by way of illustration. Moreover while aspects and applications have been shown and described it would be apparent to those skilled in the art having the benefit of this disclosure that many more modifications than mentioned above are possible without departing from the inventive concepts disclosed herein.

