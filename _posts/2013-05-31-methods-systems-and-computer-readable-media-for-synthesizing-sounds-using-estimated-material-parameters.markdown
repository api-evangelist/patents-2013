---

title: Methods, systems, and computer readable media for synthesizing sounds using estimated material parameters
abstract: The subject matter described herein includes methods, systems, and computer readable media for synthesizing sounds using estimated material parameters. According to one aspect, a method for sound synthesis using estimated material parameters is provided. The method includes at a computing platform including a memory and a processor, estimating, by the processor and based on a recorded audio sample of an impact on a physical object, one or more material parameters of a physical object for use in synthesizing a sound associated with a virtual object having material properties similar to the physical object. The method further includes storing the one or more material parameters in memory. The method further includes using the estimated material parameters to generate a synthesize sound for the virtual object.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09401684&OS=09401684&RS=09401684
owner: The University of North Carolina at Chapel Hill
number: 09401684
owner_city: Chapel Hill
owner_country: US
publication_date: 20130531
---
This application claims the benefit of U.S. Provisional Patent Application Ser. No. 61 653 827 filed May 31 2012 the disclosure of which is incorporated herein by reference in its entirety.

This invention was made with government support under Grant No. U.S. Pat. No. 0 917 040 awarded by the National Science Foundation and Grant No. W911 NF 06 1 0355 awarded by the Army Research Office. The government has certain rights in the invention.

The subject matter described herein relates to sound synthesis. More particularly the subject matter described herein relates to synthesizing sounds using estimated material parameters.

Linear modal synthesis methods have been used to generate sounds for rigid bodies. One of the key challenges in widely adopting such techniques is the lack of automatic determination of satisfactory material parameters that recreate realistic audio quality of sounding materials. Accordingly there exists a long felt need for methods systems and computer readable media for synthesizing sounds using estimated material parameters.

The subject matter described herein includes methods systems and computer readable media for synthesizing sounds using estimated material parameters. According to one aspect a method for sound synthesis using estimated material parameters is provided. The method includes at a computing platform including a memory and a processor estimating by the processor and based on a recorded audio sample of an impact on a physical object one or more material parameters of a physical object for use in synthesizing a sound associated with a virtual object having material properties similar to the physical object. The method further includes storing the one or more material parameters in memory. The method further includes using the estimated material parameters to generate a synthesize sound for the virtual object.

The subject matter described herein may be implemented in hardware software firmware or any combination thereof. As such the terms function node or module as used herein refer to hardware which may also include software and or firmware components for implementing the feature being described. In one exemplary implementation the subject matter described herein may be implemented using a computer readable medium having stored thereon computer executable instructions that when executed by the processor of a computer control the computer to perform steps. Exemplary computer readable media suitable for implementing the subject matter described herein include non transitory computer readable media such as disk memory devices chip memory devices programmable logic devices and application specific integrated circuits. In addition a computer readable medium that implements the subject matter described herein may be located on a single device or computing platform or may be distributed across multiple devices or computing platforms.

The subject matter described herein includes a method that uses pre recorded audio clips to estimate material parameters that capture the inherent quality of recorded sounding materials. The method extracts perceptually salient features from audio examples. Based on psychoacoustic principles we design a parameter estimation algorithm using an optimization framework and these salient features to guide the search of the best material parameters for modal synthesis. We also present a method that compensates for the differences between the real world recording and sound synthesized using solely linear modal synthesis models to create the final synthesized audio. The resulting audio generated from this sound synthesis pipeline well preserves the same sense of material as a recorded audio example. Moreover both the estimated material parameters and the residual compensation naturally transfer to virtual objects of different sizes and shapes while the synthesized sounds vary accordingly. A perceptual study shows the results of this system compares well with real world recordings in terms of material perception.

Sound plays a prominent role in a virtual environment. Recent progress has been made on sound synthesis models that automatically produce sounds for various types of objects and phenomena. However it remains a demanding task to add high quality sounds to a visual simulation that attempts to depict its real world counterpart. Firstly there is the difficulty for digitally synthesized sounds to emulate real sounds as closely as possible. Lack of true to life sound effects would cause a visual representation to lose its believability. Secondly sound should be closely synchronized with the graphical rendering in order to contribute to creation of a compelling virtual world. Noticeable disparity between the dynamic audio and visual components could lead to a poor virtual experience for users.

The traditional sound effect production for video games animation and movies is a laborious practice. Talented Foley artists are normally employed to record a large number of sound samples in advance and manually edit and synchronize the recorded sounds to a visual scene. This approach generally achieves satisfactory results. However it is labor intensive and cannot be applied to all interactive applications. It is still challenging if not infeasible to produce sound effects that precisely capture complex interactions that cannot be predicted in advance.

On the other hand modal synthesis methods are often used for simulating sounds in real time applications. This approach generally does not depend on any pre recorded audio samples to produce sounds triggered by all types of interactions so it does not require manually synchronizing the audio and visual events. The produced sounds are capable of reflecting the rich variations of interactions and also the geometry of the sounding objects. Although this approach is not as demanding during run time setting up good initial parameters for the virtual sounding materials in modal analysis is a time consuming and non intuitive process. When faced with a complicated scene consisting of many different sounding materials the parameter selection procedure can quickly become prohibitively expensive and tedious.

Although tables of material parameters for stiffness and mass density are widely available directly looking up these parameters in physics handbooks does not offer as intuitive direct control as using a recorded audio example. In fact sound designers often record their own audio to obtain the desired sound effects. The subject matter described herein includes a new data driven sound synthesis technique that preserves the realism and quality of audio recordings while exploiting all the advantages of physically based modal synthesis. We introduce a computational framework that takes a single example audio recording and estimates the intrinsic material parameters such as stiffness damping coefficients and mass density that can be directly used in modal analysis. However as described below in the Conclusions and Future Work section using multiple audio recordings is also within the scope of the subject matter described herein.

As a result for objects with different geometries and run time interactions different sets of modes are generated or excited differently and different sounds are produced. However if the material properties are the same they should all sound like coming from the same material. For example a plastic plate being hit a plastic ball being dropped and a plastic box sliding on the floor generate different sounds but they all sound like plastic as they have the same material properties. Therefore if we can deduce the material properties from a recorded sound and transfer them to different objects with rich interactions the intrinsic quality of the original sounding material is preserved. Our method can also compensate the differences between the example audio and the modal synthesized sound. Both the material parameters and the residual compensation are capable of being transferred to virtual objects of varying sizes and shapes and capture all forms of interactions. shows an example of our framework. From one recorded impact sound a we estimated material parameters which can be directly applied to various geometries c d and e to generate audio effects that automatically reflect the shape variation while still preserve the same sense of material.

Feature extraction module may reside in memory and be executed by processor to perform feature extraction Feature extraction may include given a recorded impact audio clip initial extraction from the audio o clip of high level features namely a set of damped sinusoids with constant frequencies dampings and initial amplitudes Sec. 4 . These features are then used to facilitate estimation of the material parameters Sec. 5 and guide the residual compensation process Sec. 6 .

Parameter estimation module may reside in memory and be executed by processor to perform parameter estimation In one example of parameter estimation due to the constraints of the sound synthesis model we assume a limited input from just one recording and it is challenging to estimate the material parameters from one audio sample. To do so a virtual object of the same size and shape as the real world object used in recording the example audio is created.

Each time an estimated set of parameters is applied to the virtual object for a given impact the generated sound as well as the feature information of the resonance modes are compared with the real world example sound and extracted features respectively using a difference metric. This metric is designed based on psychoacoustic principles and aimed at measuring both the audio material re semblance of two objects and the perceptual similarity between two sound clips. The optimal set of material parameters is thereby determined by minimizing this perceptually inspired metric function see Sec. 5 . These parameters are readily transferable to other virtual objects of various geometries undergoing rich interactions and the synthesized sounds preserve the intrinsic quality of the original sounding material.

Residual compensation module may reside in memory and be executed by processor to perform residual compensation. Residual compensation accounts for the residual i.e. the approximated differences between the real world audio recording and the modal synthesis sound with the estimated parameters. First the residual is computed using the extracted features the example recording and the synthesized audio. Then at run time the residual is transferred to various virtual objects. The transfer of residual is guided by the transfer of modes and naturally reflects the geometry and run time interaction variation see Sec. 6 .

Once material parameters are estimated for a real world object using the system illustrated in the parameters may be stored in a memory and accessed by a sound synthesizer module to synthesize sounds for virtual objects having the same or similar properties as the real world object. For example as illustrated in a computer may include a processor and a memory . Computer may be a personal computer a laptop computer a tablet computer a mobile device a gaming console a graphics card or any other platform with a processor and on which it is desirable to generate synthesized sounds for virtual objects. A synthesizer module may be embodied or stored in memory . Memory may also store material parameters estimated based on a recorded audio sample of an impact on a physical object having material properties similar to a virtual object see Sec. 5 . For example the virtual object may be an object in a game such as a car door the recorded sound may be the sound of the door closing and the material properties may include properties of the door. Synthesizer module may be configured to retrieve one or more of the estimated material parameters associated with a virtual object and utilize the retrieved material parameters to synthesize a sound associated with the virtual object. For example synthesizer module may synthesize the sound of a virtual car door closing where the virtual card door is larger than the real car door for which the material properties were calculated and stored using the estimated material parameters stored for the real car door.

According to another aspect of the subject matter described herein synthesizer module may be configured to augment the sound to account for residual differences between the set of damped sinusoids and the recorded audio sample as described below in Sec. 6. Synthesizer module may also be configured to determine the residual differences between the set of damped sinusoids and the recorded audio sample by computing a represented sound that corresponds to a portion of the recorded audio sample represented by the set of damped sinusoids and subtracting a power spectrogram of the represented sound from a power spectrogram of the recorded audio sample as also described below in Sec. 6. When the virtual object differs in geometry from the real object for which the audio was recorded synthesizer module may be configured to generate a transform function for transforming a power spectrogram based on the set of damped sinusoids to a power spectrogram that accounts for the differing geometry and apply the transform function to a power spectrogram of the residual differences as described below in Sec. 6.

a feature guided parameter estimation framework to determine the optimal material parameters that can be used in existing modal sound synthesis applications 

an effective residual compensation method that accounts for the difference between the real world recording and the modal synthesized sound 

a general framework for synthesizing rigid body sounds that closely resemble recorded example materials and

automatic transfer of material parameters and residual compensation to different geometries and runtime dynamics producing realistic sounds that vary accordingly.

In the last couple of decades there has been strong interest in digital sound synthesis in both computer music and computer graphics communities due to the needs for auditory display in virtual environment applications. The traditional practice of Foley sounds is still widely adopted by sound designers for applications like video games and movies. Real sound effects are recorded and edited to match a visual display. More recently granular synthesis became a popular technique to create sounds with computers or other digital synthesizers. Short grains of sounds are manipulated to form a sequence of audio signals that sound like a particular object or event. Roads 2004 gave an excellent review on the theories and implementation of generating sounds with this approach. Picard et al. 2009 proposed techniques to mix sound grains according to events in a physics engine.

Physically Based Sound Synthesis Another approach for simulating sound sources is using physically based simulation to synthesize realistic sounds that automatically synchronize with the visual rendering. Generating sounds of interesting natural phenomena like fluid dynamics and aerodynamics have been pro posed Dobashi et al. 2003 2004 Zheng and James 2009 Moss et al. 2010 Chadwick and James 2011 . The ubiquitous rigid body sounds play a vital role in all types of virtual environments and the synthesis of rigid body sounds using estimated material properties is described in detail herein. O Brien et al. 2001 proposed simulating rigid bodies with deformable body models that approximates solid objects small scale vibration leading to variation in air pressure which propagates sounds to human ears. This approach accurately captures surface vibration and wave propagation once sounds are emitted from objects. However it is far from being efficient enough to handle interactive applications. Adrien 1991 introduced modal synthesis to digital sound generation. For real time applications linear modal sound synthesis has been widely adopted to synthesize rigid body sounds van den Doel and Pai 1998 O Brien et al. 2002 Raghuvanshi and Lin 2006 James et al. 2006 Zheng and James 2010 . This method acquires a modal model i.e. a bank of damped sinusoidal waves using modal analysis and generates sounds at runtime based on excitation to this modal model. Moreover sounds of complex interaction can be achieved with modal synthesis. Van den Doel et al. 2001 presented parametric models to approximate contact forces as ex citation to modal models to generate impact sliding and rolling sounds. Ren et al. 2010 proposed including normal map information to simulate sliding sounds that reflect contact surface de tails. More recently Zheng and James 2011 created highly realistic contact sounds with linear modal synthesis by enabling non rigid sound phenomena and modeling vibrational contact damping. Moreover the standard modal synthesis can be accelerated with techniques proposed by Raghuvanshi and Lin 2006 Bonneel et al. 2008 which make synthesizing a large number of sounding objects feasible at interactive rates.

The use of linear modal synthesis is not limited to creating simple rigid body sounds. Chadwick et al. 2009 used modal analysis to compute linear mode basis and added nonlinear coupling of those modes to efficiently approximate the rich thin shell sounds. Zheng and James 2010 extended linear modal synthesis to handle complex fracture phenomena by precomputing modal models for ellipsoidal sound proxies.

However few previous sound synthesis works addressed the issue of how to determine material parameters used in modal analysis to more easily recreate realistic sounds.

Parameter Acquisition Spring mass Raghuvanshi and Lin 20061 and finite element O Brien et al. 2002 representations have been used to calculate the modal model of arbitrary shapes. Challenges lie in how to choose the material parameters used in these representations. Pai et al. 2001 and Corbett et al. 2007 directly acquires a modal model by estimating modal parameters i.e. amplitudes frequencies and dampings from measured impact sound data. A robotic device is used to apply impulses on a real object at a large number of sample points and the resulting impact sounds are analyzed for modal parameter estimation. This method is capable of constructing a virtual sounding object that accurately recreates the audible resonance of its measured real world counterpart. However each new virtual geometry would require a new measuring process performed on a real object that has exactly the same shape and it can become prohibitively expensive with an increasing number of objects in a scene. This approach generally extracts hundreds of parameters for one object from many audio clips while the goal of our technique instead is to estimate the few parameters that best represent one material of a sounding object from only one audio clip.

To the best of our knowledge the only other research work that attempts to estimate sound parameters from one recorded clip is by Lloyd et al. 2011 . Pre recorded real world impact sounds are utilized to find peak and long standing resonance frequencies and the amplitude envelopes are then tracked for those frequencies. They proposed using the tracked time varying envelope as the amplitude for the modal model instead of the standard damped sinusoidal waves in conventional modal synthesis. Richer and more realistic audio is produced this way. Their data driven approach estimates the modal parameters instead of material parameters. Similar to the method proposed by Pai et al. 2001 these are per mode parameters and not transferable to another object with corresponding variation. At runtime they randomize the gains of all tracked modes to generate an illusion of variation when hitting different locations on the object. Therefore the produced sounds do not necessarily vary correctly or consistently with hit points. Their adopted resonance modes plus residual resynthesis model is very similar to that of SoundSeed Impact Audiokinetic 2011 which is a sound synthesis tool widely used in the game industry. Both of these works extract and track resonance modes and modify them with signal processing techniques during synthesis. None of them attempts to fit the extracted per mode data to a modal sound synthesis model i.e. estimating the higher level material parameters.

In computer music and acoustic communities researchers proposed methods to calibrate physically based virtual musical instruments. For example V lim ki et al. 1996 1997 proposed a physical model for simulating plucked string instruments. They presented a parameter calibration framework that detects pitches and damping rates from recorded instrument sounds with signal processing techniques. However their framework only fits parameters for strings and resonance bodies in guitars and it cannot be easily extended to extract parameters of a general rigid body sound synthesis model. Trebian and Oliveira 2009 presented a sound synthesis method with linear digital filters. They estimated the parameters for recursive filters based on pre recorded audio and re synthesized sounds in real time with digital audio processing techniques. This approach is not designed to capture rich physical phenomena that are automatically coupled with varying object interactions. The relationship between the perception of sounding objects and their sizes shapes and material properties have been investigated with experiments among which Lakatos et al. 1997 and Fontana 2003 presented results and studied human s capability to tell materials sizes and shapes of objects based on their sounds.

Modal Plus Residual Models The sound synthesis model with a deterministic signal plus a stochastic residual was introduced to spectral synthesis by Serra and Smith 1990 . This approach analyzes an input audio and divides it into a deterministic part which are time variant sinusoids and a stochastic part which is obtained by spectral subtraction of the deterministic sinusoids from the original audio. In the resynthesis process both parts can be modified to create various sound effects as suggested by Cook 1996 1997 2002 and Lloyd et al. 2011 . Methods for tracking the amplitudes of the sinusoids in audio dates back to Quateri and McAulay 1985 while more recent work Serra and Smith III 1990 Serra 1997 Lloyd et al. 2011 also proposes effective methods for this purpose. All of these works directly construct the modal sounds with the extracted features while our modal component is synthesized with the estimated material parameters. Therefore although we adopt the same concept of modal plus residual synthesis for our framework we face different constraints due to the new objective in material parameter estimation and render these existing works not applicable to the problem addressed herein. Later we will describe our feature extraction Sec. 4 and residual compensation Sec. 6 methods that are suitable for material parameter estimation.

Modal Sound Synthesis The standard linear modal synthesis technique Shabana 1997 is frequently used for modeling of dynamic deformation and physically based sound synthesis. We adopt tetrahedral finite element models to represent any given geometry O Brien et al. 2002 . The displacements x R in such a system can be calculated with the following linear deformation equation 1 

where M C and K respectively represent the mass damping and stiffness matrices. For small levels of damping it is reasonable to approximate the damping matrix with Rayleigh damping i.e. representing damping matrix as a linear combination of mass matrix and stiffness matrix C M K. This is a well established practice and has been adopted by many modal synthesis related works in both graphics and acoustics communities. After solving the generalized eigenvalue problem 2 the system can be decoupled into the following form 3 where is a diagonal matrix containing the eigenvalues of Eqn. 2 U is the eigenvector matrix and transforms x to the decoupled deformation bases q with x Uq.

The solution to this decoupled system Eqn. 3 is a bank of modes i.e. damped sinusoidal waves. The i th mode looks like sin 2 4 where is the frequency of the mode dis the damping coefficient ais the excited amplitude and is the initial phase.

The frequency damping and amplitude together define the feature of mode i 5 and will be used throughout the rest of this description. We ignore in Eqn. 4 because it can be safely assumed as zero in our estimation process where the object is initially at rest and struck at t 0. and are used interchangeably to represent frequency where 2 .

Material properties The values in Eqn. 4 depend on the material properties the geometry and the run time interactions aand depend on the run time excitation of the object while and ddepend on the geometry and the material properties as shown below. Solving Eqn. 3 we get

It is feasible to assume the Rayleigh damping coefficients and are shape invariant material parameters. They can be transferred to another object if it bears no drastic shape or size change. Empirical experiments were carried out to verify this and the results are included in Appendix A. The eigenvalues Xi s are calculated from M and K and determined by the geometry and tetrahedralization as well as the material properties in our tetrahedral finite element model M and K depend on mass density . Young s modulus E and Poisson s ratio if we assume the material is isotropic and homogeneous.

Constraint for modes We observe modes in the adopted linear modal synthesis model have to obey some constraint due to its formulation. Because of the Rayleigh damping model we adopted all estimated modes lie on a circle in the d space characterized by and . This can be shown as follows. Rearranging Eqn. 6 and Eqn. 7 as

We first analyze and decompose a given example audio clip into a set of features which will later be used in the subsequent phases of our pipeline namely the parameter estimation and residual compensation parts. Next we present the detail of our feature extraction algorithm.

Multi level power spectrogram representation As shown in Eqn. 5 the feature of a mode is defined as its frequency damping and amplitude. In order to analyze the example audio and extract these feature values we use a time varying frequency representation called power spectrogram. A power spectrogram P for a time domain signal s n is obtained by first breaking it up into overlapping frames and then performing windowing and Fourier transform on each frame 

When computing the power spectrogram for a given sound clip one can choose the resolutions of the time or frequency axes by adjusting the length of the window w. Choosing the resolution in one dimension however automatically determines the resolution in the other dimension. A high frequency resolution results in a low temporal resolution and vice versa.

To fully accommodate the range of frequency and damping for all the modes of an example audio we compute multiple levels of power spectrograms with each level doubling the frequency resolution of the previous one and halving the temporal resolution. Therefore for each mode to be extracted a suitable level of power spectrogram can be chosen first depending on the time and frequency characteristics of the mode.

After computing a set of multi level power spectrograms for a recorded example audio we globally search through all levels for peaks local maxima along the frequency axis. These peaks indicate the frequencies where potential modes are located some of which may appear in multiple levels. At this step the knowledge of frequency is limited by the frequency resolution of the level of power spectrogram. For example in the level where the window size is 512 points the frequency resolution is as coarse as 86 Hz. A more accurate estimate of the frequency as well as the damping value is obtained by performing a local shape fitting around the peak.

The power spectrogram of a damped sinusoid has a hill shape similar to the surface shown in the left hand graph in . The actual shape contains information of the damped sinusoid the position and height of the peak are respectively determined by the frequency and amplitude while the slope along the time axis and the width along the frequency axis are determined by the damping value. For a potential mode a damped sinusoid with the initial guess of f d a is synthesized and added to the sound clip consisting of all the modes collected so far. The power spectrogram of the resulting sound clip is computed shown as the hill shape in and compared locally with that of the recorded audio the leftmost hill shape in . An optimizer then searches in the continuous f d a space to minimize the difference and acquire an accurate estimate of the frequency damping and amplitude of the mode at question. illustrates this process.

The local shape fittings for all potential modes are performed in a greedy manner. Among all peaks in all levels the algorithm starts with the one having the highest average power spectral density. If the shape fitting error computed is above a predefined threshold we conclude that this level of power spectrogram is not sufficient in capturing the feature characteristics and thereby discard the result otherwise the feature of the mode is collected. In other words the most suitable time frequency resolution level for a mode with a particular frequency is not predetermined but dynamically searched for. Similar approaches have been proposed to analyze the sinusoids in an audio clip in a multi resolution manner e.g. Levine et al. 1998 where the time frequency regions power spectrogram resolution is predetermined .

We have tested the accuracy of our feature extraction with 100 synthetic sinusoids with frequencies and damping values randomly drawn from 0 22050.0 Hz and 0.1 1000 s respectively. The average relative error is 0.040 for frequencies and 0.53 for damping values which are accurate enough for our framework.

The SMS method Serra and Smith III 1990 is also capable of estimating information of modes. From a power spectrogram it tracks the amplitude envelope of each peak over time and a similar method is adopted by Lloyd et al. 2011 . Unlike our algorithm which fits the entire local hill shape they only track a single peak value per time frame. In the case where the mode s damping is high or the signal s background is noisy this method yields high error.

Another feature extraction technique was proposed by Pai et al. 2001 and Corbett et al. 2007 . The method is known for its ability to separate modes within one frequency bin. In our frame work however the features are only used to guide the subsequent parameter estimation process which is not affected much by replacing two nearly duplicate features with one. Our method also offers some advantages and achieves higher accuracy in some cases compared with theirs. First our proposed greedy approach is able to reduce the interference caused by high energy neighboring modes. Secondly these earlier methods use a fixed frequency time resolution that is not necessarily the most suitable for extracting all modes while our method selects the appropriate resolution dynamically. Detailed comparisons and data can be found in Appendix B.

Using the extracted features Sec. 4 and psychoacoustic principles as described in this section we introduce a parameter estimation algorithm based on an optimization framework for sound synthesis.

We now describe the optimization work flow for estimating material parameters for sound synthesis. In the rest of this description all data related to the example audio recordings are called reference data all data related to the virtual object which are used to estimate the material parameters are called estimated data and are denoted with a tilde e.g. tilde over .

The reference sound is the example recorded audio which can be expressed as a time domain signal s n . The reference features d a are the features extracted from the reference sound as described in Sec. 4.

In order to compute the estimated sound tilde over s n and estimated features tilde over tilde over tilde over tilde over d we first create a virtual object that is roughly the same size and geometry as the real world object whose impact sound was recorded. We then tetrahedralize it and calculate its mass matrix M and stiffness matrix K. As mentioned in Sec. 3 we assume the material is isotropic and homogeneous. Therefore the initial M and K can be found using the finite element method by assuming some initial values for the Young s modulus mass density and Poisson s ratio E and . The assumed eigenvalues s can thereby be computed. For computational efficiency we make a further simplification that the Poisson s ratio is held as constant. Then the eigenvalue for general E and is just a multiple of 

We then apply a unit impulse on the virtual object at a point corresponding to the actual impact point in the example recording which gives an excitation pattern of the eigenvalues as Eqn. 4. We denote the excitation amplitude of mode j as a. The superscript 0 notes that it is the response of a unit impulse if the impulse is not unit then the excitation amplitude is just scaled by a factor 11 Combining Eqn. 6 Eqn. 7 Eqn. 10 and Eqn. 11 we obtain a mapping from an assumed eigenvalue and its excitation a to an estimated mode with frequency tilde over damping tilde over d and amplitude 

The estimated sound tilde over s n and features tilde over can then be compared against the reference sound s n and features and a difference metric can be computed. If such difference metric function is denoted by the problem of parameter estimation becomes finding

An optimization process is used to find such parameter set. The most challenging part of our work is to find a suitable metric function that can truly reflect what we view as the difference. Next we discuss the details about the metric design in Sec. 5.2 and the optimization process in Sec. 5.3.

Given an impact sound of a real world object the goal is to find a set of material parameters such that when they are applied to a virtual object of the same size and shape the synthesized sounds have the similar auditory perception as the original recorded sounding object. By further varying the size geometry and the impact points of the virtual object the intrinsic audio signature of each material for the synthesized sound clips should closely resemble that of the original recording. These are the two criteria guiding the estimation of material parameters based on an example audio clip 

The perceptual similarity of sound clips can be evaluated by an image domain metric quantified using the power spectrogram while the audio material resemblance is best measured by a feature do main metric both will be defined below 

Given a reference sound s n and an estimated sound tilde over s n their power spectrograms are computed using Eqn. 9 and denoted as two 2D images I P m w tilde over P m w . An image domain metric can then be expressed as 15 

Our goal is to find an estimated image that minimizes a given image domain metric. This process is equivalent to image registration in computer vision and medical imaging.

A feature d ais essentially a three dimensional point. As established in Sec. 3 the set of features of a sounding object is closely related to the material properties of that object. Therefore a metric defined in the feature space is useful in measuring the audio material resemblance of two objects. In other words a good estimate of material parameters should map the eigenvalues of the virtual object to similar modes as that of the real object. A feature domain metric can be written as tilde over 16 and the process of finding the minimum can be viewed as a point set matching problem in computer vision.

Both the auditory perceptual similarity and audio material resemblance would need to be considered for a generalized framework in order to extract and transfer material parameters for modal sound synthesis using a recorded example to guide the automatic selection of material parameters. Therefore we propose a hybrid metric that takes into account both tilde over 17 Next we provide details on how we design and compute these metrics. 5.2.1 Image Domain Metric

Given two power spectrogram images I and a naive metric can be defined as their squared difference I P m tilde over P m . There are however several problems with this metric. The frequency resolution is uniform across the spectrum and the intensity is uniformly weighted. As humans however we distinguish lower frequencies better than the higher frequencies and mid frequency signals appear louder than extremely low or high frequencies Zwicker and Fastl 1999 . Therefore directly taking squared difference of power spectrograms overemphasizes the frequency differences in the high frequency components and the intensity differences near both ends of the audible frequency range. It is necessary to apply both frequency and intensity transformations before computing the image domain metric. We design these transformations based on psychoacoustic principles Zwicker and Fastl 1999 .

Studies in psychoacoustics suggested that humans have a limited capacity to discriminate between nearby frequencies i.e. a frequency is not distinguishable from if is within . The indistinguishable range is itself a function of frequency for example the higher the frequency the larger the indistinguishable range. To factor out this variation in a different frequency representation called critical band rate z has been introduced in psychoacoustics. The unit for z is Bark and it has the advantage that while is a function of measured in Hz it is constant when measured in Barks. Therefore by transforming the frequency dimension of a power spectrogram from to z we obtain an image that is weighted according to human s perceptual frequency differences. shows the relationship between critical band rate z and frequency z Z .

Sound can be described as the variation of pressure p t and human auditory system has a high dynamical range from 10Pa threshold of hearing to 10Pa threshold of pain . In order to cope with such a broad range the sound pressure level is normally used. For a sound with pressure p its sound pressure level L in decibel abbreviated to dB SPL is defined as 20 log 18 where pis a standard reference pressure. While Lis just a physical value loudness L is a perceptual value which measures human sensation of sound intensity. In between loudness level Lrelates the physical value to human sensation. Loudness level of a sound is defined as the sound pressure level of a 1 kHz tone that is perceived as loud as the sound. Its unit is phon and is calibrated such that a sound with loudness level of 40 phon is as loud as a 1 kHz tone at 40 dB SPL. Finally loudness L is computed from loudness level. Its unit is sone and is defined such that a sound of 40 phon is 1 sone a sound twice as loud is 2 sone and so on.

There are other psychoacoustic factors that can affect the human sensation of sound intensity. For example van den Doel et al. van den Doel and Pai 2002 van den Doel et al. 2004 considered the masking effect which describes the change of audible threshold in the presence of multiple stimuli or modes in this case. However they did not handle the loudness transform above the audible threshold which is critical in our perceptual metric. Similar to the work by van den Doel and Pai 1998 we have ignored the masking effect.

After transforming the frequency or equivalently to the critical band rate z and mapping the intensity to loudness we obtain a transformed image T I T I m z . Different representations of a sound signal are shown in . Then we can define a psychoacoustic image domain metric as

As shown in Eqn. 8 in the d space modes under the assumption of Rayleigh damping lie on a circle determined by damping parameters and while features extracted from example recordings can be anywhere. Therefore it is challenging to find a good match between the reference features and estimated features tilde over . shows a typical matching in the d space. Next we present a feature domain metric that evaluates such a match.

In order to compute the feature domain metric we first transform the frequency and damping of feature points to another different 2D space. Namely from d to x y where x X and y Y d encode the frequency and damping information respectively. With suitable transformations the Euclidean distance defined in the transformed space can be more useful and meaningful for representing the perceptual difference. The distance between two feature points is thus written as tilde over tilde over 20 Frequency and damping are key factors in determining material agreement while amplitude indicates relative importance of modes. That is why we measure the distance between two feature points in the 2D d space and use amplitude to weigh that distance

For frequency as described in Sec. 5.2.1 we know that the frequency resolution of human is constant when expressed as critical band rate and measured in Barks z. Therefore it is a suitable frequency transformation 21 where cis some constant coefficient.

For damping although human can roughly sense that one mode damps faster than another directly taking the difference in damping value d is not feasible. This is due to the fact that humans cannot distinguish between extremely short bursts Zwicker and Fastl 1999 . For a damped sinusoid the inverse of the damping value 1 d is proportional to its duration and equals to how long before the signal decays to eof its initial amplitude. While distance measured in damping values overemphasizes the difference between signals with high d values corresponding to short bursts distance measured in durations does not. Therefore

Having defined the transformed space we then look for matching the reference and estimated feature points in this space. Our matching problem belongs to the category where there is no known correspondence i.e. no prior knowledge about which point in one set should be matched to which point in another. Furthermore because there may be several estimated feature points in the neighborhood of a reference point or vice versa the matching is not necessarily a one to one relationship. There is also no guarantee that an exact matching exist because 1 the recorded material may not obey the Rayleigh damping model 2 the discretization of the virtual object and the assumed hit point may not give the exact eigenvalues and excitation pattern of the real object. Therefore we are merely looking for a partial approximate matching.

The simplest point based matching algorithm that solves problems in this category i.e. partial approximate matching without known correspondence is Iterative Closest Points. It does not work well however when there is a significant number of feature points that cannot be matched Besl and McKay 1992 which is possibly the case in our problem. Therefore we define a metric Match Ratio Product that meets our need and is discussed next.

For a reference feature point set we define a match ratio that measures how well they are matched by an estimated feature point set tilde over . This set to set match ratio defined as

The match ratios for the reference and the estimated feature point sets are then combined to form the Match Ratio Product MRP which measures how well the reference and estimated feature point sets match with each other tilde over 26 The negative sign is to comply with the minimization framework. Multiplying the two ratios penalizes the extreme case where either one of them is close to zero indicating poor matching .

The normalization processes in Eqn. 23 and Eqn. 25 are necessary. Notice that the denominator in Eqn. 25 is related to the number of estimated feature points inside the audible range in fact tilde over if all tilde over 1 . Depending on the set of parameters can vary from a few to thousands. Factoring prevents the optimizer from blindly introducing more modes into the audible range which may increase the absolute number of matched feature points but may not necessarily increase the match ratios. Such averaging techniques have also been employed to improve the robustness and discrimination power of point based object matching methods Dubuisson and Jain 1994 Gope and Kehtarnavaz 2007 .

In practice the weights s and if u s can be assigned according to the relative energy or perceptual importance of the modes. The point to point match score k tilde over can also be tailored to meet different needs. The constants and function forms used in this section are listed in Appendix C.

Finally we combine the strengths from both image and feature domain metrics by defining the following hybrid metric 

First as elaborated by Eqn. 8 in Sec. 3 the estimated modes are constrained by a circle in the d space. Secondly although there are many reference modes they are not evenly excited by a given impact we observe that usually the energy is mostly concentrated in a few dominant ones. Therefore a good estimate of and must define a circle that passes through the neighborhood of these dominant reference feature points. We also observe that in order to yield a low metric value there must be at least one dominant estimated mode at the frequency of the most dominant reference mode.

We thereby generate our starting points by first drawing two dominant reference feature points from a total of Nof them and find the circle passing through these two points. This circle is potentially a good circle from which we can deduce a starting estimate of and using Eqn. 8. We then collect a set of eigenvalues and amplitudes defined in Sec. 5.1 a such that there does not exist any a that simultaneously satisfies a. It can be verified that the estimated modes mapped from this set always includes the one with the highest energy for any mapping parameters used in Eqn. 12. Each a in this set is then mapped and aligned to the frequency of the most dominant reference feature point and its amplitude is adjusted to be identical as the latter. This step gives a starting estimate of and . Each set of computed in this manner is a starting point and may lead to a different local minimum. We choose the set which results in the lowest metric value to be our estimated parameters. Although there is no guarantee that a global minimum will be met we find that the results produced with this strategy are satisfactory in our experiments as discussed in Sec. 7.

With the optimization proposed in Sec. 5 a set of parameters that describe the material of a given sounding object can be estimated and the produced sound bears a close resemblance of the material used in the given example audio. However linear modal synthesis alone is not capable of synthesizing sounds that are as rich and realistic as many real world recordings. Firstly during the short period of contact not all energy is transformed into stable vibration that can be represented with a small number of damped sinusoids or modes. The stochastic and transient nature of the non modal components makes sounds in nature rich and varying. Secondly as discussed in Sec. 3 not all features can be captured due to the constraints for modes in the synthesis model. In this section we present a method to account for the residual which approximates the difference between the real world recordings and the modal synthesis sounds. In addition we propose a technique for transferring the residual with geometry and interaction variation. With the residual computation and transfer algorithms introduced below more realistic sounds that automatically vary with geometries and hitting points can be generated with a small computation overhead.

In this section we discuss how to compute the residual from the recorded sound and the synthesized modal sound generated with the estimated parameters.

Previous works have also looked into capturing the difference between a source audio and its modal component Serra and Smith III 1990 Serra 1997 Lloyd et al. 2011 . In these works the modal part is directly tracked from the original audio so the residual can be calculated by a straightforward subtraction of the power spectrograms. The synthesized modal sound in our framework however is generated solely from the estimated material parameters. Although it preserves the intrinsic quality of the recorded material in general the modes in our synthesized sounds are not perfectly aligned with the recorded audio. An example is shown in and . It is due to the constraints in our sound synthesis model and discrepancy between the discretized virtual geometries and the real world sounding objects. As a result direct subtraction does not work in this case to generate a reasonable residual. Instead we first compute an intermediate data called the represented sound. It corresponds to the part in the recorded sound that is captured or represented by our synthesized sound. This represented sound can be directly subtracted from the recorded sound to compute the residual .

The computation of the represented sound is based on the following observations. Consider a feature described by extracted from the recorded audio. If it is perfectly captured by the estimated modes then it should not be included in the residual and should be completely subtracted from the recorded sound. If it is not captured at all it should not be subtracted from the recorded sound and if it is approximated by an estimated mode it should be partially subtracted. Since features closely represent the original audio they can be directly subtracted from the recorded sound.

The point to set match ratio R tilde over proposed in Sec. 5.2 essentially measures how well a reference feature is represented matched by all the estimated modes. This match ratio can be conveniently used to determine how much of the corresponding feature should be subtracted from the recording.

The represented sound is therefore obtained by adding up all the reference features that are respectively weighted by the match ratio of the estimated modes. And the power spectrogram of the residual is obtained by subtracting the power spectrogram of the represented sound from that of the recorded sound. illustrates the residual computation process.

Residual of one particular instance i.e. one geometry and one hit point can be obtained through the above described residual computation method. However when synthesizing sounds for a different geometry undergoing different interaction with other rigid bodies the residual audio needs to vary accordingly. Lloyd et al. 2011 proposed applying a random dip filter on the residual to provide variation. While this offers an attractive solution for quickly generating modified residual sound it does not transfer accordingly with the geometry change or the dynamics of the sounding object.

As discussed in previous sections modes transfer naturally with geometries in the modal analysis process and they respond to excitations at runtime in a physical manner. In other words the modal component of the synthesized sounds already provides transferability of sounds due to varying geometries and dynamics. Hence we compute the transferred residual under the guidance of modes as follows.

Given a source geometry and impact point we know how to transform its modal sound to a target geometry and impact points. Equivalently we can describe such transformation as acting on the power spectrograms transforming the modal power spectrogram of the source Pto that of the target P 

More specifically H can be decomposed into per mode transform functions H which transforms the power spectrogram of a source mode d a to a target mode d a . H can further be described as a series of operations on the source power spectrogram P 1 the center frequency is shifted from to 2 the time dimension is stretched according to the ratio between dand d 3 the height intensity is scaled pixel by pixel to match PThe per mode transform is performed in the neighborhood of namely between and to that of namely between and .

The per mode transform is performed for all pairs of source and target modes and the local residual power spectrograms are stitched together to form the complete P. Finally the time domain signal of the residual is reconstructed from P using an iterative inverse STFT algorithm by Griffin and Lim 2003 . Algorithm 1 shows the complete feature guided residual transfer algorithm. With this scheme the transform of the residual power spectrogram is completely guided by the appropriate transform of modes. The resulting residual changes consistently with the modal sound. Since the modes transform with the geometry and dynamics in a physical manner the transferred residual also faithfully reflects this variation.

The most computation costly part of residual transfer is the iterative inverse STFT process. We are able to obtain acceptable time domain reconstruction from the power spectrogram when we limit the iteration of inverse SIFT to 10. Hardware acceleration is used in our implementation to ensure fast STFT computation. More specifically CUFFT a CUDA implementation of Fast Fourier Transform is adopted for parallelized inverse STFT operations. Also note that residual transfer computation only happens when there is a contact event the obtained time domain residual signal can be used until the next event.

On an NVIDIA GTX 480 graphics card if the contact events arrive at intervals around 1 30s the residual transfer in the current implementation can be successfully evaluated in time.

Before working on real world recordings we design an experiment to evaluate the effectiveness of our parameter estimation with synthetic sound clips. A virtual object with known material parameters and geometry is struck and a sound clip is synthesized by mixing the excited modes. The sound clip is entered to the parameter estimation pipeline to test if the same parameters are recovered. Three sets of parameters are tested and the results are shown in .

This experiment demonstrates that if the material follows the Rayleigh damping model the proposed framework is capable of estimating the material parameters with high accuracy. Below we will see that real materials do not follow the Rayleigh damping model exactly but the presented framework is still capable of finding the closest Rayleigh damping material that approximates the given material.

We estimate the material parameters from various real world audio recordings a wood plate a plastic plate a metal plate a porcelain plate and a glass bowl. For each recording the parameters are estimated using a virtual object that is of the same size and shape as the one used to record the audio clips. When the virtual object is hit at the same location as the real world object it produces a sound similar to the recorded audio as shown in and the supplementary video.

The parameters estimated can be transferred to virtual objects with different sizes and shapes. Using these material parameters a different set of resonance modes can be computed for each of these different objects. The sound synthesized with these modes preserves the intrinsic material quality of the example recording while naturally reflect the variation in virtual object s size shape and interactions in the virtual environment.

Moreover taking the difference between the recording of the example real object and the synthesized sound from its virtual counterpart the residual is computed. This residual can also be transferred to other virtual objects using methods described in Sec. 6.

We applied the estimated parameters for various virtual objects in a scenario where complex interactions take place as shown in and the accompanying video.

Table II shows the timing for our system running on a single core of a 2.80 GHz Intel Xeon X5560 machine. It should be noted that the parameter estimation is an offline process it needs to be run only once per material and the result can be stored in a database for future reuse.

For each material in column one multiple starting points are generated first as described in Sec. 5.3 and the numbers of starting points are shown in column two. From each of these starting points the optimization process runs for an average number of iterations column three until convergence. The average time taken for the process to converge is shown in column four. The convergence is defined as when both the step size and the difference in metric value are lower than their respective tolerance values and . The numbers reported in Table II are measured with 1e 4 and 1e 8.

To assess the effectiveness of our parameter estimation algorithm we designed an experiment to evaluate the auditory perception of the synthesized sounds of five different materials. Each subject is presented with a series of 24 audio clips with no visual image or graphical animation. Among them 8 are audio recordings of sound generated from hitting a real world object and 16 are synthesized using the techniques described herein. For each audio clip the subject is asked to identify among a set of 5 choices wood plastic metal porcelain and glass from which the sound came. A total of 53 subjects 35 women and 18 men from age of 22 to 71 participated in this study. The 8 real objects are a wood plate a plastic plate a metal plate a porcelain plate and four glass bowls with different sizes. The 16 virtual objects are three different shapes a plate a stick and a bunny for each of these four materials wood plastic metal and porcelain plus four glass bowls with different sizes.

We show the cumulative recognition rates of the sounding materials in two separate matrices Table III presents the recognition rates of sounds from real world materials and Table IV reflects the recognition rates of sounds from synthesized virtual materials. The numbers are normalized with the number of subjects answering the questions. For example Row 3 of Table III means that for a given real world sound recorded from hitting a metal object none of the subjects thought it came from wood or plastic 66.1 of them thought it came from metal 9.7 of them thought it came from porcelain and 24.2 of them thought it came from glass. Correspondingly Row 3 of Table IV shows that for a sound synthesized with our estimated parameters for metal the percentage of subjects thinking that it came from wood plastic metal porcelain or glass respectively.

We found that the successful recognition rate of virtual materials using our synthesized sounds compares favorably to the recognition rate of real materials using recorded sounds. The difference of the recognition rates recorded minus synthesized is close to zero for most of the materials with 95 confidence intervals shown in Table V. A confidence interval covering zero means that the difference in recognition rate is not statistically significant. If both endpoints of a confidence interval are positive the recognition rate of the real material is significantly higher than that of the virtual material if both endpoints are negative the recognition rate of the real material is significantly lower.

In general for both recorded and synthesized sounds several subjects have reported difficulty in reliably differentiating between wooden and dull plastic materials and between glass and porcelain. On the other hand some of the subjects suggested that we remove redundant audio clips which are in fact distinct sound clips of recordings generated from hitting real materials and their synthesized counterparts.

The subject matter described herein includes a data driven physically based sound synthesis algorithm using an example audio clip from real world recordings. By exploiting psychoacoustic principles and feature identification using linear modal analysis we are able to estimate the appropriate material parameters that capture the intrinsic audio properties of the original materials and transfer them to virtual objects of different sizes shape geometry and pair wise interaction. We also propose an effective residual computation technique to compensate for linear approximation of modal synthesis.

Although our experiments show successful results in estimating the material parameters and computing the residuals it has some limitations. Our model assumes linear deformation and Rayleigh damping. While offering computational efficiency these models cannot always capture all sound phenomena that real world materials demonstrate. Therefore it is practically impossible for the modal synthesis sounds generated with our estimated material parameters to sound exactly the same as the real world recording. Our feature extraction and parameter estimation depend on the assumption that the modes do not couple with one another. Although it holds for the objects in our experiments it may fail when recording from objects of other shapes e.g. thin shells where nonlinear models would be more appropriate Chadwick et al. 2009 .

We also assume that the recorded material is homogeneous and isotropic. For example wood is highly anisotropic when measured along or across the direction of growth. The anisotropy greatly affects the sound quality and is an important factor in making high precision musical instruments.

Despite these limitations our proposed framework is general allowing future research to further improve and use different individual components. For example the difference metric now considers the psychoacoustic factors and material resemblance through power spectrogram comparison and feature matching. It is possible that more factors can be taken into account or a more suitable representation as well as a different similarity measurement of sounds can be found.

The optimization process approximates the global optimum by searching through all good starting points. With a deeper investigation of the parameter space and more experiments the performance may be possibly improved by designing a more efficient scheme to navigate the parameter space such as starting point clustering early pruning or a different optimization procedure can be adopted.

Our residual computation compensates the difference between the real recording and the synthesized sound and we proposed a method to transfer it to different objects. While our transferring technique is consistent with the other components of the sound i.e. the modes and produces plausible results it is not the only way much due to the fact that the origin and nature of residual is unknown.

The subject matter described herein includes a system that can quickly estimate the optimal material parameters and compute the residual merely based on a single recording with a non expensive and simple setup. However where a small number of recordings of the same material are given as input machine learning techniques can be used to determine the set of parameters with maximum likelihood and it could be an area worth exploring. Finally we would like to extend this framework to other non rigid objects and fluids and possibly nonlinear modal synthesis models as well.

In summary data driven approaches have proven useful in areas in computer graphics including rendering lighting character animation and dynamics simulation. With promising results that are transferable to virtual objects of different geometries sizes and interactions this work is the first rigorous treatment of the problem on automatically determining the material parameters for physically based sound synthesis using a single sound recording and it offers a new direction for combining example guided and modal based approaches.

The disclosure of each of the following references is incorporated herein by reference in its entirety.

The concept of internal friction describes the relationship between frequency and damping for an object and is regarded as a shape invariant property Klatzky et al. 2000 Krotkov et al. 1996 Wildes and Richards 1988 . People have used empirical data to model this frequency damping relationship. Some work fits a constant angle of friction model to the measured data while some fits a quadratic curve. Rayleigh damping is among one of the known empirical models that model the frequency damping relationship with a special class of curve and can be considered a specific type of internal friction.

In order to reexamine the applicability of the Rayleigh damping empirical model in its transferability across different geometry and shapes we performed some experiments to verify if the Rayleigh damping parameters can be considered shape invariant. We recorded impact audio for real objects of various shapes for four materials. Then the resonance modes of those objects were extracted with our feature extraction algorithm. If the modes of different objects for the same material all fall on one Rayleigh damping curve we believe it is reasonable to assume that the Rayleigh damping parameters can indeed be transferred across different shapes. The results of our experiments are shown in . The real objects used in this experiment are pictured in the left column i.e. a glass bowls b china set c graphite tiles and d wooden blocks. In the right column i.e. feature plots the objects resonance modes are visualized as lines topped with geometric shapes in the frequency damping space and the height of each line indicates the modes relative energy. We show the most prominent modes i.e. modes with highest energy levels. Different objects resonance modes are color coded differently. For example in a the largest glass bowl is coded GREEN and its resonances modes are shown as the green lines in that material s feature plot. However because color drawings are not permitted in PCT patent applications each color is mapped to a geometric shape. The left hand column illustrates the mappings between colors and shapes green corresponds to a square blue corresponds to a circle red corresponds to a triangle and magenta corresponds to a star. The black curve shown on the frequency damping plane in each feature plot is determined by one set of Rayleigh damping parameters. For various shaped objects with the same material their resonance modes appear to lie closely to the same black curve. This indicates the same Rayleigh damping parameters can be used to describe the frequency damping relationship for all those different geometries with the same material.

Furthermore our user study results provide validation on the assumptions we made about Raleigh damping model offering insights consistent with our core hypothesis. We played synthesized sounds with our estimated material parameters applied to various shapes plate bunny stick and bowl and the material detection rate for each individual shape does not vary much from one another. For example the material detection rate for the metallic bunny is almost the same as that for the metallic plate. Our perceptual studies indicate that it is feasible to transfer Rayleigh damping parameters across different shapes and geometry for sound synthesis applications.

The Spectral Modeling Synthesis SMS method Serra and Smith III 1990 detects a peak also in the power spectrogram tracks the one peak point over time and forms an amplitude envelope. One can certainly use this amplitude envelope to infer the damping value for example by linear regression of the logarithmic amplitude values which is the approach adopted by V lim ki et al. 1996 . There are however several disadvantages of this approach.

First of all tracking only the peak point over time implies that the frequency estimation is only accurate to the width of the frequency bins of power spectrogram. For example for a window size of 512 samples the width of a frequency bin is about 86 Hz direct frequency peak tracking has frequency resolution as coarse as 86 Hz.

Serra and Smith pointed out this problem Serra and Smith III 1990 and proposes to improve the accuracy by taking the two neighboring frequency bins around the peak and performing a 3 point curve fitting to find the real peak Serra 1989 . Our method takes a further step instead of 3 points per time frame we use all points within a rectangular region. The region extends as far as possible in both frequency and time axes until a the amplitude falls under a threshold to the peak amplitude or b a local minimum in amplitude is reached. We then use an optimizer to find a damped sinusoid whose power spectrogram best matches the shape of the input data in the region of interest. An example is shown in where the solid surface is the power spectrogram of the input sound clip and the overlay mesh is the power spectrogram of the best fitted damped sinusoid.

Secondly for linear regression to work well there must be at least two points the more the better along the time axis before the signal falls to the level of background noise. For high damping values there will be only a few data points along the time axis. On the other hand we know that the damping value is also reflected in the width of the hill so when there are not enough points along the time axis there are more points along the frequency axis with significant heights which will help determining the damping value in our surface fitting method.

Taking more points into account makes it less sensitive to noise. In we simulated a noisy case where white noise with signal to noise ratio SNR 8 dB is added to a damped sinusoid with damping value 240 and use a our local surface fitting method and b SMS with linear regression to infer the damping value. In this particular example due to the high damping value and high noise level only 4 points participate in linear regression while 24 points are considered in our method. Our shape fitting is less sensitive to irregularities than the fitted line in SMS. The average damping error versus damping value for both methods are plotted in and where SNR 20 dB and 8 dB respectively.

Mathematically the 2D power spectrogram contains as much information as the original time domain signal except for the windowing effect and the loss of phase . Using only a 1D sequence inevitably discards a portion of all available information as in SMS and in some cases e.g. high damping values and high noise level this portion is significant. Our surface matching method utilizes as much information as possible. Fitting a surface is indeed more costly than fitting a line but it also achieves higher accuracy.

The phase unwrapping technique proposed by Pai et al. 2001 and Corbett et al. 2007 is known for its ability to separate close modes within one frequency bin. Our method however works under a different assumption and the ability to separate modes within a frequency bin has different impacts in our framework and theirs. In their framework the extracted features d a are directly used in the sound synthesis stage and thus control the final audio quality. In our case the features are only used to guide the subsequent parameter estimation process. In this process two close modes will show up as near duplicate points in the f d space. Because as pointed out by Pai et al. 2001 modes with close frequencies usually result from the shape symmetry of the sounding object and their damping values should also be close. In the process of fitting material parameters or more specifically in computing the feature domain metric replacing these near duplicate points with one point does not affect the quality of the result much.

Secondly despite of its ability to separate nearby modes Corbett et al. 2007 also proposes to merge modes if their difference in frequency is not greater than human s audible frequency discrimination limit 2 4 Hz . Among the multiple levels of power spectrograms that we used the finest frequency resolution about 3 Hz is in fact around this limit.

On the other hand our proposed feature extraction algorithm offers some advantages and achieves higher accuracy compared with Pai et al. 2001 and Corbett et al. 2007 in some cases. When extracting the information of a mode other modes within the same frequency bin which are successfully resolved by the Steiglitz McBride algorithm Steiglitz and McBride 1965 underlying Pai et al. 2001 and Corbett et al. 2007 are not the only source of interference. Other modes from several bins away also affect the values complex or magnitude only alike in the current bin known as the spillover effect . In order to minimize this effect the greedy method proposed herein collects the modes with the largest average power spectral density first. Therefore when examining a mode the neighboring modes that have higher energy than the current one are already collected and their influence removed. This can be demonstrated in . The original power spectrogram of a mode d a is shown in . The values at the frequency bin Fcontaining are plotted over time shown as the curve connecting the circles in . In the presence of another strong mode d a located 5 bins away changes the values at F plotted as the curve connecting the x s in . The complex values of the STFT at Fare not shown but they are similarly interfered. If these complex values at Fare directly fitted with the Steiglitz McBride algorithm in the works by Pai et al. 2001 and Corbett et al. 2007 the estimated damping has a 20 error. The greedy approach in our multi level algorithm removes the influence of the neighboring mode first resulting in a 1 damping error.

Based on our experimentations we also found that the universal frequency time resolution used in Pai et al. 2001 and Corbett et al. 2007 is not always most suitable for all modes. Our method uses a dynamic selection of frequency time resolution to address this problem. For example in the case of high damping values under a fixed frequency time resolution there may only be a few points above noise level along the time axis which will undermine the accuracy of the Steiglitz McBride algorithm. shows such an example the damping value 150 s is high but not unreasonable as shown in the time domain signal where a white noise with SNR 60 dB is added. The power spectrogram is shown in . We implemented the method in the paper by Corbett et al. 2007 using the suggested 46 ms window size with N 4 and tested on the above case. The input to this method is the complex values at the peak frequency bin whose magnitudes of the real and imaginary parts are shown in and an error of 5.7 for damping is obtained. As a comparison our algorithm automatically selects a 23 ms window size and fits the local shape in a 6 5 region in the frequency time space yielding merely a 0.9 error for damping.

We provide here the actual values and forms used in our implementation for the constants and functions introduced in Sec. 5.2 

For the relationship between critical band rate z in Bark and frequency in Hz we use 6 sin 600 30 that approximates the empirically determined curve shown in Wang et al. 1992 . We use c 5.0 and c 100.0 in Eqn. 21 and Eqn. 22. In Eqn. 23 the weight wassociated to a reference feature point is designed to be related to the energy of mode i. The energy can be found by integrating the power spectrogram of the damped sinusoid and we made a modification such that the power spectrogram is transformed prior to integration. The image domain transformation introduced in Sec. 5.2.1 which better reflects the perceptual importance of a feature is used. The weight used in Eqn. 24 is 0 for k tilde over 0 and 1 for k tilde over 0 uis defined similarly . For the point to point match score k tilde over in Eqn. 24 we use

The subject matter described herein for sound synthesis using estimated material parameters can be used for a variety of applications including video games and virtual reality applications. The example guided sound synthesis techniques described herein may also be used to estimate intrinsic parameters for liquid sound simulation or voice recognition and retargeting.

It will be understood that various details of the subject matter described herein may be changed without departing from the scope of the subject matter described herein. Furthermore the foregoing description is for the purpose of illustration only and not for the purpose of limitation.

