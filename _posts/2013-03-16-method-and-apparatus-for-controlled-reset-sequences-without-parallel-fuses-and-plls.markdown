---

title: Method and apparatus for controlled reset sequences without parallel fuses and PLL'S
abstract: A system, semiconductor device and method for providing a controlled system reset sequence with lower power consumption without dependency on fuses, PLL's and external XTAL's. A method to simplify a boot sequence by using a ring oscillator that compensates for voltage and temperature variations while also removing the dependency on parallel fuses, PLL's and external XTAL's.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09223365&OS=09223365&RS=09223365
owner: Intel Corporation
number: 09223365
owner_city: Santa Clara
owner_country: US
publication_date: 20130316
---
Embodiments described herein generally relate to microprocessor based systems and in particular of providing reliable reset operation with lower power consumption.

In current computer systems reset operation relies on fuses PLL s and external XTAL s that tend to cause voltage and temperature variations in a system. It would be beneficial to remove dependency on fuses PLL s and external XTAL s to guarantee reliable system boot operation with lower power consumption.

In at least one embodiment method for a power on sequence includes initiating a ring oscillator responsive to receiving a power up signal from a power management IC generating a calibrated ring oscillator signal by calibrating a frequency of a ring oscillator signal with a reference clock signal and responsive to detecting a calibrated ring oscillator signal error below a predetermined threshold value providing the calibrated ring oscillator signal to a firmware module to execute firmware.

In some embodiments the reference clock is the only clock source the reference clock frequency is in the range of 10 to 50 kHz a frequency of the calibrated ring oscillator is in the range of 5 to 500 MHz a jitter of the calibrated ring oscillator signal is less than a jitter threshold the jitter threshold may be in the range of approximately 5 to 10 a skew of the calibrated ring oscillator signal may be less than a skew threshold wherein the skew threshold is in the range of approximately 5 to 10 .

Some embodiments include establishing a first phase locked loop PLL after executing the firmware calibrating may initiate responsive to receiving an assert power good signal from the power management IC. Some embodiments include correcting ring oscillator signal jitter and skew at a targeted frequency. In some embodiments calibrating includes counting a number of ring oscillator signals during a calibration interval determined by the reference clock signal.

In some embodiments a computer system includes an external reference clock a power management IC and a system on chip comprising a processor a fuse controller and a power management unit. The power management unit may include a ring oscillator an internally generated clock and a power management controller to initiate a ring oscillator responsive to receiving a power up signal from a power management IC generate a calibrated ring oscillator signal by calibrating a frequency of a ring oscillator signal with a reference clock signal responsive to detecting a calibrated ring oscillator signal error below a predetermined threshold value provide the calibrated ring oscillator signal to a firmware module to execute firmware. In some embodiments the reference clock is the only clock source wherein the reference clock frequency is in the range of 10 to 50 kHz. A frequency of the calibrated ring oscillator may be in the range of 5 to 500 MHz. In some embodiments establishing a first phase locked loop PLL after executing the firmware and calibrating initiates responsive to receiving an assert power good signal from the power management IC.

In some embodiments a system on chip includes a processor a fuse controller and a power management unit comprising a ring oscillator an internally generated clock and a power management controller to initiate a ring oscillator responsive to receiving a power up signal from a power management IC generate a calibrated ring oscillator signal by calibrating a frequency of a ring oscillator signal with a reference clock signal responsive to detecting a calibrated ring oscillator signal error below a predetermined threshold value provide the calibrated ring oscillator signal to a firmware module to execute firmware. The reference clock frequency is in the range of 10 to 50 kHz a frequency of the calibrated ring oscillator is in the range of 5 to 500 MHz wherein calibrating initiates responsive to receiving an assert power good signal from the power management IC.

In the following description details are set forth in conjunction with embodiments to facilitate discussion of the disclosed subject matter. It should be apparent to a person of ordinary skill in the field however that the disclosed embodiments are exemplary and not exhaustive of all possible embodiments.

Throughout this disclosure a hyphenated form of a reference numeral refers to a specific instance of an element and the un hyphenated form of the reference numeral refers to the element generically or collectively. Thus widget refers to an instance of a widget class which may be referred to collectively as widgets and any one of which may be referred to generically as a widget .

Referring to an embodiment of a microprocessor based system is illustrated. In the illustrated embodiment system includes an SoC an I O hub and an interconnect that connects SoC and I O hub . In the illustrated embodiment SoC includes a processor an integrated memory controller connected to an internal interconnect to provide access to system memory . The illustrated embodiment further includes an integrated graphics adapter and video controller connected to interconnect to control a display . A bus interface unit provides an interface between interconnects and .

The illustrated embodiment of I O hub includes an audio adapter a storage controller an I O bus controller to support a peripheral bus and a low bandwidth or legacy bus LB controller to provide access to a flash read only memory ROM or other form of persistent storage via an LB bus . In the illustrated embodiment flash ROM includes BIOS . In at least one embodiment storage controller controls a solid state drive which may be a NAND flash drive or other form of mass nonvolatile storage. In at least one embodiment LB bus is a serial peripheral interface SPI bus and peripheral bus is a universal serial bus USB .

The illustrated embodiment of I O hub includes a secure digital I O SDIO chip connected to I O hub . In the illustrated embodiment SDIO chip provides support for various wireless communication protocols including in at least one embodiment Wi Fi. Embodiments of I O hub may include one or more interfaces that may support WiFi and or wireless telephony protocols. Other embodiments of I O hub may integrate RF hardware within I O hub or SoC using RF CMOS complementary metal oxide semiconductor fabrication technology.

In the embodiment illustrated in I O hub includes a bus interface unit that provides an interface between interconnect and an interconnect internal to I O hub to which audio adapter storage controller I O bus controller and LB controller are connected.

The illustrated embodiment of computer system further includes a dedicated power management unit which may connect to I O hub through USB or another form of interconnect. In other embodiments power management unit may be integrated within I O hub or SoC . Some embodiments may include power management resources for I O hub as well as SoC .

Referring now to one embodiment of processor is illustrated. In illustrated embodiment a processing core of processor includes a level 1 L1 instruction cache a front end an execution module an L1 data cache and a level 2 L2 cache . Although illustrates an embodiment having a single core other embodiments may include two or more processing cores. Similarly other embodiments of processor may include one or more additional cache memory elements including an L3 cache memory L3 that is shared among each processing core in multicore embodiments.

In at least one embodiment front end monitors and maintains an instruction pointer and fetches instructions for execution from L1 instruction cache . Front end may also perform all or some decoding of instructions fetched from L1 instruction cache before scheduling and issuing instructions for execution in execution module . In at least one embodiment execution module includes one or more pipelined integer arithmetic logic units load store units floating point pipelines and branch units. Execution module may include a register file that the pipeline accesses to provide operands and store results of arithmetic floating point and logical operations. Load store instructions executed within execution module may access L1 data cache to obtain data for a read or load or to store data in the L1 data cache . Although the embodiment of processor illustrated in is a single core processor other embodiments may include two four or some other number of cores. Similarly although the illustrated embodiment of processor includes an L1 instruction cache an L1 data cache and an L2 cache other embodiments of processor may include more or fewer cache elements. Embodiments of processor may include a level 3 L3 cache and in embodiments that include multiple processing cores the L3 cache may be a shared cache that is shared among the two or more processing cores.

Referring to an embodiment of a system on chip controlled reset performed by a power management IC. Embodiment depicts SoC and power management IC PMIC . SoC includes processor fuse controller and power management unit . Fuse controller is used to monitor serial analog fuses. Power management unit PMU includes an internal clock CCU ICLK a ring oscillator and a power management controller used to create a reset sequence capable of clearing contention downloading serial fuses and enabling system controllers to start running firmware. PMIC is used by SoC for managing power requirements of the system and may include XTAL . PMIC provides an initial reset signal before asserting a PWRGOOD signal to SOC to indicate the beginning of a ring oscillator calibration sequence. The real time clock RTC signal is also provided via the XTAL .

Referring now to an embodiment of a sequence of booting a system by using a ring oscillator. Embodiment depicts the booting sequence. Reference clock RTC in XTAL is used to calibrate the ring oscillator at a target frequency. PMIC a slave device controlled by the SoC detects a good battery and sends a power up signal to run the ring oscillator RO in CCU ICLK and the serial fuse RO in fuse controller . PMIC then asserts a power good signal and the signal is sent to XTAL start in the XTAL block and to start reset of a finite state machine reset fsm in PMC . XTAL start signals the RO to stop running .

Once the reset fsm start signals the enabling of the RO calibration signal in PMC the RO calibration begins in CCU ICLK . Once calibration is performed on the RO the fuse block is enabled by PMC and indication is given to proceed with executing firmware by PMC .

Referring now to one embodiment of a method of providing a controlled reset sequence. Embodiment of a method to provide a controlled reset sequence begins with running serial fuse and a ring oscillator to clear contention in block . In order to ensure proper operation for all controllers on the system a calibrated version of the ring oscillator is needed. To calibrate the ring oscillator an external reference clock is used to correct jitter and skew on the ring oscillator at a targeted frequency . Next determination is made in decision block to see if the error on the generated clock frequency is below a threshold value. If the error is not below the threshold value the flow returns to to use the external reference clock to correct jitter and skew on the ring oscillator again. If determination is made that the error on the generated clock frequency is below a threshold value the calibrated ring oscillator calibration signal is enabled provided and a fuse block is enabled . The method flow continues to proceed with executing firmware .

Embodiments may be implemented in many different system types and platforms. Referring now to an illustrated embodiment of system is a multi processor system that includes a first processor and a second processor . Although illustrates two processors other embodiments may include more or fewer processors. The illustrated embodiment of processors includes a core region and an integration region . Core region includes one or more processing cores while the illustrated embodiment of integration region includes a memory controller hub MCH a processor hub point to point interface and a processor processor point to point interface .

Processing cores may each include hardware and firmware resources not depicted to support an execution pipeline. These resources may include in some embodiments a cache memory hierarchy which may include a dedicated L1 instruction cache a dedicated L1 data cache an L2 data instruction cache or a combination thereof pre fetch logic and buffers branch prediction logic decode logic a register file various parallel execution resources including arithmetic logic units floating point units load store units address generation units a data cache and so forth.

In the illustrated embodiment in MCH supports bidirectional transfer of data between a processor and a system memory via a memory interconnection . System memory may be a double data rate DDR type dynamic random access memory DRAM while memory interconnection and MCH may comply with a DDR interface specification. System memory may represent a bank of memory interfaces or slots that may be populated with corresponding memory circuits for a desired DRAM capacity.

In the multi processor system each processor includes an MCH to communicate with a portion of system memory that is local to processor . In some embodiments system memory is local to processor and represents a portion of the system memory as a whole. In the illustrated embodiment system is a distributed memory multiprocessor system in which each processor can access each portion of system memory whether local or not. While local accesses may have lower latency accesses to non local portions of system memory are permitted.

In each processor also includes a point to point interface that supports communication of information with a point to point interface of one of the other processors via an inter processor point to point interconnection . In some embodiments processor hub point to point interconnections and processor processor point to point interconnections are distinct instances of a common set of interconnections. In other embodiments point to point interconnections may differ from point to point interconnections .

In some embodiments processors include point to point interfaces to communicate via point to point interconnections with a point to point interface of an I O hub . In the illustrated embodiment I O hub includes a graphics interface to support bidirectional communication of data with a graphics adapter via a graphics interconnection which may be implemented as a high speed serial bus e.g. a peripheral components interface express PCIe bus or another suitable bus.

The illustrated embodiment of I O hub also communicates via an interface and a corresponding interconnection with a bus bridge hub that supports various bus protocols for different types of I O devices or peripheral devices. The illustrated embodiment of bus bridge hub supports a network interface controller NIC that implements a packet switched network communication protocol e.g. Gigabit Ethernet a sound card or audio adapter and a low bandwidth bus e.g. low pin count LPC I2C Industry Standard Architecture ISA to support legacy interfaces referred to herein as desktop devices that might include interfaces for a keyboard mouse serial port parallel port and a removable media drive and may further include an interface for a nonvolatile memory NVM device such as flash ROM . The illustrated embodiment of low bandwidth bus supports other low bandwidth I O devices e.g. keyboard mouse and touchscreen controller . Storage protocol bus e.g. serial AT attachment SATA small computer system interface SCSI supports persistent storage devices including conventional magnetic core hard disk drives HDD . HDD is illustrated as including code which may represent processor executable instructions including operating system instructions application program instructions and so forth that when executed by the processor cause the processor to perform operations described herein.

The illustrated embodiment of system also includes an HDD like semiconductor based storage resource referred to as solid state drive SDD and a general purpose serial communication bus e.g. USB PCI PCIe to support various devices. Although specific instances of communication busses and bus targets have been illustrated and described other embodiments may employ different communication busses and different target devices.

In HDD is illustrated as including code which may represent processor executable instructions including operating system instructions application program instructions and so forth that when executed by the processor cause the processor to perform operations described herein. HDD uses storage protocol bus as an interface with bus bridge hub .

In code may also include a sensor application programming interface API which provides application program access to one or more sensors not depicted that may be included in system . Sensors that system might have in some embodiments include an accelerometer a global positioning system GPS device a gyro meter an inclinometer and a light sensor. Resume module may be implemented as software that when executed performs operations for reducing latency when transitioning system from a power conservation state to an operating state. Resume module may work in conjunction with solid state drive SSD to reduce the amount of SSD storage required responsive to system entering a power conservation mode. Resume module may in some embodiments flush standby and temporary memory pages before transitioning to a sleep mode. By reducing the amount of system memory space that system is required to preserve upon entering a low power state resume module beneficially reduces the amount of time required to perform the transition from the low power state to an operating state. Connect module may include software instructions that when executed perform complementary functions for conserving power while reducing the amount of latency or delay associated with traditional wake up sequences. In some embodiments connect module may periodically update certain dynamic applications including email and social network applications so that when system wakes from a low power mode the applications that are often most likely to require refreshing are up to date. In the illustrated embodiment the inclusion of touchscreen support in conjunction with support for communication devices enable system to provide features traditionally found in dedicated tablet devices as well as features found in dedicated laptop and desktop type systems.

Referring now to a representation for simulation emulation and fabrication of a design implementing the disclosed techniques is illustrated. Data representing a design may represent the design in a number of manners. First as is useful in simulations the hardware may be represented using a hardware description language or another functional description language which basically provides a computerized model of how the designed hardware is expected to perform. The hardware model may be stored in a storage medium such as a computer memory so that the model may be simulated using simulation software that applies a particular test suite to the hardware model to determine if it indeed functions as intended. In some embodiments the simulation software is not recorded captured or contained in the medium.

Additionally a circuit level model with logic and or transistor gates may be produced at some stages of the design process. This model may be similarly simulated sometimes by dedicated hardware simulators that form the model using programmable logic. This type of simulation taken a degree further may be an emulation technique. In any case re configurable hardware is another embodiment that may involve a tangible machine readable medium storing a model employing the disclosed techniques.

Furthermore most designs at some stage reach a level of data representing the physical placement of various devices in the hardware model. In the case where conventional semiconductor fabrication techniques are used the data representing the hardware model may be the data specifying the presence or absence of various features on different mask layers for masks used to produce the integrated circuit. Again this data representing the integrated circuit embodies the techniques disclosed in that the circuitry or logic in the data can be simulated or fabricated to perform these techniques.

In any representation of the design the data may be stored in any form of a tangible machine readable medium. An optical or electrical wave modulated or otherwise generated to transmit such information a memory or a magnetic or optical storage such as a disc may be the tangible machine readable medium. Any of these mediums may carry the design information. The term carry e.g. a tangible machine readable medium carrying information thus covers information stored on a storage device or information encoded or modulated into or on to a carrier wave. The set of bits describing the design or the particular part of the design are when embodied in a machine readable medium such as a carrier or storage medium an article that may be sold in and of itself or used by others for further design or fabrication.

To the maximum extent allowed by law the scope of the present disclosure is to be determined by the broadest permissible interpretation of the following claims and their equivalents and shall not be restricted or limited to the specific embodiments described in the foregoing detailed description.

