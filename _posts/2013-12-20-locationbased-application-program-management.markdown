---

title: Location-based application program management
abstract: Methods, program products, and systems for location-based application program management are described. A mobile device can receive a first application program to be executed in an application subsystem. The first application program can be configured to be invoked or notified when the mobile device is located at a defined location. The mobile device can register the first application program to a second application program that executes in a baseband subsystem. The mobile device can set the application subsystem to a power-saving operating mode. The second application program can monitor a current location of the mobile device. When the mobile device is currently located at the defined location, the second application program can set the application subsystem to an active operating mode, and invoke the first application program.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09210529&OS=09210529&RS=09210529
owner: Apple Inc.
number: 09210529
owner_city: Cupertino
owner_country: US
publication_date: 20131220
---
This application is a divisional of and claims priority to U.S. patent application Ser. No. 12 755 802 filed on Apr. 7 2010 the entire contents of which are hereby incorporated by reference.

A modern mobile device can incorporate functions of a computer of a cellular transceiver or a wireless e.g. WiFi transceiver. For example the mobile device can perform traditional computer functions such as executing application programs storing various data and displaying digital images. These functions can be performed in an application subsystem of the mobile device. The application subsystem can include an application processor an application operating system and various input output devices.

When the mobile device functions as a cellular transceiver the mobile device can initiate and receive phone calls send and receive data over a cellular network identify cellular tower connections and determine when and whether to switch cellular towers. Similarly the mobile device can function as a wireless radio transceiver and send and received data over a wireless network e.g. a WiFi network. These radio related functions can be performed in a baseband subsystem of the mobile device. The baseband subsystem can include a baseband processor and a baseband operating system. The baseband processor can be an integrated circuit IC device e.g. a Large Scale Integrated Circuit LSI that performs communication functions. The baseband processor can include for example a Global System for Mobile Communications GSM modem. The baseband processor can be can be integrated with the application processor in a System on Chip SoC . In general the application subsystem can consume more power than the baseband subsystem when activated.

Methods program products and systems for location based application program management are disclosed. In general in one aspect a mobile device can receive a first application program to be executed in an application subsystem. The first application program can be configured to be invoked when the mobile device is located inside a defined geographic region. The mobile device can register the first application program to a second application program that executes in a baseband subsystem. The mobile device can set the first application program or the application subsystem or both to a power saving operating mode. The second application program can monitor a current location of the mobile device. When the mobile device is currently located inside the defined geographic region the second application program can invoke or notify the first application program.

In another aspect the mobile device can be used to configure the first application program and the second application program through various configuration application programming interfaces APIs . A method for configuring a geographic region to be associated with the first application is disclosed. The method can include receiving a request for configuring the geographic region the geographic region to be associated with the first application program the first application program to be invoked when the mobile device enters the geographic region and responsive to the request configuring the geographic region through an application programming interface the configuring including specifying one or more first call parameters according to a first calling convention defined by the application programming interface where at least one of the first call parameters specifies a centroid of the geographic region.

In another aspect the mobile device can provide various location monitoring APIs. A method for monitoring a location of the mobile device is disclosed. The method can include receiving a request for invoking the first application program on the mobile device the request specifying that the first application program is to be invoked when the mobile device has crossed a boundary into a geographic region responsive to the request monitoring a location of the mobile device through an application programming interface the monitoring including specifying one or more first call parameters according to a first calling convention defined by the application programming interface where at least one first call parameter specifies the geographic region and determining whether the mobile device has entered the geographic region upon determining that the mobile device has entered the geographic region invoking the application program on the mobile device through the API according to a second calling convention defined by the API including specifying one or more second call parameters where at least one second call parameter specifies the geographic region.

The details of one or more implementations of location based application program management are set forth in the accompanying drawings and the description below. Other features aspects and advantages of location based application program management will become apparent from the description the drawings and the claims.

Box A represents a state state A of mobile device when configuring location based application program . In state A both application subsystem and baseband subsystem can be in an active mode where application subsystem is processing an application and baseband subsystem is processing communications information. Mobile device can acquire application program that executes in application subsystem by downloading e.g. from server through communications network by copying from a storage device e.g. a flash memory card or by creating application program locally e.g. by writing source code on mobile device and compiling and linking the source code .

In state A application program can be configured to be invoked or notified when mobile device is located in a particular geographic region e.g. geographic region . Invoking application program can include loading application program from a storage device to active memory e.g. random access memory RAM of application subsystem and executing the loaded program. Parameters e.g. geographic coordinates can be passed to application program upon invocation. Notifying application program can include locating application program that has already been loaded into memory by identifying a process of application program using a process identifier PID . The process before notification can be in a background mode e.g. without interacting with user through a user interface . The notification can bring the process to the foreground e.g. by presenting a user interface . Alternatively the notification can comprise an interrupt or other event that can cause the execution of an already loaded application program to be altered even if the program is already in a foreground mode.

Configuring application program to be invoked or notified in a geographic region can include defining the geographic region and defining various ways to detect that mobile device has entered the geographic region. Mobile device enters the geographic region if mobile device at least partially crosses a boundary or geofence surrounding the geographic region. Once an entrance is detected application program can be invoked or notified. Likewise once a departure from the geographic region application program can be terminated or set to be executed as a background process.

Configuring application program to be invoked or notified in a geographic region can occur on mobile device or on server . In some implementations a user can define a geographic region on mobile device by drawing boundaries of the geographic region using a finger or a pointing device e.g. a stylus on a digital map displayed on a touch sensitive display screen of mobile device . Additionally or alternatively the user can define a region by defining a center and a radius. The center can be a centroid of the region defined by tapping a particular point on the digital map or by designating a current location of mobile device which can be determined by a global positioning system GPS receiver coupled to mobile device .

The user can specify various ways to detect that mobile device has entered or exited the geographic region. For example the user can specify that the detection can be achieved using wireless access gateways including cellular towers access points of wireless local area networks WLAN or both. To do so mobile device can submit coordinates of the geographic region to server and acquire from server information on wireless access gateways associated with the geographic region.

In some implementations mobile device can submit request to server through network . Request can include geographic coordinates of the region. The geographic coordinates can include latitude longitude and optionally altitude that can be expressed as a unit of length e.g. meters or feet above or below sea level. The latitude longitude and altitude can be associated with the center or centroid of the geographic region defined. Request can also include a radius.

In some implementations the geographic region can be represented by a polygon having multiple vertices. Request can include latitudes longitudes and optionally altitudes of the vertices of the geographic region that the user drew on the digital map.

In some implementations request can request information on a need to know basis. Request can include information on a coarse current location of mobile device e.g. a location area code LAC that is current to mobile device . The information can be used to limit the amount of information transferred from server to mobile device . Only information relevant to the coarse current location is sent from server to mobile device .

Using request received from mobile device server can identify one or more wireless access gateways e.g. wireless access gateway that correspond to the geographic region. A wireless access gateway e.g. wireless access gateway can correspond to a geographic region e.g. geographic region when it can be determined with sufficient certainty that mobile device is located in the geographic region when mobile device is within a communication range of the access gateway. For example wireless access gateway can correspond to geographic region when wireless signals sent from mobile device can be received by wireless access gateway with sufficient signal to noise ratio.

In some implementations server can provide identifiers to mobile device even when request contains no geographic coordinates. Instead of geographic coordinates request can include an identifier of application program . Some application programs can be associated with geographic regions designated by a developer. For example a surfing information application program can be pre configured to correspond to various beach areas. Upon receiving a request from mobile device server can identify the pre configured information on the geographic region as well as the wireless access gateways that are associated with application program .

Server can send identifiers of the one or more identified wireless access gateways to mobile device . Mobile device can register identifiers of the identified wireless access gateways with a second application program e.g. location monitoring program . Location monitoring program can execute in baseband subsystem . Registering identifiers with location monitoring program can include storing identifier in association with an identifier of application program . The identifier of application program can include for example a process identifier or a path to application program or both.

In some implementations identifiers can include only identifiers that mobile device needs to know. The identifiers can be a subset of identifiers of all wireless access gateways associated with a geographic region e.g. geographic region . Geographic region can be sufficiently large that multiple wireless access gateways are encompassed. For example geographic region can be a city or a state that includes multiple location areas of a cellular network each location area being represented by a location area code LAC and including multiple cell towers. Identifiers can include cell identifiers cell IDs that are located within a current location area of mobile device . When mobile device moves to another location area mobile device can send a new request to server . The new request can include a new LAC. In response to the request server can send to mobile device identifiers of wireless access gateways e.g. cell IDs located in the new location area.

Box B represents a state state B of mobile device after a period of idling. In state B application subsystem can be in a power saving mode. Generally application subsystem can consume more power than baseband subsystem when operating in active mode. To conserve battery power of mobile device application subsystem can be set to a power saving mode e.g. standby mode or sleep mode after a period of idling e.g. one minute . In the power saving mode non essential components of application subsystem can be temporarily suspended. For example an image of volatile memory if any can be cached on non volatile storage device and power supply to the volatile memory can be switched off. Non essential parts of the core of the application processor can be turned off. The clock of the processor can be slowed down.

In state B baseband subsystem can continue to operate in active mode while application subsystem is operating in the power saving mode. Location monitoring program can continue to execute in baseband subsystem as a daemon e.g. as a background process without requiring input from application program or from a user . Location monitoring program can monitor a current location of mobile device continuously or intermittently. For example location monitoring program can monitor current wireless access gateways that are within communication range of mobile device location of mobile device . Location monitoring program can compare identifiers of these gateways with identifiers of wireless access gateways that are registered by application program .

Box C represents a state state C of mobile device when mobile device moves within communication range of wireless access gateway . Location monitoring program can detect an identifier of wireless access gateway that identifies a cell tower e.g. a cell ID . Location monitoring program can determine that the detected identifier matches an identifier associated with application program . In some implementations a location monitoring program can detect a media access control MAC address that identifies an access point to a wireless local area network. A set of one or more MAC addresses can be associated with application program . The location monitoring program can determine that a sufficient number of detected MAC addresses match some or all MAC addresses in the set. For example the location monitoring program can determine that at least a threshold number e.g. three or a threshold percentage e.g. 50 of the MAC addresses in the set are located within communication range of mobile device . The location monitoring program that can detect the MAC addresses can be implemented in application subsystem baseband subsystem or a wireless communications subsystem.

In state C location monitoring program can wake or activate application subsystem by setting application subsystem to active mode if application subsystem in currently in power saving mode . Location monitoring program can signal to application subsystem that application program is to be invoked or notified.

In some implementations the signal can include be accompanied by the identifier of the wireless access gateway found to be a match. Application subsystem can be responsible for identifying which application program to invoke or notify based on the identifier. In some implementations the signal can include or be accompanied by parameters of geographic region e.g. the center of geographic region and a current distance between mobile device and the center . The parameters can be passed to application program . In some implementations the signal can include or be accompanied by an identifier of the application program to invoke or notify e.g. a file path or process identifier .

If mobile device moves outside a geographic region where wireless gateways are registered location monitoring program can communicate with application subsystem and request re registration of wireless access gateways in a new geographic region. For example when mobile device moves to a new location area baseband subsystem can detect a new LAC. Location monitoring program can activate application subsystem and provide to application subsystem the new LAC. Application subsystem can request from server one or more cell IDs in the new LAC to be registered with baseband subsystem .

Application program can be associated with multiple and discrete geographic regions and wireless access gateways . For example a surfing information application can be associated with Montara Beach of California Sunset Beach of Hawaii and Cape Hatteras area of North Carolina. Likewise multiple application programs can be associated with a single geographic region and a single wireless access gateway . In some implementations each application program can register with its own location monitoring program and can have a separate daemon.

Location functions can communicate with location monitoring program of baseband subsystem . In some implementations location monitoring program can be exposed to location functions through API . Baseband subsystem can include baseband operating system and baseband processor .

Location functions can register one or more identifiers of wireless access gateways with location monitoring program . Identifiers of wireless access gateways can be stored in registered gateways data store . Location monitoring program can monitor a current wireless access gateway e.g. by cell ID and match information on the current wireless access gateway with identifiers of wireless access gateways in data store . If a match is found location monitoring program can pass the matched identifier to application operating system of the application subsystem .

Upon receiving the identifier of the wireless access gateway application operating system can determine which application program to invoke or notify. The determination can be make using application location mapping data store . Application location mapping data store can include mappings between application programs and corresponding identifiers wireless access gateways. For example application location mapping data store can store a file path or a PID of a surfing information program and identifiers of wireless access gateways of the various beaches associated with the surfing information program. Application location mapping data store can be populated when mobile device receives identifiers and registers the identifiers . Application location mapping data store can be updated when a process of application program changes states. Application program can execute in a foreground state or a background state and can be inactive e.g. not running at all . When application program changes from a background state to an inactive state application location mapping data store can be updated to change a PID of application program to a file path of application program . Application location mapping data store can reside on mobile device or on a server connected to mobile device through a communications network or be distributed on multiple mobile devices and servers.

Location monitoring program can include location registration module . Location registration module can receive one or more identifiers of wireless access gateways associated with an application program and store the identifiers of wireless access gateways in registered gateways data store . Registered gateways data store can reside in system memory of baseband subsystem .

Location monitoring program can include location monitor . Location monitor can communicate with baseband operating system and request and receive location information from baseband operating system . In various implementations the location information can include current cell ID current LAC current mobile country code MCC and other identifiers of access gateways of various wireless communications networks. The identifiers can be passed to location mapper which can compare the identifiers with identifiers stored in registered gateways data store . If a match is found location mapper can communicate with application operating system through application operating system interface . The communication can include various parameters that can include information for identifying an application program to be invoked e.g. the identifier of the matched access gateway .

An application program e.g. application program for a mobile device can be associated with circular region having a center O and a radius. Circular region can be geographic region as described above in reference to . The center O can be defined using coordinates including latitude and longitude. The radius can be defined in various length units meters kilometers miles nautical miles etc. Application program can be configured such that mobile device can invoke or notify application program when mobile device is located within circular region . Application program can be further configured such that mobile device can terminate or notify application program when mobile device moves out of circular region .

Circular region can be associated with tolerances. The tolerances can include an entrance tolerance and an exit tolerance. An entrance tolerance can refer to a first distance such that mobile device can invoke or notify application program when mobile device is at least that distance deep in the circular region for example when mobile device is inside circular region and is at least the distance away from circumference of circular region . Shaded area between circular region and circular region represents an area within the entrance tolerance.

An exit tolerance can refer to a second distance such that mobile device can notify or terminate application program when mobile device is at least that distance away from circular region for example when mobile device is outside of circular region and is at least the distance away from circumference of circular region . Shaded area between circular region and circular region represents an area within the exit tolerance. The entrance tolerance and the exit tolerance can be either identical or distinct from each other. In some implementations the entrance tolerance and exit tolerance can be used to describe an ambiguous zone in which behavior of application program can be determined by how deeply mobile device is located inside circular region or how far away mobile device is located outside circular region . For example an entrance tolerance can include a function that measures a depth of penetration or penetration distance into circular region . When mobile device invokes or notifies application program at a penetration distance into circular region the penetration distance or a value derived from the penetration distance can be passed to application program as a parameter. Application program can use the parameter for example to determine what content to provide to the user e.g. the deeper the penetration the more specific the content on a topic .

In exemplary surf report of Montara Beach Recreation area in Northern California is displayed on display device of mobile device . Mobile device can be for example a handheld computer a personal digital assistant a cellular telephone an electronic tablet a network appliance a camera a smart phone an enhanced general packet radio service EGPRS mobile phone a network base station a media player a navigation device an email device a game console or a combination of any two or more of these data processing devices or other data processing devices. Display device can include a multi touch sensitive screen that can receive user inputs.

Exemplary surf report can be displayed on mobile device when mobile device is located at or near Montara Beach. Mobile device can invoke or notify the crowdware application program that displays exemplary surf report when for example mobile device detects that mobile device is located within communication range of a cellular tower associated with a geographic region that corresponds to Montara beach. When the user specifies the surf venue a server e.g. server can identify the cell ID of the cellular tower from a database. Surf report can include user input button that allows a user to request more surfing information and user input button that allows a user to quit the surfing information application program.

A search bar and a bookmarks list object can be displayed at the top of surf report . Below the bottom of surf report one or more display objects can be displayed for example a search object a directions object a map view object and a current location object .

The search bar can be used to find an address or other location on the map. For example a user can enter her home address in the search bar . The bookmarks list object can for example display a Bookmarks list that contains addresses that are frequently visited such as the user s home address. The Bookmarks list can also for example contain special bookmarks such as bookmarked locations of mobile device .

Search object can be used to display search bar and other map related search menus. Directions object can for example display a menu interface that allows the user to enter a start and end location. The interface can then display information e.g. directions and travel time for a route from the start location to the end location . Map view object can display a menu that can allow the user to select display options for the crowdware application program. Current location object can allow the user to see a geographic region on a map indicating where device is currently located.

Mobile device can receive an identifier of a wireless access gateway the identifier associated with a first application program the first application program to be invoked in a first subsystem of mobile device when mobile device is located within a wireless communication range of the wireless access gateway. The first application program can be a crowdware program. The first subsystem can be an application subsystem e.g. application subsystem . The first subsystem can include application processor . In various implementations the wireless access gateway can be a wireless access point of a wireless local area network WLAN or a cellular tower. The identifier can be a MAC address a cell ID or other unique identifier that can identify the wireless access gateway.

Receiving the identifier of the wireless access gateway can optionally include receiving coordinates of a geographic region from a map input device of mobile device . The map input device can include for example the multi touch sensitive screen of display device . Mobile device can request to a server e.g. server the identifier of the wireless access gateway. The request can be made when the user has defined the geographic region or when mobile device moves from one geographic area to another triggering an update e.g. when mobile device moves from one location area of a cellular network to another location area of the cellular network . Mobile device can receive the identifier of wireless access gateway from the server the wireless access gateway having a location corresponding to the geographic region.

Mobile device can register the identifier to a second application program to be executed in a second subsystem of mobile device . The second application program can include location monitoring program . The second subsystem can be baseband subsystem . The baseband subsystem can include baseband processor . The baseband subsystem can consume less power than application subsystem when application subsystem is set to a first execution mode e.g. an active execution mode . For example application subsystem can consume power at a first power consumption level when application subsystem is set to an active execution mode. Baseband subsystem can consume power at a second power consumption level when operating. The second power consumption level can be lower than the first power consumption level.

In some implementations the second subsystem can include a wireless communications subsystem that can detect one or more MAC addresses of wireless access points that are located within a communication range of mobile device . The wireless communications subsystem can include a wireless communications operating system and a wireless communications processor. The wireless communications operating system as well as a location monitoring program can be stored as firmware on mobile device . The location monitoring program can detect changes of wireless access points that are located within a communication range of mobile device .

Optionally mobile device can set application subsystem to a second execution mode e.g. a power saving mode after registering the identifier with the second application program. The first subsystem e.g. application subsystem can consume power at a third power consumption level when the first subsystem is set to the power saving mode the third power consumption level lower than the first power consumption level.

Mobile device can monitor a current location of mobile device using the second application program. The monitoring can include determining that mobile device is located within the wireless communication range of the wireless access gateway.

Mobile device can notify the first subsystem of mobile device that mobile device is located within the wireless communication range of the wireless access gateway. Notifying the first subsystem can include setting the first subsystem to an active operating mode if the first subsystem is on a power saving operating mode at time of the notification.

Mobile device can invoke or notify the first application program using the second application program upon determining that mobile device is located within the wireless communication range of the wireless access gateway. Invoking the first application program can include. Notifying the first application program can include bringing a process of first application program from background to foreground. Optionally mobile device can display a user interface e.g. surf report of the first application program on a display device e.g. display device of mobile device once the first application program is invoked or notified.

Location monitoring program can execute in baseband subsystem of mobile device . Location monitoring program can monitor a current location of mobile device . Location monitoring program can receive a current location update from baseband operating system . The current location update can include an identifier e.g. a cell ID of a wireless access gateway e.g. a cellular tower where mobile device is located within a communication range of the wireless access gateway. The current location update can be initiated by baseband operating system .

Location monitoring program can match the identifier received from the current location update with an identifier in registered gateways data store . If a match is not found location monitoring program can continue monitoring the current location of mobile device .

If a match is found location monitoring program can determine an application identifier. The application identifier can include any information that can specify which application program is to be invoked. The information can include a process identifier a file path or the identifier of the wireless access gateway which can be used by application operating system to determine which application program is associated with this particular wireless access gateway .

Location monitoring program can inform an application subsystem upon identifying the match. Informing the application subsystem e.g. application subsystem can include setting the application subsystem to an active operating mode and invoking the application program that is associated with the identifier of the wireless access gateway.

Mobile device can receive a request for configuring a geographic region. The geographic region can be associated with an application program e.g. application program . The application program can be invoked when mobile device enters the geographic region. The region can be defined on a digital map. The geographic region can be represented by an object having a Region class. In some implementations the Region class can be used to describe arbitrary shapes. In particular the Region class can be used to define a circle that has a center and a radius.

Mobile device can configure the geographic region through an API the configuring including specifying one or more first call parameters according to a first calling convention defined by the API where at least one first call parameter specifies a center of the geographic region. Configuration can occur responsive to the request. Pseudo code for an interface for initializing an exemplary Region object that represents a circular geographic region is listed below in listing 1 .

When initialized in an application program e.g. application program an object of the Region class a Region object can be given a unique region identifier RegionID . The RegionID can be passed to the application program when mobile device crosses a boundary of the geographic region defined in the Region object. The application program can use the RegionID to remove the Region object.

The parameter center of listing 1 can include coordinates of a central location of the geographic region. The parameter radius can be a distance from the central location where a geographic fence e.g. a boundary can be placed. In some implementations if mobile device moves from with the region to more that radius from the center the application program can generate a notification by using a LocationManager object.

The identifier parameter can include a description for the geographic region that can be displayed to a user e.g. in a preferences user interface or in an alert message. In some implementations the identifier parameter of listing 1 can be chosen by a user of the API. If nil is passed for the identifier parameter mobile device can reverse geocode the Region object e.g. naming the Region object by using the coordinates in the center parameter as the identifier . Mobile device can assign a prefix or a suffix to the reverse geocoded identifier to generate a unique and user readable identifier.

The type Coordinates of listing 1 can include a type for two dimensional coordinates Coordinates2D and a type for three dimensional coordinates Coordinates3D . The type for two dimensional coordinates can be defined as including a latitude and a longitude. The type for three dimensional coordinates can include a latitude a longitude and an altitude. The type Distance can be a double type.

In some implementations configuring the geographic region further includes determining a monitoring threshold including specifying at least one second call parameters according to a second calling convention defined by the API where at least one second call parameter specifies a communication range of the mobile device. Pseudo code for an interface for making the determination is listed below in listing 2 .

The DEVICE VERSION parameter can identify a version of hardware of mobile device . The BASEBAND OS VERSION parameter can identify a version of baseband operating system of mobile device . Together the DEVICE VERSION parameter and the BASEBAND OS VERSION parameter can determine a monitoring range of mobile device . In some implementations if an attempt to register a geographic region larger than the communication range an error message can be provided.

Mobile device can monitor a current location of mobile device . To monitor the current location mobile device can determine whether region monitoring is available on mobile device . Pseudo code for an interface for making the determination is listed below in listing 3 .

The DEVICE VERSION parameter can identify a version of hardware of mobile device . The BASEBAND OS VERSION parameter can identify a version of baseband operating system of mobile device .

To monitor the current location mobile device can further determine whether region monitoring is enabled on mobile device . Pseudo code for an interface for making the determination is listed below in listing 4 .

Mobile device can check whether region monitoring is enabled before calling other region monitoring APIs. If a function of listing 4 returns NO and other region monitoring APIs are called mobile device can prompt a user using a confirmation panel asking whether region monitoring service is to be enabled.

Pseudo code of an interface for starting and stopping monitoring are provided below in listings 5 and 6 respectively.

A tolerance can be set for monitoring. The tolerance can represent a distance past a border of the geographic region. If mobile device reaches the distance application program can be notified that the region border has been crossed e.g. mobile device has entered or left the geographic region . The tolerance can be useful to prevent repeated notifications when mobile device is located on or near the border of the geographic region. Pseudo code for an interface for making the determination is listed below in listing 7 .

For example if the tolerance is set to 100 meters application program can be invoked or notified if application program is already being executed when mobile device moves 100 meters inside the geographic region. The tolerance value can be honored on a best effort basis and can be overwritten if 

 A The tolerance value is large compared to a size of the region. In such cases mobile device can overwrite the tolerance value to ensure that notifications or invocations can be generated when mobile device enters the region or

 B Mobile device fails to provide a precision with respect to the location of mobile device e.g. due to poor quality of signal etc. .

Mobile device can determine that mobile device has entered or exited the geographic region based on the monitoring. Determining that mobile device has entered the geographic region can include determining that a current distance between mobile device and the center is smaller than the radius. Pseudo code of an interface for determining whether a location is inside a region is listed below in listing 8 .

In listing 8 the coordinates parameter represents the geographic coordinates of the location. The containsCoordinate function can be a method associated with a Region class. The function can be used for example for verifying that mobile device is located in a particular geographic region when application operating system receives a notification or an invocation request from baseband subsystem . The coordinates parameter can be coordinates of a current location of mobile device acquired through a GPS component of mobile device .

Mobile device can invoke or notify application program upon determining that mobile device entered or exited the geographic region. Pseudo code of interfaces of methods to be invoked when mobile device enters or exits the geographic region is listed below in listings 9 and 10 respectively.

Mobile device can receive a request for invoking or notifying application program on mobile device . The request can specify that application program is to be invoked or notified when mobile device crosses a geofence into a geographic region. Responsive to the request mobile device can monitor a location of mobile device through an API. Monitoring the location can include specifying one or more first call parameters according to a first calling convention defined by the API where at least one first call parameter specifies the geographic region. At least one first call parameter can specify a tolerance distance mobile device crossing the boundary into the geographic region if mobile device is at least the tolerance distance deep into the geographic region.

Monitoring the location can also include determining whether mobile device has entered the geographic region. Determining whether mobile device has entered the geographic region can include determining whether mobile device has entered the geographic region through the API including specifying one or more third call parameters according to a third calling convention defined by the API wherein at least one third call parameter specifies coordinates of a current location of mobile device .

Upon determining that mobile device has entered the geographic region mobile device can invoke or notify application program on mobile device through the API according to a second calling convention defined by the API. Mobile device can specify one or more second call parameters where at least one second call parameter specifies the geographic region.

Optionally once application program is invoked or notified mobile device can display a user interface of application program on a display device e.g. display device .

Mobile device can receive a request for terminating application program on mobile device upon detecting that mobile device has exited the geographic region. Responsive to the request mobile device can monitor a location of mobile device through the API the monitoring including specifying one or more fourth call parameters according to a fourth calling convention defined by the API where at least one fourth call parameter specifies the geographic region. Upon detecting that mobile device has exited the geographic region based on the monitoring mobile device can terminate application program on mobile device .

Sensors devices and subsystems can be coupled to peripherals interface to facilitate multiple functionalities. For example motion sensor light sensor and proximity sensor can be coupled to peripherals interface to facilitate orientation lighting and proximity functions of the mobile device. Location processor e.g. GPS receiver can be connected to peripherals interface to provide geopositioning. Electronic magnetometer e.g. an integrated circuit chip can also be connected to peripherals interface to provide data that can be used to determine the direction of magnetic North. Thus electronic magnetometer can be used as an electronic compass. Accelerometer can also be connected to peripherals interface to provide data that can be used to determine change of speed and direction of movement of the mobile device.

Camera subsystem and an optical sensor e.g. a charged coupled device CCD or a complementary metal oxide semiconductor CMOS optical sensor can be utilized to facilitate camera functions such as recording photographs and video clips.

Communication functions can be facilitated through one or more wireless communication subsystems which can include radio frequency receivers and transmitters and or optical e.g. infrared receivers and transmitters. The specific design and implementation of the communication subsystem can depend on the communication network s over which a mobile device is intended to operate. For example a mobile device can include communication subsystems designed to operate over a GSM network a GPRS network an EDGE network a Wi Fi or WiMax network and a Bluetooth network. In particular the wireless communication subsystems can include hosting protocols such that the mobile device can be configured as a base station for other wireless devices.

Audio subsystem can be coupled to a speaker and a microphone to facilitate voice enabled functions such as voice recognition voice replication digital recording and telephony functions.

I O subsystem can include touch screen controller and or other input controller s . Touch screen controller can be coupled to a touch screen or pad. Touch screen and touch screen controller can for example detect contact and movement or break thereof using any of a plurality of touch sensitivity technologies including but not limited to capacitive resistive infrared and surface acoustic wave technologies as well as other proximity sensor arrays or other elements for determining one or more points of contact with touch screen .

Other input controller s can be coupled to other input control devices such as one or more buttons rocker switches thumb wheel infrared port USB port and or a pointer device such as a stylus. The one or more buttons not shown can include an up down button for volume control of speaker and or microphone .

In one implementation a pressing of the button for a first duration may disengage a lock of the touch screen and a pressing of the button for a second duration that is longer than the first duration may turn power to mobile device on or off. The user may be able to customize a functionality of one or more of the buttons. The touch screen can for example also be used to implement virtual or soft buttons and or a keyboard.

In some implementations mobile device can present recorded audio and or video files such as MP3 AAC and MPEG files. In some implementations mobile device can include the functionality of an MP3 player such as an iPod . Mobile device may therefore include a pin connector that is compatible with the iPod. Other input output and control devices can also be used.

Memory interface can be coupled to memory . Memory can include high speed random access memory and or non volatile memory such as one or more magnetic disk storage devices one or more optical storage devices and or flash memory e.g. NAND NOR . Memory can store operating system such as Darwin RTXC LINUX UNIX OS X WINDOWS or an embedded operating system such as VxWorks. Operating system may include instructions for handling basic system services and for performing hardware dependent tasks. In some implementations operating system can include a kernel e.g. UNIX kernel .

Memory may also store communication instructions to facilitate communicating with one or more additional devices one or more computers and or one or more servers. Memory may include graphical user interface instructions to facilitate graphic user interface processing sensor processing instructions to facilitate sensor related processing and functions phone instructions to facilitate phone related processes and functions electronic messaging instructions to facilitate electronic messaging related processes and functions web browsing instructions to facilitate web browsing related processes and functions media processing instructions to facilitate media processing related processes and functions GPS Navigation instructions to facilitate GPS and navigation related processes and instructions camera instructions to facilitate camera related processes and functions magnetometer data and calibration instructions to facilitate magnetometer calibration. The memory may also store other software instructions not shown such as security instructions web video instructions to facilitate web video related processes and functions and or web shopping instructions to facilitate web shopping related processes and functions. In some implementations the media processing instructions are divided into audio processing instructions and video processing instructions to facilitate audio processing related processes and functions and video processing related processes and functions respectively. An activation record and International Mobile Equipment Identity IMEI or similar hardware identifier can also be stored in memory . Memory can include location instructions that can be used to transmit a current location to an access point and to determine an estimated current location based on location data associated with access points to which the mobile device is within a communication range.

Each of the above identified instructions and applications can correspond to a set of instructions for performing one or more functions described above. These instructions need not be implemented as separate software programs procedures or modules. Memory can include additional instructions or fewer instructions. Furthermore various functions of the mobile device may be implemented in hardware and or in software including in one or more signal processing and or application specific integrated circuits.

In some implementations both voice and data communications can be established over wireless network and the access device . For example mobile device can place and receive phone calls e.g. using voice over Internet Protocol VoIP protocols send and receive e mail messages e.g. using Post Office Protocol 3 POP3 and retrieve electronic documents and or streams such as web pages photographs and videos over wireless network gateway and wide area network e.g. using Transmission Control Protocol Internet Protocol TCP IP or User Datagram Protocol UDP . Likewise in some implementations the mobile device can place and receive phone calls send and receive e mail messages and retrieve electronic documents over the access device and the wide area network . In some implementations mobile device or can be physically connected to the access device using one or more cables and the access device can be a personal computer. In this configuration mobile device or can be referred to as a tethered device.

Mobile devices and can also establish communications by other means. For example wireless device can communicate with other wireless devices e.g. other mobile devices or cell phones etc. over the wireless network . Likewise mobile devices and can establish peer to peer communications e.g. a personal area network by use of one or more communication subsystems such as the Bluetooth communication devices. Other communication protocols and topologies can also be implemented.

The mobile device or can for example communicate with one or more services and over the one or more wired and or wireless networks. For example one or more location registration services can determine one or more identifiers of wireless access gateways associated with a geographic region and provide the one or more identifiers to mobile devices for registration in association with a baseband subsystem.

Crowdware service can for example provide location based API such that users of mobile device can develop location based application programs The application programs e.g. application program can be provided for download to mobile device .

Mobile device or can also access other data and content over the one or more wired and or wireless networks. For example content publishers such as news sites Really Simple Syndication RSS feeds web sites blogs social networking sites developer networks etc. can be accessed by mobile device or . Such access can be provided by invocation of a web browsing function or application e.g. a browser in response to a user touching for example a Web object.

A number of implementations of the invention have been described. Nevertheless it will be understood that various modifications can be made without departing from the spirit and scope of the invention. For example cells in a communication network are represented as hexagons in the figures. The actual shape of a cell can vary.

