---

title: Systems and methods for automated voxelation of regions of interest for magnetic resonance spectroscopy
abstract: A system and method for automating an appropriate voxel prescription in a uniquely definable region of interest (ROI) in a tissue of a patient is provided, such as for purpose of conducting magnetic resonance spectroscopy (MRS) in the ROI. The dimensions and coordinates of a single three dimensional rectilinear volume (voxel) within a single region of interest (ROI) are automatically identified. This is done, in some embodiments by: (1) applying statistically identified ROI search areas within a field of view (FOV); (2) image processing an MRI image to smooth the background and enhance a particular structure useful to define the ROI; (3) identifying a population of pixels that define the particular structure; (4) performing a statistical analysis of the pixel population to fit a 2D model such as an ellipsoid to the population and subsequently fit a rectilinear shape within the model; (5) repetiting elements (1) through (4) using multiple images that encompass the 3D ROI to create a 3D rectilinear shape; (6) a repetition of elements (1) through (5) for multiple ROIs with a common FOV. A manual interface may also be provided, allowing for override to replace by manual prescription, assistance to identify structures (e.g. clicking on disc levels), or modifying the automated voxel (e.g. modify location, shape, or one or more dimensions).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09280718&OS=09280718&RS=09280718
owner: Nocimed, LLC
number: 09280718
owner_city: Redwood City
owner_country: US
publication_date: 20130314
---
This application is a continuation in part of PCT International Patent Application Number PCT US2011 062137 Publication Number WO 2012 071566 filed Nov. 23 2011 and titled SYSTEMS AND METHODS FOR AUTOMATED VOXELATION OF REGIONS OF INTEREST FOR MAGNETIC RESONANCE SPECTROSCOPY which claims the benefit of U.S. Provisional Patent Application No. 61 417 182 filed Nov. 24 2010 and titled SYSTEMS AND METHODS FOR AUTOMATED VOXELATION OF REGIONS OF INTEREST FOR SINGLE VOXEL MAGNETIC RESONANCE SPECTROSCOPY. The entirety of each of these related priority patent applications is hereby incorporated by reference and made a part of this specification for all that it discloses.

The following disclosures are hereby incorporated by reference in their entirety and made a part of this specification for all that they disclose U.S. Patent Publication No. 2008 0039710 filed Jul. 27 2007 and titled SYSTEM AND METHODS USING NUCLEAR MAGNETIC RESONANCE NMR SPECTROSCOPY TO EVALUATE PAIN AND DEGENERATIVE PROPERTIES OF TISSUE U.S. Patent Publication No. 2009 0030308 filed Mar. 21 2008 and titled SYSTEM COMPOSITION AND METHODS FOR LOCAL IMAGING AND TREATMENT OF PAIN International Patent Publication No. WO 2009 148550 filed May 29 2009 and titled BIOMARKERS FOR PAINFUL INTERVERTEBRAL DISCS AND METHODS OF USE THEREOF U.S. Patent Publication No. 2011 0087087 filed Oct. 14 2009 and titled MR SPECTROSCOPYSYSTEM AND METHOD FOR DIAGNOSING PAINFUL AND NON PAINFUL INTERVERTEBRAL DISCS and International Patent Publication No. WO 2011 047197 filed Oct. 14 2010 and titled MR SPECTROSCOPY SYSTEM AND METHOD FOR DIAGNOSING PAINFUL AND NON PAINFUL INTERVERTEBRAL DISCS .

The present disclosure relates to segmentation of electronic images to specific regions of interest in a field of view such as for example tissue structures in medical imaging and also for improvements to clinical magnetic resonance spectroscopy MRS for example to single or multi voxel MRS and also to the automated prescription of voxels within regions of interest where MRS is to be performed such as for example in intervertebral discs.

Conventional systems and methods for prescribing voxel size and position within a region of interest ROI for magnetic resonance spectroscopy MRS applications involve manual techniques by an operator technician working from magnetic resonance imaging MRI images taken prior to the prescription operation. This standard approach suffers from various drawbacks. These include for example but without limitation 1 limitations in the ability to accurately define the ROI boundaries within which the voxel should be fit and 2 drawbacks from manual prescription such as a time required to perform the prescription under time constraints of an overall exam and b achieving optimal trade off between i maximizing voxel volume within the ROI for maximum signal noise ratio SNR and ii confining the voxel within only the ROI boundaries and avoiding overlap with adjacent tissues outside of the ROI which can potentially blend chemical information between tissue constituents within the ROI and extraneous constituents outside of the ROI into the acquired spectra and thus potentially compromise diagnostic interpretation and results.

In addition diagnostic imaging exams are typically reliant upon a fixed positioning of the patient during the exam and may be compromised by patient motion during the image acquisition. This also directly applies for example but without limitation to MRS exams. In particular an accurate voxel prescription which aligns the region for MRS data acquisition to an ROI will become mis registered with that tissue ROI if the patient moves after the prescription but before completion of the image acquisition. The information acquired may blur pre and post motion information during the image acquisition process and or may introduce chemical information from tissues which originally were extraneous to the voxel location but due to the motion were introduced into the voxel location due to moving the anatomy relative to the fixed voxel.

These issues represent particularly poignant challenges for conducting MRS in musculoskeletal applications in particular skeletal joints and still more particularly intervertebral discs. This is also especially for example the case in settings where but without limitation target tissue ROIs have limited volumes requiring maximum voxel volume to achieve sufficient SNR and are located adjacent to other tissues e.g. next to or between bones such as for example in skeletal joints with dramatically different chemical constituents than the ROI and thus could introduce significant unintended chemical signatures into acquired spectra if there is voxel overlap outside the ROI or due to patient motion during an exam.

In the particularly unique setting of intervertebral discs the disc tissues are bordered by opposite end plates of superior and inferior vertebral bodies in addition to laterally by a number of different tissue structures e.g. spinal canal . These introduce dramatically higher contents of lipid in the case of bony structures and water e.g. in the case of spinal canal than in the disc itself. Moreover the discs are relatively small for conventional MRS voxel purposes. This is further confounded by prevalent disease conditions where diagnostic imaging and MRS in particular may often be indicated such as degenerative disc disease that are specifically characterized by abnormally reduced disc height and volume as well as dehydration and dessication of the disc tissue. These issues represent a landscape that is more challenging for defining e.g. segmenting the disc material ROI from surrounding structures such as for example for diagnostic image analysis or to define regions for directed therapies. In particular context of MRS they also represent an environment for inherently low SNR and accordingly require maximum possible voxel volume to be prescribed. Furthermore the relatively small geographies and close proximities of discs relative to their bordering tissues heightens the risks and potential impact of patient motion during a disc related imaging exam such as especially but not limited to disc MRS exams.

These issues noted above are uniquely implicated in the ability to successfully perform single voxel spectroscopy in skeletal joints and especially intervertebral discs though they also relate to multi voxel spectroscopy and other imaging considerations MR related or otherwise and other tissue structures.

The current disclosure includes among other aspects certain solutions which address and overcome one or more of issues noted above. While such solutions are herein presented as uniquely tailored and beneficial for addressing the specific challenges relative to particular anatomies and related considerations they will also be applicable and present benefits elsewhere in other anatomies and or indications or purposes.

Accordingly certain aspects of this disclosure provide and address and overcome a need for a reliable automated system and method for segmenting target tissue regions of interest ROIs from medical diagnostic images.

Other aspects of this disclosure provide and address and overcome a need for a reliable automated system and method for prescribing a voxel in an ROI for magnetic resonance spectroscopy MRS applications.

Still other aspects of this disclosure provide and address and overcome a need for a reliable automated system and method for identifying patient motion during an imaging exam.

Specific modes of these aspects are in particular tailored and suitable for providing beneficial use in without limitation skeletal joints and in particular connective tissue regions between bones of such joints and in particular intervertebral discs.

The disclosed systems and methods also provide useful beneficial solutions for other applications including for example but not limited to image data post processing and analysis e.g. quantification directed therapies targeting tissue ROIs defined by such segmentation patient motion assessment during an imaging exam and potentially including dynamic adjustment of the imaging parameters and single and multi voxel MRS including without limitation automated voxel prescription .

Various embodiments disclosed in the present disclosure relate to systems and methods for locating analyzing or otherwise obtaining information relating to a region of interest related to an electronic image and real world spatial coordinates represented by such images . Various embodiments relate to automated voxelation of regions of interest for single or multi voxel magnetic resonance spectroscopy. Various features are described below and can be used in various combinations with each other. Many combinations of the features described below will be apparent which are not specifically discussed and are a part of this disclosure as would be apparent to one of ordinary skill.

One aspect of the present disclosure includes one or more computer readable media comprising computer instructions configured to cause one or more computer processors to perform actions comprising 

According to one mode of the present disclosure the electronic image comprises a magnetic resonance imaging MRI image.

According to one mode of the present disclosure selecting image coordinates comprises selecting a two dimensional shape that covers a selected area of the region of interest when converted to world coordinates.

According to one mode of the present disclosure selecting image coordinates comprises calculating a two dimensional model that approximates the region of interest based on the population of pixels.

According to one embodiment of the present disclosure calculating the two dimensional model comprises applying an expectation maximization algorithm for estimating parameters of one or more Gaussian distributions for the population of pixels.

According to one embodiment of the present disclosure the computer instructions are configured to cause the one or more computer processors to position a two dimensional shape based on the two dimensional model to cover a selected area of the region of interest.

According to one mode of the present disclosure the computer instructions are further configured to cause the one or more computer processors to output information relating to the region of interest based on the world coordinates the information comprising one or more of a location an orientation a shape an area and a volume of the region of interest.

According to one mode of the present disclosure the computer instructions are configured to cause the one or more computer processors to perform additional actions comprising 

According to one embodiment of the present disclosure the electronic images are of slices substantially parallel to and spaced apart from each other.

According to one embodiment of the present disclosure the world coordinates define a three dimensional selected volume of the region of interest.

According to one variation of the present disclosure the computer readable media is configured to be used with a magnetic resonance spectroscopy MRS system in communication with the one or more computer processors wherein the MRS system is configured to provide an MRS spectrum of chemical constituents within the three dimensional selected volume.

According to one variation of the present disclosure the computer instructions are further configured to cause the one or more computer processors to analyze a post acquisition scan to determine whether the region of interest moved during an MRS acquisition.

According to one variation of the present disclosure the region of interest is a nucleus of an intervertebral disc of a spine.

According to one variation of the present disclosure the computer instructions are configured to analyze the MRS spectrum and to determine whether the three dimensional selected volume was likely mis prescribed based on one or more signals.

According to one variation of the present disclosure the one or more signals comprise a lipid signal.

According to one variation of the present disclosure the computer instructions are configured to provide a single three dimensional scan volume to the MRS system configured for single voxel MRS.

According to one variation of the present disclosure the computer instructions are configured to cause the one or more computer processors to select multiple three dimensional volumes corresponding to multiple regions of interest and to provide the multiple three dimensional volumes to the MRS system configured for multivoxel MRS.

According to one variation of the present disclosure the electronic image is of a first acquisition mode and the MRS spectrum is of a second acquisition mode different than the first acquisition mode.

According to one embodiment of the present disclosure the three dimensional selected volume is a rectilinear volume.

According to one embodiment of the present disclosure the computer instructions are configured to cause the one or more computer processors to define a two dimensional shape using the initial electronic image the two dimensional shape corresponding to a cross sectional shape of the three dimensional selected volume and to modify the cross sectional shape of the three dimensional selected volume to fit the region of interest corresponding to at least one of the one or more additional electronic images.

According to one embodiment of the present disclosure the computer instructions are configured to cause the one or more computer processors to define a plurality of two dimensional shapes associated with the region of interest for the corresponding electronic images and wherein the three dimensional selected volume has a cross sectional shape corresponding to the overlapping area of the plurality of two dimensional shapes.

According to one embodiment of the present disclosure the computer readable media can be configured to be used with a patient therapy system configured to provide a therapy procedure to a patient based at least in part on the three dimensional selected volume.

According to one variation of the present disclosure the patient therapy system is a radiation therapy system or an ultrasound therapy system configured to direct energy to the three dimensional selected volume.

According to one embodiment of the present disclosure the computer instructions are configured to cause the one or more computer processors to calculate a three dimensional model that approximates the region of interest based on the populations of pixels from the electronic images.

According to one embodiment of the present disclosure the electronic images are magnetic resonance imaging MRI images and the computer instructions are configured to cause the one or more computer processors to receive the MRI images from an MRI system in communication with the one or more computer processors.

According to one mode of the present disclosure processing the electronic image comprises smoothing the electronic image.

According to one embodiment of the present disclosure smoothing the electronic image comprises modifying a brightness value for a pixel based on the brightness of neighboring pixels.

According to one variation of the present disclosure the neighboring pixels comprise one or more pixels from one or more additional neighboring electronic images.

According to one mode of the present disclosure processing the electronic image comprises performing at least one top hat filtering operation.

According to one mode of the present disclosure processing the electronic image comprises performing at least one morphological image processing operation.

According to one embodiment of the present disclosure processing the electronic image comprises performing a first top hat filtering operation on an upper portion of the spine and performing a second top hat filtering operation on a lower curved portion of the spine.

According to one mode of the present disclosure processing the electronic image comprises performing an order statistic filtering operation.

According to one mode of the present disclosure the at least one structure comprises the region of interest the computer instructions being configured to cause the one or more computer processors to process the electronic image to emphasize the region of interest.

According to one mode of the present disclosure the at least one structure comprises at least one structure adjacent to the region of interest.

According to one mode of the present disclosure indentifying the population of pixels in the electronic image comprises analyzing pixels in a predefined search area of the electronic image and assigning analyzed pixels having a particular property to the population of pixels associated with the at least one structure.

According to one embodiment of the present disclosure the particular property is a pixel brightness intensity.

According to one embodiment of the present disclosure the predefined search area is based on statistical analysis of historical data relating to a likely location for the at least one structure.

According to one mode of the present disclosure indentifying the population of pixels in the electronic image is based on input from an operator the input comprising one or more locations associated with the at least one structure.

According to one mode of the present disclosure the computer instructions are further configured to cause the one or more computer processors to analyze the population of pixels based on at least one reliability criteria.

According to one mode of the present disclosure the at least one reliability criteria comprises a comparison of a number of pixels in the population of pixels to a threshold pixel number.

According to one embodiment of the present disclosure when the population of pixels does not satisfy the reliability criteria the computer instructions cause the one or more processors to flag the population of pixels for review by a user.

According to one embodiment of the present disclosure when the population of pixels does not satisfy the reliability criteria the computer instructions cause the one or more processors to employ additional algorithms to modify the population of pixels to improve reliability.

One aspect of the present disclosure is a system for obtaining information relating to a region of interest the system comprising 

One mode of the present disclosure further comprises a magnetic resonance spectroscopy MRS system in communication with the one or more computer processors wherein the MRS system is configured to provide an MRS spectrum of chemical constituents within the region of interest.

One mode of the present disclosure further comprises a magnetic resonance imaging MRI system in communication with the one or more computer processors wherein the MRI system is configured to provide a plurality of MRI images.

According to one mode of the present disclosure the electronic image is of a first imaging mode wherein the computer instructions are further configured to cause the one or more processors to access an additional electronic image of a second imaging mode different than the first imaging mode the additional electronic image being of the substantially the same area as the initial electronic image wherein the world coordinates are based in part on the additional electronic image of the second imaging mode.

According to one embodiment of the present disclosure the computer instructions are further configured to cause the one or more processors to 

According to one mode of the present disclosure the computer instructions are further configured to cause the one or more processors to 

One aspect of the present disclosure is a method for obtaining information relating to a region of interest the method comprising 

According to one mode of the present disclosure the electronic image comprises a magnetic resonance imaging MRI image.

According to one embodiment of the present disclosure selecting image coordinates comprises selecting a two dimensional shape that covers a selected area of the region of interest when converted to world coordinates.

According to one mode of the present disclosure selecting image coordinates comprises calculating a two dimensional model that approximates the region of interest based on the population of pixels.

According to one embodiment of the present disclosure calculating the two dimensional model comprises applying an expectation maximization algorithm for estimating parameters of one or more Gaussian distributions for the population of pixels.

According to one embodiment of the present disclosure the computer instructions are configured to cause the one or more computer processors to position a two dimensional shape based on the two dimensional model to cover a selected area of the region of interest.

One mode of the present disclosure further comprises outputting information relating to the region of interest based on the world coordinates the information comprising one or more of a location an orientation a shape an area and a volume of the region of interest.

According to one embodiment of the present disclosure the world coordinates define to a three dimensional selected volume of the region of interest.

One variation of the present disclosure further comprises scanning the three dimensional selected volume with a magnetic resonance spectroscopy MRS system in communication with the one or more computer processors to provide an MRS spectrum of chemical constituents within the three dimensional selected volume.

One variation of the present disclosure further comprises analyzing a post acquisition scan using the one or more computer processors to determine whether the region of interest moved during an MRS acquisition.

According to one variation of the present disclosure the region of interest is a nucleus of an intervertebral disc of a spine.

One variation of the present disclosure further comprises analyzing the MRS spectrum using the one or more computer processors to determine whether the three dimensional selected volume was likely mis prescribed based on one or more signals.

One variation of the present disclosure further comprises defining one or more additional three dimensional selected volumes covering at least portions of one or more additional regions of interest and scanning the additional three dimensional selected volumes one at a time with the MRS system using single voxel MRS.

One variation of the present disclosure further comprises defining one or more additional three dimensional selected volumes covering at least portions of one or more additional regions of interest and scanning the additional three dimensional selected volumes simultaneously with the MRS system using multivoxel MRS.

According to one variation of the present disclosure the electronic image is of a first acquisition mode and wherein the MRS spectrum is of a second acquisition mode different than the first acquisition mode.

One variation of the present disclosure further comprises defining a plurality of two dimensional shapes associated with the region of interest for the corresponding electronic images wherein the three dimensional selected volume has a cross sectional shape corresponding to the overlapping area of the plurality of two dimensional shapes.

One variation of the present disclosure further comprises using with a patient therapy system to provide a therapy procedure to a patient based at least in part on the three dimensional selected volume.

According to one variation of the present disclosure the patient therapy system is a radiation therapy system or an ultrasound therapy system configured to direct energy to the three dimensional selected volume.

One embodiment of the present disclosure further comprises calculating a three dimensional model that approximates the region of interest based on the populations of pixels from the electronic images.

According to one embodiment of the present disclosure the electronic images comprise magnetic resonance imaging MRI images and the method further comprising acquiring the MRI images using an MRI system in communication with the one or more computer processors.

According to one mode of the present disclosure processing the electronic image comprises smoothing the electronic image.

According to one embodiment of the present disclosure smoothing the electronic image comprises modifying a brightness value for a pixel based on the brightness of neighboring pixels.

According to one embodiment of the present disclosure the neighboring pixels comprise one or more pixels from one or more additional neighboring electronic images.

According to one mode of the present disclosure processing the electronic image comprises performing at least one top hat filtering operation.

According to one mode of the present disclosure processing the electronic image comprises performing at least one morphological image processing operation.

According to one embodiment of the present disclosure processing the electronic image comprises performing a first top hat filtering operation on an upper portion of the spine and performing a second top hat filtering operation on a lower curved portion of the spine.

According to one mode of the present disclosure processing the electronic image comprises performing an order statistic filtering operation.

According to one mode of the present disclosure the at least one structure comprises the region of interest wherein processing the electronic image comprises emphasizing the region of interest.

According to one mode of the present disclosure the at least one structure comprises at least one structure adjacent to the region of interest.

According to one mode of the present disclosure indentifying the population of pixels in the electronic image comprises analyzing pixels in a predefined search area of the electronic image and assigning analyzed pixels having a particular property to the population of pixels associated with the at least one structure.

According to one embodiment of the present disclosure the particular property is a pixel brightness intensity.

According to one embodiment of the present disclosure the predefined search area is based on statistical analysis of historical data relating to a likely location for the at least one structure.

One mode of the present disclosure further comprises receiving input from an operator the input comprising one or more locations associated with the at least one structure and wherein identifying the population of pixels in the electronic image is based on the input.

One mode of the present disclosure further comprises analyzing the population of pixels using the one or more computer processors based on at least one reliability criteria.

According to one embodiment of the present disclosure the at least one reliability criteria comprises a comparison of a number of pixels in the population of pixels to a threshold pixel number.

One embodiment of the present disclosure further comprises when the population of pixels does not satisfy the reliability criteria flagging the population of pixels for review by a user.

One embodiment of the present disclosure further comprises when the population of pixels does not satisfy the reliability criteria employing additional algorithms to modify the population of pixels to improve reliability.

According to one mode of the present disclosure each of the actions recited is performed by the one or more processors.

According to one mode of the present disclosure the electronic image is of a first imaging mode and wherein the method further comprises accessing an additional electronic image of a second imaging mode different than the first imaging mode the additional electronic image being of the substantially the same area as the initial electronic image wherein the world coordinates are based in part on the additional electronic image of the second imaging mode.

One aspect of the present disclosure is a method for prescribing a shape within a region of interest ROI in an electronic image of a body portion of a patient comprising 

One aspect of the present disclosure is a method for configuring a medical system to be used in performing an operation on a region of interest ROI in a body portion of a patient the method comprising 

One aspect of the present disclosure is a method for defining a region of interest ROI between bones in an electronic image of a body portion comprising a skeletal joint in a patient the method comprising 

One mode of the present disclosure further comprises configuring a medical system in a configuration that is operable to perform an operation on the ROI.

According to one mode of the present disclosure the body portion comprises a skeletal joint and the ROI is located at least in part between bones of the skeletal joint the method further comprising using the one or more processors to process the electronic image to identify a region between the bones and bordered at least in part by the bones and to define the ROI to coincide with at least a part of the region.

One embodiment of the present disclosure further comprises configuring a medical system in a configuration that is operable to perform an operation on the ROI.

According to one mode of the present disclosure the body portion comprises a skeletal joint and the ROI is located at least in part between bones of the skeletal joint and further comprising using the one or more processors to process the electronic image to identify a region between the bones and bordered at least in part by the bones and to define the ROI to coincide with at least a part of the region.

One mode of the present disclosure further comprises using the one or more processors to process the electronic image to define the ROI.

One mode of the present disclosure further comprises using the one or more processors to process the electronic image to prescribe the shape.

According to one embodiment of the present disclosure prescribing the shape is entirely performed using the one or more processors.

According to one embodiment of the present disclosure prescribing the shape is partially performed using the one or more processors.

One embodiment of the present disclosure further comprises using the one or more processors to process the electronic image to prescribe the shape.

One embodiment of the present disclosure further comprises using the one or more processors to process the electronic image to prescribe the shape.

One embodiment of the present disclosure further comprises using the one or more processors to process the 2D planar image to define the ROI as a 2D ROI in the 2D planar image.

One variation of the present disclosure further comprises using the one or more processors to process the 2D planar image to prescribe a 2D shape to fit within the 2D ROI.

One embodiment of the present disclosure further comprises using the one or more processors to process the 2D planar image to prescribe a 2D shape to fit within a 2D ROI.

According to one mode of the present disclosure said electronic image comprises a 3D electronic image constructed from a series of spatially unique but related 2D planar images of the body portion and further comprising using the one or more processors to process multiple said 2D planar images within the series to define multiple respective 2D ROIs therein and to construct a 3D ROI in the 3D image from the multiple 2D ROIs.

According to one embodiment of the present disclosure the 3D ROI corresponds with a definable structure within the body portion and further comprising using the one or more processors to process the 3D electronic image to define the 3D ROI by applying a template map to each of said plurality of 2D planar images and providing a default region predictive of locating said structure in each said respective 2D planar images based on prior knowledge derived from other similar 2D planar images from other patients and processing the default region in the 2D planar image to define the 2D ROI from which the 3D ROI is constructed.

One variation of the present disclosure further comprises using the one or more processors to process multiple of the 2D planar images to prescribe a 3D shape to fit within the 3D ROI in the 3D image.

According to one mode of the present disclosure the ROI corresponds with a definable structure within the body portion and further comprising using the one or more processors to process the electronic image to define the ROI using a template map providing a default region predictive of locating said structure based on location information derived from other electronic images from other patients and processing the default region in the electronic image to define the ROI.

According to one embodiment of the present disclosure the default region processing comprises at least one of edge detection and a contrast filter.

One mode of the present disclosure further comprises using the one or more processors to process the electronic image to define the ROI using edge detection.

One mode of the present disclosure further comprises using the one or more processors to process the electronic image to define the ROI using a contrast filter.

One embodiment of the present disclosure further comprises using the one or more processors to process the electronic image to define the ROI using edge detection.

One variation of the present disclosure further comprises prescribing the 3D shape to achieve a criteria related to volume or dimension of the 3D shape.

According to one variation of the present disclosure the criteria comprises a maximum contained volume or dimension within the 3D ROI.

One variation of the present disclosure further comprises using the one or more processors to process the electronic image to prescribe multiple said 3D shapes within the 3D ROI.

One variation of the present disclosure further comprises prescribing the multiple 3D shapes to collectively achieve a criteria relating to volume of the 3D shapes.

According to one variation of the present disclosure the criteria comprises a maximum contained volume within the 3D ROI.

One variation of the present disclosure further comprises using the one or more processors to apply an inward dimensional off set from an outer boundary of the 3D ROI for form an off set 3D ROI and prescribing the multiple 3D shapes to collectively achieve a criteria relating to a volume of the 3D shapes.

According to one variation of the present disclosure the criteria comprises a maximum contained volume within the off set 3D ROI.

One variation of the present disclosure further comprises configuring a medical system to perform an operation on at least a part of the 3D ROI corresponding with the multiple 3D shapes.

According to one variation of the present disclosure the medical system comprises a nuclear magnetic resonance MR system and further comprising 

According to one variation of the present disclosure the configuration comprises a T2 weighted imaging sequence.

According to one variation of the present disclosure the configuration comprises a T1 weighted imaging sequence.

According to one variation of the present disclosure the configuration comprises an MR spectroscopy MRS pulse sequence.

According to one variation of the present disclosure the configuration comprises a T1 rho pulse sequence.

One variation of the present disclosure further comprises correlating a value of the MR based data for each of the 3D shapes with a diagnostic criteria.

One variation of the present disclosure further comprises displaying an indicia related to the correlation for each of the 3D shapes as an overlay to the electronic image.

One variation of the present disclosure further comprises defining the 3D ROI and prescribing the 3D shapes before configuring the operating the medical system in the configuration.

One variation of the present disclosure further comprises using the defined 3D ROI and 3D shape prescriptions to configure the medical system in the configuration.

One variation of the present disclosure further comprises defining the 3D ROI and prescribing the 3D shapes after configuring the medical system in the configuration and after operating the medical system in the operating mode.

One variation of the present disclosure further comprises using the 3D shapes to correlate the operation corresponding with portions of the ROI represented by the respective 3D shapes.

One mode of the present disclosure further comprises using the one or more processors to process the electronic image to prescribe a single shape that is a different shape than the ROI to fit within the ROI to achieve a criteria relating to volume or dimension of the single shape.

According to one embodiment of the present disclosure the criteria comprises a maximized dimension or contained volume within the single shape.

According to one mode of the present disclosure the ROI and the shape comprise different respective geometries.

According to one embodiment of the present disclosure the ROI comprises a geometry comprising at least one non straight linear edge boundary.

According to one variation of the present disclosure the ROI comprises at least in part a curvilinear edge boundary.

One mode of the present disclosure further comprises prescribing the shape for achieving a criteria related to volume or dimension of the shape.

According to one embodiment of the present disclosure the criteria comprises a maximized dimension or contained volume within the ROI.

According to one mode of the present disclosure the ROI comprises at least a portion of an intervertebral disc between two superior and inferior respective vertebral bodies bordering the disc.

One embodiment of the present disclosure further comprises using the one or more processors to define the ROI at least in part by locating two superior and inferior borders between the disc and the vertebral bodies in the electronic image.

One variation of the present disclosure further comprises defining the ROI by defining at least one annular wall of the disc and connecting the vertebral bodies in the electronic image such that the ROI is defined as a region contained between the borders and the at least one annular wall of the disc.

According to one variation of the present disclosure the electronic image comprises a 2D planar image through the disc and vertebral bodies and further comprising defining the ROI by defining first and second opposite portions of the annular wall in the electronic image such that the ROI is defined as a region contained between the borders and the two opposite portions of the annular wall.

According to one variation of the present disclosure the electronic image comprises a 2D planar image and each of the borders comprises a line first end and a second end and further comprising defining the ROI by defining two connecting lines between first ends and second ends of the respective borders thereby confining the ROI as an area contained within the borders and connecting lines.

According to one variation of the present disclosure the ROI comprises a nucleus portion of the intervertebral disc.

According to one variation of the present disclosure the ROI comprises an annulus portion of the intervertebral disc.

One variation of the present disclosure further comprises defining first and second said ROIs comprising a nucleus portion and an annulus portion of the disc respectively and prescribing a first shape to fit within the first ROI and a second shape to fit within the second ROI.

One mode of the present disclosure further comprises using the one or more processors to operate a computer program in a computer readable medium for performing the processing of the electronic image.

One mode of the present disclosure further comprises configuring an MR system in a configuration that is operable to perform an MR operation on at least a portion of the ROI corresponding with the shape.

One embodiment of the present disclosure further comprises configuring the MR system in a configuration that is operable to acquire a T1 weighted image of at least the portion of the ROI.

One embodiment of the present disclosure further comprises configuring the MR system in a configuration that is operable to acquire a T2 weighted image of at least the portion of the ROI.

One embodiment of the present disclosure further comprises configuring the MR system in a configuration that is operable to acquire T1 rho data of at least the portion of the ROI.

One embodiment of the present disclosure further comprises configuring the MR system in a configuration that is operable to acquire an MR spectroscopy data from at least the portion of the ROI.

One mode of the present disclosure further comprises configuring a CT system in a configuration that is operable to perform a CT imaging operation on at least a portion of the ROI corresponding with the shape.

One mode of the present disclosure further comprises configuring an X ray system in a configuration that is operable to perform an X ray imaging operation on at least a portion of the ROI corresponding with the shape.

One mode of the present disclosure further comprises configuring a nuclear imaging system in a configuration that is operable to perform a nuclear imaging operation on at least a portion of the ROI corresponding with the shape.

One mode of the present disclosure further comprises configuring a PET imaging system in a configuration that is operable to perform a PET imaging operation on at least a portion of the ROI corresponding with the shape.

One mode of the present disclosure further comprises configuring a medical diagnostic system in a configuration that is operable to perform a medical diagnostic imaging operation on at least a portion of the ROI corresponding with the shape.

According to one embodiment of the present disclosure the medical diagnostic system comprises a combination of multiple unique imaging modalities comprising first and second modalities and further comprising configuring at least the first modality in a respective first configuration to perform a first operation on at least the portion of the ROI.

One embodiment of the present disclosure further comprises configuring the second modality in a respective second configuration to perform a second operation on at least the portion of the ROI.

According to one variation of the present disclosure the medical diagnostic system comprises a combination MR CT PET CT or PET MR system.

According to one mode of the present disclosure the body portion comprises a body space defined by at least one tissue wall.

According to one mode of the present disclosure the body portion comprises at least a portion of an organ.

According to one mode of the present disclosure the body portion comprises at least a portion of a prostate gland.

According to one mode of the present disclosure the body portion comprises at least a portion of a breast.

According to one mode of the present disclosure the body portion comprises at least a portion of a brain.

According to one mode of the present disclosure the body portion comprises at least a portion of a tumor.

According to one mode of the present disclosure the body portion comprises at least a portion of a bone.

According to one mode of the present disclosure the electronic image comprises an image coordinate system and further comprising defining the ROI in image coordinates.

One embodiment of the present disclosure further comprises prescribing the shape in image coordinates.

One variation of the present disclosure further comprises prescribing the shape in world coordinates.

One mode of the present disclosure further comprises processing the electronic image to define multiple ROIs in the electronic image.

According to one embodiment of the present disclosure the multiple ROIs correspond to multiple intervertebral discs.

One embodiment of the present disclosure further comprises prescribing a plurality of shapes to fit within the plurality of ROIs in the electronic image.

According to one embodiment of the present disclosure the allowing comprises allowing the user to modify the recommended shape to prescribe the second shape as the shape.

According to one mode of the present disclosure the electronic image is of a first imaging mode the method further comprising modifying the defined ROI or the prescribed shape based on an additional electronic image of a second imaging mode different than the first imaging mode.

According to one mode of the present disclosure the electronic image is of a first imaging mode the method further comprising comparing the defined ROI or the prescribed shape to information derived from an additional electronic image of a second imaging mode different than the first imaging mode.

One aspect of the invention is a method for determining patient motion during a medical procedure on a patient comprising 

One mode of the present disclosure further comprises mapping a voxel prescribed in a region of interest ROI based upon the first image onto same coordinates in the second image.

One embodiment of the present disclosure further comprises determining change of voxel location relative to the ROI in the first and second images.

Another aspect of the present disclosure is a method for determining motion of a defined region of interest ROI of a body of a patient from a first position to a second position during a medical procedure being conducted on a patient. This method according to one mode comprises comparing a first image from the patient acquired at a first time relative to the procedure against a second image acquired from the patient at a second time relative to the procedure wherein the first and second images comprise the ROI observing a difference between the first and second images based upon the comparison and determining motion of the ROI between the first and second positions at the first and second times respectively based upon the difference between the first and second images.

Another mode of this aspect comprises re prescribing a voxel prescribed in a first prescription within the ROI based upon the first position in the first image onto same voxel prescription coordinates in a second prescription relative to the ROI in the second position in the second image.

Another mode comprises determining change of voxel location relative to the ROI in the first and second images.

According to another mode the determining comprises quantifying an extent of patient motion to a value.

One embodiment of this mode comprises comparing the value to a reference value to determine a difference value.

Another embodiment further comprises adjusting the procedure based upon the difference value. According to one further embodiment this adjusting comprises terminating the procedure based upon the difference value. According to another embodiment the adjusting comprises changing a spatial orientation or direction parameter of the procedure initially registered with the ROI in the first position to register the procedure with the ROI in the second position.

According to another embodiment observing the difference is based upon adjusting one of the first and second images in overlay to the other of the first and second images while performing a correlation comparison of an image parameter between the first and second images determining the adjustment corresponding with maximum correlation of the image parameter and deriving the difference from the adjustment. In one further embodiment the correlation comparison is based upon a registration of a segmented structure between the first and second initial images. In another further embodiment the segmented structure comprises a border or shape of the ROI.

One aspect of the present disclosure is a medical device system comprising one or more processors configured to run computer instructs stored on one or more computer readable media to perform one or more of the actions described herein. This aspect of the disclosure can be combined with the other aspects modes embodiments variations and features described herein to form various combinations and sub combinations.

One aspect of the present disclosure is one or more computer readable media comprising computer instructions configured to cause one or more computer processors to perform one or more of the actions described herein. This aspect of the disclosure can be combined with the other aspects modes embodiments variations and features described herein to form various combinations and sub combinations.

According to one mode of the present disclosure the defining the ROI in the electronic image comprises 

Another aspect of the present disclosure comprises one or more non transitory computer readable media comprising computer instructions configured to cause one or more computer processors to perform the following actions performing image fusion between multiple initial electronic images of a region of interest ROI of a body of a patient to generate a fused image providing an enhanced definition of the ROI or border thereof relative to the initial images and processing the fused image as the electronic image according to any one or more of the other aspects modes embodiments or variations elsewhere herein disclosed. In various embodiments processing the fused image comprises obtaining information relating to the ROI prescribing a shape within the ROI configuring a medical system to be used in performing an operation on the ROI or defining the ROI between bones as described elsewhere herein.

According to one embodiment of this mode the initial images comprise a T1 weighted and a T2 weighted image.

In another mode performing the image fusion comprises differencing the initial images and the fused image comprises a differenced image.

In another mode performing the image fusion comprises blending the initial images and the fused image comprises a blended image. In one embodiment of this mode blending the initial images comprises alpha blending and the blended image comprises an alpha blended image.

In another mode the non transitory computer readable media comprises further computer instructions configured to cause the one or more processors to perform actions comprising enhancing contrast along a population of pixels corresponding with a border of the ROI using the fused image.

Another aspect of the current disclosure is a method for automated diagnostic image processing comprising performing image fusion between multiple initial electronic images to generate a fused image post processing the fused image as the electronic image such as according to any of the other aspects modes embodiments or variations elsewhere herein disclosed and causing one or more computer processors to perform the image fusion and post processing via a set of computer instructions from one or more non transitory computer readable media. In various embodiments post processing the fused image comprises obtaining information relating to the ROI prescribing a shape within the ROI configuring a medical system to be used in performing an operation on the ROI or defining the ROI between bones as described elsewhere herein.

In one mode of this aspect the initial electronic images comprise magnetic resonance images. According to one embodiment of this mode the initial electronic images comprise a T1 weighted and a T2 weighted image.

In another mode performing the image fusion comprises differencing the initial images and the fused image comprises a differenced image.

In another mode performing the image fusion comprises blending the initial images and the fused image comprises a blended image. According to one embodiment of this mode blending the initial images comprises alpha blending and the blended image comprises an alpha blended image.

In another mode the actions of the processor conducted according to the computer instructions further comprise enhancing contrast along a population of pixels corresponding with a border of the ROI via the fused image.

The aspects modes embodiments variations and features noted above and those noted elsewhere herein can be combined to form various combinations and sub combinations even where not specifically discussed. For example the methods and systems disclosed herein can perform one or more of the operations shown in or described herein alone or with various combinations of the other operations shown in or disclosed herein.

As would be apparent to one of ordinary skill use of particular terms at specific places in this disclosure above shall be considered to relate consistently to similar features as other uses of same terms in other places in this disclosure including in context of providing certain combinations between then and which are contemplated hereunder though such combinations are not necessarily required limitations provided however to the extent such different uses are compatible and would not create inconsistencies in which case the different uses of the terms should be considered independently of each other .

Various embodiments disclosed in the present disclosure relate to clinical magnetic resonance spectroscopy MRS in particular single voxel MRS and still more particularly to the automated prescription of voxels within regions of interest where MRS is to be performed such as for example intervertebral discs. One example application of the present disclosure is to single voxel MRS of the intervertebral discs of the lumbar spine such as the three to five lower lumbar discs such as for the purpose of diagnosing disc degeneration or discogenic pain. The systems and methods described herein can be used in the application of MRS to diagnose chronic severe discogenic low back pain by identifying discs that are more likely to be painful versus non painful though chemical signature analysis of disc tissue.

Magnetic resonance imaging MRI and in particular magnetic resonance spectroscopy MRS uses a combination of radiofrequency RF pulses and dynamic magnetic fields to energize a target volume of material resulting in the generation of resonant frequencies that are characteristic of the chemical constituents within the energized volume. In a clinical MRS application the target volume or three dimensional 3D volume is referred to as a voxel e.g. a single point or pixel with volume . As used herein the term voxel can refer to the three dimensional target volume. In some embodiments a two dimensional voxel shape can be a slice or cross section of the three dimensional voxel volume. Although various embodiments are disclosed herein in connection with forming a voxel for a three dimensional volume it will be understood that the embodiments also relate to forming two dimensional shape associated with a two dimensional portion of the ROI. In some embodiments information identifying a ROI in only a two dimensional area can be useful. In clinical MRS voxels are typically defined or prescribed using the sagittal coronal and axial or oblique axial two dimensional 2D MRI images that include the region of interest ROI . Using a graphical interface the MRS technician manually draws or enters coordinates for a pattern typically a rectangle in each of the three plane images for example according to various present embodiments to outline the nucleus of a lumbar disc. The graphical interface converts the 2D patterns in multiple transverse in some cases orthogonal planes into a 3D volume or voxel.

As a prescribed MRS voxel defines the volume of interest VOI where MRS signatures are taken its location and tissue defined therein defines what signatures are captured. If tissue within the ROI is distinctive from tissue bordering the ROI mis prescription of the voxel in terms of size and or location to extend beyond the ROI could confound MRS results by capturing unwanted signal from the bordering tissue unintended to be voxelated for the MRS signature acquisition. Furthermore if it is not readily apparent that the voxel was mis prescribed then the MRS spectrum resulting from the mis prescribed acquisition and including bordering tissue signatures could be misinterpreted to represent the intended tissue within the target ROI itself. If signatures from bordering tissues are not related to biomarker chemicals of interest for a particular diagnosis this may be less concerning in such circumstances. However if signatures from bordering tissues relate directly or indirectly such as by overlapping MRS signature regions between different chemicals to such biomarker signals being targeted for MRS analysis of the ROI mis prescription of the voxel could lead to mis diagnosis of the tissue within the intended ROI.

Still further aside from bordering tissue issues voxel volume will typically directly correlate with signal strength. A general goal of most MRS voxel prescriptions is thus to maximize voxel volume within a desired ROI for a tissue so as to increase the signal strength while still excluding bordering tissues or structures of potentially different chemical composition relevant to MRS spectral acquisitions from the ROI.

In many applications a rectilinear voxel may fit easily into a large ROI. This may be the case for example in many cases involved in applications for the brain or breast where the voxel volume is a small percentage of the ROI volume. However in many certain other applications such as intervertebral discs the ROI may be rather small and non rectilinear and may consist of compound surfaces e.g. having different curvature and or shape at different portions of the perimeter of the ROI such as nodules which in some cases do not correspond to a smooth geometric equation or curve such as resulting in a more ellipsoidal type shape e.g. intervertebral discs . As such manual prescription of one shape inside of another may not be readily optimized. A rectangle that is fitted for a particular planar slice through an ellipsoid ROI may not fit in the ROI of an adjacent slice resulting in the voxel dimensions exceeding the shape of the ROI. This is one illustrative example of a mis prescription that would be desirable to avoid. To avoid a voxel mis prescription the MRS technician typically verifies that the voxel prescribed in one set of 2D images fits within the adjacent 2D images or slices that encompass the voxel. Even for skilled technicians this can be challenging to get correct in many cases. Also the trade off between maximizing voxel volume for optimal signal to noise SNR ratio versus excluding bordering different tissue structures is an exercise in risk reward trade offs that may be challenging to optimize for a particular case especially challenging cases where the ROI is small and bordering structures can introduce significant error if captured as is the case for intervertebral discs .

In the particular case of a voxel intended to capture an intervertebral disc for MRS chemical signature analysis and more specifically the nucleus of an intervertebral disc this structure can be bordered on some or all sides by different structures that are chemically distinct from the intended disc tissue. This is in particular the case superiorly vertically above and inferiorly below the disc where vertebral body end plates reside. These structures involve among other constituents bone marrow which are rich in lipid that has an MRS signature that overlaps with and may mask other target chemicals such as for example lactic acid and alanine . A mis prescribed voxel for a disc nucleus MRS exam thus may contain tissue from the vertebral endplate adjacent to the nucleus resulting in resonant frequencies from both tissues. The MRS signatures e.g. lipid from tissue surrounding the ROI can compromise the ability to assess overlapping chemicals of the ROI e.g. lactic acid and alanine in addition to simply representing the wrong tissue. Additionally in some cases a degenerative painful disc itself may contain lipid. To the extent a lipid signal is representative only of bordering bone or end plates and not the intervertebral disc a lipid signature in a resulting acquired spectrum could indicate a mis prescription and motivate a re prescription in a repeat scan such as by moving or shrinking the voxel. However because lipids and associated MRS signatures can be present both in some actual disc tissues and in a mis prescription involving bordering vertebral bodies or the end plates the ability to recognize whether a mis prescription occurred based on a lipid signal may be compromised in some cases. Thus in some cases the identification of a lipid signature in an acquired spectrum is not useful as an indicator of voxel mis prescription while in other cases a lipid signature may be indicative of a voxel mis prescription. In some embodiments detection of a lipid signal over a threshold level can cause an MRS acquisition to be repeated with a voxel of the same or different size disregarded flagged for user review and or further analyzed for accuracy.

Further to the issues elsewhere noted surrounding manual voxel prescriptions the process of defining single voxels may be very time consuming. For example in a single voxel MRS exam of three lower lumbar discs if each voxel prescription took from about 2.5 to about 5 minutes that represents between about 7.5 to about 15 minutes total time for voxelation during the exam. For an actual pulse sequence acquisition that may take for example about 2.5 to about 5 minutes or 7.5 to about 15 minutes total scan time that manual voxelation essentially doubles the time of the exam not accounting for other activities such as imaging sequences shimming etc. . Where mis prescriptions occur and are caught rescanning can further increase the time of the exam.

Time means money in imaging and healthcare costs have become among the most prominent issues in all of modern society world wide. At least near the top of such issues reside the rising costs of imaging. Moreover time that a patient resides in an MRI environment for an exam or in the tube is limited due to patient comfort and other concerns. Over extended exam times patients will often become more restless thus more likely to move and movement can confound an MR exam e.g. patient movement after a voxel prescription can move the patient s tissues while the voxel location remains fixed in MR machine coordinates effectively creating a voxel mis prescription . Furthermore patients such as low back pain patients may be in tremendous discomfort to begin with. If the manual process were replaced by one that was at least partially automated significant time could be saved. For illustration by reference to the example immediately above replacing manual voxelation with a fully automated process could potentially cut the time of the exam by as much as 25 50 .

Manual voxelation thus represents a human operator dependent process and the results of the MRS exam can directly and in some cases critically depend on correct performance of the manual voxelation. Thus manual voxelation introduces the risk of human error. When the risk of human error is high and the impacts of the potential error can be critical the need to find a solution to remove this potential opportunity and source for human error becomes that much more important. This does not necessarily reflect badly on the human operators themselves. Manual voxelation for single voxel spectroscopy may be very difficult to get right especially in challenging MRS applications in small defined tissue regions. Inter operator variability could be high even between the most highly skilled and diligent of operators especially in particularly challenging cases. Thus an automated voxelation process can reduce or eliminate the occurrence of human error and can increase consistency and predictability in the voxelation process and in the MRS results.

Accordingly one aspect of this disclosure provides a useful solution to replace or at least augment manual voxel prescription e.g. for single voxel MRS exams by an at least partially automated voxelation system and method. In fact in some embodiments herein described the voxelation is either fully or nearly fully automated. According to one particular benefit this can mitigate certain associated potential risks and issues that may impact single voxel MRS exams. According to another benefit it shortens the time necessary for the voxelation portion of the exam which shortens the time for the overall exam which may result in more efficient delivery of healthcare more patient comfort and more robust results.

In particular one mode of this aspect provides a system and method to automate the voxel prescription process by identifying the boundaries of the ROI in a set of 2D images that encompass the ROI creating a 3D model of the ROI and fitting a rectilinear shape voxel within the ROI. The resulting dimensions and coordinates of the voxel are then presented to the MRS technician for entry into the graphical user interface. The system may also process define multiple voxels for multiple ROI within a common field of view FOV simultaneously. Thus although many embodiments are described herein in connection with single voxel MRS the systems and methods may also be applied to multivoxel MRS e.g. for multiple ROI . In the example of lower lumbar applications voxels may be automatically prescribed for multiple e.g. all five lower lumbar discs.

Some embodiments of the present disclosure can be used in automating the voxel prescription of an intervertebral disc such as for MRS exams to provide diagnostic information related to disc degeneration and or discogenic pain.

At block sagittal coronal and axial or oblique axial MRI image sets can be captured. For example a series e.g. 13 slices of high resolution T2 w MRI images of the ROI in the sagittal plane can be captured using a field of view FOV of 40 cm 40 cm and a 4 mm slice thickness. A series e.g. 13 slices of high resolution T2 w MRI images of the ROI in the coronal plane can be captured using a field of view FOV of 40 cm 40 cm and a 4 mm slice thickness. A single high resolution T2 w MRI image of the ROI in the axial or axial oblique plane e.g. typically more angulated at the L5 S1 level can be captured using a field of view FOV of 40 cm 40 cm and a 4 mm slice thickness. It will be understood that MRI images may be produced using various other suitable parameters. Also in some embodiments a series of multiple MRI images can be used in the axial or oblique axial plane instead of a single MRI image and the series of sagittal and coronal MRI images may contain more or fewer than the 13 images described above.

At block the MRI image of the slice that intersects the center of the ROI in the sagittal plane can be identified. Typically the MRI image having the largest cross sectional area of the ROI is the slice that intersects the center of the ROI. In a series of 13 MRI images as described above slice number 7 or 8 will typically intersect the center of the ROI. In some embodiments this process may be repeated for the MRI images in the coronal plane to identify the MRI image of the slice that intersects the center of the ROI in the coronal plane. If a series of MRI images are used in the axial or oblique axial plane an MRI image that intersects the center of the ROI in the axial or oblique axial plane can also be identified. If the axial or oblique axial MRI image set includes only a single image that single MRI image can be used as the center image.

At block a rectangle can be drawn using the MRI graphical user interface in each of the three planes. For each axis if an MRI image was identified in block as intersecting the center of the ROI e.g. having the largest cross sectional area that MRI image can be used to draw the rectangle for that axis.

At block the system can present the adjacent MRI images from the MRI image sets with the drawn rectangle projected onto the image. The user can observe the projected rectangle in some or all of the MRI images in the sagittal MRI image set to verify that the rectangle fits inside the ROI for each slice in the sagittal orientation. The user can observe the projected rectangle in some or all of the MRI images in the coronal MRI image set to verify that the rectangle fits inside the ROI for each slice in the coronal orientation. If multiple images are used in the axial or axial oblique angle the user can observe the projected rectangle in some or all of the MRI images in the axial or oblique axial MRI image set to verify that the rectangle fits inside the ROI for each slice in the axial or oblique axial orientation.

At block if needed the user can adjust the dimensions coordinates and angle of the rectangle so as to keep the rectangle within the ROI. It will be understood that in some embodiments block can be omitted for example if no adjustments to the rectangle are needed after the initial rectangle designation. In some cases the user may reduce the size of the rectangle so as to exclude area outside the region of interest. The user may also increase the size of the rectangle so as to capture more volume of the region of interest. The user may also change the angle or orientation of the rectangle so as to better fit the volume of the ROI.

If the rectangle is adjusted in block the process can repeat block to confirm that the adjusted rectangle fits into the ROI in some or all of the slices of the MRI images sets. In some embodiments the user can repeat blocks and multiple times if needed until a rectangle is defined that covers a large portion of the ROI but does not extend outside the ROI. In some embodiments the user may first adjust the rectangle in the sagittal and coronal directions and once satisfied with their positioning can confirm in the single axial or oblique axial plane MRI image that the rectangular dimensions are contained within the ROI in the axial or oblique axial direction.

Once the user is satisfied with the rectangle dimensions and angles the process can proceed to block and perform the MRS scan. Blocks through can then be repeated for additional ROIs e.g. additional intervertebral discs to be scanned.

An example of the potential risks associated with manual prescription is illustrated by reference to and A D which illustrate another MRS exam of another subject where one MRS exam conducted according to a mis prescribed voxel is compared against the MRS results of another MRS exam conducted with a more appropriate prescription .

More specifically show mid sagittal mid coronal and axial or oblique axial 2 dimensional 2D planar views of MRI images taken during imaging phase of an illustrative MRS exam of a human subject s spine including a disc bordered by superior and inferior end plates between disc and superior and inferior vertebral bodies located above and below disc . Shown superimposed on these planar MRI images is a rectangular voxel drawn per a manual prescription as described above. The voxel as shown in potentially impinges on one or both of end plates . An MRS exam per this manual voxel prescription conducted according to an MRS pulse sequence and post processing system and method similar to that described in PCT Patent Publication No. WO 2011 047197 produced the MRS spectrum shown in . MRS spectrum includes a relatively narrow and distinctive n acetyl aspartate NAA peak typically representative of proteoglycan PG in disc nucleus tissues and a still stronger peak with much wider line width e.g. broad between opposite sides of the peak such as at 50 power of peak that spans across spectral regions associated with lactic acid and alanine respectively. This strong broad peak region is characteristic of lipid signal. If and to the extent any lactic acid or alanine signal may or may not contribute to the signal intensity in this region is difficult to ascertain.

In contrast show similar images for the same spine in the same subject and in fact during the same MR study session but for a different MRS exam scan according to a different manual voxel prescription shown at voxel . As compared against voxel shown in the prior manually prescribed exam of voxel has slightly reduced height vertically across disc and potentially excludes end plates either of which may have been partially captured by the larger voxel with the larger vertical height dimension in the prior exam. The MRS spectrum acquired and processed for this voxel prescription according to similar MRS pulse sequence and post processing methods as reflected in the spectral results shown in for the prior exam is shown in . The Proteoglycan related n acetyl aspartate NAA peak for spectrum is slightly reduced signal intensity than the similar peak shown in between about 8 to 9 10for peak versus about 12 10for peak as would be expected from a smaller voxel in the second case. However the overall signal quality is apparent to be much more robust as the lactate related and alanine related spectral ranges include only a slight peak possibly related to small level of lactic acid but the spectrum appears to be substantially devoid of prominent lipid. By comparison of this first and second voxel prescription results lipid peak appears to have been the result of captured end plate contaminant in the MRS spectrum of the over prescribed voxel dimensions in that case.

Example embodiments relating to automated voxelation methods are provided below by reference to . More specifically shows a software flow diagram of an automated voxelation method that can be used by an automated voxelation system such as the system of discussed below. As discussed in more detail below the system can include an MRI MRS system configured to acquire MRI images of a region of interest in a portion of a patient s body and or to perform an MRS exam or procedure using the voxelation. The system can also include a computer system that can have a processor and a computer readable medium which can be configured to execute a program that performs some or all of the method shown in . The method of can include image processing including further detailed blocks shown ROI location and isolation including further detailed blocks shown 2D voxel formation including further detailed blocks shown and 3D voxel formation including further detailed blocks shown. Various aspects of the method are further illustrated in additional as follows.

Additional details relating to various aspects of the process described above are provided below. It is generally to be appreciated that the current systems and methods may be employed using a variety of different types of resources including software programs utilities etc. According to certain detailed present embodiments a software utility program MATLAB can be used. More specifically the specific examples provided for detailed illustration in some embodiments have been put into actual use using the R2010b version of MATLAB along with the MATLAB Statistics and Image Processing toolboxes within that version.

At block the process locates an MRI image which can be a sagittal MRI image through the center of the ROI e.g. having the largest ROI cross sectional area . In some embodiments the automated voxelation can use the same working set of MRI images used in manual voxel prescription process. Prior to image use in some embodiments the automated voxelation system and method can access the image files in each series and form a volume image structure for each consisting of a stack of image arrays.

In some embodiments the method for collecting the sagittal coronal and axial or oblique axial image sets can be performed automatically or can be partially automatic. In some embodiments a user can identify a mid sagittal location for the mid sagittal image e.g. by selecting one of a series of low resolution images that corresponds to a sagittal center position and the system can automatically compile a series of high resolution MRI images including a mid sagittal MRI image at the location indicated by the user as well as other sagittal images taken at planes substantially parallel to and space from the mid sagittal image. In some embodiments some or all of the image processing phase and ROI location and isolation phase can be performed on a plurality of MRI images before a center slice is identified so that a center MRI image can be identified by automatically comparing the sizes of the ROI in the plurality of MRI images. For example the system can access a plurality of MRI images taken from substantially parallel planes that intersect the ROI can calculate an area of the ROI in the plurality of MRI images and can use the image with the largest ROI area as the center slice for voxel positioning. When multiple ROI e.g. multiple intervertebral discs are being analyzed the system can calculate the ROI area for the multiple ROI in the plurality of MRI images and can select a center MRI image having the largest aggregate ROI area combined from the multiple ROI. This approach can be beneficial for example when identifying multiple voxels e.g. for multivoxel MRS procedures with multiple ROI. In some embodiments a center MRI image can be selected based on the largest ROI area for a single ROI and in some cases the system can allow for different MRI images to be selected as the center MRI image for different ROI. This approach can be beneficial for example for single voxel MRS procedures. The system can access multiple MRI images e.g. taken from substantially parallel planes and can test all or a subset of the images e.g. the middle 7 images of an array of 13 image slices to identify a center image. The system can start with an image at the middle of a series of images and can measure the ROI area for a number of images e.g. 3 images on either side of the middle image in the series of images.

In some embodiments the selected center image can be an image other than the middle image of the series of MRI images and the selected center image can in some cases correspond to a slice that is not through a center of the disc or spine or patient s body. A center image can be the middle image of a series of MRI image slices and can in some cases pass through substantially the center of the ROI the disc the spine and or the patient s body. Many other variations are possible. In some embodiments the system can identify the MRI images that have an ROI interest that meets a threshold amount and can define the center MRI image to be the image at the middle of the series of images that meet the threshold FOI area amount. In some embodiments the system can omit the identification of a center image. For example the system can use some or all of the MRI images to generate a 3D model of the ROI without identifying a center image for the ROI. A voxel can be formed based on the 3D model of the ROI without identification of a center image for the ROI.

In some embodiment the center image identification process can be repeated for the coronal series and axial or oblique axial series of MRI images in the coronal and axial or oblique axial planes. In some embodiments the voxelation method can use MRI images taken from only a single axis e.g. the sagittal axis for prescribing a voxel for the ROI. Thus in some embodiments the images of one or both of the other two axes e.g. the coronal and or the axial images can be omitted. In some embodiments the system can locate the ROI and or positioned the voxel based on images from a single axis e.g. sagittal and the system can use one or more images from one or both of the other axes e.g. coronal and or axial for displaying information to the user such as for showing a 3D voxel in a 3D presentation between multiple images of different planes as shown in and discussed below.

In some embodiments as part of the image processing the system can convert the MRI image to a different format such as from DICOM Digital Imaging and Communications in Medicine image data to MATLAB gray format with double precision intensity values in the range from 0 to 1. Portions of the MRI image can correspond to the ROI and surrounding area in a physical target object e.g. a patient s spine . Although many embodiments disclosed herein are described in connection with MRI images it will be understood that various types of electronic images can be used. An electronic image can be any electronic representation of an image and may be related to MRI CT PET X ray or other modality. The electronic image can include an image coordinate system and a plurality of pixels with unique respective image coordinates. Such electronic images may be considered acquired from a subject by virtue of the respective imaging modality that gathers information from the body which is then converted to the electronic image. An electronic image may comprise for example a single 2D planar image with x y x z or y z coordinates or a series of related 2D images in different planes that provide a coordinated picture of a region such as may be combined in an array of images to provide a 3D image. Thus throughout this disclosure various types of electronic images can be used in place of the MRI images that are specifically discussed. The system can access metadata from the image files to support 3D interpretation of the image coordinate data in 3D machine coordinates also referred to as world coordinates for current purposes of this disclosure. For example the system can form 4 4 homogeneous coordinate transformation matrices from the metadata to support image to machine coordinate transformation. Thus images coordinate data corresponding to portions of the MRI image can be converted or transformed into world coordinates corresponding to portions of the target object. In some embodiments the system can then organize all the above data into an AutoVox data structure that contains all the information to create a 3D volume display in machine or world coordinates. One example of a 3D volume display is shown in which is discussed below.

In order to analyze an MRI image image processing can be performed to smooth the image level the intensity variation from anterior to posterior remove the bright spinal column and posterior fat signal and finally emphasize the ROI e.g. disc nucleus . The result of image processing can be an image consisting almost exclusively of emphasized sub images of multiple ROIs as shown in .

Various types of image smoothing can be used at block . For example the system can perform 3D smoothing using the MATLAB function smooth3 with a 3 3 3 cubic kernel. This 3D smoothing algorithm accesses the selected sagittal image and the sagittal images which bracket it in the image stack. This algorithm was found to provide notably better smoothing than a 2D algorithm with the 3D smoothing algorithm producing essentially no loss of edge acuity. Thus in some embodiments an image smoothing operation can modify the brightness of a pixel based on the brightness values of neighboring pixels for example setting the pixel brightness to an average value or a weighted average value etc. In some embodiments the neighboring pixels can be part of the same image e.g. a 3 3 or 5 5 area around the pixel and or can be part of other images in the series of substantially parallel images e.g. sagittal MRI images . For example in the 3 3 3 kernel mentioned above can use the adjacent image on both sides of the image containing the pixel being processed. The kernel can be referred to as cubic because the number of pixels that are used to modify the brightness of a pixel are equal e.g. 3 in each direction e.g. x y and z even though the physical volume may not form a cube. For example in the 3 3 3 cubic kernel example the distance between adjacent MRI slices can be larger than the distance between pixels within the same image resulting in the cubic kernel coving a somewhat elongated rectilinear volume rather than a cube.

At block top hat filtering can be performed on the MRI image. The top hat filtering can be configured to deemphasize e.g. darken or remove portions of the image that correspond to features other than the ROI while preserving the ROI portions of the image. In the example of intervertebral discs the spinal column and posterior fat can form bright portions of the image e.g. due to high water content and the top hat filtering operation can be configured to deemphasize these features while preserving the disc portions of the image. The system can perform for example morphological top hat filtering on the image using vertical linear structuring element 50 pixels tall and 5 pixels wide. The structuring element can be effectively 50 running averages with 5 data points per average that is shifted across the image. The structuring element can be generally shaped like the shape of the structures to be deemphasized. As the structuring element is swept across the image if the pixels covered by the structuring element satisfy a criteria e.g. a threshold brightness level then the pixels covered by the structuring element can be deemphasized e.g. darkened or removed . In the illustrated example the structuring element can be generally tall and thin e.g. 50 pixels tall and 5 pixels wide so that the structuring element can fit into the vertically oriented spinal column and fat portions of the image and not fit into the intervertebral disc portions of the image which are generally ellipsoidal in shape and relatively short and wide. Thus the top hat filtering can primarily target removing the bright water signal of the spinal canal and minimizing the signal from the posterior fat. The top hat filtering can primarily deconstruct the bright water rich image of the spinal canal in the MRI image to facilitate the algorithm that searches for the bright e.g. water rich oval shape associated with the disc nucleus. It also can have the effect of leveling the intensity of the image. The top hat filtering operation can basically remove or darken any parts of the image which it can encompass by the structuring element. Its dimensions are selected so it does not affect the ROI e.g. disc nucleus images.

In some embodiments a first top hat operation does not effectively remove the signal from the lower curved portion of the spinal canal typically below L4L5. The system can then perform a second top hat filtering operation with the structuring element as a line 50 pixels long and at a 45 degree slope to target the sloping lower portion of the spinal canal to target the lower curved portion of the spinal canal. Many variations are possible. Many different configurations of top hat filtering operations can be performed depending on the shape and structure of the ROI and the surrounding area and multiple top hat filtering operations of various different numbers can be performed. In some embodiments other forms of morphological image processing operations can be performed to either emphasize the ROI or to deemphasize the regions of the image not associated with the ROI.

At block the system can perform order statistic filtering to further smooth and level the image while preserving edges. In some embodiments two dimensional 2D order statistic filtering can be used. The kernel or domain for the order statistic filtering can be a 5 by 5 pixel square although other sizes can be used. The order statistic filtering can set the brightness of a pixel based on the brightness of neighboring pixels. In some embodiments the sixth order can be used although other orders can be used. For example in the sixth order embodiment the filter operation can order the neighboring pixels and the analyzed area e.g. 25 pixels in the 5 5 example from darkest to brightest and the filter operation can set the brightness value of the analyzed pixel to the sixth brightness value from the darkest. Thus the order statistic filtering operation can generally darken the image except for pixels of the image that are generally surrounded by other bright pixels. The 5 5 kernel and sixth order parameters were optimized experimentally for some applications relating to intervertebral disc ROI but many other configurations e.g. of size shape and or orders can be used depending on the application. This operation can serve to remove small speckles and fill small holes while generally preserving edges of the ROI.

Many variations to the disclosed image processing can be made. For example in some embodiments one or more of the operations discussed herein can be omitted or combined with other operations. For example in some embodiments the method can use only one of 3D image smoothing and order statistic filtering for removing noise etc. and the other of 3D image smoothing and order statistic filtering can be omitted. Also as discussed elsewhere herein in some embodiments the method can locate a center image at a later stage of the method or the locating of a center image can be omitted entirely. Also additional image processing operations can be added in combination with or in place of the operations illustrated in the image processing phase of . For example various other types of noise reduction filters can be applied. Also a contrast enhancing filter can be applied to emphasize contrast in the image to facilitate identification of the edges of the ROI. In some embodiments edge detection can be performed on the image to identify or emphasize the edges of the ROI. The methods and systems disclosed herein can perform one or more of the operations of the image processing phase alone or with various combinations of the other components of the method shown in or described herein.

Having processed the image to emphasize the ROI e.g disc nuclei while preserving their location the system can next isolate and locate the ROI e.g. disc nuclei at phase . At block default search areas can be applied to the image. For example in the illustrated embodiment statistics on the location of each disc level in the image have been developed. For the default search areas shown in a training set of ten MRI studies where digitized to locate disc center and disc tilt. The means of the disc centroid and disc tilt were used to define an ellipsoid search area for each level such as shown at default ellipsoid search areas in . For each level the search area ellipse has a semi major axis of 60 pixels and a semi minor axis of 30 pixels and is centered on the mean location in image coordinates for a disc at that level and the tilts for each level are 0 0 5 18 and 30 for levels L1L2 to L5S1 respectively although other configurations can also be used. This approach is justified as the lumbar image prescription protocol is very well standardized and followed in the studies acquired to date. In some embodiments the system may use active shape modeling to locate ROIs or operator intervention to identify and or confirm ROIs.

As would be apparent to one of ordinary skill based upon the disclosure immediately above this present illustrated embodiment thus provides a template for refining statistical methods to determine actual disc locations based upon an atlas applied to the image developed from pre existing knowledge of typical locations derived from prior acquisitions and segmentation defining the disc locations which segmentation may even be done manually for purpose of creating the atlas . The template provides default regions in which the various disc levels in spines previously used to construct the template were known to be located thus providing default regions applied to a given spine image so that processing algorithms may more effectively narrow a focused statistical search for the actual discs within that one new spine image. In some embodiments a single default search area can be applied if a single ROI is to be identified and in some embodiments a plurality of default search areas can be applied if multiple ROI to be identified.

After applying default ellipsoid search areas to the image such as at block of Phase of the voxel automation the following can be performed. At block for each or one or more of the elliptical search areas all the pixels within the area which have a particular property e.g. an intensity of at least 0.15 can be assigned to a pixel population corresponding to the ROI. The pixels can be identified by their spatial coordinates in the image which correspond to world coordinates in the imaged object .

In some embodiments the system can analyze the population of pixels based on a reliability criteria. One criteria that may be applied for example is to require a certain threshold number such as for example at least 300 of pixels in the pixel population or grouped together to qualify as a reliable estimate. In some embodiments a tiered approach can be used depending on the number of pixels detects as part of the pixel population. In some embodiments if there are between 150 and 299 pixels the pixel population may still be processed but considered and flagged as potentially unreliable or the pixel population may be kicked out of the automated system for manual prescription or further algorithms may be employed specifically tailored to overcome such circumstance. If there are fewer than 150 pixels in some embodiments the system can be set such that no attempt is made to locate the corresponding disc. Many variations and alternatives are possible. The comparison of the reliability criteria can reduce or avoid incorrectly keying on residual image artifacts as though they were a ROI. The aforementioned values have been empirically determined for a given population of examples which is relatively small. Thus values other than those specifically disclosed herein may be used in view of further data of clinically relevant numbers representative of a given target population distribution. Also values other than those specifically disclosed herein may be used for other specific applications other than that described herein e.g. voxelation in regions of the body other than intervertebral discs .

In this regard it is to be appreciated that the default and estimated aspects of these detailed embodiments applied may be influenced by certain subject dependent variables such as height weight BMI gender age race or ethnicity. The present disclosure contemplates that aspects of the present embodiments may take such variability into account such as for example generating default ellipsoid search areas from spine MRIs from target numbers of samples on such uniquely identifiable sub population bases e.g. based on age gender race height weight or BMI .

Accordingly some embodiments of this disclosure contemplate use of further algorithms and methods to distinguish possible sources for such potential artifact such as by statistical methods to exclude artifacts in one step from being used in calculations in the next step e.g. confidence interval calculations basing on separation between strongest contiguous signal region location relative to the default ROI combinations thereof etc. . In some embodiments artifacts can be excluded by review of the quality of the results shown in relative to signal intensity contrast or image homogeneity captured within the drawn shape. The results can be modified to correct or allow for circular correction algorithms back to prior operations but performed differently based on data obtained from subsequent operation s . In the example of a neighboring function can be performed that identifies that the identified population of pixels includes a neighboring group of pixels near the main group of pixels and the neighboring function can cause the neighboring group of pixels to be excluded from analysis of the population of pixels. The neighboring function can identify neighboring groups of pixels that do not contact and are separated from the main group of pixels. In some embodiments the neighboring function can be configured to identify a neighboring group of pixels that do contact the main group of pixels by recognizing that the neighboring group of pixels do not conform to an expected shape of the ROI for example if the bright spot of were connected to the bright ellipsoid disc shape as an arm or extension that does not fit with the ellipsoid shape.

In some embodiments further manual opportunities may be provided for assistance. For example the image shown as modified in may be presented to a user to allow for regions to be manually captured e.g. mouse drag for exclusion or inclusion. Manual indications of areas of exclusion or inclusion may be done as a matter of course or may be done only when a particular interim result is flagged as potentially erroneous and thus appropriate for manual intervention. Thus in some embodiments review of the process and or results can be performed in order to optimize results or to correct or remove sources of error.

At block the system can calculate a two dimensional model from the shape of the population of pixels. In the embodiment illustrated in for the cluster of pixel locations identified in each level search area an expectation maximization algorithm for decomposing Gaussian mixtures EM GM algorithm can be applied at block . The EM GM algorithm can provide parameters e.g. means and covariance matrix of a two dimensional Gaussian distribution representing the spatial distribution of the pixels in the cluster. A cross section or footprint of the 2D Gaussian distribution can have a generally ellipsoidal shape. With appropriate scaling experimental observation indicates that the EM GM algorithm appears to form a very good approximation to the generally ellipsoidal shape of the disc nucleus although other methods can be used to form a 2D shape or model based on the population of pixels. In the illustrated embodiment examining the eigenvectors of the covariance matrix can be used to yield the orientation tilt of the disc which initial experimental observation has also suggested results in very good accuracy. An experimentally determined scale factor of 2.5 can be applied to the standard deviations from the covariance matrix to use as the semi major and semi minor axes of the disc ellipse estimate. Various other shape approximation operations can be used to estimate the shape of the ROI based on the population of pixels identified at block . For example active shape modeling statistical shape modeling or various other techniques such as those generally referred to as blob detection can be used to estimate the shape of the ROI.

Many variations to the disclosed ROI location and isolation process can be made. For example in some embodiments one or more of the operations discussed herein can be omitted or combined with other operations. For example in some embodiments the image processing can emphasize the ROI so that the process can locate the populations of pixels without using the applying the default search areas at block . In some embodiments a default area e.g. formed by atlas based segmentation and or historical date of common ROI locations can be used after ROI detection or after voxel formation as a check. For example if the location of an identified ROI or prescribed voxel does not fit into or correspond with the default area the identified ROI or prescribed voxel can be flagged as potential unreliable disregarded presented to the user for review recalculated and or adjusted. Also operations can be added in combination with or in place of the operations illustrated in the method shown in . For example as mentioned above various types of blob detection techniques can be used to identify the shape of a ROI.

Also in some embodiments the method can use user input along with automated procedures to identify the ROI. For example the user can be permitted to identify a location e.g. by clicking on the image that is inside of the ROI a single location for a single ROI or multiple locations for multiple ROI to provide guidance in locating the ROI. For example the process can search within an area centered on the location identified by the user to search for the ROI boundaries. For example the process can use an edge detection operation to identify edges of the ROI around the location identified by the user. The program can also use the image brightness of the location clicked by the user in determining what brightness threshold to apply for identifying other pixels associated with the ROI. The contrast ratio between ROI and non ROI portions of the image can vary significantly between patients but if the user specifies a location that is known to be part of the ROI the brightness of that portion of the image can be used to set the brightness threshold used to identify other portions of the same ROI or of other ROI. In some embodiments the program can allow the user to identify e.g. click points outside the ROI such as along one or both of the end plates that surround the intervertebral disc and the program can use those points to guide the locating of the end plates or of the ROI e.g. disc between the end plates . The program can select the voxel size and or orientation based at least in part on the clicked end plate points e.g. by fitting a linear line or curve between the clicked end plate points and placing the voxel between the lines associated with the end plates. The end plate clicks can be used to define a search area for locating the ROI as well.

The methods and systems disclosed herein can perform one or more of the operations of the ROI location and isolation phase alone or with various combinations of the other components of the method shown in or described herein.

Given the above ROI disc nucleus characteristic data provided per the operations above it becomes possible to automatically form two dimensional 2D shapes or voxels at phase . At block image coordinate data can be extracted and at block the image coordinates can be converted to world coordinates using a transformation matrix. The system can for example apply an experimentally determined scale factor e.g. of 2.9 times the image to world scale factor e.g. 0.39 from the DICOM metadata to the semi minor axis to determine the voxel thickness in the z axis axial axis and to the semi minor axis to determine the voxel dimensions in the machine y axis coronal axis as shown in block . In some embodiments the 2D shape can be a rectilinear shape such as a rectangle although many other 2D shapes can be used. Many variations are possible. Various components of the 2D voxel formation phase can be combined or omitted. For example in some embodiments the 2D shape can be defined in image coordinates and then the coordinates of the 2D image can be transformed to machine or world coordinates or the transformation to world coordinates can be omitted from the 2D voxel formation phase for example by transforming image coordinates to world coordinates after the 3D voxel is formulated. The methods and systems disclosed herein can perform one or more of the operations of the 2D voxel formation phase alone or with various combinations of the other components of the method shown in or described herein.

3D Voxel Formation of phase can include determining voxel width across the coronal plane or x axis sagittal axis which can include the following. The system can locate a sagittal slice adjacent to the previous processed sagittal image slice at block and can repeat image processing ROI location and isolation and 2D voxel formation for the sagittal slice adjacent to the previously processed sagittal image. The system can compare the newly calculated 2D voxel to the 2D voxel from the previously processed sagittal slice to determine if the previously established 2D voxel dimensions fit within the current 2D voxel of the current sagittal slide being analyzed. The system can modify e.g. decrease the 2D voxel dimensions if required to fit the current 2D voxel. This process can be repeated for each sagittal slice being considered e.g. until all sagittal slices that encompass the ROI have been analyzed . A three dimensional 3D volume or voxel can be formed using the final 2D voxel dimensions as a cross sectional shape for the 3D voxel projected across the width of the analyzed sagittal slices to form a rectilinear volume. Although many embodiments are described herein as using a series of MRI images corresponding to sagittal slices coronal axial or oblique axial MRI images can also be used.

In some embodiments the volume of the 3D voxel can be increased or maximized while also being contained within the ROI. For example for a voxel with a rectilinear volume shape and a ROI having a generally ellipsoidal shape e.g. an intervertebral disc various 3D voxel shapes and sizes can be used having various different dimensions e.g. a voxel having a smaller height may have a larger length and or width while remaining contained in the ROI than a voxel having a larger height which can have a smaller length and or width in order to fit into the ROI . The system can select a 3D voxel having a maximized or increased volume. In some embodiments one or more of the MRI images may not contribute to the formation of the voxel for example if inclusion of an MRI image near the end of the ROI would require that the height of the voxel be reduced to a degree that would lower the total volume of the voxel the MRI image near the end of the ROI can be disregarded for the forming of the voxel. In some embodiments the volume can be maximized by defining a voxel for multiple combinations of MRI images and the voxel with the largest volume can be selected. For example for an array of MRI images having 13 slices voxels can be defined using 13 slices 12 slices 11 slices 10 slices etc. The volumes for the voxels can be calculated and compared and the voxel having the largest volume can be selected e.g. a voxel using 9 MRI images and omitting the 2 end slices from each side . In some embodiments the voxel can be formed to provide an increased or maximized dimension e.g. height width or length of the voxel.

In some embodiments the process can define the voxel contained within an inward offset from the boundaries of the ROI. For example the offset can provide a buffer that can prevent the voxel from covering non ROI tissue in the event of minor inaccuracies in voxelation and or minor patient movement during a procedure. In some cases if the voxel were defined to reach to the edge or very close to the edge of the ROI patent movement during the examination or minor inaccuracies in voxelation can cause the voxel to cover a portion of non ROI tissue during a procedure which can reduce the quality of the procedure as discussed above. The offset can be applied at various stages of the process. For example in some embodiments the final voxel can be reduced in size after voxelation. The population of pixels can be reduced in size after being populated for example by removing a layer of pixels e.g. 1 2 5 10 pixels etc. at the edge of the population of pixels. The size of the shape that approximates the population of pixels can be reduced in size or the 2D voxel shapes can be reduced in size before they are used to form the 3D voxel. The process can be configured to increase or maximize the area of the voxel similar to the description above while containing the voxel within the inward offset boundary of the ROI.

In some embodiments multiple voxels can be formed for a single ROI. For example a plurality of rectilinear voxels can be positioned inside of an ellipsoidal shape to increase the amount of the ellipsoidal shape that is included for a procedure. The plurality of voxels can have different shapes and or sizes. For example a relatively large voxel can be positioned at a central region of the ROI and one or more smaller voxels can be positioned around the larger voxel in the ROI. In some embodiments the plurality of voxels can have the same size. For example a standard voxel size and shape e.g. cube or square can be used and the process can be configured to fit the standard voxels into the shape of the ROI.

Many other variations are possible. For example in some embodiments the y axis coronal axis value can be set equal to the x axis sagittal axis value thereby simplifying the voxel formation. In some embodiments instead of modifying the 2D shape as needed at each sagittal layer the system can form the 2D shapes for each sagittal layer independent of the other layers and the system can then define the cross sectional shape of the 3D voxel to be the area shared by all the 2D shapes when the 2D shapes are overlay on each other. In some embodiments the 3D voxel can be a non rectilinear volume shape. For example the 3D voxel can be formed by connecting the multiple 2D shapes e.g. by interpolating to form a 3D voxel which can have an irregular shape not defined by an equation or mathematical shape. In some embodiments the system can skip the 2D voxel formulation phase . For example the system can calculate a 3D model for the ROI based on the populations of pixels that are identified in the series of parallel sagittal slices. A 3D voxel can then be selected that fits into the 3D model. For example a 3D voxel can be selected that provides an increased or substantially maximized volume for the given 3D model.

At block the 3D voxel can be displayed for example so that a user can inspect the 3D voxel. As shown in the 3D voxel can be displayed relative to a mid sagittal MRI image a mid coronal MRI image and or an axial or oblique axial MRI image not shown in so that the 3D voxel can be compared to the ROI displayed on the MRI images. In some embodiments the system can allow the user to manipulate the view of the 3D voxel for inspection at various angles. In some embodiments the system can allow the user to manually adjust the size or shape of the 3D voxel. In some embodiments block can be omitted. In some embodiments block can be performed only if one or more of the prior operations caused the procedure to be flagged as being potentially unreliable.

At block the system can display the voxel dimensions coordinates and or angles for the user. In some embodiments the voxel dimensions coordinates angles and or other voxel data can be transferred to an MRS system so that the 3D voxel can be used as a scan area during a MRS exam as described above. The system can provide the 3D voxel information to the MRS system in machine or world coordinates. The conversion from image coordinates to world coordinates can be performed at various stages of the process . For example in some embodiments the system can convert image coordinates for the pixels in the population of pixels to world coordinates and the formation of the 2D model 2D voxel 3D model and or 3D voxel can be done in world coordinates. In some embodiments the system can use image coordinates for formation of the 2D model 2D voxel 3D model and or 3D voxel and the final data transferred to the MRS system can be converted to world coordinates. It will be understood that the conversion from image coordinates to world coordinates can be performed at other stages of the process than those specifically identified.

The methods and systems disclosed herein can perform one or more of the operations of the 3D voxel formation phase alone or with various combinations of the other components of the method shown in or described herein. Various components of the illustrated 3D voxel formation phase can be combined omitted or supplemented with additional components.

In some embodiments the program can use images of different modes to improve the accuracy of the voxelation process or to check the accuracy. Different modes of MRI images can be for example MRI images made using a T1 process first mode and MRI images made using a T2 process second mode . The images can be made of the same tissue to allow for comparison between the images of the different modes. The voxelation process can be performed on the images of different modes and the resulting voxel results can be compared. Because images of different modes can have differences such as different contrast ratios applied to different tissues the resulting voxels can be different for each mode of imaging. The voxels produced using the different modes of images can be combined e.g. averaged to form a final voxel to be used in the MRS exam. Thus if one mode of images does not sufficiently represent one aspect of the tissue being imaged one or more of the other modes of images can better represent that aspect of the tissue and improve the accuracy of the final voxel. The voxels produced by the different modes of images can also be compared and if the differences between the voxels is above a threshold level the voxelation process can be flagged as potentially unreliable can be restarted can be aborted or can be supplemented with additional operations designed to minimize errors. In some embodiments the information derived from the images of different modes can be compared or combined before voxel formation for example after defining populations of pixels for the multiple images of different modes the defined pixel populations can be combined e.g. averaged or compared to confirm accuracy.

One further embodiment uses two different images of the same area of tissue via two different imaging modalities and performs an image fusion operation between them. In one embodiment the fusion operation includes a differencing between the images to produce a third differencing image. In another embodiment the fusion operation comprises performing a blending or merging between the images e.g. alpha blend for example . Such image fusion according to these or other illustrative examples is applied in certain embodiments for emphasizing contrast at certain particular tissue structures or interfaces between adjacent amorphous tissue structures such as that vary in different chemicals that are respectively emphasized by each different modality. One particular embodiment differences T1 and T2 weighted images whereas another applies the fusion e.g. differencing or blending to emphasize contrast at the borders e.g. bony boundaries of musculoskeletal joints e.g. adjacent vertebral bodies bordering intervertebral discs whereas another applies this T1 and T2 weighted image fusion to musculoskeletal joints such as spinal joints. According to these various embodiments the results of the fusion themselves may provide various different benefits either in their own right for diagnostic image analysis or for further downstream operations such as for example consistent with other embodiments disclosed herein e.g. for use in generating voxel prescription generating related structural measurements directing certain further operations or otherwise regarding segmented target regions of interest or other purposes and combination uses .

This T1 T2 differencing shown in was derived by processing the T1 and T2 weighted images of as follows. Differencing is a built in capability on most scanner or image viewer systems either for post processing after a study or such that a technician operator may readily do so at the time of an exam e.g. to check for patient motion which may be a valuable utility to determine if a rescan may be required or a good idea clearly best determined if possible while the patient is still in the imaging modality . Commercially available software packages and related tools such as for example MATLAB Version 7.14 with Imaging Processing Toolbox Version 8.0 a commercially available programming language and environment from MathWorks Inc. provides the capability to directly perform image processing operations including fusion as described above. For example the difference image of was generated by the MATLAB code segment 

It is also noted that the illustrated embodiments shown in are negative images of the processed combined image approaches as in the target contrast area of the end plate borders were observed to be particularly emphasized in that negative mode. The reference T1 and T2 weighted images shown in are shown with contrast and brightness settings range and center as would typically be viewed. However contrast can be varied to also vary the results. For example show the same differencing result at lower and higher relative contrast settings with varied emphasis at the end plate borders which may impact how subsequent functions operate to segment the disc or conversely vertebral bodies between adjacent end plates . Note also that the contrast is also clearly emphasized not just at the end plate borders but also along the lateral anterior and posterior walls of the spinal column both along the vertebral bodies and disc regions in particular via bright white in . This results in nearly completely defining the enclosed circumferential borders surrounding these respective tissue structures of the spinal linkage system e.g. serial vertebral bodies and discs and are well permissive for success in further refinement operations such as edge detection and or modeling for use in other applied purposes e.g. dimensional or volumetric measurements voxel prescription or other further aspects of this disclosure . The processed images are on same slice from a multi slice acquisition in the particular case slice .

In performing these imaging combining approaches such as for example differencing and or to show evidence of motion between images taken at two different time points the field of views may be the same or the two acquisitions may be performed with different resolutions. For illustration a T2 weighted image may be a 320 320 image while the T1 maybe a 384 384 image for example. In this situation they could be resampled to equalize them and then difference or otherwise combination process them. An acquisition protocol may also specify that the different images be collected under the same prescription to facilitate differencing or other combination processing.

The differencing vs. blended approaches illustrated in these examples may vary or be roughly equivalent in terms of respective benefits for a specific implementation. In this particular case while roughly equivalent the blended approach may be slightly superior for endplate emphasis. Certain other aspects may impact results such as for example leveling which generally refers to compensating for the brightness variation that varies with signal strength as a function distance from the receive coil. On for example the fat is much brighter posterior than anterior but not with such apparent difference on the T2 of FIG. B a difference which could potentially impact preferred images in a given case such as one fusion approach vs. another.

An additional step in such image combining processing may also include a registration operation to ensure exact overlay anatomically between the images as they are taken at different times in the sequencing and patient motion may intervene . Commercial tools are available for such registering between two separate images such as for example the MATLAB referenced above Image Processing Toolbox function imregister . Registering may also be done for example by use of commercially available software packages or utilities such as for example the same MATLAB package referenced above for other operations but for example using a code segment such as the following 

This transforms the first image T1s6 to be in alignment with the second T2s6 and returns the transformed registered image as T1Reg. The first line defines a set of parameters to the registration algorithm appropriate for registering images of different modalities in particular having different brightness ranges.

In this particular example of registering the separate T1 and T2 weighted images was tried although no need was apparent as they are in essentially perfect registration in their original forms.

It is to be appreciated that these embodiments illustrated above by reference to are shown and described in context of an MR scanner operation and in particular context of T1 and T2 weighted images. However the broad aspects contemplated may also be achieved by further embodiments involving different pulse sequence acquisition approaches E.g. T1rho or T2 a combination of more than 2 different images or images taken on different imaging modalities than these specific examples.

In some embodiments the system can include an MRI system which can be used to acquire the MRI images . The system can also include an MRS system configured to perform an MRS exam which can use a voxel provided by the system as a scan area. In some embodiments the MRI system and the MRS system can be integrated into a single system configured to generate MRI images and to perform MRS examinations. In some embodiments the MRI system and or the MRS system can be omitted and the system can perform voxelation without being connected to the MRI system or the MRS system . The components of the system can be in communication with each other and can be located in close proximity to each other. For example the entire system can be integrated into a single device e.g. with a computer system integrated into a joint MRI MRS system . The components of the system can be located in a single room or within the same building e.g. a hospital . In some embodiments some components of the system can be located remotely from other components. For example the MRI system and or the MRS system can be located remotely from the processor and computer memory and a communication connection can be established using the internet or a network. In some embodiments the prescription of one or more voxels or other analysis of the ROI can be performed by a different system or by a different party than the system or party that acquires the images and or performs the MRS exam. In some embodiments the prescription of one or more voxels or other analysis of the ROI can be performed at a later time and or at a different place than the acquisition of the images and or than the MRS exam.

In some embodiments the MRI images can be acquired e.g. by MRI system using a first acquisition mode e.g. T2 MRI imaging and an MRS procedure e.g. performed by MRS system can be performed using a second acquisition mode e.g. T1 rho MRI imaging . Thus in some embodiments the ROI locating and voxelation can be performed based on data obtained from the first acquisition mode e.g. T2 and the voxel can be used for a procedure or exam that uses the second acquisition mode e.g. T1 rho .

In some embodiments information provided by the ROI locating or voxelation process can be used for treatment of a patient. For example a voxel can identify a target area in the patient s body for treatment such as radiation therapy high intensity focused ultrasound therapy or various other procedures.

Although various embodiments are described herein in connection with nuclear magnetic resonance MR processes such as MRI and MRS other imaging and analysis processes can be used. For example a CT system an X ray system a PET imaging system or other imaging systems can be used for identifying or analyzing the ROI. Thus although many embodiments discuss the use of MRI images it will be understood that CT images PET images X ray images or images of a different modality can be used in combination with or instead of the MRI images discussed herein. Also although some embodiments discuss the use of the voxel or ROI information in connection with an MRS exam procedure it will be understood that CT PET X ray and other procedures can be performed based on the voxel or ROI information.

The lines leading from blocks and to the block illustrate that at various stages of the process data can be converted from image coordinates to world coordinates e.g. for use in an MRS exam or for locating a ROI . For example in some embodiments the image coordinates corresponding to the population of pixels can be converted to world coordinates that represent the location of a ROI. Thus in some embodiments the method can be performed for a single image and can proceed from block to and then to . In some embodiments one or more 2D models for a single MRI image or multiple MRI images or a 3D model can be converted to world coordinates for identifying the location size and or orientation of the ROI. Thus in some embodiments the method does not create a voxel to define a scan area for an MRS exam and the process can merely provide information about the ROI e.g. size location orientation to a user or to a system. In some embodiments the world coordinates can be used for an MRS exam or other procedure or can be reported to a user or system for additional analysis. In some embodiments the world coordinates can be used for additional portions of the processes disclosed in . For example a 3D model formed at block can be converted to world coordinates at block and the world coordinates can be used to form a 3D voxel at block . Also the 2D voxel shapes formed at block can be converted to world coordinates and the world coordinates can then be used for forming the 3D voxel at block . Many other variations are possible. Alternative flow paths through the flow cart of are possible other than those specifically discussed and are contemplated as part of this disclosure. The methods illustrated by can be implemented by a system such as system of .

The following United States patent application Publications are herein incorporated in their entirety by reference thereto US 2005 0240104 US 2010 0086185 US 2010 0268225.

The following additional references are also herein incorporated in its entirety by reference thereto 

As would be apparent to one of ordinary skill combinations and sub combinations between the disclosed aspects modes embodiments features and variations of references that are incorporated hereunder by reference thereto and the various aspects modes embodiments features and variations shown and or described in the present disclosure are further contemplated as part of and falling with the intended scope of this disclosure.

It is to be appreciated that the foregoing description provides many details with respect to the embodiments shown and or described. The specific details disclosed are intended to provide one of ordinary skill sufficient detailed examples to gain a full and complete understanding of the broader aspects of the present disclosure. While considered highly beneficial and illustrative of useful specific applications of the broader aspects contemplated hereunder such details however are not intended to be necessarily limiting to such broader aspects as would be apparent to one of ordinary skill. The present disclosure describes various features no single one of which is solely responsible for the benefits described herein. It will be understood that various features described herein may be combined modified or omitted as would be apparent to on of ordinary skill.

The present description provides for an automated voxelation system and method useful for providing voxels e.g. for single voxel MRS exams with particular application described for lumbar intervertebral disc nuclei. However the broad aspects may be applied to other specific applications without departing from the broad intended scope hereof such as larger disc volumes to include annulus often becoming less distinguished from nuclei in degenerative discs other disc levels along the spine or other structures of the body where single voxel MRS might be performed. Also the methods and systems described herein can be used in connection with multivoxel MRS exams.

Although many of the methods and systems described herein are described as using sagittal images to form a voxel or to model a ROI or otherwise provide information relating to a ROI in some embodiments coronal or axial or oblique axial images can also be used. For example a series of coronal plane slices can be used to create a 3D voxel for example by creating 2D voxel shapes for the coronal images modifying the 2D voxel shapes as needed to remain in the ROI and defining a voxel length in the y axis from the distance covered by the series of coronal images. Other methods disclosed herein can also be modified to use coronal or axial or oblique axial images where sagittal images are described.

Furthermore it is also contemplated that the various specific approaches taken among the various methods herein described for the specific application of automated voxelation also have other beneficial uses than only in such overall system and method. For example the current disclosure describes a system and method for automatically estimating the location shape and volume of intervertebral disc nuclei based on MRI images from an otherwise standard MRI exam. While this can be beneficial for further use in the additional automated voxelation approaches further developed in these detailed embodiments this approach and result alone is considered an independent beneficial aspect of the present disclosure with many beneficial uses contemplated. For example such result may be applied as useful for other MR based exams and pulse sequences such as for example estimating T1 or T2 signal intensities T1 rho data etc. for the defined ROI.

Similarly the voxelated results of the disclosure may be used for other applications than merely MRS such as immediately described above. By assigning a voxel to MRS data and also to other data acquired for the same region but using a different MR modality certain benefits may arise from such combination. For example MRS and T1 rho values can both be taken for the same ROI or voxel such as for example in a complex multi pulse sequence exam of disc chemistry which may be algorithmically diagnostically useful such as for example in calibrating an MRS curve based on NAA proteoglycan peak region calibration against T1 rho based calculations for the same. In yet a further example of other contemplated applications of various disclosed aspects the ability to automatically and accurately calculate disc angle disc height and other tissue structure related aspects are considered of broad value and application beyond only the specific further embodiments to which such accomplishments are put in the examples provided herein.

In some embodiments the location of the disc e.g. the center of the disc nucleus and the orientation of the disc e.g. the angle of tilt can be automatically identified as described herein and can be used to facilitate the prescription of clinical MRI imaging sequences in the sagittal coronal and axial or oblique axial directions. The location and orientation of the disc can be used to prescribe the location and orientation for MRI image slices to be used in clinical analysis. This can be particularly advantageous in the axial or oblique axial orientation where the angle of disc tilt can vary significantly between discs and between patients.

Still further the approaches taken in the current embodiments may be modified by one of ordinary skill without departing from the scope of the broadly intended aspects of this disclosure. For example one or more edge detection algorithms e.g. contrast based filter assisted etc. may be used to estimate the location and dimensions of the vertebral body end plates bordering above and below discs to facilitate exclusion of the end plates from a disc voxelation and MRS exam. These perimeter structures may themselves be estimated to prescribe a perimeter around a disc from the outside in approach and in which a voxel prescription is then optimized. Thus in some embodiments the methods and systems described herein can identify a population of pixels associated with a structure adjacent the ROI or otherwise useful in determining the location of the ROI. A model of the ROI and or a voxel defining a scan area can then be created in a manner similar to the descriptions above but wherein the populations of pixels are used to define the ROI from the outside in approach instead of defining the ROI directly. In some embodiments the anterior and posterior borders are less defined than the superior and inferior end plates which are typically well defined via T1 and or T2 MRI contrast . The system can automatically connect the anterior and posterior ends of the curvilinear estimated lines for the superior and inferior end plates to define the anterior and posterior borders to appropriately encapsulate the disc in at least many cases if not nearly all cases with only fringe exceptions. This is one example of another viable approach different than certain specific approaches shown and described herein by reference to the detailed illustrative embodiments and figures yet are considered within the scope contemplated herein and representative of the broad intended aspects of this disclosure.

While the present description is primarily directed toward automated voxelation systems and methods it is also to be appreciated that such disclosure may be applied in whole or in part as to the embodiments described and thus provide for more fully or only partial automation of the voxelation or related image reconstruction or region of interest estimation processes. Provisions for certain aspects to be automated and certain aspects to be manual may be made. For example a user operator technician can click on estimated centers of disc levels intended to be voxelated in order to indicate their general location relative to the field of view in the image. Such manual operations can either replace some of the automated estimation operations provided herein e.g. replacing the use of empirically derived default ellipsoid search areas or may rather enhance the likelihood of accurate results e.g. to better refine the locations at or by which to apply the other estimation algorithms . Moreover manual overrides may be provided at operator option. For example after automated voxelation the users may be permitted to re prescribe or modify the automated result based on their own observations and or knowledge of patient movement. In some cases the result of the automated voxelation can be automatically flagged for manual adjustment or inspection as described herein. For example if a potential source of error is observed by the automated system the system may prompt the user to inspect or modify the automatically generated voxel. In these regards the interim operations taken by the automation system may be made invisible to the operator or all or various operations may be made available to user for review which may aid in interpreting results. In some cases the operations can be made available to a reviewer of the results after completion of the voxelation or MRS exam report.

In some embodiments the system can perform a post acquisition scan for validation that the subject did not move during the MRS data acquisition. The system can automatically locate the targeted disc after the MRS data acquisition and compare that post acquisition position to the pre acquisition position to determine if the voxel prescription remains valid after the data acquisition. In some embodiments the post acquisition scan can be faster than the initial scan. For example in some cases only a limited area is scanned that is near the original position of the disc. In some embodiments only a post acquisition mid sagittal scan is compared to the pre acquisition mid sagittal scan to assess patient movement. In some cases the post acquisition disc location can be identified similarly as described above in connection with the pre acquisition scan and the coordinates of the pre and post acquisition scans can be compared and the acquisition can be deemed invalid if the difference is greater than a threshold value.

The present disclosure describes various features no single one of which is solely responsible for the benefits described herein. It will be understood that various features described herein may be combined modified or omitted as would be apparent to one of ordinary skill. Other combinations and sub combinations than those specifically described herein will be apparent to one of ordinary skill and are intended to form a part of this disclosure. Various methods are described herein in connection with various flowchart steps and or phases. It will be understood that in many cases certain steps and or phases may be combined together such that multiple steps and or phases shown in the flowcharts can be performed as a single step and or phase. Also certain steps and or phases can be broken into additional sub components to be performed separately. In some instances the order of the steps and or phases can be rearranged and certain steps and or phases may be omitted entirely. Also the methods described herein are to be understood to be open ended such that additional steps and or phases to those shown and described herein can also be performed.

Some aspects of the systems and methods described herein can advantageously be implemented using for example computer software hardware firmware or any combination of computer software hardware and firmware. Computer software can comprise computer executable code stored in a computer readable medium e.g. non transitory computer readable medium that when executed performs the functions described herein. In some embodiments computer executable code is executed by one or more general purpose computer processors. A skilled artisan will appreciate in light of this disclosure that any feature or function that can be implemented using software to be executed on a general purpose computer can also be implemented using a different combination of hardware software or firmware. For example such a module can be implemented completely in hardware using a combination of integrated circuits. Alternatively or additionally such a feature or function can be implemented completely or partially using specialized computers designed to perform the particular functions described herein rather than by general purpose computers.

Multiple distributed computing devices can be substituted for any one computing device described herein. In such distributed embodiments the functions of the one computing device are distributed e.g. over a network such that some functions are performed on each of the distributed computing devices.

Some embodiments may be described with reference to equations algorithms and or flowchart illustrations. These methods may be implemented using computer program instructions executable on one or more computers. These methods may also be implemented as computer program products either separately or as a component of an apparatus or system. In this regard each equation algorithm block or step of a flowchart and combinations thereof may be implemented by hardware firmware and or software including one or more computer program instructions embodied in computer readable program code logic. As will be appreciated any such computer program instructions may be loaded onto one or more computers including without limitation a general purpose computer or special purpose computer or other programmable processing apparatus to produce a machine such that the computer program instructions which execute on the computer s or other programmable processing device s implement the functions specified in the equations algorithms and or flowcharts. It will also be understood that each equation algorithm and or block in flowchart illustrations and combinations thereof may be implemented by special purpose hardware based computer systems which perform the specified functions or steps or combinations of special purpose hardware and computer readable program code logic means.

Furthermore computer program instructions such as embodied in computer readable program code logic may also be stored in a computer readable memory e.g. a non transitory computer readable medium that can direct one or more computers or other programmable processing devices to function in a particular manner such that the instructions stored in the computer readable memory implement the function s specified in the block s of the flowchart s . The computer program instructions may also be loaded onto one or more computers or other programmable computing devices to cause a series of operational steps to be performed on the one or more computers or other programmable computing devices to produce a computer implemented process such that the instructions which execute on the computer or other programmable processing apparatus provide steps for implementing the functions specified in the equation s algorithm s and or block s of the flowchart s .

All of the methods and tasks described herein may be performed and fully automated by a computer system. The computer system may in some cases include multiple distinct computers or computing devices e.g. physical servers workstations storage arrays etc. that communicate and interoperate over a network to perform the described functions. Each such computing device typically includes a processor or multiple processors that executes program instructions or modules stored in a memory or other non transitory computer readable storage medium or device. The various functions disclosed herein may be embodied in such program instructions although some or all of the disclosed functions may alternatively be implemented in application specific circuitry e.g. ASICs or FPGAs of the computer system. Where the computer system includes multiple computing devices these devices may but need not be co located. The results of the disclosed methods and tasks may be persistently stored by transforming physical storage devices such as solid state memory chips and or magnetic disks into a different state.

