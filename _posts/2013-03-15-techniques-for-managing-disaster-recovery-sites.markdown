---

title: Techniques for managing disaster recovery sites
abstract: Techniques for managing disaster recovery sites are disclosed. In one particular embodiment, the techniques may be realized as a method for managing disaster recovery sites comprising generating a heartbeat at a first node, transmitting the heartbeat from the first node to a second node, determining whether a network connection between the first node and the second node has failed, determining whether the second node has received an additional heartbeat from the first node, and changing a state of the secondary node based on the determination of whether the second node has received the additional heartbeat.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09075771&OS=09075771&RS=09075771
owner: Symantec Corporation
number: 09075771
owner_city: Mountain View
owner_country: US
publication_date: 20130315
---
The present disclosure relates generally to disaster recovery and more particularly to techniques for managing disaster recovery sites.

Data and applications may be maintained with a high level of availability by replicating the data and applications from a primary site to a disaster recovery site. For example the data and applications that are online and available at the primary site may be regularly replicated to a secondary disaster recovery site. Upon occurrence of a failure at the primary site the secondary site may be brought online. However traditional management of disaster recovery sites is typically unable to properly prevent the secondary site from being inadvertently brought online during a split brain situation due to network partitioning.

In view of the foregoing it may be understood that there may be significant problems and shortcomings associated with traditional disaster recovery site management technologies.

Techniques for managing disaster recovery sites are disclosed. In one particular embodiment the techniques may be realized as a method for managing disaster recovery sites comprising generating a heartbeat at a first node transmitting the heartbeat from the first node to a second node determining whether a network connection between the first node and the second node has failed determining whether the second node has received an additional heartbeat from the first node and changing a state of the secondary node based on the determination of whether the second node has received the additional heartbeat.

In accordance with other aspects of this particular embodiment the heartbeat is generated periodically at the first node.

In accordance with other aspects of this particular embodiment the primary site is online and hosts at least one application.

In accordance with other aspects of this particular embodiment the second node is a disaster recovery site.

In accordance with other aspects of this particular embodiment application data is transmitted with the heartbeat from the first node to the second node.

In accordance with further aspects of this particular embodiment the heartbeat is periodically transmitted from the first node to the second node.

In accordance with further aspects of this particular embodiment the heartbeat is transmitted from the first node to the second node via a replication channel.

In accordance with further aspects of this particular embodiment the method further includes storing the heartbeat at the second node in a private region of a disk.

In accordance with additional aspects of this particular embodiment the first node and the second node are in communication via a replication channel.

In accordance with additional aspects of this particular embodiment the replication channel is separate from the network connection.

In accordance with additional aspects of this particular embodiment a predetermined amount of time elapses from when it is determined that the network connection has failed to when it is determined whether the second node has received the additional heartbeat.

In accordance with additional aspects of this particular embodiment a disaster recovery agent determines whether the second node has received the additional heartbeat.

In accordance with additional aspects of this particular embodiment the state of the secondary node is changed to online when it is determined that the second node has not received the additional heartbeat.

In accordance with further aspects of this particular embodiment the state of the secondary node is maintained as a disaster recovery site when it is determined that the second node has received the additional heartbeat.

In accordance with further aspects of this particular embodiment the first node and the second node are connected to a steward via a replication channel.

In accordance with other aspects of this particular embodiment the steward determines whether the second node has received the additional heartbeat when it is determined that the network connection has failed.

In another particular embodiment the techniques may be realized as least one non transitory processor readable storage medium storing a computer program of instructions configured to be readable by at least one processor for instructing the at least one processor to execute a computer process for performing the method for managing disaster recovery sites comprising generating a heartbeat at a first node transmitting the heartbeat from the first node to a second node determining whether a network connection between the first node and the second node has failed determining whether the second node has received an additional heartbeat from the first node and changing a state of the secondary node based on the determination of whether the second node has received the additional heartbeat.

In another particular embodiment the techniques may be realized as a system for managing disaster recovery sites comprising one or more processors communicatively coupled to a network wherein the one or more processors are configured to generate a heartbeat at a first node transmit the heartbeat from the first node to a second node determine whether a network connection between the first node and the second node has failed determine whether the second node has received an additional heartbeat from the first node and change a state of the secondary node based on the determination of whether the second node has received the additional heartbeat.

With reference to computer system of modem network interface or some other method may be used to provide connectivity from one or more of client systems and to network . Client systems and may access information on server A N using for example a web browser or other client software not shown . Such a client may allow client systems and to access data hosted by any one of servers A N or one of storage devices A N N N and or N .

Networks and may be local area networks LANs wide area networks WANs the Internet cellular networks satellite networks or other networks that permit communication between clients servers and other devices communicatively coupled to networks and . Networks and may further include one or any number of the exemplary types of networks mentioned above operating as a stand alone network or in cooperation with each other. Networks and may utilize one or more protocols of one or more clients or servers to which they are communicatively coupled. Networks and may translate to or from other protocols to one or more protocols of network devices. Although networks and are each depicted as one network it should be appreciated that according to one or more embodiments networks and may each comprise a plurality of interconnected networks.

Storage devices A N N N and or N may be network accessible storage and may be local remote or a combination thereof to any one of servers A N. Storage devices A N N N and or N may utilize a redundant array of inexpensive disks RAID magnetic tape disk a storage area network SAN an internet small computer systems interface iSCSI SAN a Fibre Channel SAN a common Internet File System CIFS network attached storage NAS a network file system NFS optical based storage or other computer accessible storage. Storage devices A N N N and or N may be used for backup or archival purposes. For example storage devices N N and or N may be used to store data replicated from storage devices A N .

According to some embodiments clients and may be smartphones PDAs desktop computers laptop computers servers other computers or computing devices or other devices coupled via a wireless or wired connection to network . Clients and may receive data from user input a database a file a web service and or an application programming interface.

Servers A N may be application servers archival platforms backup servers network storage devices media servers email servers document management platforms enterprise search servers or other devices communicatively coupled to network . Servers A N may utilize one of storage devices A N N N and or N for the storage of application data backup data or other data. Servers A N may be hosts such as an application server which may process data traveling between clients and and a backup platform a backup process and or storage. According to some embodiments servers A N may be platforms used for backing up and or archiving data. One or more portions of data may be backed up or archived based on a backup policy and or an archive applied attributes associated with the data source space available for backup space available at the data source or other factors. Further the one or more portions of data that have been backed up or archived may be recovered upon occurrence of a particular event according to a failover policy.

According to some embodiments server A may contain one or more portions of software for management of disaster recovery sites such as for example disaster recovery management module . As illustrated one or more portions of the disaster recovery management module may reside at a network centric location. For example server A may be a server a firewall a gateway or other network element that may perform one or more actions to manage disaster recovery sites. According to some embodiments network may be an external network e.g. the Internet and server A may be a gateway or firewall between one or more internal components and clients and the external network. According to some embodiments the disaster recovery management module may be implemented as part of a cloud computing environment.

According to some embodiments server B may also contain one or more portions of software for management of disaster recovery sites such as for example the disaster recovery management module . For example server B may be a server a firewall a gateway or other network element that may perform one or more actions to manage disaster recovery sites.

Bus allows data communication between central processor and system memory which may include read only memory ROM or flash memory neither shown and random access memory RAM not shown as previously noted. The RAM may be the main memory into which the operating system and application programs may be loaded. The ROM or flash memory can contain among other code the Basic Input Output system BIOS which controls basic hardware operation such as the interaction with peripheral components. Applications resident with computer system may be stored on and accessed via a computer readable medium such as a hard disk drive e.g. fixed disk an optical drive e.g. optical drive a floppy disk unit a removable disk unit e.g. Universal Serial Bus drive or other storage medium. According to some embodiments the disaster recovery management module may be resident in system memory .

Storage interface as with the other storage interfaces of computer system can connect to a standard computer readable medium for storage and or retrieval of information such as a fixed disk drive . Fixed disk drive may be a part of computer system or may be separate and accessed through other interface systems. Modem may provide a direct connection to a remote server via a telephone link or to the Internet via an internet service provider ISP . Network interface may provide a direct connection to a remote server via a direct network link to the Internet via a POP point of presence . Network interface may provide such connection using wireless techniques including digital cellular telephone connection Cellular Digital Packet Data CDPD connection digital satellite data connection or the like.

Many other devices or subsystems not shown may be connected in a similar manner e.g. document scanners digital cameras and so on . Conversely all of the devices shown in need not be present to practice the present disclosure. The devices and subsystems can be interconnected in different ways from that shown in . Code to implement the present disclosure may be stored in computer readable storage media such as one or more of system memory fixed disk optical disk or floppy disk . Code to implement the present disclosure may also be received via one or more interfaces and stored in memory. The operating system provided on computer system may be MS DOS MS WINDOWS OS 2 OS X UNIX Linux or another known operating system.

Power manager may monitor a power level of battery . Power manager may provide one or more APIs Application Programming Interfaces to allow determination of a power level of a time window remaining prior to shutdown of computer system a power consumption rate an indicator of whether computer system is on mains e.g. AC Power or battery power and other power related information. According to some embodiments APIs of power manager may be accessible remotely e.g. accessible to a remote backup management module via a network connection . According to some embodiments battery may be an Uninterruptable Power Supply UPS located either local to or remote from computer system . In such embodiments power manager may provide information about a power level of an UPS.

The heartbeat generation module may generate a heartbeat that indicates the presence of a host site to a secondary disaster recovery site. In some embodiments the heartbeat may include a timestamp. Additionally the heartbeat generation module may generate a heartbeat at predetermined times or at predetermined intervals. For example the heartbeat generation module may generate a heartbeat every thirty second one minute two minutes or any other appropriate period of time for transmission from a primary host site to a secondary disaster recovery site.

The data replication module may replicate data from a primary site to a secondary site. In some embodiments the data may be application data for an application hosted by or running on the primary site. In at least one embodiments the data replication module may transmit the data to be replicated to the secondary site via a separate replication channel. Further the data replication module may transmit the heartbeat generated by the heartbeat generation module along with the data to the secondary site.

The network partition detection module may determine whether a network partition has occurred. For example the network partition detection module may determine whether there has been a failure in a network connection between the primary site and the secondary site. Additionally the network partition detection module may determine the type of network partition or fault that has occurred. For instance the network partition detection module may determine whether the network partition was caused by any one of a plurality of events such as a software or hardware failure. In some embodiments the network partition detection module may determine whether a network partition has occurred by transmitting a request or to each site within the network at periodic intervals. Further the network partition detection module may determine whether a network partition has occurred when the data replication module attempts to replicate the data from the primary site to the secondary site.

The heartbeat detection module may determine whether heartbeats are being written to a secondary site. In some embodiments the heartbeat detection module may determine whether heartbeats are being written to the secondary site when the network partition detection module has determined that a network partition occurred. In at least one embodiment the heartbeat detection module may determine whether a heartbeat has been written to a private region of a disk or volume at the secondary site within a specific period of time. The heartbeat detection module may also determine whether a heartbeat stored at the secondary site has been written over by a new heartbeat received from the primary site via the replication channel. Further the heartbeat detection module may determine whether the heartbeat at the secondary site is increasing.

The secondary site state management module may change a state of the secondary site based on an output from the network partition detection module and the heartbeat detection module . For example the secondary site state management module may bring the secondary site online when a network partition has been detected by the network partition detection module and the heartbeat detection module has determined that heartbeats are not being written from the primary site. The secondary site state management module may also bring the secondary site online such that an application may run on the secondary site instead of the primary site and data may be replicated from the secondary site to another data recovery site.

The user interface may provide a user or administrator with control over the disaster recovery management module and the data replication process. For example the user or administrator may specify via the user interface which site the primary site is to replicate data to and how often. In addition the user interface provide the user or administrator with information about the status of each of the sites and any additional information about the data replication process. Further a user or administrator may specify a policy of how to handle a network partition via the user interface .

The multi node computing environment may also include a steward connected to each of the primary site and the secondary site . The steward may connect to the primary site via a replication channel and to the secondary site via a replication channel . In some embodiments the steward may be a Veritas Cluster Server VCS Replication Agent available from Symantec Corp. In other aspects of the embodiment the replication channels and are separate and distinct from the network .

At block a heartbeat may be generated at a primary site. In some embodiments the heartbeat generation module may generate the heartbeat at the primary site. In at least one embodiment the heartbeat may be generated periodically or at predetermined intervals. In addition the heartbeat may include a timestamp. After the heartbeat has been generated at the primary site the process may then proceed to block .

At block data may be replicated from the primary site to the secondary site. In some embodiments the data replication module may replicate the data from the primary site to the secondary site. In addition the heartbeat generated at block may be replicated from the primary site to the secondary site with the replicated data. The data that is replicated may be any type of data generated or stored at the primary site. For example the data at the primary site may be application data or a database. Further when the primary site is online the primary site may be in a writable state such that an application running at the primary site may write to the volumes of the primary site and that application data may be replicated to the secondary site.

In some embodiments the data and the heartbeat may be replicated from the primary site to the secondary site via a replication channel that is separate from a direct network connection between the primary and secondary sites. Additionally a steward may be arranged within the replication channel that receives the data and heartbeat from the primary site via the replication channel and passes the data and heartbeat to the secondary site via the replication channel. For example the primary site may transmit the data and the heartbeat to the steward via replication channel and the steward may forward the data and heartbeat to the secondary site via the replication channel . After the data and the heartbeat have been replicated to the secondary site the process may then proceed to block .

At block it may be determined whether a network partition has been detected. In some embodiments the network partition detection module may determine whether a network partition has occurred. A network partition may occur when a network connection between a primary site and a secondary site fails. For example the network partition may occur when the network fails such that the primary site is not able to communicate directly with the secondary site via the network . If it is determined that a network partition has not been detected the process may proceed to block .

If a network partition has been detected the network partition detection module may determine what type of network partition has occurred. For example the network partition detection module may determine whether a split brain condition has occurred. In one example of a split brain condition an application may be running on a primary site the data supporting the application may have been replicated to a secondary site and a direct connection between the primary site and the secondary site may have failed such that it may be necessary to bring the secondary site online. If it is determined that a network partition has been detected at block the process may then proceed to block before bringing the secondary site online.

At block it may be determined whether a heartbeat from the primary site is being written to the secondary site. In some embodiments the heartbeat detection module may determine whether a heartbeat from the primary site is being written to the secondary site. The heartbeat may be replicated from the primary site to the secondary site via replication channel steward and replication channel . In at least one embodiment the heartbeat may be stored in a private region of the volumes on the secondary site that are separate from the replicated data from the primary site . The private regions of the secondary site may also allow a user to save user defined tags of the disks or volumes included at the secondary site.

In accordance with further aspects of this particular embodiment the steward may determine whether the heartbeat is still being written to the secondary site . For example upon detection of a network partition at block the steward may wait a predetermined period of time and determine whether a new heartbeat has been written to the secondary site within that time. In some embodiments the heartbeat stored at the secondary site is written over by the received heartbeat such that the steward may determine whether the heartbeat at the secondary site has been updated or replaced with a new heartbeat within a specific period of time.

If it is determined that the heartbeat is not being written to the secondary site the process may proceed to block . At block the secondary site may be brought online. In some embodiments the secondary site state management module may bring the secondary site online such that the secondary site is in a writable state an application is running on the secondary site and data may be replicated from the secondary site to another disaster recovery site.

Alternatively if it is determined that the heartbeat has been written to the secondary site the process may proceed to block . At block the state of the primary site may be maintained and the state of the secondary site may be maintained. For example the primary site may continue to run an application such that the volumes of the primary site are writable and data from the primary site is replicated to the secondary site. The process may then proceed back to block such that the entire process may repeat periodically.

At this point it should be noted that management of disaster recovery sites in accordance with the present disclosure as described above may involve the processing of input data and the generation of output data to some extent. This input data processing and output data generation may be implemented in hardware or software. For example specific electronic components may be employed in management of disaster recovery sites or similar or related circuitry for implementing the functions associated with management of disaster recovery sites in accordance with the present disclosure as described above. Alternatively one or more processors operating in accordance with instructions may implement the functions associated with management of disaster recovery sites in accordance with the present disclosure as described above. If such is the case it is within the scope of the present disclosure that such instructions may be stored on one or more non transitory processor readable storage media e.g. a magnetic disk or other storage medium or transmitted to one or more processors via one or more signals embodied in one or more carrier waves.

The present disclosure is not to be limited in scope by the specific embodiments described herein. Indeed other various embodiments of and modifications to the present disclosure in addition to those described herein will be apparent to those of ordinary skill in the art from the foregoing description and accompanying drawings. Thus such other embodiments and modifications are intended to fall within the scope of the present disclosure. Further although the present disclosure has been described herein in the context of at least one particular implementation in at least one particular environment for at least one particular purpose those of ordinary skill in the art will recognize that its usefulness is not limited thereto and that the present disclosure may be beneficially implemented in any number of environments for any number of purposes. Accordingly the claims set forth below should be construed in view of the full breadth and spirit of the present disclosure as described herein.

