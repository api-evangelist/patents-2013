---

title: End-to-end (E2E) tunneling for multi-radio access technology (multi-rat)
abstract: Technology for measuring quality of service (QoS) in a tunneling layer using multiple radio access technologies (RAT) is disclosed. In an example, a mobile node (e.g., user equipment UE), a mobile station (MS), or a mobile cheat), or a multi-RAT control server and/or gateway can include computer circuitry configured to: receive packets of a data flow from separate tunnel connections; and generate a QoS metric for the data flow from a QoS parameter within an enhanced tunneling header of a received packet. At least one RAT (e.g., third generation partnership project (3GPP) long term evolution (LTE), Institute of Electrical and Electronics Engineers (IEEE) 802.16 or Worldwide interoperability for Microwave Access (WiMAX), or IEEE 802.11 or Wireless Fidelity (WiFi)) can communicate via the tunnel connections.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09456378&OS=09456378&RS=09456378
owner: INTEL CORPORATION
number: 09456378
owner_city: Santa Clara
owner_country: US
publication_date: 20130925
---
Wireless mobile communication technology uses various standards and protocols to transmit data between a node e.g. a transmission station and a wireless device e.g. a mobile device Some wireless devices communicate using orthogonal frequency division multiple access OFDMA in a downlink DL transmission and single carrier frequency division multiple access SC FDMA in an uplink UL transmission. Standards and protocols that use orthogonal frequency division multiplexing OFDM for signal transmission include the third generation partnership project 3GPP long term evolution LTE e.g. Release 11 or V11.3.0dated 06 2013 the Institute of Electrical and Electronics Engineers IEEE 802.16 standard e.g. 802.16e 802.16m which is commonly known to industry groups as WiMAX Worldwide interoperability for Microwave Access and the IEEE 802.11 standard e.g. 803.11ac 802.11ad which is commonly known to industry groups as WiFi Wireless Fidelity .

In 3GPP radio access network RAN LTE systems the node can be a combination of Evolved Universal Terrestrial Radio Access Network E UTRAN Node Bs also commonly denoted as evolved Node Bs enhanced Node Bs eNodeBs or eNBs and Radio Network Controllers RNCs which communicates with the wireless device known as a user equipment UE . The downlink DL transmission can be a communication from the node e.g. eNodeB to the wireless device e.g. UE and the uplink UL transmission can be a communication from the wireless device to the node.

Wireless devices can include mobile communication technology to communicate using multiple radio access technologies such as LTE WiMax or WiFi. For example in some configurations the wireless devices may include a radio to communicate using LTE protocols via an eNB and a radio to communicate using a WiFi protocols via a wireless access point WAP . In other configurations wireless devices can include a single radio to communicate with both the eNB and the WAP.

When a wireless device e.g. mobile node can simultaneously access both a wireless local area network WLAN e.g. Wi Fi and a wide wireless area network WWAN e.g. second generation third generation 2G 3G cellular LTE or WiMAX the wireless device can select a network for an Internet Protocol IP packet flow e.g. an IP flow mobility technique .

Reference will now be made to the exemplary embodiments illustrated and specific language will be used herein to describe the same. It will nevertheless be understood that no limitation of the scope of the invention is thereby intended.

Before the present invention is disclosed and described it is to be understood that this invention is not limited to the particular structures process steps or materials disclosed herein but is extended to equivalents thereof as would be recognized by those ordinarily skilled in the relevant arts. It should also be understood that terminology employed herein is used for the purpose of describing particular examples only and is not intended to be limiting. The same reference numerals in different drawings represent the same element. Numbers provided in flow charts and processes are provided for clarity in illustrating steps and operations and do not necessarily indicate a particular order or sequence.

An initial overview of technology embodiments is provided below and then specific technology embodiments are described in further detail later. This initial summary is intended to aid readers in understanding the technology more quickly but is not intended to identify key features or essential features of the technology nor is it intended to limit the scope of the claimed subject matter.

An Internet Protocol IP flow mobility technique can support delivering a single IP flow over multiple networks simultaneously. As used herein a single IP flow or a single data flow means a set of IP packets that can be classified into the same group for flow bindings based on traffic selector information such as a source IP address a destination IP address a protocol type a source port number or a destination port number. Using a flow mobility technique to spin an individual IP flow between multiple available wireless networks can provide an enhanced user experience such as a higher aggregate throughput.

In a configuration the IP service can be coupled to a server . The WLAN can operate using an IEEE 802.11 based protocol. The WWAN can operate using a 3GPP based protocol a WiMax based protocol a universal mobile telecommunications system based UMTS based protocol a code division multiple access 2000 based CDMA2000 based protocol a global system for mobile communications based GSM based protocol a cellular digital packet data based CDPD based protocol and or a Mobitex based protocol. Although illustrate two different access points to the IP services as the WLAN node and the WWAN node other configurations may also be used such as two or more WWAN nodes using different radio access technologies RAT 

In an example a conventional IP flow mobility technique allows the mobile node to send a binding update message to a home agent HA which can be included in the multi RAT control gateway . In an example the multi RAT control gateway can be included a home core network for the mobile node . The HA can register multiple local IP addresses for the mobile node to a single permanent home address i.e. HoA at the home agent HA . Each registered local IP address e.g. a Care of Address CoA can correspond to a particular wireless network.

In the conventional IP flow mobility technique the mobile node can have a registered CoA1 with home agent for a first IP flow e.g. for a 3rd party application and a registered CoA2 for a second IP flow e.g. a Voice over Internet Protocol VoIP application . The first IP flow can be sent to the mobile node via the WLAN using the local IP address CoA1 and the second IP flow can be sent to mobile node via the WWAN using the CoA2. Both IP flows can use the same HoA so moving a flow from one network to another network can be completely transparent from the point of view of an IP services application.

Alternatively the first IP flow and the second IP flow can represent packets from a single split IP flow from the IP service as shown by . Similar to switching an IP flow from one network to another the splitting of the IP flow using at least two different networks can be transparent to the user e.g. using the same HoA . A sequence based flow splitting technique to balance the load for a particular IP flow can be used to increase the end to end throughput. For example a WiFi WLAN can be used to offload some or all of the WWAN traffic of the IP flow.

Each RAN connection e.g. WiFi WAP and LTE eNB can be referred to as a tunnel. Computer networks can use a tunneling protocol when one network protocol i.e. the delivery protocol encapsulates a different payload protocol. By using tunneling one network can carry a payload over an incompatible delivery network or provide a secure path through an untrusted network.

The technology e.g. mobile nodes IP services multi RAT control server and or gateway methods computer circuitry systems structures and mechanism as described herein can support transporting a single transmission control protocol TCP flow e.g. video streaming over multiple radio access networks including managing out of order delivery to improve TCP performance. The single TCP flow can provide seamless Wi Fi offload and an IP flow mobility solution using an enhanced tunneling header. The TCP flow can provide a tunneling layer e.g. user datagram protocol UDP tunneling or IP in IP tunneling to support and measure end to end E2E or e2e quality of service QoS performance. The QoS performance measurements e.g. local measurements made by the mobile node e.g. client devices can be used to make a network selection and a flow mobility decision. For example an enhanced tunneling header and a protocol to support dynamic load balancing DLB with an enhanced packet re ordering capability can provide several enhancements to the tunneling layer.

The transmission control protocol TCP is one of the core protocols of the Internet protocol IP suite. The TCP can provide reliable ordered error checked delivery of a stream of octets between programs running on computers connected to a local area network LAN an intranet or the public Internet. The TCP can reside at the transport layer.

User datagram protocol UDP is another core member of the IP suite i.e. the set of network protocols used for the Internet . With UDP computer applications can send messages referred to as datagrams to other hosts on an IP network without prior communications to set up special transmission channels or data paths.

In computer networking and or wireless communication different functions can be provided by different layers in a protocol stack. The protocol stack can be in implementation of a computer networking protocol suite. The protocol stack or protocol suite can include the definition and implementation of the protocols. Each layer or protocol in the protocol stack can provide a specified function. The modularization of the layers and protocols can make design and evaluation of the computer networking and or wireless communication easier. In an example each protocol module or layer module in a stack of protocols may communicate with at least two other modules e.g. a higher layer and a lower layer . The lowest protocol or layer can provide low level physical interaction with the hardware. Each higher layer may add more features. The upper or topmost layers can include user applications and services.

In the LTE system communication layers e g. LTE layers can include a physical PHY i.e. layer 1 L1 a data link or link i.e. layer 2 L2 a network i.e. layer 3 L3 a transport i.e. layer 4 L4 a session i.e. layer 5 L5 and an application layer as illustrated in . In an example the link layer can include media access control MAC radio link control RLC packet data convergence protocol PDCP radio resource control RRC layers . The network layer can use an internet protocol IP and the transport layer can use a transmission control protocol TCP or user datagram protocol UDP in an internet protocol suite. In an example the tunneling layer can occur in one of the communication layers. The session layer can use a hypertext transfer protocol HTTP . The application layer can include video audio speech and timed text a 3GPP file format or a media presentation description MPD .

The multi RAT control server and or gateway can provide a tunneling interface between the IP service and the mobile node . The multi RAT control server and or gateway can include an IP layer virtual IP or VIP to interface with the mobile node and an IP layer to interface with the IP service so the underlying RAT used in the transmission is transparent to the IP flows . In an example the IP flow can use a HoA and or be associated with the virtual IP layer. In another example the multi RAT control server and or gateway can act as a virtual private network VPN for the mobile node. The multi RAT control server and or gateway can use the L1 and or L2 layer e.g. Ethernet protocol to provide physical layer communication with the IP service over a wired or optical connection. The tunnel layer or tunneling layer can use the UDP protocol to provide multi RAT resource control such as DLB IP flow mobility and QoS measurements for the tunnel or RAN connections. The multi RAT control server and or gateway can provide the mapping of the IP flows to physical IP PIP layer addresses of access nodes WAP eNB NB or BS of the WWAN or WLAN in the RAN. Each access node can have a PIP and address and L1 and or L2 layer processing WLAN and WWAN to wirelessly transmit packets to the mobile node. The physical IP PIP and can be associated with the tunnels. In an example the HoA of the IP flow can be mapped to the local IP address CoA for the WLAN e.g. IP flow or the local IP address CoA2 for the WWAN e.g. IP flow . A core network and or the RAN can provide the L1 and or L2 layer e.g. Ethernet WiFi WiMax or LTE protocol signaling for the access nodes. The L1 and or L2 layer e.g. Ethernet protocol can be used by the multi RAT control server and or gateway to communicate with the RAN or the core network 

Packet headers packet formats and packet configurations can be used to support different communication layers. For example a packet can include an IP header IP Hdr a UDP header UDP Hdr an enhanced tunneling header and a payload. The payload can include the message or actual data to be transmitted.

The enhanced tunneling header can support dynamic load balancing DLB operations as well as E2E QoS measurements. In another example the mobile node can represent one end e.g. receiver or transmitter and the multi RAT control server and or gateway can represent another end e.g. transmitter or receiver in the end to end E2E QoS measurements. The enhanced tunneling header can include various parameters or bit fields such as QoS parameters resource management parameters or administrative parameters. In an example the enhanced tunneling header can include a total of four bytes. In other examples each of the parameters of the enhanced tunneling header can have varying bit sizes. The enhanced tunneling header can have all or some of the parameters as needed for the tunneling layer and QoS metrics.

The QoS parameter can include a data transmission DT time interval between a tunnel packet and a previous tunnel packet in a tunneling flow or a sequence number SN of a tunnel packet of the tunneling flow. In an example the DT field can indicate the transmission interval of a tunnel packet in units of time e.g. millisecond ms and can be used by a receiver to measure E2E delay variation. A timer in the transmitter can count the time between each tunneling packet and include the timer value in the DT field. The timer can reset after the transmitted packet or the transmission interval can be a difference between a transmitted packet and a previous packet. In another example the DT bit field can be 7 bits long. For instance if the actual transmission interval is greater than 127 ms the DT field can be set to a bit value of . The SN field can be a sequential order of the tunneling packets. The SN field can be used for re ordering as well as packet loss measurement. In an example the DT field can be 7 bits and the SN field can be 16 bits 

The resource management parameter can include an aggregation bit field A to indicate when a tunnel packet includes multiple Internet Protocol IP data packets a compression bit field C to indicate when header compression is used for an IP data packet or a priority bit field. P to indicate a priority of the tunnel packet. The resource management parameter can be used to better manage the resources of the tunnel packet. Multiple packets at the transmitter e.g. one end of the tunnel can be combined or aggregated into a single aggregated packet to conserve header overhead. When aggregation is used the A field may be set to alert the receiver at the other tunnel that the tunnel packet includes multiple smaller packets. Compression can be used to reduce the header size. The C field indicates that compression is used on a header of the current tunnel packet and that the receiver can decompress the header to get header information. In an example the A field and the C field can be one bit. Each packet can be given a priority to ensure minimal delays for high priority data and traffic. The P field can indicate the priority for the tunnel packet especially when the priority in the IP header or UDP header is unavailable e.g. due to layer header processing or compressed. For example a lower number or smaller number can indicate a higher priority. When 2 bits are used 4 different priorities can be used.

The administrative parameter includes a type bit field T to indicate whether the tunnel packet is used for control e.g. binding update or RRC messaging or includes the IP data packet a setting bit field S to indicate when the tunnel packet uses a different tunnel burst size TBS setting from a prior tunnel packet or a flow identifier FID of the tunnel packet. The tunnel burst size TBS can be the number of consecutive packets that are sent over a RAN connection e.g. WiFi or cellular . The administrative parameter can provide administrative information for the tunnel packet. For example the T field can indicate if the tunnel payload carries an IP data packet e.g. zero for data or a control message e.g. one for control messaging such as a binding update BU message or binding acknowledgement BA . For instance the rest of the header fields may only be valid if T 0.

The S field can be used by the transmitter to signal the receiver that the TBS setting of a flow has changed so that the receiver can detect out of order packet delivery. For example the S field of a packet can be set to zero for one TBS setting then when a DLB process switches or changes to a different TBS setting the S field can be set to one. With another change of the TBS setting the S field can be set back to zero and so forth oscillating between zero and one for each TBS setting change.

The FID field can be used to identify which flow a packet belongs to. In an example to limit the size of a tunnel header the FID field can be 3 bits. As defined in the 3GPP LTE standard Release 11 the FID can be 16 bits For instance a flow with FID 1 to 7 may have the SN counted separately from FID. Flows with FID greater than 7 FIG 7 can be considered as a single flow with the FID field set to 0.

With the enhanced tunneling header including the QoS parameters as illustrated in QoS metrics can be measured for an individual tunnel or tunnel connection . Such QoS metrics can include a packet loss rate throughput a delay variation a re ordering delay a congestion packet ratio or an available bandwidth. The packet loss rate can be the number of packets loss from the total of number of packets sent. With the SN field each tunnel packet can have a unique number so when SN numbers are missing the packet loss rate can be calculated. Throughput can be the number of packets received in a period of time such as 1 second s .

Delay variation or a congestion period can be represented by DRX DTX where DTX indicates the time interval e.g. delay between two consecutive packets at the transmitter TX and DRX indicates the time interval e.g. delay between two consecutive packets at the receiver RX . The receiver can include a timer to determine the delay. The delay variation can use the DT field and the SN field. The DTX can be determined from the DT field and the. DRX can be determined by the delay between subsequent SNs. The delay variation can be used to detect congestion and measure available bandwidth of a tunnel and compare E2E latency between two tunnels. Based on the E2E latency packets of the IP flow can be re routed to the less congested tunnel connection using a DLB operation.

Re ordering delay can measure how long a packet waits at the receiver due to out of order delivery. The SN field can be used determine the ordering of the packets and out of order delivery or reception at the receiver. The congestion packet ratio can be the number of packets that experienced congestion relative to the total number of transmitted packets. As already mentioned the congestion packet ratio can be calculated based on the delay variation exceeding a specified or predetermined threshold delay or congestion threshold. The threshold delay or congestion threshold can be determined statically e.g. a wireless standard or protocol or dynamically based on other criteria. The available bandwidth can be the maximum. achievable throughput of a tunnel in an example the available bandwidth can represent a bandwidth without delay variation or a congestion period.

A decision for DLB or the flow mobility can be made by the client e.g. mobile node or the server e.g. multi RAT control server and or gateway . The client can measure the downlink tunnel performance e.g. using QoS metrics and the server e.g. IP service can measure the uplink tunnel performance and report the QoS metrics hack to the client where the client can make the determination of the DLB or the flow mobility. Alternatively the sever can measure the uplink tunnel performance e.g. using QoS metrics and the client e.g. IP service can measure the uplink tunnel performance and report the QoS metrics back to the server where the server can make the determination of the DLB or the flow mobility.

The DLB dynamic load balancing control parameters can include a tunnel burst size TBS a maximum aggregation delay MAD and a re ordering timer ROT . The DLB control parameters can be included in control messaging e.g. requests responses or acknowledgements ACK . The TBS can be a parameter that specifies the number of consecutive packets that are sent over a connection via a particular network e.g. WiFi or LTE . The ROT can be parameter that specifies the maximum time that a packet may wait for at the receiver due to out of order delivery before a retransmission request. The ROT can specify how long the packet waits in a re ordering buffer until prior in sequence packets are received. In an example the ROT can use units in time e.g. rot 0.5 s . The MAD can be parameter that specifies the maximum time that a packet may wait for at the transmitter due to aggregation e.g. putting multiple small packets into a single tunnel packet to reduce tunneling overhead . In an example the MAD can use units in time e.g. mad 50 ms 

Referring back to tbs i can represent the TBS of the tunnel connection where i is an integer. For instance i 0 can represent a WiFi tunnel arid can represent a cellular e.g. LTE or WiMax connection. shows how traffic may be split over WiFi and cellular. In this example. DLB can start with equal share loading between WiFi i.e. tbs 2 and cellular e.g. tbs 2 . At packet the WiFi loading ratio can increase to 60 e g. tbs 3 and tbs 2 with a DLB change.

When splitting. TCP packets over multiple RAN connections i.e. tunnels the receiver can re order the packets that are delivered out of order. However a packet may be lost in the tunnel due to an unreliable wireless channel or a buffer overflow.

Identifying which tunnel a missing packet is from at the receiver can be used to differentiate between packet loss and out of order delivery and minimize unnecessary re ordering delay For instance if any successive packet from the same tunnel has arrived the receiver can determine the packet is lost assuming packets from the same tunnel will never arrive out of order. Typically packets from a particular network using a same network path will arrive in sequential order but that order may not apply to different tunnels or different networks. For example if packet on the cellular tunnel arrives and packet has not arrived. packet may he considered lost but if packet has not arrived the arrival of packet may not be deterministic of a lost packet since packet is transmitted using the WiFi connection which may have additional delay over the cellular connection The enhanced tunneling header and or the DLB control parameters can provide additional information to differentiate between packet loss and out of order delivery and minimize unnecessary re ordering delay 

A deterministic tunnel burst scheduling policy can be used to determine a transmission order of packets in an IP flow into various tunnels. For example a tunnel with smaller or higher binding ID BID can be scheduled first in each round the minimum SN can be e.g. first packet of the first burst which can indicate the first packet of a burst in the tunnel with the smallest BID and the maximum SN can be given by S 2 1 where L can indicate the length of the SN field. BID can be an unsigned integer to uniquely identify a tunnel. The BID can be used to identify the network.

As the rule e.g. tunnel burst scheduling policy can be known to both transmitter and receiver the receiver can then determine which round a missing packet is from based on the packet s SN and the current TBS settings. In another example the rule can be known and applied by the multi RAT control server and or gateway.

Referring back to a dynamic load balancing DLB protocol can be illustrated. illustrates a client initiated DLB procedure for a downlink and illustrates a client initiated DEB procedure for an uplink. In a client initiated DLB procedure for the downlink the client e.g. mobile node can send message to the server via the IP service . For example the message can comprise an existing binding update message as defined in Mobile IP or an RRC message used in LTE. Other message types of other wireless standards may also be used. The message can include DLB request DLB REQ which can indicate the new TBS settings for a flow identified by FID e.g. tbs 2 tbs 3 mad 50 ms . The DLB REQ can include various control parameters e.g. TBS ROT or MAD . The server can then send a message in response e.g. DLB response DLB RSP which can include a start SN for the DLB change. The message in response can comprise an existing binding ACK BA message as defined in Mobile IP or an RRC message used LTE.

To ensure both the client e.g. mobile node and server e.g. home agent are synchronized about which packet a new TBS setting will start to take effect the server can put start SN information in the DLR RSP for the downlink process. The start SN can indicate the sequence number SN of the first packet that will use the new TBS setting. For uplink the client can send another DLB REQ to include the Start SN information after receiving the DLR REP from the server 

In a client initiated DLB procedure for the uplink the client e.g. mobile node can send message with the control parameters e.g. tbs 2 tbs 3 rot 0.5 ms to the server indicating a request for DLB. The client initiated DLB procedure for the uplink can use similar messaging as the client initiated DLB procedure for the downlink. The server can acknowledge the change or the request in a DLB RSP. The client can provide the start SN for the DLB change in a DLB REQ and tin. server can transmit a DLB RSP. The DLB change may be initiated with the transmission of the start SN even without a subsequent ACK 

The DLB procedures protocols or processes can assist the receiver in differentiating between packet loss and out of order delivery and minimize unnecessary re ordering delay. Because tunnel burst scheduling policy can be known to both transmitter and receiver the receiver can determine when a packet is missing from a tunnel based on the packet s SN and the current TBS settings which can be signaled using the DLB protocol. The reduction of the re ordering delay and detemination of the packet loss can use the SN and FID parameters in the enhanced tunneling header.

Another example provides a method for ordering packets in a tunneling layer using multiple radio access technologies RAT as shown in the flow chart in . The method may be executed as instructions on a machine or computer circuitry where the instructions are included on at least one computer readable medium or one non transitory machine readable storage medium. The method includes the operation of communicating a tunneling configuration by a message request and a message response wherein the message request or the message response includes a dynamic load balancing DLB control parameter when a DLB changes and the DLB control parameter includes a maximum aggregation delay MAD value that provides a maximum time that a packet may wait at a transmitter due to packet aggregation as in block . The next operation of the method can be transmitting packets of a data flow into separate tunnel connections wherein at least two RAT communicate via the separate tunnel connections using the tunneling configuration as in block . The method can further include minimizing re ordering delay using the DLB control parameter as in block .

In an example the DLB control parameter can include a tunnel burst size TBS of a number of consecutive packets that are sent over a tunnel connection a re ordering timer ROT indicating a Maximum time that a packet may wait at a receiver due to an out of order delivery or a start sequence number SN of the packet of the flow indicating when the DLB changes. In another example the operation of transmitting packets of the flow into separate tunnel connections can further include splitting the packets of the flow into the separate tunnel connections or receiving the packets of the flow from the separate tunnel connections.

In another configuration the packets can use an enhanced tunneling header. The enhanced tunneling header can include a quality of service QoS parameter a resource management parameter or an administrative parameter. The QoS parameter Call include a data transmission DT time interval between a tunnel packet and a previous tunnel packet in a tunneling flow or a sequence number SN of a tunnel packet. The resource management parameter can include an aggregation bit field A to indicate when a tunnel packet includes multiple Internet Protocol IP data packets a compression bit field C to indicate when header compression is used for an IP data packet or a priority bit field P to indicate a priority of the tunnel packet. The administrative parameter can include as type bit field T to indicate whether the tunnel packet is used for control or includes the IP data packet a setting bit field S to indicate when the tunnel packet uses a different tunnel burst size TBS setting from a prior tunnel packet or a flow identifier FID of the tunnel packet. In another example the method can further include generating a QoS metric from the QoS parameter within an enhanced tunneling header of a received packet.

In another example the different RAT can include third generation partnership project 3GPP long term evolution LTE Institute of Electrical and Electronics Engineers IEEE 802.16 or Worldwide interoperability for Microwave Access WiMAX or IEEE 802 11 or Wireless Fidelity WiFi . In another configuration the operation of transmitting pickets of the flow into separate tunnel connections can further include transmitting the packets in a downlink transmission from a multi RAT control server and or gateway or an Internet Protocol IP service to as mobile node via a base station BS a Node B NB or an evolved Node B eNB or transmitting the packets in an uplink transmission from the mobile node to the multi RAT control server and or gateway or IP service to the mobile node via the BS the NB or the eNB. The IP service can be coupled to a server. The multi RAT control server and or gateway can be couple between the IP service and the BS the NB or the eNB.

In another configuration the method can further include scheduling the packets in tunnel bursts where a tunnel with a smaller binding identifier BID is scheduled first then a tunnel with a next smallest BID is scheduled next and a minimum sequence number SN indicates a first packet of as burst in the tunnel with the smallest BID and a maximum SN is represented by S 2 1 where L indicates a length of a SN bit field.

Another example provides functionality of computer circuitry of a mobile node for measuring quality of service QoS in a tunneling layer using multiple radio access technologies RAT as shown in the flow chart in . The functionality may be implemented as a method or the functionality may be executed as instructions on a machine where the instructions are included on at least one computer readable medium or one non transitory machine readable storage medium. The computer circuitry can be configured to receive packets of a data flow from separate tunnel connections wherein at least two different RAT communicate via the tunnel connections as in block . The computer circuitry can be further configured to generate a QoS metric for the data flow from a QoS parameter within an enhanced tunneling header of a received packet as in block .

In another configuration the computer circuitry can be configured to receive packets of a data flow from separate tunnel connections where a RAT communicates via the tunnel connections. The computer circuitry can be further configured to generate a QoS metric for the data flow from a QoS parameter within an enhanced tunneling header of a received packet.

In an example the QoS parameter can include a data transmission DT time interval between a tunnel packet and a previous tunnel packet in a tunneling flow or a sequence number SN of a tunnel packet.

In another example the QoS metric can provide an end to end QoS performance measurement. The QoS performance measurement can include A packet loss rate based on the SN a delay variation based on the DT and the SN a re ordering delay based on the SN a congestion packet ratio based on the delay variation a throughput based on a number of packets received within a duration or an available bandwidth based on the throughput and the delay variation.

In another configuration the enhanced tunneling header can include a resource management parameter or an administrative parameter. The resource management parameter can include an aggregation bit field. A to indicate when a tunnel packet includes multiple Internet Protocol IP data packets a compression bit field C to indicate when header compression is used for an IP data packet or a priority bit field P to indicate a priority of the tunnel packet. The administrative parameter can include a type bit field T to indicate whether the tunnel packet is used for control or includes the IP data packet a setting bit field S to indicate when the tunnel packet uses a different configuration. The different configuration can include a tunnel burst size TBS from a prior tunnel packet or a flow identifier FID of the tunnel packet. In another example the different RAT can include third generation partnership project 3GPP long term evolution LTE institute of Electrical and Electronics Engineers IEEE 802 16 or Worldwide interoperability for Microwave Access WiMAX or IEEE 802.11 or Wireless Fidelity WiFi .

In another example the computer circuitry can be further configured to determine tunnel burst scheduling of the received packets. A tunnel with smaller or bigger binding identifier BID can be scheduled first then a tunnel with a next smallest biggest BID is scheduled next and a minimum sequence number SN indicates a first packet of a burst in the tunnel with the smallest BID and a maximum SN is represented by S 2 1 where L indicates a length of a SN bit field. In another configuration the computer circuitry can be further configured to reorder the packets of a flow from the separate tunnel connections using the enhanced tunneling header of the received packets.

In another configuration the computer circuitry can be further configured to Transmit a message request to a multi RAT control server and or gateway to change a dynamic load balancing DLB between the tunnel connections based on the QoS metric receive during a downlink DLB process a message response from the multi RAT control server and or gateway with a start sequence number SN of a tunnel packet of the flow indicating when the DLB changes receive during an uplink DLB process a message response from the multi RAT control server and or gateway acknowledging the DLB change and transmit during the uplink DLB process a message request to the multi RAT control server and or gateway with the start SN of the tunnel packet of the flow indicating when the DLB changes. For LTE the message request can include a DLB request and the message response includes a DLB response.

The message request and the message response use a radio resource control RRC message for communication using third generation partnership project 3GPP long term evolution LTE . The message request can include a binding update and the message response can include a binding acknowledgement ACK for a mobile IP flow. The message request can include a change in a tunnel burst size TBS for each tunnel connection. The message request for a downlink DLB process can include a maximum aggregation delay MAD and the message request for an uplink DLB process can include a re ordering timer ROT value.

In another configuration the mobile node includes a user equipment UE a mobile station MS or a mobile client.

Referring back to the mobile node can include a transceiver and a processor. The processor and or transceiver of the mobile node Can be configured for ordering packets in a tunneling layer using multiple radio access technologies RAT as described in of . In another configuration the processor and or transceiver of the mobile node can be operable for measuring quality of service QoS in a tunneling layer using multiple radio access technologies RAT as described in of .

At a high level network can include a core network CN e.g. an evolved packet core EPC and an air interface access network E UTRAN. The CN can be responsible for the overall control of the various user equipments UEs connected to the network and establishment of the bearers. The CN may include functional entities such as a multi RAT control gateway a home agent HA and or an access network discovery and selection function ANDSF server or entity. The E UTRAN can be responsible for radio related functions.

Some main logical nodes of the CN can include a serving gateway general packet radio service GPRS support node GGSN a mobility management entity AME a home subscriber server HSS a serving gateway SGW or S GW a packet data network PDN gateway and a policy and charging rules function PCRF manager. Each of the network elements of CN can interconnected by well known standardized interfaces such as interfaces S3 S4 or S5.

Referring back to the Internet Protocol IP service can include a transceiver and a processor . In another example the multi RAT control gateway can include a transceiver and a processor. The multi RAT control gateway can be configured for providing quality of service QoS parameters in an enhanced tunneling header. In an example the transceiver and the processor functionality applicable to the multi RAT control gateway can he applicable to the IP service. The processor can be configured for splitting packets of a data flow into separate tunnel connections. At least two different RAT e.g. WiFi WiMAX or LTE can communicate via the tunnel connections. The transceiver can be configured to transmit a downlink packet with the enhanced tunneling header using one of the tunnel connections to a mobile node during a downlink transmission and receive an uplink packet with the enhanced tunneling header using one of the tunnel connections from the mobile node during an uplink transmission. The enhanced tunneling header can include a QoS parameter.

In another configuration the QoS parameter can include a data transmission DT time interval between a tunnel packet and a previous tunnel packet in a tunneling flow or a sequence number SN of a tunnel packet. The enhanced tunneling header can include a resource management parameter and an administrative parameter. The resource management parameter can include an aggregation bit field A to indicate when a tunnel packet includes multiple Internet Protocol IP data packets a compression bit field C to indicate when header compression is used for an IP data packet or a priority bit field P to indicate a priority of the tunnel packet. The administrative parameter can include a type bit field T to indicate whether the tunnel packet is used for control or includes the IP data packet a setting bit field S to indicate when the tunnel packet uses a different tunnel burst size TBS setting from a prior tunnel packet or a flow identifier FID of the tunnel packet. The different RAT can include third generation partnership protect 3GPP long term evolution LTE Institute of Electrical and Electronics Engineers IEEE 802.16 or Worldwide interoperability for Microwave Access WiMAX or IEEE 802.11 or Wireless Fidelity WiFi .

In another example the processor can be further configured to schedule packets in tunnel busts for the separate tunnel connections. A tunnel with smaller or bigger binding identifier BID can be scheduled first then a tunnel with a next smallest BID can be scheduled next. A minimum sequence number SN can indicate a first packet of a burst in the tunnel with the smallest BID. A maximum SN can be represented by S 2 1 where L indicates a length of a SN bit field.

In another configuration the transceiver can be further configured to communicate a tunneling configuration by a message request and a message response. The message request or the message response can include a start sequence number SN of a tunnel packet of the flow indicating when a dynamic load balancing DLB changes. The message request can include a DLB request and the message response includes a DLB response. The message request and the message response can use radio resource control RRC message for third generation partnership project 3GPP long term evolution LTE . In another example the message request can include a binding update and the message response can include a binding acknowledgement ACK for a mobile IP flow. The message request can include a DLB control parameter having a tunnel burst size TBS a re ordering timer ROT or a maximum aggregation delay MAD .

The multi RAT control gateway can be coupled to a server and can communicate with the mobile node is a base station BS a Node B NB an evolved Node B eNB a baseband Unit BBU . remote radio head RRH a remote radio equipment RRE a remote radio unit RRU a central processing module CPM a WLAN node or a WWAN node .

Various techniques or certain aspects or portions thereof may take the form of program code i.e. instructions embodied in tangible media such as floppy diskettes compact disc read p.m. only memory CD ROMs hard drives non transitory computer readable storage medium or any other machine readable storage medium wherein when the program code is loaded into and executed by a machine such as a computer the machine becomes an apparatus for practicing the various techniques. Circuitry can include hardware firmware program code executable code computer instructions and or software. A non transitory computer readable storage medium can be a computer readable storage medium that does not include signal. In the case of program code execution on programmable computers the computing device may include a processor a storage medium readable by the processor including volatile and non volatile memory and or storage elements at least one input device and at least one output device The volatile and non volatile memory and or storage elements may be a random access memory RAM erasable programmable read only memory EPROM flash drive optical drive magnetic hard drive solid state drive or other medium for storing electronic data. The node and wireless device may also include a transceiver module i.e. transceiver a counter module i.e. counter a processing module i.e. processor and or a clock module i.e. clock or timer module i.e. timer . One or more programs that may implement or utilize the various techniques described herein may use an application programming interface API reusable controls and the like. Such programs may be implemented in a high level procedural or object oriented programming language to communicate with a computer system. However the. program s may be implemented in assembly or machine language if desired. In any case the language may be a compiled or interpreted language and combined with hardware implementations.

It should be understood that many of the functional units described in this specification have been labeled modules in order to more particularly emphasize their implementation independence. For example a module may be implemented as a hardware circuit comprising custom very large scale integration VLSI circuits or gate arrays off the shelf semiconductors such as logic chips transistors or other discrete components. A module may also be implemented in programmable hardware devices such as field programmable gate arrays programmable array logic programmable logic devices or the like.

Modules may also be implemented in software for execution by various types of processors. An identified module of executable code may for instance comprise one or more physical or logical blocks of computer instructions which may for instance be organized as an object procedure or function. Nevertheless the executables of an identified module need not be physically located together but may comprise disparate instructions stored in different locations which when joined logically together comprise the module and achieve the stated purpose for the module.

Indeed a module of executable code may be a single instruction or many instructions and may even be distributed over several different code segments among different programs and across several memory devices. Similarly operational data may be identified and illustrated herein within modules and may be embodied in any suitable form and organized within any suitable type of data structure. The operational data may be collected as a single data set or may be distributed over different locations including over different storage devices and may exist at least partially merely as electronic signals on a system or network. The modules may be passive or active including agents operable to perform desired functions.

Reference throughout this specification to an example or exemplary means that a particular feature structure or characteristic described in connection with the example is included in at least one embodiment of the present invention. Thus appearances of the phrases in an example or the word exemplary in various places throughout this specification are not necessarily all referring to the same embodiment.

As used herein a plurality of items structural elements compositional elements and or materials may be presented in a common list for convenience. However these lists should be construed as though each member of the list is individually identified as a separate and unique member. Thus no individual member of such list should be construed as a de facto equivalent of any other member of the same list solely based on their presentation in a common group without indications to the contrary. In addition various embodiments and example of the present invention may be referred to herein along with alternatives for the various components thereof. It is understood that such embodiments examples and alternatives are not to be construed as defacto equivalents of one another but are to be considered as separate and autonomous representations of the present invention.

Furthermore the described features structures or characteristics may be combined in any suitable manner in one or more embodiments. In the following description numerous specific details are provided such as examples of layouts distances network examples etc. to provide a thorough understanding of embodiments of the invention. One skilled in the relevant art will recognize however that the invention can be practiced without one or more of the specific details or with other methods components layouts etc. In other instances well known structures materials or operations are not shown or described in detail to avoid obscuring aspects of the invention.

While the forgoing examples are illustrative of the principles of the present invention in one or more particular applications it will be apparent to those of ordinary skill in the art that numerous modifications in form usage and details of implementation can be made without the exercise of inventive faculty and without departing from the principles and concepts of the invention. Accordingly it is not intended that the invention be limited except as by the claims set forth below.

