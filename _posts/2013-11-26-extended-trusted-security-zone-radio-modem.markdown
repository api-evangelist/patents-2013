---

title: Extended trusted security zone radio modem
abstract: A cellular wireless modem. The cellular wireless modem comprises a cellular radio transceiver, a short range communication interface, a processor, wherein the processor comprises a trusted security zone, a memory, wherein the memory stores an input forwarding application, and a trusted security zone extension application stored in the memory. When executed by the processor, the extension application provisions the input forwarding application to an intelligent appliance via the short range communication interface, receives input from the input forwarding application executing on the intelligent appliance via the short range communication interface, and transmits a message based on the input via the cellular radio transceiver.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09210576&OS=09210576&RS=09210576
owner: Sprint Communications Company L.P.
number: 09210576
owner_city: Overland Park
owner_country: US
publication_date: 20131126
---
This application is a continuation of and claims priority under 35 U.S.C. 120 to U.S. patent application Ser. No. 13 540 437 filed on Jul. 2 2012 entitled Extended Trusted Security Zone Radio Modem by Warren B. Cope et al. which is incorporated herein by reference for all purposes.

A variety of confidential communications transactions are completed over networks that may be subject to a variety of security threats. For example confidential financial information such as credit card account number and authentication codes may be transmitted via a network to an on line retail store. Personal health information such as measured health parameters may be transmitted via a network to a medical monitoring service. Security threats may include infiltrating malware onto a computing device such as a desktop computer a laptop computer or other device. The malware may obtain confidential information in various ways and send this out in communications that may be hidden from a normal user to a nefarious computer or application via the network. The malware may screen scrape information by accessing the outputs to a display screen. The malware may capture keyboard input.

In an embodiment a method of wireless communication is disclosed. The method comprises coupling a cellular wireless modem to an intelligent appliance wherein the intelligent appliance has a processor and a user interface input device transmitting a trusted security zone extension application from the cellular wireless modem to the intelligent appliance executing the trusted security zone extension application at a ring 0 level of the processor of the intelligent appliance and blocking access to the user interface input device by an application executing above the ring 0 level of the processor of the intelligent application wherein the blocking access is performed by the trusted security zone extension application. The method further comprises transmitting an input received by the user interface input device to the cellular wireless modem wherein the transmitting the input is performed by the trusted security zone extension application and transmitting a cellular wireless message by the cellular wireless modem where the message is based on the input received by the user interface input device.

In an embodiment a method of wireless communication is disclosed. The method comprises coupling a cellular wireless modem to an intelligent appliance wherein the intelligent appliance has a processor and a user interface input device provisioning a trusted security zone extension application on the intelligent appliance and executing the trusted security zone extension application. The method further comprises executing a non preemptable routine of the trusted security zone extension application wherein the non preemptable routine reads an input from the user interface input device and transmits the input to the cellular wireless modem and transmitting a cellular wireless message by the cellular wireless modem wherein the message is based on the input from the user interface input device.

In an embodiment a cellular wireless modem is disclosed. The cellular wireless modem comprises a cellular radio transceiver a short range communication interface a processor wherein the processor comprises a trusted security zone a memory wherein the memory stores an input forwarding application and a trusted security zone extension application stored in the memory. When executed by the processor the extension application provisions the input forwarding application to an intelligent appliance via the short range communication interface receives input from the input forwarding application executing on the intelligent appliance via the short range communication interface and transmits a message based on the input via the cellular radio transceiver.

These and other features will be more clearly understood from the following detailed description taken in conjunction with the accompanying drawings and claims.

It should be understood at the outset that although illustrative implementations of one or more embodiments are illustrated below the disclosed systems and methods may be implemented using any number of techniques whether currently known or not yet in existence. The disclosure should in no way be limited to the illustrative implementations drawings and techniques illustrated below but may be modified within the scope of the appended claims along with their full scope of equivalents.

In an embodiment a system and method are taught that promote extending a trusted communication path to an otherwise untrusted computer in a confirmable manner. A computer or intelligent device may not implement a trusted security zone and hence may be considered an untrusted device. For example the computer may have been infiltrated by viruses spyware Trojans or other malware that could propagate across a communication link coupled to the computer. In an embodiment a radio modem having a trusted security zone is communicatively coupled to the computer installs a trusted security zone extension application on the computer and engages as a mediator or bridge for trusted communication between the computer and another trusted network node. In an embodiment the trusted security zone extension application may block access to the input and output devices of the computer by other applications executing on the computer and or a processor of the computer e.g. one or more of a plurality of processors of a multiprocessor computer for example processors that do not execute the subject trusted security zone extension application . The trusted security zone extension application may receive inputs for example keyboard inputs input to the computer and forward this input to the trusted security zone on the radio modem. The trusted security zone on the radio modem sends the input on to the trusted network node.

In an embodiment the trusted security zone extension application may execute in a ring 0 level of the computer system for example at the most privileged level of the computer. Alternatively in another embodiment the trusted security zone extension application may execute as a non preemptible routine where the trusted security zone extension application holds the processor and or processors of the computer until an input session has been completed and then releases the processor and or processors. In either embodiment the trusted security zone extension application may uninstall itself or delete itself after completion of a delimited procedure such as a web session.

The system and method described above may promote using computers that have not been configured during manufacturing to have a trusted security zone thereby enabling the extension of communication trust to what otherwise would be an untrusted computer. In an embodiment the trusted security zone extension application may be said to couple to the hardware and or the chipset of the subject computer but does not actually execute in a trusted security zone of the computer because this solution and disclosure presumes the computer does not feature a trusted security zone . The trusted security zone extension application may be executed under supervision of and or control of a trusted application executing in the trusted security zone of the radio modem. In this way it may be said that the trusted security zone extension application taught herein leverages the trusted security zone of the radio modem to provide security like that of a trusted security zone for communication operations of the computer that engage the radio modem.

A trusted security zone provides chipsets with a hardware root of trust a secure execution environment for applications and secure access to peripherals. A hardware root of trust means the chipset should only execute programs intended by the device manufacturer or vendor and resists software and physical attacks and therefore remains trusted to provide the intended level of security. The chipset architecture is designed to promote a programmable environment that allows the confidentiality and integrity of assets to be protected from specific attacks. Trusted security zone capabilities are becoming features in both wireless and fixed hardware architecture designs. Providing the trusted security zone in the main mobile device chipset and protecting the hardware root of trust removes the need for separate secure hardware to authenticate the device or user. To ensure the integrity of the applications requiring trusted data such as a mobile financial services application the trusted security zone also provides the secure execution environment where only trusted applications can operate safe from attacks. Security is further promoted by restricting access of non trusted applications to peripherals such as data inputs and data outputs while a trusted application is running in the secure execution environment. In an embodiment the trusted security zone may be conceptualized as hardware assisted security.

A complete Trusted Execution Environment TEE may be implemented through the use of the trusted security zone hardware and software architecture. The Trusted Execution Environment is an execution environment that is parallel to the execution environment of the main mobile device operating system. The Trusted Execution Environment and or the trusted security zone may provide a base layer of functionality and or utilities for use of applications that may execute in the trusted security zone. For example in an embodiment trust tokens may be generated by the base layer of functionality and or utilities of the Trusted Execution Environment and or trusted security zone for use in trusted end to end communication links to document a continuity of trust of the communications. For more details on establishing trusted end to end communication links relying on hardware assisted security see U.S. patent application Ser. No. 13 532 588 filed Jun. 25 2012 entitled End to end Trusted Communications Infrastructure by Leo Michael McRoberts et al. which is hereby incorporated by reference in its entirety. Through standardization of application programming interfaces APIs the Trusted Execution Environment becomes a place to which scalable deployment of secure services can be targeted. A device which has a chipset that has a Trusted Execution Environment on it may exist in a trusted services environment where devices in the trusted services environment are trusted and protected against attacks. The Trusted Execution Environment can be implemented on mobile phones and tablets as well as extending to other trusted devices such as personal computers servers sensors medical devices point of sale terminals industrial automation handheld terminals automotive etc.

The trusted security zone is implemented by partitioning all of the hardware and software resources of the mobile device into two partitions a secure partition and a normal partition. Placing sensitive resources in the secure partition can protect against possible attacks on those resources. For example resources such as trusted software applications may run in the secure partition and have access to hardware peripherals such as a touchscreen or a secure location in memory. Less secure peripherals such as wireless radios may be disabled completely while the secure partition is being accessed while other peripherals may only be accessed from the secure partition. While the secure partition is being accessed through the Trusted Execution Environment the main mobile operating system in the normal partition is suspended and applications in the normal partition are prevented from accessing the secure peripherals and data. This prevents corrupted applications or malware applications from breaking the trust of the device.

The trusted security zone is implemented by partitioning the hardware and software resources to exist in a secure subsystem which is not accessible to components outside the secure subsystem. The trusted security zone is built into the processor architecture at the time of manufacture through hardware logic present in the trusted security zone which enables a perimeter boundary between the secure partition and the normal partition. The trusted security zone may only be manipulated by those with the proper credential and in an embodiment may not be added to the chip after it is manufactured. Software architecture to support the secure partition may be provided through a dedicated secure kernel running trusted applications. Trusted applications are independent secure applications which can be accessed by normal applications through an application programming interface in the Trusted Execution Environment on a chipset that utilizes the trusted security zone.

In an embodiment the normal partition applications run on a first virtual processor and the secure partition applications run on a second virtual processor. Both virtual processors may run on a single physical processor executing in a time sliced fashion removing the need for a dedicated physical security processor. Time sliced execution comprises switching contexts between the two virtual processors to share processor resources based on tightly controlled mechanisms such as secure software instructions or hardware exceptions. The context of the currently running virtual processor is saved the context of the virtual processor being switched to is restored and processing is restarted in the restored virtual processor. Time sliced execution protects the trusted security zone by stopping the execution of the normal partition while the secure partition is executing.

The two virtual processors context switch via a processor mode called monitor mode when changing the currently running virtual processor. The mechanisms by which the processor can enter monitor mode from the normal partition are tightly controlled. The entry to monitor mode can be triggered by software executing a dedicated instruction the Secure Monitor Call SMC instruction or by a subset of the hardware exception mechanisms such as hardware interrupts which can be configured to cause the processor to switch into monitor mode. The software that executes within monitor mode then saves the context of the running virtual processor and switches to the secure virtual processor.

The trusted security zone runs a separate operating system that is not accessible to the device users. For security purposes the trusted security zone is not open to users for installing applications which means users do not have access to install applications in the trusted security zone. This prevents corrupted applications or malware applications from executing powerful instructions reserved to the trusted security zone and thus preserves the trust of the device. The security of the system is achieved at least in part by partitioning the hardware and software resources of the mobile phone so they exist in one of two partitions the secure partition for the security subsystem and the normal partition for everything else. Placing the trusted security zone in the secure partition and restricting access from the normal partition protects against software and basic hardware attacks. Hardware logic ensures that no secure partition resources can be accessed by the normal partition components or applications. A dedicated secure partition operating system runs in a virtual processor separate from the normal partition operating system that likewise executes in its own virtual processor. Users may install applications on the mobile device which may execute in the normal partition operating system described above. The trusted security zone runs a separate operating system for the secure partition that is installed by the mobile device manufacturer or vendor and users are not able to install new applications in or alter the contents of the trusted security zone.

Turning now to a system is described. In an embodiment the system comprises a cellular wireless modem having a cellular radio transceiver a base transceiver station BTS a network and a server computer . In an embodiment the server is coupled to a data store . While shown as directly connected to the data store in an embodiment the server may communicate with the data store via the network . In an embodiment the network comprises one or more public networks one or more private networks or a combination thereof. In some contexts the cellular wireless modem may be referred to as a radio modem.

The cellular wireless modem may comprise a processor that promotes a normal execution zone and a trusted security zone . In an embodiment the normal execution zone may be implemented by a processor that is a separate processor than a processor that implements the trusted security zone . In another embodiment the normal execution zone executes on a first virtual processor and the trusted security zone executes on a second virtual processor.

The cellular wireless modem further comprises a memory having a trusted partition . The trusted partition may store a trust zone extension application and an input forwarding application . The cellular wireless modem may comprise one or more of a short range radio transceiver or a wired data communication interface . The short range radio transceiver may be a WiFi radio transceiver a Bluetooth radio transceiver or some other kind of radio transceiver. The wired data communication interface may be a universal serial bus USB interface or some other kind of wired interface.

The cellular wireless modem may be in communication with an intelligent appliance and may provide a communication link from the intelligent appliance via one of the short range radio transceiver or the wired data communication interface and via a cellular wireless link from the cellular radio transceiver to the base transceiver station . Using the cellular wireless modem the intelligent appliance may establish a communication link to the network for example to the server to request content and or to complete an on line purchase transaction. The intelligent appliance may comprise a desktop computer a laptop computer a printer a medical monitoring device or a variety of other devices that may embed a computer or processor. By communicatively coupling the cellular wireless modem to the intelligent appliance a trusted communication path may be extended to and provided to the intelligent appliance as described further herein below. While not described in detail the cellular wireless modem may also provide a normal or untrusted communication path from the intelligent appliance to the network for example when an untrusted application executing on the intelligent appliance may access the network for example to cruise the Internet.

In an embodiment when the cellular wireless modem is communicatively coupled to the intelligent appliance the trust zone extension application may execute in the trusted partition . The trust zone extension application may be said to execute in a trusted security zone. The trust zone extension application may provision and or copy one or more applications to the intelligent appliance to promote an enhanced level of secure operation of the intelligent appliance .

Turning now to further details of an embodiment of the intelligent appliance are described. In an embodiment the intelligent appliance comprises a processor a memory a user interface having one or more input devices and one or more output devices . The intelligent appliance further comprises a modem interface . The memory may store one or more untrusted applications .

When the intelligent appliance is communicatively coupled to the cellular wireless modem via the modem interface the trust zone extension application may provision a trust zone extension application and or an input forwarding application into the memory of the intelligent appliance . For example the cellular wireless modem may transfer the trust zone extension application and the input forwarding application to the intelligent appliance and store this copy in the memory of the intelligent appliance . The trust zone extension application may act as an agent on the intelligent appliance of the trust zone extension application performing actions on the intelligent appliance that are invoked by the trust zone extension application executing on the cellular wireless modem . The trust zone extension application input forwarding application may be executed by the processor when invoking a communication link via the cellular wireless modem to the network . When it is executed the trust zone extension application may prevent the untrusted applications from executing while the communication link via the cellular wireless modem to the network is established thereby preventing the untrusted applications from spying on inputs to the input devices . When commanded by the trust zone extension application executing on the cellular wireless modem the trust zone extension application may execute the input forwarding application . The input forwarding application may capture inputs provided by a user to the input device and send them to the input forwarding application executing on the cellular wireless modem . The input forwarding application may then send these to the cellular radio transceiver for transmitting to the base transceiver station the network and possibly to the server for example to complete an on line purchase transaction or some other transmission of confidential information.

The trust zone extension application may execute at the ring 0 level of the processor or alternatively may execute as an unpreemptable application on the processor . In an embodiment the trust zone extension application may cause an indicator to be presented on a display of the intelligent appliance that indicates that a trusted security zone communication link is established and is communicating. The trust zone extension application may uninstall the input forwarding application and then uninstall itself in response to receiving a command to do so from the trust zone extension application executing on the cellular wireless modem . Uninstalling the trust zone extension application and the input forwarding application may reduce the opportunity for any of the untrusted applications altering or corrupting the trust zone extension application or the input forwarding application . In an embodiment the trust zone extension application and the input forwarding application may be combined in a single component. Alternatively one or more of the trust zone extension application or input forwarding application may be provided as two or more components or applications.

Turning now to a method is described. At block a cellular wireless modem is coupled to an intelligent appliance wherein the intelligent appliance has a processor and a user interface input device . At block a trusted security zone extension application for example the trust zone extension application and or the input forwarding application is transmitted from the cellular wireless modem to the intelligent appliance . At block a trusted security zone extension application for example the trust zone extension application and or the input forwarding application is executed at a ring 0 level of the processor of the intelligent appliance . At block access to the user interface input device is blocked by an application for example the trust zone extension application executing at the ring 0 level of the processor of the intelligent appliance wherein blocking access is performed by the trusted security zone extension application. At block an input received by the user interface input device is transmitted to the cellular wireless modem wherein transmitting the input is performed by the trusted security zone extension application. At block a cellular wireless message is transmitted by the cellular wireless modem where the message is based on the input received by the user interface input device .

Turning now to a method is described. At block a cellular wireless modem is coupled to an intelligent appliance wherein the intelligent appliance has a processor and a user interface input device . At block a trusted security zone extension application for example the trust zone extension application and or the input forwarding application is provisioned on the intelligent appliance . At block the trusted security zone extension application is executed. At block a non preemptable routine of the trusted security zone extension application executes wherein the non preemptable routine reads an input from the user interface input device and transmits the input to the cellular wireless modem . At block a cellular wireless message is transmitted by the cellular wireless modem wherein the message is based on the input from the user interface input device .

It is understood that by programming and or loading executable instructions onto the computer system at least one of the CPU the RAM and the ROM are changed transforming the computer system in part into a particular machine or apparatus having the novel functionality taught by the present disclosure. It is fundamental to the electrical engineering and software engineering arts that functionality that can be implemented by loading executable software into a computer can be converted to a hardware implementation by well known design rules. Decisions between implementing a concept in software versus hardware typically hinge on considerations of stability of the design and numbers of units to be produced rather than any issues involved in translating from the software domain to the hardware domain. Generally a design that is still subject to frequent change may be preferred to be implemented in software because re spinning a hardware implementation is more expensive than re spinning a software design. Generally a design that is stable that will be produced in large volume may be preferred to be implemented in hardware for example in an application specific integrated circuit ASIC because for large production runs the hardware implementation may be less expensive than the software implementation. Often a design may be developed and tested in a software form and later transformed by well known design rules to an equivalent hardware implementation in an application specific integrated circuit that hardwires the instructions of the software. In the same manner as a machine controlled by a new ASIC is a particular machine or apparatus likewise a computer that has been programmed and or loaded with executable instructions may be viewed as a particular machine or apparatus.

The secondary storage is typically comprised of one or more disk drives or tape drives and is used for non volatile storage of data and as an over flow data storage device if RAM is not large enough to hold all working data. Secondary storage may be used to store programs which are loaded into RAM when such programs are selected for execution. The ROM is used to store instructions and perhaps data which are read during program execution. ROM is a non volatile memory device which typically has a small memory capacity relative to the larger memory capacity of secondary storage . The RAM is used to store volatile data and perhaps to store instructions. Access to both ROM and RAM is typically faster than to secondary storage . The secondary storage the RAM and or the ROM may be referred to in some contexts as computer readable storage media and or non transitory computer readable media.

I O devices may include printers video monitors liquid crystal displays LCDs touch screen displays keyboards keypads switches dials mice track balls voice recognizers card readers paper tape readers or other well known input devices.

The network connectivity devices may take the form of modems modem banks Ethernet cards universal serial bus USB interface cards serial interfaces token ring cards fiber distributed data interface FDDI cards wireless local area network WLAN cards radio transceiver cards such as code division multiple access CDMA global system for mobile communications GSM long term evolution LTE worldwide interoperability for microwave access WiMAX and or other air interface protocol radio transceiver cards and other well known network devices. These network connectivity devices may enable the processor to communicate with the Internet or one or more intranets. With such a network connection it is contemplated that the processor might receive information from the network or might output information to the network in the course of performing the above described method steps. Such information which is often represented as a sequence of instructions to be executed using processor may be received from and outputted to the network for example in the form of a computer data signal embodied in a carrier wave.

Such information which may include data or instructions to be executed using processor for example may be received from and outputted to the network for example in the form of a computer data baseband signal or signal embodied in a carrier wave. The baseband signal or signal embedded in the carrier wave or other types of signals currently used or hereafter developed may be generated according to several methods well known to one skilled in the art. The baseband signal and or signal embedded in the carrier wave may be referred to in some contexts as a transitory signal.

The processor executes instructions codes computer programs scripts which it accesses from hard disk floppy disk optical disk these various disk based systems may all be considered secondary storage ROM RAM or the network connectivity devices . While only one processor is shown multiple processors may be present. Thus while instructions may be discussed as executed by a processor the instructions may be executed simultaneously serially or otherwise executed by one or multiple processors. Instructions codes computer programs scripts and or data that may be accessed from the secondary storage for example hard drives floppy disks optical disks and or other device the ROM and or the RAM may be referred to in some contexts as non transitory instructions and or non transitory information.

In an embodiment the computer system may comprise two or more computers in communication with each other that collaborate to perform a task. For example but not by way of limitation an application may be partitioned in such a way as to permit concurrent and or parallel processing of the instructions of the application. Alternatively the data processed by the application may be partitioned in such a way as to permit concurrent and or parallel processing of different portions of a data set by the two or more computers. In an embodiment virtualization software may be employed by the computer system to provide the functionality of a number of servers that is not directly bound to the number of computers in the computer system . For example virtualization software may provide twenty virtual servers on four physical computers. In an embodiment the functionality disclosed above may be provided by executing the application and or applications in a cloud computing environment. Cloud computing may comprise providing computing services via a network connection using dynamically scalable computing resources. Cloud computing may be supported at least in part by virtualization software. A cloud computing environment may be established by an enterprise and or may be hired on an as needed basis from a third party provider. Some cloud computing environments may comprise cloud computing resources owned and operated by the enterprise as well as cloud computing resources hired and or leased from a third party provider.

In an embodiment some or all of the functionality disclosed above may be provided as a computer program product. The computer program product may comprise one or more computer readable storage medium having computer usable program code embodied therein to implement the functionality disclosed above. The computer program product may comprise data structures executable instructions and other computer usable program code. The computer program product may be embodied in removable computer storage media and or non removable computer storage media. The removable computer readable storage medium may comprise without limitation a paper tape a magnetic tape magnetic disk an optical disk a solid state memory chip for example analog magnetic tape compact disk read only memory CD ROM disks floppy disks jump drives digital cards multimedia cards and others. The computer program product may be suitable for loading by the computer system at least portions of the contents of the computer program product to the secondary storage to the ROM to the RAM and or to other non volatile memory and volatile memory of the computer system . The processor may process the executable instructions and or data structures in part by directly accessing the computer program product for example by reading from a CD ROM disk inserted into a disk drive peripheral of the computer system . Alternatively the processor may process the executable instructions and or data structures by remotely accessing the computer program product for example by downloading the executable instructions and or data structures from a remote server through the network connectivity devices . The computer program product may comprise instructions that promote the loading and or copying of data data structures files and or executable instructions to the secondary storage to the ROM to the RAM and or to other non volatile memory and volatile memory of the computer system .

In some contexts the secondary storage the ROM and the RAM may be referred to as a non transitory computer readable medium or a computer readable storage media. A dynamic RAM embodiment of the RAM likewise may be referred to as a non transitory computer readable medium in that while the dynamic RAM receives electrical power and is operated in accordance with its design for example during a period of time during which the computer is turned on and operational the dynamic RAM stores information that is written to it. Similarly the processor may comprise an internal RAM an internal ROM a cache memory and or other internal non transitory storage blocks sections or components that may be referred to in some contexts as non transitory computer readable media or computer readable storage media.

While several embodiments have been provided in the present disclosure it should be understood that the disclosed systems and methods may be embodied in many other specific forms without departing from the spirit or scope of the present disclosure. The present examples are to be considered as illustrative and not restrictive and the intention is not to be limited to the details given herein. For example the various elements or components may be combined or integrated in another system or certain features may be omitted or not implemented.

Also techniques systems subsystems and methods described and illustrated in the various embodiments as discrete or separate may be combined or integrated with other systems modules techniques or methods without departing from the scope of the present disclosure. Other items shown or discussed as directly coupled or communicating with each other may be indirectly coupled or communicating through some interface device or intermediate component whether electrically mechanically or otherwise. Other examples of changes substitutions and alterations are ascertainable by one skilled in the art and could be made without departing from the spirit and scope disclosed herein.

