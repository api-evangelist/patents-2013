---

title: System and method for processing encoded messages for exchange with a mobile data communication device
abstract: A system and method are provided for pre-processing encrypted and/or signed messages at a host system before the message is transmitted to a wireless mobile communication device. The message is received at the host system from a message sender. There is a determination as to whether any of the message receivers has a corresponding wireless mobile communication device. For each message receiver that has a corresponding wireless mobile communication device, the message is processed so as to modify the message with respect to one or more encryption and/or authentication aspects. The processed message is transmitted to a wireless mobile communication device that corresponds to the first message receiver. The system and method may include post-processing messages sent from a wireless mobile communications device to a host system. Authentication and/or encryption message processing is performed upon the message. The processed message may then be sent through the host system to one or more receivers.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09172540&OS=09172540&RS=09172540
owner: BlackBerry Limited
number: 09172540
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20130802
---
This application is a continuation of U.S. application Ser. No. 12 916 929 filed Nov. 1 2010 which is a continuation of U.S. application Ser. No. 11 089 869 filed on Mar. 25 2005 which is a continuation of U.S. application Ser. No. 10 480 514 filed Dec. 11 2003 which is a National Stage Entry of PCT International Application No. PCT CA02 00890 filed Jun. 12 2002 which claims the benefit of U.S. Provisional Application No. 60 297 681 filed Jun. 12 2001 and entitled An Advanced System and Method for Compressing Secure E Mail for Exchange with a Mobile Data Communication Device . U.S. application Ser. No. 12 916 929 U.S. application Ser. No. 11 089 869 U.S. application Ser. No. 10 480 514 and U.S. Provisional Application No. 60 297 681 including the entirety of the written descriptions and drawing figures are hereby incorporated into the present application by reference.

The present invention is directed to exchanging e mail messages involving a mobile data communications device mobile device and more particularly to exchanging secure e mail messages involving a mobile device.

There are many solutions for exchanging information between host systems and mobile devices. These systems all follow simple encoding methods for delivering a shortened version of the original message to the wireless mobile device keeping in mind the limited memory and display capabilities of the device. However there is a lack of focus and attention being paid to the problems of delivering S MIME message to mobile devices. Currently there are no known systems that try to delivery the entire S MIME message to the mobile device. This is because the bandwidth and battery limitations when using wireless devices makes it impossible to create such a solution without performing any pre processing on the message. One major problem is that S MIME messages are too large to send effectively to the mobile device. If the entire S MIME message is sent it could use excessive amounts of memory and battery power just for a single message. Considering the time necessary for reception the memory required for storage and the battery required to handle the RF exchange a product that tried to support direct S MIME would be unusable to the average business user. The second problem is that there are no public key servers accessible to wireless networks and wireless devices. As a result the use of public key crypto operations is very difficult and requires heavy caching operations to eliminate the Public Key Infrastructure PKI requirements.

In the area or exchanging secure e mail there are additional problems that include 1 the inability for mobile devices to retrieve public encryption keys from Public Key Infrastructures PKIs to encrypt messages being sent from the mobile device 2 the inability to retrieve public keys on received messages that are signed 3 the inability to deal with very large Certificate Revocation Lists CRLs on small devices and 4 the time delay on mobile devices with slower CPUs to perform complex math calculations involved with public key encryption algorithms. These problems and others result in a poor and frustrating user experience when trying to exchange S MIME based e mail messages with other companies.

Therefore there remains a need for a system and method for processing secure mail so that S MIME messages can be exchanged with mobile devices. There also remains a method for leveraging the processor power of the host system to enable a better user experience when exchanging S MIME messages with outside correspondents.

In accordance with the teachings herein a system and method are provided for processing secure mail so that S MIME messages or other types of secure messages can be exchanged with mobile devices. The system and method may include different aspects such as reducing the size of the S MIME messages and or pre processing S MIME messages to enable transmission of S MIME with mobile devices.

For example the system and method may provide for pre processing encrypted and or signed messages at a host system before the message is transmitted to a wireless mobile communication device. The message is received at the host system from a message sender. There is a determination as to whether any of the message receivers has a corresponding wireless mobile communication device. For each message receiver that has a corresponding wireless mobile communication device the message is processed so as to modify the message with respect to one or more encryption and or authentication aspects. The processed message is transmitted to a wireless mobile communication device that corresponds to the first message receiver. The system and method may also include post processing messages sent from a wireless mobile communications device to a host system. Authentication and or encryption message processing is performed upon the message. The processed message may then be sent through the host system to one or more receivers.

In other situations the system and method may rearrange signed e mail messages at a host system in order to reduced transmitted data being sent to a mobile device. The steps may include A receiving a signed e mail message at the host system from a message sender addressed to one or more message receivers B confirming that at least one addressee has a corresponding mobile device C rearranging the senders signature Certificate and Certificate Revocation Lists within the message placing them at the end of the message D sending the message followed by the senders signature to the mobile device and E holding back the Certificate and Certificate Revocation Lists so that the user has to request these items if they are not already on the mobile device.

Further in the area of size reduction the system and method may rearrange encrypted e mail messages at a host system so that the important information for the receiver is placed first. The steps may include A receiving an encrypted e mail message from a message sender addressed to one or more message receivers B confirming that at least one addressee has a corresponding mobile device C for each message receiver that has a corresponding mobile device the system and method may 1 regenerate the message so that it contains only the message text and the session key for the address that matches a specific user s mobile device and 2 transmit the message and selected session key without sending the other session keys contained within the original message.

In the area of pre processing it is possible for the host system to preauthorize a signed message and send the mobile device the result of the pre processing. The steps for this method may include A receiving a signed e mail message at the host system from a message sender addressed to one or more message receivers B confirming that at least one addressee has a corresponding mobile device C extracting the signature certificates and certificate revocation lists following normal S MIME practice D performing a signature preauthorization on the message using the necessary public key information and following normal S MIME practice on behalf of the mobile device user and E transmitting to the user the original message with a flag indicating whether the message had been signed and whether the signature was verified. This flag will be signed by the sender so the device can verify the flag is valid.

Further in the area of pre processing it is possible for the host to decrypt e mail data from standard S MIME on behalf of the mobile device user. The steps for this method may include A receiving an encrypted e mail message from a message sender addressed to one or more message receivers B confirming that at least one addressee has a corresponding mobile device C for each message receiver that has a corresponding mobile device the system and method may 1 identify the individual session key that matches an e mail address for a corresponding mobile device 2 generate a intermediary message for the mobile device user with just the encrypted session key for the corresponding user 3 send the encrypted session key to the mobile device user 4 decrypt the session key at the mobile device 5 return the decrypted session key to the host system 6 decrypt the original message contents using the returned session key and 7 send the decrypted message to the mobile device user.

These are just a few of the many advantages of the system and method as described in more detail below. As will be appreciated other and different embodiments than those expressly described are possible and their several details are capable of modifications in various respects. Accordingly the drawings and description of the system and method set forth below are to be regarded as illustrative in nature and not restrictive.

With reference to this illustration represents a complex overview of a sample network topology. Naturally one skilled in the art can appreciate there could be hundreds of different topologies but the one selected helps demonstrate how the system and method works. There could be many e mail senders in the Internet and many Internal company based senders of e mail. The system and method discussed herein use the example of mail being exchange between companies or branch offices across an insecure network like the Internet. It should be understood that this is only an exemplary environment as the system and method may be utilized outside of company settings such as in individual secure e mail exchanges.

Most mail exchanges today between companies remains unencrypted and unsigned so that anyone on the Internet with some amount of effort could see the information being exchanged. To address this issue new standards like PGP Pretty Good Privacy and S MIME Secure Multipurpose Internet Mail Extensions are being used to exchange mail between companies. illustrates an example clan Internet e mail environment where security between companies is not used.

Turning now to there is shown a central host location typically referred to herein as a corporate office or Host Location . However this does not restrict the host location from being a branch office a home office or some other secure location where mail messages are being exchanged. Also shown is an e mail sender which could be an individual using an ISP Internet Service Provider account a person within another company a person in the same company within another branch office or it could be a user of a large ASP application service provider like an America Online AOL user. Within the corporate office is a message server running on some computer within the firewall of the corporation that acts as the main interface for the corporation to exchange mail with the Internet . Two common message servers are Microsoft Exchange and Lotus Domino . These products are often used in conjunction with Internet mail routers that typically use UNIX based Sendmail protocols to route and deliver mail. These message server products do extend beyond just e mail sending and receiving they also include dynamic database storage engines that have predefined database formats for data like Calendars todo lists task lists e mail and documentation.

Within this typical corporate environment a redirection software program is inserted. Although the redirection software is shown to reside on the same machine for ease of presentation there is no requirement that it must reside here. The redirection software and the message server products are designed to co operate and interact to allow the pushing of information to mobile devices . In this installation the redirection software is taking confidential and non confidential corporate information for a specific user and redirecting it out through the corporate firewall to mobile devices . A more detailed description of an example of the redirection software may be found in PCT International Application No. 09 087 632 U.S. Pat. No. 6 219 694 and U.S. patent application Ser. Nos. 09 401 868 09 545 963 09 528 495 09 545 962 and Ser. No. 09 649 755 all of which are hereby incorporated into the present application by reference. The push techniques described in these applications and patent use a wireless friendly encoding compression and encryption technique to deliver all information to the mobile device thus extending the company firewall to include the mobile device .

It is noted that the host system at the host location may be message server running within a corporate environment behind a company firewall. The message server has an associated wireless enabling component known as the redirection software . A redirection software may be used either directly on the host system or on a different computer platform to redirect information to a wireless data communication device. Alternatively the host system could be a user s desktop PC also running within a corporate environment connected to local area network LAN or could be any other system that is in communication with the user s desktop PC.

A redirection program or software operating at the host system normally in association with a message server enables the user to redirect or mirror certain user selected data items or parts of data items from the host system to the user s mobile data communication device upon detecting that one or more user defined triggering events has occurred. In the process of redirecting data items to the user s mobile data communication device there is special processing performed that enables the support of S MIME or PGP messages. For one skilled in the art of S MIME it is well known that the original message size of an e mail message can be dramatically increased when S MIME algorithms are applied to the mail message. By applying advanced filtering re organization and pre processing on the message the user can still receive such data items at a mobile device. In some situations the user can still have full control over the S MIME processing stage and can direct the host system as to the procedures it performs.

Operating at the host system are various sub systems that can be configured to create triggering events such as a screen saver sub system or a keyboard sub system as well as sub systems for repackaging the user s data items for transparent delivery to the mobile data device such as a TCP IP sub system or one or more e mail sub systems. Other sub systems within the redirection software include components for dealing with signed e mail interacting with Public Key Infrastructures PKIs and repackaging of the user s encrypted data items. The host system also includes a primary memory store where the user s data items are normally stored with related information as to Which folder the message might have originally been placed into.

Using the redirector software a user can select certain data items for redirection such as e mail messages calendar events meeting notifications address entries journal entries personal reminders etc. The user can also select folders for redirection to or mirroring on the mobile device. For example the user may select that only data items in the Inbox and those in the company X folder shall be sent to the device. Having selected the data items for redirection the user can then configure one or more event triggers to be sensed by the redirection software to initiate redirection of the user data items. These user defined trigger points or event triggers include external events internal events and networked events.

Examples of external events include receiving a message from the user s mobile data communication device to begin redirection receiving a similar message from some external computer sensing that the user is no longer in the vicinity of the host system or any other event that is external to the host system. Internal events could be a calendar alarm screen saver activation keyboard timeout programmable timer or any other user defined event that is internal to the host system. Networked events are user defined messages that are transmitted to the host system from another computer coupled to the host system via a network to initiate redirection. These are just some of the examples of the types of user defined events that can trigger the redirector program to push data items from the host to the mobile device.

Once an event has triggered redirection of the user data items the host system then repackages these items in a manner that is transparent to the mobile data communication device so that information on the mobile device appears similar to information on the user s host system. In addition to repackaging the information itself the repackaging may also include properties about the message for example whether the message was signed and whether the signature was verified. The repackaging method may include wrapping the user data items in an e mail envelope that corresponds to the address of the mobile data communication device although alternatively other repackaging methods could be used with the system and method disclosed herein such as special purpose TCP IP wrapping techniques or other methods of wrapping the user selected data items. The repackaging preferably results in c mail messages appearing to come from the host system even though they are initiated at the mobile device thus enabling the user to appear to have a single e mail address such that the recipients of messages sent from the mobile communications device do not know where the user was physically located when the message was first sent. The repackaging also permits both messages to the mobile device and sent from the mobile device to be encrypted and decrypted as well as compressed and decompressed. To maintain this appearance of transparency the support of S MIME security is essential. Effectively the goal is to extend the S MIME security from company to company and then onto the mobile device.

In an alternative system and method the redirection software executes on a network server and the server is programmed to detect numerous redirection event triggers over the network from multiple user desktop computers coupled to the server via a LAN. The server can receive internal event triggers from each of the user desktops via the network and can also receive external event triggers such as messages from the users mobile data communication devices. In response to receiving one of these triggers the server redirects the user s data items to the proper mobile data communication device. The user data items and addressing information for a particular mobile device can be stored at the server or at the user s PC. Using this alternative configuration one redirection software can serve a plurality of users. This alternative configuration could also include internet or intranet based redirection software that could be accessible through a secure web page or other user interface. The redirection software could be located on an Internet Service Provider s system and accessible only through the Internet.

In another alternative configuration redirection software operates at both the host system and at the user s mobile data communication device. In this configuration the user s mobile device operates similarly to the host system described below and is configured in a similar fashion to push certain user selected data items from the mobile device to the user s host system or some other computer upon detecting an event trigger at the mobile device. This configuration provides two way pushing of information from the host to the mobile device and from the mobile device to the host.

As shown in there are many alternative paths for getting information to the mobile device . A method for getting information to the mobile device discussed later in this section is through the serial port using a serial cradle . The serial port may for example include a standard serial connection a Universal Serial Bus USB connection or other types of serial data connections. This method tends to be used for bulk information updates often performed at initialization of the system. The other main method for data exchange is over the air using Radio Frequency RF networks to delivery the information. As shown in this could be accomplished through a Wireless VPN router assuming this is available to the company or through a traditional Internet connection to a Wireless Gateway and a Wireless Infrastructure . The concept of a Wireless VPN router implies that a Virtual Private Network VPN connection could be established directly through a specific wireless network to the mobile device . The Wireless VPN router may be used for example when the new Internet Protocol IP Version 6 IPV6 is available in IP based wireless networks. This new protocol will provide enough IP addresses to dedicate an IP address to every mobile device and thus make it possible to push information to the mobile device at any time. One advantage of using this Wireless VPN router is that it could be an off the shelf VPN component which would not require a separate Wireless Gateway and Wireless Infrastructure . A VPN connection would most likely use a Transmission Control Protocol over IP TCP IP or User Datagram Protocol over IP UDP IP connection to deliver the messages directly to the mobile device .

If a Wireless VPN router is not available then link to the Internet is the most common connection mechanism available. To handle the addressing of the mobile device a wireless gateway is typically used. Then to abstract a connection to multiple wireless networks and a wireless infrastructure can be employed. One function of the wireless infrastructure is to determine the most likely network for locating a given user and track the user as they roam between countries or networks. The messaging being delivered to the mobile devices are normally sent via RF transmission from a base station to the mobile device .

Also shown in is a composed e mail message leaving the e mail sender located somewhere on the Internet . This message is fully in the clear and uses traditional SMTP RFC822 headers and MIME body parts to define the format of the mail message. These techniques are all well known to one in the art. In this environment the message arrives at the message server and is redirected by the redirection software to the mobile device . As this redirection takes place the message is re packaged into an electronic envelope and a proprietary compression and encryption algorithm can be applied to the original message . In this way messages being read on the mobile device are no less secure then reading them on the desktop workstation . All messages exchanged between the redirection software and the mobile device use this message repackaging technique. Another goal of this outer envelope is to maintain the addressing information of the original message. This allows reply messages to reach the appropriate destination and it allows the from field to reflect the mobile user s desktop or message server account address. Using the user s corporate address from the mobile device allows the received message to appear as though the message originated from the user s desktop system rather than the mobile device .

Turning back to the serial port connectivity to the mobile device this connection path offers many advantages for enabling one time data exchange of large items. For those skilled in the art of PDAs and synchronization the most common data exchanged over this link is Personal Information Management PIM data . When exchanged for the first time this data tends to be large in quantity bulky in nature and requires a large bandwidth to be loaded onto the mobile device . This serial link is also used for other purposes including transferring a private security key a Certificate Cert of the User Certificate Revocation Lists CRLs and chained Certs . The private key allows the desktop and mobile device share at least one personality and one method for accessing all mail. The Cert and CRLs are normally exchanged because they represent a large part of the information required to implement S MIME PGP and other public key security methods. A Cert chain includes an individual s Cert as well as other Certs to verify the original Cert. Each Cert in a Cert chain is signed by a Cert issuer whose Cert normally appears next in the Cert chain. A message receiver typically traces a certification path by verifying each Cert in a Cert chain until eventually the message receiver is able to verify a common Cert trusted by both the message sender and the receiver. Once a common Cert is found a signature can be verified and trusted. The idea of using the serial port for loading Certs and CRLs will be discussed later herein. The goal of this download of Certs and CRLs is to allow the user to hand pick who they might be exchanging secure mail with and to pre load the bulky information onto the handheld device a head of time thus saving wireless bandwidth later.

Turning back to the wireless infrastructure there is a series of connections to wireless networks and . These connections could be ISDN Frame Relay or T1 connections using the TCP IP protocol used throughout the Internet. These networks could represent distinct unique and unrelated networks or they could represent the same network in different countries. For example the networks and may include such different types of network as 1 data centric wireless networks 2 voice centric wireless networks and 3 dual mode networks that can support both voice and data communications over the same physical base stations. Modern examples of these combined networks include but are not limited to 1 newer Code Division Multiple Access CDMA networks 2 the Groupe Special Mobile or the Global System for Mobile Communications GSM and the General Packet Radio Service GPRS networks and 3 third generation 3G networks like Enhanced Data rates for Global Evolution EDGE and Universal Mobile Telecommunications Systems UMTS currently under development. GPRS is a data overlay on top of the very popular GSM wireless network. Data centric network include for example 1 the Mobitex Radio Network Mobitex and 2 the DataTAC Radio Network DataTAC . Examples of older voice centric data networks include Personal Communication Systems PCS networks like CDMA GSM and Time Division Multiple Access TDMA systems.

Tuning now to which is an illustration of the main types of e mail exchanges that are commonly used today in the Internet we first have a normal exchange of e mail messages method . In this scenario an e mail is constructed using RFC822 RFC821 and MIME techniques and delivered using standard SMTP mail exchange protocols as shown at . The e mail is then received and given to the addressed users as indicated at . Such normal e mail exchange is typically secure within a company or LAN such as located behind a security firewall but not between stand alone users and or users on different networks.

Also commonly used are VPN links for inter office message exchange method for example between branch offices of the same company and sometimes between different companies that are working very closely together. Using this method a lower level security called IP Security IPSec may be used to encrypt all data being exchanged between the two VPN locations as shown at . When an encrypted e mail is received at a corresponding VPN system it is decrypted into plain text and routed to addressed users at .

E mail exchange between different companies or users that have adopted a private security scheme is illustrated in as method . In this scenario a protocol such as PGP OpenPGP or some other less widely used protocol is used to encrypt an e mail before it is sent at . Once received a corresponding mail agent decrypts the e mail and presents the plain text of the e mail to the recipient at .

Methods and shown in relate to S MIME. The methods are all different variations of S MIME. In method a sender takes a digest of an e mail message and signs the digest using the sender s private key as shown at . A digest may for example be generated by performing a check sum Cyclic Redundancy Check CRC or some other preferably non reversible operation such as a hash on the message and is then signed by the sender using the sender s private key. The signed digest is appended to the outgoing message possibly along with the Cert of the sender and possibly any chained Certs and CRLs. The receiver of such a signed message also takes a digest of the message compares this digest with the digest appended to the message retrieves the sender s public key usually by extracting the public key from the sender s Cert and verities the signature on the appended digest. These operations are part of the signature verification indicated at in . If the message content has been changed since it was signed by the sender then the digests will be different or the signature on the digest will not verify properly. This does not prevent anyone from seeing the contents of the message but does ensure the message has not been tampered with since it was signed by the sender and that the message was signed by the person as indicated on the From field of the message. The Cert Cert chain and CRLs are used by a receiver to ensure that the sender s Cert is valid i.e. that the Cert has not been revoked or expired and trusted. The combination of a digest generated at a sender with the signature on the digest is typically referred to as a digital signature. Hereinafter references to digital signatures should therefore be interpreted as including a digest and a signature of the digest.

Method represents exchange of S MIME encrypted messages. In this method a one time session key is generated used to encrypt the body of a message typically with a symmetric cipher like Triple Data Encryption Standard 3DES . The session key is then encrypted using the public key of each intended receiver of the message at . Session key encryption is often accomplished using a public key encryption algorithm such as Rivest Shamir Adelman RSA . The S MIME message including the encrypted message and all encrypted versions of the session key is sent to each receiver. Each receiver must then locate its corresponding encrypted session key normally based on a RecipientInfo summary of the receivers that is attached to the message and decrypt that particular encoded session key using its private key as indicated at . Once the session key is decrypted it is used to decrypt the message body. An S MIME message may also specify an encryption algorithm that must be used to decrypt the message. This information is normally placed in a header of an S MIME message.

Exchange of messages that have been encrypted and then signed is shown in as method . According to this scheme the sender first generates a one time session key encrypts the message body and then encrypts the session key with the public key of each receiver as described above. The sender then takes a digest of the message including the encrypted session keys and signs the digest using its private key to generate a digital signature at . Each receiver takes a digest of the message compares this digest with the digest in the digital signature appended to the message retrieves the sender s public key and verifies the signature on the digest as described above. The correct session key is then located and decrypted with the receiver s private key which then allows the message body to be decrypted. Signature verification and message decryption according to this method are shown in at .

Method in illustrates exchanging messages that have been signed and then encrypted. A digital signature is generated by a sender substantially as described above at . This digital signature as well as possibly the sender s Cert Cert chain and CRLs are all appended to the outgoing message. A session key is then generated and is used to encrypt the message body digital signature and any Certs and CRLs. The session key is encrypted with the public key of each receiver. The resultant S MIME message including the encrypted versions of the session key is transmitted to the receiver. When a receiver receives such a message as shown at it must first decrypt its corresponding encrypted session key with its private key. The decrypted session key is then used to decrypt the message body digital signature and any Certs and CRLs of the message sender. The digital signature can then be verified as described above.

In reference now to this illustration shows a company that does not use encryption and another company that does use encryption and the effects on a message. In Company C sends an e mail message to Company A. Company A as shown is a larger fortune company for example with a firewall and strong security practices. The message traverses the Internet and is received by the message server in Company A s LAN environment. All these companies are connected to the Internet using a traditional T1 ISDN or Frame Relay type connection .

Company B is also a larger company for instance a fortune company that makes use of secure e mail communications People sending e mail from Company B to Company A know that they can use S MIME to secure the e mail as both companies use the same standard. Also shown is a Public Key Server PKS that supports the use of S MIME. The PKS could reside within Company A s or Company B s firewall or anywhere on the Internet . The sender of e mail from Company B selects an encoding method in this case signed and encrypted and sends the e mail message. Software within Company B s message server will take a digest of the message and sign the digest to generate a digital signature and include the digital signature as well as the sender s Cert and CRLs from their system. A session key will also be generated and used to encrypt the message. Public keys for each receiver will the be retrieved from the PKS if necessary and encrypt the session key for each receiver. The resulting message has an encrypted component the session keys that are uniquely encrypted for each receiver as shown by the different key formats and numbers A B and C and a signed component .

As will be apparent to those skilled in the art the order of the signing and encryption operations and the message components that are signed and encrypted will depend on the variant of S MIME used by a message sender. For example if a message is to be signed and then encrypted the message digest is generated based on a body of a message the digital signature and any signature related information such as Certs and CRLs are added to the message and then the entire message including the message body digital signature and any signature related information are encrypted using the session key. The session key is then encrypted for each receiver and encrypted versions of the session key are appended to the encrypted portion of the message. On the other hand a message may be encrypted first and then the digital signature is generated based on the encrypted message body and the encrypted session keys.

These first three diagrams represent an overview of the system and how encrypted mail works today on the Internet. The next three diagrams will illustrate several examples of the method to process secure e mail messages. This first method represents a method for re organizing the message to reduce the amount of data that must be transmitted to the device. This method performs the least amount of invasive procedures on the message before it is transmitted from the host to the mobile device. As such this also means it offers the best security from the original sender to the final destination user. Naturally this assumes the office environment is safe and that an intruder could not gain access to a company computer and read secure mail within the firewall.

In reference to there is an example of how to improve processing on encrypted messages going to handheld devices. This is one of two methods that will be presented to improve the processing and transmission of public key encrypted messages. This method has the advantage of using the same message encryption all the way from the message sender to the mobile device . This could be important if there is no current encrypting being used between the redirection software and the mobile device .

In a message sender composes an e mail . In this example the e mail is being encrypted and is addressed to three recipients A B and C. The e mail sender encodes there e mail to produce a secure e mail message . The e mail is encrypted by randomly generating a session key and the session key is further encrypted using public key of each intended recipient of the e mail which for this example produces three session keys . The public key for each receiver could have been retrieved from a local storage area where the sender has previously exchanged messages with one of the receivers for example or a PKS. In this example the PKS is not shown and the location of the keys for this example is not important only that they do exist and are accessible.

The encrypted message and the session keys are passed through the insecure Internet to the destination host location . A computer at the host system connected to the Internet then receives the message which is then given to the message server for processing. Also working in cooperation with the message server is the redirection software that detects the encrypted message. To assist in the delivery of this message to the mobile device the redirection software re arranges the message and removes any session keys that are not needed for the individual user s mobile device . Another part of the encrypted message is the RecipientInfo list which provides a map as to which session key corresponds to which recipient in the To Cc or Bcc list. The RecipientInfo list is also removed since the mobile device will not need to parse through all the attached session keys once the redirector software removes all of the encrypted session keys for other recipients of the message. In the cases where there could be 50 or 100 individual recipients this could be a large overall message size savings.

In the example shown in users A and B have user accounts associated with the message server . The redirection software sends the reordered message with only the session key specifically directed to user A. As those skilled in the art will appreciate user A owns the private key that can decrypt the encrypted session key A. Similarly the redirection software reorders another transmission of message with session key B . In this case user B is the only user that can use session key B since only user B s private key can decrypt encrypted session key B. At the mobile devices both user A and user B open the message and extract the encrypted session key. The encrypted session key is then decrypted using the private key resident on each mobile device and the decrypted session key is used to decrypt the user s message. By re organizing the original message the redirection software was able to remove all unnecessary session keys and the RecipientInfo list from the original message. As the number of recipients increases the overall message size benefit is greater and the amount of data transmitted to the mobile device is reduced.

In reference now to an example of signed message processing before sending it from a host system to a mobile device is shown. In this example the user sending the message decides to sign the message to confirm that they are the authentic sender of the message. The receiving host system removes part of the signature component the Certificates and CRLs and sends that to the mobile device. The mobile device must have preloaded the removed portions of the signature or it must request them from the host in order to verify the digital signature.

At the sender system user X enters an e mail message . In this example the user X generates a digest of the message and signs the digest using their own private key. A digest is preferably a non reversible transformation that generates a unique output for every unique input such as a CRC of the message or a transformation using a digest algorithm such as MD5 ensuring that no part of the message can be changed without affecting the digest. The digest is then itself transformed using the private key of the sender by encryption or some other processing to generate a digest signature. The digest and digest signature are commonly referred to as a digital signature.

To assist in verifying user X s digital signature user X s Cert and a current CRL are also sent with the message. A Public Key Authority PKA or Certificate Authority CA normally holds Certs for a plurality of users. The PKA might link several Certs together in a Cert chain to confirm the authenticity of user X s Cert . Effectively each Cert contains a cryptographic link back to other Certs that create a chain of authorization. The CRL contains a list of Certs that should be considered invalid. For host systems that have kept old Certs this is a method for removing their rights in the system. The message is then sent with the Cert information to the destination host location associated with at least one of the intended recipients of the message .

Once received by a computer at the host location the message is processed by the message server and routed to each recipients e mail account on the message server . At this point the redirection software detects the message and reorders the message before transmission to the mobile device . The main operation is to place the text of the message first followed by the senders signature X s Signature and place the Cert Chain and the CRL last. This reordered message and possibly the signature is transmitted to each of the recipients that has a mobile devices . The signature is a truncated or reordered from of the original signature Cert and CRL components . In the first transmission the Certificates and CRLs are stored at the host location and not sent to the mobile device . At the mobile devices the users opens the message and select a Verify Signature or like menu option or operation for the message. The signature verification uses a local copy of the Cert and CRLs which may have been downloaded earlier through the serial port or received with an earlier message. If the message comes from a user whose Cert and CRL information was not previously loaded onto a mobile devices a user can request that the redirection software send the rest of the message. The second part of the message will contain the Cert and CRL for this sender and will allow the signature to be fully verified.

In reference now to there is an illustration of a message being sent that is both signed and encrypted. For the impact of performing either operation first will be discussed. That means when the message is encrypted first and signed second there are one set of re organizing methods that can be applied. When the message is signed first and encrypted second a second set of re organizing techniques can be applied. When the message is encrypted first and signed second only the signature portion can be reordered and modified. However if the message was signed first and encrypted second then only the encrypted portion can be optimized. The steps in are mostly a combination of the operations shown in and described above.

User X at system creates a mail message and decides to encrypt and then sign the message. To achieve this encoding the system first creates a session key and encrypts the message. Then the public key for each recipient is retrieved from either local storage or a PKS. For each message recipient the session key is encrypted and attached to the message along with the RecipientInfo section. Once the encryption operations are complete a digest of the new message including the encrypted session keys is taken and this digest is signed using the senders private key to generate a digital signature. In the case where the message is signed first a digest of the message would be taken first without the encrypted session keys and signed using the sender s private key. This digital signature and all the signed components as well as any Certs and CRLs would be encrypted using a session key and the session key would be encrypted using each recipients public key.

The encrypted and signed message with the session keys and Cert information is sent to another host location where it is received by a message server running on a computer system. As the message server processes the message and places it into the appropriate user s mailbox the redirector software detects the new message and begins the redirection process to each recipient that has a mobile device . Before the message is sent to a mobile device the signature or encryption section of the message is reordered and only the necessary portion is sent as described in conjunction with . If the message has been encrypted first and signed second then only the sender s digital signature is included and all other parts Certs and CRLs are placed at the end of the message. If the message was signed first and encrypted second then the extra session keys are removed and only the session key for the designated user of the mobile device is sent. Once these re organization steps are performed the resulting message is sent to each mobile user. The message to mobile device of user A is an example of a message that has been signed first and encrypted second. In this case the full signature Cert. and CRL has been included with only one session key . The message sent to the mobile device of user is an example of a message that was encrypted first and signed second. In this case the full collection of encrypted session keys are present but only the digital signature portion of the signature information is sent. In both cases a message body portion of the message remains similar as transmitted from the sender and only the other MIME parts have been reordered to allow for a reduced over the air transmission of information to the mobile devices .

When user A opens the message the single session key is decrypted and the message is decrypted to expose the signature component. A digest of the message is then taken and compared against the signed digest value in the digital signature. If the digests match and the digest signature is verified using the sender s private key then the digital signature is verified. At user B s mobile device the digital signature is first verified and then the correct session key is located and decrypted. Once the session key for the user is found and decrypted the message can be decrypted to obtain the full contents.

The preceding addressed re organizing the message before sending it to the user of the mobile device. This next example describes different ways to pre process the message to reduce data that must be transmitted over the air. The largest advantage of the pre processing method is that it deals very well with messages that are both signed and encrypted which are the most difficult messages to reorder to reduce size. These pre processing methods are most feasible if strong security is already in place between the corporate firewall and the user s mobile device for example by using a wireless friendly security solution from the company s location to the mobile device. However it could be said that any proposed e mail secure solution will have flaws if the company s own corporate location does not have office and desktop security in place. Without company security it might be possible to sneak into any office and just read another person s mail at his or her own desktop. Therefore this kind pre processing of S MIME to a wireless friendly security method done completely behind the company s firewall should be considered very secure for most companies.

In reference now to this illustration is the first of two methods for dealing with messages that have been encrypted using a public key mechanism like S MIME. Both and use this first method. This first method offers the strongest encryption support of the two methods but requires more over the air steps and more CPU and RF power resources on the mobile device. The steps used in this first method can handle the case where 1 the company s mail system and the user s mobile device have individual private and public key pairs or 2 the company s mail system and the user s mobile device have the same private and public key pairs but the messaging server and redirection software do not have access to the private key. This later situation is often the case when the private key is kept on a special smart card or hardware based key reader system. The biggest challenge with this mechanism is to deal with the fact that only the device has a copy of the private key that can decrypt the session key to decrypt their message.

In a user enters a message at workstation . The user then decides to encrypt the message using a randomly created session key and encrypts the session key with the public key of every intended recipient. In this example the message might either be addressed to both the user s desktop mail account and the user s wireless mail account i.e. when they both are using different public encryption keys. However it is more likely that the message will be addressed to the person s corporate account directly. It is possible to share the private key between the desktop and the mobile device by loading the private key into the mobile device over the serial port as shown in . To perform this the user would insert their smart card into a card reader and run a component of the redirection software to load the private key from the card reader directly into a memory of the mobile device . A full detailed description of the mobile device is included with . This shared private key is used by both the desktop and the mobile device as a way to extend the mirrored e mail concept between the two locations.

It is assumed that the necessary public keys have been retrieved by the sender from local memory or a local or Internet based PKS. The encoded message and the associated encrypted session keys are sent to one or more recipients or destination host locations . A specific machine connected to the Internet receives the message and the message is given to the message server for processing. This processing triggers the redirection software to detect the new message for the mobile user and to extract it from the message server . Since the session key is encrypted with a specific public key of the mobile device or alternatively the private key used by the user is not accessible from a piece of software running on the server the redirection software extracts the correct session key for the mobile device and sends it to the mobile device . After extracting the correct session key for the mobile user the redirection software builds an empty message that only contains the encrypted session key . The mobile device receives this empty message and extracts the encrypted session key from the message. The mobile device then decrypts the encrypted session key to recover the original session key and sends it back to the host location and redirection software . The redirection software then uses this decrypted session key to decrypt the entire message on behalf of the user. This reduces the amount of complex public key decryption operations that must be performed on the mobile device and leaves the larger decryption operation on the entire message to the redirector S W . Additionally this allows the redirector software to redirect only portions of the message in the case of a very large e mail message. A message is then constructed and sent to the mobile device and will normally be encrypted using a wireless friendly encryption method. The message can then be decrypted at the mobile device and the original message is presented to the user.

Another example of handling public key encrypted messages that use methods like S MIME is shown in . This second method focuses on a situation where the desktop and the mobile device share a common private key and the key is accessible to the mail server and redirection software. This method has the advantage of reducing the number or steps in the process removes the need to send a decrypted session key over the air and reduces the number of public key operations the mobile device must perform.

Turning now to a user composes an e mail message at workstation . A session key is created and is used to encrypt this message. This session key is then encrypted with the public key of every recipient. In this example the mobile device does not have its own public key but has received its private key over the serial port as described in conjunction with . This shared private key is used by both the desktop and the mobile device as a way to extend the mirrored e mail concept between the two locations.

The message and session keys are sent to one or more recipients or host locations based on the recipient list. The message is received by a computer that is connected to the Internet and passed to a message server that processes the message and places it into the user s mailbox. This triggers the redirection software to extract the message from the message server and detect that it has been encrypted using a public key. Instead of sending the message directly to the mobile device the redirection software uses the saved private key shared with the device to decrypt the session key . The session key is then used to decrypt the message itself.

After being decrypted the message is processed by the redirection software to reformat the decrypted message into a format for the wireless mobile communication device. For example the decrypted message may be re ordered to place the message into a format more suitable to the wireless mobile communications device and unnecessary information may be removed to reduce the message size. For instance the redirection software may reorder the message by placing the text of the message first followed by the sender s signature and place the Cert Chain and the CRL last. In addition the sender s digital signature may be truncated or reordered from the original signature Cert and CRL components as described above with reference to . In another example if the message contains MIME then parts of the message text that are encoded as text html or other alternate message format codings may be deleted to reduce the message size. Once the message has been processed the message is then re encrypted preferably using a wireless friendly encryption method and transmitted to the mobile device .

The mobile device decrypts the message and presents it to the user in its original form . This procedure allows the mobile device the fastest delivery time with the least amount of public key operations which tend to be very CPU and power intensive on the mobile device .

In an example of signed message pre processing is shown. The host location of the mobile device user performs the signature verification on behalf of the mobile device user thus saving the transmission of bulky signature data. This pre processing transfers the sender authentication step from the mobile device user to the host system.

As above an e mail message is created and signed by user X. The signed message is transmitted with all signature components to one or more destinations or host locations . A machine connected to the Internet receives the signed message and it is given to the message server . The redirection software detects the new message for user A and it is extracted for processing. The redirection software detects that the message has been signed so it goes through the process of finding the public key of the sender. The public key could come from a local storage area or from a Public Key Infrastructure PKI somewhere on the Internet for example. Once the public key of the sender is retrieved the digital signature can be verified on behalf of the mobile device user. Whether or not the signature verifies an indication is included in the message that is transmitted to the mobile device . As shown the original message is re packaged into an electronic envelope before it is sent to the mobile device . This electronic envelope is then removed at the mobile device before the message is presented to the user.

In a combination of the operations described above and shown in are being used at once. In this example a message has been signed then encrypted or encrypted and then signed. The order of the operation is not important as this method can handle either operation being performed first.

The e mail message is first composed by user X. If the user X has asked for the message to be signed first and then encrypted the first step is to generate a digital signature as described above and the digital signature possibly along with one or more Certs and CRLs will be attached to the message. Next a random session key which will be used to encrypt the message including the digital signature and any Certs and CRLs. Then the session key is further encrypted using the public key of each destination recipient. If the user has asked for the message to be encrypted and then signed the steps are slightly different. In this ease the random session key is generated first and the message is encrypted using it without the including the digital signature Certs and CRLs. Then the session key is encrypted using the public key of each recipient and a RecipientInfo component is created. All the keys and the RecipientInfo list are attached to the message. Once this is complete a digital signature of the message session keys and RecipientInfo list is generated using the senders private key. For working with public and private keys it has been assumed that the necessary public keys have been retrieved from local memory or a PKS. It is also assumed that the sender does not necessarily know whether a specific recipient is mobile since the mobile device and the desktop share the same private key. It is possible to share the private key between the desktop and the mobile device by loading the private key into the mobile device over the serial port as shown in and described above.

The encoded message the associated encrypted session keys and the associated signature information are all sent to the host location and possibly other recipients. A specific machine connected to the Internet receives the message and the message is given to the message server for processing. This processing triggers the redirection software to detect the new message for the mobile user and to extract it from the message server . Since the message has been both signed and encrypted several additional steps are performed. If the message has been signed first and then encrypted the redirection software first sends the correct session key to the mobile device for decryption. Once the decrypted session key is returned to the redirection software the message can be fully decrypted and the signature information extracted. The signature is then verified by retrieving the public key of the sender. This key might be stored in the location memory or disk location or accessible through a public key infrastructure accessible on the Internet in this example. Whether the sender s signature does or does not verify the message is re encrypted using a wireless friendly method and resultant message is transmitted to the mobile user with an indication that the message had been signed and whether or not the signature verified. The mobile user may then decrypt the transmitted message to retrieve the original message an indication that the message had been signed and whether or not the signature was verified.

If the message has been encrypted first and signed second the redirection software verifies the digital signature as described above. Whether the sender s signature verifies the correct session key may be sent to the mobile device for decryption. Once the decrypted session key is returned to the redirection software the message can be fully decrypted and sent to the user using a wireless friendly encryption algorithm. The mobile device receives and processes the message and presents the original message as well as signature indications to the mobile user.

It should be noted that a digital signature need not necessarily be verified in order for a user to view a message. By decrypting the message at the host location the user can then choose to view the message even if the signature was not verified.

Turning now to in detail the method begins at step when a message arrives from a message sender within the Internet or Intranet and is detected by the redirection software . The first step for the redirection software is to check to see if the message if in plain text or not at . This check can be easily performed by checking the MIME type or looking for attachments with a certain format and MIME value. If the information is plain text then it is opened and routed to each of the mobile devices as normal as shown at . If the information is not plain text then a check is made at step to see if the message was signed first or not signed at all. If the message was signed first this would mean the message had been encrypted last and the encryption would have to be processed before the signature. Otherwise if the message was signed last then the digital signature must be processed first before processing the encrypted component. If the message was signed first or not signed at all then an additional test for encryption is performed at step . If the message is not encrypted only i.e. not signed or was not encrypted last then there must be an error or the message has a format that the redirection software cannot handle and an error condition is declared. The particular error handling procedures may be dependent upon the implementation and may be configurable in the redirection software. If the message was encrypted last or if the message was only encrypted and not signed then the method proceeds to process the encrypted component first at .

If the message has been signed last or if the message was signed only and not encrypted then the redirector detects the signed data content via a digital signature at .. Another path into this area is after the encryption component has been processed and removed 850 . This path enters from and will be described in more detail below. This is the case when the data is signed first and encrypted second.

In this example the MD message digest is encrypted with User A s private key represented by Kto produce the digest signature A MD . At step a new message digest is generated on the content using a known algorithm or using an algorithm selected in the signed data. This produces a digest A which will be later compared to the digest sent by the original message sender. After this step the public key of the sender is retrieved from memory from a PKI or it may also be included in the SignerInfo component of the message at step . Then at step the original digest is decrypted using the public key of the sender to produce digest B. The operation is shown as taking the User A s public key Aand applying it to the private key encrypted A A MD which produces MD. Finally the digest generated from the message digest A is compared to the decrypted digest B to see if the signature is valid and the message was not tampered with at step . If the signature is invalid then a text header is added to the message at step to indicate that the signature verification failed. Otherwise a text header is added to the message at step to indicate the signature was valid.

Alternatively as described above a digital signature may include both a message digest and a digest signature. In this case digest A would be compared with the digest in the digital signature and the digest signature would also be verified using the sender s public key. Verification of the digital signature is then dependent upon both a digest match and verification of the digest signature.

Now that the signature has been processed a check is made to see if the data is still encrypted at step . The encrypted portion may have been already processed for example if the signature verification path had been entered via path . If the data is still encrypted then the method proceeds to decrypt the data via step as detailed in . If the data is no longer encrypted then a check is performed at step to determine if it had been encrypted. If it had been encrypted then a message that contains the signature validation header an indication that the message was encrypted using a public key mechanism and the original message body text is constructed and sent to the user at step . If the message was never encrypted a message that includes the signature validation header plus the message body is sent to the mobile device at step . Not shown in this flow chart is the encoding compression and encryption schemes optionally employed by the redirection software to ensure secure to the mobile device.

The first step in processing the encrypted data is to locate the RecipientInfo list structure and locate the session key for this particular user at step . The next step is to generate a canned message for the mobile device that contains the session key. This message will have text for the user to give them information about the message like the size date and originator of the message with an indication that it is encrypted. The message is sent to the mobile device at step with a boilerplate message. The mobile device then receives the message detects the session key and confirms there is a private key that can be used to decrypt the session key at step . If the device does not have the correct private key or if it has not loaded any private key or the user does not want to decrypt the message then the message cannot be viewed by the user as indicated at . Otherwise as an optional step the user may be given the choice to decrypt the message via a menu or other user interface of the mobile device at step . The decrypted session key is then passed back to the host and the original message is decrypted at step .

Once the decryption is complete a test is performed to see if the message is also signed. If the message is also signed then the method proceeds to step to process the digital signature as shown in and described above. If the message is not signed then a further test is performed at step to see if the signature was already processed. It is possible to enter the encryption processing in via path when the signed component was already processed. If the signature was already processed then the decrypted message with the signature header are all sent to the mobile device for viewing at step . Otherwise if the message was not signed then the original message is decrypted and sent to the mobile device to view at step .

The first step in is the user selecting a compose option on the mobile device. The user enters a message and requests additional security on the message at step . This might include for example S MIME PGP or some other proprietary encoding mechanisms. Then at step a test is performed to see if the user wants to add a signature to the message. If not then a test is performed at step to see if they want to add encryption. If the user has not selected to add either signature or encryption then the user s request for additional security is ignored and the message is sent according to normal procedures at step .

If the user does want to add a signature then the message text is passed to a digest function and the digest is encrypted with the User s Private key A MD at step . As described above encryption of the digest is only one example of a transformation that could be used to sign a digest. After this is complete a further test is performed to see if the user also wants to add encryption to the message at step . As those skilled in the art will appreciate the test at step assumes or alternatively may check that the message has not already been encrypted to avoid an endless loop from occurring. If the user does not want to add encryption or if encryption is already added a message is prepared and sent to the host system at step . The original message now optionally encrypted the signed digest the algorithm id and the optional session key used in the encryption are all sent to the host system. It may also be desirable to encode compress and encrypt all of this information using a wireless friendly method.

If the user didn t want to add a signature to the message but does want to add encryption or if they want to add encryption after adding the signature the method proceeds to step . At this step the mobile device will generate a session key based on the private key for this mobile user stored on the device for example. The mobile device software might optionally use the session key to encrypt the message or use a separate wireless friendly encryption method if one is already in place. Once this is complete a test is performed at step to see if the user wants to sign the message as well. As with step described above step assumes or alternatively checks that the message has not already been signed to avoid an endless loop. If the user does want a signature added then the method proceeds back to step to add the digital signature. Otherwise if the user does not want a signature or if a signature has already been added a message is prepared for the host at step . Step now takes the original message that is now encrypted includes the session key used for the encryption adds the optional signed digest and the algorithm id and sends all this to the host . As above all this information may be encoded compressed and encrypted using a wireless friendly method.

When the host receives this message from the mobile device at step it takes the components that are present which may or may not include the digital signature the algorithm id and the session key and prepares a full S MIME or PGP message to send to the destination . The processing done on behalf of the mobile device user will include creating an encrypted session key for every recipient of the message creating a RecipientInfo list creating a signature section with the public key of the user a Certificate and the Certificate Revocation List CRL for that company. These final components can take the message from 2 000 bytes into 10 000 bytes in length. Once this reconstruction is complete the message is transmitted via the message server to all destination recipients either Internet based or Intranet based within the company.

Turning now to a block diagram of an exemplary wireless communication device that could be used with the systems and methods described herein is shown. The mobile communication device is preferably a two way communication device having voice and or data communication capabilities. The device preferably has the capability to communicate with other computer systems on the Internet. Depending on the functionality provided by the device the device may be referred to as a data messaging device a two way pager a cellular telephone with data messaging capabilities a wireless Internet appliance or a data communication device with or without telephony capabilities . As mentioned above such devices are referred to generally herein simply as mobile devices.

The dual mode device includes a transceiver a microprocessor a display Flash Memory RAM auxiliary input output I O devices a serial port a keyboard a speaker a microphone a short range wireless communications sub system and may also include other device sub systems . The transceiver preferably includes transmit and receive antennas a receiver Rx a transmitter Tx one or more local oscillators LOs and a digital signal processor DSP . Within the Flash memory the device preferably includes a plurality of software modules A N that can be executed by the microprocessor and or the DSP including a voice communication module A a data communication module and a plurality of other operational modules N for carrying out a plurality of other functions.

The mobile communication device is preferably a two way communication device having voice and data communication capabilities. Thus for example the device may communicate over a voice network such as any of the analog or digital cellular networks and may also communicate over a data network. The voice and data networks are depicted in by the communication tower . These voice and data networks may be separate communication networks using separate infrastructure such as base stations network controllers etc. or they may be integrated into a single wireless network. References to the network should therefore be interpreted as encompassing both a single voice and data network or separate networks.

The communication subsystem is used to communicate with the network . The DSP is used to send and receive communication signals to and from the transmitter and receiver and may also exchange control information with the transmitter and receiver . If the voice and data communications occur at a single frequency or closely spaced set of frequencies then a single LO may be used in conjunction with the transmitter and receiver . Alternatively if different frequencies are utilized for voice communications versus data communications then a plurality of LOs can be used to generate a plurality of frequencies corresponding to the network . Although two antennas are depicted in the mobile device could be used with a single antenna structure. Information which includes both voice and data information is communicated to and from the communication module via a link between the DSP and the microprocessor .

The detailed design of the communication subsystem such as frequency band component selection power level etc. will be dependent upon the communication network in which the device is intended to operate. For example a device intended to operate in a North American market may include a communication subsystem designed to operate with the Mobitex or DataTAC mobile data communication networks and also designed to operated with any of a variety of voice communication networks such as AMPS TDMA CDMA PCS etc. whereas a device intended for use in Europe may be configured to operate with the GPRS data communication network and the GSM voice communication network. Other types of data and voice networks both separate and integrated may also be utilized with the mobile device .

Depending upon the type of network the access requirements for the dual mode mobile device may also vary. For example in the Mobitex and DataTAC data networks mobile devices are registered on the network using a unique identification number associated with each device. In GPRS data networks however network access is associated with a subscriber or user of a device . A GPRS device typically requires a subscriber identity module SIM which is required in order to operate the device on a GPRS network. Local or non network communication functions if any may be operable without the SIM but the device will be unable to carry out any functions involving communications over the network other than any legally required operations such as 911 emergency calling.

After any required network registration or activation procedures have been completed the dual mode device may send and receive communication signals preferably including both voice and data signals over the network . Signals received by the antenna from the communication network are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and may also provide analog to digital conversion. Analog to digital conversion of the received signal allows more complex communication functions such as digital demodulation and decoding to be performed using the DSP . In a similar manner signals to be transmitted to the network are processed including modulation and encoding for example by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network via the antenna . Although a single transceiver is shown in for both voice and data communications it is possible that the device may include two distinct transceivers a first transceiver for transmitting and receiving voice signals and a second transceiver for transmitting and receiving data signals.

In addition to processing the communication signals the DSP may also provide for receiver and transmitter control. For example the gain levels applied to communication signals in the receiver and transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP . Other transceiver control algorithms could also be implemented in the DSP in order to provide more sophisticated control of the transceiver .

The microprocessor preferably manages and controls the overall operation of the dual mode mobile device . Many types of microprocessors or microcontrollers could be used here or alternatively a single DSP could be used to carry out the functions of the microprocessor . Low level communication functions including at least data and voice communications are performed through the DSP in the transceiver . Other high level communication applications such as a voice communication application A and a data communication application B may be stored in the Flash memory for execution by the microprocessor . For example the voice communication module A may provide a high level user interface operable to transmit and receive voice calls between the dual mode mobile device and a plurality of other voice devices via the network . Similarly the data communication module may provide a high level user interface operable for sending and receiving data such as e mail messages files organizer information short text messages etc. between the dual mode mobile device and a plurality of other data devices via the network . On the device a secure messaging software application may operate in conjunction with the data communication module B in order to implement the secure messaging techniques described above.

The microprocessor also interacts with other device subsystems such as the display Flash memory random access memory RAM auxiliary input output I O subsystems serial port keyboard speaker microphone a short range communications subsystem and any other device subsystems generally designated as . For example the modules A N are executed by the microprocessor and may provide a high level interface between a user of the mobile device and the mobile device. This interface typically includes a graphical component provided through the display and an input output component provided through the auxiliary I O keyboard speaker or microphone .

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as keyboard and display may be used for both communication related functions such as entering a text message for transmission over a data communication network and device resident functions such as a calculator or task list or other PDA type functions.

Operating system software used by the microprocessor is preferably stored in a persistent store such as Flash memory . In addition to the operating system and communication modules A N the Flash memory may also include a file system for storing data. A storage area is also preferably provided in the Flash memory to store public keys a private key and other information required for secure messaging. The operating system specific device applications or modules or parts thereof may be temporarily loaded into a volatile store such as RAM for faster operation. Moreover received communication signals may also be temporarily stored to RAM before permanently writing them to a file system located in the persistent store .

An exemplary application module N that may be loaded onto the dual mode device is a personal information manager PIM application providing PDA functionality such as calendar events appointments and task items. This module N may also interact with the voice communication module A for managing phone calls voice mails etc. and may also interact with the data communication module B for managing e mail communications and other data transmissions. Alternatively all of the functionality of the voice communication module A and the data communication module B may be integrated into the PIM module.

The Flash memory preferably provides a file system to facilitate storage of PIM data items on the device. The PIM application preferably includes the ability to send and receive data items either by itself or in conjunction with the voice and data communication modules A B via the wireless network . The PIM data items are preferably seamlessly integrated synchronized and updated via the wireless network with a corresponding set of data items stored or associated with a host computer system thereby creating a mirrored system for data items associated with a particular user.

The mobile device may also be manually synchronized with a host system by placing the device in an interface cradle which couples the serial port of the mobile device to the serial port of the host system. The serial port may also be used to enable a user to set preferences through an external device or software application to download other application modules N for installation and to load Certs keys and other information onto a device as described above. This wired download path may be used to load an encryption key onto the device which is a more secure method than exchanging encryption information via the wireless network .

Additional application modules N may be loaded onto the dual mode device through the network through an auxiliary I O subsystem through the serial port through the short range communications subsystem or through any other suitable subsystem and installed by a user in the Flash memory or RAM . Such flexibility in application installation increases the functionality of the device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the device .

When the dual mode device is operating in a data communication mode a received signal such as a text message or a web page download will be processed by the transceiver and provided to the microprocessor which will preferably further process the received signal for output to the display or alternatively to an auxiliary I O device . A user of dual mode device may also compose data items such as email messages using the keyboard which is preferably a complete alphanumeric keyboard laid out in the QWERTY style although other styles of complete alphanumeric keyboards such as the known DVORAK style may also be used. User input to the device is further enhanced with a plurality of auxiliary I O devices which may include a thumbwheel input device a touchpad a variety of switches a rocker input switch etc. The composed data items input by the user may then be transmitted over the communication network via the transceiver . Secure messages received by and to be transmitted from the mobile device are processed by the data communication module B or an associated secure messaging software application according to the techniques described above.

When the dual mode device is operating in a voice communication mode the overall operation of the device is substantially similar to the data mode except that received signals are preferably output to the speaker and voice signals for transmission are generated by a microphone . In addition the secure messaging techniques described above might not necessarily be applied to voice communications. Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the device . Although voice or audio signal output is preferably accomplished primarily through the speaker the display may also be used to provide an indication of the identity of a calling party the duration of a voice call or other voice call related information. For example the microprocessor in conjunction with the voice communication module A and the operating system software may detect the caller identification information of an incoming voice call and display it on the display .

A short range communications subsystem may also be included in the dual mode device . For example the subsystem may include an infrared device and associated circuits and components or a short range wireless communication module such as a Bluetooth module or an 802.11 module according to the Bluetooth or 802.11 specifications respectively to provide for communication with similarly enabled systems and devices. It will be apparent to those skilled in the art that Bluetooth and 802.11 refer to sets of specifications available from the Institute of Electrical and Electronics Engineers IEEE relating to wireless LANs and wireless personal area networks respectively.

Having described in detail the preferred embodiments of the system including the preferred methods of operation it is to be understood that this operation could be carried out with different elements and steps. This preferred embodiment is presented only by way of example and is not meant to limit the scope of the present invention. For example illustrate pre processing and post processing of messages involving wireless mobile communications devices.

The sender s message is similarly processed if other mobile devices are identified by the wireless connector system to correspond to the recipients that should receive the sender s message . In this way messages e.g. modified with respect to authentication and or encryption aspect s e.g. encoding aspects are sent to other mobile devices e.g. .

It should be understood that such a system may be varied in many ways such as allowing the processing to be performed by the host system or having the wireless connector system operate within the host system or operate on a different platform from the host system . As a further example of the wide scope of the system s variations the wireless connector system may use techniques other than redirection operations to transmit messages to mobile devices e.g. and .

Such pre processing and post processing systems as described herein address many issues such as the difficulty that current systems do not attempt to deliver entire S MIME messages to a mobile device due primarily to bandwidth and battery limitations associated with mobile devices. One difficulty is that S MIME messages are usually too large to send effectively to a mobile device over a wireless communication network. If an entire S MIME message is sent either to or from a mobile device it could use excessive amounts of memory and battery power just for a single message. Considering the time necessary for reception or transmission by a mobile device the memory required for storage and the battery power required to handle the message exchange a product that tried to support straight S MIME would have undesirable qualities to the average business user. Another exemplary issue is that there are no currently available public key servers accessible to wireless networks and mobile devices. As a result the use of public key cryptographic operations is very difficult and requires heavy caching operations at the mobile device to eliminate PKI requirements. In the area of exchanging secure e mail messages there are additional problems that include 1 the inability for mobile devices to retrieve public encryption keys from PKIs to encrypt messages being sent from the mobile device 2 the inability to retrieve public keys on received messages that are signed 3 the inability to deal with very large CRLs on small devices and 4 the time delay on mobile devices with slower processors to perform complex mathematical calculations involved with public key encryption algorithms. These problems and others result in a poor and frustrating user experience when trying to exchange S MIME based e mail messages using mobile devices.

The pre processing and post processing system and method described herein process secure e mail messages so that such messages including for example S MIME messages can be exchanged with mobile devices. The system and method also leverages the processor power of a host system associated with a mobile device to enable a better user experience when exchanging S MIME messages with mobile devices.

Still further examples of the wide scope of the system and method disclosed herein are illustrated in . describe additional uses of the system and method within different exemplary communication systems. is a block diagram showing an example communication system. In there is shown a computer system a WAN corporate LAN behind a security firewall wireless infrastructure wireless networks and and wireless mobile communication devices mobile devices and . The corporate LAN includes a message server a wireless connector system a data store including at least a plurality of mailboxes a desktop computer system having a communication link directly to a mobile device such as through physical connection to an interface or connector and a wireless Virtual Private Network VPN router . Operation of the system in will be described below with reference to the messages and .

The computer system may for example be a laptop desktop or palmtop computer system configured for connection to the WAN . Such a computer system may connect to the WAN via an ISP or ASP. Alternatively the computer system may be a network connected computer system that like the computer system for example accesses the WAN through a LAN or other network. Many modern mobile devices are enabled for connection to a WAN through various infrastructure and gateway arrangements so that the computer system may also be a mobile device.

The corporate LAN is an illustrative example of a central server based messaging system that has been enabled for wireless communications. The corporate LAN may be referred to as a host system in that it hosts both a data store with mailboxes for messages as well as possibly further data stores not shown for other data items that may be sent to or received from mobile devices and and the wireless connector system the wireless VPN router or possibly other components enabling communications between the corporate LAN and one or more mobile devices and . In more general terms a host system may be one or more computers at with or in association with which a wireless connector system is operating as described above. The corporate LAN is one preferred embodiment of a host system in which the host system is a server computer running within a corporate network environment operating behind and protected by at least one security communications firewall . Other possible central host systems include ISP ASP and other service provider or mail systems. Although the desktop computer system and interface connector may be located outside such host systems wireless communication operations may be similar to those described below.

The corporate LAN implements the wireless connector system as an associated wireless communications enabling component which will normally be a software program a software application or a software component built to work with at least one or more message server. The wireless connector system is used to send user selected information to and to receive information from one or more mobile devices and via one or more wireless networks and . The wireless connector system may be a separate component of a messaging system as shown in or may instead be partially or entirely incorporated into other communication system components. For example the message server may incorporate a software program application or component implementing the wireless connector system portions thereof or some or all of its functionality.

The message server running on a computer behind the firewall acts as the main interface for the corporation to exchange messages including for example email calendaring data voice mail electronic documents and other personal information management PIM data with the WAN which will typically be the Internet. The particular intermediate operations and computers will be dependent upon the specific type of message delivery mechanisms and networks via which messages are exchanged and therefore have not been shown in . The functionality of the message server may extend beyond message sending and receiving providing such features as dynamic database storage for data like calendars todo lists task lists e mail and documentation.

Message servers such as normally maintain a plurality of mailboxes in one or more data stores such as for each user having an account on the server. The data store includes mailboxes for a number of n user accounts. Messages received by the message server that identify a user a user account a mailbox or possibly another address associated with a user account or mailbox as a message recipient will typically be stored in the corresponding mailbox . If a message is addressed to multiple recipients or a distribution list then copies of the same message may be stored to more than one mailbox . Alternatively the message server may store a single copy of such a message in a data store accessible to all of the users having an account on the message server and store a pointer or other identifier in each recipient s mailbox . In typical messaging systems each user may then access his or her mailbox and its contents using a messaging client such as Microsoft Outlook or Lotus Notes which normally operates on a PC such as the desktop computer system connected in the LAN . Although only one desktop computer system is shown in those skilled in the art will appreciate that a LAN will typically contain many desktop notebook and laptop computer systems. Each messaging client normally accesses a mailbox through the message server although in some systems a messaging client may enable direct access to the data store and a mailbox stored thereon by the desktop computer system . Messages may also be downloaded from the data store to a local data store not shown on the desktop computer system .

Within the corporate LAN the wireless connector system operates in conjunction with the message server . The wireless connector system may reside on the same computer system as the message server or may instead be implemented on a different computer system. Software implementing the wireless connector system may also be partially or entirely integrated with the message server . The wireless connector system and the message server are preferably designed to cooperate and interact to allow the pushing of information to mobile devices . In such an installation the wireless connector system is preferably configured to send information that is stored in one or more data stores associated with the corporate LAN to one or more mobile devices through the corporate firewall and via the WAN and one of the wireless networks . For example a user that has an account and associated mailbox in the data store may also have a mobile device such as . As described above messages received by the message server that identify a user account or mailbox are stored to a corresponding mailbox by the message server . If a user has a mobile device such as messages received by the message server and stored to the user s mailbox are preferably detected by the wireless connector system and sent to the user s mobile device . This type of functionality represents a push message sending technique. The wireless connector system may instead employ a pull technique in which items stored in a mailbox are sent to a mobile device responsive to a request or access operation made using the mobile device or some combination of both techniques.

The use of a wireless connector thereby enables a messaging system including a message server to be extended so that each user s mobile device has access to stored messages of the message server .

As shown in and similar to the system of there are several paths for exchanging information with a mobile device from the corporate LAN . One possible information transfer path is through the physical connection such as a serial port using an interface or connector . This path may be useful for example for transfer of bulky PIM and signature related information data synchronization and private encryption or signature key transfers as described above. In known synchronization type wireless messaging systems a physical path has also been used to transfer messages from mailboxes associated with a message server to mobile devices and .

Another method for data exchange with a mobile device is over the air through the wireless connector system and using wireless networks . As shown in this could involve a Wireless VPN router or a traditional WAN connection to wireless infrastructure that provides an interface to one or more wireless networks . The Wireless VPN router provides for creation of a VPN connection directly through a specific wireless network to a wireless device . A primary advantage of using a wireless VPN router is that it could be an off the shelf VPN component which would not require wireless infrastructure .

If a wireless VPN router is not available then a link to a WAN normally the Internet is a commonly used connection mechanism that may be employed by the wireless connector system . To handle the addressing of the mobile device and any other required interface functions wireless infrastructure is preferably used.

In some implementations more than one over the air information exchange mechanism may be provided in the corporate LAN . In the exemplary communication system of for example mobile devices associated with users having mailboxes associated with user accounts on the message server are configured to operate on different wireless networks and . If the wireless network supports IPv6 addressing then the wireless VPN router may be used by the wireless connector system to exchange data with any mobile device operating within the wireless network . The wireless network may be a different type of wireless network however such as the Mobitex network in which case information may instead be exchanged with a mobile device operating within the wireless network by the wireless connector system via a connection to the WAN and the wireless infrastructure .

Operation of the system in is similar to that of described above. An e mail message sent from the computer system and addressed to at least one recipient having both an account and mailbox or like data store associated with the message server and a mobile device or . However the e mail message is intended for illustrative purposes only. The exchange of other types of information between the corporate LAN is preferably also enabled by the wireless connector system .

The e mail message sent from the computer system via the WAN may be fully in the clear or signed with a digital signature and or encrypted depending upon the particular messaging scheme used. For example if the computer system is enabled for secure messaging using S MIME then the e mail message may be signed encrypted or both.

The e mail message arrives at the message server which determines into which mailboxes the e mail message should be stored. As described above a message such as the e mail message may include a user name a user account a mailbox identifier or other type of identifier that may be mapped to a particular account or associated mailbox by the message server . For an e mail message recipients are typically identified using e mail addresses corresponding to a user account and thus a mailbox .

The wireless connector system sends or mirrors via a wireless network or certain user selected data items or parts of data items from the corporate LAN to the user s mobile device or preferably upon detecting that one or more triggering events has occurred. A triggering event includes but is not limited to one or more of the following screen saver activation at a user s networked computer system disconnection of the user s mobile device or from the interface or receipt of a command sent from a mobile device or to the host system to start sending one or more messages stored at the host system. Thus the wireless connector system may detect triggering events associated with the message server such as receipt of a command or with one or more networked computer systems including the screen saver and disconnection events described above. When wireless access to corporate data for a mobile device or has been activated at the LAN for example when the wireless connector system detects the occurrence of a triggering event for a mobile device user data items selected by the user are preferably sent to the user s mobile device. In the example of the e mail message assuming that a triggering event has been detected the arrival of the message at the message server is detected by the wireless connector system . This may be accomplished for example by monitoring or querying mailboxes associated with the message server or if the message server is a Microsoft Exchange server then the wireless connector system may register for advise syncs provided by the Microsoft Messaging Application Programming Interface MAPI to thereby receive notifications when a new message is stored to a mailbox .

When a data item such as the e mail message is to be sent to a mobile device or the wireless connector system preferably repackages the data item as indicated at and . Repackaging techniques may be similar for any available transfer paths or may be dependent upon the particular transfer path either the wireless infrastructure or the wireless VPN router . For example the e mail message is preferably compressed and encrypted either before or after being repackaged at to thereby effectively provide for secure transfer to the mobile device . Compression reduces the bandwidth required to send the message whereas encryption ensures confidentiality of any messages or other information sent to mobile devices and . In contrast messages transferred via a VPN router might only be compressed and not encrypted since a VPN connection established by the VPN router is inherently secure. Messages are thereby securely sent via either encryption at the wireless connector system which may be considered a non standard VPN tunnel or a VPN like connection for example or the VPN router to mobile devices and . Accessing messages using a mobile device or is thus no less secure than accessing mailboxes at the LAN using the desktop computer system .

When a repackaged message or arrives at a mobile device or via the wireless infrastructure or via the wireless VPN router the mobile device or removes the outer electronic envelope from the repackaged message or and performs any required decompression and decryption operations. Messages sent from a mobile device or and addressed to one or more recipients are preferably similarly repackaged and possibly compressed and encrypted and sent to a host system such as the LAN . The host system may then remove the electronic envelope from the repackaged message decrypt and decompress the message if desired and route the message to the addressed recipients.

The wireless connector systems are similar to the wireless connector system described above in that it enables data items such as e mail messages and other items that are stored in mailboxes and possibly data items stored in a local or network data store to be sent from the LAN to one or more mobile devices . In however the network operator infrastructure provides an interface between the mobile devices and the LAN . As above operation of the system shown in will be described below in the context of an e mail message as an illustrative example of a data item that may be sent to a mobile device .

When an e mail message addressed to one or more recipients having an account on the message server is received by the message server the message or possibly a pointer to a single copy of the message stored in a central mailbox or data store is stored into the mailbox of each such recipient. Once the e mail message or pointer has been stored to a mailbox it may preferably be accessed using a mobile device or . In the example shown in the e mail message has been addressed to the mailboxes associated with both desktop computer systems and and thus both mobile devices and .

As those skilled in the art will appreciate communication network protocols commonly used in wired networks such as the LAN and or the WAN are not suitable or compatible with wireless network communication protocols used within wireless networks such as . For example communication bandwidth protocol overhead and network latency which are primary concerns in wireless network communications are less significant in wired networks which typically have much higher capacity and speed than wireless networks. Therefore mobile devices and cannot normally access the data store directly. The network operator infrastructure provides a bridge between the wireless network and the LAN .

The network operator infrastructure enables a mobile device to establish a connection to the LAN through the WAN and may for example be operated by an operator of the wireless network or a service provider that provides wireless communication service for mobile devices and . In a pull based system a mobile device may establish a communication session with the network operator infrastructure using a wireless network compatible communication scheme preferably a secure scheme such as Wireless Transport Layer Security WTLS when information should remain confidential and a wireless web browser such as a Wireless Application Protocol WAP browser. A user may then request through manual selection or pre selected defaults in the software residing in the mobile device any or all information or just new information for example stored in a mailbox in the data store at the LAN . The network operator infrastructure then establishes a connection or session with a wireless connector system using Secure Hypertext Transfer Protocol HTTPS for example if no session has already been established. As above a session between the network operator infrastructure and a wireless connector system may be made via a typical WAN connection or through the VPN router if available. When time delays between receiving a request from a mobile device and delivering requested information back to the device are to be minimized the network operator infrastructure and the wireless connector systems may be configured so that a communication connection remains open once established.

In the system of requests originating from mobile device A and B would be sent to the wireless connector systems and respectively. Upon receiving a request for information from the network operator infrastructure a wireless connector system retrieves requested information from a data store. For the e mail message the wireless connector system retrieves the e mail message from the appropriate mailbox typically through a messaging client operating in conjunction with the computer system which may access a mailbox either via the message server or directly. Alternatively a wireless connector system may be configured to access mailboxes itself directly or through the message server . Also other data stores both network data stores similar to the data store and local data stores associated with each computer system may be accessible to a wireless connector system and thus to a mobile device .

If the e mail message is addressed to the message server accounts or mailboxes associated with both computer systems and and devices and then the e mail message may be sent to the network operator infrastructure as shown at and which then sends a copy of the e mail message to each mobile device and as indicated at and . Information may be transferred between the wireless connector systems and the network operator infrastructure via either a connection to the WAN or the VPN router . When the network operator infrastructure communicates with the wireless connector systems and the mobile devices via different protocols translation operations may be performed by the network operator infrastructure . Repackaging techniques may also be used between the wireless connector systems and the network operator infrastructure and between each mobile device and the network operator infrastructure .

Messages or other information to be sent from a mobile device may be processed in a similar manner with such information first being transferred from a mobile device to the network operator infrastructure . The network operator infrastructure may then send the information to a wireless connector system for storage in a mailbox and delivery to any addressed recipients by the message server for example or may alternatively deliver the information to the addressed recipients.

The above description of the system in relates to pull based operations. The wireless connector systems and the network operator infrastructure may instead be configured to push data items to mobile devices and . A combined push pull system is also possible. For example a notification of a new message or a list of data items currently stored in a data store at the LAN could be pushed to a mobile device which may then be used to request messages or data items from the LAN via the network operator infrastructure .

If mobile devices associated with user accounts on the LAN are configured to operate within different wireless networks then each wireless network may have an associated wireless network infrastructure component similar to .

Although separate dedicated wireless connector systems are shown for each computer system in the system of one or more of the wireless connector systems may preferably be configured to operate in conjunction with more than one computer system or to access a data store or mailbox associated with more than one computer system. For example the wireless connector system may be granted access to the mailboxes associated with both the computer system and the computer system . Requests for data items from either mobile device A or B may then be processed by the wireless connector system . This configuration may be useful to enable wireless communications between the LAN and the mobile devices and without requiring a desktop computer system to be running for each mobile device user. A wireless connector system may instead be implemented in conjunction with the message server to enable wireless communications.

The wireless connector system provides for transfer of data items stored at the LAN to one or more mobile devices . These data items preferably include e mail messages stored in mailboxes in the data store as well as possibly other items stored in the data store or another network data store or a local data store of a computer system such as .

As described above an e mail message addressed to one or more recipients having an account on the message server and received by the message server may be stored into the mailbox of each such recipient. In the system of the external data store preferably has a similar structure to and remains synchronized with the data store . PIM information or data stored at data store preferably is independently modifiable to the PIM information or data stored at the host system. In this particular configuration the independently modifiable information at the external data store may maintain synchronization of a plurality of data stores associated with a user i.e. data on a mobile device data on a personal computer at home data at the corporate LAN etc. . This synchronization may be accomplished for example through updates sent to the data store by the wireless connector system at certain time intervals each time an entry in the data store is added or changed at certain times of day or when initiated at the LAN by the message server or a computer system at the data store or possibly by a mobile device through the access gateway . In the case of the e mail message for example an update sent to the data store some dine after the e mail message is received may indicate that the message has been stored in a certain mailbox in the store and a copy of the e mail message will be stored to a corresponding storage area in the data store . When the e mail message has been stored in the mailboxes corresponding to the mobile devices and for example one or more copies of the e mail message indicated at and in will be sent to and stored in corresponding storage areas or mailboxes in the data store . As shown updates or copies of stored information in the data store may be sent to the data store via a connection to the WAN or the VPN router . For example the wireless connector system may post updates or stored information to a resource in the data store via an HTTP post request. Alternatively a secure protocol such as HTTPS or Secure Sockets Layer SSL may be used. Those skilled in the art will appreciate that a single copy of a data item stored in more than one location in a data store at the LAN may instead be sent to the data store . This copy of the data item could then be stored either in more than one corresponding location in the data store or a single copy may be stored in the data store with a pointer or other identifier of the stored data item being stored in each corresponding location in the data store .

The access gateway is effectively an access platform in that it provides mobile devices and with access to the data store . The data store may be configured as a resource accessible on the WAN and the access gateway may be an ISP system or WAP gateway through which mobile devices and may connect to the WAN . A WAP browser or other browser compatible with the wireless networks and may then be used to access the data store which is synchronized with the data store and download stored data items either automatically or responsive to a request from a mobile device . As shown at and copies of the e mail message which was stored in the data store may be sent to the mobile devices and . A data store not shown on each mobile device may thereby be synchronized with a portion such as a mailbox of a data store on a corporate LAN . Changes to a mobile device data store may similarly be reflected in the data stores and .

