---

title: Systems and methods for cancelling interference using multiple attenuation delays
abstract: A wireless communication device includes, in part, at least one antenna for receiving or transmitting a signal, and a cancelation circuit adapted to cancel or reduce the self-interference signal. The cancelation circuit includes, in part, a control block, N delay and attenuation paths, a combiner, and a subtractor. Each path includes a delay element and a variable attenuator whose attenuation level varies in response to a control signal generated by the control block. Each path receives a sample of the transmit signal and generates a delayed and attenuated (weighted) version of the sample signal. The combiner combines the N delayed and weighted versions of the sample signal to construct a signal representative of the self-interference signal. The subtractor subtracts the constructed signal from the received signal thereby the cancel or reduce the self-interference signal therefrom.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09331737&OS=09331737&RS=09331737
owner: The Board of Trustees of the Leland Stanford Junior University
number: 09331737
owner_city: Palo Alto
owner_country: US
publication_date: 20130607
---
The present application claims priority to U.S. Provisional Patent Application No. 61 657 567 filed Jun. 8 2012 and entitled Multiple Tap Feed Forward Cancellation and is a continuation in part of U.S. patent application Ser. No. 13 762 043 filed Feb. 7 2013 and entitled Systems and Methods for Full Duplex Signal Shaping which claims priority to U.S. Provisional Patent Application No. 61 596 628 filed Feb. 8 2012 and entitled Enabling Algorithms and RF Circuitry for Full duplex Communication Over Arbitrary Spectrum Fragments the contents of all of which are incorporated herein by reference in their entirety.

The present invention relates to wireless communication systems and more particularly to cancellation or reduction of self interference in full duplex communication systems.

A wireless communication system operating in a half duplex mode may use the same frequency to either transmit or receive data. When operating in a full duplex mode the system may simultaneously transmit and receive data but the simultaneous transmission and reception of data occur at different frequencies. For example a full duplex cell phone uses a first frequency for transmission and a second frequency for reception of signals. Using the same frequency for simultaneous transmission and reception in a conventional wireless system results in significant amount of self interference at the receiver thereby rendering the system ineffective in receiving the desired signal. Reducing the self interference signal in a full duplex wireless communication system remains a challenge.

A wireless communication device in accordance with one embodiment of the present invention includes in part at least one antenna for receiving or transmitting a signal and a cancelation circuit adapted to cancel or reduce the self interference signal. The cancelation circuit includes in part a control block N delay and attenuation paths a combiner and a subtractor. Each path includes a delay element and an associated variable attenuator whose attenuation level varies in response to the control block. Each path receives a sample of the transmit signal and generates a delayed and weighted version of the sample signal. The combiner is adapted to combine the N delayed and weighted versions of the sample signal to construct a signal representative of a first portion of the self interference signal. The subtractor is adapted to subtract the constructed signal from the received signal. N is an integer greater than or equal to 2.

In one embodiment the delay generated by at least one of the delay elements is shorter than an arrival time of a sample of the transmit signal received at the subtractor and the delay generated by at least another one of the delay elements is longer than the arrival time of the sample of the transmit signal at the subtractor. In one embodiment the N paths include 2M paths forming M associated pairs of delay paths. The delays generated by the delay elements of each associated pair of delay paths form a time window within which time the second sample of the transmit signal arrives at the subtractor.

In one embodiment N is equal to 2M and is thus an even number. In another embodiment N is an odd number therefore the 2M paths form a subset of the N paths. In one embodiment the controller determines the attenuation levels of the variable attenuators in accordance with values of intersections of an estimate of the self interference signal and 2M sinc functions centered at the boundaries of the M windows. In one embodiment the peak value of at least a subset of the 2M sinc functions is selected to be substantially equal to an amplitude of the estimate of the self interference signal.

In one embodiment the cancellation circuit further includes in part a splitter adapted to generate the sample of transmit signal to the delay paths. In one embodiment the subtractor is a balun. In one embodiment the communication device further includes an isolator having a first port coupled to the antenna a second port coupled to a transmit line of the wireless communication device and a third port coupled to a receive line of the wireless communication device. In one embodiment the isolator is a circulator.

In one embodiment the wireless communication further includes in part a frequency downconverter configured to downconvert an output signal of the subtractor a filter adapted to filter out unselected portions of the downconverted signal and an analog to digital converter adapted to convert an output signal of the filter to a digital signal. In one embodiment the wireless communication further includes in part a processing engine configured to remove a second portion of the self interference signal from the output signal of the analog to digital converter. The processing engine optionally includes a plurality of programmable filters. In one embodiment the wireless communication further includes in part a frequency upconverter configured to upconvert a transmit signal a filter adapted to filter out unselected portions of the upconverted signal and a digital to analog converter adapted to convert an output signal of the filter to an analog signal.

A method of canceling or reducing a self interference signal in accordance with one embodiment of the present invention includes in part receiving a first sample of a transmit signal at a receiver generating N delayed versions of the first sample of the transmit signal attenuating the N delayed signals to generate N attenuated and delayed signals combining the N attenuated and delayed signals to generate a combined signal representative of a first portion of a self interference signal and subtracting the combined signal from the received signal.

In one embodiment the delay associated with a first one of the N delayed versions of the first sample of the transmit signal is set to a value less than an arrival time of a second sample of the transmit signal and the delay associated with a second one of the N delayed versions of the first sample of the transmit signal is set to a value less than the arrival time of a second sample of the transmit signal.

In one embodiment the method of cancellation further includes in part forming M time windows from the N delay paths and selecting the delays such that the arrival time of the second sample of the transmit signal falls within each of the M time windows. In one embodiment N is equal to 2M and is thus an even number. In another embodiment N is an odd number therefore the 2M paths form a subset of the N paths. In one embodiment the controller determines the attenuation levels are determined in accordance with values of intersections of an estimate of the self interference signal and 2M sinc functions centered at the boundaries of the M windows. In one embodiment the peak value of at least a subset of the 2M sinc functions is selected to be substantially equal to an amplitude of the estimate of the self interference signal. In one embodiment the first sample of the transmit signal is received via a splitter. In one embodiment the combined signal is subtracted from the received signal via a balun.

In one embodiment the method of cancellation further includes in part coupling a first port of an isolator to an antenna used by the receiver to receive signals coupling a second port of the isolator to the receiver and coupling a third port of the isolator to a transmitter causing self interference at the receiver. In one embodiment the isolator is a circulator.

In one embodiment the method of cancellation further includes in part downconverting the difference between the combined signal and the received signal to generate a downconverted signal filtering out unselected portions of the downconverted signal and converting the filtered signal to a digital signal. In one embodiment the method of cancellation further includes in part removing a second portion of the self interference signal from the converted digital signal.

In one embodiment the method of cancellation further includes in part removing a second portion of the self interference signal from the converted digital signal using a plurality of programmable filters. In one embodiment the method of cancellation further includes in part upconverting a transmit signal filtering out unselected portions of the upconverted signal and converting the filtered signal to an analog signal.

As shown the received Radio frequency RF signal is converted by frequency downconverter to a baseband signal which is filtered by filter and converted to a digital signal by ADC . Processing engine performs baseband signal processing and filtering operations on the signal it receives from ADC and delivers its output signal to devices associated with the same or other communication layers. Likewise the transmit signal supplied by processing engine is converted to an analog signal by DAC filtered by filter and upconverted to an RF signal by frequency upconverter before being delivered to antenna by splitter .

Power splitter is adapted to split and deliver a first portion of the transmit signal to transmit antenna via its high power port and a second portion of the transmit signal to attenuation and delay circuit via its low power port. Power splitter may be a passive component adapted to deliver for example 8 dBc of the signal power it receives to attenuation and delay circuit . Attenuation and delay circuit is adapted to generate a multitude of weighted and delayed samples versions of the transmit signal it receives and combine these signals to generate and deliver to balun a signal representative of the self interference signal received by antenna . Balun is adapted to subtract the signal it receives from attenuation and delay circuit from the signal it receives from antenna and deliver the resulting signal to frequency downconverter . Accordingly the self interference component of the signal supplied by balun to frequency upconverter is canceled or substantially degraded. In one embodiment self cancellation circuit may cancel e.g. 20 25 dB of self interference signal. Self cancellation circuit is further adapted to adjust the amount of self cancellation in order to accommodate the dynamic range of ADC and ensure that ADC does not saturate.

Processing engine is configured among other functions to resample signal streams. The digital baseband transmission streams received by processing engine may be up sampled e.g. from 40 Msamples sec to 200 Msamples sec by an up sampler disposed in processing engine . Processing engine is further configured to low pass filter the up sampled streams to remove undesirable aliases of the up sampled streams. Processing engine is further shown as including in part a multitude of filters intermediate frequency IF converters and an application programming interface API . Filters may be programmable and include one or more finite impulse response FIR filters one or more infinite impulse response IIR filters and the like. In one embodiment one or more of the programmable digital filters disposed in processing engine remove the remaining self interference signal that may be present at the output of self cancelation circuit . Intermediate frequency converters are adapted to convert the incoming digital baseband to a digital intermediate frequency IF when necessary.

API is adapted to program and interconnect one or more of the filters program the IF converter to achieve the desired results configure the up down samplers and up down converters. API is further adapted to coordinate the flow of signal streams across the various components disposed in filters and IF converters collect the incoming signal streams add them and send the resulting stream to DAC . For the signals that processing engine receives from the receive path API performs the above signal processing control operations in reverse.

As shown attenuation and delay circuit receives a sample TX SMP of the transmit signal TX via splitter . Attenuation and delay circuit is shown as including a multitude of paths . . . where N is an integer greater than or equal to 2. Each path is shown as including a delay element where i is an index varying from 1 to N and a variable attenuator . The delay elements may generate a fixed or a variable delay. The level of attenuation of each variable attenuator may be varied in accordance with a predefined algorithm implemented by controller . Each delay element is adapted to generate a signal Athat is a delayed version of signal TX SMP. Each variable attenuator is adapted to attenuate the amplitude of the signal Ait receives in accordance with the control signal Capplied thereto by controller so as to generate an attenuated weighted signal B. Accordingly signals Bare different delayed and weighted versions of signal TX SMP. Combiner combines signals Bto generate signal RX RC representative of the self interference component of the transmit signal. In one embodiment combiner is an adder adding signals Bto generate signal RX RC. In other embodiments combiner may perform other arithmetic or logic functions on signals Bto generate signal RX RC.

As described above attenuation and delay circuit is operative to reconstruct the self interference signal from the signal values present on paths alternatively referred to herein as taps . Since both the self interference signal and the time delayed weighted signals Bpresent on the taps are samples of the same transmit signal the reconstruction of the self interference signal is similar to band limited interpolation. Furthermore since only a finite number of taps are available a windowed interpolation may be used to reconstruct signal RX RC representative of the self interference signal. Therefore the signal representative of the self interference signal in accordance with one embodiment of the present invention is generated from signals Bthat are delayed and weighted versions of the same sampled transmit signal TX SMP.

To generate a signal representative of the self interference signal in accordance with one exemplary embodiment the delays generated in each pair of associated paths taps are selected such that the arrival time of the self interference signal at subtractor falls within the difference between these two delays also referred to herein as the delay window . Accordingly the delay generated by a first tap in each pair of associated taps is less than the arrival time of the self interference signal at subtractor referred to herein as T and the delay generated by a second tap in each pair of associated taps is greater than T. In one embodiment the center two taps namely taps and form the first pair of associated taps such that for example the delay TLgenerated by delay element is less than Tand the delay THgenerated by delay element is greater than T. TLand THare thus selected to be the closest such delays to T. The next two taps closest to the center taps namely taps and form the second pair of associated taps such that for example the delay TLgenerated by delay element is less than Tand the delay THgenerated by delay element is greater than T. TLis shorter than TL and THis longer than TH therefore TLand THare selected to be the second closest such delays to T. The delay of the remaining pairs of associated taps are similarly selected and thus are not described herein. It is understood that in other embodiments associated taps may be arranged and selected differently. For example in another embodiment taps and may be selected as associated taps and used to form a delay window.

The following description is made with reference to an arrangement according to which the center taps and form the first pair of associated taps the next two taps and form the second pair of associated taps the next two taps and form the third pair of associated taps . . . and the last two taps and form the last pair of associated taps as described above. Furthermore in the following the delays and interpolations associated with only 2 pairs of associated taps namely associated taps and associated taps are described. It is understood however that similar operations may be performed for all other taps regardless of the number of taps disposed in attenuation and delay circuit .

As shown in TLrepresents the time around which signal Bis generated the delays across attenuators are assumed to be negligible relative to the delays across delay elements THrepresents the time around which signal Bis generated TLrepresents the time around which signal Bis generated and THrepresents the time around which signal Bis generated. As is seen time delays THand TLare selected using delay elements and such that Tfalls within the window Wdefined by the difference TH TL. Likewise time delays THand TLare selected such that Tfalls within the window Wdefined by the difference TH TL. Accordingly as described above and shown in for each pair of associated taps defining a window the amount of delay generated by one of the delay paths is longer than T and the amount of delay generated by the other one of the delay paths is shorter than T. For example referring to window W THis greater than Tand TLis smaller than T. Although the above description is made with reference to paths and only it is understood that all the tap delays are selected such that Tfalls either within a window defined by any pair of associated paths. If the attenuation and delay path includes an odd number of paths i.e. N is an odd number N 1 of the delay path may be used to form associated pairs as described above. The delay Tassociated with the last remaining delay path the Nth path is selected such that Tfalls within a time from T.

To determine the level of attenuation for each attenuator in accordance with one exemplary embodiment of the present invention sinc interpolation is used it is however understood that any other interpolation scheme may also be used. To achieve this for each window the intersection of a pair of sinc functions each centered at one of the window boundaries and each having a peak value substantially equal to the peak value of an estimate of the self interference signal and the estimate of the interference signal shown as Self int is determined. For example referring to sinc function centered at TLis seen as intersecting the estimate of the self interference signal Self int at point and sinc function centered at THis seen as intersecting signal Self int at point . The heights of points and define the level of attenuations applied to attenuators and respectively. shows the attenuation levels so determined and applied to attenuators and respectively.

Since the amplitude and delay of the self interference signal is not known in advance as described above an estimate signal Self int of both the delay and amplitude of the self interference signal is initially used by control block for interpolation. As described further below the initial estimates are used to determine the attenuation levels of the attenuators thereby to generate signals Bwhich are subsequently combined to generate signal RX RC. The amount of self interference at the receiver is then measured to determine whether one or more conditions are satisfied. One such condition may be to determine whether the amount of self interference has reached below a minimum threshold level. If the condition s is not met an iterative optimization algorithm is performed by control block to arrive at new estimate s for either the delay or amplitude or both the delay and amplitude of the self interference signal. The new estimate s are subsequently used as described further below to generate new attenuation levels for the attenuators in turn resulting in generation of revised signals Bas well as revised self interference signal. The process of measuring the level of the self interference signal being canceled or reduced at the receiver arriving at a new estimate for the self interference signal based on such measurement and varying the attenuation levels of the attenuators in response continue until the predefined condition s is met.

Combiner is adapted to combine signals B B. . . Bthereby to generate signal RX RC representative of the self interference signal. As the delay of the self interference signal changes and its position within the windows moves the intersections of the self interference signal and the sinc functions change thereby causing the attenuation levels to change which in turn causes the reconstructed signal representative of the self cancelation signal to also change to track the self interference signal.

The higher the number of taps the greater is the amount of self interference. is an exemplary plot of the amount of self interference cancellation as a function of the number of taps. As is seen the amount of self interference cancellation for two taps and ten taps are respectively shown as being approximately 30 dB and 75 dB. In other words by increasing the number of taps self interference cancellation on a wider bandwidth is achieved.

The above embodiments of the present invention are illustrative and not limitative. The embodiments of the present invention are not limited by the transmitter or receiver used in the communication device. The embodiments of the present invention are not limited by the number of taps used to reconstruct the self interference signal nor are they limited by the frequency of signal transmission reception. The embodiments of the present invention may be implemented in hardware software firmware and or combinations thereof. One or more embodiments may include instructions stored in non transitory computer readable storage medium for execution by one or more processors. Other additions subtractions or modifications are obvious in view of the present disclosure and are intended to fall within the scope of the appended claims.

