---

title: System and method to enable power related decisions to start additional workload based on hardware power budget in a virtulization environment
abstract: An information handling system includes a first power detector that detects a first power level of the information handling system, a second power detector that detects a second power level of the information handling system, and a virtual machine manager. The virtual machine manager is operable to receive the first power level and the second power level, apportion a first portion of the first power level to a first workload instantiated on the information handling system, apportion a second portion of the first power level to a second workload instantiated on the information handling system, apportion a first portion of the second power level to the first workload, and apportion a second portion of the second power level to the second workload.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08813078&OS=08813078&RS=08813078
owner: Dell Products, LP
number: 08813078
owner_city: Round Rock
owner_country: US
publication_date: 20130104
---
This application is a continuation of U.S. patent application Ser. No. 12 695 591 entitled System and Method to Enable Power Related Decisions in a Virtualization Environment filed on Jan. 28 2010 the disclosure of which is hereby expressly incorporated by reference in its entirety.

This disclosure relates generally to information handling systems and relates more particularly to enabling power related decisions in an information handling system.

As the value and use of information continues to increase individuals and businesses seek additional ways to process and store information. One option is an information handling system. An information handling system generally processes compiles stores or communicates information or data for business personal or other purposes. Because technology and information handling needs and requirements can vary between different applications information handling systems can also vary regarding what information is handled how the information is handled how much information is processed stored or communicated and how quickly and efficiently the information can be processed stored or communicated. The variations in information handling systems allow information handling systems to be general or configured for a specific user or specific use such as financial transaction processing airline reservations enterprise data memory or global communications. In addition information handling systems can include a variety of hardware and software resources that can be configured to process store and communicate information and can include one or more computer systems data memory systems and networking systems. An information handling system can include virtual machines that run multiple operating systems and applications on a common host system.

The following description in combination with the Figures is provided to assist in understanding the teachings disclosed herein. The following discussion will focus on specific implementations and embodiments of the teachings. This focus is provided to assist in describing the teachings and should not be interpreted as a limitation on the scope or applicability of the teachings. However other teachings can be used in this application. The teachings can also be used in other applications and with several different types of architectures such as distributed computing architectures client server architectures or middleware server architectures and associated resources.

For purposes of this disclosure an information handling system can include any instrumentality or aggregate of instrumentalities operable to compute classify process transmit receive retrieve originate switch store display manifest detect record reproduce handle or use any form of information intelligence or data for business scientific control entertainment or other purposes. For example an information handling system can be a personal computer a PDA a consumer electronic device a network server or storage device a switch router wireless router or other network communication device or any other suitable device and can vary in size shape performance functionality and price. The information handling system can include memory volatile such as random access memory nonvolatile such as read only memory or flash memory or any combination thereof one or more processing resources such as a central processing unit CPU a graphics processing unit GPU hardware or software control logic or any combination thereof. Additional components of the information handling system can include one or more storage devices one or more communications ports for communicating with external devices as well as various input and output I O devices such as a keyboard a mouse a video graphic display or any combination thereof. The information handling system can also include one or more buses operable to transmit communications between the various hardware components. Portions of an information handling system may themselves be considered information handling systems.

Portions of an information handling system when referred to as a device a module or the like can be configured as hardware software which can include firmware or any combination thereof. For example a portion of an information handling system device may be hardware such as for example an integrated circuit such as an Application Specific Integrated Circuit ASIC a Field Programmable Gate Array FPGA a structured ASIC or a device embedded on a larger chip a card such as a Peripheral Component Interface PCI card a PCI express card a Personal Computer Memory Card International Association PCMCIA card or other such expansion card or a system such as a motherboard a system on a chip SoC or a stand alone device . Similarly the device could be software including firmware embedded at a device such as a Pentium class or PowerPC brand processor or other such device or software capable of operating a relevant environment of the information handling system. The device could also be a combination of any of the foregoing examples of hardware or software. Note that an information handling system can include an integrated circuit or a board level product having portions thereof that can also be any combination of hardware and software.

Devices or programs that are in communication with one another need not be in continuous communication with each other unless expressly specified otherwise. In addition devices or programs that are in communication with one another may communicate directly or indirectly through one or more intermediaries.

Virtual machine manager functions to create one or more workloads in virtual environment . Each workload includes a virtual operating system and application software to perform a particular dedicated task. For example one workload can operate as a mail server while another workload can operate as a file server. Virtual machine manager thus provides for the separation of the hardware and the software used for each workload within a common physical system. In a particular embodiment virtualization environment is implemented on a single information handling system and virtual machine manager implements the workloads within that information handling system. In another embodiment not illustrated virtualization environment includes two or more information handling systems grouped into a network. Here each information handling system includes a power supply similar to power supply one or more CPUs similar to CPU an I O system similar to I O system a memory system similar to memory system and a power status module similar to power status module . A virtual machine manager similar to virtual machine manager is connected to each power status module and is implemented in one or more of the information handling systems to create the workloads across the information handling systems. For example the virtual machine manager can be implemented on a single information handling system the functionality of the virtual machine manager can be distributed on two or more information handling systems or each information handling system can include a virtual machine manager that works in conjunction with the virtual machine managers in the other information handling systems.

In operation power detector module provides an indication to power status module of the power being supplied by power supply . Power detector module provides an indication to power status module of the power being consumed by CPUs . Power detector module provides an indication to power status module of the power being consumed by I O system . Power detector module provides an indication to power status module of the power being consumed by memory system . Power status module provides information about the power being consumed by CPUs I O system and memory system based upon the information provided by power detectors and . In addition power status module provides information about the power being consumed by other elements of virtualization environment based upon the information provided by power detectors and .

For example power status module can take the total power consumed by virtualization environment and subtract the sum of the power consumed by CPUs I O system and memory system as shown in Equation 1 Equation 1

where Pis the power consumed by miscellaneous elements of virtualization environment Pis the total power consumed by virtualization environment as provided by power detector Pis the power consumed by CPUs as provided by power detector Pis the power consumed by I O system as provided by power detector and Pis the power consumed by memory system as provided by power detector . In a particular embodiment not illustrated one or more of the miscellaneous elements of virtualization environment include separate power detectors to give a more detailed indication of the power usage in virtualization environment . For example a memory system a display system another system or a combination thereof can include a power detector and power status module can provide information on the power consumption as indicated by the power detector to virtual machine manager .

Virtual machine manager receives the power status indications from power status module and using other information available to virtual machine manager makes determinations related to the workloads in virtualization environment . Thus virtual machine manager includes information as to the number of workloads operating in virtualization environment and information as to the amount of resources used by each workload operating in virtualization environment . By combining the power status information from power status module with the information as to the number and resources of each workload virtual machine manager determines the power usage of each workload operating in virtualization environment .

Workload resource information includes first workload WL CPU resource information second workload WL CPU resource information WL I O resource information WL I O resource information WL memory resource information WL memory resource information WL miscellaneous resource information and WL miscellaneous resource information . WL and WL CPU resource information and are illustrated with exemplary values of 66.7 of CPU resource load and 33.3 of CPU resource load respectively. WL and WL I O resource information and are illustrated with exemplary values of 60 of I O resource load and 40 of I O resource load respectively. WL and WL memory resource information and are illustrated with exemplary values of 40 of memory resource load and 60 of memory resource load respectively. WL and WL miscellaneous resource information and are each illustrated with exemplary values of 50 of the miscellaneous resource load and 33.3 of miscellaneous resource load respectively. In a particular embodiment virtual machine manager includes information as to the resource load of each workload for the miscellaneous power consumed and applies the resource load information accordingly to determine WL and WL miscellaneous resource information and . In another embodiment virtual machine manager does not include explicit information as to the resource load of each workload for the miscellaneous power consumed but divides the total miscellaneous power by the number of workloads to derive WL and WL miscellaneous resource information and .

Workload power usage includes WL power usage and WL power usage . WL power usage includes WL CPU power usage WL I O power usage WL memory power usage and WL miscellaneous power usage . WL power usage includes WL CPU power usage WL I O power usage WL memory power usage and WL miscellaneous power usage . Each of power usages through are derived by multiplying the associated total powers through with the associated workload resource information through as illustrated in Table 1. For example WL CPU power usage shown in the column labeled Workload and the row labeled CPU as 80 W is derived by multiplying total CPU power with WL CPU resource information 120 W 66.7 80 W . WL power usage is shown in the cell labeled Total Power Workload as 220 W or 55 of total system power. Similarly WL power usage is shown in the cell labeled Total Power Workload as 180 W or 45 of total system power.

The operator of virtualization environment can use the information derived from power usage to allocate processing costs to the particular task owners associated with WL and WL . In a particular embodiment virtualization environment represents a server resource of an organization that provides processing services to various groups within the organization. For example a manufacturing group can maintain an inventory management system as a workload on a company s servers and a finance group can maintain an accounting system as a separate workload on the company s servers. The power usage information can be used to allocate the costs of maintaining and operating the company s servers. In another embodiment virtualization environment represents a server resource of an organization that provides processing services to various clients outside of the organization. For example a web hosting service can maintain server resources and operate the hosted web sites as separate workloads and the power usage information can be used to bill the owners of the hosted web sites based upon the amount of power used by each workload.

Virtual machine manager also includes information as to a power allocation budget for CPUs I O system memory system and for the miscellaneous power loads in virtualization environment . By combining the power status indications from power status module with the power allocation budgets virtual machine manager determines whether or not additional workloads can be created in virtualization environment without violating any of the power allocation budgets.

In a particular embodiment WL CPU power usage WL I O power usage WL memory power usage WL miscellaneous power usage WL CPU power usage WL I O power usage WL memory power usage and WL miscellaneous power usage are derived from workload resource information not illustrated similar to workload resource information . Thus virtual machine manager includes information as to the additional resource load that WL and WL will add in terms of allocation of CPUs I O system memory system and miscellaneous resources. For example virtual machine manager can include information that indicates that WL uses twice the processing power of either WL or WL . Then knowing that WL and WL are currently operating in virtualization environment virtual machine manager can determine if the addition of WL representing a 33.3 increase in processing power will exceed CPU power budget . Similar determinations can be made with respect to WL and to the allocation of resources to I O system memory system and the miscellaneous resources. Note that in a particular embodiment virtual machine manager estimates the additional resource load that WL and WL will add based upon extrapolations from virtual machine meta data or historical data related to the additional resource loads for WL and WL or from similar workloads.

After the cost of processing is allocated per workload in block or if the cost of processing is not to be allocated and the NO branch of decision block is taken then a decision is made as to whether or not a workload is to be added in decision block . If not then processing ends in block . If a workload is to be added then the YES branch of decision block is taken and a new workload power usage is determined in block . For example virtual machine manager can consider WL power usage for creation in virtualization environment . The workload power usage is added to the power status in block . Thus virtual machine manager can create WL power allocation by adding WL power usage to power allocation . A decision is made as whether or not the power allocation exceeds the power budget in decision block . If so the YES branch of decision block is taken and processing returns to block where another new workload power usage is determined. For example virtual machine manager can consider WL power usage for creation in virtualization environment . If the power allocation does not exceed the power budget then the NO branch of decision block is taken and the workload is created in the virtualization environment in block and processing ends in block . For example the third workload can be created by virtual machine manager in virtualization environment . In a particular embodiment not illustrated the method can proceed to consider additional workloads for creation in the virtualization environment by continuing processing in block .

In a particular embodiment an information handling system can be used to function as one or more of the network systems or carry out one or more of the methods described above. In another embodiment one or more of the systems described above can be implemented in the form of an information handling system. illustrates a functional block diagram of an embodiment of an information handling system generally designated as . Information handling system includes processor a chipset a memory a graphics interface an input output I O interface a disk controller a network interface and a disk emulator .

Processor is coupled to chipset . Chipset supports processor allowing processor to process machine executable code. In a particular embodiment not illustrated information handling system includes one or more additional processors and chipset supports the multiple processors allowing for simultaneous processing by each of the processors permitting the exchange of information between the processors and the other elements of information handling system . Processor can be coupled to chipset via a unique channel or via a bus that shares information between processor chipset and other elements of information handling system .

Memory is coupled to chipset . Memory can be coupled to chipset via a unique channel or via a bus that shares information between chipset memory and other elements of information handling system . In particular a bus can share information between processor chipset and memory . In a particular embodiment not illustrated processor is coupled to memory through a unique channel. In accordance with another aspect not illustrated an information handling system can include a separate memory dedicated to each of the processors. A non limiting example of memory includes static dynamic. Or non volatile random access memory SRAM DRAM or NVRAM read only memory ROM flash memory another type of memory or any combination thereof.

Graphics interface is coupled to chipset . Graphics interface can be coupled to chipset via a unique channel or via a bus that shares information between chipset graphics interface and other elements of information handling system . Graphics interface is coupled to a video display . Other graphics interfaces not illustrated can also be used in addition to graphics interface if needed or desired. Video display can include one or more types of video displays such as a flat panel display or other type of display device.

I O interface is coupled to chipset . I O interface can be coupled to chipset via a unique channel or via a bus that shares information between chipset I O interface and other elements of information handling system . Other I O interfaces not illustrated can also be used in addition to I O interface if needed or desired. I O interface is coupled to one or more add on resources . Add on resource can also include another data storage system a graphics interface a network interface card NIC a sound video processing card another suitable add on resource or any combination thereof.

Network interface device is coupled to I O interface . Network interface can be coupled to I O interface via a unique channel or via a bus that shares information between I O interface network interface and other elements of information handling system . Other network interfaces not illustrated can also be used in addition to network interface if needed or desired. Network interface can be a network interface card NIC disposed within information handling system on a main circuit board e.g. a baseboard a motherboard or any combination thereof integrated onto another component such as chipset in another suitable location or any combination thereof. Network interface includes a network channel that provide interfaces between information handling system and other devices not illustrated that are external to information handling system . Network interface can also include additional network channels not illustrated .

Disk controller is coupled to chipset . Disk controller can be coupled to chipset via a unique channel or via a bus that shares information between chipset disk controller and other elements of information handling system . Other disk controllers not illustrated can also be used in addition to disk controller if needed or desired. Disk controller can include a disk interface . Disk controller can be coupled to one or more disk drives via disk interface . Such disk drives include a hard disk drive HDD or an optical disk drive ODD e.g. a Read Write Compact Disk R W CD a Read Write Digital Video Disk R W DVD a Read Write mini Digital Video Disk R W mini DVD or another type of optical disk drive or any combination thereof. Additionally disk controller can be coupled to disk emulator . Disk emulator can permit a solid state drive to be coupled to information handling system via an external interface. The external interface can include industry standard busses e.g. USB or IEEE Firewire or proprietary busses or any combination thereof. Alternatively solid state drive can be disposed within information handling system .

Although only a few exemplary embodiments have been described in detail above those skilled in the art will readily appreciate that many modifications are possible in the exemplary embodiments without materially departing from the novel teachings and advantages of the embodiments of the present disclosure. Accordingly all such modifications are intended to be included within the scope of the embodiments of the present disclosure as defined in the following claims. In the claims means plus function clauses are intended to cover the structures described herein as performing the recited function and not only structural equivalents but also equivalent structures.

