---

title: Non-volatile memory systems and methods
abstract: A high speed voltage mode sensing is provided for a digital multibit non-volatile memory integrated system. An embodiment has a local source follower stage followed by a high speed common source stage. Another embodiment has a local source follower stage followed by a high speed source follower stage. Another embodiment has a common source stage followed by a source follower. An auto zeroing scheme is used. A capacitor sensing scheme is used. Multilevel parallel operation is described.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09640263&OS=09640263&RS=09640263
owner: Silicon Storage Technology, Inc.
number: 09640263
owner_city: San Jose
owner_country: US
publication_date: 20131224
---
This is a continuation of application Ser. No. 13 866 966 filed Apr. 19 2013 which is a division of application Ser. No. 12 961 458 filed Dec. 6 2010 now U.S. Pat. No. 8 432 750 which is a continuation of application Ser. No. 12 275 191 filed Nov. 20 2008 now U.S. Pat. No. 7 848 159 which is a division of application Ser. No. 11 726 913 filed Mar. 22 2007 published as US2007 0159904 A1 now U.S. Pat. No. 7 471 581 which is a continuation of application Ser. No. 10 764 381 filed Jan. 28 2002 now U.S. Pat. No. 7 196 927 which is a division of application Ser. No. 10 211 886 filed Aug. 1 2002 now U.S. Pat. No. 6 865 099 which is a continuation in part of application Ser. No. 09 929 542 filed Aug. 13 2001 now U.S. Pat. No. 6 751 118 which is a division of application Ser. No. 09 231 928 filed Jan. 14 1999 now U.S. Pat. No. 6 282 145 all of which are incorporated herein by reference in entirety.

This invention relates in general to semiconductor memories and in particular to the design and operation of multilevel nonvolatile semiconductor memories.

As the information technology progresses the demand for high density giga bit and tera bit memory integrated circuits is insatiable in emerging applications such as data storage for photo quality digital film in multi mega pixel digital camera CD quality audio storage in audio silicon recorder portable data storage for instrumentation and portable personal computers and voice data and video storage for wireless and wired phones and other personal communicating assistants.

The nonvolatile memory technology such as ROM Read Only Memory EEPROM Electrical Erasable Programmable Read Only Memory or FLASH is often a technology of choice for these application due to its nonvolatile nature meaning it still retains the data even if the power supplied to it is removed. This is in contrast with the volatile memory technology such as DRAM Dynamic Random Access Memory which loses data if the power supplied to it is removed. This nonvolatile feature is very useful in saving the power from portable supplies such as batteries. Until battery technology advances drastically to ensure typical electronic systems to function for a typical operating lifetime e.g. 10 years the nonvolatile technology will fill the needs for most portable applications.

The FLASH technology due to its smallest cell size is the highest density nonvolatile memory system currently available. The advance of the memory density is made possible by rapidly advancing the process technology into the realm of nano meter scale and possibly into the atomic scale and electron scale into the next century. At the present sub micro meter scale the other method that makes the super high density memory system possible is through the exploitation of the analog nature of a storage element.

The analog nature of a flash or nonvolatile storage element provides by theory an enormous capability to store information. For example if one electron could represent one bit of information then for one typical conventional digital memory cell the amount of information is equal to the number of electrons stored or approximately a few hundred thousands. Advances in device physics exploring the quantum mechanical nature of the electronic structure will multiply the analog information manifested in the quantum information of a single electron even further.

The storage information in a storage element is hereby defined as a discrete number of storage levels for binary digital signal processing with the number of storage levels equal to 2with N equal to the number of digital binary bits. The optimum practical number of discrete levels stored in a nonvolatile storage element depends on the innovative circuit design method and apparatus the intrinsic and extrinsic behavior of the storage element all within constraints of a definite performance target such as product speed and operating lifetime with a certain cost penalty.

At the current state of the art all the multilevel systems are only suitable for medium density i.e. less than a few tens of mega bits and only suitable for a small number of storage levels per cell i.e. less than four levels or two digital bits.

This invention describes the design method and apparatus for a super high density nonvolatile memory system capable of giga to tera bits as applied to the array architecture reference system and decoding schemes to realize the optimum possible number of storage levels within specified performance constraints. Method and apparatus for multilevel program and sensing algorithm and system applied to flash memory is also described in this invention. Details of the invention and alternative embodiments will be made apparent by the following descriptions.

The invention provides array architectures and operating methods suitable for a super high density in the giga to tera bits for multilevel nonvolatile green memory integrated circuit system. Green refers to a system working in an efficient and low power consumption manner. The invention solves the issues associated with super high density multilevel memory system such as precision voltage control in the array severe capacitive loading from MOS transistor gates and parasitics high leakage current due to memory cells and from cells to cells excessive power consumption due to large number of gates and parasitics and excessive memory cell disturbances due to large memory density.

An aspect of the invention provides an Inhibit and Select Segmentation Scheme that makes use of a truly floating bitline scheme to greatly reduce the capacitance from junctions and parasitic interconnects to a small value.

The invention also provides a Multilevel Memory Decoding scheme which is capable of greater than 10 bit multilevel operation. The Multilevel Memory Decoding Scheme includes the Power Supply Decoded Decoding Scheme the Feedthrough to Memory Decoding Scheme and the Feedthrough to Driver Decoding Scheme. The Multilevel Memory Decoding scheme also includes a winner take all Kelvin Decoding Scheme which provides precise bias levels for the memory at a minimum cost. The invention also provides a constant total current program scheme. The invention also provides fast slow and 2 step ramp rate control programming. The invention also presents reference system method and apparatus which includes the Positional Linear Reference System Positional Geometric Reference System and the Geometric Compensation Reference System. The invention also describes apparatus and method of multilevel programming reading and margining.

A sense amplifier system includes local sense amplifiers coupled to memory subarrays and global sense amplifiers coupled to groups of local sense amplifiers.

Method and apparatus described herein are applicable to digital multilevel as well as analog multilevel system.

The foregoing together with other aspects of this invention will become more apparent when referring to the following specification claims and accompanying drawings.

To facilitate the understanding of the invention a brief description of a memory cell technology is described below. In an embodiment the invention applies to Source Side Injection SSI flash memory cell technology which will be referred to as SSI flash memory cell technology. The invention is equally applicable to other technologies such as drain side channel hot electron CHE programming ETOX P channel hot electron programming other hot electron programming schemes Fowler Nordheim FN tunneling ferro electric memory and other types of memory technology.

A cell structure of one typical SSI flash cell is symbolically shown in . Its corresponding transistor symbol is shown in . The cell is made of two polysilicon gates abbreviated as poly a floating gate poly FG F and a control gate poly CG C. The control gate CG C also acts as a select gate that individually select each memory cell. This has the advantage of avoiding the over erase problem which is typical of stacked gate CHE flash cell. The floating gate has a poly tip structure that points to the CG C this is to enhance the electric field from the FG F to the CG C which allows a much lower voltage in FN erase without using a thin interpoly oxide.

The thicker interpoly oxide leads to a higher reliability memory cell. The cell is also fabricated such that a major portion of the FG F overlaps the source junction S. This is to make a very high coupling ratio from the source S to FG F which allows a lower erase voltage and is advantageous to the SSI programming which will be described shortly. A structural gap between the FG F and at CG C is also advantageous for the efficient SSI programming.

The SSI flash memory cell enables low voltage and low power performance due to its intrinsic device physics resulting from its device structure. The SSI flash cell uses efficient FN tunneling for erase and efficient SSI for programming. The SSI flash cell programming requires a small current in hundreds of nano amps and a moderate voltage range of 8 to 11 volts. This is in contrast to that of a typical drain side channel hot electron memory cell programming which requires current in hundreds of microamp to milliamp range and a voltage in the range of 11 to 13 volts.

The SSI flash memory cell erases by utilizing Fowler Nordheim tunneling from the floating gate poly to the control gate poly by applying a high erase voltage on the control gate CG C e.g. 8 13 volts and a low voltage on the source S e.g. 0 0.5 volts. The high erase voltage together with high coupling from the source to the floating gate creates a localized high electric field from the FG F tip to the CG C and causes electrons to tunnel from the FG F to the CG C near the tip region. The resulting effect causes a net positive charge on the FG F.

The SSI flash memory cell programs by applying a high voltage on the source S herein also known as common line CL e.g. 4 13 V a low voltage on the CG C e.g. 0.7 2.5 V and a low voltage on the drain D herein also known as the bitline BL e.g. 0 1V. The high voltage on the source S strongly couples to the FG to strongly turn on the channel under the FG it will be equivalently referred to as the FG channel . This in turn couples the high voltage on the source S toward the gap region. The voltage on the CG C turns on the channel directly under the CG C it will be equivalently referred to as the CG channel . This in turn couples the voltage on the drain D toward the gap region. Hence the electrons flow from the drain junction D through the CG channel through the gap channel through the FG channel and finally arrive at the source junction.

Due to the gap structure between the CG C and the FG F in the channel under the gap there exists a strong lateral electric field EGAPLAT G. As the EGAPLAT G reaches a critical field electrons flowing across the gap channel become hot electrons. A portion of these hot electrons gains enough energy to cross the interface between the silicon and silicon dioxide into the silicon dioxide. And as the vertical field Ev is very favorable for electrons to move from the channel to the FG F many of these hot electrons are swept toward the FG F thus reducing the voltage on the FG F. The reduced voltage on the FG F reduces electrons flowing into the FG F as programming proceeds.

Due to the coincidence of favorable Ev and high EGAPLAT G in the gap region the SSI memory cell programming is more efficient over that of the drain side CHE programming which only favors one field over the other. Programming efficiency is measured by how many electrons flow into the floating gate as a portion of the current flowing in the channel. High programming efficiency allows reduced power consumption and parallel programming of multiple cells in a page mode operation.

The challenges associated with putting together a billion transistors on a single chip without sacrificing performance or cost are tremendous. The challenges associated with designing consistent and reliable multilevel performance for a billion transistors on a single chip without sacrificing performance or cost are significantly more difficult. The approach taken here is based on the modularization concept. Basically everything begins with a manageable optimized basic unitary block. Putting appropriate optimized unitary blocks together makes the next bigger optimized block.

A super high density nonvolatile multilevel memory integrated circuit system herein described is used to achieve the performance targets of read speed write speed and an operating lifetime with low cost. Read speed refers to how fast data could be extracted from a multilevel memory integrated circuit system and made available for external use such as for the system microcontroller shown in which is described later. Write speed refers to how fast external data could be written into a multilevel memory integrated circuit system. Operating lifetime refers to how long a multilevel memory integrated circuit system could be used in the field reliably without losing data.

Speed is modularized based on the following concept T CV I where switching time T is proportional to capacitance C multiplied by the voltage swing V divided by the operating current I. Methods and apparatuses are provided by the invention to optimize C V and I to achieve the required specifications of speed power and optimal cost to produce a high performance high density multilevel memory integrated circuit system. The invention described herein makes the capacitance independent of memory integrated circuit density to the first order and uses the necessary operating voltages and currents in an optimal manner.

A nonvolatile multilevel memory system is shown in . A super high density nonvolatile multilevel memory integrated circuit IC system is a digital multilevel nonvolatile flash memory integrated circuit capable of storing 2storage levels per one memory cell with N number of digital bits. A system microcontroller is a typical system controller used to control various system operations. Control signals CONTROL SIGNALS L input output bus IO BUS L and ready busy signal R BB RB are for communication between the system microcontroller and the super high density nonvolatile multilevel memory integrated circuit system .

An electronic camera system SILICONCAM utilizing super high density nonvolatile multilevel memory IC system is shown in . The system SILICONCAM includes an integrated circuit system ECAM and an optical lens block LENS . The integrated circuit system ECAM includes an image sensor IMAGE SENSOR an analog to digital converter block A D CONVERTER a system microcontroller and the multilevel memory IC system . The optical lens block LENS is used to focus light into the IMAGE SENSOR which converts light into an analog electrical signal. The IMAGE SENSOR is a charge coupled device CCD or a CMOS sensor. The block A D CONVERTER is used to digitize the analog electrical signal into digital data. The microcontroller is used to control various general functions such as system power up and down exposure time and auto focus. The microcontroller is also used to process image algorithms such as noise reduction white balance image sharpening and image compression. The digital data is stored in the multilevel memory IC system . The digital data can be down loaded to another storage media through wired or wireless means. Future advances in process and device technology can allow the optical block LENS to be integrated in a single chip with the ECAM .

An electronic audio system SILICONCORDER utilizing super high density nonvolatile multilevel memory IC system is shown in . The SILICONCORDER includes an integrated circuit system SILICONAUDIO a MICROPHONE and a SPEAKER . The system SILICONAUDIO includes an anti alias FILTER an A D CONVERTER a smoothing FILTER a D A CONVERTER a system microcontroller and the multilevel memory IC system . The FILTER and the FILTER can be combined into one filter block if the signals are multiplexed appropriately. The microcontroller is used to control various functions such as system power up and down play record message management audio data compression and voice recognition. In recording a sound wave the MICROPHONE converts the sound wave into an analog electrical signal which is filtered by the FILTER to reduce non audio signals. The filtered analog signal is then digitized by the A D CONVERTER into digital data. The digital data is then stored in compressed or uncompressed form in the multilevel memory IC system . In playing back the stored audio signal the microcontroller first uncompresses the digital data if the data is in compressed form. The D A CONVERTER then converts the digital data into an analog signal which is filtered by a smoothing filter FILTER . The filtered output analog signal then goes to the SPEAKER to be converted into a sound wave. The signal filtering can be done by digital filtering by the microcontroller . External digital data can be loaded into the multilevel memory IC system through wired or wireless means. Future advances in process and device technology can allow the MICROPHONE and the SPEAKER to be integrated in a single chip with the SILICONAUDIO .

A circuit block diagram of the super high density nonvolatile multilevel memory integrated circuit system based on the concepts described above and also on ideas described below is shown in . For the purpose of discussion a giga bit nonvolatile multilevel memory chip is described.

It includes a total of for example 256 million nonvolatile memory cells for a 4 bit digital multilevel memory cell technology or 128 million cells for a 8 bit digital multilevel memory cell technology. An N bit digital multilevel cell is defined as a memory cell capable of storing 2levels. A reference array MFLASHREF is used for the reference system. A redundancy array MFLASHRED is used to increase production yield by replacing bad portions of the regular memory array of the circuit block . An optional spare array MFLASHSPARE can be used for extra data overhead storage such as for error correction.

A y driver block YDRV including a plurality of single y drivers YDRVS S is used for controlling the bitlines during write read and erase operation. Block YDRVS S will be described in detail below in the description of the multilevel algorithm. Multiples of y driver block YDRV are used for parallel multilevel page writing and reading to speed up the data rate during write to and read from the multilevel memory IC system . A reference y driver block REFYDRV including a plurality of single reference y drivers REFYDRVS S is used for the reference array block MFLASHREF . A redundant y driver block RYDRV including a plurality of single redundant y drivers RYDRVS S is used for the redundant array MFLASHRED . The function of block RYDRVS S is similar to that of block YDRVS S. A spare y driver block SYDRV including a plurality of single spare y drivers SYDRVS S is used for the spare array MFLASHSPARE . The function of block SYDRVS S is similar to that of block YDRVS S. A page select block PSEL is used to select one bitline out of multiple bitlines for each single y driver YDRVS S inside the block YDRV . Corresponding select circuit blocks for reference array redundant array and spare array are a reference page select block PRSEL a redundant page select block and a spare page select block . A byte select block BYTESEL is used to enable one byte data in or one byte data out of the blocks YDRV at a time. Corresponding blocks for reference array redundant array and spare array are a reference byte select block a redundant byte select block and a spare byte select block . The control signals for circuit blocks and are in general different from the control signals for circuit blocks and of the regular memory array of the circuit block . The control signals are not shown in the figures.

A multilevel memory precision decoder block MLMDEC is used for address selection and to provide precise multilevel bias levels over temperature process corners and power supply as required for consistent multilevel memory operation for the regular memory array of the circuit block and for the redundant array . A multilevel memory precision decoder block MLMSDEC is used for address selection and to provide precise multilevel bias levels over temperature process corners and power supply as required for consistent multilevel memory operation for the spare array .

An address pre decoding circuit block XPREDEC is used to provide decoding of addresses A. The term AN denotes the most significant bit of addresses depending on the size of the memory array. The outputs of block XPREDEC couple to blocks MLMDEC and block MLMSDEC . An address pre decoding block XCGCLPRED is used to provide decoding of addresses A. The outputs of block also couple to blocks MLMDEC and block MLMSDEC .

A page address decoding block PGDEC is used to provide decoding of addresses A. The outputs of block PGDEC couple to blocks PSEL . A byte address decoding block BYTEDEC is used to provide decoding of addresses A. The outputs of block BYTEDEC couple to blocks BYTESEL . An address counter block ADDRCTR provides addresses A A and A for row page and byte addresses respectively. The outputs of the block ADDRCTR couple to blocks XPREDEC XCGCLPRED PGDEC and BYTEDEC . The inputs of the block ADDRCTR are coupled from the outputs of an input interface logic block INPUTLOGIC .

The input interface logic block INPUTLOGIC is used to provide external interface to systems off chip such as the microcontroller . Typical external interface for memory operation are read write erase status read identification ID read ready busy status reset and other general purpose tasks. Serial interface can be used for the input interface to reduce pin counts for high density chip due to a large number of addresses. Control signals L are used to couple the INPUTLOGIC to the system microcontroller . The INPUTLOGIC includes a status register that is indicative of the status of the memory chip operation such as pass or fail in program or erase ready or busy write protected or unprotected cell margin good or bad restore or no restore etc. The margin and restore concepts are described more in detail in the multilevel algorithm description.

An algorithm controller block ALGOCNTRL is used to handshake the input commands from the block INPUTLOGIC and to execute the multilevel erase programming and sensing algorithms as needed for multilevel nonvolatile operation. The ALGOCNTRL is also used to algorithmically control the precise bias and timing conditions as required for multilevel precision programming.

A test logic block TESTLOGIC is used to test various electrical features of the digital circuits analog circuits memory circuits high voltage circuits and memory array. The inputs of the block TESTLOGIC are coupled from the outputs of the INPUTLOGIC . The block TESTLOGIC also provides timing speed up in production testing such as faster write read and mass modes. The TESTLOGIC is also used to provide screening tests associated with memory technology such as various disturb and reliability tests. The TESTLOGIC also allows an off chip memory tester to directly take over the control of various on chip logic and circuit bias blocks to provide various external voltages and currents and external timing. This feature permits for example screening with external voltage and external timing or permits accelerated production testing with fast external timing.

A fuse circuit block FUSECKT is a set of nonvolatile memory cells configured at the external system level at the tester at the user or on chip on the fly to achieve various settings. These settings can include precision bias levels precision on chip oscillator programmable logic features such as write lockout feature for portions of an array redundancy fuses multilevel erase program and read algorithm parameters or chip performance parameters such as write or read speed and accuracy.

A reference control circuit block REFCNTRL is used to provide precision reference levels for precision voltage levels as required for multilevel programming and sensing.

A voltage algorithm controller block VALGGEN provides various specifically shaped voltage signals of amplitude and duration as required for multilevel nonvolatile operation and to provide precise voltage levels with tight tolerance as required for precision multilevel programming erasing and sensing.

A circuit block BGAP is a bandgap voltage generator based on the bandgap circuit principle to provide a precise voltage level over process temperature and supply as required for multilevel programming and sensing.

A voltage and current bias generator block V IREF is an on chip programmable bias generator. The bias levels are programmable by the settings of the control signals from the FUSECKT and also by various metal options. A precision oscillator block PRECISIONOSC provides accurate timing as required for multilevel programming and sensing.

Input buffer blocks are typical input buffer circuits for example TTL input buffers or CMOS input buffers. Input output io buffer blocks includes typical input buffers and typical output buffers. A typical output buffer is for example an output buffer with slew rate control or an output buffer with level feedback control. A circuit block R is an open drained output buffer and is used for ready busy handshake signal R BB RB.

A voltage multiplier also known as charge pump block VMULCKT provides voltage levels above the external power supply required for erase program read and production tests. A voltage multiplying regulator block VMULREG provides regulation for the block VMULCKT for power efficiency and for transistor reliability such as to avoid various breakdown mechanisms.

A flash power management block FPMU is used to efficiently manage power on chip such as powering up only the circuit blocks in use. The FPMU also provides isolation between sensitive circuit blocks from the less sensitive circuit blocks by using different regulators for digital power VDDD VSSD analog power VDDA VSSA and IO buffer power VDDIO VSSIO . The FPMU also provides better process reliability by stepping down power supply VDD to lower levels required by transistor oxide thickness. The FPMU allows the regulation to be optimized for each circuit type. For example an open loop regulation could be used for digital power since highly accurate regulation is not required and a closed loop regulation could be used for analog power since analog precision is normally required. The flash power management also enables creation of a green memory system since power is efficiently managed.

Block diagram of the FPMU is shown in . A VDD and a VSS are externally applied power supply and ground lines respectively. A block ANALOG POWER REGULATOR A is an analog power supply regulator which uses closed loop regulation. The closed loop regulation is provided by negative feedback action of an operational amplifier op amp configured in a voltage buffer mode with a reference voltage VREF1 on the positive input of the op amp . A filter capacitor CFILL is used for smoothing transient response of the analog power VDDA . A ground line VSSA is for analog power supply. A block DIGITAL POWER REGULATOR B is a digital power supply regulator which uses open loop regulation. The open loop regulation is provided by source follower action of a transistor with a reference voltage VREF2 on its gate. A pair of filter capacitor CFIL4 and CFIL2 are used for smoothing transient response of digital power VDDD . A loading element LOAD1 is for the transistor . A ground line VSSD is for digital power supply. A block IO POWER REGULATOR C is an IO power supply regulator which uses open loop regulation similar to that of the digital power supply B. The open loop regulation is provided by a transistor with a reference voltage VREF3 on its gate. A loading element LOAD2 is for transistor . A pair of capacitors CFIL5 and CFIL3 are used for smoothing transient response of IO power VDDIO . A ground line VSSIO is for IO power supply. A block D includes various circuits that require unregulated power supply such as transmission switches high voltage circuits ESD structures and the like.

A block PORK is a power on reset circuit which provides a logic signal PON indicating that the power supply being applied to the chip is higher than a certain voltage. The signal PON is typically used to initialize logic circuits before chip operation begins.

A block VDDDET is a power supply detection circuit which provides a logic signal VDDON indicating that the operating power supply is higher than a certain voltage. The block VDDDET is normally used to detect whether the power supply is stable to allow the chip to take certain actions such as stopping the programming if the power supply is too low.

A block FPMUCNTRL is a power supply logic controller that receives control signals from blocks PORK VDDDET INPUTLOGIC ALGOCNTRL and other logic control blocks to power up and power down appropriately power supplies and circuit blocks. The FPMUCNTRL is also used to reduce the power drive ability of appropriate circuit blocks to save power. A line PDDEEP is used to power down all regulators. Lines PDAPOW PDDPOW and PDIOPOW are used to power down blocks A B and C respectively. Lines PDDEEP PDAPOW PDDPOW and PDIOPOW come from block FPMUCNTRL .

It is possible that either closed or open loop regulation could be used for any type of power supply regulation. It is also possible that any power supply could couple directly to the applied power supply VDD without any regulation with appropriate consideration. For example VDDA or VDDIO could couple directly to VDD if high voltage transistors with thick enough oxide are used for analog circuits or IO buffer circuits respectively.

A typical memory system operation is as follows a host such as the microcontroller sends an instruction also referred to as a command such as a program instruction via the CONTROL SIGNALS L and the IO BUS L to the multilevel memory chip see . The INPUTLOGIC interprets the incoming command as a valid command and initiates the program operation internally. The ALGOCNTRL receives the instruction from the INPUTLOGIC to initiate the multilevel programming algorithmic action by outputting various control signals for the chip. A handshake signal such as the ready busy signal R BB RB then signals to the microcontroller that the multilevel memory chip is internally operating. The microcontroller is now free to do other tasks until the handshake signal R BB RB signals again that the multilevel memory chip is ready to receive the next command. A timeout could also be specified to allow the microcontroller to send the commands in appropriate times.

A read command including a read operational code and addresses is sent by the microcontroller via the CONTROL SIGNALS L and IO BUS L. The INPUTLOGIC decodes and validates the read command. If it is valid then incoming addresses are latched in the ADDRCTR . The ready busy signal R BB RB now goes low to indicate that the multilevel memory device has begun read operation internally. The outputs of ADDRCTR couple to blocks XPREDEC XCGCLPRED PGDEC BYTEDEC and REDCNTRL . The outputs of blocks and couple to blocks MLMDEC MLSMDEC and block to enable appropriate memory cells. Then the ALGOCNTRL executes a read algorithm. The read algorithm will be described in detail later in the multilevel algorithm description. The read algorithm enables blocks BGAP V IREF PRECISIONOSC VALGGEN and REFCNTRL to output various precision shaped voltage and current bias levels and algorithmic read timing for read operation which will be described in detail later in the description of the multilevel array architecture. The precision bias levels are coupled to the memory cells through blocks MLMDEC MLMSDEC and block .

In an embodiment the read algorithm operates upon one selected page of memory cells at a time to speed up the read data rate. A page includes a plurality of memory cells e.g. 1024 cells. The number of memory cells within a page can be made programmable by fuses e.g. 512 or 1024 to optimize power consumption and data rate. Blocks PGDEC MLMDEC MLMSDEC and PSEL select a page. All memory cells in the selected page are put in read operating bias condition through blocks MLMDEC MLMSDEC PSEL and XCGCLPRED . After the readout voltage levels are stable a read transfer cycle is initiated by the block ALGOCNTRL . All the readout voltages from the memory cells in the selected page are then available at the y drivers YDRVS S RYDRVS S and SYDRVS S inside block YDRV RYDRV and SYDRV respectively.

Next in the read transfer cycle the ALGOCNTR executes a multilevel read algorithm to extract the binary data out of the multilevel cells and latches them inside the YDRVS S RYDRVS S and SYDRVS S. This finishes the read transfer cycle. A restore flag is now set or reset in the status register inside the INPUTLOGIC . The restore flag indicates whether the voltage levels of the multilevel memory cells being read have been changed and whether they need to be restored to the original voltage levels. The restore concept will be described more in detail in the multilevel algorithm description. Now the ready busy signal R BB RB goes high to indicate that the internal read operation is completed and the multilevel memory device is ready to transfer out the data or chip status. The microcontroller now can execute a status read command to monitor the restore flag or execute a data out sequence. The data out sequence begins with an external read data clock provided by the microcontroller via the CONTROL SIGNAL L coupled to an input buffer to transfer the data out. The external read data clock couples to the blocks BYTEDEC and BYTESEL and to enable the outputs of the latches inside blocks YDRV or RYDRV or SYDRV to output one byte of data at a time into the bus IO . The external read data clock keeps clocking until all the desired bytes of the selected page are outputted. The data on bus IO is coupled to the microcontroller via IO BUS L through IO buffers .

A program command including a program operational code addresses and data is sent by the microcontroller via CONTROL SIGNALS L and IO BUS L. The INPUTLOGIC decodes and validates the command. If it is valid then incoming addresses are latched in the ADDRCTR . The data is latched in the latches inside YDRV RYDRV and SYDRV via blocks BYTEDEC BYTESEL and respectively. The ready busy signal R BB RB now goes low to indicate that the memory device has begun program operation internally. The outputs of ADDRCTR couple to blocks XPREDEC XCGCLPRED PGDEC BYTEDEC and REDCNTRL . The outputs of blocks and couple to blocks MLMDEC MLSMDEC and to enable appropriate memory cells. Then the ALGOCNTRL executes a program algorithm which will be described in detail later in the multilevel algorithm description. The ALGOCNTRL enables blocks BGAP V IREF PRECISIONOSC VALGGEN and REFCNTRL to output various precision shaped voltage and current bias levels and algorithmic program timing for the program operation which will be described in detail later in the description of the multilevel array architecture. The precision bias levels are coupled to the memory cells through blocks MLMDEC MLMSDEC and block .

In an embodiment the program algorithm operates upon one selected page of memory cells at a time to speed up the program data rate. Blocks PGDEC MLMDEC MLMSDEC and PSEL select a page. All memory cells in the selected page are put in appropriate program operating bias condition through blocks MLMDEC MLMSDEC PSEL and XCGCLPRED . Once the program algorithm finishes program flags are set in the status register inside the block INPUTLOGIC to indicate whether the program has been successful. That is all the cells in the selected page have been programmed correctly without failure and with enough voltage margins. The program flags are described more in detail in the multilevel algorithm description. Now the ready busy signal R BB RB goes high to indicate that the internal program operation is completed and the memory device is ready to receive the next command.

An erase command including an erase operational code and addresses is sent by the microcontroller via CONTROL SIGNALS L and BUS L. The INPUTLOGIC decodes and validates the command. If it is valid then incoming addresses are latched in the ADDRCTR . The ready busy signal R BB RB now goes low to indicate that the memory device has begun erase operation internally. The outputs of ADDRCTR couple to blocks XPREDEC XCGCLPRED PGDEC BYTEDEC and REDCNTRL . The outputs of blocks and couple to blocks MLMDEC MLSMDEC and to enable appropriate memory cells. Then the ALGOCNTRL executes an erase algorithm. The ALGOCNTRL enables blocks BGAP V IREF PRECISIONOSC VALGGEN and REFCNTRL to output various precision shaped voltage and current bias levels and algorithmic erase timing for erase operation. The shaped voltage for erase is to minimize electric field coupled to memory cells which minimizes the damage to memory cells during erasing. The precision bias levels are coupled to the memory cells through blocks MLMDEC MLMSDEC and block .

In an embodiment the erase algorithm operates upon one selected erase block of memory cells at a time to speed up the erase time. An erase block includes a plurality of pages of memory cells e.g. 32 pages. The number of pages within an erase block can be made programmable by fuses to suit different user requirements and applications. Blocks PGDEC MLMDEC MLMSDEC and PSEL select a block. All memory cells in the selected block are put in erase operating bias condition through blocks MLMDEC MLMSDEC PSEL and XCGCLPRED . Once the erase algorithm finishes the erase flags are set in the status register inside the block INPUTLOGIC to indicate whether the erase has been successful. That is all the cells in the selected page have been erased correctly to desired voltage levels without failure and with enough voltage margins. Now the ready busy signal R BB RB goes high to indicate that the internal erase operation is completed and the multilevel memory device is ready to receive the next command.

The demanding requirements associated with putting together a billion transistors on a single chip with the ability to store multiple precision levels per cell and operating at a very high speed are contradictory. These requirements need innovative approaches and careful tradeoffs to achieve the objective. Examples of tradeoffs and problems with prior art implementation are discussed below. In conventional prior art architectures a voltage drop along a metal line of a few tens of millivolts could be easily tolerated. Here in a super high density nonvolatile multilevel memory integrated circuit system such a voltage drop can cause unacceptable performance degradation in precision levels due to the high number of levels stored per memory cell. In conventional array architectures a bit line capacitance in the order of 10 pico farads would be a non issue. Here it may be unworkable due to the high data rate required. In prior art array architectures a bias level variation from one memory cell to another in the order of 30 percent would be a typical situation. Here such a bias variation would be a serious performance problem. In prior art array architectures the total resistance of a memory source line in the order of a few hundreds of ohms would be a typical situation here a few tens of ohms is a serious problem. The huge number of memory cells of the giga to tera bit high density memory system compounds the matter even further by making the memory source line longer. Another challenge facing the multilevel system is maintaining high speed sensing and programming with low power again requiring tradeoffs. Another challenge facing the multilevel system is high speed sensing and programming with very high precision voltages due to a high number of levels stored per digital multilevel memory cell again a conflicting demand. Another challenge facing the multilevel system is high speed sensing and programming consistently every time over many years process corners temperature and power supply variation.

To get an appreciation of the order of magnitude of the difficulty involved in the super high density multilevel nonvolatile memory system numerical examples will be given corresponding to a one giga bit array architecture system suitable for 256 levels i.e. 8 bits. The array is then organized as 8192 bitlines or columns and 16384 rows or wordlines for a total of 134 217 730 physical cells.

One sensing level V1level multilevel sensing range 2 N number of digital bits stored per memory cell. Multilevel sensing range is the readout voltage range from sensing a multilevel memory cell. Assuming the multilevel sensing range from the multilevel memory cell available is 2048 millivolts then V1level 2048 256 8 millivolts.

A very high data rate is required for applications such as image or high density data storage. For example write and read rates of a mega byte per second are required. To achieve this high data rate parallel writing and sensing is required for the super high density nonvolatile multilevel memory integrated circuit system. In the present embodiment a total of 1024 y drivers YDRVS S inside blocks YDRV are used. This allows 1024 memory cells to be written and sensed at the same time in a page mode manner effectively increasing the speed by a factor of 1024 over single cell operation. The number of bitlines multiplexed into one single y driver YDRVS S is 8192 1024 8 bitlines.

A program algorithm described in more detail elsewhere in this specification is able to achieve desired multilevel resolution. The read or program multilevel resolution is the smallest voltage range in read or program respectively needed to operate the multilevel memory cells correctly. An erase algorithm first erases the memory cells to make the cell readout voltage reaching a certain desired voltage level. Then the iterative program algorithm is applied to the memory cells. The program algorithm includes a plurality of verify program cycles. A verify program cycle includes a verify cycle followed by a program cycle. A verify cycle is done first to inhibit the cell from the first programming pulse if the cell is verified therefore preventing possible over programming. Over programming means that after a programming pulse the cell sensing level passes a desired voltage level by more than a desired voltage amount. A verify cycle is used to determine whether the desired readout sensing level has been reached. If the desired readout sensing level is reached the cell is inhibited from further programming. Otherwise the cell is enabled for the next program cycle. A program cycle is used to change incrementally the charge stored in the cell and the corresponding cell sensing readout voltage. Instead of a verify program cycle a program verify cycle can be used. A program verify cycle begins with a program cycle followed by a verify cycle. In this case care should be taken to ensure that the first programming pulse does not cause over programming.

In an embodiment the program cycle includes applying a voltage on the source line interchangeably referred to as common line CL VCL with a predetermined program pulsewidth TPPWD and a predetermined program bias cell current Ipcell . The verify cycle makes use of the voltage mode sensing as shown in which applies a reference voltage VCLRD on the source line CL another reference voltage VCGRD on the control gate and a predetermined read bias current Ircell on the bitline and through the memory cell. The current Ircell is applied to the bitline and the memory cell through select transistors which are not shown. The resulting voltage on the bitline is the sensing readout voltage VR which has a unique relationship to the charge on the floating gate. The voltage mode sensing is also used during read. To change incrementally the readout sensing voltage to the next value VR dVR with dVR equals to the incremental readout sensing voltage change the next program cycle is repeated with the common line voltage increased incrementally to VCL dVCLP with dVCLP equals to the incremental programming voltage change.

The number of verify program cycles NC is dependent on the number of voltage levels and various margins of the memory system. For example for an equivalent 8 bit digital multilevel cell there are 2 2 256 levels with N 8. The minimum possible number of verify program cycles NC required would be 256. To cover variations due to cell to cell variation temperature process corners an algorithm may require for example approximately 1.4 256 360 verify program cycles. To cover various margins needed such as for data retention and programming distribution the number of verify program cycles required is actually higher. Assuming a factor of 2 due to various margin coverage the number of verify program cycles is approximately equal to 720. The exact number of verify program cycles is typically varied depending on various memory technologies and particular desired performance targets.

For write data rate of 1 mega byte per second and for 8 bit digital multilevel operation with 1024 bytes per page the write timing per page is TWRT of bytes written in parallel data rate 1024 bytes per page 1 mega bytes second 1024 s 1.024 ms per page.

Hence the time to execute each program verify cycle TPV must be less than TWRT NC 1.024 ms 720 1.42 s. This fast timing coupled with parallel operation of 1024 cells has important implication on memory cell program speed capacitance loading power consumption and other effects as will be described below.

Typical process parameters of a sub micron memory cell are as follows. A typical diffused source line resistance per cell is 100 ohms. A typical bitline resistance per cell is 80 milliohms. A typical silicided row line resistance per cell is 20 ohms. A typical source line capacitance per cell is 2 fF. A typical bitline capacitance per cell is 1.5 fF. And a typical row line capacitance per cell is 3 fF.

Hence for the 8192 16384 array the total bitline capacitance is CBL 16384 1.5 fF 25 pF where is defined as approximately equal to. The total metal bitline resistance RBL 16384 0.08 1330 ohms. The total diffused source line resistance is RSL 8192 100 819 K ohms. The total row line resistance is RWL 8192 20 164 K ohms. For a typical memory system the diffused source line is strapped by metal along the source line with approximately 80 milliohms per cell in this case RSL 8192 0.08 655 ohms.

In conventional stacked gate drain side CHE programming abbreviated as CHE flash program the single cell current is typically 1 ma which causes a voltage drop along a single metal bitline of 1 ma RBL 1 ma 1330 ohms 1330 millivolts which is unacceptable since it is much greater than 1 level 8 millivolts. In SSI flash programming abbreviated as SSI flash program the typical cell current can be lowered to 1 a which causes a voltage drop along a single metal bitline of 1 a 1330 ohms 1.33 millivolts which is acceptable.

For 1024 cells drawing the cell current Icell continuously the voltage drop DVCL along the source line from the driver to the other end follows the geometric equation DVCL 0.5 1 8cell cell 1 where R8cell the metal source line resistance for 8 cells in series 0.08 ohms 8 0.64 ohms and P 1024.

Along the source line for 1024 cells programming simultaneously the total current is 1024 1 ma 1.024 A for the CHE flash program and 1024 1 a 1.024 ma for the SSI flash program. The power needed for the drain side CHE flash programming for parallel page mode operation is unsustainable due to very high current. Additionally the voltage drop along the metal source line by equation 1 is 0.5 1024 1025 0.64 1 ma 336 Volts for CHE. This is unworkable for CHE flash technology. Similarly the source line voltage drop for the SSI flash 336 millivolts. This is also unworkable in the multilevel program for the following reasons.

For a multilevel nonvolatile system in one program cycle the cell sensing voltage can only shift dVR a maximum of 

For verifying after programming multilevel memory cells conventional methods would shut off the read cell currents for cells that have already reached their desired verifying levels this would cause the voltage shift dVCL in verify as much as in programming as described above. This voltage jump dVCL would couple to the memory cells and cause a large jump in cell sensing voltage. This undesired large jump in cell sensing voltage causes an error in sensing herein called a sense error VRerr. This sense error should be much less than Q V1level . Hence this large jump is unacceptable. The invention solves the problem by enabling the total current all the time whether the cells have been verified or not. This mitigates the change in the source line voltage. However a new problem surfaces as compared to that in programming. As temperature changes from 45 C to 85 C the resistance of the source line metal line changes by about 40 hence the source line voltage drop changes by about 40 which causes an additional sense error VRerr in read. This sense error should be much less than Q V1level to prevent overall read margin degradation. Therefore an array architecture is needed to achieve this as will be described in detail below.

With 1024 cells operating simultaneously assuming sense current Ircell 10 a the total sense current is 1024 10 a 10.24 ma flowing into the source line. This presents several problems. With power specification for a typical memory chip ICC 20 30 ma. This 10.24 ma is a big percentage of the power specification. To deliver 10.24 ma while maintaining a precise voltage level VCLRD VCLRD is defined as the voltage in read on CL line requires a challenging decoding and driver scheme which will be addressed in the description of the multilevel decoding scheme. Large current flowing across the source line also causes the voltage drop as described above.

High data rate meaning high sense speed and write speed is required for data intensive application. The speed is proportional to capacitance and voltage swing and inversely proportional to the current 2 .

For typical bitline capacitance as calculated above CBL 25 pF and assuming voltage swing V 1V and assuming available current I 10 a the time it takes to charge or discharge a bitline as needed in verify or program cycle is TBL 25 pF 1V 10 a 2.5 s. This is greater than the TPV 1.42 s as calculated above. At least a 2 or better timing is required for TBL to allow for various settling time sensing time and programming time. Increasing the current would cause higher power consumption large decoding driver and voltage problems as described above.

Further in programming 1024 cells in parallel the programming current is supplied from an on chip voltage multiplier also known as a charge pump. The on chip voltage multiplier multiplies the low voltage power supply e.g. 2.5 V to the required higher voltages. Allowing a reasonable area penalty from the on chip voltage multiplier a total current of 100 a is allowed for programming. The programming current per cell is 100 a 1024 0.1 a. This causes a TBL 25 pF 1V 0.1 a 250 s which is even more severe of a timing problem. Here an improvement of more than 2 order of magnitude or better in speed is needed. The invention describes array architectures with suitable operating methods to achieve this improvement and will be described below.

A block PSEL includes a plurality of circuit blocks PSELS S. shows details of a page select circuit PSELS S that selects a pair of bitlines at a time. Transistors A D are select transistors. Transistors E H are inhibit transistors. Lines PP0 K PP1 M PP2 and PP3 Q are complementary signals of lines PP0B L PP1B N PP2B P and PP3B R respectively. Line BLYDRV Y goes to one y driver YDRVS S inside the block YDRV . Block YDRVS S will be described in detail later in the description of the multilevel algorithm. Lines BLTP0 P BLTP1 P BLTP2 P and BLTP3 P couple to the bitlines in block and couple to a set of lines BLP0 BLP1 BLP2 and BLP3 of the circuit block in .

Multiple units of the basic array unit ARYSEG0 are tiled together to make up one sub array MFLSUBARY as shown in . And multiples of such MFLSUBARY are tiled horizontally to make up the final 8192 columns for a total of 32768 8192 268 435 460 physical memory cells or called 256 mega cells. The logical array size is 256 mega cells 4 bits per cell 1 giga bits if 4 bit digital multilevel memory cell is used or 256 mega cells 8 bits per cell 2 giga bits if 8 bit digital multilevel memory cell is used. The top bitlines BLP0 BLP1 BLP2 and BLP3 run from the top of the array to the bottom of the array. The segment bitlines SBL0 A SBL1 B SBL2 A SBL3 B SBL4 A SBL5 B SBL6 A and SBL7 B only run as long as the number of rows within a segment for example 128 rows. Hence the capacitance contributed from each segment bitline is very small e.g. 0.15 pF.

The layout arrangement of the top bitlines in relative position with each other and with respect to the segment bitlines SBL0 A SBL1 B SBL2 A SBL3 B SBL4 A SBL5 B SBL6 A SBL7 B are especially advantageous in reducing the bitline capacitance. The purpose is to make the top bitlines as truly floating as possible hence the name of truly floating bitline scheme.

In an embodiment as shown in lines and are in the middle sandwiched between lines A B A and B in the bottom and lines CL0 in the top. Furthermore line is on top of the spacing between lines A and B and line is on top of the spacing between lines A and B. This has the benefit of reducing significantly the bottom plane capacitance of line and line since the oxide below each line is almost doubled. The lines and could be positioned on top of lines A and A respectively when the sidewall capacitance reduction outweighs the benefit of the bottom plane capacitance reduction. The sidewall capacitance refers to the capacitance resulting from the vertical walls of a line the bottom plane capacitance refers to the capacitance from the bottom of a line and the top plane capacitance refers to the capacitance from the top of a line.

In another embodiment as shown in the top bitlines have been positioned all the way to the top metal of a multi layer metal integrated circuit system. For example for a 5 layer metal integrated circuit system the top bitlines are metal 5 layer. This avoids the top plane capacitance of the top bitlines . This also reduces the bottom plane capacitance of the top bitlines by a factor of as much as 4 if metal 5 is used. The reduction factor of 4 is due to the oxide below the line increasing by a factor of about as much as 4. Also since the top bitlines are spaced further apart as compared to the segment bitlines the sidewall capacitance is reduced significantly. The top bitlines are now almost floating on top of the array. The end effect is more than on order of magnitude reduction in bitline capacitance. Also since the top bitlines spacing are relaxed the width of the top metal lines can be made larger to reduce the metal bitline resistance.

The reduction in bitline capacitance results in a corresponding increase in speed. To help increase the speed in programming a bitline stabilization assisted operating method can be applied and is described as follows. At the beginning of the programming cycle a bitline stabilization control signal is used to set all the bitlines to a predetermined voltage VBLPRE e.g. 0.4 0.8 V. Then high voltage VCL is applied to selected memory common lines for programming. Now the bitlines only have to move partially to a final voltage. This speeds up the TBL timing.

There is an important transient effect related to bitline capacitance in programming. For high speed writing each program cycle takes time in the microsecond range. The program bias condition for a memory cell is control gate voltage VCGP 0.7 2.5 V bitline cell current Ipcell 50 500 nA and common line voltage VCL going from a low 0 V to a high programming voltage 8 13 V. As the VCL ramps from a low to a high voltage there is a transient current flowing through the memory cell to charge up the bitline node capacitance. This transient current flowing through the cell contributes to the cell programming in addition to the programming current Ipcell. Prior art CHE programming would not be bothered with this effect since the additional transient programming current is small compared to the actual programming current. However for a very fine programming voltage level control as required for high bits per cell this effect will cause the programming level to be uncontrollable making the multilevel memory system useless. The following example is given to appreciate the magnitude of this transient current. Assuming program VCL ramp time 1 s CBL 1 pF the voltage the bitline has to slew 1 V then by equation 2 I CV T 1 pF 1 V 1 s 1 A which can be 10 the programming current. Hence a method is needed to reduce the transient programming current.

Two approaches are shown in to reduce this transient phenomenon. In one embodiment 2 step ramp rate control approach greatly reduces this transient effect without prolonging the programming time as follows. First VCL ramps fast during TRP1 to an intermediate voltage VCLINT e.g. 2 6 V then VCL stays at an intermediate voltage for a finite time TVCLINT then VCL ramps slow during TRP2 to a final voltage VCLFIN. The first fast ramp with the flat intermediate time TVCLINT will let transient current flowing through the cell to stabilize most of the cell capacitances such as CBL in a short time and at sufficiently low VCL voltage so that insignificant programming takes place while the transient current is flowing. The TRP1 is made fast to consume little programming time. The second slow ramp then brings the cell to a final programming voltage without affecting the programming rate since very little current is flowing through the cell in the second ramp.

Another embodiment of the ramp rate control is a fast slow ramp rate control approach. VCL first ramps fast during TRP1 to an intermediate voltage VCLINT then VCL ramps slow during TRP2 to a final voltage VCLFIN. The first ramp TRP1 is faster than that of the TRP2 ramp to allow the transient current during the first ramp TRP1 to stabilize quickly all the cell capacitances while VCL is low enough to not cause significant programming.

The ramp rate can be generated by a RC network meaning the rate is controlled by a certain capacitance multiplied by a certain resistance or by a CV I network meaning the rate is controlled by a certain capacitance multiplied by a voltage swing divided by a certain bias current. Further the ramp rate can be programmable by programmable fuses as a function of bitline capacitance to optimize the programming time without introducing adverse transient current. That is the ramp rate is made to be faster for smaller bitline capacitance.

The common line CL0 is common to four rows of memory cells for the following reason. Allowing 4 mV voltage drop along the CL line during programming to avoid programming error as described previously with 1024 cells operating simultaneously with 0.1 a drawn per cell the voltage drop by equation 1 is dVCLP 4 mV 0.5 1024 1025 R8cell 0.1 a hence R8cell 76 milliohms. For a typical CL line with the line width half as wide as the memory cell the CL resistance per cell is 80 milliohms for 8 cells in series R8cell is 8 80 640 milliohms which is much greater than 76 milliohms. Hence by making CL line four memory cells wide R8cells is 80 milliohms. The reason the width of the line CL cannot be made arbitrarily large is due to the program disturb. As the high voltage is applied to CL line in programming all the cells connected to the CL line will see the VCL voltage whether they are selected for programming or not. The more cells connected to the same CL line the longer time for the disturb for the unselected cells.

Shown in are the metal strapping lines CLOSTRAP S and CL3STRAP S of the common lines that connect the diffusion common lines to the metal common lines. The metal strapping could be done every 8 16 or 32 memory cells depending on an allowable voltage drop along the common line diffusion inside the strapping. This voltage drop depends on the diffusion common line resistance for a given operating current.

An alternative method that mitigates the voltage drop problem along the common line in the program cycle is by the constant total current program scheme. Namely by keeping the same total current flowing all the time independent of whether the cells have been verified or not the common line voltage drop is kept constant during programming. This could be done for example by adding additional switching transistors in the array every 8 16 32 or 64 memory cells and switching into the CL line the current equivalent to the current from verified cells.

Table 1 shows the operating conditions for the memory array in read erase and program. The array operating conditions are shown for the cell of the block ARY1BLK A in of a selected page for read and program. The selected cell is one cell out of 1024 selected cells within a selected page. The other 1023 selected cells belong to the other 1023 ARYSEG0 connected horizontally. The array operating conditions are also shown for all cells connected to CL0 for erase.

As shown in Table 1 the operating conditions are such that all the unselected memory cells see no voltage other than 0 volts. This reduces significantly the power consumption. This is also particularly advantageous for improved speed in very high density memory chips since all the necessary driver circuits only see the loading from the selected memory cells. The loading from the whole array is tremendous due to large number of transistors in array e.g. 256 million transistors with its tremendous diffusion metal and poly interconnect parasitics. For example one bitline capacitance CBL is 25 pF with 8192 bitlines the total bitline capacitance is 8192 25 pF 204 nF. This would require a tremendous amount of power during signal switching for example to inhibit all the bitlines during programming. Also not shown in Table 1 the unselected control signals ENBLAs ENBLBs INHBLAs and INHBLBs for unselected array units ARYSEG0 only see 0 or VDD but not the multiplied high voltage. This again saves significant power and increases speed due to no loading from unselected control circuits.

Another factor that is reduced greatly is the excessive leakage current from the bitline to ground due to junction leakage bitline to bitline leakage band to band tunneling and cell subthreshold conduction. For example for a typical leakage of 10 pA per cell with 16 384 cells per bitline the total leakage is 164 nA which is greater than Ipcell 100 nA. This implies that the multilevel programming will be uncontrolled due to the uncontrollable excessive leakage current contributing to the controlled programming current Ipcell. With the inhibit and segmentation scheme the total leakage current is reduced to 128 10 pA 1.28 nA which is much less than Ipcell 100 nA.

Note that it is possible to do one top bitline per one segmented bitline in the ARYSEG0 . In this case the sidewall capacitance from one top bitline to adjacent top bitlines increases due to reduced spacing between the top bitline and the adjacent top bitlines.

Note that it is also possible to do one top bitline per more than two segmented bitlines in the ARYSEG0 . In this case more decoding transistors are needed in the array to select one segmented bitline out of more than two segmented bitlines which leads to more die size. However the sidewall capacitance from one top bitline to adjacent top bitlines decreases due to increased spacing between the top bitline and the adjacent top bitlines. This reduction of capacitance may not be significant if the spacing is already wide enough.

An alternative embodiment of reducing the bitline capacitance is by hierarchical interconnect segmentation that is an extension over the previous concept as follows. A first segment bitline running in first layer of metal couples to a plurality of memory cells. A second segment bitline running in second layer of metal is coupled to a plurality of first segment bitlines by bitline segment transistors through vias between metal 1 and metal 2. Third segment bitline running in third layer of metal is coupled to a plurality of second segment bitlines by other bitline segment transistors through vias between metal 1 and metal 2 and metal 3. This can continue to higher metal layers. This approach allows optimization of horizontal spacing vertical spacing interconnect width and interconnect length between different layers of interconnect metals for minimum capacitive coupling between metal interconnect lines. This results in further reduced bitline capacitance.

As discussed in the array architecture section the voltage drop along the common line would cause a programming error as well as sense error in read. Hence the drop is brought down to a manageable level. By partitioning a common line into small line sections with drivers on both sides of each of the line sections the voltage drop is reduced. However prior art partition would cause a tremendous area penalty due to the large amount of decoding lines and circuits. This invention provides an enhanced decoding circuit by routing the interconnect in the higher metal layers and by using circuit configurations suitable for multilevel decoding.

The block VCGCLPRED has been expanded to include sub blocks inside. Common line predecoder and driver XCLPREDRV provide predecoded common lines with precision voltages to regular memory common lines in block and . A common line predecoder and driver XCLSPREDRV provides predecoded common lines with precision voltages to spare memory common lines in block . The circuit block is functional equivalent to circuit . A control gate predecoder XCGPREDEC provides predecoded control gate lines to block . A spare control gate predecoder XCGSPREDEC provides predecoded control gate lines to block . A bitline predecoder BLXDEC provides predecoded bitlines to block MLMDEC . All other circuit blocks have been described in association with .

The circuit blocks RDSGPSDEC RDSGBLDEC RDSGINHDEC and RD1SUBBLK are used in the array as shown in for array selection and inhibit decoding.

Four common lines of memory cells are coupled together to one decoded common line CL as shown in the block ARYSEG0 in . Four blocks of the RD4CG1CL are used to provide array block selection as shown in the block ARYSEG0 in . One array block is defined as including 16 rows and 4 common lines of memory cells. One array block includes a plurality of blocks ARY1BLK A connected horizontally.

The lines VXRGND VXCLGND and VXCGGND could be individually controlled to be biased at different voltage levels during erase read and program to optimize circuit functionality for instance to increase the breakdown or to reduce the leakage of MOS decoding transistors.

Note that the same transistors are used for decoding in erase read and program operation. In conventional decoding read decoding is isolated from erase and program decoding since read decoding requires only low voltage and hence the decoding size can be optimized for read speed. Here all decoding is combined together to minimize the die size. Further all decoding is done by NMOS transistors instead of by both PMOS and NMOS transistors as conventionally done. This has the benefit of reducing the capacitive loading. This is so because in deselection one PMOS presents itself as a gate capacitor load while one NMOS only presents itself as a source or drain overlap capacitor load which is much smaller than a gate capacitor load. Low capacitive loading leads to less power consumption for NMOS decoding. This is against conventional wisdom which holds that a CMOS circuit is more power efficient than a NMOS circuit.

The block MLMDECS shown in and also in includes a plurality of the blocks RDSGCLPDEC B and a plurality of the blocks RD1CL C. Only one block RDSGCLPDEC B and one block RD1CL C per block are shown in for clarity. Other blocks have similar connections. The block MLMDEC shown in and also in includes a plurality of the blocks RD1SEG . The block RD includes a block RDSGPSDEC and a plurality of blocks RD1SUBBLK . Only the block RDSGPSDEC and one block RD1SUBBLK inside one block RDLSEG are shown in for clarity. Other blocks have similar connections.

The feedthrough to memory uses a single driver to drive both left and right sides of a memory array. The layout of row decoding circuits such as of the block RD1SUBBLK is very dense because of the limited height of a typical advanced memory cell e.g. 0.5 1 m per cell height and the very wide width of each decoding transistor e.g. 20 50 m due to their required precision multilevel drive ability. This makes it extremely difficult to route the required lines from the right side across the active circuit of this row decoding circuit to the left side with limited layers of metal interconnect. As shown in the control lines CG 0 15 A P and common lines CL 0 3 A D provides the control signals to the memory cells on the right side as well as the memory cells on the left side. This is also shown in in block B with lines pointing to the right as well as to the left. Similarly it also shows the control lines from circuit block A and C driving both sides. The feedthrough to memory scheme also shows predecoded high voltage lines ENHV4BLK and ENVSUP and predecoded low voltage lines ENB and ENB4 being fed through the memory by running on top of the memory for example in metal 4 without interfering with the memory cells underneath. Other control lines could also be fed through the memory. Again this is achievable by three or more metal layers which allow a different circuit configuration with minimal active area. The circuit block C is the precision voltage driver for the common lines CL of the memory cells in addition to the circuit block B. The feedthrough to driver scheme shows control signals from circuit blocks B and A being fed through the memory array to the precision voltage drivers C.

The common line segmentation is also shown in . Each metal common line runs the length of the memory core horizontally across the full array with seven circuit blocks RD1CL C and two circuit blocks RD1SUBBLK driving the same common line. The voltage drop across one common line is thus divided into eight voltage drop segments. Each voltage drop segment belongs to each common line of each sub array block MFLSUBARY . Within each voltage drop segment the voltage value on the left side is same as the voltage value on the right side of the voltage drop segment and the lowest voltage value is in the middle of the voltage drop segment. This is because there is a precision circuit driver RDLCL C or RD4CG1CL on each side of the voltage drop segment. One alternative embodiment of the common line segmentation scheme is to have these common lines physically divided into eight separate common lines. That is each sub array block MFLSUBARY shown in has its separate common line. However in this case the deselect transistor S in the block RD1CL C is no longer optional but necessary to deselect each separated common line.

The voltage level on the control gates is controlled by the voltage on the lines CGP 0 15 A P in circuit block . The voltage on lines CGP 0 15 A P are in turn controlled by a precise bandgap referred regulated voltage. Hence precision voltage level is provided at the memory control gates. The voltage level on the common lines is controlled by the voltage on the predecoded common lines CLP 0 3 A D in circuit block . The voltage on lines CLP 0 3 A D are in turn controlled by a precise bandgap referred regulated voltage for each common line driver. Hence precision voltage level is provided at the memory common lines. The programming and sensing current bias are also bandgap referred hence they are highly stable.

Note that in an alternative embodiment is to share one block RDSGPSDEC or A across the full array by doing feedthrough of the outputs of RDSGPSDEC or A across the full memory array. In this case the drive ability of the driver circuit inside block RDSGPSDEC or A should be adequately designed to drive the long interconnect lines.

Note that in an alternative embodiment is to have a separate block RD4CG1CL for driving the right side of an array and another separate block RD4CG1CL for driving the left side of an array. Another alternative embodiment is to share just one CL driver for both left and right sides but to have separate control gate CG drivers for the left side and the right side.

A buffer VRBUFFER and a comparator are inside a block REFYDRVS S. The buffer VRBUFFER is used to drive each reference level of VREF0 15 for all the y drivers. A buffer circuit without offset auto zero A is used to isolate the reference cell from all capacitance from auxiliary circuits. The offset auto zero cancels out the voltage offset of an analog buffer. The voltage offset of an analog buffer is typically uncontrollable and is caused by threshold voltage mismatch transistor transconductance mismatch and systematic offset. This voltage offset would cause an uncertainty in the reference voltage which would degrade the margin of one voltage level with respect to another voltage level. Line VBUFO is used to verify a reference cell is programmed to one desired reference level out of 16 possible reference levels. Line VBUFO is used instead of the direct memory cell output for verifying in the verify cycle. This is to include the buffer offset from buffer A in the verifying process. The comparator is used to do the actual comparison in verify. A buffer with offset auto zero B is used to drive a reference level. Various voltage levels needed for multilevel algorithm are also generated by the buffer B with switch capacitor technique. The auto zero is needed to zero out the offset of this buffer since a typical buffer offset is 10 20 mV. This voltage amount if not canceled out would degrade the margin of a reference level which effectively reduces the voltage margin for each level. Capacitors are needed to accomplish the auto zero and level shifting operation in the buffer B. However as described in the array architecture description any additional capacitance would adversely degrade the write and read speed. Hence buffer A is inserted between the reference cell and the buffer B so that the reference cell only sees one gate capacitance inside a typical buffer as a capacitor load.

Lines VREF0 15 are the final reference lines driving into all the y drivers as needed for verify program cycles and read cycles. Switch S D couples line VREFD to the input terminal of buffer B when one selected page programs for the first time. Switch S C couples line VBUFO to input terminal of buffer B when the same selected page programs for the second time or more without an erase in between program. The reason is that for first time programming reference levels for data cells come from a reference generator VREFGEN and for subsequent programming reference levels come from the reference cells in MFLASHREFS A.

For the memory system described herein there are 8 pages for each row 4 rows for each block and 512 bytes per page with a 4 bit digital multilevel memory cell. Since any one page is written or read at any time a complete reference set of 16 levels is reserved for each page instead of for each row. This is done to preserve the operating conditions through the lifetime of a memory system exactly the same for reference cells as regular data cells. This is done for example to make the reference and data cells have the same voltage readout drift over time. For each row there are 8 16 128 reference cells. This has some small die size penalty. The reference cells are written at the same time as the regular data cells.

After the reference cells are written with the first programming sequence if subsequent programming cycles are allowed to write other data cells in the same page the previously programmed reference cells stay in the program inhibit mode. This is accomplished as shown in . A comparator is used to compare a reference voltage from a bandgap VREF e.g. 1.2 V versus a readout voltage from a reference memory cell VREFOUT for example level 0 e.g. 0.5V. If the reference cell has not been written VREF VREFOUT then line REFON would be high indicating that the reference cells have been previously written and the reference cells are inhibited in programming.

For subsequent programming cycles after the first programming cycle the reference voltages for the data cells come from the reference cells and the reference voltages are shifted appropriately to place the data voltages in between the adjacent reference voltages.

The voltage drop along the common line poses a particular problem for a multilevel reference system. Reference cells are needed to track the data cells over temperature process or power supply. But as temperature changes the voltage drop along the common line changes which causes a sense error. The voltage drop along the line from one end to the other end follows geometrically as described earlier. That is depending on position along the common line the cells experience different amounts of common line voltage changes which cause different voltage readout shifts due to different voltage amounts being coupled into the cells. This cannot be corrected by a conventional reference system.

In each full array is divided into three sub arrays ARYVSUB1 3 A C and ARYVSUB4 6 D F respectively. It should be noted that the array could be divided into as many sub arrays as needed to reduce the voltage error. Also shown in each sub array of ARYVSUB1 6 A F includes its own complete set of reference cells in the middle. A complete set of reference cells provides all the reference levels e.g. 16 levels for 4 bit digital multilevel cell per page for all the pages. One row of reference cells includes 128 reference cells if each row has 8 pages and each reference cell provides one reference level. An alternative embodiment is to have more than one reference cell per level e.g. 4 16 cells per level. This averages out the electrical variation of multiple cells.

One alternative embodiment of the reference system is instead of using 16 reference cells for a 4 bit digital multilevel cell to use 2 or 4 or 8 reference cells to generate 16 reference levels with level interpolation. That is from reference levels coming from reference cells the other reference levels are interpolated by using linear or any other interpolation.

As shown in next for each level L upper program margin verify voltage UMV L VCELLR L VUM L is generated where VUM L is the upper margin voltage for level L. Depending on the data latch output B 0 3 of the data latches in the respective YDRVS S SYDRVS S RYDRVS S the appropriate voltage UMV L is compared with read back cell voltage VCELLD L for all the data cells. If the result of comparison indicates that all upper cell margins are not within limits then a program flag fail condition is set BUSY signal is reset and programming cycle is done. If the result of comparison indicates that all the upper cell margins are within limits then a program flag fail condition is not set and then for each level L lower program margin verify voltage LMV L VCELLR L 1 VLM L is generated where VLM L is the lower margin voltage for level L. Depending on the data latch output B 0 3 of the data latches in the respective YDRVS S SYDRVS S RYDRVS S the appropriate voltage LMV L is compared with read back cell voltage VCELLD L . If the result of comparison indicates that all lower cell margins are not within limits then a program flag fail condition is set BUSY signal is reset and programming cycle is done. If the result of comparison indicates that all the lower cell margins are within limits then a program flag fail condition is not set and BUSY signal is reset and programming cycle is done. The program flag fail indicates the programming cycle has been unsuccessful to program the current page. It does not indicate specifically which cell or cells caused the unsuccessful programming.

After the page program command and the address of the page to be program is issued the data to be programmed is loaded in the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 of each of the YDRVS S SYDRVS S or RYDRVS S. The REFERENCE MULTIPLEXER then couples one of the inputs VR0 through VR15 to its output VROUT . During a program verify cycle VREFD 0 through VREFD 15 are available on the VR0 through VR15 lines respectively. VR0 through VR15 are commonly coupled to REFERENCE MULTIPLEXER of all the YDRV SYDRV RYDRV . The REFYDRVS S have the data latches internally set. In this embodiment there are 16 REFYDRVS S. Each REFYDRVS S is used for a specific level. For example the data latches of a REFYDRVS S used for level 5 will be internally set to program level 5 into reference cells coupled to it. VR0 through VR15 are commonly coupled to REFERENCE MULTIPLEXER of all the REFYDRVS S. During a program verify cycle VREFR 0 through VREFR 15 are respectively available at the VR0 through VR15 lines of a REFYDRVS S. Depending on the output B3 B2 B1 B0 of the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 within each YDRVS S SYDRVS S SYDRVS S one specific voltage VREFD 0 through VREFD 15 is output to the input of the VOLTAGE COMPARATOR . Depending on the output B3 B2 B1 B0 of the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 within each REFYDRV one specific voltage VREFR 0 through VREFR 15 is output to the input of the VOLTAGE COMPARATOR .

The latch within each REFYDRVS S YDRVS S SYDRVS S and RYDRVS S are all reset by pulsing line RBYLATCOMP . RBYLATCOMP is commonly connected to the reset input of the latch within each REFYDRVS S YDRVS S SYDRVS S and RYDRVS S. After latch is reset COMLATQ is at logic low. The NAND then outputs logic high to line NDO . Output of INV then is at logic low on line INVO . With NDO at logic high and INVO at logic low transistors N3 and P couple BLIN to N4 . P1 de couples the inhibit voltage VIH from BLIN . The memory cell is placed in the voltage read mode and the cell read back voltage VCELLR L or VCELLD L is available on BLIN . At this point the VOLTAGE COMPARATOR compares the voltages at its inputs. If voltage on BLIN is higher then voltage on VROUT the output COMPOUT is low otherwise it is high. At this time a positive going strobe pulse is applied to the ENLATCOMP common to all the latches in REFYDRVS S YDRVS S SYDRVS S and RYDRVS S to latch the status of line COMPOUT . If COMPOUT is low then the COMLATQ remains at logic low.

If COMPOUT is high then the COMLATQ switches to logic high. If during an iteration of verify program cycles any one of the latches latches a logic high on COMLATQ called a program inhibit state then for that specific REFYDRVS S YDRVS S SYDRVS S or RYDRVS S the line NDO is at low and the line INVO is at logic high. With latch in a program inhibit state BLIN is de coupled from N4D and there is no current load whereas BLIN is coupled to the inhibit voltage VIH through P1 . With latch in the program inhibit state further programming pulses do not cause programming.

The line COMPOR is connected in a wire OR fashion to all the COMPOR lines of each REFYDRVS S YDRVS S SYDRVS S or RYDRVS S. There is a pull up load coupling the COMPOR line to the power supply. Similarly the line COMPORB is connected in a wire OR fashion to all the COMPORB lines of each REFYDRVS S DRVS S SYDRVS S or RYDRVS S. There is a pull up load coupling the COMPORB line to the power supply. The COMPORB line goes high whenever all the latches have reached the program inhibit mode. When the Program Pulse Count MAXPC is reached the ALGOCNTRL latches the status of COMPORB line in a status latch in block INPUT LOGIC . The status latch can be read at one of the IO 0 7 lines by the external host. If ALGOCNTRL latches a logic low in the status latch in block INPUT LOGIC then a program fail condition is reached and the ALGOCNTRL goes out of the page programming cycle.

If at the end of any verify program iteration the COMPOR line goes high the ALGOCNTRL sequences to the margin verify mode. All latches are reset. All cells are placed in the voltage read mode by READB at logic low. At this time inhibit voltage is de coupled from BLIN and current bias transistor N4 is coupled to BLIN . Cell voltages VCELLR L or VCELLD L are respectively available on BLIN of a REFYDRVS S or BLIN of YDRVS S SYDRVS S or RYDRVS S. During program margin verify the voltages read back from the data cells are checked for adequate margin from voltages read back from reference cells for each programmed level L. In the Upper Program Margin Verify mode voltages UMV 0 through UMV 15 are placed on the VR0 through VR 15 . Depending on the output B3 B2 B1 B0 of the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 within each YDRVS S SYDRVS S RYDRVS S one specific voltage UMV 0 through UMV 15 is output to the input VROUT of the VOLTAGE COMPARATOR . At this time the VOLTAGE COMPARATOR compares the voltages at its inputs. If voltage on BLIN is higher then voltage on VROUT the output COMPOUT is low otherwise it is high. At this time a positive going strobe pulse is applied to the ENLATCOMP common to all the latches in YDRVS S SYDRVS S and RYDRVS S to latch the status of line COMPOUT . If COMPOUT is low then the COMLATQ remains at logic low. If COMPOUT is high then the COMLATQ switches to logic high. At this time if LGOCNTRL latches a logic low in the status latch in INPUT LOGIC block by looking at the status of the COMPORB line then a program fail condition is reached and the ALGOCNTRL goes out of the page programming cycle. Otherwise ALGOCNTRL sequences to the Lower Program Margin Verify mode.

In the Lower Program Margin Verify mode all latches are reset. Voltages LMV 0 through LMV 15 are placed on the VR0 through VR 15 . Depending on the output B3 B2 B1 B0 of the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 within each YDRVS S SYDRVS S RYDRVS S one specific voltage LMV 0 through LMV 15 is output to the input VROUT of the VOLTAGE COMPARATOR . At this time the VOLTAGE COMPARATOR compares the voltages at its inputs. If voltage on BLIN is higher then voltage on VROUT the output COMPOUT is low otherwise is high. At this time a positive going strobe pulse is applied to the ENLATCOMP common to all the latches in YDRVS S SYDRVS S and RYDRVS S to latch the status on line COMPOUT . If COMPOUT is low then the COMLATQ remains at logic low. If COMPOUT is high then the COMLATQ switches to logic high. At this time if ALGOCNTRL latches a logic low in the status latch in INPUT LOGIC block by looking at the status of the COMPOR line then a program fail condition is reached and the ALGOCNTRL goes out of the page programming cycle.

During page read cycle after page read command and the page address is issued the reference and the data cells are placed in the voltage read mode. At this time all the B3 0 3 lines output . VR0 through VR15 have VCELLR 0 through VCELLR 15 . VCELLR 0 through VCELLR 15 are the voltages read out of the reference cells of the page being read. Under the control of the ALGOCNTRL block 4 bits are sequentially read into the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 . For example B3 is read by forcing the output of DATALAT3 to output B3 0. At this time B 0 3 . The REFERENCE MULTIPLEXER then outputs VCELLR 7 on the VROUT in each of the YDRVS S SYDRVS S and RYDRVS S. The output COMPOUT of the VOLTAGE COMPARATOR is high or low depending on whether voltage VCELLD L on the BLIN is lower or higher relative to voltage VCELLR 7 on line VROUT . If COMPOUT is high then a logic high is latched into DATALAT3 and B3 0 otherwise logic low is latched and B3 1. Next B2 is read by forcing the output of DATALAT2 to output B2 0. At this time B 0 3 110B3. B3 is the output of DATALAT3 from previous sequence. The REFERENCE MULTIPLEXER then outputs VCELLR L depending on 110B3 on the VROUT line in each of the YDRVS S SYDRVS S and RYDRVS S. The output COMPOUT of the VOLTAGE COMPARATOR is high or low depending on whether voltage VCELLD L on the BLIN is lower or higher relative to voltage VRCELL L on line VROUT . If COMPOUT is high then a logic high is latched into DATALAT2 and B2 0 otherwise logic low is latched and B2 1. In this manner the next two sequences latch two bits into the DATALAT1 and DATALAT0 .

After all 4 bit from the cell are latched into the DATALAT3 DATALAT2 DATALAT1 DATALAT0 for all the YDRVS S SYDRVS S and RYDRVS S the restore margins are checked. All latches are reset. First the RESTORE LOW margin is checked. At this time for each level 0 through 15 MARGIN RESTORE LOW Voltage VRSTRL 0 through VRSTRL 15 is placed at the VR0 through VR15 lines respectively. Depending on each outputs B3 B2 B1 B0 of the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 within each YDRVS S SYDRVS S and RYDRVS S the REFERENCE MULTIPLEXER outputs one of VRSTRL 0 through VRSTRL 15 on line VROUT going into the positive input of the VOLTAGE COMPARATOR . ENLATCOMP is strobed with the positive pulse to latch the status of the COMPOUT line. If data cell read out voltage VCELLD L on BLIN line is higher than voltage VRSTRL L on VROUT line then COMLATQ remains at logic low and COMLATQB at logic high. Otherwise COMLAT is at logic high and COMLATQB at logic low. At this time if ALGOCNTRL latches a logic low in the RESTORE LOW latch in INPUT LOGIC block by looking at the status of the COMPORB line then a restore low flag condition is reached. Next all latches are reset.

Next the RESTORE HIGH margin is checked. At this time for each level 0 through 15 MARGIN RESTORE HIGH Voltage VRSTRH 0 through VRSTRH 15 is placed at the VR0 through VR15 lines respectively. Depending on each outputs B3 B2 B1 B0 of the data latches DATALAT3 DATALAT2 DATALAT1 DATALAT0 within each YDRVS S SYDRVS S and RYDRVS S the REFERENCE MULTIPLEXER outputs one of VRSTRH 0 through VRSTRH 15 on line VROUT going into the positive input of the VOLTAGE COMPARATOR . ENLATCOMP is strobed with the positive pulse to latch the status of the COMPOUT line. If data cell read out voltage VCELLD L on BLIN line is higher than voltage VRSTRH L on VROUT line then COMLATQ remains at logic low and COMLATQB at logic high. Otherwise COMLAT is at logic high and COMLATQB at logic low. At this time if ALGOCNTRL latches a logic low in the RESTORE HIGH latch in INPUT LOGIC block by looking at the status of the COMPOR line then a restore high flag condition is reached.

At this time 4 bits from every cell with the page being read are latched into the respective data latches within each YDRVS S SYDRVS S and RYDRVS S. Next under the control of the READ CLOCK data is sequentially read on IO 0 7 . If after READ CL0CK the RED ADD TRUE Y condition is true then the data is read from the addressed RYDRVS S otherwise data is read from the addressed YDRVS S or SYDRVS S.

The embodiment shown in can be used in combination with the embodiment shown in . As discussed in the multilevel reference system section above the embodiment shown in can be used when a selected page programs for the first time after block erase. For subsequent page programming cycles on the same page the embodiment shown in is advantageous since the VCELLR L values may shift between initial page programming and subsequent page programming.

The memory cell comprises a plurality of memory arrays arranged in rows and columns of memory arrays . Each memory array comprises a plurality of memory subarrays a plurality of local sense amplifiers and a plurality of global sense amplifiers . In one embodiment a local sense amplifier is disposed adjacent to a memory subarray . In another embodiment the local sense amplifier is shared between a plurality of memory subarrays . The local sense amplifier reads the contents of the memory cells with the corresponding memory subarray . The memory subarrays are arranged in rows and columns. The local sense amplifiers coupled to a column of memory subarrays are coupled to a global sense amplifier . The memory cells may include redundant cells reference cells or spare cells.

The inverter mode sensing circuit comprises a PMOS transistor a plurality of NMOS transistors and a feedback circuit a plurality of memory cells and a comparator . For clarity only one memory cell and one NMOS transistor are shown for a subarray but the subarray comprises a plurality of memory cells arranged in columns. Each column has a corresponding NMOS transistor or a plurality of NMOS transistors arranged in series. Only one column with one memory cell is shown.

The comparator determines the voltage of the memory cell by comparing the cell voltage VCELL to a reference voltage VREF in a manner described above. The PMOS transistor the NMOS transistors and and the memory cells are coupled in series between the supply voltage and ground. The selected memory cell is read by applying a control gate reference voltage VCGRD on the control gate of the memory cell . The column of memory cells and an associated bit line has a capacitance that slows the sensing of the memory cells . The NMOS transistor functions as a switch to couple the column of memory cells to the sensing portion of the circuit. The feedback circuit controls biasing of the NMOS transistor to stabilize the cell voltage . The drain of the diode connected PMOS transistor is coupled to the cell voltage . Inverter mode sensing may also be referred to as current mode sensing or common source sensing.

The voltage sensing circuit is similar to the inverter mode sensing circuit except that a current source replaces the PMOS transistor and is coupled to ground the memory cell is coupled to a reference bias and the NMOS transistor and the feedback circuit are omitted. The voltage mode sensing may also be referred to as source follower sensing.

The memory array includes a plurality of voltage mode sensing circuits . The voltage mode sensing circuit comprises a PMOS transistor a plurality of NMOS transistors a feedback circuit a plurality of memory cells a current source IRCELL and a comparator . For clarity only one memory cell one NMOS transistor and one NMOS transistor are shown for a subarray but the subarray comprises a plurality of memory cells arranged in columns. Each column has a corresponding NMOS transistor . Only one column with one memory cell is shown. Possible decoding circuitry between the current source and the memory cell and between the current source and the NMOS transistor is not shown.

The comparator determines the voltage of the memory cell by comparing a cell voltage VCELL to a reference voltage VREF in a manner described above. The PMOS transistor the NMOS transistors and are coupled in series between the supply voltage and ground. The current source is coupled between the gate of the NMOS transistor and ground. The memory cell is coupled between a reference voltage VCLRD and the common node formed of the current source and the gate of the NMOS transistor .

The selected memory cell is read by applying a control gate reference voltage VCGRD on the control gate of the memory cell . The biasing of the gate of the NMOS transistor by the current source and the memory cell controls the voltage on the bit line.

The NMOS transistor functions as a switch to couple the column of NMOS transistors and the associated memory cells to the sensing portion of the circuit. The feedback circuit controls biasing of the NMOS transistor to stabilize the cell voltage . The drain of the diode connected PMOS transistor is coupled to the cell voltage .

The voltage mode sensing circuit comprises a plurality of memory subarrays a plurality of local sense amplifiers and a plurality of global sense amplifiers . The local sense amplifier includes a local source follower stage. The global sense amplifier includes a common source stage.

Each local sense amplifier is coupled to a memory subarray . In one embodiment the local sense amplifier is disposed adjacent the memory subarray . The local sense amplifier includes a selection circuit that couples a selected bitline to a bitline . In one embodiment the selection circuit comprises transistors. The local sense amplifier senses the selected memory cell on the bitline and provides a voltage to a global sense amplifier .

The local sense amplifier comprises an NMOS transistor coupled between the bitline and ground and includes a gate coupled to the bitline . A current source is coupled between the gate of the NMOS transistor and ground.

The global sense amplifier comprises a comparator a PMOS transistor and a selection circuit . The selection circuit couples the selected one of the bitlines to a common node formed of a voltage cell input of the comparator and the drain of the diode connected PMOS transistor . A reference voltage is applied to the second input of the comparator .

The local sense amplifier provides a larger voltage range by using optimally low current bias. The global sense amplifier includes a common source stage with a PMOS transistor as a load and buffers the column capacitance.

The voltage mode sensing circuit further comprises a plurality of reference subarrays a plurality of local sense amplifiers and a plurality of global sense amplifiers . The reference subarrays comprise a plurality of reference cells for storing reference signals. In one embodiment the reference subarrays are similar to the memory subarrays . The local sense amplifiers read the reference subarrays . In one embodiment the local sense amplifiers are similar to the local sense amplifiers . The global sense amplifiers detect and amplify the voltage from the local sense amplifiers .

The global sense amplifier comprises a comparator a PMOS transistor and a selection circuit which are arranged in similar manner as the comparator the PMOS transistor and the selection circuit of the global sense amplifier except the comparator is configured as a buffer. The comparator serves as a comparator in sensing the reference cells and serves as a buffer for driving the reference level.

The voltage mode sensing circuit includes like elements as the voltage mode sensing circuit and are given like reference numbers. The voltage mode sensing circuit comprises a memory array a plurality of local sense amplifiers and a plurality of global sense amplifiers . The local sense amplifier includes a local source follower stage and includes a PMOS source follower as part of the global sense amplifier. The global sense amplifier includes a source follower stage.

Each local sense amplifier is coupled to a memory subarray . In one embodiment the local sense amplifier is disposed adjacent the memory subarray . The local sense amplifier includes a selection circuit that couples a selected bitline to a bitline . In one embodiment the selection circuit comprises transistors. The local sense amplifier senses the selected memory cell on the bitline and provides a voltage to a global sense amplifier .

The local sense amplifier comprises a PMOS transistor coupled between the bitline and ground and includes a gate coupled to the bitline . A current source is coupled between the gate of the PMOS transistor and ground. The local sense amplifier provides a maximum voltage range by using low current bias.

The global sense amplifier comprises a comparator a current source and a selection circuit . The current source couples the supply voltage to the cell voltage terminal of the comparator to ground. The selection circuit couples the selected one of the bitlines to a common node formed of a voltage cell input of the comparator and the current source . A reference voltage is applied to the second input of the comparator .

The voltage mode sensing circuit further comprises a plurality of reference subarrays a plurality of local sense amplifiers and a plurality of global sense amplifiers . The reference subarrays comprise a plurality of reference cells for storing reference signals. In one embodiment the reference subarrays are similar to the memory subarrays . The local sense amplifiers read the reference subarrays . In one embodiment the local sense amplifiers are similar to the local sense amplifiers . The global sense amplifiers detect and amplify the voltage from the local sense amplifiers .

The global sense amplifier comprises a comparator a current source and a selection circuit which are arranged in similar manner as the comparator the current source and the selection circuit of the global sense amplifier except the comparator is configured as a buffer. The comparator serves as a comparator in sensing the reference cells and serves as a buffer for driving the reference level.

The voltage mode sensing circuit includes like elements as the voltage mode sensing circuit and are given like reference numbers. The voltage mode sensing circuit comprises a memory array a plurality of local sense amplifiers and a plurality of global sense amplifiers . The local sense amplifier includes a local source follower stage and includes an NMOS source follower as part of the global sense amplifier. The global sense amplifier includes a source follower stage.

Each local sense amplifier is coupled to a memory subarray . In one embodiment the local sense amplifier is disposed adjacent the memory subarray . The local sense amplifier includes a selection circuit that couples a selected bitline to a bitline . In one embodiment the selection circuit comprises transistor. The local sense amplifier senses the selected memory cell on the bitline and provides a voltage to a global sense amplifier .

The local sense amplifier comprises an NMOS transistor coupled between the bitline and a supply voltage terminal and includes a gate coupled to the bitline . A current source is coupled between the gate of the NMOS transistor and ground. The local sense amplifier provides a maximum voltage range by using low current bias.

The global sense amplifier comprises a comparator a current source and a selection circuit . The current source couples the voltage terminal of the comparator to a ground terminal. The selection circuit couples the selected one of the bitlines to a common node formed of a voltage cell input of the comparator and the current source . A reference voltage is applied to the second input of the comparator . The global sense amplifier is selectively coupled to the bitline to compare the cell voltage to a reference voltage . The global sense amplifier buffers the column capacitance.

The voltage mode sensing circuit further comprises a plurality of reference subarrays a plurality of local sense amplifiers and a plurality of global sense amplifiers . The reference subarrays comprise a plurality of reference cells for storing reference signals. In one embodiment the reference subarrays are similar to the memory subarrays . The local sense amplifiers read the reference subarrays . In one embodiment the local sense amplifiers are similar to the local sense amplifiers . The global sense amplifiers detect and amplify the voltage from the local sense amplifiers .

The global sense amplifier comprises a comparator a current source and a selection circuit which are arranged in similar manner as the comparator the current source and the selection circuit of the global sense amplifier except the comparator is configured as a buffer. The comparator serves as a comparator in sensing the reference cells and serves as a buffer for driving the reference level.

In another embodiment the local sense amplifier is a common source amplifier and the global sense amplifiers are NMOS source follower stages or PMOS source follower stages.

In another embodiment the local sense amplifier is a common source amplifier and the global sense amplifiers are common source amplifiers.

The sense amplifier comprises an operational amplifier a pair of capacitors and and a plurality of switches and .

In response to an auto zero AZ command the switches selectively couples an output of the operational amplifier to the input to equalize the voltages on the output and input and selectively couples an output of the operational amplifier to the input to equalize the output and the input . In the auto zero mode the voltage on A terminals of the capacitors and are set equal to the reference voltage VREF and the B terminals of the capacitors and are equalized to the complementary outputs of the operational amplifier . The switch is switched by an evaluation EVA command to connect the cell voltage VCELL to the other end of the capacitor for comparison from the operational amplifier .

The switch selectively applies the reference voltage VREF to the capacitor in response to the evaluation EVA command . The switch also selectively applies either the reference voltage VREF or a cell voltage VCELL to the capacitor in response to the evaluation EVA command . The evaluation command equalizes the signals on terminals A and A of the capacitors and .

In an alternate embodiment the nodes B and B of the capacitors and are reset to a fixed bias voltage. In another embodiment the nodes B and B of the capacitors and are shorted together.

By using a capacitor for sensing the input common load range to the operational amplifier or comparator is substantially constant and independent of the memory cell voltage or current.

The autozero sense amplifier comprises a plurality of PMOS transistors and a plurality of NZ NMOS transistors and a plurality of NMOS transistors through a plurality of capacitors and and a plurality of transfer gates through .

The PMOS transistors and and the NMOS transistors and and the NZ NMOS transistor are arranged as a differential pair. The NMOS transistors and provide the differential input pair. The NZ NMOS transistor and the NMOS transistor provide bias for the NMOS transistor and . The PMOS transistors and are coupled for cross coupled loading. The PMOS transistor is coupled between the supply voltage and an output terminal . A bias voltage is applied to the gates of the NZ NMOS transistors and and the NMOS transistors and .

The NMOS transistors and provide an NMOS coupled internal latch which is active while the differential input pair is on. The drain of the NMOS transistor is coupled to the drain of the NMOS transistor and the gate of the NMOS transistor . The drain of the NMOS transistor is coupled to a common node formed of the drain of the NMOS transistor and gate of the NMOS transistor . The NZ NMOS transistor and the NMOS transistor provide bias for the NMOS transistors and and are coupled between the common node formed of the sources of the NMOS transistors and and ground.

The transfer gate couples the drains of the PMOS transistors and and the output to each other for equalization and quick recovery for the next comparison in response to a release signal and an inverted release signal .

The capacitor couples the gate of the NMOS transistor to first terminals of the transfer gates and which include a second terminal coupled to a reference voltage . The capacitor couples the gate of the NMOS transistor into first terminals of the transfer gates and which have second terminals coupled to the reference voltage and a cell voltage respectively. The transfer gates and are controlled by a auto zero signal and an inverted auto zero signal . The transfer gates and are controlled by evaluation signals and .

The transfer gates and couple the drains of the PMOS transistors and respectively to the gates of the NMOS transistors and respectively in response to the auto zero signal and inverted auto zero signal . The NMOS transistors and couple the gates of the NMOS transistors and respectively to ground in response to a strobe signal to pull down the transistors and to turn off the differential pair. The NMOS transistor couples the sources of the NMOS transistors and to the ground in response to the strobe signal for full level latching.

A pipelined read operation may be as follows. A first row is selected in a selected subarray such as subarray or subarray and the content of selected memory cells are coupled to the local bitline and to the global bitlines while a second row in another subarray or is selected and the content of the selected memory cells are coupled to the local bitlines but not yet coupled to the global bitlines. After the read operation completes processing the data of the first row the data of the second row is enabled to couple to the global bitlines to continue the read operation and a third row in a different subarray or is selected to enable the content of the selected memory cells to couple to the local bitlines but not yet to the global bitlines. This cycle continues until all desired data are read out. This for example enables continuous read of multilevel memory cells.

In another embodiment pipelined read operation is performed by operating on memory cells in a row in an array such as memory array while another row in another memory array is selected to enable the contents of the memory cells to be ready.

A read while read operation may be as follows. A read operation operates on both arrays such as memory array or memory subarrays or simultaneously and the data are available from both arrays possibly at the same time. In this case for example data latches are used to latch the data from both arrays. In another embodiment two sets of data lines may be used to transfer the data from both arrays to an on chip controller.

A read write while write read operation may be as follows. Similarly while one operation e.g. read is executed on an array such as subarray or array or subarrays another operation is executed e.g. write on another array such as subarray or or subarray . This is possible because control circuits associated with decoding and sensing and or writing may be embedded for each array.

A read erase while erase read may be as follows. Similarly while one operation e.g. read is executed on an array such as subarray or or subarray another operation is executed e.g. erase on another array such as subarray or or subarray . This is possible because each array may have its own decoders and embedded control circuits associated with sensing.

An erase while erase operation may be as follows. Similarly while one erase operation is executed on an array such as subarray or or subarray another erase operation is executed on another array such as subarray or or subarray . This is possible because each array may have its own decoders.

A write erase while erase write operation may be as follows. Similarly while one operation e.g. write is executed on an array such as subarray or array or subarrays another operation is executed e.g. erase on another array such as subarray or or subarray . This is possible because each array may have its own decoders and embedded control circuits associated with sensing and or writing.

A write while write operation may be as follows. Similarly while one write operation is executed on an array such as subarray or or subarray another write operation is executed on another array such as subarray or or subarray . This is possible because each array may have its own decoders and embedded control circuits associated with sensing and or writing.

In the foregoing description of various method and apparatus it was referring to various specific embodiments. However it should be obvious to the one conversant in the art various alternatives modifications and changes may be possible without departing from the spirit and the scope of the invention which is defined by the metes and bounds of the appended claims.

