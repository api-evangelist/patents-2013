---

title: Certificate management and transfer system and method
abstract: A method and system for Certificate management and transfer between messaging clients are disclosed. When communications are established between a first messaging client and a second messaging client, one or more Certificates stored on the first messaging client may be selected and transferred to the second messaging client. Messaging clients may thereby share Certificates. Certificate management functions such as Certificate deletions, Certificate updates and Certificate status checks may also be provided.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=RE045087&OS=RE045087&RS=RE045087
owner: BlackBerry Limited
number: RE045087
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20130812
---
This application is a reissue application of U.S. Pat. No. 8 015 400 which issued Sep. 6 2011 from U.S. patent application Ser. No. 12 480 841 filed Jun. 9 2009 which is a continuation of U.S. patent application Ser. No. 10 480 615 filed on Dec. 11 2003 now U.S. Pat. No. 7 546 453 and entitled Certificate Management and Transfer System and Method. The complete disclosure of this application including drawings is hereby incorporated into this application now issued as U.S. Pat. No. 7 546 453 on Jun. 9 2009 which is the National Stage of International Application No. PCT CA02 00868 filed Jun. 12 2002 which claims the benefit of U.S. provisional application Ser. No. 60 297 681 filed Jun. 12 2001 and of U.S. provisional application Ser. No. 60 365 533 filed Mar. 20 2002. The entire contents of U.S. patent application Ser. No. 12 480 841 U.S. patent application Ser. No. 10 480 615 U.S. provisional application Ser. No. 60 297 681 and U.S. provisional application Ser. No. 60 365 533 are incorporated herein by reference.

This invention relates generally to the field of secure electronic messaging and in particular to management and transfer of Certificates between secure messaging clients.

Most known secure messaging clients including for example e mail software applications operating on desktop computer systems maintain a data store or at least a dedicated data storage area for secure messaging information such as Certificates Certs . A Cert normally includes the public key of an entity as well as identity information that is bound to the public key with one or more digital signatures. In Secure Multipurpose Internet Mail Extension S MIME messaging for example a public key is used to verify a digital signature on a received secure message and to encrypt a session key that was used to encrypt a message to be sent. In other secure messaging schemes public keys may be used to encrypt data or messages. If a public key is not available at the messaging client when required for encryption or digital signature verification then the Cert must be loaded onto the messaging client before these operations can be performed. Normally each messaging client establishes communications with a Cert source to obtain any required Certs and manages its own Certs and private keys independently of other messaging clients. However when a user has more than one messaging client operating on a desktop or laptop personal computer PC and a wireless mobile communication device for example then Certs must typically be loaded onto each messaging client from the Cert source.

Therefore there remains a need for a messaging client with a Cert management and transfer mechanism that simplifies Cert management and loading.

A method of Cert management and transfer between a first messaging client and a second messaging client is provided. The method may include the steps of establishing communications between the first messaging client and the second messaging client selecting one or more Certs stored on the first messaging client for transfer to the second messaging client and transferring the selected Certs from the first messaging client to the second messaging client.

A system for Cert management and transfer between a first messaging client and a second messaging client is also provided. The system may comprise at the first messaging client a first memory comprising a first Cert store configured to store Certs a first Cert synchronization sync system configured to access the first Cert store and a first communications interface. At the second messaging client the system may include a second memory comprising a second Cert store configured to store Certs a second Cert sync system configured to access the second Cert store and a second communications interface compatible with the first communications interface. The first Cert sync system is may also be configured to transfer Certs stored in the first Cert store from the first messaging client to the second messaging client when a communications link is established between the first messaging client and the second messaging client via the first communications interface and the second communications interface.

A further system for transferring Certs between a computer system and a wireless mobile communication device is also provided. The system may include a serial port associated with the computer system a mobile device cradle connected to the serial port the mobile device cradle having an interface and a mobile device interface associated with the wireless mobile communication device and compatible with the interface of the mobile device cradle. Certs stored at the computer system may be transferred to the wireless mobile communication device when a communications link is established between the computer system and the wireless mobile communication device by placing the wireless mobile communication device in the mobile device cradle.

A wireless mobile communication device is also provided and may comprise a wireless transceiver a messaging system coupled to the wireless transceiver a communications interface a Cert store configured to store Certs and a Cert sync system coupled to the Cert store and the communications interface. The messaging system may be configured to store Certs received via the wireless transceiver to the Cert store and the Cert sync system is configured to store Certs received via the communications interface to the Cert store.

A secure message is a message that has been processed by a message sender or possibly an intermediate system between a message sender and a message receiver to ensure one or more of data confidentiality data integrity and user authentication. Common techniques for secure messaging include signing a message with a digital signature and or encrypting a message. For example a secure message may be a message that has been signed encrypted encrypted and then signed or signed and then encrypted by a message sender according to variants of Secure Multipurpose Internet Mail Extensions S MIME .

A messaging client allows a system on which it operates to receive and possibly also send messages. Messaging clients may operate on a computer system a handheld device or any other system or device with communications capabilities. Many messaging clients also have additional non messaging functions.

The computer system may be a desktop or laptop PC which is configured to communicate to the WAN the Internet for example. PCs such as computer system normally access the Internet through an Internet Service Provider ISP Application Service Provider ASP or the like.

The corporate LAN is an example of a network based messaging client. It is normally located behind a security firewall . Within the corporate LAN a message server operating on a computer behind the firewall acts as the primary interface for the corporation to exchange messages both within the LAN and with other external messaging clients via the WAN . Two known message servers include for example Microsoft Exchange Server and Lotus Domino . These servers are often used in conjunction with Internet mail routers that typically use UNIX based Sendmail protocols to route and deliver mail. The message server may also provide additional functionality such as dynamic database storage for data like calendars todo lists task lists e mail and documentation.

The message server provides messaging capabilities to networked computer systems coupled to the LAN . A typical LAN includes multiple computer systems each of which implements a messaging client such as Microsoft Outlook Lotus Notes etc. Within the LAN messages are received by the message server distributed to the appropriate mailboxes for user accounts addressed in the received message and are then accessed by a user through a messaging client operating on a computer system .

The wireless gateway provides an interface to a wireless network through which messages may be exchanged with a mobile device . The mobile device may for example be a data communication device a voice communication device a dual mode communication device such as most modem cellular telephones having both data and voice communications functionality a personal digital assistant PDA enabled for wireless communications or a laptop or desktop computer system with a wireless modem.

Such functions as addressing of the mobile device encoding or otherwise transforming messages for wireless transmission and any other required interface functions may be performed by the wireless gateway . The wireless gateway may be configured to operate with more than one wireless network in which case the wireless gateway may also determine a most likely network for locating a given mobile device user and possibly track users as they roam between countries or networks.

Any computer system with access to the WAN may exchange messages with the mobile device through the wireless network gateway . Alternatively private wireless network gateways such as wireless Virtual Private Network VPN routers could also be implemented to provide a private interface to a wireless network. For example a wireless VPN implemented in the LAN may provide a private interface from the LAN to one or more wireless mobile communication devices through the wireless network . Such a private interface to wireless mobile communication devices via the wireless network gateway and or the wireless network may also effectively be extended to entities outside the LAN by providing a message forwarding or redirection system that operates with the message server . Such a message redirection system is disclosed in U.S. Pat. No. 6 219 694 which is hereby incorporated into this application by reference. In this type of system incoming messages received by the message server and addressed to a user of a mobile device are sent through the wireless network interface either a wireless VPN router wireless gateway or other interface for example to the wireless network and to the user s mobile device . Another alternate interface to a user s mailbox on a message server may be a Wireless Application Protocol WAP gateway. Through a WAP gateway a list of messages in a user s mailbox on the message server and possibly each message or a portion of each message may be sent to the mobile device . Several example communication systems are described in further detail below.

A wireless network normally delivers messages to and from mobile devices via RF transmissions between base stations and mobile devices . The wireless network may for example be 1 a data centric wireless network 2 a voice centric wireless network or 3 a dual mode network that can support both voice and data communications over the same infrastructure. Recently developed networks include 1 the Code Division Multiple Access CDMA network 2 the Groupe Special Mobile or the Global System for Mobile Communications GSM and the General Packet Radio Service GPRS both developed by the standards committee of CEPT and 3 third generation 3G networks like Enhanced Data rates for Global Evolution EDGE and Universal Mobile Telecommunications Systems UMTS which are currently under development.

GPRS is a data overlay on top of the existing GSM wireless network which is used operating in virtually every country in Europe. Some older examples of data centric network include but are not limited to 1 the Mobitex Radio Network Mobitex and 2 the DataTAC Radio Network DataTAC . Examples of known voice centric data networks include Personal Communication Systems PCS networks like CDMA GSM and Time Division Multiple Access TDMA systems that have been available in North America and world wide for several years.

The mobile device may be a data communication device a voice communication device or a multiple mode device capable of voice data and other types of communications. An exemplary mobile device is described in further detail below.

Perhaps the most common type of messaging currently in use is e mail. In a standard e mail system an e mail message is sent by an e mail sender possibly through a message server and or a service provider system and typically routed through the Internet to one or more message receivers. E mail messages are normally sent in the clear and use traditional Simple Mail Transfer Protocol SMTP RFC822 headers and MIME body parts to define the format of the e mail message.

In recent years secure messaging techniques have evolved to protect both the content and integrity of messages such as e mail messages. S MIME and Pretty Good Privacy PGP are two public key secure e mail messaging protocols that provide for both encryption to protect data content and signing which both protects the integrity of a message and provides for sender authentication by a message receiver. Secure messages may also be encoded compressed or otherwise processed in addition to being encrypted and or signed.

The e mail sender may be a PC such as the system in or it may be a network connected computer such as computer system . The e mail sender may also be a mobile device on which e mail messages may be composed and sent. The WAN wireless gateway wireless network and mobile device are substantially the same as similarly labelled components in .

According to secure messaging schemes such as S MIME and PGP a message is encrypted using a one time session key chosen by the e mail sender . The session key is used to encrypt the message body and is then itself encrypted using the public key of each addressed message receiver to which the message is to be sent. As shown at a message encrypted in this way includes an encrypted message body and an encrypted session key . In this type of message encryption scheme a message sender such as e mail sender must have access to the public key of each entity to which an encrypted message is to be sent.

A secure e mail message sender typically signs a message by taking a digest of the message and signing the digest using the sender s private key. A digest may for example be generated by performing a check sum Cyclic Redundancy Check CRC or some other preferably non reversible operation such as a hash on the message. This digest is then signed by the sender using the sender s private key. The private key may be used to perform an encryption or other transformation operation on the digest to generate the digest signature. A digital signature including the digest and the digest signature is then appended to the outgoing message. In addition a Cert of the sender which includes the sender s public key and sender identity information that is bound to the public key with one or more digital signatures and possibly any chained Certs and Certificate Revocation Lists CRLs associated with the sender s Cert and any chained Certs may also be attached to a secure message.

The secure e mail message sent by the e mail sender may include the digital signature as well as the encrypted message body and the encrypted session key both of which are signed. The sender s Cert any chained Certs and one or more CRLs may also be included in the message . In the S MIME secure messaging technique Certs CRLs and digital signatures are normally placed at the beginning of a message and the message body is included in a file attachment.

Messages generated by other secure messaging schemes may place message components in a different order than shown or include additional and or different components. For example a secure message may include addressing information such as To and From email addresses and other header information.

When the secure e mail message is sent from the e mail sender it is routed through the WAN to the computer system which in most cases will be either a PC associated with an e mail address for user A or a network connected computer workstation which accesses a mailbox on a messaging server. The computer system repackages the secure message into an electronic envelope and forwards the repackaged message to the wireless gateway . The repackaged message is then sent through the wireless network to the mobile device . At the mobile device the electronic envelope is then removed from the repackaged message to recover the original secure message which may then be processed on the mobile device . This message repackaging may involve such operations as compression encryption and encoding and will typically be performed by a software module or application operating at the computer system . Where the computer system accesses received e mail on a messaging server however the repackaging operations may be performed at the messaging server or possibly another system operating in conjunction with the messaging server. At the mobile device inverse operations are similarly performed by an unpackaging system or software module.

Although the computer system is shown as receiving the secure message repackaging the message and then sending the repackaged message to the mobile device in the illustrative example system of other implementations are also possible. For example the mobile device may be addressable directly in which case the message is routed to the wireless gateway instead of to the computer system . The wireless gateway then performs any required address translation encoding or similar functions if any and sends the message through the wireless network to the mobile device .

In addition the message may be routed or forwarded to the mobile device through other transport mechanisms than the wireless gateway . For example routing to the wireless network may be accomplished using a wireless VPN router associated with the e mail sender or in the case of a message being received at a computer system and then forwarded to the mobile device with the computer system .

Each receiver of a signed message both the computer system and mobile device in may verify the digital signature by generating a digest of the message body and encrypted session key extracting the digest from the digital signature comparing the generated digest with the digest extracted from the digital signature and verifying the digest signature in the digital signature . The digest algorithm used by a secure message receiver is the same as the algorithm used by the message sender and may be specified for example in a message header or possibly in the digital signature . One commonly used digest algorithm is the so called Secure Hashing Algorithm 1 SHA1 although other digest algorithms such as Message Digest Algorithm 5 MD5 may also be used.

In order to verify the digest signature a message receiver must retrieve the sender s public key and verify the signature on the digest in the digital signature by performing a reverse transformation on the digest signature. For example if the message sender generated the digest signature by encrypting the digest using its private key then a receiver would use the sender s public key to decrypt the digest signature to recover the original digest. If a secure message includes the sender s Cert then the sender s public key may be extracted from the Cert. The sender s public key may instead be retrieved from a local store for example where the public key was extracted from an earlier message from the sender and stored in a key store in the receiver s local store. Alternatively the public key may be retrieved from the sender s Cert if it is stored in the local store or from a Public Key Server PKS . A PKS is a server that is normally associated with a Certificate Authority CA from which a Cert for an entity including the entity s public key is available. A PKS might reside within a corporate LAN such as or anywhere on the WAN Internet or other network or system through which message receivers may establish communications with the PKS. A sender s Cert may be loaded onto a mobile device from an associated computer system as described in further detail below.

A digest algorithm is preferably a non reversible function that produces a unique output for every unique input. Therefore if an original message is changed or corrupted then the digest generated by the receiver will be different from the digest extracted from the digital signature and signature verification therefore fails. Because digest algorithms are publicly known however it is possible that an entity may alter a secure message generate a new digest of the altered message and forward the altered message to any addressed message receivers. In this case the digest generated at the receiver on the basis of the altered message will match the new digest that was added by the entity that altered the message. The digest signature check is intended to prevent verification of a digital signature in such a situation. Even though the generated and new digests will match since a sender signs the original digest using its own private key the entity that altered the message cannot generate a new digest signature that can be verified with the sender s private key. Therefore although the digests in the altered message match the digital signature will not be verified since the digest signature verification will fail.

These mathematical operations do not prevent anyone from seeing the contents of the secure message but do ensure the message has not been tampered with since it was signed by the sender and that the message was signed by the person as indicated on the From field of the message.

When the digital signature has been verified or sometimes even if digital signature verification fails the encrypted message body must then be decrypted before it can be displayed or further processed by a receiving messaging client the computer system and the mobile device in . A message receiver uses its private key to decrypt the encrypted session key and then uses the decrypted session key to decrypt the encrypted message body and thereby recover the original message.

An encrypted message that is addressed to more than one receiver would include an encrypted version of the session key for each receiver that was encrypted using the public key of the receiver. Each receiver would perform the same digital signature verification operations but would decrypt a different one of the encrypted session keys using its own private key.

Therefore in a secure messaging system a sending messaging client must have access the public key of any receiver to which an encrypted message is to be sent. A receiving messaging client must be able to retrieve the sender s public key which may be available to a messaging client through various mechanisms in order to verify a digital signature in a signed message. Although the mobile device is a receiver of the secure message the mobile device may be enabled for two way communications and may therefore require public keys for both message sending and message receiving operations.

Public keys are commonly provided in Certs. As described above a Cert for any particular entity typically includes the entity s public key and identification information that is bound to the public key with a digital signature. Several types of Cert currently in widespread use including for example X.509 Certs which are typically used in S MIME. PGP uses Certs with a slightly different format. Systems and methods according to aspects of the present invention may be used with any of these types of Cert as well as other types of Cert both currently known types as well as others that may be developed. The digital signature in a Cert is generated by the issuer of the Cert and can be checked by a message receiver substantially as described above. A Cert sometimes includes an expiry time or validity period from which a messaging client may determine if the Cert has expired. Verification of the validity of a Cert may also involve tracing a certification path through a Cert chain which includes a user s Cert as well as possibly other Certs to verify that the user s Cert is authentic. A Cert may also be checked against a CRL to ensure that the Cert has not been revoked.

If the digital signature in a Cert for a particular entity is valid the Cert has not expired or been revoked and the issuer of either the Cert or a chained Cert is trusted then the public key in the Cert is assumed to be the public key of the entity for which the Cert was issued also referred to as the subject of the Cert.

Certs may be available to a messaging client from several sources. When a Cert is attached to a received message the Cert can be extracted from the message and stored by the messaging client. Otherwise Certs can be requested and downloaded from a PKS on a LAN the Internet or other network with which a requestor may establish communications. Alternatively according to an aspect of the present invention a messaging client may load Certs from other sources than a PKS. Many modem mobile devices are configured for connection to a PC. By connecting such a devices to a PC to download Certs via a physical connection such as a serial port or USB port over the air transfer of Certs may be reduced. If such a physical connection is used to load Certs for entities to which a user expects to send encrypted messages then these Certs need not be downloaded when encrypted messages are to be sent to any of these entities. A user may similarly load Certs for any entities from which signed messages are expected to be received such that digital signatures may be verified even if one of these entities does not append its Cert to a signed message.

In known systems any Cert must be requested from a Cert source and stored on each messaging client. Certs are not normally shared between messaging clients even when the messaging clients are associated with the same user. In the system of for example if user A requires a Cert for another entity user B on both the computer system and the mobile device then user B s Cert must be requested and loaded twice once for the computer system and again for the mobile device . Using a Cert management and transfer system however user B s Cert need be requested and loaded on only one of the computer system and the mobile device .

As shown in a mobile device incorporating a Cert management and transfer system comprises a memory a messaging system a Cert synchronization sync system a user interface UI a wireless transceiver and an interface or connector . The memory preferably includes a storage area for a Cert store as well as possibly other data stores such as an address book in which messaging contact information is stored and an application data storage area which stores data associated with software applications on the mobile device . Data stores and are illustrative examples of stores that may be implemented in a memory on mobile device . The memory may also be used by other device systems in addition to those shown in to store other types of data.

The memory is a writeable store such as a RAM into which other device components may write data. The Cert store is a storage area dedicated to storage of Certs on the mobile device . Certs may be stored in the Cert store in the format in which they are received or may alternatively be parsed or otherwise translated into a storage format before being written to the store .

The messaging system is connected to the wireless transceiver and is thus enabled for communications via a wireless network. The Cert sync system is connected to the interface connector to allow communication with the computer system through the cooperating interface connector and connections and .

The UI may include such UI components as a keyboard or keypad a display or other components which may accept inputs from or provide outputs to a user of the mobile device . Although shown as a single block in it should be apparent that a mobile device typically includes more than one UI and the UI is therefore intended to represent one or more user interfaces.

The computer system includes a physical connection through which Certs may be transferred to the mobile device via the interface or connector . Although shown in as an external component the interface connector may alternatively be internal to the computer system . Like the mobile device the computer system includes a Cert sync system which in most implementations will be a software application. The Cert sync system interfaces with a UI which may include one or more input and output components the connection and the Cert store . The Cert store could possibly be any computer storage medium including for example a local hard disk drive or other memory unit. Certs which are public information could also be shared between computer systems within a network for example such that the store is external but accessible to the computer system for example on a network file server. The messaging system is connected to both the Cert store and the communications subsystem .

A messaging client implementing a Cert management and transfer system may still preferably retrieve Certs in a conventional manner. This is represented in by the connections between the messaging systems Cert stores and a communication system either the wireless transceiver or communications subsystem . Therefore when the messaging system on the mobile device requires a public key for a sender of a received message or an addressee of a message to be sent a Cert may be requested and received from a PKS for example through the wireless transceiver . When a Cert is appended to a received message the messaging system may extract the Cert from the message and store the Cert to the Cert store . The computer system may perform similar operations to obtain any required Certs.

A user of a Cert storage and transfer system as shown in can also preferably select and transfer Certs to a mobile device from the computer system or from the mobile device to the computer system via a communication link established between the interfaces or connectors and . The interfaces or connectors and could be any of a plurality of compatible data transfer components including for example optical data transfer interfaces such as Infrared Data Association IrDA ports other short range wireless communications interfaces or wired interfaces such serial or Universal Serial Bus USB and connections. Known short range wireless communications interfaces include for example Bluetooth modules and 802.11 modules according to the Bluetooth or 802.11 specifications respectively. It will be apparent to those skilled in the art that Bluetooth and 802.11 denote sets of specifications available from the Institute of Electrical and Electronics Engineers IEEE relating to wireless LANs and wireless personal area networks respectively.

Since communications between the computer system and the mobile device need not necessarily be via a physical connection references to connecting a mobile device to an associated computer includes establishing communications between a computer system and a mobile device through either physical connections or wireless transfer schemes. Thus the mobile device could be connected to the computer system by placing the mobile device in a mobile device cradle connected to a serial port on the computer system by positioning the mobile device such that an optical port thereof is in a line of sight of a similar port of the computer system or by physically connecting or arranging the mobile device and computer system in some other manner so that data may be exchanged. The particular operations involved in establishing communications between a mobile device and a computer system will be dependent upon the types of Interfaces and or connectors.

Referring again to when the mobile device is connected to the computer system the Cert sync system is preferably automatically started. Other operations may also be automatically executed when the mobile device is connected to the computer system preferably in accordance with user specified settings established at the computer system the mobile device or both.

The Cert sync system may access the Cert store to determine which Certs are stored therein. The Cert sync system then preferably generates a list of stored Certs on a UI preferably a display screen on the computer system . Certs could be listed for example in the order in which they are stored in the Cert store in order of frequency of use in alphabetical order of the name of the entity for which the Cert was issued i.e. the subject name or any other default or user configured order. In this list Certs are preferably identified by subject name or if contact information for the subject of a Cert is stored in an address book or similar contact information store on the computer system a Cert could alternatively be identified using a portion of the contact information such as a familiar name for example.

A user may then choose which of the Certs stored on the computer system should be transferred to the mobile device using a mouse keyboard or other input device that may be implemented as a UI associated with the computer system . The selected Certs are then transferred to the mobile device via the connections and interfaces . A Cert transfer operation may for example be an add operation to add selected Certs to the Cert store on the mobile device an update operation for example to replace an expired Cert in the Cert store on the mobile device with a selected Cert or to replace a less frequently used Cert with one that is or is expected to be more frequently used or a replace all operation in which all Certs in the Cert store on the mobile device are deleted and the selected Certs are stored to the Cert store . Other types of Cert transfers are also possible and may be selectable or configurable using the Cert sync system the Cert sync system or both.

On the mobile device Certs are received by the Cert sync system and processed according to the type of transfer operation selected by the user to store transferred Certs to the Cert store . Transferred Certs may be added to the store in addition to add operation or instead of update operation Certs already stored in the Cert store or after the Certs in the Cert store have been deleted replace all operation . When Certs are transferred to a mobile device in this manner a message sender or an intermediate system through which messages are sent to the mobile device need not send Certs along with secure messages to the mobile device . An intermediate system if present may also strip Certs and possibly other relatively bulky information from a received secure message before it is sent to the mobile device if the Certs have already been transferred to the mobile device .

Since memory on a mobile device tends to be limited data stores such as the Cert store may have sufficient space to store only a certain number of Certs. When the Cert store is full no new Certs can be transferred from the computer system to the Cert store unless one or more existing Certs in the Cert store are overwritten or deleted. Cert store overflow could be handled by either the mobile device Cert sync system the computer system Cert sync system or both. For example the Cert sync system in the mobile device may be configured to implement a least recently used LRU replacement policy in the Cert store whereby a least recently used Cert will automatically be overwritten if a new Cert is to be loaded into the mobile device when the Cert store is full. Alternatively the Cert sync system may be configured to alert the Cert sync system if the Cert store is or becomes full while the mobile device and computer system are connected. An alert could also or instead be returned to the Cert sync system when a user attempts to add a Cert to a full Cert store . In this case the user could then be prompted via a UI to choose whether or not a Cert in the Cert store should be replaced with the Cert to be added and if so possibly to select a Cert that should be replaced. Such a scheme may also allow a user to abort an add operation when a Cert store is full.

The Cert sync system on the computer system may also check each Cert in the Cert store to ensure that only valid Certs are transferred to the mobile device . This may involve checking one or more CRLs an expiry time or validity period and possibly submitting a status inquiry to an external system not shown for each Cert. Any Certs that have expired or are no longer valid may be deleted from the Cert store and are preferably not included in the Cert list generated by the Cert sync system . Detection of an expired or invalid Cert in the Cert store may also trigger either a request for a new Cert for the entity identified in the subject name or like field of the expired or invalid Cert or a user prompt to select a further action such as request a new Cert or simply delete the expired or invalid Cert without requesting a new one.

If the messaging system or another component in the computer system periodically checks the status of all stored Certs then a status check by the Cert sync system might not be necessary every time that the mobile device is connected to the computer system . In either case a user can be assured that Certs transferred from the computer system to the mobile device are valid at the time of transfer. However due primarily to the size of CRLs processing loads associated with Cert status checking and network latency when Cert status information must be requested from an external source Cert status checking on a mobile device tends to be problematic and therefore is not commonly performed. Although valid at the time of transfer Certs in the Cert store that expire are revoked or become invalid after the time of transfer might not always be detected on a mobile device .

Cert management systems and methods may alleviate this problem of expired revoked or invalid Certs in the Cert store of the mobile device . The Cert sync systems and can exchange Cert information between the mobile device and computer system . The Cert sync system similar to the Cert sync system as described above is preferably configured to access the Cert store to generate at least a list of Certs stored in the Cert store when the mobile device is connected to the computer system . Depending upon the information required by the Cert sync system to check the status of a Cert a copy of the Certs in the Cert store not just a list of Certs may be passed to the Cert sync system . The list or complete Certs may be passed to the Cert sync system either automatically or in response to a request to the Cert sync system from the Cert sync system . Using information in the list or Certs as well as any CRLs expiry times or validity periods and any information from external sources if required the Cert sync system checks the status of each Cert.

If a Cert on the mobile device is expired revoked or invalid the Cert sync system preferably retrieves a new Cert to replace the expired Cert from either its own Cert store or an external Cert source. Alternatively a user may be prompted via a UI or to select whether the Cert should tie deleted from the Cert store or a new Cert should be retrieved. The Cert sync system then either deletes or replaces the expired revoked or invalid Cert with a new Cert from the computer system .

Either the mobile device or the computer system preferably maintains a record of at least the most recent Cert check for Certs on the mobile device such that the frequency of Cert checking for Certs stored on the mobile device is controllable. When the mobile device is connected to the computer system this Cert check record is accessed to determine if the Certs stored in the Cert store should be checked.

Coordinated operation of the Cert sync systems and also provides for further Cert management functions. Since the Cert sync system has access to both its own Cert store and through the Cert sync system the mobile device Cert store separate lists of Certs stored at the computer system and the mobile device may be generated and displayed to a user. The user can then easily determine which Certs have already been loaded onto the mobile device . Alternatively Certs that are stored in the mobile device Cert store may be removed from the list of Certs that are stored in the Cert store such that only those Certs available in the Cert store that are not stored in the mobile device Cert store are displayed for selection and transfer to the mobile device .

If a list of Certs stored in the mobile device Cert store is displayed to a user on the computer system the user is better able to manage the Certs in the mobile device store . For example a user may select a Cert from the device list for deletion and can also determine how many Certs are stored on the mobile device and possibly how much space is remaining in the Cert store .

Certs may also be transferred from the mobile device to the computer system . As described above both the computer system and the mobile device may retrieve Certs from a variety of sources. When the computer system and the mobile device are separately addressable for example they may receive secure messages from different senders and thus require different Certs to process the messages. Different Certs may also be required to send secure messages to different recipients. If a required Cert was not transferred from the computer system to the Cert store then the mobile device may retrieve the Cert from another source via a wireless network for example. In this case the mobile device Cert store contains a Cert that might not be available in the Cert store of the computer system . Such a Cert may be transferred from the mobile device to the computer system substantially as described above.

Similarly where the mobile device UI includes a display screen and one or more input devices such as a keyboard thumbwheel and the like Cert management and transfer operations could be controlled by the Cert sync system .

When Cert management operations are complete both the mobile device and the computer system preferably revert to a normal operating mode. If the Cert sync systems and are embodied as software applications the applications may be closed or may instead end automatically after selected Certs have been transferred. The Cert sync systems may also be configured to start only when one or each of the sync systems is invoked by a user instead of automatically when the mobile device is connected to the computer system .

The method begins at step when a mobile device is connected to a computer system. Step involves establishing communications between the mobile device and the computer system for example via a physical link such as a serial or USB connection or a wireless link such as an optical Bluetooth 802.11 or other short range communication link. At step the computer system may check the status of any Certs stored in a Cert store on the mobile device and possibly retrieve a new Cert for each expired revoked or invalid Cert in the mobile device Cert store as described above. Step may be automatic or may alternatively be dependent upon a user response to a prompt or alert generated when one or more of the Certs stored on the mobile device are found to be expired revoked or invalid.

If none of the Certs on the mobile device are expired revoked or invalid when new Certs have been or will not be retrieved for any such Certs or if no status check is performed for Certs stored on the mobile device then a list of Certs stored in a Cert store on the computer system is generated and displayed to the user at step . As described above a list of the Certs stored at each messaging client may be displayed to a user. The user may then select one or more stored Certs from either of the lists at step and the selected Certs are transferred from one messaging client to the other messaging client at step . Steps and may be repeated for each selected Cert. Alternatively a user may select a plurality of Certs at step and transfer each Cert at step without requiring further action on the part of the user. The Cert transfer at step may be from the computer system to the mobile device or from the mobile device to the computer system. Cert selection and transfer steps and may be repeated as often as necessary to perform desired Cert transfer operations. Cert store overflow handling may be configurable for example according to an LRU replacement policy or in response to a further user selection to replace a stored Cert or abort the Cert transfer operation.

Since a computer system normally has faster and more powerful processing resources and access to a much higher speed communication link to a PKS or other Cert source than a mobile device Cert loading from a remote source to a computer system is a relatively fast and simple process. Therefore most Cert transfers at step will likely be from the computer system to the mobile device be to the mobile device. However Cert transfers between computer systems is also possible when Certs are to be managed and or shared between computer systems. Sharing of Certs between computer systems within a corporate LAN for example would minimize communications with external PKSs or other Cert sources for any Certs that have been retrieved from the external sources by a computer system within the LAN.

Cert transfers at step may add selected Certs to a Cert store on a messaging client or replace any or all of the Certs in the Cert store on the messaging client as described above. Although not explicitly shown in other Cert management operations than Cert transfers may also be performed after lists of stored Certs are generated and displayed at step . For example Certs may be selected for deletion or other operations than transfer to another messaging client.

The mobile device includes a transceiver a microprocessor a display Flash memory RAM auxiliary input output I O devices a serial port a keyboard a speaker a microphone a short range wireless communications sub system and may also include other device sub systems . The transceiver preferably includes transmit and receive antennas a receiver Rx a transmitter Tx one or more local oscillators LOs and a digital signal processor DSP . Within the Flash memory the mobile device preferably includes a plurality of software modules A N that can be executed by the microprocessor and or the DSP including a voice communication module A a data communication module B and a plurality of other operational modules N for carrying out a plurality of other functions.

The mobile device is preferably a two way communication device having voice and data communication capabilities. Thus for example the mobile device may communicate over a voice network such as any of the analog or digital cellular networks and may also communicate over a data network. The voice and data networks are depicted by the communication tower . These voice and data networks may be separate communication networks using separate infrastructure such as base stations network controllers etc. or they may be integrated into a single wireless network. References to the network should therefore be interpreted as encompassing both a single voice and data network and separate networks.

The communication subsystem is used to communicate with the network . The DSP is used to send and receive communication signals to and from the transmitter and receiver and may also exchange control information with the transmitter and receiver . If the voice and data communications occur at a single frequency or closely spaced set of frequencies then a single LO may be used in conjunction with the transmitter and receiver . Alternatively if different frequencies are utilized for voice communications versus data communications then a plurality of LOs can be used to generate a plurality of frequencies corresponding to the network . Although two antennas are depicted in the mobile device could be used with a single antenna structure. Information which includes both voice and data information is communicated to and from the communication module via a link between the DSP and the microprocessor .

The detailed design of the communication subsystem such as frequency band component selection power level etc. will be dependent upon the communication network in which the mobile device is intended to operate. For example a mobile device intended to operate in a North American market may include a communication subsystem designed to operate with the Mobitex or DataTAC mobile data communication networks and also designed to operated with any of a variety of voice communication networks such as AMPS TDMA CDMA PCS etc. whereas a mobile device intended for use in Europe may be configured to operate with the GPRS data communication network and the GSM voice communication network. Other types of data and voice networks both separate and integrated may also be utilized with the mobile device .

Depending upon the type of network the access requirements for the mobile device may also vary. For example in the Mobitex and DataTAC data networks mobile devices are registered on the network using a unique identification number associated with each device. In GPRS data networks however network access is associated with a subscriber or user of the mobile device . A GPRS device typically requires a subscriber identity module SIM which is required in order to operate the mobile device on a GPRS network. Local or non network communication functions if any may be operable without the SIM but the mobile device will be unable to carry out any functions involving communications over the network other than any legally required operations such as 911 emergency calling.

After any required network registration or activation procedures have been completed the mobile device may send and receive communication signals preferably including both voice and data signals over the network . Signals received by the antenna from the communication network are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and may also provide analog to digital conversion. Analog to digital conversion of the received signal allows more complex communication functions such as digital demodulation and decoding to be performed using the DSP . In a similar manner signals to be transmitted to the network are processed including modulation and encoding for example by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network via the antenna . Although a single transceiver is shown in for both voice and data communications it is possible that the mobile device may include two distinct transceivers a first transceiver for transmitting and receiving voice signals and a second transceiver for transmitting and receiving data signals.

In addition to processing the communication signals the DSP may also provide for receiver and transmitter control. For example the gain levels applied to communication signals in the receiver and transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP . Other transceiver control algorithms could also be implemented in the DSP in order to provide more sophisticated control of the transceiver .

The microprocessor preferably manages and controls the overall operation of the mobile device . Many types of microprocessors or microcontrollers could be used here or alternatively a single DSP could be used to carry out the functions of the microprocessor . Low level communication functions including at least data and voice communications are performed through the DSP in the transceiver . Other high level communication applications such as a voice communication application A and a data communication application B may be stored in the Flash memory for execution by the microprocessor . For example the voice communication module A may provide a high level user interface operable to transmit and receive voice calls between the mobile device and a plurality of other voice devices via the network . Similarly the data communication module B may provide a high level user interface operable for sending and receiving data such as e mail messages files organizer information short text messages etc. between the mobile device and a plurality of other data devices via the network . On the mobile device a secure messaging software application incorporating software modules corresponding to the messaging system and Cert sync system in for example may operate in conjunction with the data communication module B in order to implement the techniques described above.

The microprocessor also interacts with other device subsystems such as the display Flash memory random access memory RAM auxiliary input output I O subsystems serial port keyboard speaker microphone a short range communications subsystem and any other device subsystems generally designated as . For example the modules A N are executed by the microprocessor and may provide a high level interface between a user of the mobile device and the mobile device. This interface typically includes a graphical component provided through the display and an input output component provided through the auxiliary I O keyboard speaker or microphone . Such interfaces are designated generally as UI in .

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as keyboard and display may be used for both communication related functions such as entering a text message for transmission over a data communication network and device resident functions such as a calculator or task list or other PDA type functions.

Operating system software used by the microprocessor is preferably stored in a persistent store such as Flash memory . In addition to the operating system and communication modules A N the Flash memory may also include a file system for storing data. A storage area is also preferably provided in the Flash memory to store Certs address book entries and possibly other information required for messaging shown as data stores and in . The operating system specific device applications or modules or parts thereof may be temporarily loaded into a volatile store such as RAM for faster operation. Moreover received communication signals may also be temporarily stored to RAM before permanently writing them to a file system located in the persistent store .

An exemplary application module N that may be loaded onto the mobile device is a personal information manager PIM application providing PDA functionality such as calendar events appointments and task items. This module N may also interact with the voice communication module A for managing phone calls voice mails etc. and may also interact with the data communication module B for managing e mail communications and other data transmissions. Alternatively all of the functionality of the voice communication module A and the data communication module B may be integrated into the PIM module.

The Flash memory preferably provides a file system to facilitate storage of PIM data items on the device. The PIM application preferably includes the ability to send and receive data items either by itself or in conjunction with the voice and data communication modules A B via the wireless network . The PIM data items are preferably seamlessly integrated synchronized and updated via the wireless network with a corresponding set of data items stored or associated with a host computer system thereby creating a mirrored system for data items associated with a particular user.

The mobile device may also be manually synchronized with a host system by placing the mobile device in an interface cradle which couples the serial port of the mobile device to the serial port of the host system. The serial port may also be used to enable a user to set preferences through an external device or software application to download other application modules N for installation and to manage Certs on a device as described above. This wired download path may further be used to load an encryption key onto the device which is a more secure method than exchanging encryption information via the wireless network .

Additional application modules N may be loaded onto the mobile device through the network through an auxiliary I O subsystem through the serial port through the short range communications subsystem or through any other suitable subsystem and installed by a user in the Flash memory or RAM . Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

When the mobile device is operating in a data communication mode a received signal such as a text message or a web page download will be processed by the transceiver and provided to the microprocessor which will preferably further process the received signal for output to the display or alternatively to an auxiliary I O device . A Cert received by the transceiver in response to a request to a PKS or attached to a secure message for example will be processed as described above to add the Cert to a Cert store in the Flash memory if it has not already been stored and to extract and store contact information in a new address book entry in the Flash memory if necessary. A user of mobile device may also compose data items such as email messages using the keyboard which is preferably a complete alphanumeric keyboard laid out in the QWERTY style although other styles of complete alphanumeric keyboards such as the known DVORAK style may also be used. User input to the mobile device is further enhanced with a plurality of auxiliary I O devices which may include a thumbwheel input device a touchpad a variety of switches a rocker input switch etc. The composed data items input by the user may then be transmitted over the communication network via the transceiver .

When the mobile device is operating in a voice communication mode the overall operation of the mobile device is substantially similar to the data mode except that received signals are preferably output to the speaker and voice signals for transmission are generated by a microphone . In addition the secure messaging techniques described above might not necessarily be applied to voice communications. Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile device . Although voice or audio signal output is preferably accomplished primarily through the speaker the display may also be used to provide an indication of the identity of a calling party the duration of a voice call or other voice call related information. For example the microprocessor in conjunction with the voice communication module A and the operating system software may detect the caller identification information of an incoming voice call and display it on the display .

A short range communications subsystem may also be included in the mobile device . For example the subsystem may include an infrared device and associated circuits and components or a Bluetooth or 802.11 short range wireless communication module to provide for communication with similarly enabled systems and devices. Thus Cert management and transfer operations as described above may be enabled on the mobile device via the serial port or other short range communications subsystem . More than one such interface may be used depending upon the type of messaging client with which mobile device Cert management and or transfer operations will be performed. For mobile device to computer system operations the serial port may be used whereas for mobile device to mobile device operations another short range communications subsystem could be used.

Although an example secure message transfer has been described above in the context of a communication system as shown in Cert management and transfer may also be useful in other types of communication systems.

The computer system like computer system in may for example be a laptop desktop or palmtop computer system configured for connection to the WAN . Such a computer system may connect to the WAN via an ISP or ASP. Alternatively the computer system may be a network connected computer system that accesses the WAN through a LAN or other network. Many modem mobile devices are enabled for connection to a WAN through various infrastructure and gateway arrangements so that the computer system may also be a mobile device.

The corporate LAN is an illustrative example of a central server based messaging system that has been enabled for wireless communications. The corporate LAN may be referred to as a host system in that it hosts both a data store with mailboxes for messages as well as possibly further data stores not shown for other data items that may be sent to or received from mobile devices and and the wireless connector system the wireless VPN router or possibly other components enabling communications between the corporate LAN and one or more mobile devices and . In more general terms a host system may be one or more computers at with or in association with which a wireless connector system is operating. The corporate LAN is one preferred embodiment of a host system in which the host system is a server computer running within a corporate network environment operating behind and protected by at least one security communications firewall . Other possible central host systems include ISP ASP and other service provider or mail systems. Although the desktop computer system and interface connector may be located outside such host systems wireless communication operations may be similar to those described below.

The corporate LAN implements the wireless connector system as an associated wireless communications enabling component which will normally be a software program a software application or a software component built to work with at least one or more message server. The wireless connector system is used to send user selected information to and to receive information from one or more mobile devices and via one or more wireless networks and . The wireless connector system may be a separate component of a messaging system as shown in or may instead be partially or entirely incorporated into other communication system components. For example the message server may incorporate a software program application or component implementing the wireless connector system portions thereof or some or all of its functionality.

The message server running on a computer behind the firewall acts as the main interface for the corporation to exchange messages including for example e mail calendaring data voice mail electronic documents and other personal information management PIM data with the WAN which will typically be the Internet. A message server is often used in conjunction with Internet mail routers to route and deliver messages. The particular intermediate operations and computers will be dependent upon the specific type of message delivery mechanisms and networks via which messages are exchanged and therefore have not been shown in . The functionality of the message server may extend beyond message sending and receiving providing such features as dynamic database storage for data like calendars todo lists task lists e mail and documentation as described above.

Message servers such as normally maintain a plurality of mailboxes in one or more data stores such as for each user having an account on the server. The data store includes mailboxes for a number of n user accounts. Messages received by the message server that Identify a user a user account a mailbox or possibly another address associated with a user account or mailbox as a message recipient will typically be stored in the corresponding mailbox . If a message is addressed to multiple recipients or a distribution list then copies of the same message may be stored to more than one mailbox . Alternatively the message server may store a single copy of such a message in a data store accessible to all of the users having an account on the message server and store a pointer or other identifier in each recipient s mailbox . In typical messaging systems each user may then access his or her mailbox and its contents using a messaging client such as Microsoft Outlook or Lotus Notes which normally operates on a PC such as the desktop computer system connected in the LAN . Although only one desktop computer system is shown in those skilled in the art will appreciate that a LAN will typically contain many desktop notebook and laptop computer systems. Each messaging client normally accesses a mailbox through the message server although in some systems a messaging client may enable direct access to the data store and a mailbox stored thereon by the desktop computer system . Messages may also be downloaded from the data store to a local data store not shown on the desktop computer system .

Within the corporate LAN the wireless connector system operates in conjunction with the message server . The wireless connector system may reside on the same computer system as the message server or may instead be implemented on a different computer system. Software implementing the wireless connector system may also be partially or entirely integrated with the message server . The wireless connector system and the message server are preferably designed to cooperate and interact to allow the pushing of information to mobile devices . In such an installation the wireless connector system is preferably configured to send information that is stored in one or more data stores associated with the corporate LAN to one or more mobile devices through the corporate firewall and via the WAN and one of the wireless networks . For example a user that has an account and associated mailbox in the data store may also have a mobile device such as . As described above messages received by the message server that identify a user account or mailbox are stored to a corresponding mailbox by the message server . If a user has a mobile device such as messages received by the message server and stored to the user s mailbox are preferably detected by the wireless connector system and sent to the user s mobile device . This type of functionality represents a push message sending technique. The wireless connector system may instead employ a pull technique in which items stored in a mailbox are sent to a mobile device responsive to a request or access operation made using the mobile device or some combination of both techniques.

The use of a wireless connector thereby enables a messaging system including a message server to be extended so that each user s mobile device has access to stored messages of the message server . Although the systems and methods described herein are not restricted solely to a push based technique a more detailed description of push based messaging may be found in U.S. Pat. No. 6 219 694 referenced above and in the following co pending and commonly owned U.S. patent applications all of which are related to the 694 patent U.S. patent application Ser. No. 09 401 868 Ser. No. 09 545 963 Ser. No. 09 528 495 Ser. No. 09 545 962 and Ser. No. 09 649 755. The complete disclosure of the 694 patent and each of these applications including drawings and claims is hereby incorporated into this application by reference. This push technique uses a wireless friendly encoding compression and encryption technique to deliver all information to a mobile device thus effectively extending the company firewall to include the mobile devices .

As shown in there are several paths for exchanging information with a mobile device from the corporate LAN . One possible information transfer path is through the physical connection such as a serial port using an interface or connector . This path may be useful for example for bulk information such as Certs and CRLs as described above or updates often performed at initialization of a mobile device or periodically when a user of a mobile device is working at a computer system in the LAN such as the computer system . The physical connection may also be used to transfer other information from a desktop computer system to a mobile device including private keys such as private encryption or signature keys associated with the desktop computer system .

Private key exchange using a physical connection and connector or interface allows a user s desktop computer system and mobile device or to share at least one identity for accessing all encrypted and or signed mail. The user s desktop computer system and mobile device or can thereby also be used to manage and transfer private keys so that either the host system or mobile device or can process secure messages addressed to the user s mailbox or account on the message server .

In known synchronization type wireless messaging systems a physical path has also been used to transfer messages from mailboxes associated with a message server to mobile devices and .

Another method for data exchange with a mobile device is over the air through the wireless connector system and using wireless networks . As shown in this could involve a Wireless VPN router if available in the network or alternatively a traditional WAN connection to wireless infrastructure that provides an interface to one or more wireless networks . The Wireless VPN router provides for creation of a VPN connection directly through a specific wireless network to a wireless device . Such a Wireless VPN router may be used in conjunction with a static addressing scheme. For example if the wireless network is an Internet Protocol IP based wireless network then the new IP Version 6 IPV6 should provide enough IP addresses to dedicate an IP address to every mobile device configured to operate within the network and thus make it possible to push information to a mobile device at any time. A primary advantage of using a wireless VPN router is that it could be an off the shelf VPN component which would not require wireless infrastructure . A VPN connection may use a Transmission Control Protocol over IP TCP IP or User Datagram Protocol over IP UDP IP connection to deliver messages directly to and from a mobile device .

If a wireless VPN router is not available then a link to a WAN normally the Internet is a commonly used connection mechanism that may be employed by the wireless connector system . To handle the addressing of the mobile device and any other required interface functions wireless infrastructure is preferably used. One example of a wireless infrastructure is the gateway in . The wireless infrastructure may also determine a most likely wireless network for locating a given user and track users as they roam between countries or networks. In wireless networks such as and messages are normally delivered to and from mobile devices via RF transmissions between base stations not shown and the mobile devices .

A plurality of connections to wireless networks and may be provided including for example Integrated Services Digital Network ISDN Frame Relay or T1 connections using the TCP IP protocol used throughout the Internet. The wireless networks and could represent distinct unique and unrelated networks or they could represent the same network in different countries and may be any of the different types of networks described above in conjunction with the wireless network in .

In some implementations more than one over the air information exchange mechanism may be provided in the corporate LAN . In the exemplary communication system of for example mobile devices associated with users having mailboxes associated with user accounts on the message server are configured to operate on different wireless networks and . If the wireless network supports IPv6 addressing then the wireless VPN router may be used by the wireless connector system to exchange data with any mobile device operating within the wireless network . The wireless network may be a different type of wireless network however such as the Mobitex network in which case information may instead be exchanged with a mobile device operating within the wireless network by the wireless connector system via a connection to the WAN and the wireless infrastructure .

Operation of the system in will now be described using an example of an e mail message sent from the computer system and addressed to at least one recipient having both an account and mailbox or like data store associated with the message server and a mobile device or . However the e mail message is intended for illustrative purposes only. The exchange of other types of information between the corporate LAN is preferably also enabled by the wireless connector system .

The e mail message sent from the computer system via the WAN may be fully in the clear or signed with a digital signature and or encrypted depending upon the particular messaging scheme used. For example if the computer system is enabled for secure messaging using S MIME then the e mail message may be signed encrypted or both and processed as described above.

E mail messages such as normally use traditional Simple Mail Transfer Protocol SMTP RFC822 headers and Multipurpose Internet Mail Extensions MIME body parts to define the format of the e mail message. These techniques are all well known to one in the art. The e mail message arrives at the message server which determines into which mailboxes the e mail message should be stored. As described above a message such as the e mail message may include a user name a user account a mailbox identifier or other type of identifier that may be mapped to a particular account or associated mailbox by the message server . For an e mail message recipients are typically identified using e mail addresses corresponding to a user account and thus a mailbox .

The wireless connector system sends or mirrors via a wireless network or certain user selected data items or parts of data items from the corporate LAN to the user s mobile device or preferably upon detecting that one or more triggering events has occurred. A triggering event includes but is not limited to one or more of the following screen saver activation at a user s networked computer system disconnection of the user s mobile device or from the interface or receipt of a command sent from a mobile device or to the host system to start sending one or more messages stored at the host system. Thus the wireless connector system may detect triggering events associated with the message server such as receipt of a command or with one or more networked computer systems including the screen saver and disconnection events described above. When wireless access to corporate data for a mobile device or has been activated at the LAN for example when the wireless connector system detects the occurrence of a triggering event for a mobile device user data items selected by the user are preferably sent to the user s mobile device. In the example of the e mail message assuming that a triggering event has been detected the arrival of the message at the message server is detected by the wireless connector system . This may be accomplished for example by monitoring or querying mailboxes associated with the message server or if the message server is a Microsoft Exchange server then the wireless connector system may register for advise syncs provided by the Microsoft Messaging Application Programming Interface MAPI to thereby receive notifications when a new message is stored to a mailbox .

When a data item such as the e mail message is to be sent to a mobile device or the wireless connector system preferably repackages the data item in a manner that is transparent to the mobile device so that information sent to and received by the mobile device appears similar to the information as stored on and accessible at the host system LAN in . One preferred repackaging method includes wrapping received messages to be sent via a wireless network in an electronic envelope that corresponds to the wireless network address of the mobile device to which the message is to be sent. Alternatively other repackaging methods could be used such as special purpose TCP IP wrapping techniques. Such repackaging preferably also results in e mail messages sent from a mobile device or appearing to come from a corresponding host system account or mailbox even though they are composed and sent from a mobile device. A user of a mobile device or may thereby effectively share a single e mail address between a host system account or mailbox and the mobile device.

Repackaging of the e mail message is indicated at and . Repackaging techniques may be similar for any available transfer paths or may be dependent upon the particular transfer path either the wireless infrastructure or the wireless VPN router . For example the e mail message is preferably compressed and encrypted either before or after being repackaged at to thereby effectively provide for secure transfer to the mobile device . Compression reduces the bandwidth required to send the message whereas encryption ensures confidentiality of any messages or other information sent to mobile devices and . In contrast messages transferred via a VPN router might only be compressed and not encrypted since a VPN connection established by the VPN router is inherently secure. Messages are thereby securely sent via either encryption at the wireless connector system which may be considered a non standard VPN tunnel or a VPN like connection for example or the VPN router to mobile devices and . Accessing messages using a mobile device or is thus no less secure than accessing mailboxes at the LAN using the desktop computer system .

When a repackaged message or arrives at a mobile device or via the wireless infrastructure or via the wireless VPN router the mobile device or removes the outer electronic envelope from the repackaged message or and performs any required decompression and decryption operations. When the original message is a secure message further processing may also be performed by the mobile device . Messages sent from a mobile device or and addressed to one or more recipients are preferably similarly repackaged and possibly compressed and encrypted and sent to a host system such as the LAN . The host system may then remove the electronic envelope from the repackaged message decrypt and decompress the message if desired and route the message to the addressed recipients.

Another goal of using an outer envelope is to maintain at least some of the addressing information in the original e mail message . Although the outer envelope used to route information to mobile devices is addressed using a network address of one or more mobile devices the outer envelope preferably encapsulates the entire original e mail message including at least one address field possibly in compressed and or encrypted form. This allows original To From and CC addresses of the e mail message to be displayed when the outer envelope is removed and the message is displayed on a mobile device or . The repackaging also allows reply messages to be delivered to addressed recipients with the From field reflecting an address of the mobile device user s account or mailbox on the host system when the outer envelope of a repackaged outgoing message sent from a mobile device is removed by the wireless connector system . Using the user s account or mailbox address from the mobile device or allows a message sent from a mobile device to appear as though the message originated from the user s mailbox or account at the host system rather than the mobile device.

The wireless connector systems may be similar to the wireless connector system described above in that they enable data items such as e mail messages and other items that are stored in mailboxes and possibly data items stored in a local or network data store to be sent from the LAN to one or more mobile devices . In however the network operator infrastructure provides an interface between the mobile devices and the LAN . As above operation of the system shown in will be described below in the context of an e mail message as an illustrative example of a data item that may be sent to a mobile device .

When an e mail message addressed to one or more recipients having an account on the message server is received by the message server the message or possibly a pointer to a single copy of the message stored in a central mailbox or data store is stored into the mailbox of each such recipient. Once the e mail message or pointer has been stored to a mailbox it may preferably be accessed using a mobile device or . In the example shown in the e mail message has been addressed to the mailboxes associated with both desktop computer systems and and thus both mobile devices and .

As those skilled in the art will appreciate communication network protocols commonly used in wired networks such as the LAN and or the WAN are not suitable or compatible with wireless network communication protocols used within wireless networks such as . For example communication bandwidth protocol overhead and network latency which are primary concerns in wireless network communications are less significant in wired networks which typically have much higher capacity and speed than wireless networks. Therefore mobile devices and cannot normally access the data store directly. The network operator infrastructure provides a bridge between the wireless network and the LAN .

The network operator infrastructure enables a mobile device to establish a connection to the LAN through the WAN and may for example be operated by an operator of the wireless network or a service provider that provides wireless communication service for mobile devices and . In a pull based system a mobile device may establish a communication session with the network operator infrastructure using a wireless network compatible communication scheme preferably a secure scheme such as Wireless Transport Layer Security WTLS when information should remain confidential and a wireless web browser such as a Wireless Application Protocol WAP browser. A user may then request through manual selection or pre selected defaults in the software residing in the mobile device any or all information or just new information for example stored in a mailbox in the data store at the LAN . The network operator infrastructure then establishes a connection or session with a wireless connector system using Secure Hypertext Transfer Protocol HTTPS for example if no session has already been established. As above a session between the network operator infrastructure and a wireless connector system may be made via a typical WAN connection or through the VPN router if available. When time delays between receiving a request from a mobile device and delivering requested information back to the device are to be minimized the network operator infrastructure and the wireless connector systems may be configured so that a communication connection remains open once established.

In the system of requests originating from mobile device A and B would be sent to the wireless connector systems and respectively. Upon receiving a request for information from the network operator infrastructure a wireless connector system retrieves requested information from a data store. For the e mail message the wireless connector system retrieves the e mail message from the appropriate mailbox typically through a messaging client operating in conjunction with the computer system which may access a mailbox either via the message server or directly. Alternatively a wireless connector system may be configured to access mailboxes itself directly or through the message server . Also other data stores both network data stores similar to the data store and local data stores associated with each computer system may be accessible to a wireless connector system and thus to a mobile device .

If the e mail message is addressed to the message server accounts or mailboxes associated with both computer systems and and devices and then the e mail message may be sent to the network operator infrastructure as shown at and which then sends a copy of the e mail message to each mobile device and as indicated at and . Information may be transferred between the wireless connector systems and the network operator infrastructure via either a connection to the WAN or the VPN router . When the network operator infrastructure communicates with the wireless connector systems and the mobile devices via different protocols translation operations may be performed by the network operator infrastructure . Repackaging techniques may also be used between the wireless connector systems and the network operator infrastructure and between each mobile device and the network operator infrastructure .

Messages or other information to be sent from a mobile device may be processed in a similar manner with such information first being transferred from a mobile device to the network operator infrastructure . The network operator infrastructure may then send the information to a wireless connector system for storage in a mailbox and delivery to any addressed recipients by the message server for example or may alternatively deliver the information to the addressed recipients.

The above description of the system in relates to pull based operations. The wireless connector systems and the network operator infrastructure may instead be configured to push data items to mobile devices and . A combined push pull system is also possible. For example a notification of a new message or a list of data items currently stored in a data store at the LAN could be pushed to a mobile device which may then be used to request messages or data items from the LAN via the network operator infrastructure .

If mobile devices associated with user accounts on the LAN are configured to operate within different wireless networks then each wireless network may have an associated wireless network infrastructure component similar to .

Although separate dedicated wireless connector systems are shown for each computer system in the system of one or more of the wireless connector systems may preferably be configured to operate in conjunction with more than one computer system or to access a data store or mailbox associated with more than one computer system. For example the wireless connector system may be granted access to the mailboxes associated with both the computer system and the computer system . Requests for data items from either mobile device A or B may then be processed by the wireless connector system . This configuration may be useful to enable wireless communications between the LAN and the mobile devices and without requiring a desktop computer system to be running for each mobile device user. A wireless connector system may instead be implemented in conjunction with the message server to enable wireless communications.

The wireless connector system provides for transfer of data items stored at the LAN to one or more mobile devices . These data items preferably include e mail messages stored in mailboxes in the data store as well as possibly other items stored in the data store or another network data store or a local data store of a computer system such as .

As described above an e mail message addressed to one or more recipients having an account on the message server and received by the message server may be stored into the mailbox of each such recipient. In the system of the external data store preferably has a similar structure to and remains synchronized with the data store . PIM information or data stored at data store preferably is independently modifiable to the PIM information or data stored at the host system. In this particular configuration the independently modifiable information at the external data store may maintain synchronization of a plurality of data stores associated with a user i.e. data on a mobile device data on a personal computer at home data at the corporate LAN etc. . This synchronization may be accomplished for example through updates sent to the data store by the wireless connector system at certain time intervals each time an entry in the data store is added or changed at certain times of day or when initiated at the LAN by the message server or a computer system at the data store or possibly by a mobile device through the access gateway .

In the case of the e mail message for example an update sent to the data store some time after the e mail message is received may indicate that the message has been stored in a certain mailbox in the store and a copy of the e mail message will be stored to a corresponding storage area in the data store . When the e mail message has been stored in the mailboxes corresponding to the mobile devices and for example one or more copies of the e mail message indicated at and in will be sent to and stored in corresponding storage areas or mailboxes in the data store . As shown updates or copies of stored information in the data store may be sent to the data store via a connection to the WAN or the VPN router . For example the wireless connector system may post updates or stored information to a resource in the data store via an HTTP post request. Alternatively a secure protocol such as HTTPS or Secure Sockets Layer SSL may be used. Those skilled in the art will appreciate that a single copy of a data item stored in more than one location in a data store at the LAN may instead be sent to the data store . This copy of the data item could then be stored either in more than one corresponding location in the data store or a single copy may be stored in the data store with a pointer or other identifier of the stored data item being stored in each corresponding location in the data store .

The access gateway is effectively an access platform in that it provides mobile devices and with access to the data store . The data store may be configured as a resource accessible on the WAN and the access gateway may be an ISP system or WAP gateway through which mobile devices and may connect to the WAN . A WAP browser or other browser compatible with the wireless networks and may then be used to access the data store which is synchronized with the data store and download stored data items either automatically or responsive to a request from a mobile device . As shown at and copies of the e mail message which was stored in the data store may be sent to the mobile devices and . A data store not shown on each mobile device may thereby be synchronized with a portion such as a mailbox of a data store on a corporate LAN . Changes to a mobile device data store may similarly be reflected in the data stores and .

It will be appreciated that the above description relates to preferred embodiments by way of example only. Many variations on the invention will be obvious to those knowledgeable in the field and such obvious variations are within the scope of the invention as described and claimed whether or not expressly described.

For example although a wireless mobile communication device is shown in and described as one of the messaging clients the invention is also applicable to other messaging clients including those operating on desktop and laptop computer systems networked computer workstations and other types of messaging clients between which Cert management and transfer to allow sharing of Certs for example is desired.

It is also contemplated that other Cert related information may be managed and transferred between messaging clients substantially as described above. CRLs public keys and private keys could similarly be managed and or transferred.

