---

title: Automated determination of jet orientation parameters in three-dimensional fluid jet cutting
abstract: Methods, systems, and techniques for automatically determining jet orientation parameters to correct for potential deviations in three dimensional part cutting are provided. Example embodiments provide an Adaptive Vector Control System (AVCS), which automatically determines speeds and orientation parameters of a cutting jet to attempt to insure that a part will be cut within prescribed tolerances where possible. In one embodiment, the AVCS determines the tilt and swivel of a cutting head by mathematical predictive models that examine the cutting front for each of “m” hypothetical layers in a desired part, to better predict whether the part will be within tolerances, and to determine what corrective angles are needed to correct for deviations due to drag, radial deflection, and/or taper.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09597772&OS=09597772&RS=09597772
owner: Flow International Corporation
number: 09597772
owner_city: Kent
owner_country: US
publication_date: 20130313
---
The present disclosure relates to methods systems and techniques for automatically controlling a fluid jet apparatus to cut three dimensional parts and in particular to methods systems and techniques for automatically adjusting orientation parameters of a waterjet cutting apparatus to cut within a designated tolerance three dimensional parts having non vertical surfaces and or from non flat material.

High pressure fluid jets including high pressure abrasive waterjets are used to cut a wide variety of materials in many different industries. Abrasive waterjets have proven to be especially useful in cutting difficult thick or aggregate materials such as thick metal glass or ceramic materials. Systems for generating high pressure abrasive waterjets are currently available for example the Paser ECL Plus system manufactured by Flow International Corporation. An abrasive jet cutting system of this type is shown and described in Flow s U.S. Pat. No. 5 643 058 which is incorporated herein by reference. The terms high pressure fluid jet and jet used throughout should be understood to incorporate all types of high pressure fluid jets including but not limited to high pressure waterjets and high pressure abrasive waterjets. In such systems high pressure fluid typically water flows through an orifice in a cutting head to form a high pressure jet into which abrasive particles are combined as the jet flows through a mixing tube. The high pressure abrasive waterjet is discharged from the mixing tube and directed toward a workpiece to cut the workpiece along a designated path.

Various systems are currently available to move a high pressure fluid jet along a designated path. Such systems are commonly referred to as three axis and five axis machines. Conventional three axis machines mount the cutting head assembly in such a way that it can move along an x y plane and perpendicular along a z axis namely toward and away from the workpiece. In this manner the high pressure fluid jet generated by the cutting head assembly is moved along the designated path in an x y plane and is raised and lowered relative to the workpiece as may be desired. Conventional five axis machines work in a similar manner but provide for movement about two additional rotary axes typically about one horizontal axis and one vertical axis so as to achieve in combination with the other axes degrees of tilt and swivel.

Manipulating a jet about five axes may be useful for a variety of reasons for example to cut a three dimensional shape. Such manipulation may also be desired to correct for cutting characteristics of the jet or for the characteristics of the cutting result. More particularly a cut produced by a jet such as an abrasive waterjet has characteristics that differ from cuts produced by more traditional machining processes. Two of the cut characteristics that may result from use of a high pressure fluid jet are referred to as taper and trailback. is an example illustration of taper. Taper is a phenomenon resulting from the width of a jet changing from its entry into a material to its exit from the material. The taper angle refers to the angle of a plane of the cut wall relative to a vertical plane. Jet taper typically results in a target piece that has different dimensions on the top surface where the jet enters the workpiece than on the bottom surface where the jet exits the workpiece . is an example illustration of trailback. Trailback also referred to as drag identifies the phenomenon that the high pressure fluid jet exits the workpiece at a point behind the point of entry of the jet into the workpiece relative to the direction of travel. These two cut characteristics namely taper and trailback may or may not be acceptable given the desired end product. Taper and trailback varies depending upon the speed the cut is made the speed that the jet travels in order to produce separation of part of the material from another part and other process parameters such as material thickness. Thus one known way to control excessive taper and or trailback is to slow down the cutting speed of the system. In situations where it is desirable to minimize or eliminate taper and trailback conventional five axis systems have been used primarily by manual trial and error to apply angular corrections to the jet by adjusting the cutting head apparatus to compensate for taper and trailback as the jet moves along the cutting path.

Embodiments described herein provide enhanced computer and network based methods systems and techniques for automatically adjusting orientation of a jet in a waterjet cutting system to compensate for deviations to achieve superior control over the surface of the cut and resulting piece generated by the cut. Example embodiments provide an Adaptive Vector Control System AVCS that automatically predicts how far the jet will deviate from the desired cutting path profile and automatically determines appropriate deviation correction angles that can be used to generate a motion control program or other data for controlling orientation of a cutting head apparatus. The deviation correction angles are determined as functions of the target piece geometry as well as speed and or other process parameters. By determining the deviation correction angles and using them as appropriate to generate instructions in the motion control program data in a form dependent upon what the cutting head controller can process the AVCS enables the cutting head apparatus controller to automatically control the three dimensional position and tilt and swivel of the cutting head and hence the x axis y axis z axis and angular positions of the jet relative to the material being cut as it moves along a cutting path in three dimensional space to cut the target piece. The AVCS where possible maximizes cutting speed while still maintaining desired tolerances.

In one embodiment the AVCS uses a set of advanced predictive models to determine the characteristics of an intended cut through a given material and to provide the deviation correction angles to account for predicted deviation of the jet from a straight line trajectory. The predicted deviation may be related for example to the width of the jet changing as it penetrates through the material and or the drag or deflection that results in the jet exiting at a point in some direction distant from the intended exit point. When cutting straight wall pieces these cutting phenomena can be expressed as trailback drag and taper and the corresponding deviation corrections expressed as lead compensation and taper compensation angles. However when cutting more complicated pieces such as non vertical beveled surfaces non flat curved material pieces with directional changes over the depth of the jet pieces with different shapes on the top and on the bottom etc. these deviations have directional components such as forward backward and sideways terms relative to the direction and path of jet travel that influence the deviations. The prediction of angular corrections thus becomes far more complex. Using advanced predictive models the AVCS operates without manual e.g. human intervention and does not require special knowledge by the operator to run the cutting machine. The automatic nature of the AVCS thus supports decreased production time as well as more precise control over the cutting process especially of complex parts.

In order to cut such parts the AVCS employs the advanced predictive models to determine how the jet is affected when penetrating the material from the entrance of the jet when making the cut e.g. the top to the exit of the jet when making the cut e.g. the bottom as it progresses along the intended cutting path. Of note when cutting from flat stock material the jet entry typically corresponds to a position on the top surface and the jet exit typically corresponds to a position on the bottom surface. As the jet progresses to cut the workpiece material to create the desired part there is a path that forms a contour on the top more generally referred to herein as the jet entry contour and a path that forms a contour on the bottom more generally referred to herein as the jet exit contour. A contour is a boundary of a shape or object. One aspect to understand these models is to recognize that the cutting speed of the jet changes along the length e.g. penetration or projection of the jet as the jet advances along the cutting path profile. These microenvironment speed changes cause localized deflections along the length of the jet which are accounted for by the models in determining deviation corrections.

Although discussed herein in terms of waterjets and abrasive waterjets in particular the described techniques can be applied to any type of fluid jet generated by high pressure or low pressure whether or not additives or abrasives are used. In addition these techniques can be modified to control the x axis y axis z offset and tilt and swivel or other comparable orientation parameters as functions of process parameters other than speed and the particulars described herein.

Although the AVCS described in is shown residing on a computer workstation separate from but connected to the jet apparatus the AVCS alternatively may be located on other devices within the overall jet system depending upon the actual configuration of the jet apparatus and the computers or other controllers the jet system . For example the AVCS may be embedded in the controller of the jet apparatus itself as part of the software firmware hardware associated with the machine . In this case the motion program data may be reduced and rather the determination of the automatic deviation correction adjustments to the jet orientation may be embedded into the controller code itself. Or for example the AVCS may reside on a computer system directly connected to the controller. In addition the controller may take many forms including integrated circuit boards as well as robotics systems. All such combinations or permutations are contemplated and appropriate modifications to the AVCS described such as the specifics of the motion program data and its form are contemplated based upon the particulars of the fluid jet system and associated control hardware and software.

Many different arrangements and divisions of functionality of the components of an AVCS are possible. In the following description numerous specific details are set forth such as data formats user interface screens code sequences menu options etc. in order to provide a thorough understanding of the described techniques. The embodiments described also can be practiced without some of the specific details or with other specific details such as changes with respect to the ordering of the code flow different code flows etc. or the specific features shown on the user interface screens. Thus the scope of the techniques and or functions described are not limited by the particular order selection or decomposition of blocks described with reference to any particular routine or code logic. In addition example embodiments described herein provide applications tools data structures and other support to implement an AVCS for waterjet cutting. Other embodiments of the described techniques may be used for other purposes including for other fluid jet apparatus cutting.

In block the AVCS gathers other input data such as process parameters typically from an operator although these parameters may have default values or some may be able to be queried and obtained from the jet apparatus controller. In one example embodiment the AVCS determines values for one or more of the type of material being cut material thickness fluid pressure nozzle orifice diameter abrasive flow rate abrasive type offset distance mixing tube diameter and mixing tube length or other mixing tube characteristics as process parameters.

In block the AVCS uses the received geometry specification and input process parameters to automatically calculate an offset geometry. The offset geometry is the geometry that needs to be followed when the target piece is cut to account for any width that the jet actually takes up the width of the cut kerf due to the jet . This prevents the production of pieces that are smaller or larger than specified. As characteristics of the jet change over time for example due to wear jet process parameters need to be correspondingly modified in order to compute the correct offset. In some embodiments the size of the offset is fixed and part of the input data. Calculation of the offset geometry for a three dimensional part may be achieved using known techniques for offsetting surfaces. Alternatively an approximation of the offset geometry instead of direct calculation may be obtained by computing an offset from the jet entry contour the contour of the part where the jet enters the material and computing an offset from the jet exit contour the contour of the part where the jet exits the material and then connecting the entrance and exit contours by lines. Depending on the inclinations of the surfaces and allowed tolerances this approximation methodology may or may not be acceptable.

Blocks build up a motion program by incrementally storing determined program values in a motion program structure or other data structure as needed by a particular cutting head controller cutting head etc. . Preferably the entries in the data structure correspond to stored motion program instructions and or data that are executed by the controller. Depending upon the particular cutting head apparatus and controller the motion program may be motion instructions and or data fed directly or indirectly to the hardware software firmware that controls the cutting head. In addition some configurations require inverse kinematic data because the instructions are specified from the point of view of the motors in the cutting head instead of from the point of view of the jet. Inverse kinematics can be computed using known mathematics to convert jet coordinates into motor or sometimes referred to as joint commands. All such embodiments can be incorporated into an AVCS appropriately configured to use the techniques described herein.

In particular in block the offset geometry is segmented into a number of part geometry vectors PGVs . This segmentation is performed for example automatically by components of the AVCS or in some embodiments may be performed externally such as by a CAD CAM program. show example segmentation of a desired part. shows an example of a desired part e.g. target piece design as it might be rendered in a solid modeling CAD package. Information from the part geometry specification and offset geometry is used to determine the jet entrance contour where the cutting jet will enter the target material as it progresses along the desired cutting path and the jet exit contour where the cutting jet will leave the material accordingly. For example when cutting a part from flat stock the jet entrance contour will define the cutting path on the top of the part and the jet exit contour will define the cutting path on the bottom of the part. The PGVs then are formed by using multiple lines to connect the jet entrance contour to the jet exit contour in a one to one relationship. That is there are an equal number of segments between PGVs in both the entrance and exit contours. In one example embodiment the end points of each PGV are connected by lines to each succeeding PGV along the contour. Thus a circle or arc contour is converted into a sequence of line segments. illustrates the part shown in A segmented into PGVs. In this example the jet entrance contour forms a circle and the jet exit contour forms a square. The ruled surface nature of the part is a clearly visible in . In one embodiment the number of PGVs is determined by the desired resolution of the target part to be cut. For example the circular entrance contour shown in requires a large number of PGVs to optimally retain its circular shape. If the segmentation process results in too few PGVs then the desired circle would look like a polygon after it is cut. Other factors such as the hardware kinematics or motion controller capabilities may also be considered when determining the number of required PGVs. Additionally lead in and lead out PGVs may be added to the offset geometry or beforehand to the geometry specified by the user to correspond to start and finishing positions of the jet. These vectors do not define the part but describe the way the jet starts and ends its cut into the workpiece.

In block an indication of maximum cutting speed allowed is assigned to one or more surfaces or regions of the desired part. Typically the operator or using a default provided by the AVCS assigns a maximum speed to each region surface of the target part a set of regions or the whole part either as an indication of speed or by specifying surface finish and or quality etc. Defining the maximum speed allowed sets an upper limit on how rough the surface finish of the cut will be. Cutting speed and surface finish are tightly related thus the indication of maximum speed allowed may take the form of any scale representing cutting speed surface finish or cut quality. Using the input data process parameters received geometry specification indication of speed and any required mathematical relationships the AVCS then automatically calculates the desired tool tip speed along the jet entrance contour for each segment between PGVs based upon the indicated maximum cutting speed assigned to each respective surface region. For example if the operator had assigned a maximum cutting speed of 50 speed for the sides of the shape shown in then the AVCS would use that value to determine what actual cutting speed to assign to each entrance contour segment between PGVs since the speed specified is the same for all . In the case where the length of a segment on the entrance contour and corresponding segment on the exit contour are different the cutting speed will vary along the length projection into the material of the jet because more material needs to be cut on one contour than the other in a given period of time . Thus the AVCS needs to adjust the cutting speed at jet entrance such that no portion of a given surface is cut at a speed greater than the indicated maximum allowed speed. This means that the cutting speeds along some portions of the jet hence assigned to the PGV may be conservative to insure that all regions surface areas bounded by PGVs do not violate the quality requirement e.g. are within the desired maximum speed . An example using a percent of maximum speed as a suitable indication of maximum speed is available in FlowMaster controlled shape cutting systems currently manufactured by Flow International Corporation. Equivalent indicators of surface finish speed and or quality are generally known. When using percent of maximum speed as the indicator predictive models equations and or equivalent look up tables such as the speed and acceleration model can be used by the AVCS to determine the fastest cutting speed possible for a given thickness of material based on the input data for example to comport with Newtonian constraints . The percentage value is then used to scale the calculated maximum value.

In block the determination of speed is made for each top bottom pair of segments bounded by adjacent PGVs. Given the lengths of the top and bottom segments and an indication of speed the AVCS can automatically calculate both the top and bottom cutting speeds.

In block the tolerance input data from block are used to determine an enclosed imaginary volume around each PGV. This volume represents the deviation tolerance or deviation tolerance zone for each PGV. is an example block diagram that illustrates two tolerance volumes around two part geometry vectors. In practice a volume is defined around all PGVs with showing only two such vectors for the purpose of clarity. Volume is a tolerance volume around a first PGV volume is a tolerance volume around a second PGV. As shown in the volume around each vector need not be the same. For example shows a smaller volume around the PGV at the corner of the part. This is indicative of a tighter tolerance requirement in this region of the part. Furthermore while shows a tolerance volume for example that is cylindrical in shape such a shape is not a requirement. In practice the tolerance requirements may be directional in nature. For example as the jet is directed into an inside corner it may be undesirable to create a region of overcutting into the part. On an outside corner however cutting into the waste material by the trailing jet may be acceptable. These different requirements may result in one tolerance value as the jet goes into the corner and another tolerance value as the jet leaves the corner. Such requirements might create tolerance volumes of varying sizes and shapes throughout a part unlike the cylindrical ones shown in . In addition a single tolerance value may be assigned to the entire part for example when less precision of any subparts of the part is required. Also one or more tolerances may be assigned by the cutting system for example as default values.

In block the AVCS automatically determines the shape of a the part to be cut and whether or not the shape is within the deviation tolerance associated with each PGV for example using the adaptive deviation correction model in . In one embodiment the indication of maximum allowed speed input data received geometry specification and part geometry vectors are used to predict the shape of the cutting front the cut down the length of the jet as it moves into the workpiece material to cut the target piece. This prediction is discussed further below with respect to . Any suitable model giving the same or equivalent information may be used. The predicted shape of the cutting front is then compared to the deviation tolerance volume at each PGV. For example illustrates a curved shape of a cutting front partially contained in a cylindrical shape of a deviation tolerance volume. The curved shape represents the cutting front made into the workpiece material with the top of the shape centered upon a PGV not shown . For ease of presentation the cutting front is displayed as an assemblage of small cylinders although only a half of each small cylinder may be needed to represent the cutting front. The cylinder represents the deviation tolerance volume surrounding the PGV. In the cutting front representation falls outside of the deviation tolerance volume as can be seen by the tail of shape extending beyond cylinder . illustrates an example of a curved shape where the predicted cutting front lies within the deviation tolerance volume. Here the curved shape is shown entirely within cylindrical shape . The location and orientation of the cutting front within the deviation tolerance volume may change but a critical factor is whether the cutting front is contained within the zone.

In block the AVCS automatically determines two deviation correction angles applied relative to the XYZ coordinate system used to describe the PGV. Here the deviation correction angles are expressed spherical coordinates applied to the local coordinate system of the PGV. Other equivalent expressions may be used. Also depending upon the cutting head apparatus motors and controller fewer or more deviation angles may be determined and used. The deviation correction angles are used to create a new jet direction vector JDV that deviates from the PGV in the amount defined by the tilt and swivel specified in the deviation correction angles. In the case where the predicted shape of the cutting front is outside of the deviation tolerance volume directing the jet along the JDV will adjust the cutting front into the deviation tolerance volume.

In block the AVCS builds the final motion program data by making adjustments to the motion program data structure or other data structures as necessary for the particular jet controller in use. The motion program contains the necessary commands to orient the jet along each JDV at the determined cutting speed starting with the location of the lead in JDV and ending with the location that corresponds to the lead out JDV as the jet progress along the entrance and exit contours. The motion program instructions may be expressed in terms of motor positions or tool tip positions and orientations or equivalents thereof. If tool tip positions defining location and orientation are used the controller must interpret the instructions into motor positions through the use of kinematic equations. The complexity of the kinematics are typically a function of the hardware used to manipulate the cutting jet.

For example some controllers are capable of receiving motion programs specified in terms of the jet orientation and internally use inverse kinematics to determine the actual motor positions from the jet tool tip positions. Others however expect to receive the motion program instructions in terms of motor positions and not jet tool tip x y positions and angle coordinates. In this case when the jet tool tip positions need to be translated to motor positions the AVCS in step performs such translations using kinematic equations and makes adjustments to the orientation parameter values stored in the motion program data structure.

In block the AVCS establishes and or verifies communication with the controller of the jet apparatus depending upon the setup of the connection between the AVCS and the controller. For example in the case of an embedded AVCS this logic may not need to be performed. In block the AVCS sends forwards communicates transmits or the like the built motion program motion instructions data to the controller for execution. The term controller includes any device software firmware capable of directing motor movement based upon the motion program motion instructions data. The term motion program is used herein to indicate a set of instructions that the particular jet apparatus and or controller being used understands as explained elsewhere. The foregoing code logic can accordingly be altered to accommodate the needs of any such instructions and or data requirements.

Also although certain terms are used primarily herein other terms could be used interchangeably to yield equivalent embodiments and examples. In addition terms may have alternate spellings which may or may not be explicitly mentioned and all such variations of terms are intended to be included.

 GUI that controls the entire cutting process. are example screen displays of various aspects of an example embodiment of the AVCS user interface. These displays show how a user invokes the AVCS capabilities to automatically determine jet deviation corrections and accordingly adjust the jet orientation as described in detail in . Other example screen displays for entering user input etc. are described in detail in U.S. Pat. No. 6 766 216 issued Jul. 20 2004 to Flow International Corporation. Many variations of these screen displays including the input requested the output displayed and the control flow exist and are contemplated to be used with the techniques described herein.

The computing system may comprise one or more server and or client computing systems and may span distributed locations. In addition each block shown may represent one or more such blocks as appropriate to a specific embodiment or may be combined with other blocks. Moreover the various blocks of the Adaptive Vector Control System may physically reside on one or more machines which use standard e.g. TCP IP or proprietary interprocess communication mechanisms to communicate with each other.

In the embodiment shown computer system comprises a computer memory memory a display one or more Central Processing Units CPU Input Output devices e.g. keyboard mouse CRT or LCD display etc. other computer readable media and one or more network or other communications connections . The AVCS is shown residing in memory . In other embodiments some portion of the contents some of or all of the components of the AVCS may be stored on and or transmitted over the other computer readable media . The components of the Adaptive Vector Control System preferably execute on one or more CPUs and manage the generation of motion programs as described herein. Other code or programs and potentially other data repositories such as data repository also reside in the memory and preferably execute on one or more CPUs . Of note one or more of the components in may not be present in any specific implementation. For example some embodiments embedded in other software may not provide means for user input or display.

As described in in a typical embodiment the AVCS  comprises various components including a user interface a CAD module if not a part of the user interface a motion program generator AVCS Kernel one or more replaceable models including the Adaptive Deviation Correction Model a controller interface and an AVCS Data Repository . These components are shown residing in the memory . As described elsewhere the user interface is used to provide the AVCS with certain inputs such as a desired surface finish and or other input parameters. The CAD module provides a geometry specification for the desired part. The Motion Program Generator AVCS Kernel is responsible for segmenting the part geometry determining tolerances and deviation corrections to achieve such tolerances using the models including the Adaptive Deviation Correction Model . The AVCS Data Repository may be used to hold temporary or permanent data including for example a copy of the generated motion program.

In at least some embodiments the CAD module component is provided external to the AVCS and is available potentially over one or more networks and or communication buses . Other and or different modules may be implemented. In addition the AVCS may interact via a communications bus network with other application code that e.g. for example that uses results computed by the AVCS one or more cutting jet controllers or control systems and or one or more third party information provider systems such as an External CAD System that provides part of the segmentation process or a 3D modeling tool etc.

Also in some embodiments an AVCS API Application Programming Interface is provided to provide programmatic access to aspects of the AVCS. For example the API may provide programmatic access to the motion program stored in the data repository or even to the intermediary deviation correction results such as the PGVs JDVs etc. or to the functions provided by the AVCS in embodiments where such access is desirable. Such access may be desirable for example to interface to 3party 3D modeling software.

In an example embodiment components modules of the AVCS are implemented using standard programming techniques. However a range of programming languages known in the art may be employed for implementing such example embodiments including representative implementations of various programming language paradigms including but not limited to object oriented e.g. Java C C Smalltalk etc. functional e.g. ML Lisp Scheme etc. procedural e.g. C Pascal Ada Modula etc. scripting e.g. Perl Ruby Python JavaScript VBScript etc. declarative e.g. SQL Prolog etc. etc.

The embodiments described above may also use well known or proprietary synchronous or asynchronous client server computing techniques. However the various components may be implemented using more monolithic programming techniques as well for example as an executable running on a single CPU computer system or alternately decomposed using a variety of structuring techniques known in the art including but not limited to multiprogramming multithreading client server or peer to peer running on one or more computer systems each having one or more CPUs. Some embodiments may execute concurrently and asynchronously and communicating using message passing techniques. Equivalent synchronous embodiments are also supported.

In addition programming interfaces to the data stored as part of the AVCS e.g. in the data repositories can be available by standard means such as through C C C and Java APIs libraries for accessing files databases or other data repositories through scripting languages such as XML or through Web servers FTP servers or other types of servers providing access to stored data. The AVCS data repository may be implemented as one or more database systems file systems in memory data structures or any other method known in the art for storing such information or any combination of the above including implementation using distributed computing techniques.

Also the example AVCS may be implemented in a distributed environment comprising multiple even heterogeneous computer systems and networks. Also one or more of the modules may themselves be distributed pooled or otherwise grouped such as for load balancing reliability or security reasons. Different configurations and locations of programs and data are contemplated for use with techniques of described herein. A variety of distributed computing techniques are appropriate for implementing the components of the illustrated embodiments in a distributed manner including but not limited to TCP IP sockets RPC RMI HTTP Web Services XML RPC JAX RPC SOAP etc. etc. Other variations are possible. Also other functionality could be provided by each component module or existing functionality could be distributed amongst the components modules in different ways yet still achieve the functions described herein.

Furthermore in some embodiments some or all of the components of the AVCS may be implemented or provided in other manners such as at least partially in firmware and or hardware including but not limited to one or more application specific integrated circuits ASICs standard integrated circuits controllers e.g. by executing appropriate instructions and including microcontrollers and or embedded controllers digital signal processors DSPs field programmable gate arrays FPGAs complex programmable logic devices CPLDs etc. Some or all of the system components and or data structures may also be stored e.g. as executable or other machine readable software instructions or structured data on a computer readable medium e.g. a hard disk a memory a network or a portable media article to be read by an appropriate drive or via an appropriate connection so as to enable or configure the computer readable medium and or one or more associated computing systems or devices to execute or otherwise use or provide the contents to perform at least some of the described techniques. Some or all of the system components and data structures may also be stored as data signals e.g. as part of a carrier wave or included as part of an analog or digital propagated signal on a variety of computer readable transmission mediums such as media including wireless based and wired cable based mediums which signals are then transmitted including across wireless based and wired cable based mediums and may take a variety of forms e.g. as part of a single or multiplexed analog signal or as multiple discrete digital packets or frames . Such computer program products may also take other forms in other embodiments. Accordingly embodiments of this disclosure may be practiced with other computer system configurations.

As discussed with reference to the user interface demonstrated in when an operator selects the Run button from the introductory dialog of the cutting module of the user interface see e.g. button the AVCS begins the process of automatically determining and adjusting deviation correction angles and building a motion program based upon them.

Specifically in block the AVCS automatically calculates an offset geometry for the desired part called also the part geometry from the inputted geometry specification as described elsewhere and assigns to it an XYZ coordinate system upon which all subsequent calculations are based. Recall that the offset geometry is the geometry that needs to be followed when the target piece is cut to account for any width that the jet actually takes up when cutting. Preferably a right handed coordinate system is used with the Z axis pointing upward. However any consistent coordinate system may be used. In practice the calculations are made easier if the coordinate system matches the physical robotic system on which the part will be cut.

In block the part geometry is automatically segmented such that it is represented as a series of part geometry vectors PGVs . As described earlier PGVs are straight line segments connecting a contour where the jet enters the material to be cut with a contour where the jet exits the material. Preferably endpoints of the PGVs along the jet entrance and jet exit contours are connected by line segments although other geometric entities such as arcs may be feasible in some control schemes. The jet entrance and jet exit contours are in a one to one relationship such that the two contours have the same number of segments. For ease of explanation the flow diagram of will refer to a part such as that represented in although the techniques are not limited to geometries such as where the jet enters a surface co planar with the surface where the jet exits. Note that the techniques described in may be applied to any geometry provided the proper transformations are applied to the selected coordinate system.

In block the AVCS determines a tool tip speed e.g. in units of percent speed for each segment of the jet exit contour between two PGVs . In other embodiments indications of speed other than units of percent speed may be incorporated. For the sake of consistency and ease units of percent speed are used herein to describe speed. The tool tip speed is determined automatically by the AVCS using the part geometry and the indication of maximum cutting speed allowed by the operator as was explained with reference to . In its simplest form in one embodiment the AVCS follows a highly conservative approach and allows no part of the cutting jet stream to exceed the speed determined by the AVCS. For example in the case where an operator uses an indicator of 50 maximum speed. If the length of the connecting segment between two PGVs is the same at both the jet entrance along the jet entrance contour and exit of the part along the jet exit contour then the AVCS will calculate the cutting speed based on the 50 input. If however the length of the connecting segment at jet entrance is twice as long as the length of the connecting segment at jet exit then a conservative approach is to use a 50 value at the entrance of the cut even if the cutting speed is very slow along the jet length at the exit of the cut. shows a tapered bevel part where the entrance contour is longer than the exit contour. If the length of the connecting segment at jet entrance is half the length of the connecting segment at jet exit then a conservative approach is to lower the entrance cutting speed to a speed determined by a 25 value half the 50 maximum value . shows a beveled part where the entrance contour is shorter than the exit contour even though the shapes are the same. See as well . Setting the entrance cutting speed to a 25 value guarantees that no portion of the cut surface is cut faster than the 50 originally assigned by the operator. Less conservative approaches can be used based on predictive models such as those for example describing surface finish as a function of cutting speed. Any type of predictive model can be used by the AVCS as well as look up tables or simple mathematical techniques such as averaging.

In block the AVCS automatically slices the part geometry into many layers parallel to the XY plane. The AVCS will automatically apply predictive models e.g. the adaptive deviation correction model of to each slice to predict localized deviations such as trailback drag radial deflection which may affect the drag and taper. The drag results accounting for any radial deflection for each layer are then summed together to give an overall picture of the cutting front. Specifically the deviation position at each layer becomes the starting position for the subsequent layer. Hence by adding the relative deviations a whole sense of the total deviation of the predicted cutting front from the desired cutting front can be determined. In addition the taper is examined at each layer to determine whether the cut is within a localized tolerance volume. Once the predicted cutting front is determined and compared against acceptable tolerances the AVCS can determine correction angles to be applied to the jet orientation to attempt to adjust the cutting front to come within acceptable tolerances as described with respect to through .

For example consider the scenario depicted in . is an example illustration of applying deviation correction angles to adjust jet orientation to be within acceptable tolerances. In line represents a PGV the ideal desired location for the cutting front to produce the desired geometry. However line shows the starting and exit locations of the predicted cutting front as summed up over multiple layers where line falls outside of the desired tolerance volume . Line shows the starting and end positions of a hypothetical cutting front that would fall within an acceptable tolerance volume. The AVCS calculates the appropriate rotations required to orient line to the position of . These rotations become the correction angles applied to the PGV . By adding these correction angles to the PGV the cutting front will be shifted within the tolerance volume eventually when cutting takes place.

The thickness chosen for each layer is a trade off between calculation effort and resolution. Thinner layers require more calculations but provide results that are more accurate. Thicker layers allow for fewer calculations but less accurate results. Experiments have shown that a layer thickness of 0.01 inches 0.254 mm will describe a typical abrasive waterjet cut with adequate detail. The equations used in the following description are based upon this layer thickness. Coefficients for the various equations may vary as layer thickness is changed.

In block the radius of curvature of the part surface at each PGV for each PGV segment for each layer is determined. The radius of curvature R is the reciprocal of the curvature k of the part surface. Both the curvature k and the radius of curvature R are found using well established mathematical methods for surfaces. For example Kobayashi and Nomizu John Wiley Sons 1991 or Thorpe Springer Verlag N.Y. 1979 provides such information and are incorporated herein by reference in their entireties. It is noted that information about the curvature may be lost through the segmentation process e.g. when the PGVs are straight lines . In such cases the curvature values can be retrieved from the original geometry that was input as the geometric specification. Alternatively these values may be calculated as part of the logic of prior to the segmentation. For example in the part shown in the radius of curvature at each layer will vary from the radius of the circle that forms each segment at the jet entrance contour to a value of infinity for the line that represents each segment at the jet exit contour. The value for the radius on intermediate layers will vary as a function of the surface description.

In block the AVCS calculates an adjusted cutting speed at each layer e.g. an adjusted percent cutting speed by using the percent speed of the jet exit contour and information from the PGVs and connecting segments. The adjustment in the speed accounts for the material depth at each layer. In other words the speed assigned to the jet exit contour is associated with the total depth T of the material. But the AVCS preferably uses a cutting speed that is appropriate for a given layer to derive the other layer calculations. In addition the angle of attack should be taken into account as well as the pivoting of the jet as it moves through the material. In it can be seen that the angle of attack is taken into account to compensate for any additional distance the jet travels through a layer due to the angle . Also in for example the bottom segment lengths Lare greater than Land so on. This effectively makes the cutting speeds towards the entrance of the cut even slower than at the bottom. If the entrance lengths were larger than at the exit the effect is reversed. Additionally cutting efficiency tends to decrease with depth because of power loss down the jet length and this too is preferably taken into account. With regards to the decrease in cutting efficiency with depth based upon empirical results for materials up to 2 inches thick the cutting speed is approximately proportional to 1 0.2T T where T is the total thickness in inches. This relationship is used to calculate the adjusted cutting speed per layer by forming a ratio of the proportional cutting speed at the full material thickness to the proportional cutting speed at the thickness of a given layer.

Equation 1 shows the form of equation used to adjust the cutting speed for each layer here using percent speed as a measure of speed . In Equation 1 Uis the adjusted speed in percent for a given layer Uis the percent speed at the exit contour T is the total thickness of the target material in inches t is the depth of one layer in inches m is the layer number counting from the entrance contour Lis the length of the segment in inches connecting two adjacent PGVs at the exit contour Lis the length of the segment between adjacent PGVs of the layer being adjusted. Equation 1 has been shown to work well for material depths up to 2 inches thick. For materials thicker some adjustment of coefficients may be necessary.

In block the adjusted percent cutting speed for each layer is broken into X and Y components to represent a directional component. Starting with the first PGV the direction of the segment at each layer connecting to the following PGV forms a velocity vector. Following standard rules of geometry the AVCS calculates the adjusted percent speed for each layer for both the X and Y components of the established coordinate system. Results of the calculations are stored in a suitable data structure.

In block the AVCS constructs the three dimensional profile of the cutting front. To calculate the cutting front for each layer the AVCS takes two interactions between the jet and the material into account. The first interaction is the deflection of the jet opposite from the direction of the cut. This is referred to as jet drag trail back or lag. The AVCS calculates the drag for each layer in each of the X and Y components using an equation in the form 

In block the AVCS determines the width of the kerf at each layer. For this block the AVCS relies on models showing the macro structure of the jet. Existing models for kerf width and drag are known in the art and for example one form is presented in U.S. Pat. No. 6 766 216. In these models it is seen that both drag and width of the kerf are functions of material thickness and percent speed. Thus kerf width may be calculated using the relationship between linear drag and kerf width. shows a graphical representation of the relationship between kerf width and linear drag. In particular each line on the graph represents how the kerf width for pairs of percent speed and material thickness varies with different linear drag values. The AVCS examines the stored data for each layer and calculates the total length of the drag for each layer from entrance to and including that layer without regard to the radial deflection. The value of this drag is then used to calculate what an equivalent percent speed would be in a linear cut for which the kerf width is predicted using the aforementioned models. The linear equivalent percent speed Uis found using equations of the form 

The AVCS then uses the value of U to calculate the width Win inches of each layer using equations of the form 

The AVCS stores calculated values for each layer in a suitable data structure. shows a representation of the cutting front where the kerf width of each layer is represented by a disk centered around the cutting front shape determined by the drag and deflection calculations of block .

In block the AVCS automatically determines if the cutting front i.e. the curvature characteristics of the intended cut is within the deviation tolerance s allowed. Using the tolerance input by the operator AVCS itself and or by an external input the AVCS calculates the acceptable tolerance volume around each PGV per layer. For example consider the cylinder representing the tolerance volume in . The cutting front data for each layer determined in block is then checked to see if the intended kerf will be within the acceptable volume. If the cutting front is acceptable for all layers of that PGV the next PGV and cutting front curvature characteristics of the intended cut at that path profile are checked for each layer. For each PGV the results of the tolerance checks are stored in a suitable data structure.

In block the AVCS locates any PGVs for which the corresponding cutting front is cut curvature characteristics are out of tolerance. An example of this situation was described with reference to . A line represents an imaginary line connecting the top layer kerf location to the bottom layer kerf location. One convenient way to describe the position and orientation of is to use a local spherical coordinate system with the origin placed at the top of the PGV . shows an example of the use of spherical coordinates to derive deviation correction angles. Using spherical coordinates any point in space can be defined by two angles and a distance from an origin. Applying this method to it can be observed that the location of the cutting front at the bottom layer is defined by a length r and two angles and . The line represents any orientation that would allow the cutting front to lie within the tolerance volume . That is if line were rotated to the position of line the predicted cutting front would no longer extend outside of the tolerance volume . Since the bottom endpoint of line may also be defined by spherical coordinates standard mathematical procedures for rotation transformations may be used to calculate values for angles that when applied to line will rotate it into position shown by line . These calculated angles may effectively be used to correct for the deviation of the cutting front from the PGV . The dotted line shows that by applying these deviation correction angles to the PGV the jet direction vector JDV is obtained. Again rotating the PGV by the amount of the deviation correction angles can be performed using known mathematical procedures for rotation transformations.

In block the AVCS determines if the deviation corrected cutting front is still within the deviation tolerance volume. If not the AVCS continues to block to lower the cutting speed by some chosen percent speed and the cutting front recalculated from the beginning by returning to block . This process is iterated upon performing blocks through until the cutting front fits within the deviation tolerance volume for example as shown in .

In one embodiment the AVCS does not allow the speed to go below a fixed value. If this value is reached the operator is notified that the desired tolerance will not be met. Lowering the cutting speed for one PGV may necessitate an adjustment of the cutting speeds for speeds of adjacent PGVs or JDVs . This may be necessary if machine acceleration limits are violated or to avoid large speed changes that affect the cut part appearance. Generally speaking speed changes that result in a large drag change in a short distance are discouraged. If several speeds need to be adjusted the AVCS iterates over the affected area. All results are stored in a suitable data structure.

In block the AVCS produces the actual motion instructions e.g. in a motion program and or data and stores them. The motion instructions contain all of the information necessary for the motion controller to move the tool tip along the jet entrance contour at the proper speed and in the proper orientations aligning with each JDV. The information for all PGVs speed indications e.g. percent speeds and deviation correction angles are retrieved. Where needed the speed indications e.g. percent speeds are converted into real speed units if needed using suitable predictive models or look up tables. These models are practiced for example in the FlowMaster software. As appropriate for the cutting head controller the commands necessary to move the motors to achieve the position and orientation of the cutting head along the PGVs plus deviation correction angles are calculated and a motion program data built from them.

The motion program may be written in any format that is understood by a given motion controller. For example one common form of motion program uses what is commonly referred to as G code. A simple example of a G code program is G01X10F50 where the G01 indicates a linear move 10 units in the X direction at a speed of 50 units per time. More complex G code commands would include Y and Z directions as well as commands for rotary axes. The actual values used for the X Y Z F and rotary commands will depend on whether or not the tool tip position and orientation is being commanded or the explicit motor positions needed to produce the desired tip position and orientation.

In another embodiment of the AVCS does not perform one or more of the logic blocks. Instead the models such as the adaptive deviation correction model model in are downloaded into the controller itself. As the controller executes the cutting path profile of the part geometry the controller consults internally embedded models and feedback relative to the current location in the cutting path profile and the upcoming location to determine any needed deviation correction angles to be used to adjust the jet for example by manipulating the cutting head orientation. Thus a type of look ahead is provided. As discussed with reference to below once the controller feedback and control screen is displayed an operator preferably selects the cycle start button see e.g. button to cause the jet apparatus to actually begin cutting the workpiece.

Vector Control System to begin the cutting cycle. In block the AVCS forwards e.g. causes to be downloaded sends transmits the motion program to the controller e.g. controller computer or card . In block the AVCS sends or otherwise communicates an instruction to the controller to indicate that the controller should begin executing the motion program and then returns. As the controller advances through the motion program it smoothly transitions between all angles and speeds.

All of the above U.S. patents U.S. patent application publications U.S. patent applications foreign patents foreign patent applications and non patent publications referred to in this specification and or listed in the Application Data Sheet including but not limited to U.S. Pat. No. 6 766 216 entitled METHOD AND SYSTEM FOR AUTOMATED SOFTWARE CONTROL OF WATERJET ORIENTATION PARAMETERS issued Jul. 20 2004 U.S. Pat. No. 6 996 452 of the same title issued Feb. 7 2006 and U.S. Pat. No. 8 423 172 entitled AUTOMATED DETERMINATION OF JET ORIENTATION PARAMETERS IN THREE DIMENSIONAL FLUID JET CUTTING issued on Apr. 16 2013 are incorporated herein by reference in their entireties.

From the foregoing it will be appreciated that although specific embodiments have been described herein for purposes of illustration various modifications may be made without deviating from the spirit and scope of the present disclosure. For example the methods systems and techniques for automatically determining and adjusting deviation correction angles discussed herein are applicable to other architectures other than a PMAC controller architecture. Also the methods systems. and techniques discussed herein are applicable to differing protocols communication media optical wireless cable etc. and devices such as wireless handsets electronic organizers personal digital assistants portable email machines game machines pagers navigation devices such as GPS receivers etc. .

