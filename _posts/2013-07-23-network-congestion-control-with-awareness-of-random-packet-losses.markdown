---

title: Network congestion control with awareness of random packet losses
abstract: Messages are sent from a first network device to a second network device across a network. The network includes a network portion with an expected random packet loss rate. The actual packet loss rate for packets sent across the network is compared to the expected random packet loss rate. A determination is made that the actual packet loss rate is greater than the expected random packet loss rate. Compensation for network congestion is performed in response to the determination that the actual packet loss rate exceeds the expected random packet loss rate.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09485186&OS=09485186&RS=09485186
owner: Cisco Technology, Inc.
number: 09485186
owner_city: San Jose
owner_country: US
publication_date: 20130723
---
The present disclosure relates to computer networks and in particular congestion compensation and avoidance in computer networks.

Congestion control mechanisms in Internet transport layers such as Transmission Control Protocol TCP congestion control mechanisms and Stream Control Transmission Protocol SCTP congestion control mechanisms have been designed to assume that packet losses are an indication of network congestion in the path. Additional mechanisms have been developed to provide congestion indications e.g. explicit congestion notification ECN but these mechanisms are not consistently supported. Accordingly transport layer congestion control mechanism implementations must still treat any packet loss as an indication of congestion.

Congestion control mechanisms adjust for congestion by resizing the congestion window cwnd size for the transmission. Even for layer 4 TCP and SCTP congestion signaling such as ECN Congestion Experienced CE signaling congestion control mechanisms react to the signaling in the same manner in which they react to actual lost packets.

As network technology evolves to include wireless networks networks have begun to see random packet losses. For example third generation 3G wireless networks can see 1 packet loss rates even under perfect environmental conditions. Similarly Long Term Evolution LTE wireless users may see 10or 10percent packet loss rates even under the best of conditions. As wireless devices move around they can experience significantly higher random packet loss rates due to the physical location of the device and irrespective of current network congestion.

Techniques are presented herein to provide congestion control with awareness of random packet losses. Messages are sent from a first network device to a second network device across a network. The network includes a network portion with an expected random packet loss rate. The actual packet loss rate for packets sent across the network is compared to the expected random packet loss rate. A determination is made that the actual packet loss rate is greater than the expected random packet loss rate. Compensation for network congestion is performed in response to the determination that the actual packet loss rate exceeds the expected random packet loss rate.

Depicted in is network environment in which network congestion compensation including random packet loss awareness may be been implemented. Included in network environment is a sending device a receiving device and a network . Included within network is portion in which there is an expected random packet loss rate. According to the example of portion is embodied in an Open System Interconnection OSI model Layer 2 network portion while the remainder of network is embodied in OSI Layer 4 network portions. As a sending device device sends traffic over network to receiving device . The receiving device responds to sending device through return traffic e.g. acknowledgments. Depending on the content of return traffic sending device may determine whether or not all of the packets sent through traffic have been received by receiving device . Also included in sending device is random packet loss awareness unit which is configure to allow sending device to apply congestion compensation to traffic which takes into account the random packet loss rate of portion .

According to the example of sending device may send traffic to receiving device in the form of sequentially sent packets and . Packets and may include sequence numbers indicative of the order in which they were sent. Accordingly packet may include a sequence number of 1 packet may include a sequence number of 2 and packet may include a sequence number of 3. These sequence numbers allow the packets and to be reordered if they are received out of sequence. Receiving device will acknowledge the packets it has received through acknowledgements and which will include the sequence number for the next packet it expects to receive. For example acknowledgment acknowledges receipt of packet and includes the lowest sequence number that it has not yet received mainly sequence number 2 for packet . Acknowledgement which acknowledges receipt of packet will also indicate the sequence number of 2 if packet has not yet been received as 2 would still be the lowest un received sequence number.

If sending device receives a sequence number of 2 in a predetermined number of acknowledgement messages such as messages and it may assume that packet has been lost and may proceed to resend packet . Sending device may also modify the manner in which it sends packets when it is determined that a packet has been lost. For example sending device may assume that network congestion is the cause of the packet loss rate and sending device may resize a congestion window to attempt to alleviate network congestion to improve the packet loss rate. On the other hand if the packet loss rate is not due to network congestion resizing the congestion window will not remedy the lost packet problem and may further degrade network performance. In order to avoid this problem sending device is configured to include random packet loss awareness unit .

Random packet loss awareness unit is configured to determine when a packet loss rate exceeds a random packet loss rate caused by a lossy portion of network . If the packet loss rate is below the random loss rate caused by the lossy portion of the network random packet loss awareness unit will determine that the packet loss is not due to network congestion and therefore packet transmission will not be modified to account for network congestion. On the other hand if the packet loss rate exceeds the random packet loss rate random packet loss awareness unit may determine that network congestion is a contributing factor in the packet loss and may direct sender to take steps necessary to alleviate or compensate for the network congestion. Specifically random packet loss awareness unit will determine whether the following expression is true or not Actual Packet Loss Rate

If the above listed expression is true the random packet loss awareness unit may determine that at least some portion of the actual packet loss rate is due to network congestion. Accordingly random packet loss awareness unit can take appropriate action to alleviate the congestion. On the other hand if the above listed expression is not true random packet loss awareness unit may determine that the actual packet loss rate is not due to congestion.

For example portion of network may be embodied in a wireless network portion such as a Wi Fi network a third generation wireless network e.g. 3G GPRS HPSA or a fourth generation wireless network e.g. 4G LTE . These wireless networks are expected to see some packet loss regardless of the amount of traffic currently being handled by network . Specifically wireless networks are subject to signal to noise ratio SNR optimization to save energy at wireless transceivers and therefore the transceivers will generally experience random packet loss. If portion is embodied in a 3G wireless network users may experience 1 packet loss regardless of network congestion. Similarly if portion is embodied in an LTE wireless network users may experience a random packet loss rate of between 10and 10percent. Furthermore mobile devices may experience greater random packet loss rates due to the physical location of the mobile device. Because these loss rates are not due to network congestion the loss rate will not be improved by altering the rate or number of messages sent over network .

Furthermore when congestion compensation techniques are applied in response to random packet losses network performance may be degraded instead of improved. For example even when the network path has no congestion if congestion compensation techniques are applied in response to a 1 random packet loss rate such as those present in 3G networks the congestion window may be reduced to a value of less than 12.2 packets in equilibrium and limit throughput over the network to less than 0.73 Mbps. If the random packet loss rate approaches or exceeds 10 as may happen depending on the geographic location of a wireless device the congestion window will drop to less than 3.87 packets in equilibrium and throughput will drop to less than 0.23 Mbps. This drop in throughput due to the congestion compensation may result in significant under utilization of wireless links. Furthermore the drop in throughput may result in failures of certain applications such as video streaming even though the network should be able to provide sufficient throughput. For example video streaming applications may experience oscillation of video quality or even complete failure over a network which is more than capable of supporting the video stream.

Accordingly random packet loss awareness unit would be aware of the expected random packet loss rate for network portion and utilize this knowledge to control sending device to compensate or not compensate for network congestion as appropriate. Depending on the implementation random packet loss awareness unit may be made aware of the expected packet loss rate through different means. For example random packet loss awareness unit may be manually configured with the expected packet loss rate the sending device may include an application programming interface API which locally determines and reports the expected random packet loss rate to the random packet loss awareness unit or the random packet loss awareness unit may have the expected random packet loss rate reported to it through out of band signaling messages.

With reference now made to depicted therein is an example sender device including random packet loss awareness unit which utilizes a combination of manual configuration and signaling. Specifically the random packet loss awareness unit may be manually configured with information indicating the type of lossy network portion within network . Accordingly the random packet loss awareness unit will expect at least a minimum packet loss rate such as the 1 packet loss rate of a 3G network. This manual configuration may be supplemented through an API that receives reports of dynamic packet loss rates from the local links in network for network portions and . According to the example of network links use out of band signaling messages to provide dynamic packet loss rates for individual portions and of network . For example signaling message may provide sender with dynamic packet loss rate information for network portion . Similarly message provides dynamic packet loss rate information for portion while message provides dynamic packet loss rate information for portion .

Upon receipt of signaling messages random packet loss awareness unit may determine the actual packet loss rate as well as the expected random packet loss rate. By comparing the two values random packet loss awareness unit is able to appropriately compensate for packet losses over network .

Referring now to depicted therein is a flowchart depicting a process of providing congestion control with awareness of random packet losses. The process begins in block in which messages are sent from a first network device to a second network device across a network. The network includes a network portion which includes an expected random packet loss rate. For example the network may include a wireless portion which has an expected random packet loss rate due to SNR optimization.

In block the actual packet loss rate is compared to the expected random packet loss rate. The expected random packet loss rate may be predetermined based on the type of network link in which the network portion having the expected random packet loss rate is embodied. In other examples the expected random packet loss rate may be dynamically calculated by the sending device or through signaling messages sent to the sending device from one or more network links. The actual packet loss rate may be determined according to the content of acknowledgment messages received by the sending device or in response to retransmission timeouts RTOs as will be described below with reference to .

In block a determination is made as to whether or not the actual packet loss rate exceeds the expected random packet loss rate. Specifically it is determined that the actual packet loss rate is greater than the expected random packet loss rate. In block network congestion is compensated for in response to the determination.

With reference now made to depicted therein is a flowchart illustrating a process of providing congestion control with awareness of random packet losses in a Layer 4 network which includes a Layer 2 portion having an expected random packet loss rate. Furthermore the Layer 4 network is configured to retransmit packets in response to receiving a predetermined number of duplicate acknowledgement messages.

The process begins in block where a predetermined number of duplicate acknowledgement messages are received in this case three duplicate acknowledgement messages. As previously discussed above with reference to the duplicate acknowledgement messages may serve as an indication that packets are being lost between the sending and receiving devices. According to the example of if three acknowledgement messages are received which all indicate the same packet as the next expected packet it may be determined that the indicated packet has been lost.

In block the packet indicated by the duplicate acknowledgment messages is retransmitted to the receiving device. This retransmission is considered a fast retransmission because the sending device does not wait for a retransmission timer to time out before retransmitting the packet. Instead the packet is retransmitted as soon as the three duplicate acknowledgment messages are received. Because the three duplicate acknowledgement messages will often be received prior to expiration of the transmission timer the retransmission in response to the duplicate acknowledgement messages is considered fast relative to other retransmission techniques.

Next if the sending device was not operating with awareness of expected random packet loss rates in its congestion compensation methods the sending device may immediately compensate for network congestion. According to the present example the actual packet loss rate is first calculated in step . Specifically the Layer 4 packet loss rate L4 PLR is calculated. According to the example of Layer 4 packet loss rate is calculated in response to the fast retransmission of block . According to other examples the Layer 4 packet loss rate may be calculated in response to fast retransmitting a predetermined number of packets or the Layer 4 packet loss rate may be calculated at predetermined intervals.

In step the Layer 4 packet loss rate is compared to the expected random packet loss rate which according to the example of is the Layer 2 packet loss rate L2 PLR . Specifically it is determined whether or not the Layer 4 packet loss rate is greater than the Layer 2 packet loss rate. If the Layer 4 packet loss rate is less than or equal to the Layer 2 packet loss rate it may be determined that the Layer 4 packet loss rate is simply due to the random losses in the Layer 2 portion of the network and therefore performing congestion compensation would be ineffective. Accordingly the process would continue to block where the process ends until duplicate acknowledgment messages indicate that another packet has been lost.

On the other hand if the Layer 4 packet loss rate is greater than the Layer 2 packet loss rate it may be determined that network congestion contributes at least partially to the Layer 4 packet loss rate. Accordingly the process proceeds to block where a congestion window cwnd and the slow start threshold ssthresh are reduced according to a slow start congestion compensation method. Specifically slow start congestion compensation avoids sending more data than a network is capable of handling by decreasing the number of packets that can be sent without receiving an acknowledgement decreasing the congestion window and decreasing the threshold for when more congestion compensation or avoidance should be performed decreasing the slow start threshold . Upon completion of the congestion compensation or avoidance of block the process ends in block and the sending device continues sending packets until another packet is lost.

With reference now made to depicted therein is flowchart illustrating a process similar to that illustrated in flowchart of . The process of flowchart differs from that of in that the sending device waits for retransmission timeouts RTOs before determining a packet has been lost. Accordingly the process begins in block where a packet RTO timer expires. In response to expiration of the timer the sending device retransmits the packet. Next if the sending device was not operating with awareness of expected random packet loss rates in its congestion compensation methods the sending device may immediately compensate for network congestion. Instead because the sending device does implement or operate with awareness of expected random packet loss rates the runtime Layer 4 packet loss rate is calculated in step . In step it is determined whether or not the Layer 4 packet loss rate exceeds the expected random packet loss rate in this case the Layer 2 packet loss rate. If the Layer 4 packet loss rate is less than or equal to the expected random Layer 2 packet loss rate the process ends at step without any congestion compensation or avoidance being performed.

If on the other hand the Layer 4 packet loss rate exceeds the expected Layer 2 packet loss rate network congestion compensation and or avoidance is performed in step . Specifically because the Layer 4 packet loss rate exceeds the expected Layer 2 packet loss rate it may be determined that network congestion contributes at least partially to the Layer 4 packet loss rate. In response the sending device will reduce the congestion window and slow start threshold in order to compensate for the network congestion. Once the congestion window and slow start threshold are reduced the process completes in block until another lost packet is detected.

With reference now made to depicted therein is a plurality of example networks over which packets are sent from sending device to receiving device . As illustrated the entirety of network between sending device and receiving device may be comprised of wired or optical networks without any intervening wireless network portions. Nevertheless so long as some or all of network has an expected random packet loss rate the techniques described herein will apply. For networks and the wireless or lossy portion of the network does not need to be located at an intermediate network link. Instead the wireless or lossy portion of the network may be local to either of sending device or receiving device . Finally as illustrated networks are not limited to a single wireless or lossy portion. Instead each of networks is constructed from two or more wireless or lossy portions.

Turning to depicted therein is a network enabled device configured to implement network congestion compensation including random packet loss awareness such as sending device . The sending device comprises one or more network interface units e.g. network interface cards to enable communication over a network processor s bus and memory . The memory contains software instructions for operating system and random packet loss awareness unit .

Memory may comprise ROM RAM magnetic disk storage media devices optical storage media devices flash memory devices electrical optical or other physical tangible e.g. non transitory memory storage devices. The processor is for example a microprocessor or microcontroller that executes instructions including instructions contained random packet loss awareness unit . Thus in general the memory may comprise one or more tangible non transitory computer readable storage media e.g. a memory device encoded with software comprising computer executable instructions and when the software is executed by the processor and in particular random packet loss awareness unit it is operable to perform the operations described herein in connection with . Specifically random packet loss awareness unit includes instructions that allow processor to implement congestion compensation including expected random packet loss awareness.

By implementing the techniques and devices described above networks may achieve improved Transmission Control Protocol Stream Control Transmission Protocol TCP SCTP throughput and network utilization for better user experiences particularly when the Layer 4 end to end path includes a wireless link or other portion which experiences random packet losses particularly in Layer 2 of the OSI model. Furthermore the techniques and devices described herein may be applied as an enhancement to any existing TCP and SCTP congestion control mechanism or other Layer 4 protocols . Specifically these techniques may be particularly advantageous in Layer 4 networks supporting Selective Acknowledge SACK e.g. TCP SACK and SCTP which allows for more accurate runtime estimation of the Layer 4 packet loss rate. Furthermore the when signaling is implemented to dynamically determine Layer 2 random packet loss the Layer 2 packet loss rate can be advantageously collected instead of relying solely on acknowledgement messages generated at the last hop of the transmission path.

