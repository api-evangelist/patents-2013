---

title: System and apparatus having an application programming interface for flexible control of execution ultrasound actions
abstract: Apparatus to control and execute ultrasound system actions includes API that includes API procedure, processor coupled to API, adaptive scheduler, and memory. Adaptive scheduler includes beamer to generate signals, probe interface to transmit the signals to at least one probe unit and to receive signals from the at least one probe unit, and receiver to receive and process the signals received from the probe interface. Memory stores instructions, which when executed, causes processor to receive task list including task actions. Processor may execute API procedure to generate scan specification that is a data structure that includes task list. Processor may execute API procedure to identify at least one of: a probe required to perform the task actions, a beam required to perform the task actions and requirements and parameters associated with the beam, or a format of a beam firing result. Other embodiments are described.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09529080&OS=09529080&RS=09529080
owner: White Eagle Sonic Technologies, Inc.
number: 09529080
owner_city: Santa Clara
owner_country: US
publication_date: 20131205
---
This application claims the benefit pursuant to 35 U.S.C. 119 e of U.S. Provisional Application No. 61 746 096 filed on Dec. 26 2012 which application is specifically incorporated herein in its entirety by reference.

This application claims the benefit pursuant to 35 U.S.C. 119 e of U.S. Provisional Application No. 61 734 067 filed on Dec. 6 2012 which application is specifically incorporated herein in its entirety by reference.

This application claims the benefit pursuant to 35 U.S.C. 119 e of Provisional U.S. application Ser. No. 61 734 291 filed on Dec. 6 2012 which application is specifically incorporated herein in its entirety by reference.

Embodiments of the invention generally relate to an ultrasound apparatus providing an application programming interface for controlling the execution of multiple simultaneous functions and dynamically changing beam firings.

Today s ultrasound systems have limited fixed functionality and require sophisticated user control. Most ultrasound systems cannot provide multiple simultaneous functions. The ultrasound systems that can provide multiple simultaneous functions have the functions as fixed functions that are not flexible to user demands or need for adaptation. Accordingly in these systems a selection between different functions may be available however no deviations that relate for example to timing of the fixed functions is possible. For example in the case of ultrasound systems it may be possible to have a Doppler beam and a B mode beam. The combined functions of the different beams are provided as preprogrammed solutions. These solutions are selected for example by using a touch of a button. However there is no flexibility provided to the user of the system for changes that require the reconfiguring and reshuffling of the timed scheduled actions that are included in the preprogrammed solutions.

In the following description numerous specific details are set forth. However it is understood that embodiments of the invention may be practiced without these specific details. In other instances well known circuits structures and techniques have not been shown to avoid obscuring the understanding of this description.

In the description certain terminology is used to describe features of the invention. For example in certain situations the terms component unit module and logic are representative of hardware and or software configured to perform one or more functions. For instance examples of hardware include but are not limited or restricted to an integrated circuit such as a processor e.g. a digital signal processor microprocessor application specific integrated circuit a micro controller etc. . Of course the hardware may be alternatively implemented as a finite state machine or even combinatorial logic. An example of software includes executable code in the form of an application an applet a routine or even a series of instructions. The software may be stored in any type of machine readable medium.

A sophisticated ultrasound system supports multiple simultaneous functions such as imaging blood flow measurement and heartbeat monitoring. The ultrasound system performs these functions by executing sequences of actions such as firing beams receiving beam data and moving mechanical arms. These actions frequently have rigorous real time requirements. The ultrasound system performs functions by executing one or more parallel tasks where each task requires a sequence of actions. The ultrasound system cannot perform conflicting actions at the same time. Accordingly in some embodiments actions conflict if they require the same resource e.g. the same transmitter the same receiver or the same area of memory. In other embodiments actions conflict if the ultrasound beams from two different transmitters travel through the same area of the target and make it impossible for a receiver to identify the source.

Further some actions depend on events that cannot be accurately predicted. For example the system may need to wait for a mechanical arm to complete its movement before it fires the next beam. The system must wait for a laser to be charged before it can fire a laser beam. The time taken to charge a laser varies significantly and cannot be predicted to the required accuracy. The ultrasound system indicates the completion of mechanical movement or laser charging by signaling events. Thus some actions may depend on asynchronous events.

Accordingly in some embodiments the ultrasound system supports changes to the list of parallel tasks. For instance a human user may view an ultrasound image and request new functions to be performed. An automated system may change the list of tasks in response to analysis of the ultrasound results. In some embodiments the automated system uses the adaptive scheduler to schedule actions from the updated task list. Scheduling the actions may include signaling to a processor to send commands to other units to perform the actions. The adaptive scheduler may be implemented in hardware software firmware or any combination thereof as discussed below. In prior ultrasound systems a skilled human operator is required to analyze results and modify ultrasound parameters. For example an ultrasound operator may wish to locate a human heart valve monitor the heart rate and measure the shape of the heart valve movement. In one embodiment of the invention the automated system employs analysis software to monitor the ultrasound results. The analysis software determines the required task list changes and signals an appropriate event to the adaptive scheduler. The analysis software modifies the task list while searching for the heart valve. The analysis software starts new tasks when the ultrasound system locates the heart valve. Thus the ultrasound system needs to respond to events that change the task list e.g. when it receives an event indicating that the heart valve is located from the analysis software or from the end user . In this example the event may be a signal received by the adaptive scheduler that indicates that the heart valve is located. The signal may be a single bit digital signal wherein the high signal 1 may indicate that the heart valve is located.

Accordingly in one embodiment of the invention the adaptive scheduler further described below handles the scheduling of task actions. Each task to be performed may include a plurality of task actions. For instance a task to be performed by the ultrasound system may be measuring the blood flow. The task actions included in the task of measuring the blood flow may include firing one of the beams and collecting the data e.g. ultrasound data from the beam. The adaptive scheduler adapts the schedule of task actions to ensure that actions do not conflict. When adapting the schedule of task actions if actions are found to conflict in one embodiment the adaptive scheduler ensures that high priority actions are handled prior to lower priority actions. The adaptive scheduler handles events. The events may be signals received by the adaptive scheduler that indicate the completion of certain tasks or task actions. For example when an external unit e.g. robot arm has completed the movement required the event received may be a signal that indicates that the external unit has completed the movement. The events may also be a signal received from an input device that indicates that a list of tasks has been inputted by the user. In some embodiments events can cause the adaptive scheduler to pause task actions modify task parameters add or delete tasks and to invoke software procedures such as analysis software for locating a heart valve. In other embodiments in response to events the adaptive scheduler sends a signal to the processor to send commands to probe units or external units to start executing a task action. For instance in response to receiving an event that indicates that data has been collected from a first beam associated with a higher priority the adaptive scheduler may signal to the processor to send a start command to the second beam of a lower priority. In some embodiments the adaptive scheduler sends the commands to the probe units or external units instead of the processor.

In one embodiment an ultrasound apparatus provides an application programming interface that allows an application program to control multiple simultaneous functions and make dynamic or adaptive changes during ultrasound beam firings.

In one embodiment the processing unit sends probe control commands telling the probe units when to fire specific beams and when to collect data. Such operation as explained in further detail herein below is performed for example from a memory containing instructions that are executed by the processing unit . A memory may also be included in the adaptive scheduler . The memory that may include one or more different types of storage such as hard disk drive storage nonvolatile memory and volatile memory such as dynamic random access memory. The memory may also include a database that stores data received from the probe units and the external units . The memory may also store instructions e.g. software firmware which may be executed by the processing unit . As multiple operations of the ultrasound system may be needed e.g. firing beams at various times a task list is generated and altered by the adaptive scheduler to address the combination of actions that are desired by the user of the system further described herein. This embodiment of the invention provides for flexibility that is not achievable in prior art systems. The processing unit is configured to further retrieve data collected by a probe unit data. The processing unit takes input commands from one or more input devices . The input devices may be a keyboard mouse or touch screen that allows a user to input commands.

The input devices typically provide high level commands to the processing unit which in turn under control of the embedded instruction memory performs at least the tasks described in greater detail herein below. The processing unit may output at least a result respective of the data collected to for example a display unit that is coupled to the processing unit . A display unit may be replaced or augmented by a storage unit not shown to allow the storing of the collected data for future use. The display unit may show an image a video comprised of a series of image frames text as well as combinations thereof.

While a single adaptive scheduler is referenced herein the use of a plurality of adaptive schedulers is possible without departing from the scope of the invention. As discussed above the adaptive scheduler may be implemented in hardware for example through a configurable circuit or in memory of the system where the memory is loaded with instructions which when executed by the processor causes the processor to perform methods of adaptively scheduling the task actions or cause the processor to control the adaptive scheduler or adaptive schedulers. In one embodiment cycle accurate timing for the firing of the beams is provided by the system based at least in part on the directions or signals received from the adaptive scheduler. In some embodiments the adaptive scheduler may be used to configure at least a probe unit.

In an embodiment the ultrasound system may control one or more external units such as lasers robot arms and motors. The external units may also require time synchronization with probe units operations. In one embodiment the processing unit sends external units control commands based on the adaptive scheduler s selected task action as further explained below. For example the processing unit may send a control command telling a robot arm e.g. external unit to move a probe upon receipt of a signal from the adaptive scheduler that received an event indicating that a unit of data has been collected.

The ultrasound system may receive a specification of ultrasound system tasks and events through for example input devices . The ultrasound system generates a task list identifying a sequence of task actions. Some of the task actions may have real time constraints and some may depend on events. For instance some task actions may not start until an event is received by the adaptive scheduler . For example the task action may be to move a robot arm which cannot begin until an event is received that indicates that the data from a beam is finished being collected. In one embodiment the ultrasound system computes the time needed to complete each task action in the specification received. The ultrasound system generates a list of the task actions using a linked list in memory . In some embodiments the specification may include tasks and events that are associated with multiple beam firings of different types. A beam firing task action may require a setup time which is the amount of time needed to configure the transducer before firing a beam. The setup time may depend on the transducer. Different beam firing types are called modes. Switching modes for example switching from B Mode mode to color flow Doppler typically requires a mode switching delay. The switching delay acts as an additional setup time. Each beam firing task action has a firing time also known as pulse duration which is the amount of time that the transducer outputs ultrasound waves. The firing time depends of the beam type and the purpose of the beam firing. For instance a shorter firing time can give a better quality image. Doppler beams have a longer firing period than B Mode beams. Each beam also has a collection time which is the time needed to receive the reflected or pass through ultrasound waves. The ultrasound propagation time depends on the medium through which the beam passes. The collection time depends on the depth of the scan. The ultrasound system may need to distinguish the source of the collected data. Accordingly the ultrasound system may avoid two beams firing at the same time. A dead time time interval between data collection and the next beam firing may also be introduced as needed.

Some beam types have a pulse repetition period which is the time between successive firings. Successive firings lead to the construction of a single image. Repeating this sequence of firings can generate multiple images. The ultrasound system may for instance have a requirement to generate 60 images per second. Doppler beams have a pulse repetition period whereas B mode scan beams do not.

Some beam firings need to be consecutive in time. Using multi focal zones allows the ultrasound system to get significantly better image quality. The ultrasound system scans with beams focused at different distances. The ultrasound system may scan with the first beam focused at 0 5 centimeters cm a second beam focused at 5 10 cm and a third beam focused at 10 15 cm. The data collected from the three different levels may be combined to form one line of an image. This beam firing sequence can be repeated using different collectors to generate a complete image. The ultrasound system may need to schedule the actions that generate a single line consecutively.

In one embodiment the processing unit receives an input specification including a list of tasks or task list to be performed that includes ultrasound tasks and external unit tasks. Each ultrasound task may include for example the beam type the number of beam firings the setup time the firing time the dead time the pulse repetition period the desired images per second rate the number of multi focal zones and other timing constraints. Each external unit function e.g. an external unit task may include for example desired external unit task actions and the desired external unit task actions timing constraints. The desired external unit task action may be for example a movement of a robot arm. The processing unit or the adaptive scheduler processes each task description and produces a list of sequential task actions such as beam firing actions and data collection actions. The task list may also include a plurality of tasks that are associated with a plurality of beams of differing priority levels. In some embodiments the plurality of tasks includes at least one of a photoacoustic laser firing task and an electrocardiogram ECG task.

In one embodiment the processing unit creates a schedule of timing actions task list and selects a task action following the method described herein. It should be understood that the processing unit in one embodiment may schedule the dependent or independent operation of a plurality of probe units coupled to the probe interface such that their beam firing is either dependent or independent of each other. Each of the probe units may have for example its own task list of ultrasound actions that may be adaptively modified by the adaptive scheduler . In another embodiment a single task list that may be adaptively modified by the adaptive scheduler may be used to cause the firing of beams by at least one of the plurality of probe units . Similarly a plurality of external units may be coupled to the probe interface illustrated in or in one embodiment a dedicated interface not shown used to couple a plurality of external devices to the processing unit . In one embodiment the adaptive scheduler may use one or more task lists to cause the operation of the one or more probe units and the one or more external units . These operations being performed independent or dependent of each other. As discussed above the ultrasound system may receive a specification of ultrasound system tasks and events through for example a feedback resulting from measurements made by the system or from input devices e.g. a change requested by a user of the system by entering an input . These changes may occur in real time as the system executes the task list including the tasks that may include tasks and task actions that were earlier entered to the system . It should be further understood that task actions included in the task lists may be added as well as removed in real time by the adaptive scheduler and the task actions included in the task lists may also be added and removed when the system is off line for reconfiguration.

An application programmer develops an ultrasound application program by writing source code that references ultrasound library procedures defined by an application programming interface. The source code is written in a computer language such as C or C . The application programmer uses programming development tools that include an editor a compiler and a linker. The programming development tools run on a computer system. In one embodiment the application programmer uses programming development tools that run on processing unit . In one embodiment the generated application program is stored in the memory and executed by processing unit or processing element .

The processing unit may include one or more ultrasound platforms. Each ultrasound platform may operate independently and may be controlled through the application programming interface API via API procedures specified and included in the API. In one embodiment the processing unit includes multiple hardware schedulers e.g. adaptive scheduler . Each of the hardware schedulers may be a separate ultrasound platform controlling separates probes and external units.

The following embodiments of the invention may be described as a process which is usually depicted as a flowchart a flow diagram a structure diagram or a block diagram. Although a flowchart may describe the operations as a sequential process many of the operations can be performed in parallel or concurrently. In addition the order of the operations may be re arranged. A process is terminated when its operations are completed. A process may correspond to a method a procedure etc.

In S processor may execute an API procedure to define a callback procedure that will receive the beam firing results. The callback procedure may cause the processor to receive imaging data that may then be transmitted to the display and stored on a computer readable medium or sent to a separate external device. In S the processor may execute an API procedure to signal to the ultrasound platform e.g. the adaptive scheduler to start execution of the task actions included in the scan specification. In executing the task actions the ultrasound platform may initialize the appropriate hardware start beam firing and start data collection. In S the processor may execute API procedures to dynamically change the task actions included in the scan specification. The changes to the task actions may be based on end user input based on analysis of the beam firing data results by the processor based on hardware status determined by the processor or based on predefined program behavior e.g the application program stored in memory including instructions causing the processor to change the task actions . In S the processor may decide if more changes to the task actions are to be made. The process continues to S if the processor determines that more task action changes are required and the process continues to S if the processor determines that more parameter changes are not required. At S the processor decides if execution of the task actions in the scan specification should be stopped. The processor may stops execution of the task actions if a stop condition is detected. The process continues to S if a stop condition is not detected by the processor . Detecting stop conditions include for example receiving an end user input to stop detecting a platform error detecting that a predetermined amount of time has elapsed etc. In one embodiment the processor may call an API procedure to stop the ultrasound platform in order to stop execution of the task actions. In some embodiments the process may proceed to S before S.

An embodiment of the invention may be a machine readable medium having stored thereon instructions which program a processor to perform some or all of the operations described above. A machine readable medium may include any mechanism for storing or transmitting information in a form readable by a machine e.g. a computer such as Compact Disc Read Only Memory CD ROMs Digital Versatile Disc DVD Flash Memory Read Only Memory ROMs Random Access Memory RAM and Erasable Programmable Read Only Memory EPROM . In other embodiments some of these operations might be performed by specific hardware components that contain hardwired logic. Those operations might alternatively be performed by any combination of programmable computer components and fixed hardware circuit components.

While the invention has been described in terms of several embodiments those of ordinary skill in the art will recognize that the invention is not limited to the embodiments described but can be practiced with modification and alteration within the spirit and scope of the appended claims. The description is thus to be regarded as illustrative instead of limiting. There are numerous other variations to different aspects of the invention described above which in the interest of conciseness have not been provided in detail. Accordingly other embodiments are within the scope of the claims.

