---

title: Relay device, relay method, and non-transitory computer readable medium
abstract: A relay device includes a communication unit, a first conversion unit, a second conversion unit, and a controller. The communication unit communicates with a client device and a service providing device. The first conversion unit performs a first conversion process for performing conversion between a language interpretable by each client device and a language interpretable by the relay device. The second conversion unit performs a second conversion process for performing conversion between a language interpretable by each service providing device and the language interpretable by the relay device. The controller performs control so that data sent from the client device is subjected to the first conversion process and then the second conversion process before transmitted to the service providing device and data sent from the service providing device is subjected to the second conversion process and then the first conversion process before transmitted to the client device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09148492&OS=09148492&RS=09148492
owner: FUJI XEROX CO., LTD.
number: 09148492
owner_city: Tokyo
owner_country: JP
publication_date: 20130228
---
This application is based on and claims priority under 35 USC 119 from Japanese Patent Application No. 2012 148757 filed Jul. 2 2012.

The present invention relates to a relay device a relay method and a non transitory computer readable medium.

Services in which server devices on networks in place of client devices perform various kinds of information processing such as storing data and converting a data format are called cloud services or cloud computing services.

According to an aspect of the invention there is provided a relay device including a communication unit a first conversion unit a second conversion unit and a controller. The communication unit communicates with a client device and a service providing device that provides a service to the client device. The first conversion unit performs a first conversion process for performing conversion between a language interpretable by each of plural client devices and a language interpretable by the relay device. The second conversion unit performs a second conversion process for performing conversion between a language interpretable by each of plural service providing devices and the language interpretable by the relay device. The controller performs control so that when the communication unit receives data sent to the service providing device from the client device the first conversion unit performs the first conversion process on the data the second conversion unit then performs the second conversion process on the data and the communication unit transmits data obtained after the first conversion process and the second conversion process have been performed to the service providing device and so that when the communication unit receives data sent to the client device from the service providing device the second conversion unit performs the second conversion process on the data the first conversion unit then performs the first conversion process on the data and the communication unit transmits data obtained after the second conversion process and the first conversion process have been performed to the client device.

Each of the cloud service providing devices and is a device that provides so called cloud services and is an example of a service providing device according to an exemplary embodiment of the present invention. The term cloud service as used herein refers to a service in which a server device on a network rather than a client device performs various kinds of information processing such as storing data providing data and converting a data format. The client devices and are information processing devices that receive cloud services provided from the cloud service providing devices and . In this exemplary embodiment the client devices and may be image forming devices such as printers image reading devices such as scanners or the like. The network is a communication network via which the client devices and the PCs and the relay device and the cloud service providing devices and are connected to one another and may be for example the Internet.

When cloud services are provided from the cloud service providing devices and to the client devices and the relay device relays data exchanged between the cloud service providing devices and and the client devices and . More specifically for example when image data to be stored is transmitted from any of the client devices and the relay device transfers the image data to any of the cloud service providing devices and or when image data to be output is transmitted from any of the cloud service providing devices and the relay device transfers the image data to any of the client devices and . Alternatively while the image data described above is transmitted and received between the cloud service providing devices and and the client devices and the relay device calls a service other than the service for transmitting and receiving the image data described above such as a service for performing image recognition called optical character recognition OCR or a service for converting the format of the image data .

The client devices and have various resources implemented thereon. For example some image forming devices serving as client devices may have lower display capabilities than general PCs and even client devices included in the same category of image forming device may have different processing capabilities and different types of formats of image data to support. Because of different developers or administrators the cloud service providing devices and have various specifications such as different interpretable commands communication protocols and languages used to exchange data between devices such as application programming interfaces APIs . For this reason the relay device is configured to relay data such as control data image data and files exchanged between the client devices and and the cloud service providing devices and without being affected by the difference in resource of the client devices and or the difference in specification of the cloud service providing devices and

Single sign on is available as a mechanism for authentication processing in the relay of data of this type. Single sign on is a process in which a relay device or the like holds plural pieces of authentication information registered in the individual cloud services namely user names and passwords in association with each other and the relay device is responsible for logging in the individual cloud services. In this mechanism however since the relay device holds authentication information namely personal information such as user names and passwords the risk of such personal information leaking to any third party may not be undeniable. Accordingly the relay device is configured to relay data from the client devices and to the cloud service providing devices and without holding user names and passwords registered by the users in the cloud service providing devices and

The number of devices constituting the communication system is not limited to that illustrated in . The hardware configurations and operations of the client devices and are substantially equivalent and therefore the client devices and will be hereinafter collectively referred to as the client devices or each individually as the client device unless individually identified. The PCs and and the cloud service providing devices and will also sometimes be collectively referred to as the PCs and the cloud service providing devices or each individually as the PC and the cloud service providing device respectively.

Next an operation according to an exemplary embodiment will be described with reference to . In the following description by way of example the client device illustrated in receives a data storage service provided from the cloud service providing device

In the controller of the relay device needs to register itself in federation with one of the cloud service providing devices that provides a service to the client device . The term federation as used herein means that the relay device and the cloud service providing devices federate with each other. In other words the term federation means the state that credential is established between the relay device and the cloud service providing devices . The controller of the relay device requests the cloud service providing device to register itself in federation with the relay device step S . The controller of the relay device sends device identification information for identifying the relay device and a federation registration request to the cloud service providing device . The cloud service providing device transmits federation acceptance information indicating that federation has been accepted to the requesting relay device step S . In this case the cloud service providing device stores the device identification information identifying the relay device in association with information indicating acceptance of federation.

Then the user operates the PC to send a request for access to the cloud service to the relay device . In response to the access request the controller of the relay device transmits data for example Uniform Resource Locator URL of the site for access to the cloud service for displaying an access screen used for guiding access to the cloud service to the PC and the PC causes the access screen to be displayed on the display by using a function of a web browser or the like. The access screen is written in a hypertext markup language HTML or any other suitable language. The user enters their user ID and an input to access the desired cloud service providing device step S . Here as an example the user tanaka enters the user ID tanaka to perform user authentication at the relay device .

The controller of the relay device may transmit to the PC information indicating that access to the cloud service providing device with which the relay device has registered itself in federation in advance is possible and may cause a screen that provides direct access to the cloud service providing device to be displayed by using the function of the web browser of the PC to allow the user to issue an instruction to access the cloud service providing device on the screen.

The relay device may register itself in advance in federation with the plural cloud service providing devices and . In this case the controller of the relay device may cause a screen for allowing the user to select which of the plural cloud service providing devices and to access to be displayed on the PC . When the user selects the cloud service providing device they wish to access the PC transmits to the relay device the user ID and a request for access to the cloud service providing device step S . Upon receiving from the PC the user ID and the request for access to the cloud service providing device the controller of the relay device transfers the access request received from the PC to the cloud service providing device registered in advance in federation with the relay device step S . In this case the controller of the relay device stores the user ID transmitted together with the access request from the PC in the memory in association with information indicating that the access request has been transferred to the cloud service providing device

Upon receiving the access request the cloud service providing device checks the login state step S . If a login account corresponding to the access request does not exist the cloud service providing device generates data for displaying a login request screen step S and transmits the generated data to the PC that has sent the access request. The PC displays a login screen for login to the cloud service providing device by using the function of the web browser step S .

The user enters the login account or the user name and the password as authentication information used by the cloud service providing device on the login screen for login to the cloud service providing device which is displayed on the PC step S . The login account entered by the user or the user name and the password is transmitted to the cloud service providing device step S . Here the user tanaka enters the user name tanaka cloud and the password aaaa which are authentication information for login to the cloud service providing device

The cloud service providing device performs authentication processing using a user database illustrated in based on the received login account namely the user name and the password. If it is determined that login is successful step S the cloud service providing device generates screen data for prompting the user to input whether or not access is to be granted to permit the relay device that has registered itself in advance in federation with the cloud service providing device and that has transferred the access request to access the cloud service providing device and transmits the generated screen data to the PC step S .

The PC displays an access permission input screen based on the received screen data for inputting access permission by using the function of the web browser. When the user inputs access permission step S the PC transmits an access permission instruction to the cloud service providing device step S .

Upon receiving an access permission instruction from the PC the cloud service providing device issues an access token for accessing the cloud service providing device to the relay device that has transferred the access request and that has registered itself in advance in federation with the cloud service providing device and transmits the access token to the relay device step S . The access token is privilege information granted to the login account by the cloud service providing device and includes for example account information and information indicating access privilege. When an access request is made together with the access token the cloud service providing device grants access with the privilege of the login account corresponding to the issued access token. Here if the user name tanaka cloud and the password aaaa entered by the user tanaka which are authentication information for login to the cloud service providing device are authenticated the access token 1234abcd corresponding to the account is issued and transmitted to the relay device registered in federation with the cloud service providing device

The controller of the relay device stores the access token in the memory in association with the user ID stored in step S in a manner illustrated in step S . Here the user ID tanaka which is information with which the user tanaka accesses the relay device and the access token 1234abcd issued in response to successful authentication of login to the cloud service providing device by the user tanaka and transmitted to the relay device are stored in association with each other and are stored in the manner illustrated in . Through the process illustrated in described above the relay device has access privilege to the cloud service providing device specified by the user ID.

Next referring to the user inputs their user ID to the client device by for example causing the client device to read a card medium storing the user ID and further operates the operation unit to make a request for a list of cloud services. The controller of the client device accepts the operation and transmits a service list request to the relay device step S . In response to the request the controller of the relay device transmits a service list to the client device step S . When the user performs an operation of specifying a data storage service from the service list displayed on the display of the client device the controller of the client device accepts the operation step S and transmits a request for access to the data storage service to the relay device step S .

Upon receiving the access request the controller of the relay device performs conversion processing step S . Specifically the first abstraction I F unit performs a process for converting a language interpretable by the client device into an intermediate language interpretable by the controller of the relay device and the second abstraction I F unit performs a process for converting the intermediate language interpretable by the controller of the relay device into a language interpretable by the cloud service providing device . The access request subjected to the conversion processes described above is transmitted to the cloud service providing device from the communication I F unit associated with the cloud service providing device after an access token corresponding to the user ID is added to the access request step S . After verifying the validity of the access token the cloud service providing device transmits information on a folder list in response to the access request to the relay device step S . Specifically since the cloud service providing device has issued an access token concurrently with the successful login of the user the cloud service providing device permits the data storage service to be provided to the user whose access token has been validated and transmits information on a list of folders available to the user to the relay device .

Upon receiving the information on the folder list the controller of the relay device performs conversion processing step S . Specifically the second abstraction I F unit performs a process for converting the language interpretable by the cloud service providing device into the intermediate language interpretable by the controller of the relay device and the first abstraction I F unit performs a process for converting the intermediate language interpretable by the controller of the relay device into the language interpretable by the client device . The information on the folder list subjected to the conversion processes described above is transmitted to the client device step S .

The user refers to the folder list displayed on the display of the client device and operates the operation unit to specify a desired folder as a storage location. Then the user performs an operation of causing the image forming reading unit of the client device to read a document. Upon accepting this operation the controller of the client device causes the image forming reading unit to read a document to acquire image data step S . The controller of the client device transmits the acquired image data and a request for storing the image data in the specified folder to the relay device step S . Upon receiving the request and the image data the controller of the relay device performs conversion processing from one language to another step S . Specifically the first abstraction I F unit performs a process for converting the language interpretable by the client device into the intermediate language interpretable by the controller of the relay device and the second abstraction I F unit performs a process for converting the intermediate language interpretable by the controller of the relay device into the language interpretable by the cloud service providing device

Then the data subjected to the conversion processes described above the image data and the request for storing the image data in the folder specified as a storage location is transmitted to the cloud service providing device from the communication I F unit associated with the cloud service providing device after an access token corresponding to the user ID described above is added to the data step S . Upon receiving the request for storing the image data in the folder and the image data which have been converted by the relay device the cloud service providing device verifies the validity of the access token and then stores the image data in the folder step S . Then the cloud service providing device transmits a completion notification indicating that the image data has been stored step S . The controller of the relay device performs conversion processing similar to that in step S on the completion notification step S and then transmits the resulting completion notification to the client device step S . The controller of the client device displays the completion notification on the display .

In the foregoing description by way of example the client device illustrated in receives a data storage service provided by the cloud service providing device . The following description will be made of an example in which the client device prints document data held generated and managed by the cloud service providing device

A data printing service relayed by the relay device enables document data managed by the cloud service providing device to be specified by the client device and relayed by the relay device so that the document data may be printed and output from the client device . Since the cloud service providing device does not have a function for generating print data from document data the relay device acquires document data from the cloud service providing device converts the acquired document data into print data having a format that is printable by the client device and provides the print data to the client device . Thus the document data managed by the cloud service providing device may be printed and output from the client device

The user performs the processing illustrated in in advance to allow the relay device to have access privilege to the cloud service providing device specified by the user ID.

Next referring to the user inputs their user ID to the client device by for example causing the client device to read a card medium storing the user ID and further operates the operation unit to make a request for a list of cloud services. The controller of the client device accepts the operation and transmits a service list request to the relay device step S . In response to the request the controller of the relay device transmits a service list to the client device step S . When the user performs an operation of specifying a data printing service from the service list displayed on the display of the client device the controller of the client device accepts the operation step S and transmits a request for access to the data printing service to the relay device step S .

Upon receiving the access request the controller of the relay device performs conversion processing from one language to another step S . Specifically the first abstraction I F unit performs a process for converting a language interpretable by the client device into an intermediate language interpretable by the controller of the relay device . The information command on the printing request supplied from the client device is also converted into information command which requests that the cloud service providing device acquire document data. Further the second abstraction I F unit performs a process for converting the intermediate language interpretable by the controller of the relay device into a language interpretable by the cloud service providing device . The access request including the document acquisition request which has been subjected to the conversion processes described above is transmitted to the cloud service providing device from the communication I F unit associated with the cloud service providing device after an access token corresponding to the user ID is added to the access request step S . After verifying the validity of the access token the cloud service providing device transmits information on a document data list corresponding to the user ID and available to the user to the relay device in response to the access request step S . The document data may be document data held in the cloud service providing device or may be document data generated based on data obtained as a result of processing performed by the cloud service providing device . The document data may also be reference information to document data held by another cloud service providing device or a document management device not illustrated .

Upon receiving the information on the document data list the controller of the relay device performs conversion processing step S . Specifically the second abstraction I F unit performs a process for converting the language interpretable by the cloud service providing device into the intermediate language interpretable by the controller of the relay device and the first abstraction I F unit performs a process for converting the intermediate language interpretable by the controller of the relay device into the language interpretable by the client device . The information on the document data list subjected to the conversion processes described above is transmitted to the client device step S .

The user refers to the document data list displayed on the display of the client device and operates the operation unit to specify desired document data to be printed using the client device . Upon accepting this operation step S the controller of the client device transmits information on a request for printing the specified document data to the relay device step S . Upon receiving the printing request information the controller of the relay device performs conversion processing from one language to another step S . Specifically the first abstraction I F unit performs a process for converting the language interpretable by the client device into the intermediate language interpretable by the controller of the relay device . The information on the request for printing the specified document data is also converted into a request for acquiring the specified document data. Further the second abstraction I F unit performs a process for converting the intermediate language interpretable by the controller of the relay device into the language interpretable by the cloud service providing device

Then the data subjected to the conversion processes described above the information on the request for acquiring the specified document data is transmitted to the cloud service providing device from the communication I F unit associated with the cloud service providing device after an access token corresponding to the user ID described above is added to the data step S . Upon receiving the information on the request for acquiring the document data which has been converted by the relay device the cloud service providing device verifies the validity of the access token and then starts to perform acquisition request processing for the document data specified by the user step S . Then the cloud service providing device transmits the specified document data to the relay device step S . The controller of the relay device performs print data generation processing on the document data transmitted from the cloud service providing device to convert the document data into print data having a format printable by the client device . Further the controller performs processing for converting the intermediate language interpretable by the controller of the relay device into the language interpretable by the client device in a manner similar to that in step S step S . Then the controller transmits the generated print data and the information represented in the language interpretable by the client device to the client device step S . The controller of the client device prints and outputs the received print data from the image forming reading unit step S .

In the example of the data printing service described above any document data is specified from a document data group held generated and managed by one of the cloud service providing device e.g. the cloud service providing device and is printed. Alternatively desired document data may be retrieved from a document data group held generated and managed by plural cloud service providing devices and plural pieces of document data may be acquired from plural different cloud service providing devices and printed. A specific example will be described hereinafter.

The relay device registers itself in advance in federation with the plural cloud service providing devices and and the user accesses the plural cloud service providing devices and to log in from the PC via the relay device . Accordingly the relay device stores the user ID and access tokens issued by the cloud service providing devices and in the memory in association with each other.

The user inputs their user ID from the client device and makes a request for a data printing service. When a request for searching for document data to be printed and the search key such as the document name or information added to the document are transmitted from the client device to the relay device the controller of the relay device converts the language with which the request for searching the document data to be printed which has been received from the client device is represented into a language with which the request for searching for the document data is represented which is interpretable by each of the cloud service providing devices and and requests each of the cloud service providing devices and to search for the document data.

The controller of the relay device receives information on the found document data from the respective cloud service providing devices in the corresponding languages and converts the languages into an intermediate language interpretable by the relay device . Then the controller generates information on a document data list that matches the search condition from the document data held and managed by each of the cloud service providing devices and converts the generated information into information represented in the language interpretable by the client device and transmits the resulting information to the client device . In this case the controller stores information indicating which cloud service providing device the acquired document data has been held and managed by.

In the client device document data to be printed is specified by using the operation unit from the received information on the document data list and a printing instruction is made. In response to the printing instruction the client device transmits information identifying the specified document data and the printing instruction information to the relay device . The controller of the relay device converts the language with which the received information is represented and specifies document data instructed to be printed by the client device . The controller refers to the information indicating which cloud service providing device the specified document data is held and managed by and requests the cloud service providing devices that hold and manage the specified document data to acquire document data.

In response to this acquisition request each of the cloud service providing devices transmits document data to the relay device . The controller of the relay device converts the document data acquired from each of the cloud service providing devices into print data and transmits the print data to the client device . The client device prints and outputs the print data. Accordingly a printing request is made by the client device after the search condition for the document data to be printed is input thus allowing document data to be searched for across the plural cloud service providing devices and to be printed. In addition to the search across the plural cloud service providing devices pieces of document data held in the plural cloud service providing devices may be collectively printed by batch.

Cloud services are not limited to those in the example according to the exemplary embodiment and may include for example a service for performing image recognition a service for converting the format of image data and a service for managing the flow of information processing. The program executed by the client device the relay device and the cloud service providing device may be provided by being recorded on a recording medium such as a magnetic tape a magnetic disk a floppy disk an optical recording medium a magneto optical recording medium a compact disk CD a digital versatile disk DVD or a RAM.

The foregoing description of the exemplary embodiment of the present invention has been provided for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Obviously many modifications and variations will be apparent to practitioners skilled in the art. The embodiment was chosen and described in order to best explain the principles of the invention and its practical applications thereby enabling others skilled in the art to understand the invention for various embodiments and with the various modifications as are suited to the particular use contemplated. It is intended that the scope of the invention be defined by the following claims and their equivalents.

