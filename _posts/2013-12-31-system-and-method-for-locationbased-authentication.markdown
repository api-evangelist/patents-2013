---

title: System and method for location-based authentication
abstract: A system, apparatus, method, and machine readable medium are described for location-aware authentication. For example, one embodiment of a location-aware method for user authentication comprises: determining a current location of a mobile device; identifying a location class corresponding to the current location; selecting a set of one or more authentication techniques to provide a sufficient level of user authentication for a current transaction based on the identified location class.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09305298&OS=09305298&RS=09305298
owner: NOK NOK LABS, INC.
number: 09305298
owner_city: Palo Alto
owner_country: US
publication_date: 20131231
---
This application claims the benefit of and priority to U.S. Provisional Patent Application No. 61 804 568 filed Mar. 22 2013 entitled Advanced Methods of Authentication And Its Applications .

This invention relates generally to the field of data processing systems. More particularly the invention relates to a system and method for location based authentication.

Systems have also been designed for providing secure user authentication over a network using biometric sensors. In such systems the score generated by the application and or other authentication data may be sent over a network to authenticate the user with a remote server. For example Patent Application No. 2011 0082801 801 Application describes a framework for user registration and authentication on a network which provides strong authentication e.g. protection against identity theft and phishing secure transactions e.g. protection against malware in the browser and man in the middle attacks for transactions and enrollment management of client authentication tokens e.g. fingerprint readers facial recognition devices smartcards trusted platform modules etc .

For certain classes of transactions the riskiness associated with the transaction may be inextricably tied to the location where the transaction is being performed. For example it may be inadvisable to allow a transaction that appears to originate in a restricted country such as those listed on the US Office of Foreign Asset Control List e.g. Cuba Libya North Korea etc . In other cases it may only be desirable to allow a transaction to proceed if a stronger authentication mechanism is used for example a transaction undertaken from within the corporation s physical premises may require less authentication than one conducted from a Starbucks located in a remote location where the company does not have operations.

However reliable location data may not be readily available for a variety of reasons. For example the end user s device may not have GPS capabilities the user may be in a location where Wifi triangulation data is unavailable or unreliable the network provider may not support provide cell tower triangulation capabilities to augment GPS or Wifi triangulation capabilities. Other approaches to divine the device s location may not have a sufficient level of assurance to meet the organization s needs for example reverse IP lookups to determine a geographic location may be insufficiently granular or may be masked by proxies designed to mask the true network origin of the user s device.

In these cases an organization seeking to evaluate the riskiness of a transaction may require additional data to provide them with additional assurance that an individual is located in a specific geographic area to drive authentication decisions.

Described below are embodiments of an apparatus method and machine readable medium for implementing a location aware authentication policy. Throughout the description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be apparent however to one skilled in the art that the present invention may be practiced without some of these specific details. In other instances well known structures and devices are not shown or are shown in a block diagram form to avoid obscuring the underlying principles of the present invention.

The embodiments of the invention discussed below involve client devices with authentication capabilities such as biometric devices or PIN entry. These devices are sometimes referred to herein as tokens authentication devices or authenticators. Various different biometric devices may be used including but not limited to fingerprint sensors voice recognition hardware software e.g. a microphone and associated software for recognizing a user s voice facial recognition hardware software e.g. a camera and associated software for recognizing a user s face and optical recognition capabilities e.g. an optical scanner and associated software for scanning the retina of a user . The authentication capabilities may also include non biometric devices such as trusted platform modules TPMs smartcards Trusted Execution Environments TEEs and Secure Elements SEs 

As mentioned above in a mobile biometric implementation the biometric device may be remote from the relying party. As used herein the relying party is the entity which utilizes the authentication techniques described herein to authenticate the end user. For example the relying party may be an online financial service online retail service e.g. Amazon cloud service or other type of network service with which the user is attempting to complete a transaction e.g. transferring funds making a purchase accessing data etc . In addition as used herein the term remote means that the biometric sensor is not part of the security boundary of the computer it is communicatively coupled to e.g. it is not embedded into the same physical enclosure as the relying party computer . By way of example the biometric device may be coupled to the relying party via a network e.g. the Internet a wireless network link etc or via a peripheral input such as a USB port. Under these conditions there may be no way for the relying party to know if the device is one which is authorized by the relying party e.g. one which provides an acceptable level of authentication and integrity protection and or whether a hacker has compromised the biometric device. Confidence in the biometric device depends on the particular implementation of the device.

One embodiment of the invention implements an authentication policy that allows authentication mechanisms to be selected based on the physical location of the client device being used for authentication. For example the client and or server may make a determination of the physical location of the client device and feed that location to a policy engine that evaluates an ordered set of policy rules. In one embodiment these rules specify classes of locations and the authentication mechanism or mechanisms that must be applied if the client location matches the location definition in the rule.

As illustrated in one embodiment of the invention includes a client device with an authentication policy engine for implementing the location aware authentication policies described herein. In particular this embodiment includes a location class determination module for using the current location of the client device provided by location sensors e.g. a GPS device to identify a current location class. As discussed in detail below different location classes may be defined comprising known geographical points and or regions. Location class data may be continuously updated and stored in a persistent location data storage device e.g. a flash storage or other persistent storage device . The location class determination module may then compare the current location provided by the sensor s against the defined classes to determine a current location class for the client device .

In one embodiment the relying party specifies the authentication policy to be implemented by the authentication policy engine for each transaction as indicated by the dotted line from the relying party to the authentication policy engine . Thus the authentication policy may be uniquely tailored to the authentication requirements of each relying party. In addition the level of authentication required may be determined based on the current transaction as defined by the authentication policy . For example a transaction which requires a transfer of a significant amount of money may require a relatively high authentication assurance threshold whereas non monetary transaction may require a relatively lower authentication assurance threshold. Thus the location aware authentication techniques described herein may be sufficient for certain transactions but may be combined with more rigorous authentication techniques for other transactions.

In one embodiment the location class determination module provides the determined class to an authentication policy module which implements a set of rules to identify the authentication techniques to be used for the determined class. By way of example and not limitation illustrates an exemplary set of rules 1 5 specifying one or more authentication techniques 1 5 which may be used for each defined location class 1 5. Although illustrated as a table data structure in the underlying principles of the invention are not limited to any particular type of data structure for implementing the rule set.

Once the authentication policy engine selects a set of authentication techniques the authentication policy engine may implement the techniques using one or more explicit user authentication devices and or non intrusive authentication techniques to authenticate the user with a relying party . By way of example and not limitation the explicit user authentication may include requiring the user to enter a secret code such as a PIN fingerprint authentication voice or facial recognition and retinal scanning to name a few.

The non intrusive authentication techniques may include user behavior sensors which collect data related to user behavior for authenticating the user. For example the biometric gait of the user may be measured using an accelerometer or other type of sensor in combination with software and or hardware designed to generate a gait fingerprint of the user s normal walking pattern. As discussed below other sensors may be used to collect data used for authentication. For example network data may be collected identifying network computing devices within the local proximity of the client device e.g. known peer computers access points cell towers etc .

In one embodiment secure storage is a secure storage device used to store authentication keys associated with each of the authentication devices . As discussed below the authentication keys may be used to establish secure communication channels with the relying party via a secure communication module .

Various different classes of locations may be defined consistent with the underlying principles of the invention. By way of example and not limitation the following classes of locations may be defined 

Class 1 The client is within a given radius of a specified location. In this class the associated authentication policy is applied if the current client location is within an area bounded by a circle of a given radius centered at a specified latitude and longitude.

Class 2 The client is within a specified boundary region. In this class the associated authentication policy is applied if the client is located within an area bounded by a polygon defined by an ordered set of latitude and longitude pairs e.g. a closed polygon .

Class 3 The client is outside a specified boundary. In this class the associated authentication policy is applied if the client is located outside an area bounded by a polygon defined by an ordered set of latitude and longitude pairs e.g. a closed polygon .

In one embodiment additional classes are defined using Boolean combinations of the classes and policy rules defined above. For example the Boolean operations AND OR NOT and the nesting of Boolean operations allow the expression of complex conditions. Such policies could be used for example to implement a policy that applies when the client is located in one of a variety of facilities owned by a company.

Various different mechanisms may be used to determine the current physical location of the client represented generally in as location sensors including but not limited to the following 

GPS Embedded GPS sensors can directly provide details on the location of the client. New emerging standards seek to add authentication of the location provided as a capability that address this shortcoming in current GPS solutions.

Geo IP Lookup Reverse lookups of the client s IP address can be used to determine a coarse approximation of the client s location. However the trustworthiness of the location obtained through this method requires the IP address to be cross checked against blacklists of known compromised hosts anonymizing proxy providers or similar solutions designed to obfuscate the source IP address of the host.

Cell Tower Triangulation Integration between the client the server and wireless carrier infrastructure could allow the client and server to perform high resolution determination of physical location using cellular signal strength triangulation.

Wi Fi Access Point Triangulation A higher resolution method to determine physical location is to triangulate the signal strength of nearby Wifi access points with known physical locations. This method is particularly effective in determining the location of a device within facilities.

Location Displacement Inference A device s exact location may be unknown but a statistical probability of location may be used as an approximation for the purpose of evaluating policy. This may be calculated by noting the change in the device s position relative to a starting point with a known location the user s device may have in the past had a known starting point and in the interim has moved a known or estimate distance and bearing allowing an approximate location to be calculated. Possible methods to calculate the displacement from the starting point may include inferring distance traveled using measurements gathered from an accelerometer i.e. using the accelerometer to measure how far the user walked based on gait measurement changes in signal strength from a known stationary set of signal sources and other methods.

At the client s location is identified using one or more available techniques e.g. GPS triangulation peer network device detection etc . At one or more location classes and potentially Boolean combinations of classes are identified for the current location based on an existing set of policy rules. At one or more authentication techniques are identified according to the location class es . For example if the client device is currently at a location known to be the user s home or office or within a defined radius of another trusted location then minimal or no authentication may be required. By contrast if the client device is currently at an unknown location and or a location known to be untrusted then more rigorous authentication may be required e.g. biometric authentication such as a fingerprint scan PIN entry etc . At the authentication techniques are employed and if authentication is successful determined at then the transaction requiring authentication is authorized at .

As mentioned above the level of authentication required may be determined based on the current transaction. For example a transaction which requires a transfer of a significant amount of money may require a relatively high authentication assurance threshold whereas non monetary transaction may require a relatively lower authentication assurance threshold. Thus the location aware authentication techniques described herein may be sufficient for certain transactions but may be combined with more rigorous authentication techniques for other transactions.

If authentication is not successful then the transaction is blocked at . At this stage the transaction may be permanently blocked or additional authentication steps may be requested. For example if the user entered an incorrect PIN the user may be asked to re enter the PIN and or perform biometric authentication.

The embodiments of the invention described herein provide numerous benefits to authentication systems. For example the described embodiments may be used to efficiently block access from unauthorized locations reducing unauthorized access by limiting the location from which users are permitted to attempt authentication e.g. as defined by location classes . In addition the embodiments of the invention may selectively require stronger authentication to respond to location specific risks. For example the relying party can minimize the inconvenience of authentication when a user is entering into a transaction from a known location while retaining the ability to require stronger authentication when the user client is connecting from an unknown or unexpected location. Moreover the embodiments of the invention enable location aware access to information. Alternatively a location centric policy may be used by a relying party to provide a user with additional access to location specific information. By way of example and not limitation a user located in a Walmart may be granted access to special offers from Amazon.com when the user logs into their Amazon.com account on their mobile phone.

As mentioned above the location of the client device may be determined using a variety of different techniques. In one particular embodiment the definition of a location may not be tied to a set of physical coordinates as with GPS but instead be prescribed by the presence of a set of peer devices or other types of network devices. For example when at work the client s wireless network adapters e.g. Wifi adapter Bluetooth adapter LTE adapter etc may see a set of peer network devices e.g. other computers mobile phones tablets etc and network infrastructure devices e.g. Wifi access points cell towers etc on a consistent basis. Thus the presence of these devices may be used for authentication when the user is at work. Other locations may be defined by the presence of devices in a similar manner such as when the user is at home.

For example using the techniques described herein a location may be defined as with my work colleagues or at work where the presence of a set of peer devices known to be owned by the user s work colleagues may be used as a proxy for the risk that needs to be mitigated by authentication policy. For example if a user is surrounded by a set of known peer devices or other types of network devices then the user may be deemed to be less of a risk than if no known devices are detected.

As illustrated device proximity detection logic on the client device may capture data related to visible devices and compare the results against historical device proximity data . The historical device proximity data may be generated over time and or through a training process. For example in one embodiment the user may specify when he she is at work at home or at other locations either manually or when prompted to do so by the client . In response the device proximity detection logic may detect the devices in the vicinity and persistently store the results as historical device proximity data . When the user subsequently returns to the location the device proximity detection logic may compare the devices that it currently sees against the devices stored as historical proximity data to generate a correlation between the two. In general the stronger the correlation the more likely it is that the client is at the specified location. Over time devices which are seen regularly may be prioritized above other devices in the historical device proximity data e.g. because these devices tend to provide a more accurate correlation with the user s work location .

In one embodiment the authentication policy engine may use the correlation results provided by the device proximity detection logic to determine the level of authentication required by the user for each relying party . For example if a high correlation exists i.e. above a specified threshold then the authentication policy engine may not require explicit authentication by the end user. By contrast if there is a low correlation between the user s current location and the historical device proximity data i.e. below a specified threshold then the authentication policy engine may require more rigorous authentication e.g. a biometric authentication such as a fingerprint scan and or requesting PIN entry .

In one embodiment the device proximity detection logic identifies the set of other devices that are in the client s proximity which have been authenticated. For example if several of a user s colleagues have already authenticated successfully then there may be less risk associated with allowing the user to access certain data with a less reliable authenticator simply because the user is operating in the presence of his her peers. In this embodiment peer to peer communication over standards such as 802.11n may be used to collect authentication tokens from peers that can be used to prove those peers have already authenticated.

In another embodiment the device proximity detection logic may also detect a previously authenticated device that is paired with the user s client e.g. such as the user s mobile phone or tablet . The presence of another authenticated device that is used by the same user that is attempting to authenticate may be used as an input to the authentication decision particularly when accessing the same application.

In one embodiment the historical device proximity data is collected and shared across multiple devices and may be stored and maintained on an intermediate authentication service. For example a history of groups of peers and network devices in each location may be tracked and stored in a central database accessible to the device proximity detection logic on each device. This database may then be used as an input to determine the risk of an attempted authentication from a particular location.

As mentioned above one embodiment of the invention leverages data from additional sensors from the mobile device to provide supplemental inputs to the risk calculation used for authentication. These supplemental inputs may provide additional levels of assurance that can help to either confirm or refute claims of the location of the end user s device.

As illustrated in the additional sensors which provide supplemental assurance of the device s location may include temperature sensors humidity sensors and pressure sensors e.g. barometric or altimeter pressure sensors . In one embodiment the sensors provide temperature humidity and pressure readings respectively which are used by a supplemental data correlation module of the authentication policy engine to correlate against supplemental data known about the location provided by the location sensor s or the location derived using the various other techniques described herein . The results of the correlation are then used by the authentication policy module to select one or more authentication techniques for a given transaction. As indicated in the supplemental location data may include data collected from external sources e.g. the Internet or other mobile devices and local data sources e.g. historical data collected during periods when the device is known to be in possession of the legitimate user .

The supplemental data correlation module may use the data provided by the additional sensors in a variety of different ways to correlate against the supplemental location data . For example in one embodiment the supplemental location data includes current local meteorological conditions at the location provided by the location sensor s . By comparing the humidity temperature or barometric pressure gathered from the additional sensors against real time local weather data the supplemental data correlation module identifies cases where the sensor data is inconsistent with local conditions. For example if the client device s GPS reading indicates that the device is outside yet the temperature humidity or barometric pressure are not consistent with the local weather conditions then the supplemental data correlation module may generate a low correlation score and the location may be deemed less trustworthy. Consequently the authentication policy module may require more rigorous authentication techniques e.g. fingerprint PIN entry etc to approve a transaction.

As another example by comparing the altitude provided by an altimeter pressure sensor against the known geographical or network topology of the claimed location provided with the supplemental location data the supplemental data correlation module may identify discrepancies that signal the claimed location is not genuine. For example if a reverse IP lookup of the user s claimed location identifies them as being in the Andes Mountains but altimeter data from the device indicates the device is at sea level then the supplemental data correlation module may generate a low correlation score and the location may be deemed less trustworthy. As a result of the low correlation score the authentication policy module may attempt to mitigate the higher risk with stronger authentication for the transaction.

In one embodiment the supplemental data correlation module compares data gathered from sensors on the user s device against multiple other end users in the immediate area to identify anomalies that suggest the user is not operating in the same physical location as those known users. For example if a set of authenticated users are identified who are operating the same physical area and all of those users devices note that the local temperature in the area is 10 C. the supplemental data correlation module may generate a low correlation score for an end user whose temperature sensor indicates the local temperature is 20 C. As a result the authentication policy may require more rigorous authentication techniques .

As yet another example the supplemental data correlation module may compare current readings against historical data for a particular user. For example as mentioned sensor data may be analyzed during periods of time when the user is known to be in possession of the device e.g. for a time period following an explicit authentication . The supplemental data correlation module may then look for discontinuities in the local data to identify suspicious behavior. For example if the user s ambient temperature normally floats between 10 C. and 20 C. and it is currently at 30 C. this may indicate the user is not in a typical location thereby generating a low correlation and causing the authentication policy module to require an additional level of scrutiny for a transaction.

The supplemental data correlation module may perform various different types of correlations between sensor data and supplemental location data while still complying with the underlying principles of the invention. For example various known correlation mechanisms may be used to determine the statistical relationship between the two sets of data. In one embodiment the correlation score provided to the authentication policy engine comprises a normalized value e.g. between 0 1 indicating a level of correlation. In one embodiment various threshold levels may be set for detected differences between the sensors and supplemental location data . For example if the temperature sensor measures a temperature of more than 3 degrees off of the current temperature gathered from other devices or the Internet then a first threshold may be triggered resulting in a lowering of the correlation score . Each additional 3 degrees off from the current temperature may then result in a new threshold being met resulting in a corresponding lowering of the correlation score . It should be noted however that these are merely examples of one embodiment of the invention the underlying principles of the invention are not limited to any particular manner of performing a correlation.

A method in accordance with one embodiment of the invention is illustrated in . At the current location being reported by the client device e.g. via the GPS module on the device is read. At supplemental location data is collected for the reported location along with sensor data from the client device. As mentioned above the supplemental location data may be collected locally or remotely e.g. from other clients and or servers on the Internet and may include data such as the current temperature pressure and or humidity for the reported location. The sensor data may be provided by temperature sensors barometric or altimeter pressure sensors and or humidity sensors.

At a correlation is performed between the supplemental location data and the sensor data provided by the device sensors. In one embodiment a relatively higher correlation will result in a relatively higher correlation score at whereas lower correlations will result in relatively lower correlation scores. As mentioned in one embodiment the correlation score is a normalized value e.g. between 0 1 indicating the similarity between the sensor readings and supplemental data.

At one or more authentication techniques are selected based at least in part on the correlation score. For example if a relatively low correlation score is provided then more rigorous authentication techniques may be selected whereas if a relatively high correlation exists then less rigorous authentication techniques may be selected potentially those which do not require explicit authentication by the end user .

If the user successfully authenticates using the selected techniques determined at then the transaction is allowed to proceed at . If not then the transaction is blocked at .

Numerous benefits are realized from the above embodiments. For example these embodiments provide an additional level of assurance for location data gather from other sources Allows the organization to supplement location data gathered from other sources IP GPS etc in order to gain additional assurance that the location is authentic. In addition the embodiments of the invention may block a transaction from an unauthorized location reducing unauthorized access by limiting the location from which users can even attempt authentication. Moreover these embodiments may force stronger authentication to respond to location specific risks e.g. the relying party can minimize the inconvenience of authentication when the user is accessing information from a known location while retaining the ability to require stronger authentication when the user client is accessing from an unknown or unexpected location or a location whose veracity can t be sufficiently qualified using multiple inputs .

While the secure storage is illustrated outside of the secure perimeter of the authentication device s in one embodiment each authentication device may have its own integrated secure storage. Alternatively each authentication device may cryptographically protect the biometric reference data records e.g. wrapping them using a symmetric key to make the storage secure .

Turning first to the illustrated embodiment includes a client equipped with one or more authentication devices for enrolling and authenticating an end user. As mentioned above the authentication devices may include biometric devices such as fingerprint sensors voice recognition hardware software e.g. a microphone and associated software for recognizing a user s voice facial recognition hardware software e.g. a camera and associated software for recognizing a user s face and optical recognition capabilities e.g. an optical scanner and associated software for scanning the retina of a user and non biometric devices such as a trusted platform modules TPMs and smartcards.

The authentication devices are communicatively coupled to the client through an interface e.g. an application programming interface or API exposed by a secure transaction service . The secure transaction service is a secure application for communicating with one or more secure transaction servers over a network and for interfacing with a secure transaction plugin executed within the context of a web browser . As illustrated the Interface may also provide secure access to a secure storage device on the client which stores information related to each of the authentication devices such as a device identification code user identification code user enrollment data e.g. scanned fingerprint or other biometric data and keys used to perform the secure authentication techniques described herein. For example as discussed in detail below a unique key may be stored into each of the authentication devices and used when communicating to servers over a network such as the Internet.

As discussed below certain types of network transactions are supported by the secure transaction plugin such as HTTP or HTTPS transactions with websites or other servers. In one embodiment the secure transaction plugin is initiated in response to specific HTML tags inserted into the HTML code of a web page by the web server within the secure enterprise or Web destination sometimes simply referred to below as server . In response to detecting such a tag the secure transaction plugin may forward transactions to the secure transaction service for processing. In addition for certain types of transactions e.g. such as secure key exchange the secure transaction service may open a direct communication channel with the on premises transaction server i.e. co located with the website or with an off premises transaction server .

The secure transaction servers are coupled to a secure transaction database for storing user data authentication device data keys and other secure information needed to support the secure authentication transactions described below. It should be noted however that the underlying principles of the invention do not require the separation of logical components within the secure enterprise or web destination shown in . For example the website and the secure transaction servers may be implemented within a single physical server or separate physical servers. Moreover the website and transaction servers may be implemented within an integrated software module executed on one or more servers for performing the functions described below.

As mentioned above the underlying principles of the invention are not limited to a browser based architecture shown in . illustrates an alternate implementation in which a stand alone application utilizes the functionality provided by the secure transaction service to authenticate a user over a network. In one embodiment the application is designed to establish communication sessions with one or more network services which rely on the secure transaction servers for performing the user client authentication techniques described in detail below.

In either of the embodiments shown in the secure transaction servers may generate the keys which are then securely transmitted to the secure transaction service and stored into the authentication devices within the secure storage . Additionally the secure transaction servers manage the secure transaction database on the server side.

Embodiments of the invention may include various steps as set forth above. The steps may be embodied in machine executable instructions which cause a general purpose or special purpose processor to perform certain steps. Alternatively these steps may be performed by specific hardware components that contain hardwired logic for performing the steps or by any combination of programmed computer components and custom hardware components.

Elements of the present invention may also be provided as a machine readable medium for storing the machine executable program code. The machine readable medium may include but is not limited to floppy diskettes optical disks CD ROMs and magneto optical disks ROMs RAMs EPROMs EEPROMs magnetic or optical cards or other type of media machine readable medium suitable for storing electronic program code.

Throughout the foregoing description for the purposes of explanation numerous specific details were set forth in order to provide a thorough understanding of the invention. It will be apparent however to one skilled in the art that the invention may be practiced without some of these specific details. For example it will be readily apparent to those of skill in the art that the functional modules and methods described herein may be implemented as software hardware or any combination thereof. Moreover although some embodiments of the invention are described herein within the context of a mobile computing environment the underlying principles of the invention are not limited to a mobile computing implementation. Virtually any type of client or peer data processing devices may be used in some embodiments including for example desktop or workstation computers. Accordingly the scope and spirit of the invention should be judged in terms of the claims which follow.

