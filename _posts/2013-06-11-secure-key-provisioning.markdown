---

title: Secure key provisioning
abstract: Some examples include provisioning secret material onto an electronic device. For instance, an electronic device may be provided with a provisioning key that can be used for provisioning other secret material on the electronic device. The provisioning key may be encrypted at a secure location using an on-chip key that is also sent to a processor manufacturer. The encrypted provisioning key may subsequently be decrypted by an electronic device having a processor installed that includes the on-chip key. The provisioning key is saved to the device and may then be used for securely provisioning other secret material onto the electronic device, such as one or more keys, one or more digital certificates, or other digital rights management information. Accordingly, the provisioning key provides the device manufacture with the ability to securely install secret material to the electronic device using a key that is never shared outside of a secure environment.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09479328&OS=09479328&RS=09479328
owner: Amazon Technologies, Inc.
number: 09479328
owner_city: Reno
owner_country: US
publication_date: 20130611
---
Digital content items such as videos music electronic books and the like may be consumed on a variety of electronic devices. These electronic devices and or the content items to be consumed on these devices may often include digital rights management DRM technology for protecting the rights of content owners. Such DRM technology encourages content owners to make the content items more readily available to content providers and ultimately to consumers.

This disclosure includes techniques and arrangements for provisioning secret material on an electronic device. In some examples herein an electronic device is provided with a provisioning encryption key provisioning key that can be used for provisioning other secret material on the electronic device. The provisioning key may be stored on the electronic device in a secure manner during manufacture of the electronic device as discussed additionally below. The provisioning key may then be used by the device manufacturer for securely provisioning other secret material onto the electronic device either during the manufacturing process or after the electronic device has been purchased by a consumer. Accordingly the provisioning key provides the device manufacture with the ability to securely add secret material to the electronic device using a key that is never shared or exposed outside of a secure environment.

In some examples herein secret material may be any information that the device manufacturer desires to install or otherwise place on an electronic device in a secure manner such that the information is not exposed e.g. in an unencrypted form outside of a secure environment. As one example digital rights management DRM technology may be employed with content items provided to an electronic device to protect the rights of the copyright owner and or other parties. Some DRM technologies such as PLAYREADY DRM provided by Microsoft Corporation of Redmond Wash. and High bandwidth Digital Content Protection HDCP provided by Digital Content Protection LLC of Beaverton Oreg. require that secret material such as secret certificates and keys or secret key sets respectively be stored on the electronic device to enable consumption of a content item that is protected by this DRM technology. As one example such as in the case of PLAYREADY DRM when a content item is encrypted using this DRM technology the electronic device uses the secret material to decrypt the content item during consumption. As another example such as in the case of HDCP the electronic device may use the secret material to encrypt content of a content item before sending the content to another device such as a television. The secret material should be provided to the device in a secure fashion stored securely on the device and used securely on the device. For example each HDCP capable electronic device has a set of 40 56 bit keys stored on the electronic device that should remain secret to prevent possible unauthorized access to HDCP protected content. The secret material may be provisioned on the electronic device at the time of device manufacture or in the field such as after the electronic device has been sold to a consumer. However conventional techniques of employing a secure server on a factory floor for installing secret material require a level of physical security in the factory that can be problematic to achieve on a consistent controllable basis.

In some examples herein processors utilized in the electronic devices herein may include a small amount of one time programmable OTP memory that can be used to store a customer specified key. A key stored in the processor typically can only be accessed in a secure execution environment implemented on the device and can be programmed by the processor s manufacturer prior to shipment of the processors to the device manufacturer. However this still requires a secure process to communicate the key to the processor manufacturer and program the key provided by the device manufacturer onto the processor. By taking advantage of this feature the processor is provided to the device manufacturer already equipped with an on chip key that could be used to encrypt decrypt secret material for use on the electronic device. However in the process of placing the on chip key onto the processor the on chip key is exposed to the processor manufacturer and thus is not always under the direct control of the device manufacturer. It is therefore desirable to limit usage of the on chip key to limit the chance of exposing secret material if the on chip key is compromised. Further if the on chip key is compromised there is no means to replace or reprogram the on chip key in the field.

Some implementations herein employ a provisioning key that can be used on the electronic device for provisioning the secret material on an electronic device instead of for example an on chip key. The provisioning key itself can be encrypted with the on chip key and sent in encrypted form to a factory or manufacturing area of the device manufacturer in encrypted form. Since the provisioning key is encrypted the provisioning key does not require highly secure handling. For example the provisioning key can be placed on the electronic device as part of the manufacturing process which already involves pushing data onto the electronic device. Also as a part of the manufacturing flow the device manufacturer can cause execution of a provisioning module on the electronic device that uses the on chip key to decrypt the provisioning key within a secure execution environment on the electronic device. The decrypted provisioning key can be stored in a secure storage on the device. For example the provisioning module may re encrypt the provisioning key with a device secret key known only to the device itself as part of the secure storage capability of the device and placed into memory in encrypted form. As discussed below the device secret key is secret information such as a random number that is generated internally by the electronic device and is never shared or exposed outside of the electronic device. Accordingly the electronic device may use the device secret key for encrypting information stored on the electronic device so that the information is securely stored on the electronic device.

After the provisioning key has been stored on the electronic device the on chip key is no longer needed except in the highly unlikely event of a breach of the provisioning key. With the provisioning key in place on the electronic device the device manufacturer has a secure way to address secret data to the electronic devices using the provisioning key which unlike the on chip key is never shared outside of the company and the handling process for which is completely under control of the device manufacturer at all times. Even within the device manufacturer access to the provisioning key may be extremely limited. For example the provisioning key may be stored on a storage device or computer located in a safe with limited access and the safe itself may be located in a room or other secure area with limited access such as with access limited to a small number of authorized employees.

Therefore the provisioning key can be used to encrypt the secret material that the device manufacturer desires to load onto the electronic device to implement the DRM or other content protection standards supported by the device manufacturer. For example the device manufacture can use the provisioning key to encrypt the secret material within the secure limited access area mentioned above. The device manufacturer can then send the encrypted secret material to a factory or manufacturing area in that encrypted form without having to resort to highly secure handling measures. The encrypted secret material can be placed on the electronic devices during the manufacturing process while still encrypted. The provisioning module on each electronic device may use the provisioning key stored on the electronic device to decrypt the secret material within the secure execution environment on the electronic device and store the secret material in the device s secure storage. In this way the secret material is never exposed in the clear outside of the device manufacturer s secure area.

In addition because the provisioning key is stored in device memory the device manufacturer is able to replace the provisioning key in the field if the device manufacturer has reason to believe that the provisioning key has been breached. For example the device manufacturer may encrypt a new provisioning key using the on chip key in the secure room that has access only to authorized employees of the device manufacturer. The encrypted new provisioning key may then be pushed to electronic devices in the field i.e. devices previously purchased by consumers such as through a wired and or wireless network. The provisioning module may then be executed on the electronic devices to place the new provisioning key into secure storage on the electronic devices to replace the original provisioning key.

The device manufacturer is able to define as many provisioning keys as desired and may assign the provisioning keys to particular devices batches of devices device models types of devices or other groupings or sets of devices. For example a larger number of provisioning keys can limit the impact of the breach of any single provisioning key but can also increase operational and logistical complexity. In addition some secret material can be unique per device while other secret material can be the same across all devices of a particular model batch type etc. The provisioning key herein can be used to encrypt the secret material in either case. As an example some versions of HDCP key sets may be unique for each device while PLAYREADY model keys and certificates can be the same across all devices of a particular model.

In addition other security measures may be layered on top of the provisioning key encryption. For instance for per device HDCP keys the device manufacturer may encrypt each individual HDCP key set with the provisioning key bundle together large numbers of such encrypted key sets and encrypt the bundle using Pretty Good Privacy PGP e.g. OpenPGP or other encryption techniques before sending the bundle of HDCP key sets to a factory or manufacturing area computer. The manufacturing area computer may apply PGP decryption to extract the encrypted key sets leaving the provisioning key encryption in place. For example this technique may satisfy contractual language calling for PGP level encryption when communicating HDCP keys to remote locations.

The provisioning key may also be used to provision additional or replacement secret material to electronic devices in the field i.e. devices already in possession of consumers. As one example the provisioning key may be used to update the software on the electronic device to support an additional DRM scheme. The new secret material can be encrypted with the provisioning key and pushed to the electronic devices such as over a network. The pushed information may trigger the provisioning module on the electronic devices to decrypt the secret material in each device s secure execution environment and install or store the secret material securely in the device s storage.

For discussion purposes some example implementations are described in the environment of a device manufacturer installing secret material onto electronic devices. However the implementations are not limited to the particular examples provided and may be extended to other encryption environments and other types of devices as will be apparent to those of skill in the art having the benefit of the disclosure herein.

The network s may include a local area network LAN a wide area network WAN such as the Internet or any combination thereof and may include both wired and wireless communication technologies using any suitable protocols and communication techniques. The computing device of the device manufacturer and the source of the secret material may communicate and interact with one another using any combination of suitable communication and networking protocols such as Internet protocol IP transmission control protocol TCP hypertext transfer protocol HTTP and so forth.

Furthermore in some examples the secret material is encrypted such as by using a public key of a public private key pair or other suitable encryption technology. The secure computing device may use a compatible technology to decrypt the encrypted secret material such as by using a corresponding private key of the public private key pair not shown in . The secure computing device may be maintained in a secure area controlled by the device manufacturer. Examples of the secure area may include a secure room or other secure location and may further include a safe or various other security features and protocols to protect the secure computing device and the other secure information maintained in the secure area from unauthorized access or breach.

In some examples direct communications into and out of the secure area may be prohibited for added security in which case one or more communication computing devices controlled by the device manufacturer may be employed for carrying out the communications attributed herein to the secure computing device . For instance the encrypted secret material may be received by the communication computing device outside of the secure area stored on a removable storage media not shown in taken into the secure area on the removable storage media and then loaded onto the secure computing device . In other examples however the secure computing device is able to communicate directly over the one or more networks with suitable security protection such as a firewall and the like.

The secure computing device may be able to generate and or access one or more on chip keys and one or more provisioning keys . The on chip key may be any secret information that is stored on or associated with a processor or other component of the electronic device and used to encrypt and or decrypt other information such as to gain access to the other information. Further the provisioning key may be any secret information that is used to encrypt or decrypt other information such as for provisioning information onto the electronic devices in a secure manner. In some cases both the on chip key and the provisioning key are generated by the device manufacturer and at least the provisioning key is not exposed in an unencrypted form outside of a secure environment such as the secure area or a secure execution environment on the electronic device . For example the secure computing device may generate at least one on chip key and at least one provisioning key such as by using a random number generator. The keys and may be of any suitable length and may not be the same length. As several examples the keys and may be 128 bits 256 bits and so forth.

The secure computing device or the communication computing device may send at least one on chip key to a processor manufacturer computing device of a processor manufacturer . For example the secure computing device may first encrypt the on chip key such as using a public key of a public private key pair to produce an encrypted on chip key . The secure computing device may then send the encrypted on chip key over one or more networks to the processor manufacturer computing device . The processor manufacturer may then decrypt the encrypted on chip key using its own private key of the public private key pair and incorporate the on chip key into one or more processors. As an alternative the processor manufacturer may generate the on chip key such as by using its own random number generator not shown in . The processor manufacturer may then provide the on chip key to the secure computing device of the device manufacturer such as by sending the on chip key in an encrypted form to the communication computing device .

As mentioned above the processor manufacturer may embed or store the on chip key in one time programmable nonvolatile memory OTP NVM designed into the processor s to be provided to the device manufacturer for incorporation into the electronic device s . Accordingly one or more processors having the on chip key maintained thereon may be provided to the device manufacturer such as by being provided to a manufacturing area controlled by the device manufacturer. For example a batch of processors having the same on chip key saved in the OTP NVM may be provided to the manufacturing area and the batch may be identified as corresponding to a particular on chip key .

Furthermore the secure computing device may encrypt at least one provisioning key with the on chip key that was sent to the processor manufacturer . As one example the secure computing device may use Advanced Encryption Standard AES encryption technology or other suitable encryption technology to encrypt the provisioning key with the on chip key . The secure computing device or the communication computing device may send the provisioning key encrypted with the on chip key to a manufacturing area computing device within or accessible from the manufacturing area . For example the manufacturing area computing device may be remote from the secure computing device at least by not being located in the same room as the secure computing device . In some cases the manufacturing area computing device may be located in a different city state country etc. from the secure computing device . Accordingly the provisioning key encrypted with the on chip key may be provided over the one or more networks through a direct connection or by any other suitable technique or transmission means.

The manufacturing area computing device may provide the provisioning key encrypted with the on chip key to one or more of the electronic devices during the manufacturing process. For instance the provisioning key encrypted with the on chip key may be burned onto or otherwise installed onto computer readable media on the electronic device . As one example the provisioning key encrypted with on chip key may be included in an image that is installed on the computer readable media of the electronic device . For example the image may include various software modules such as an operating system one or more applications one or more other types of computer programs one or more device drivers data or the like. In some examples a model identifier batch identifier or the like may accompany the encrypted provisioning key to enable the manufacturing area computing device to determine the correct electronic device on which to install the encrypted provisioning key.

As part of the manufacturing and software installation process for the electronic device the manufacturing area computing device may cause the electronic device to execute a provisioning module on the electronic device . For example the provisioning module may be included in the image installed on the electronic device and may be executed in a secure environment on the electronic device to decrypt the provisioning key encrypted with the on chip key by using the on chip key stored in the storage location of the processor with on chip key. As mentioned above OTP NVM or other suitable technology may be used to associate the on chip key with the processor . The provisioning module may access the on chip key from the processor and may use the on chip key to decrypt the provisioning key that was encrypted with the on chip key.

Further the provisioning module or another module on the electronic device may store the provisioning key securely on the electronic device . For example the electronic device may include an encryption module and a device secret key not shown in that is known only to the electronic device and which may be used for securely storing information in an encrypted form on the electronic device . Accordingly the electronic device may re encrypt the provisioning key using the device secret key and may store the encrypted provisioning key on computer readable media included in the electronic device . Following re encryption of the provisioning key and storage on the electronic device using the device secret key the original version of the provisioning key encrypted with the on chip key may be deleted overwritten or otherwise removed from the electronic device.

In addition the secure computing device may use the provisioning key to encrypt the secret material received from the source of secret material such as using AES or other suitable encryption technology. Thus following decryption using the private key of a public private key pair the secure computing device may use the provisioning key to encrypt the secret material to obtain secret material encrypted with the provisioning key. The secure computing device or the communication computing device may then transfer the secret material encrypted with the provisioning key to the manufacturing area computing device such as over the one or more networks over a direct connection or the like. The manufacturing area computing device sees the secret material encrypted with the provisioning key and may install this on to the electronic device . In some examples a model identifier batch identifier or the like may accompany the encrypted material to enable the manufacturing area computing device to determine the correct electronic device on which to install the secret material . Similar to the technique described above for the encrypted provisioning key the secret material may be installed as part of a larger image installed onto computer readable media of the electronic device . Alternatively of course the secret material encrypted with the provisioning key may be installed separately on to the computer readable media of electronic device .

In either event the manufacturing area computing device may cause the provisioning module to execute on the electronic device for decrypting the secret material encrypted with the provisioning key. In particular the provisioning module may use the provisioning key stored on the electronic device to decrypt the encrypted secret material within a secure environment to obtain secret material . For example the secret material may be subsequently re encrypted for secure storage using the device secret key mentioned above or other suitable secure storage techniques. Following re encryption and storage of the secret material on the electronic device using the device secret key the original version of the secret material encrypted with the provisioning key may be deleted overwritten or otherwise removed from on the electronic device.

The manufacturing area computing device may include various software modules for accomplishing the functions discussed above such as an installation module that may be executed for installing software and data on the electronic devices such as including an image to which the provisioning key encrypted with the on chip key and or the secret material encrypted with the provisioning key may be added. For instance the image may include any of an operating system applications device drivers other computer programs code scripts or data. Alternatively the provisioning key encrypted with the on chip key and or the secret material encrypted with the provisioning key may be installed on the electronic devices separately from the image .

In some cases an entire batch of electronic devices an entire model run of electronic devices or an entire type of electronic devices may be provisioned with secret material using the same provisioning key and on chip key . In other cases a greater granularity of provisioning keys and on chip keys may be used depending on the device manufacturer s tolerance for the logistics involved in tracking a larger number of provisioning keys and or on chip keys . For instance the device manufacturer may maintain user account records that associate the device ID numbers with user accounts of users who purchased particular devices along with the provisioning key and on chip key that correspond to each of those electronic devices .

Furthermore in some examples other security measures may be layered on top of the provisioning key encryption applied to the secret material . For instance when the secret material is per device HDCP keys the device manufacturer may encrypt each individual HDCP key set with the provisioning key and bundle up large numbers of such encrypted key sets for sending to the manufacturing area computing device . The bundle of HDCP key sets each already encrypted with the provisioning key may be further encrypted using any suitable encryption technology such as Pretty Good Privacy PGP e.g. OpenPGP before sending the bundle of HDCP key sets to the manufacturing area computing device . Thus the secret material that is already encrypted using the provisioning key may be further encrypted using a public key of a public private key pair and sent to the manufacturing area computing device . Upon receipt of the encrypted bundle of secret material the manufacturing area computing device may apply PGP decryption i.e. using the private key of the public private key pair to partially decrypt the received bundle of secret material to extract the encrypted key sets leaving the provisioning key encryption of each key set in place. For example this technique may satisfy contractual language calling for PGP level encryption when communicating HDCP keys to remote locations.

As illustrated in an example secure computing device includes one or more processors one or more computer readable media and one or more communication interfaces . The processor s may be a single processing unit or a number of processing units and may include single or multiple computing units or multiple cores. The processor s can be configured to fetch and execute computer readable instructions stored in the computer readable media or other computer readable media.

The computer readable media may include volatile and nonvolatile memory and or removable and non removable media implemented in any type of technology for storage of information such as computer readable instructions data structures program modules or other data. Such computer readable media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape solid state storage magnetic disk storage RAID storage systems storage arrays network attached storage storage area networks cloud storage removable storage media or any other medium that can be used to store the desired information and that can be accessed by a computing device. Depending on the configuration of the computing device the computer readable media may be a type of tangible computer storage media and may be a non transitory storage media.

The computer readable media may be used to store any number of functional components that are executable by the processors . In many implementations these functional components comprise instructions or programs that are executable by the processors and that when executed implement operational logic for performing the actions attributed above to the computing device . Functional components of the computing device that may be executed on the processors for implementing the various functions and features related to encryption and communication as described herein include a key generation module an encryption module and a communication module . For example the key generation module may be a random number generator or the like for generating keys such as the on chip keys and or the provisioning keys . The encryption module may use any suitable type of encryption technology such as AES for performing the various encryption operations discussed above. The communication module may be used in the examples in which the secure computing device is able to communicate directly outside of the secure area. Additional functional components stored in the computer readable media may include an operating system for controlling and managing various functions of the computing device .

In addition the computer readable media may include or the computing device may access data which may include the decrypted secret material one or more public private key pairs one or more provisioning keys such as provisioning key provisioning key . . . provisioning key N N and one or more on chip keys such as on chip key on chip key . . . on chip key M . In addition the secure computing device may include many other logical programmatic and physical components of which those described above are merely examples that are related to the discussion herein.

The communication interface s may include one or more interfaces and hardware components for enabling communication with various other devices over the network s . For example communication interface s may facilitate communication through one or more of the Internet cable networks cellular networks wireless networks e.g. Wi Fi cellular and wired networks. Various different approaches to implementations described herein can be implemented in various environments. For instance the network s may include any appropriate network including an intranet the Internet a cellular network a LAN WAN VPN or any other network or combination thereof. Components used for such a system can depend at least in part on the type of network and or environment selected. Protocols and components for communicating via such networks are well known and will not be discussed herein in detail. Further as discussed above in some examples a communication module and communication interfaces may be alternatively included on a separate communication computing device located outside of the secure area.

Secure computing device may further be equipped with various input output devices . Such I O devices may include a display various user interface controls e.g. buttons mouse keyboard touch screen etc. audio speakers connection ports and so forth.

In addition the communication computing device the processor manufacturer computing device and the manufacturing area computing device may include hardware components such as a processor computer readable media and communication interface similar to those discussed in but with different functional components configured to accomplish the functions described above. For example the manufacturing area computing device may include the installation module executable by a processor for performing the installation functions discussed above.

Various instructions methods and techniques described herein may be considered in the general context of computer executable instructions such as program modules stored on computer storage media and executed by the processors herein. Generally program modules include routines programs objects components data structures etc. for performing particular tasks or implementing particular abstract data types. These program modules and the like may be executed as native code or may be downloaded and executed such as in a virtual machine or other just in time compilation execution environment. Typically the functionality of the program modules may be combined or distributed as desired in various implementations. An implementation of these modules and techniques may be stored on computer storage media or transmitted across some form of communication media.

In a very basic configuration the electronic device includes or accesses components such as at least one control logic circuit central processing unit or processor and one or more computer readable media . Each processor may itself comprise one or more processors or processing cores. In some examples the processor may correspond to the processor with on chip key discussed above and may include one time programmable non volatile memory OTP NVM or other technology for enabling a particular on chip key to be associated with a particular processor .

Depending on the configuration of the electronic device the computer readable media may be an example of tangible non transitory computer storage media and may include volatile and nonvolatile memory and or removable and non removable media implemented in any type of technology for storage of information such as computer readable instructions data structures program modules or other data. Such computer readable media may include but is not limited to RAM ROM EEPROM flash memory or other computer readable media technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape solid state storage magnetic disk storage RAID storage systems storage arrays network attached storage storage area networks cloud storage or any other medium that can be used to store information and which can be accessed by the processor directly or through another computing device. Accordingly the computer readable media may be computer readable media able to store and maintain instructions modules or components executable by the processor .

The computer readable media may be used to store any number of functional components that are executable by the processor . In some implementations these functional components comprise instructions or programs that are executable by the processor and that when executed implement operational logic for performing the actions attributed above to the electronic device . Functional components of the electronic device stored in the computer readable media may include the provisioning module executable by the processor for decrypting the provisioning key and or the secret material . Additional functional components stored in the computer readable media may include an encryption module and a secure environment module which may be executed by the processor for providing a secure execution environment on the electronic device and for providing secure storage such as by using a device secret key to encrypt data for secure storage on the computer readable media . Thus the presentation module may present the interface discussed above with respect to . Other functional components may include one or more applications executable for various purposes and an operating system and user interface module for controlling and managing various functions of the electronic device .

The device secret key may be an internal secret key that is securely generated and stored within the electronic device such as in the OTP NVM of the processor . In some examples the device secret key is secret information that is generated internally by the electronic device and is never shared or known outside of the electronic device . Accordingly the electronic device may use the device secret key for encrypting and or decrypting other information stored on the electronic device so that the other information is securely stored on the electronic device. For instance the device secret key may be a random number or other secret information generated internally by the processor such as during or after manufacture of the processor and may be stored on the OTP NVM of the processor or other component of the electronic device . For example the OTP NVM may include eFuses or other suitable secure non volatile memory that cannot be accessed through normal memory access techniques. Thus the processor may generate the device secret key and the device secret key is never known or exposed outside of the electronic device . As another example the device secret key and or the on chip key may be maintained in a separate security chip not shown in that is separate from the main processor such as is available from Renesas Electronics of Santa Clara Calif. or other suitable vendors. Other variations for internal secure storage of secret material will also be apparent to those of skill in the art having the benefit of the disclosure herein.

The computer readable media may also store data data structures and the like that are used by the functional components. For example data stored by the computer readable media may include the provisioning key the secret material and one or more content items . For instance the content items may be protected by DRM and thus may require the secret material to enable consumption of the content items on the electronic device or to enable sending content to another device for consumption. Further one or more of the applications may be used to consume the content items in the secure execution environment with use of the secret material . Examples of content items may include video content audio content images multimedia items electronic books and other textual content web content or any combination thereof.

Depending on the type of the electronic device the computer readable media may also optionally include other functional components and other data . For instance other modules may include device drivers and other programs while other data may include for example data used by the operating system and user interface module and the applications . Further the electronic device may include many other logical programmatic and physical components of which those described are merely examples that are related to the discussion herein.

One or more communication interfaces may support both wired and wireless connection to various networks such as cellular networks radio WiFi networks short range or near field networks e.g. BLUETOOTH infrared signals local area networks wide area networks the Internet and so forth. For example the communication interface may allow a user of the electronic device to access the World Wide Web download content items from content provider sites access online content such as from a website or other network location and the like. The communication interface may further allow a user to access storage on another device such as a user computing device a network attached storage device cloud storage or the like.

The electronic device may further be equipped with various other input output I O components . Such I O components may include a touchscreen and various user controls e.g. buttons a joystick a keyboard a mouse etc. speakers a microphone a camera connection ports and so forth. For example the operating system of the electronic device may include suitable drivers configured to accept input from a keypad keyboard or other user controls and devices included as the I O components . For instance the user controls may include page turning buttons navigational keys a power on off button selection keys and so on. Additionally the electronic device may include various other components that are not shown examples of which include removable storage a power source such as a battery and power control unit a global positioning system GPS device a PC Card component and so forth.

The service provider computing device may maintain an online location or site such as a merchant website an e commerce site or other functionality that may offer one or more content items to the public. In some cases the service provider computing device may offer the electronic devices for sale as well. For example the service provider computing device may be one or more web servers located at a data center server farm or other single physical location. In other cases the service provider computing devices may include multiple computers located in diverse locations that are physically remote from one another. Further in some implementations the service provider computing devices may provide a group of websites data stores services and the like hosted on a plurality of different computing devices in a plurality of diverse locations or hosted by one or more computing devices at a single location. Each service provider computing device may include one or more processors which may be the same or similar to the processors described above one or more computer readable media which may be the same or similar to the computer readable media described above and one or more communication interfaces which may be the same or similar to the communication interfaces described above.

The service provider computing device may offer content items to the public through an online presence accessible by a web browser or other application on the electronic device . The service provider computing device alternatively or additionally may offer content items through an online or mobile application executing on the electronic device . For example an application on the electronic device not shown in may connect to or obtain information from the service provider computing device to enable a user of an electronic device to select purchase or manage one or more content items .

In the example of one or more users may use one or more respective electronic devices to access one or more content items on the electronic devices . For example each user may use at least one device to access at least one content item . In some cases the content items may have DRM associated with them and may require appropriate secret material to be present on the electronic device to allow consumption of the associated content item . The user may access or receive content items from the service provider computing device such as by downloading or streaming through the network .

The service provider computing device may include a content item store module that may provide or may access a content item catalog . For example the content item store module may present the content item catalog to an electronic device that accesses the service provider computing device such as during shopping for a content item . The content item catalog may include searchable and or browsable listings and descriptions of content items available from the service provider computing device such as may be presented in the interface discussed above.

The service provider computing device may further include a delivery module that may deliver or make available for delivery a content item to the electronic device and or the user . For example in some instances the delivery module may facilitate the download of a content item to the electronic device over the network s following a purchase of access to the content item . In other instances the delivery module may provide for delivery of a hard copy of a content item to the user such as by delivery of a storage medium that maintains a copy of the content item or a printed version of the content item depending on the nature of the content item and the electronic device . The delivery module may also expose programmatic interfaces or APIs application programming interfaces that electronic devices can use to obtain content items and other services.

Furthermore in some implementations the service provider computing device may maintain user information . For example the user information may include one or more user accounts which may include user data such as user contact information a purchase history a user content item library records relating to content items purchased by the user as well as records of other transactions of the user with the service provider computing device . The user account may also include device information regarding various devices associated with a particular user account such as device ID number model number batch number or other information that may be used to associate a provisioning key and or on chip key with a particular electronic device associated with the user account .

As an example suppose that the device manufacturer has determined that the provisioning key on the electronic device has possibly been breached or otherwise compromised. Accordingly the secure computing device may be used to generate a new provisioning key for the electronic device . The new provisioning key may be encrypted using the on chip key for the electronic device and provided to the communication computing device . In some cases the provisioning key may sent to the communication computing device via a communication link while in other examples the provisioning key may be provided using removable storage media or the like.

The communication computing device may identify the electronic device to which to deliver the new provisioning key . As one example the communication computing device may identify the electronic device based on device information contained in user account information which may be similar to the account information and device information discussed above with respect to . Consequently the communication computing device may deliver the new provisioning key to the electronic device . For example the new provisioning key may be delivered as part of an update to software on the electronic device or may be delivered independently of any other updates.

Receipt of the new provisioning key may cause the provisioning module on the electronic device to decrypt the new provisioning key using the on chip key in a secure environment and store the new provisioning key on the electronic device . For example the new provisioning key may be stored using secure storage techniques as discussed above and may subsequently be used in place of the old provisioning key . In some cases the old provisioning key may be deleted from the electronic device . Further the version of the new provisioning key encrypted with the on chip key is removed or overwritten on the electronic device following decryption and re encryption of the new provisioning key with the device secret key not shown in .

In addition suppose that the device manufacturer would like to provide new secret material to the electronic device . For example a new DRM technology may have been introduced and the device manufacturer may like to upgrade previously sold electronic devices to enable use of the new DRM technology. Accordingly the secure computing device may encrypt the new secret material with the provisioning key for the appropriate corresponding electronic devices . The new secret material encrypted with the provisioning key may be provided to the communication computing device . The communication computing device may deliver the new secret material to the electronic devices e.g. as part of a periodic update or as part of a separate update.

Receipt of the new secret material on the electronic device may cause the provisioning module on the electronic device to decrypt the new secret material using the provisioning key stored on the electronic device in a secure environment and install the new secret material in a secure location on the electronic device such as using the device secret key discussed above. The version of the secret material encrypted with the provisioning key may then be deleted or overwritten on the electronic device . Furthermore while several examples have been discussed herein numerous variations will be apparent to those of skill in the art having the benefit of this disclosure.

At the one or more computing devices generate at least one on chip key and at least one provisioning key. For example the secure computing device in a secure area may use a random number generator to generate the keys.

At the one or more computing devices send to a computing device associated with a processor manufacturer the on chip key for placement in a storage location on a processor. For example the one or more computing devices of the device manufacturer may send the on chip key to a computing device of a processor manufacturer. The processor manufacturer may install the on chip key on a batch of processors to be incorporated into electronic devices manufactured by the device manufacturer.

At the one or more computing devices send to a manufacturing area computing device the provisioning key which has been encrypted using the on chip key. For example the manufacturing area computing device may place the provisioning key onto an electronic device having the processor installed. For instance the manufacturing area computing device may determine which model or batch of electronic device has the processor that corresponds to the on chip key that was used to encrypt the provisioning key. The electronic device may use the on chip key from the storage location of the processor to decrypt the provisioning key and store the provisioning key on the electronic device using a secure storage technology such as by encrypting the provisioning key with the device secrete key.

At the one or more computing devices send secret material encrypted using the provisioning key to the manufacturing area computing device. For example the manufacturing area computing device may place the secret material onto the electronic device. The electronic device may use the provisioning key to decrypt the secret material and may store the secret material using a secure storage technology such as by encrypting the secret material using the device secret key.

At the electronic device receives an encrypted provisioning key. For example the electronic device may receive the encrypted provisioning key from a manufacturing area computing device which in turn receives the encrypted provisioning key from a secure computing device that encrypted the provisioning key using an on chip key.

At the electronic device uses an on chip key maintained in a storage location on a processor of the electronic device to decrypt the provisioning key. For example the on chip key may be stored in one time programmable non volatile memory included with the processor. The provisioning key may be decrypted in a secure environment on the electronic device.

At the electronic device uses the provisioning key to decrypt secret material. For example the electronic device may have encrypted secret material already stored on the device or may receive encrypted secret material from the manufacturing area computing device. The electronic device may use the provisioning key to decrypt the secret material.

At the electronic device uses a device secret key to encrypt and store at least one of the provisioning key or the secret material for secure storage. For example as described above the device secret key may be known only to the electronic device and may be used to securely encrypt and store information on the electronic device.

At the electronic device deletes the received version of the provisioning key that was encrypted with the on chip key and the secret material that was encrypted with the provisioning key. For example as mentioned above the provisioning key encrypted by the on chip key may be stored initially on the electronic device without being encrypted using device secret key. Accordingly following decryption of the provisioning key in the secure environment and re encryption of the provisioning key using the device secret key the initial version of the encrypted provisioning key stored on the device may be deleted overwritten or otherwise removed. Similarly the version of the secret material encrypted with the provisioning key may be initially stored on the electronic device without using the device secret key. Accordingly following decryption of the secret material using the provisioning key in the secure environment and re encryption of the secret material using the device secret key the version of the secret material that was encrypted with the provisioning key and stored on the electronic device without being encrypted using electronic device secret key may also be deleted overwritten or otherwise removed.

At in response to a user input to present a content item the electronic device may use the secret material to present the content item on the electronic device and or to send content to another device such as for playback. For example during presentation of a content item that is control by DRM the electronic device may decrypt the secret material and use the secret material to decrypt the content item so that the content item maybe displayed or otherwise presented on the electronic device. Further as another example the electronic device may use the secret material to encrypt content prior to sending the content to another device such as for playback on a television.

At the computing device receives an encrypted provisioning key where the encrypted provisioning key has been encrypted using an on chip key. For example a manufacturing area computing device may receive the encrypted provisioning key and may further receive an identifier that indicates a model number or batch of electronic devices onto which the encrypted provisioning key should be installed. For example a particular on chip key may correspond to a particular batch of processors that are installed into a particular model or batch of electronic devices.

At the computing device installs the encrypted provisioning key on a computer readable media of at least one electronic device having a processor with the on chip key. For example computing device may install the encrypted provisioning key along with a software and data image that is installed on the electronic device during the manufacturing process. As another example the computing device may install the encrypted provisioning key separately from other software and data.

At the computing device causes execution of instructions on the electronic device to use the on chip key from the processor to decrypt the encrypted provisioning key. For example the computing device may cause the electronic device to execute a provisioning module that decrypts the provisioning key using the on chip key obtained from the processor of the device. The provisioning key may then be stored in a secure manner on the electronic device.

At the computing device receives secret material encrypted using the provisioning key. For example the secret material may have been encrypted using the provisioning key by the secure computing device and then transmitted to the manufacturing area computing device.

At the computing device installs the encrypted secret material on the computer readable media of the electronic device. For example the computing device may install the encrypted secret material as part of a software and data image that is installed on to the electronic device during the manufacturing process. Alternatively the computing device may install the encrypted secret material separately from other software or data.

At the computing device causes execution of additional instructions on the electronic device to decrypt the secret material using the provisioning key. For example the computing device may cause execution of the provisioning module on the electronic device which causes the provisioning module to use the provisioning key to decrypt the secret material. The decrypted secret material may then be stored in a secure manner on the electronic device.

At the computing device deletes the encrypted provisioning key and or the encrypted secret material from the computing device storage. For example following completion of a model production run a batch production run etc. or following receipt of a new provisioning key and new secret material for use on a next batch of devices or when reaching some other point at which the encrypted provisioning key and or the encrypted secret material will no longer be used during the manufacturing process the computing device may delete overwrite or otherwise remove from the storage of the computing device the provisioning key encrypted with the on chip key and the secret material encrypted with the provisioning key.

Additionally the example processes described herein are only examples of processes provided for discussion purposes. Numerous other variations will be apparent to those of skill in the art in light of the disclosure herein. Further while the disclosure herein sets forth several examples of suitable frameworks architectures and environments for executing the processes implementations herein are not limited to the particular examples shown and discussed.

Furthermore this disclosure provides various example implementations as described and as illustrated in the drawings. However this disclosure is not limited to the implementations described and illustrated herein but can extend to other implementations as would be known or as would become known to those skilled in the art. Reference in the specification to one implementation this implementation these implementations or some implementations means that a particular feature structure or characteristic described is included in at least one implementation and the appearances of these phrases in various places in the specification are not necessarily all referring to the same implementation.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described. Rather the specific features and acts are disclosed as example forms of implementing the claims.

