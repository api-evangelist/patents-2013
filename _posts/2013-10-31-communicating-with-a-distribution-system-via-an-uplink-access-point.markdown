---

title: Communicating with a distribution system via an uplink access point
abstract: The present disclosure discloses a system and method for communicating with a distribution system via an uplink access point. The system includes a processor and a memory storing instructions that, when executed, cause the system to: receive, at a first network device, an original packet from a client device; identify a source MAC address of the original packet as a MAC address of the client device; identify an IP address of the original packet as an IP address of the client device; generate a modified packet from the original packet by changing the source MAC address from the MAC address of the client device to a MAC address of the first network device; preserve the IP address in the modified packet to be the IP address of the client device; and forward the modified packet from the first network device to a second network device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09438555&OS=09438555&RS=09438555
owner: Aruba Networks, Inc.
number: 09438555
owner_city: Sunnyvale
owner_country: US
publication_date: 20131031
---
The present disclosure relates to communicating with distribution systems. In particular the present disclosure relates to a system and method for handling data communication between client devices and distribution systems via access points.

In the IEEE 802.11 standard an access point AP can be connected to a distribution system DS via a wired Ethernet connection. In some scenarios some access points may not have wired Ethernet connection to a distribution system and may use a wireless DS link to connect to the distribution system. However the implementation of the wireless DS link requires the use of a 4 address IEEE 802.11 frame format that is not supported by a majority of deployed access points.

In the following description several specific details are presented to provide a thorough understanding. While the context of the disclosure is directed to handling communication between client devices and distribution systems using access points one skilled in the relevant art will recognize however that the concepts and techniques disclosed herein can be practiced without one or more of the specific details or in combination with other components etc. In other instances well known implementations or operations are not shown or described in details to avoid obscuring aspects of various examples disclosed herein. It should be understood that this disclosure covers all modifications equivalents and alternatives falling within the spirit and scope of the present disclosure.

Embodiments of the present disclosure relate to communicating with distribution systems. In particular the present disclosure relates to a system and method for handling communication between client devices and distribution systems via access points. Specifically the system achieves benefits similar to those provided by a wireless DS link without using a 4 address IEEE 802.11 frame format that is required in the wireless DS link. Instead the system associates a first access point that has no Ethernet connection to a distribution system with an uplink access point using an IEEE 802.11 standard wireless link. The uplink access point has Ethernet connection to the distribution system and the first access point and the distribution system can communicate with each other via the uplink access point. The system supports Internet Protocol IP clients and can be extended to support other protocols such as IPv6.

According to embodiments of the present disclosure the first access point receives packets from its clients and applies selective transformations on the packets before forwarding the packets to the uplink access point. The first access point can provide a Layer 2 L2 link to its clients. However the first access point does not expose the media access control MAC address of any client because the first access point uses its own MAC address as the source MAC address to forward the packets to the uplink access point causing the uplink access point to relay the packets to the distribution system. The first access point also acts as an address resolution protocol ARP proxy for all its clients so that stations such as host devices in the distribution systems can send and receive data traffic to and from the clients of the first access point.

In some embodiments the first access point receives an original packet from a client device. The first access point identifies a source MAC address of the original packet as a MAC address of the client device and identifies a source IP address in the original packet as an IP address of the client device. The first access point generates a modified packet from the original packet by changing the source MAC address from the MAC address of the client device to a MAC address of the first network device. The first access point preserves the source IP address in the modified packet to be the IP address of the client device. The first access point forwards the modified packet to an uplink access point which forwards the modified packet to the distribution system.

In some embodiments the first access point receives an original DHCP discover message from a client device. The first access point identifies a first transaction ID in the original DHCP discover message. The first access point generates a second transaction ID. The first access point generates a modified DHCP discover message from the original DHCP discover message by replacing the first transaction ID in the original DHCP discover message with the second transaction ID and setting a broadcast bit of the modified DHCP discover message to a broadcast state. The first access point forwards the modified DHCP discover message to an uplink access point which forwards the modified DHCP discover message to the distribution system.

The controller is a hardware device and or software module that provide network managements which include but are not limited to controlling planning allocating deploying coordinating and monitoring the resources of a network network planning frequency allocation predetermined traffic routing to support load balancing cryptographic key distribution authorization configuration management fault management security management performance management bandwidth management route analytics and accounting management etc.

Moreover assuming that a number of access points are interconnected with the network controller . Each access point may be interconnected with zero or more client devices via either a wired interface or a wireless interface. In this example for illustration purposes only assuming that the client is associated with the access point via a wireless link and the client is associated with the access point via a wireless link. An access point generally refers to a network device that allows wireless clients to connect to a wired network. Access points usually connect to a controller via a wired network or can be a part of a controller in itself. In some examples an access point can be connected to another access point . For example the access point is connected to the access point

In some embodiments the access point has a wired Ethernet connection to a distribution system DS while the access point does not have any Ethernet connection to the distribution system . The access point connects to the access point as a client. For example the access point connects to the access point using an IEEE 802.11 standard wireless link. The access point that has the Ethernet connection can be referred to as an uplink access point for the access point and serves the access point and other clients such as the client . The access point can communicate with the distribution system via the uplink access point as described below in more detail.

Furthermore the controller can be connected to the router through zero or more hops in a layer 3 or layer 2 network such as L2 L3 Network . The router can forward traffic to and receive traffic from the Internet . The router generally is a network device that forwards data packets between different networks and thus creating an overlay internetwork. A router is typically connected to two or more data lines from different networks. When a data packet comes in one of the data lines the router reads the address information in the packet to determine its destination. Then using information in its routing table or routing policy the router directs the packet to the next different network. A packet is typically forwarded from one router to another router through the Internet until the packet gets to its destination.

The gateway is a network device that passes network traffic from local subnet to devices on other subnets. In some embodiments the gateway may be connected to a controller or be a part of the controller depending on the configuration of the controller .

The distribution systems are hardware devices and or software modules that manage network resource in the digital network environment . For example the distribution systems can be dynamic host configuration protocol DHCP servers such as Internet System Consortium ISC servers that can configure and distribute Internet Protocol IP addresses for different network devices and or client devices . The distribution system may also exchange data packets with different client devices . In some embodiments the distribution systems are in the same local area network LAN as the access point . The distribution systems may connect to the access point directly via Ethernet connection. Each distribution system may include one or more host devices not shown . Although two distribution systems are illustrated may include one or more distribution systems .

Web servers are hardware devices and or software modules that facilitate delivery of web content that can be accessed through the Internet . For example the web server may be assigned an IP address of 1.1.1.1 and used to host a first Internet website e.g. www.yahoo.com and the web server may be assigned an IP address of 2.2.2.2 and used to host a second Internet website e.g. www.google.com . Although two web servers are illustrated may include one or more web servers .

The client may be a computing device that includes a memory and a processor for example a laptop computer a desktop computer a tablet computer a mobile telephone a personal digital assistant PDA a mobile email device a portable game player a portable music player a reader device a television with one or more processors embedded therein or coupled thereto or other electronic device capable of accessing a network. Although only one client is connected to one access point in a plurality of clients can be connected to each access point .

It should be understood that in other embodiments the network device may be one of a network switch a network router a network controller a network gateway a network server etc. Further the network device may serve as a node in a distributed or a cloud computing environment. According to embodiments of the present disclosure network services provided by a network device solely or in combination with other wireless network devices include but are not limited to an Institute of Electrical and Electronics Engineers IEEE 802.1x authentication to an internal and or external Remote Authentication Dial In User Service RADIUS server an MAC authentication to an internal and or external RADIUS server a built in Dynamic Host Configuration Protocol DHCP service to assign wireless client devices IP addresses an internal secured management interface Layer 3 forwarding Network Address Translation NAT service between the wireless network and a wired network coupled to the network device an internal and or external captive portal an external management system for managing the network devices in the wireless network etc.

In some embodiments the access point includes a network interface capable of communicating to another access point and or a wired network a processor a memory and a storage device . The components of the access point are communicatively coupled to each other.

The network interface can be any communication interface which includes but is not limited to a modem token ring interface Ethernet interface wireless IEEE 802.11 interface e.g. IEEE 802.11n IEEE 802.11ac etc. cellular wireless interface satellite transmission interface or any other interface for coupling network devices. In some embodiments the network interface may be software defined and programmable for example via an Application Programming Interface API and thus allowing for remote control of the network device.

The processor includes an arithmetic logic unit a microprocessor a general purpose controller or some other processor array to perform computations and provide electronic display signals to a display device. Processor processes data signals and may include various computing architectures including a complex instruction set computer CISC architecture a reduced instruction set computer RISC architecture or an architecture implementing a combination of instruction sets. Although includes a single processor multiple processors may be included. Other processors operating systems sensors displays and physical configurations are possible. In some embodiments the processor includes a networking processor core that is capable of processing network data traffic.

The memory stores instructions and or data that may be executed by the processor . The instructions and or data may include code for performing the techniques described herein. The memory may be a dynamic random access memory DRAM device a static random access memory SRAM device flash memory or some other memory device. In some embodiments the memory also includes a non volatile memory or similar permanent storage device and media including a hard disk drive a floppy disk drive a CD ROM device a DVD ROM device a DVD RAM device a DVD RW device a flash memory device or some other mass storage device for storing information on a more permanent basis.

In some embodiments the memory stores a data communication application . The data communication application can be code and routines for handling communication between distribution systems and client devices . In some embodiments the data communication application can be implemented using hardware including a field programmable gate array FPGA or an application specific integrated circuit ASIC . In some other embodiments the data communication application can be implemented using a combination of hardware and software. In some embodiments the data communication application may be stored in a combination of the network devices or in one of the network devices. The data communication application is described below in more detail with reference to .

The storage device can be a non transitory memory that stores data for providing the functionality described herein. The storage device may be a dynamic random access memory DRAM device a static random access memory SRAM device flash memory or some other memory devices. In some embodiments the storage device also includes a non volatile memory or similar permanent storage device and media including a hard disk drive a floppy disk drive a CD ROM device a DVD ROM device a DVD RAM device a DVD RW device a flash memory device or some other mass storage device for storing information on a more permanent basis.

The communication module can be software including routines for handling communication between the data communication application and other components in the digital computing environment . In some embodiments the communication module sends and receives data to and from one or more of a client an uplink access point and other network devices via the network interface . For example the communication module receives packets from a client via the network interface and forwards the received packets to the DHCP module or the traffic handling module . In another example the communication module receives data describing a modified DHCP discover message from the DHCP module and sends the modified DHCP discover message to an uplink access point via the network interface . In some embodiments the communication module handles communication between components of the data communication application .

In some embodiments the communication module receives data from components of the data communication application and stores the data in the storage device . For example the communication module receives data describing a service client entry associated with a client device from the association module and stores the service client entry in the storage device . The service client entry is described below in more detail. In some embodiments the communication module retrieves data from the storage device and sends the data to components of the data communication application . For example the communication module retrieves data describing a DHCP state entry from the storage device and sends the DHCP state entry to the DHCP module . The DHCP state entry is described below in more detail.

The association module can be software including routines for establishing an association between the access point and an uplink access point and or associations between the access point and its clients . In some embodiments the association module establishes a link between the access point and an uplink access point . For example the association module associates the access point to the uplink access point using an uplink radio of the access point so that the access point acts as a client such as a standard IEEE 802.11 client of the uplink access point . The access point obtains an IP address as a standard client of the uplink access point .

In some embodiments the access point may have two radios in two different frequency bands. For example the access point has an uplink radio for associating with the uplink access point and a service radio for serving its own clients . An uplink radio of the access point can be a radio for setting up a link such as an IEEE 802.11 wireless link with the uplink access point . A service radio of the access point can be a radio for setting up links such as IEEE 802.11 wireless links with clients of the access point . In some other embodiments the uplink radio and the service radio can be the same radio in the same frequency band.

In some embodiments the association module uses the service radio to establish links between the access point and clients of the access point . For example after establishing the uplink association between the access point and the uplink access point the association module can instruct the access point to transmit periodic signals such as beaconing signals on the service radio indicating the access point is ready to accept clients on the service radio. After receiving the signals from the access point client devices can associate to the service radio of the access point and become clients of the access point .

The association module generates a service client entry for each client device that associates with the access point and adds the service client entry to a station table associated with the access point . The station table can be a table for storing data associated with the access point . In some embodiments data in the station table can be stored in other formats e.g. a tree format a graph format etc. rather than a tabular format. A service client entry associated with a client device may include one or more items associated with the client device . For example a service client entry includes a hardware address such as a media access control MAC address of an associated client device encryption keys negotiated between the client device and the access point and or an IP address for the client device etc. An example service client entry is illustrated with reference to . The IP address for the client device is initially blank until a unique IP address is allocated to the client device . The configuration of an IP address for a client device associated with the access point is described below in more detail.

The DHCP module can be software including routines for processing DHCP messages. Example DHCP messages include DHCP discover messages DHCP offer messages DHCP request messages and DHCP acknowledgement ACK messages etc. In some embodiments the DHCP module receives a DHCP discover message from a client device that is associated with the access point . The DHCP discover message received from a client device can be referred as an original DHCP discover message. The DHCP module identifies a transaction ID e.g. an XID from the original DHCP discover message. The transaction ID in the original DHCP discover message can be referred to as an originator XID. The DHCP module generates a new transaction ID for the DHCP discover message which can be referred to as a generated XID. In some examples the generated XID has a one to one correspondence with the originator XID.

The DHCP module creates a DHCP state entry for the client device . The DHCP state entry for the client device may include one or more of an originator XID field for storing the originator XID a generated XID field for storing the generated XID and or a broadcast field for storing a broadcast bit e.g. Bit of the flags field of the original DHCP discover message etc. The DHCP state entry may include the MAC address of the client device that serves as a client ID to identify the client device associated with the DHCP state entry.

After receiving the original DHCP discover message from the client device the DHCP module stores the broadcast bit of the original DHCP discover message in the broadcast field of the DHCP state entry. The DHCP module modifies the original DHCP discover message to generate a modified DHCP discover message by 1 replacing the originator XID in the original DHCP discover message with the generated XID and 2 setting the broadcast bit e.g. Bit of the flags field to the broadcast state. The broadcast state of the broadcast bit in the modified DHCP discover message can cause the distribution system to broadcast a message e.g. a DHCP offer message replying to the modified DHCP discover message in the network. The modified DHCP discover message includes a client ID for identifying the client device . For example the chaddr field in the modified DHCP discover message includes the MAC address of the client device which can serve as a client ID for identifying the client device .

The DHCP module forwards the modified DHCP discover message to the uplink access point causing the uplink access point to relay the modified DHCP discover message to a distribution system via the Ethernet connection. For example the uplink access point forwards the modified DHCP discover message to the distribution system as an Ethernet frame. The source address of the frame is the MAC address of the access point rather than the MAC address of the client device .

The distribution system receives the modified DHCP discover message from the uplink access point and generates a DHCP offer message that replies to the modified DHCP discover message. The distribution system sends the DHCP offer message as a broadcast packet because the broadcast bit in the flags field of the modified DHCP discover message is set to the broadcast state. The DHCP offer message generated by the distribution system can be referred to as an original DHCP offer message. The uplink access point receives the original DHCP offer message from the distribution system as a broadcast message and relays the original DHCP offer message to all the clients of the uplink access point including the access point .

The DHCP module stored on the access point receives the original DHCP offer message from the uplink access point . The DHCP module determines whether the original DHCP offer message is a reply message to any modified DHCP discover message generated by the DHCP module . For example the DHCP module extracts a transaction ID and a client ID e.g. an address in the chaddr fields from the original DHCP offer message. The DHCP module determines whether there is a DHCP state entry in the station table of the access point that has 1 a generated XID matching the extracted transaction ID and 2 a client ID matching the extracted client ID. If there is no matching DHCP state entry e.g. there is no generated XID in the station table matching the extracted transaction ID and no client ID matching the extracted client ID the DHCP module discards the original DHCP offer message.

However if there is a matching DHCP state entry e.g. there is a DHCP state entry having 1 a generated XID equal to the extracted XID and 2 a client s MAC address equal to the extracted client ID the DHCP module modifies the original DHCP offer message to generate a modified DHCP offer message by replacing the transaction ID in the original DHCP offer message with an originator XID in the matching DHCP state entry. The modified DHCP offer message is a reply message for the original DHCP discover message that has the same originator XID. The DHCP module forwards the modified DHCP offer message to the client device identified by the client ID. If the broadcast bit in the original DHCP discover message is set to the broadcast state the DHCP module sends the modified DHCP offer message as a broadcast packet. Otherwise the DHCP module sends the modified DHCP offer message as a unicast message to the client device .

The client device receives the modified DHCP offer message from the access point and generates a DHCP request message with a transaction ID to be the originator XID. The client device sends the DHCP request message to the access point . The DHCP module stored in the access point receives the DHCP request message from the client device . The DHCP request message originated from the client device can be referred as an original DHCP request message. The DHCP module identifies a transaction ID in the original DHCP request message as the originator XID. The DHCP module identifies a DHCP state entry associated with the client device that has the same originator XID as the original DHCP request message. The DHCP module stores the broadcast bit e.g. Bit of the flags field of the original DHCP request message in the broadcast field of the DHCP state entry.

The DHCP module modifies the original DHCP request message to generate a modified DHCP request message by 1 replacing the originator XID in the original DHCP request message with the generated XID in the DHCP state entry and 2 setting the broadcast bit to the broadcast state. The broadcast state of the broadcast bit in the modified DHCP request message can cause the distribution system to broadcast a message e.g. a DHCP ACK message that replies to the modified DHCP request message in the network. The modified DHCP request message includes a client ID for identifying the client device . For example the chaddr field in the modified DHCP request message includes the MAC address of the client device which can serve as a client ID for identifying the client device . The DHCP module forwards the modified DHCP request message to the uplink access point causing the uplink access point to relay the modified DHCP request message to a distribution system via the Ethernet connection. For example the uplink access point forwards the modified DHCP request message to the distribution system as an Ethernet frame. The source address of the frame is the MAC address of the access point rather than the MAC address of the client device .

The distribution system receives the modified DHCP request message from the uplink access point and generates a DHCP ACK message that replies to the modified DHCP request message. The distribution system sends the DHCP ACK message as a broadcast packet because the broadcast bit in the flags field of the modified DHCP request message is set to the broadcast state. The DHCP ACK message generated by the distribution system can be referred to as an original DHCP ACK message. The uplink access point receives the original DHCP ACK message from the distribution system as a broadcast message and relays the original DHCP ACK message to all the clients of the uplink access point including the access point .

The DHCP module stored on the access point receives the original DHCP ACK message from the uplink access point . The DHCP module determines whether the original DHCP ACK message is a reply message to any modified DHCP request message generated by the DHCP module . For example the DHCP module extracts a transaction ID and a client ID e.g. a MAC address in the chaddr fields from the original DHCP ACK message and determines whether there is a DHCP state entry in the station table of the access point that includes 1 a generated XID matching the extracted transaction ID and 2 a client ID matching the extracted client ID. If there is no matching DHCP state entry e.g. there is no generated XID matching the extracted transaction ID and no client ID matching the extracted client ID the DHCP module discards the original DHCP ACK message.

However if there is a matching DHCP state entry e.g. there is a DHCP state entry having 1 a generated XID equal to the extracted XID and 2 a client s MAC address equal to the extracted client ID the DHCP module modifies the original DHCP ACK message to generate a modified DHCP ACK message by replacing the transaction ID in the original DHCP ACK message with an originator XID in the matching DHCP state entry. The modified DHCP ACK message is a reply message for the original DHCP request message that has the same originator XID. The DHCP module forwards the modified DHCP ACK message to the client device identified by the client ID. If the broadcast bit in the original DHCP request message is set to the broadcast state the DHCP module sends the modified DHCP ACK message as a broadcast packet. Otherwise the DHCP module sends the modified DHCP ACK message as a unicast message to the client device .

The client device receives the modified DHCP ACK message and updates its IP address as the IP address confirmed in the DHCP ACK message. The DHCP handshake process described herein allocates a unique IP address to the client device . The DHCP module updates the IP address in the service client entry associated with the client device as the unique IP address allocated to the client device .

The ARP module can be software including routines for managing ARP operations for client devices associated with the access point . In some embodiments the ARP module can perform proxy ARP functions for managing data traffic from the distribution system to the client devices . For example assume a host device in the distribution system intends to send one or more packets to a client device where the client device is associated with the access point and has been allocated with an IP address. The host device sends a broadcast ARP request across the network. The uplink access point receives the broadcast ARP request and forwards the ARP request to the access point as a broadcast packet. The ARP module stored on the access point determines whether a target IP address in the ARP request is associated with any client device of the access point . For example the ARP module compares the target IP address with IP addresses stored in the service client entries and determines whether the target IP address is an IP address of any client of the access point . If the target IP address is not associated with any client of the access point the ARP module discards the ARP request. If the target IP address is associated with a client of the access point e.g. the target IP address is the IP address allocated to the client the ARP module generates an ARP response that responds to the ARP request. The ARP response maps the IP address of the client device to the MAC address of the access point allowing packets sent to the IP address of the client device to be uni casted to the MAC address of the access point .

In some embodiments the ARP module can perform ARP forwarding from client devices to the distribution system . For example the ARP module receives an ARP request from a client device associated with the access point and determines whether a target IP address included in the ARP request is associated with another client device of the access point . If the target IP address is an IP address of another client device the ARP module broadcasts the ARP request on the service radio of the access point allowing the other client device associated with the target IP address to send an ARP response to the client device . The ARP response may map the target IP address to the other client device s MAC address.

If the target IP address is not associated with any client devices of the access point the ARP module determines whether the target IP address is present in a DS IP table. The DS IP table stores IP to MAC mappings for host devices in the distribution system . For example the DS IP table stores one or more entries with each mapping a host device s IP address to the host device s MAC address. Initially the DS IP table is an empty table and the ARP module updates the DS IP table responsive to receiving ARP responses from host devices in the distribution system . If the target IP address is present in the DS IP table the ARP module generates an ARP response based on the DS IP table. The ARP response maps the target IP address to a MAC address of a host device associated with the target IP address. The ARP module sends the ARP response to the client device that sends the ARP request.

If the target IP address is not present in the DS IP table the ARP module generates a new ARP request including the target IP address and drops the original ARP request received from the client device . The ARP module sends the new ARP request from the access point to the uplink access point causing the uplink access point to forward or broadcast the ARP request to the distribution system . A host device in the distribution system that is associated with the target IP address receives the new ARP request and generates an ARP response mapping the host device s IP address to the host device s MAC address. The host device sends the ARP response to the uplink access point or broadcasts the ARP response in the network. The uplink access point forwards the ARP response to the access point or broadcasts the ARP response to all its clients including the access point . The ARP module stored on the access point receives the ARP response from the uplink access point and updates the DS IP table based on the ARP response. For example the ARP module adds an entry in the DS IP table where the entry describes the mapping between the host device s IP address and the host device s MAC address.

When the client device re transmits the ARP request including the target IP address to the access point the ARP module determines that the target IP address is now present in the updated DS IP table. The ARP module generates an ARP response mapping the target IP address to the host device s MAC address based on the updated DS IP table and sends the ARP response to the client device . In some embodiments the ARP module removes inactive entries or outdated entries in the DS IP table and adds new entries to the DS IP table.

The traffic handling module can be software including routines for handling data traffic related to client devices that are associated with the access point . For example the traffic handling module can handle uni cast IP traffic and or multi cast traffic between client devices and the distribution system as described herein. In some embodiments operations related to DHCP and ARP are implemented preceding the exchange of IP traffic. For example the exchange of DHCP messages is performed prior to the exchange of IP traffic.

In some embodiments the traffic handling module receives a packet from a client associated with the access point . The packet received from the client device can be referred to as an original packet. The traffic handling module identifies a source MAC address in the original packet as the MAC address of the client device . The traffic handling module identifies a source IP address in the original packet as the IP address of the client device . The traffic handling module modifies the original packet to generate a modified packet by changing the source MAC address from the MAC address of the client device to the MAC address of the access point so that the packet is treated as being originated from the access point . The traffic handling module preserves the source IP address in the modified packet to be the IP address of the client device . In this case the modified packet has a source MAC address as the MAC address of the access point and a source IP address as the IP address of the client device . The traffic handing module sends the modified packet to the uplink access point causing the uplink access point to forward the modified packet to a target IP address in the modified packet.

In some embodiments a host device in the distribution system intends to send a packet to an IP address of a client device associated with the access point . The host device uni casts the packet to the access point because the IP address of the client device is mapped to the MAC address of the access point . The traffic handling module determines that a destination IP address in the packet is the IP address of the client device and forwards the packet to the client device .

The roaming module can be software including routines for managing roaming of client devices . In some embodiments the roaming module detects a removal of a client device from the access point and deactivates service for the client device from the access point . For example the roaming module manages a time counter for each client device associated with the access point . The time counter counts a time duration that the client device is linked to the access point . If the time duration reaches a predetermined threshold indicating the association between the client device and the access point expires the roaming module removes the association between the client device and the access point . For example the roaming module invalidates the service client entry associated with the client device from the station table de authenticates the client device at the access point and stops responding as an ARP proxy for the client device etc.

In another example the roaming module monitors for DHCP discover messages and or DHCP request messages that are 1 received from the uplink access point via the uplink radio and 2 originated from client devices associated with the access point . If the roaming module receives from the uplink access point via the uplink radio a DHCP discover message and or a DHCP request message originated from a client device the roaming module determines that the client device has roamed away from the access point . The roaming module removes the association between the client device and the access point . For example the roaming module invalidates and removes the service client entry associated with the client device from the station table. In another example the roaming module de authenticates the client device at the access point to avoid a potential denial of service DOS attack where an attacker may cause the access point to invalidate the service client entry of the client device by injecting numerous fake DHCP discover messages and or DHCP request messages in the network. In yet another example the roaming module stops responding as an ARP proxy for the client device .

With reference to described below in some embodiments the first network device can be an access point that does not have Ethernet connection to the distribution system . The first network device connects to a second network device that has Ethernet connection to the distribution system . The second network device can be an uplink network device such as an uplink access point .

Referring to the DHCP module generates a modified DHCP discover message from the original DHCP discover message at least by 1 replacing the first transaction ID in the original DHCP discover message with the second transaction ID and 2 setting a broadcast bit of the modified DHCP discover message to a broadcast state operation . The DHCP module creates a DHCP state entry for the client device operation where the DHCP state entry includes an originator XID field for storing the first transaction ID a generated XID field for storing the second transaction ID and or a field for storing the broadcast bit of the original DHCP discover message etc. In some examples the DHCP state entry may include a client ID such as the MAC address of the client device . The DHCP module forwards the modified DHCP discover message to the second network device operation .

The second network device forwards the modified DHCP discover message to the distribution system causing the distribution system to generate an original DHCP offer message. The distribution system sends the original DHCP offer message to a broadcast address. The second network device receives the original DHCP offer message and re broadcasts it to all its clients including the first network device. The communication module receives the original DHCP offer message from the second network device operation . The DHCP module identifies that a transaction ID in the original DHCP offer message is the second transaction ID operation .

Referring to the DHCP module identifies a client ID in the original DHCP offer message is the MAC address of the client device operation . For example the DHCP module identifies that the chaddr fields in the original DHCP offer message include the client device s MAC address. The DHCP module determines that the original DHCP offer message is a message replying to the modified DHCP discover message based on operations and . The DHCP module generates a modified DHCP offer message from the original DHCP offer message at least by replacing the transaction ID of the original DHCP offer message with the first transaction ID operation . The modified DHCP offer message is a message replying to the original DHCP discover message. The DHCP module forwards the modified DHCP offer message to the client device according to a broadcast bit of the original DHCP discover message operation .

The client device receives the modified DHCP offer message and generates an original DHCP request message. The client device sends the original DHCP request message to the first network device. The communication module stored on the first network device receives the original DHCP request message from the client device operation . The original DHCP request message includes the first transaction ID. The DHCP module generates a modified DHCP request message from the original DHCP request message at least by 1 replacing the first transaction ID in the original DHCP request message with the second transaction ID and 2 setting a broadcast bit in the modified DHCP request message to a broadcast state operation . The DHCP module forwards the modified DHCP request message from the first network device to the second network device operation . The second network device forwards the modified DHCP request message to the distribution system causing the distribution system to generate an original DHCP ACK message. The distribution system sends the original DHCP ACK message to a broadcast address. The second network device receives the original DHCP ACK message and re broadcasts it to all its clients including the first network device.

Referring to the communication module receives the original DHCP ACK message from the second network device operation . The DHCP module identifies that a transaction ID in the original DHCP ACK message is the second transaction ID operation . The DHCP module identifies a client ID in the original DHCP ACK message is the MAC address of the client device operation . For example the DHCP module identifies that the chaddr fields in the original DHCP ACK message include the client device s MAC address. The DHCP module determines that the original DHCP ACK message is a message replying to the modified DHCP request message based on operations and . The DHCP module generates a modified DHCP ACK message from the original DHCP ACK message at least by replacing the transaction ID of the original DHCP ACK message with the first transaction ID operation . The modified DHCP ACK message is a message replying to the original DHCP request message. The DHCP module forwards the modified DHCP ACK message to the client device according to a broadcast bit of the original DHCP request message operation . After receiving the modified DHCP ACK message the client device is allocated with a unique IP address. The DHCP module also updates the IP address in the service client entry associated with the client device .

The ARP module sends the ARP response to the distribution system via the uplink access point operation . The distribution system can use the mapping relationship between the IP address of the client device and the MAC address of the first network device to send packets to the client device via the first network device. For example any packets sent to the IP address of the client device are sent to the first network device and the first network device relays the packets to the client device . In some embodiments the communication module stored in the first network device receives a packet from the distribution system operation . The traffic handling module determines that a destination IP address in the packet is the IP address of the client device operation . The traffic handling module forwards the packet to the client device operation .

If the target IP address is not associated with any client device of the first network device the ARP module determines whether the target IP address is present in a DS IP table operation . If the target IP address is present in the DS IP table the exemplary process moves to operation . Otherwise the exemplary process moves to operation . At operation the ARP module generates an ARP response based on the DS IP table. For example the ARP module generates an ARP response that includes an entry from the DS IP table where the entry maps the target IP address to an MAC address of a host device in the distribution system . The ARP module sends the ARP response to the client device operation .

Referring to if the target IP address is not present in the DS IP table the ARP module generates a second ARP request including the target IP address operation . The ARP module drops the first ARP request received from the client device operation . The ARP module sends the second ARP request to the uplink network device operation . The uplink network device forwards the ARP request to the distribution system . A host device in the distribution system which is associated with the target IP address generates an ARP response mapping the target IP address to the host device s MAC address. The host device broadcasts the ARP response in the network. The uplink network device receives the ARP response as a broadcast message and re broadcasts the ARP response to its client devices including the first network device.

The communication module stored on the first network device receives the ARP response from the uplink network device operation . The ARP module updates the DS IP table based on the ARP response operation . For example the ARP module adds an entry to the DS IP table where the entry describes the mapping between the target IP address and the MAC address of the host device. The communication module receives a third ARP request from the client device operation . The third ARP request includes the same target IP address. The ARP module generates an ARP response based on the updated DS IP table operation . The ARP response includes data describing a mapping between the target IP address and the host device s MAC address. The ARP module sends the ARP response to the client device operation .

The client device receives the modified DHCP offer message and generates an original DHCP request message . The client device sends the original DHCP request message to the first access point . The first access point modifies the original DHCP request message to generate a modified DHCP request message and sends the modified DHCP request message to the second access point . The second access point forwards the modified DHCP request message to the distribution system . The distribution system generates an original DHCP ACK message and sends the original DHCP ACK message to the second access point causing the second access point to forward the original DHCP ACK message to the first access point . The first access point modifies the original DHCP ACK message to generate a modified DHCP ACK message and sends the modified DHCP ACK message to the client device . At the completion of the DHCP handshake process the client device is allocated with a unique IP address.

The present disclosure may be realized in hardware software or a combination of hardware and software. The present disclosure may be realized in a centralized fashion in one computer system or in a distributed fashion where different elements are spread across several interconnected computer systems coupled to a network. A typical combination of hardware and software may be an access point with a computer program that when being loaded and executed controls the device such that it carries out the methods described herein.

The present disclosure also may be embedded in non transitory fashion in a computer readable storage medium e.g. a programmable circuit a semiconductor memory such as a volatile memory such as random access memory RAM or non volatile memory such as read only memory power backed RAM flash memory phase change memory or the like a hard disk drive an optical disc drive or any connector for receiving a portable memory device such as a Universal Serial Bus USB flash drive which comprises all the features enabling the implementation of the methods described herein and which when loaded in a computer system is able to carry out these methods. Computer program in the present context means any expression in any language code or notation of a set of instructions intended to cause a system having an information processing capability to perform a particular function either directly or after either or both of the following a conversion to another language code or notation b reproduction in a different material form.

As used herein digital device generally includes a device that is adapted to transmit and or receive signaling and to process information within such signaling such as a station e.g. any data processing equipment such as a computer cellular phone personal digital assistant tablet devices etc. an access point data transfer devices such as network switches routers controllers etc. or the like.

As used herein access point AP generally refers to receiving points for any known or convenient wireless access technology which may later become known. Specifically the term AP is not intended to be limited to IEEE 802.11 based APs. APs generally function as an electronic device that is adapted to allow wireless devices to connect to a wired network via various communications standards.

As used herein the term interconnect or used descriptively as interconnected is generally defined as a communication pathway established over an information carrying medium. The interconnect may be a wired interconnect wherein the medium is a physical medium e.g. electrical wire optical fiber cable bus traces etc. a wireless interconnect e.g. air in combination with wireless signaling technology or a combination of these technologies.

As used herein information is generally defined as data address control management e.g. statistics or any combination thereof. For transmission information may be transmitted as a message namely a collection of bits in a predetermined format. One type of message namely a wireless message includes a header and payload data having a predetermined number of bits of information. The wireless message may be placed in a format as one or more packets frames or cells.

As used herein wireless local area network WLAN generally refers to a communications network links two or more devices using some wireless distribution method for example spread spectrum or orthogonal frequency division multiplexing radio and usually providing a connection through an access point to the Internet and thus providing users with the mobility to move around within a local coverage area and still stay connected to the network.

As used herein the term mechanism generally refers to a component of a system or device to serve one or more functions including but not limited to software components electronic components electrical components mechanical components electro mechanical components etc.

As used herein the term embodiment generally refers an embodiment that serves to illustrate by way of example but not limitation.

Some portions of the detailed descriptions are presented in terms of algorithms and symbolic representations of operations on data bits within a computer memory. These algorithmic descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. An algorithm is here and generally conceived to be a self consistent sequence of steps leading to a desired result. The steps are those requiring physical manipulations of physical quantities. Usually though not necessarily these quantities take the form of electrical or magnetic signals capable of being stored transferred combined compared and otherwise manipulated. It has proven convenient at times principally for reasons of common usage to refer to these signals as bits values elements symbols characters terms numbers or the like.

It should be borne in mind however that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the foregoing discussion it is appreciated that throughout the description discussions utilizing terms including processing or computing or calculating or determining or displaying or the like refer to the action and processes of a computer system or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission or display devices.

Input output or I O devices including but not limited to keyboards displays pointing devices etc. can be coupled to the system either directly or through intervening I O controllers.

The particular naming and division of the modules routines features attributes methodologies and other aspects are not mandatory or significant and the mechanisms that implement the specification or its features may have different names divisions and or formats. Furthermore as will be apparent to one of ordinary skill in the relevant art the modules routines features attributes methodologies and other aspects of the disclosure can be implemented as software hardware firmware or any combination of the three. Also wherever a component an example of which is a module of the specification is implemented as software the component can be implemented as a standalone program as part of a larger program as a plurality of separate programs as a statically or dynamically linked library as a kernel loadable module as a device driver and or in every and any other way known now or in the future to those of ordinary skill in the art of computer programming.

It will be appreciated to those skilled in the art that the preceding examples and embodiments are exemplary and not limiting to the scope of the present disclosure. It is intended that all permutations enhancements equivalents and improvements thereto that are apparent to those skilled in the art upon a reading of the specification and a study of the drawings are included within the true spirit and scope of the present disclosure. It is therefore intended that the following appended claims include all such modifications permutations and equivalents as fall within the true spirit and scope of the present disclosure.

While the present disclosure has been described in terms of various embodiments the present disclosure should not be limited to only those embodiments described but can be practiced with modification and alteration within the spirit and scope of the appended claims. Likewise where a reference to a standard is made in the present disclosure the reference is generally made to the current version of the standard as applicable to the disclosed technology area. However the described embodiments may be practiced under subsequent development of the standard within the spirit and scope of the description and appended claims. The description is thus to be regarded as illustrative rather than limiting.

