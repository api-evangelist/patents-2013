---

title: Method and device for storing secured sent message data
abstract: Methods and devices for storing sent message data are described. The sent message data corresponds to a message sent to a destination by a communication device via a server. The method includes compiling a first portion of the message which has a plurality of components; applying security encoding to the first portion; and storing the first portion. The first portion includes at least one but not all of the plurality of components in the message, and pointers to the components not included in the first portion. A method of verifying sent message data on a communication device is also described.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09391780&OS=09391780&RS=09391780
owner: BlackBerry Limited
number: 09391780
owner_city: Waterloo
owner_country: CA
publication_date: 20130911
---
This is a Continuation Application of U.S. patent application Ser. No. 12 956 047 filed Nov. 30 2010 the contents of which are hereby incorporated by reference.

The present disclosure relates to the field of secure messaging and more specifically to the field of secure messaging on communication devices.

Messaging applications often store copies of messages sent from a communication device which can be later referenced resent or forwarded to other recipients. Additionally these messages may be secured by digitally signing encrypting the messages or both.

Storing secure copies of all sent messages which may include large attachments or repetitious data can require a significant amount of capacity on communication devices with limited storage. Accordingly it may be desirable to provide an improved approach to storing secured messages.

In accordance with one aspect there is provided a method of storing sent message data on a communication device. The sent message data corresponds to a message sent to a destination by the communication device via a server. The method includes compiling a first portion of the message which has a plurality of components applying security encoding to the first portion and storing the first portion. The first portion includes at least one but not all of the plurality of components in the message and pointers to the components not included in the first portion.

In another aspect the present application discloses a communication device. The communication device includes a processor and memory. The processor is configured to compile a first portion of a message being sent to a destination via a server the message including a plurality of components wherein the first portion includes at least one but not all of the plurality of components in the message and pointers to the components not included in the first portion apply security encoding to the first portion and store the first portion in the memory.

In another aspect the present application describes a method of verifying secured sent message data on a communication device. The method includes compiling a message from a first portion and determining whether a signature matches the message. The message includes a plurality of components wherein the first portion includes at least one but not all of the plurality of components and pointers to the components not included in the first portion and wherein compiling the message includes retrieving the components not included in the first portion using the pointers and combining the components included in the first portion with the retrieved components.

In yet a further aspect the present application describes a communication device that includes a processor a memory and an application stored in memory and containing computer executable instructions that when executed by the processor configure the processor to verify secured sent message data. The computer executable instructions configure the processor to compile a message from a first portion and determine whether a signature matches the message. The message includes a plurality of components wherein the first portion includes at least one but not all of the plurality of components and pointers to the components not included in the first portion and wherein compiling the message includes retrieving the components not included in the first portion using the pointers and combining the components included in the first portion with the retrieved components.

Messaging applications such as an email client are typically used to manage a user s messages and to facilitate the sending and receiving of messages via a messaging server. Incoming messages are generally received at and stored on the server and the messaging application connects to the server to access or download the incoming messages. In some systems incoming messages received at the server are pushed to the communication device. Outgoing messages are generally composed on the communication device and are sent to the server where they may be stored before being sent on to the destination. Both incoming and outgoing message may include text and attached data or file attachments such as images documents presentation files and other user data.

In the following description the term message is to be understood to include both the text and any attachments or attached data. Also while some of the following examples are discussed in the context of email messaging the present disclosure is not necessarily limited to email messages and may be applicable more broadly to any messaging system wherein messages are sent from a communication device to a remote destination via a server.

Most messaging applications allow a user to reply to an incoming message or forward an incoming message to another destination. In additional to any new text or attachments provided by a user these forwarded or reply messages may include the text of the original incoming message and or any attachments in the original incoming messages.

In some messaging applications messages may be digitally signed to provide sender authentication message integrity or non repudiation. A digital signature may be generated by the message sender by applying the sender s private cryptographic key and a cryptographic algorithm to the message. Upon receipt the recipient may verify the digital signature using the sender s public cryptographic key and compare it to the message. Since the digital signature can only be produced by the sender s private cryptographic key the recipient may be reassured of the sender s authenticity the message integrity or may use the signature to prevent repudiation of the message.

In some examples a hash or message digest may be generated from the message before applying the cryptographic algorithm. Generating or verifying a signature for the shortened hash is generally less computationally intensive than it is for the entire message. In the following description the phrase generating a signature or similar language contemplates both the scenario where a signature is generated from the hash of a message and the scenario where a signature is generated from the message itself.

The digital signature may be generated using any algorithm including but not limited to the Digital Signature Algorithm DSA Elliptic Curve DSA and the Rivest Shamir Adleman RSA algorithm. For further security the sender may use a third party certificate authority to certify ownership of the public key associated with the digital signature.

In some examples instead of or in addition to being signed the message may be encrypted by the sender to prevent unauthorized access to the message. For example the message may be encrypted using an encryption key and an encryption scheme such as Advanced Encryption Standard AES or Triple Data Encryption Standard Triple DES .

In accordance with one aspect of the present disclosure in some messaging systems portions of a message to be sent to a destination may be stored on the server and may or may not be stored on the communication device. In these systems when the communication device replies to or forwards a message for which portions are stored on the server the communication device may reduce data transmission costs by only sending the portions of the message which are not stored on the server. In some examples the communication device may not be required to store or to even have received the portions stored on the server.

When sending a message the communication device may be configured to store a local copy of the sent message for future reference or to allow the message to be resent or forwarded to another recipient. A digitally signed or encrypted message may be stored to provide a verifiable future reference for a message that was sent to a recipient. The stored message may also provide information regarding how the message was secured including for example whether the message was signed encrypted or both signed and encrypted. The message may also provide information about the method used to secure the message such as Secure Multipurpose Internet Mail Extensions S MIME or Pretty Good Privacy PGP .

In some examples the communication device may be configured to store only a portion of a sent message. By not saving the entire sent message the size of the saved sent message data may be reduced and the saving of duplicate attachments or message data may be avoided.

In the following description many of the described embodiments involve communication devices communicating with a server over a wireless network. However the present disclosure is not necessarily limited to wireless communications and may be applicable more broadly to any communications device configured to send messages to a remote destination via a server.

Reference is made to which shows in block diagram form an example communication system . The communication system includes a number of communication devices which may be connected to the remainder of system in any of several different ways. For illustrative purposes two instances of communication devices are depicted in each employing different example ways of connecting to system . Communication devices are connected to a wireless communication network which may comprise one or more of a Wireless Wide Area Network WWAN a Wireless Local Area Network WLAN or any other suitable network arrangements. In some embodiments the communication devices are configured to communicate over both the WWAN and WLAN and to roam between these networks. In some embodiments the wireless network may comprise multiple WWANs and WLANs .

The WWAN may be implemented as any suitable wireless access network technology. By way of example but not limitation the WWAN may be implemented as a wireless network that includes a number of base stations one of which is shown in each containing radio transmitting and receiving equipment adapted to provide wireless radio frequency RF network service or coverage to a corresponding area or cell. The WWAN is typically operated by a mobile network service provider that provides subscription packages to users of the mobile communication devices . The WWAN may be implemented as any appropriate wireless network including but not limited to any to one or more of the following wireless network types Mobitex Radio Network DataTAC GSM Global System for Mobile Communication GPRS General Packet Radio System TDMA Time Division Multiple Access CDMA Code Division Multiple Access CDPD Cellular Digital Packet Data iDEN integrated Digital Enhanced Network EvDO Evolution Data Optimized CDMA2000 EDGE Enhanced Data rates for GSM Evolution UMTS Universal Mobile Telecommunication Systems HSPDA High Speed Downlink Packet Access IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX . Other network types and technologies could also be used. Although WWAN is described as a Wide Area network that term is intended herein also to incorporate wireless Metropolitan Area Networks WMAN and other similar technologies for providing coordinated service wirelessly over an area larger than that covered by typical WLANs.

A wireless network gateway may be associated with the WWAN to connect the communication devices to transport facilities and through the transport facilities to a wireless connector system . Transport facilities may include one or more private networks or lines the public internet a virtual private network or any other suitable network. The wireless connector system may be operated for example by an organization or enterprise such as a corporation university or governmental department which allows access to a network such as an internal or enterprise network and its resources or the wireless connector system may be operated by a mobile network provider. In some embodiments the network may be realized using the Internet rather than an internal or enterprise network.

The wireless network gateway provides an interface between the wireless connector system and the WWAN which facilitates communication between the communication devices and other devices not shown connected directly or indirectly to the WWAN . Accordingly communications sent via the communication devices are transported via the WWAN and the wireless network gateway through transport facilities to the wireless connector system . Communications sent from the wireless connector system are received by the wireless network gateway and transported via the WWAN to the communication devices .

The WLAN comprises a wireless network which in some embodiments conforms to IEEE 802.11x standards sometimes referred to as Wi Fi such as for example any or all of the IEEE 802.11a 802.11b 802.11g or 802.11n standards. Other communication protocols may be used for the WLAN in other embodiments such as for example IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WIMAX or IEEE 802.20 also referred to as Mobile Wireless Broadband Access . The WLAN includes one or more wireless RF Access Points AP one of which is shown in that collectively provide WLAN service or coverage over an area.

The WLAN may be a personal network of the user an enterprise network or a hotspot offered by an internet service provider ISP a mobile network provider or a property owner in a public or semi public area for example. The access points are connected to an access point AP interface which may connect to the wireless connector system directly for example if the access point is part of an enterprise WLAN in which the wireless connector system resides or indirectly not shown via the transport facilities if the access point is a personal Wi Fi network or Wi Fi hotspot in which case a mechanism for securely connecting to the wireless connector system such as a virtual private network VPN may be desirable . The AP interface provides translation and routing services between the access points and the wireless connector system to facilitate communication directly or indirectly with the wireless connector system .

The wireless connector system may be implemented as one or more servers and is typically located behind a firewall . The wireless connector system manages communications including e mail messages to and from a set of managed communication devices . The wireless connector system also provides administrative control and management capabilities over users and communication devices which may connect to the wireless connector system .

The wireless connector system allows the mobile communication devices to access the network and connected resources and services such as a messaging server for example a Microsoft Exchange IBM Lotus Domino or Novell GroupWise email messaging server or other servers . In the context of the present disclosure the term other server encompasses both content servers for providing content such as internet content or content from an organization s internal servers as well as servers for implementing server based applications such as instant messaging IM applications.

In the messaging server and other servers appear separately from the wireless connector system however in other examples the messaging server or other servers may be at the same location as the wireless connector system .

The wireless connector system typically provides a secure exchange of data e.g. e mail messages personal information manager PIM data and IM data with the communication devices . In some embodiments communications between the wireless connector system and the communication devices are encrypted.

The wireless network gateway is adapted to send data packets received from the communication device over the WWAN to the wireless connector system . The wireless connector system then sends the data packets to the appropriate connection via a proxy server or directly to a server such as a messaging or other server. Conversely the wireless connector system sends data packets received for example from a server to the wireless network gateway which then transmits the data packets to the destination communication device . The AP interfaces of the WLAN provide similar sending functions between the communication device the wireless connector system and network connection point such as the messaging or other servers .

The messaging or other servers may be configured to receive messages from a communication device and send them to the proper destination via the network . In some examples the server may receive a first portion of the message from the communication device and combine it with the second portion of the message stored on the server before sending the combined message to its destination.

The network may comprise a private local area network metropolitan area network wide area network the public internet or combinations thereof and may include virtual networks constructed using any of these alone or in combination. A communication device may alternatively connect to the wireless connector system using a computer such as desktop or notebook computer via the network . A link may be provided for exchanging information between the communication device and computer connected to the wireless connector system . The link may comprise one or both of a physical interface and short range wireless communication interface. The physical interface may comprise one or combinations of an Ethernet connection Universal Serial Bus USB connection Firewire also known as an IEEE 1394 interface connection or other serial data connection via respective ports or interfaces of the communication device and computer . The short range wireless communication interface may be a personal area network PAN interface. A personal area network is a wireless point to point connection meaning no physical cables are required to connect the two end points. The short range wireless communication interface may comprise one or a combination of an infrared IR connection such as an Infrared Data Association IrDA connection a short range radio frequency RF connection such as one specified by IEEE 802.15.1 or the Bluetooth special interest group or IEEE 802.15.3a also referred to as UltraWideband UWB or other PAN connection.

It will be appreciated that the above described communication system is provided for the purpose of illustration only and that the above described communication system comprises one possible communication network configuration of a multitude of possible configurations for use with the mobile communication devices . The teachings of the present disclosure may be employed in connection with any other type of network and associated devices that are effective in implementing or facilitating wireless communication. Suitable variations of the communication system are intended to fall within the scope of the present disclosure.

Reference is now made to which illustrates a communication device in which example embodiments described in the present disclosure can be applied. The communication device is a two way communication device having data and voice communication capabilities and the capability to communicate with other computer systems for example via the Internet. Depending on the functionality provided by the communication device in various embodiments the device may be a multiple mode communication device configured for both data and voice communication a smartphone a mobile telephone or a PDA personal digital assistant enabled for wireless communication or a computer system with a wireless modem.

The communication device includes a rigid case not shown housing the components of the device . The internal components of the device are constructed on a printed circuit board PCB . The communication device includes a controller comprising at least one processor such as a microprocessor which controls the overall operation of the device . The processor interacts with device subsystems such as a wireless communication subsystem for exchanging radio frequency signals with the wireless network to perform communication functions. The processor interacts with additional device subsystems including a display screen such as a liquid crystal display LCD screen input devices such as a keyboard and control buttons flash memory random access memory RAM read only memory ROM auxiliary input output I O subsystems data port such as serial data port such as a Universal Serial Bus USB data port speaker microphone short range communication subsystem and other device subsystems generally designated as . Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions.

The device may comprise a touchscreen display in some embodiments. The touchscreen display may be constructed using a touch sensitive input surface connected to an electronic controller and which overlays the display screen . The touch sensitive overlay and the electronic controller provide a touch sensitive input device and the processor interacts with the touch sensitive overlay via the electronic controller.

The communication device may communicate with any one of a plurality of fixed transceiver base stations of the wireless network within its geographic coverage area. The communication device may send and receive communication signals over the wireless network after the required network registration or activation procedures have been completed.

The processor operates under stored program control and executes software modules stored in memory such as persistent memory for example in the flash memory . As illustrated in the software modules comprise operating system software and software applications which may include a web browser an instant messaging application and an email messaging application . In some example embodiments the functions performed by each of the applications and may each be realized as a plurality of independent elements and any one or more of these elements may be implemented as parts of other software applications . In some examples one or more applications are configured to send messages to a user defined destination via a messaging or other server .

In some examples the software modules may be configured to send messages to a destination when one portion of the message is on the communication device and another portion is on a server . In some examples the software modules may be configured to encrypt or digitally sign messages or portions of messages.

In some examples the software modules may include a data protection module which configures the processor to protect data such as message components stored in the flash memory or on the memory module . This may involve for example encryption password protection read only protection or any other file access related protection mechanisms. In some examples the data protection module may be part of the file system or operating system as illustrated in . Although the data protection module is illustrated as a separate module in in some examples the data protection module may be realized as a plurality of independent elements and any one or more of these elements may be implemented as parts of other software modules in the operating system software applications or otherwise.

The software modules or parts thereof may be temporarily loaded into volatile memory such as the RAM . The RAM is used for storing runtime data variables and other types of data or information. Although specific functions are described for various types of memory this is merely one example and a different assignment of functions to types of memory could also be used.

In some embodiments the auxiliary input output I O subsystems may comprise an external communication link or interface for example an Ethernet connection. The communication device may comprise other wireless communication interfaces for communicating with other types of wireless networks for example a wireless network such as an orthogonal frequency division multiplexed OFDM network or a GPS Global Positioning System subsystem comprising a GPS transceiver for communicating with a GPS satellite network not shown . The auxiliary I O subsystems may comprise a pointing or navigational tool input device such as a clickable trackball or scroll wheel or thumbwheel or a vibrator for providing vibratory notifications in response to various events on the device such as receipt of an electronic message or incoming phone call or for other purposes such as haptic feedback touch feedback .

In some embodiments the communication device also includes a removable memory card typically comprising flash memory and a memory card interface . Network access typically associated with a subscriber or user of the communication device via the memory card which may be a Subscriber Identity Module SIM card for use in a GSM network or other type of memory card for use in the relevant wireless network type. The memory card is inserted in or connected to the memory card interface of the communication device in order to operate in conjunction with the wireless network .

The communication device also stores other data in an erasable persistent memory which in one example embodiment is the flash memory . In various embodiments the data includes service data comprising information required by the communication device to establish and maintain communication with the wireless network . The data may also include user application data such as email messages address book and contact information calendar and schedule information notepad documents image files and other commonly stored user information stored on the communication device by its user and other data . The data stored in the persistent memory e.g. flash memory of the communication device may be organized at least partially into a number of databases each containing data items of the same data type or associated with the same application. For example email messages contact records and task items may be stored in individual databases within the device memory.

The serial data port may be used for synchronization with a user s host computer system not shown . The serial data port enables a user to set preferences through an external device or software application and extends the capabilities of the communication device by providing for information or software downloads to the communication device other than through the wireless network . The alternate download path may for example be used to load an encryption key onto the communication device through a direct reliable and trusted connection to thereby provide secure device communication.

In some embodiments the communication device is provided with a service routing application programming interface API which provides an application with the ability to route traffic through a serial data i.e. USB or Bluetooth Bluetooth is a registered trademark of Bluetooth SIG Inc. connection to the host computer system using standard connectivity protocols. When a user connects their communication device to the host computer system via a USB cable or Bluetooth connection traffic that was destined for the wireless network is automatically routed to the communication device using the USB cable or Bluetooth connection. Similarly any traffic destined for the wireless network is automatically sent over the USB cable Bluetooth connection to the host computer system for processing.

The communication device also includes a battery as a power source which is typically one or more rechargeable batteries that may be charged for example through charging circuitry coupled to a battery interface such as the serial data port . The battery provides electrical power to at least some of the electrical circuitry in the communication device and the battery interface provides a mechanical and electrical connection for the battery . The battery interface is coupled to a regulator not shown which provides power V to the circuitry of the communication device .

The short range communication subsystem is an additional optional component which provides for communication between the communication device and different systems or devices which need not necessarily be similar devices. For example the subsystem may include an infrared device and associated circuits and components or a wireless bus protocol compliant communication mechanism such as a Bluetooth communication module to provide for communication with similarly enabled systems and devices.

A predetermined set of applications that control basic device operations including data and possibly voice communication applications will normally be installed on the communication device during or after manufacture. Additional applications and or upgrades to the operating system or software applications may also be loaded onto the communication device through the wireless network the auxiliary I O subsystem the serial port the short range communication subsystem or other suitable subsystem . The downloaded programs or code modules may be permanently installed for example written into the program memory i.e. the flash memory or written into and executed from the RAM for execution by the processor at runtime. Such flexibility in application installation increases the functionality of the communication device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the communication device .

The communication device may provide two principal modes of communication a data communication mode and an optional voice communication mode. In the data communication mode a received data signal such as a text message an email message or Web page download will be processed by the communication subsystem and input to the processor for further processing. For example a downloaded Web page may be further processed by a browser application or an email message may be processed by the email messaging application and output to the display . A user of the communication device may also compose data items such as email messages for example using the input devices in conjunction with the display screen . These composed items may be transmitted through the communication subsystem over the wireless network .

In the voice communication mode the communication device provides telephony functions and operates as a typical cellular phone. The overall operation is similar except that the received signals would be output to the speaker and signals for transmission would be generated by a transducer such as the microphone . The telephony functions are provided by a combination of software firmware i.e. the voice communication module and hardware i.e. the microphone the speaker and input devices . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the communication device . Although voice or audio signal output is typically accomplished primarily through the speaker the display screen may also be used to provide an indication of the identity of a calling party duration of a voice call or other voice call related information.

Reference is now made to which shows in flowchart form a method of storing secured message data. In this example a message is sent from a communication device to a destination. The message includes a number of components including but not limited to text and attachments. In some examples one or more of the components in the message are on the communication device and some of the components may be stored on a server.

For illustrative purposes will be discussed in the context of an example scenario wherein the message being sent from the communication device is a forward of an original email. The original email consists of an image attachment and a text description both of which are stored on a messaging server. The message contains text comments and a portable document format PDF file attachment which are on the communication device as well as the original email s text and the original email s image attachment.

At event a first portion of the message is compiled. The first portion may include one or more but not all of the message components and pointers to the components not included in the first portion.

In some examples the pointers may be attachment headers. An attachment header is attachment metadata that does not include the actual attachment payload. In some examples attachment headers include the attachment name size and pointers to the attachment payload location.

In other examples the pointers may include filenames and the full file system or network paths to the components. In yet other examples the pointers may point to messaging database records or entries corresponding to the components. The pointers may point to components stored locally on the communication device or components stored remotely on the server.

In some examples if a component is stored both on the communication device and on the server the first portion may include a pointer to the location of the component on the communication device or to the location of the component on the server. In some of these examples the first portion may include multiple pointers to the same component a first pointer to the location of the component on the communication device and a second pointer to the location of the same component on the server.

In some examples if a component stored locally on the communication device is to be sent to the server as part of a message the pointer may point to a location where the component is to be stored on the server. In some of these examples two pointers may be compiled for the same component a first pointer pointing to the location of the component on the communication device and a second pointer pointing to location where the same component is to be stored on the server.

In the present description the term pointer is intended to include references such as explicit addresses or path names and less explicit references including non address specific references to a file object or item. For example a pointer may explicitly indicate a file name and path for locating a specific attachment within the directory structure of the memory of the communication device. In another example a pointer may be a reference to a file name or item including an original email or text without an explicit path or address. In one example the device may generate and include a unique identifier or number for the file or item in the pointer which may enable the server to locate its copy of the file or item based on correlation with the unique identifier or number. In the examples described herein pointers may include any such examples or other types of references to components of the message.

In one example the first portion may only include the new text component of the message. Text components may be plain text rich text HyperText Markup Language HTML Extensible Markup Language XML or any other text based message component. For example in the described scenario only the text comments on the communication device are compiled as part of the first portion while the PDF attachment and the original email s text and image attachment are excluded. The communication device may compile pointers to the PDF attachment the original email s text and the original email s image attachment as part of the first portion.

In another example the first portion may only include components that are on the communication device. For example in the described scenario the text comments and PDF attachment are compiled as part of the first portion while the original email s text and image attachment are excluded. The communication device may include pointers to the original email s text and image attachment as part of the first portion.

Notwithstanding the above examples the communication device may compile any subset of the message components as part of the first portion.

At event the communication device applies security encoding to the first portion of the message. Applying security encoding to the first portion may include digitally signing the first portion encrypting the first portion or both signing and encrypting the first portion. In some embodiments the security encoding applied to the first portion is based upon the security encoding applied to the message. For example if the communication device is configured to apply a certain security encoding to the message or if the server is configured to apply a certain security encoding to the message then the security encoding applied to the first portion may be the same type of security encoding applied to the complete message. In this manner the security encoding applied to the first portion saved on the communication device is indicative of the security encoding applied to the message sent to the destination.

In one embodiment to apply security encoding by digitally signing the first portion the communication device generates a digital signature for the first portion of the message. The signature for the first portion may be generated using any cryptographic algorithm as discussed above. In some examples the signature may be generated using standard message security mechanisms PGP or S MIME.

In some examples the pointers are not included with the first portion for the purposes of generating the digital signature. In other examples the pointers are included with the first portion when generating the digital signature. Including the pointers with the first portion affords the pointers the security applied to the first portion.

In some example embodiments to apply security encoding by encrypting the first portion the communication device may encrypt the first portion using an encryption key and any encryption scheme such as AES or Triple DES.

In yet other example embodiments the communication device may apply security encoding by both encrypting and signing the first portion.

At event the secured first portion including any pointers to components not in the first portion is stored on the communication device. If the first portion was digitally signed at event the signature for the first portion is also stored on the communication device. If the first portion was encrypted at event the encrypted first portion is stored on the device. The encryption key used to encrypt the first portion may also be stored on the communication device in some embodiments. In yet other embodiments in which the communication device is capable of re generating the encryption key the encryption key may not be stored on the communication device.

At event the communication device may optionally protect the message components stored on the communication device that were not included in the first portion. These components may be protected by the data protection module for example by encrypting the components by marking the components as read only by password protecting the components or by any other mechanism that prevents access or modification to the components.

In some examples when the data protection module is configured to protect all data and files on the communication device the message components stored on the communication device but not included in the first portion may be automatically protected by the data protection module .

In other examples the data protection module may be configured to only protect message components stored on the communication device not in the first portion and to leave all other files and data unprotected.

In other examples the data protection module may be configured to protect message components stored on the communication device not in the first portion using a different protection mechanism from the protection mechanism used for all other files and data on the communication device.

In some examples the data protection module may encrypt a message component not in the first portion with a first encryption key. The first encryption key may then be included in the first portion and encrypted when the first portion is encrypted. If the same component is subsequently part of a second message the first encryption key may be included in the first portion of the second message and thus is encrypted with the first portion of the second message such that a duplicate copy of the encrypted component is not created.

At event the communication device compiles applies security encoding to and stores a first portion of the email on the communication device. The first portion includes the email text as well as pointers to the attachments initially stored on the communication device and pointers to the text and attachments initially stored on the server.

Since copies of the local attachments are not stored with the first portion to ensure the integrity of the local attachments the communication device may be configured by the data protection module to protect the attachments initially stored on the communication device.

In some examples the data protection module may be configured to protect the attachments initially stored on the communication device by one of the example mechanisms described above.

At event the communication device sends a local composition of the email to the messaging server . The local composition includes the email text the attachments initially stored on the communication device and pointers to the text and attachments initially stored on the server.

At event the messaging server compiles the message by combining the email text and attachments initially stored on the communication device received in the local composition with the remote text and attachments stored on the messaging server . The messaging server may store a copy of the email text and the attachments initially on the communication device. In some examples the messaging server may encrypt or sign the compiled message .

In some examples before sending the message to the destination the messaging server may at optional event generate and send a hash for the message to the communication device . The communication device at optional event signs the hash and sends the resulting message signature to the messaging server . The communication device may store the signature for the message with the first portion and the messaging server may send the signature to the destination with the message .

As described above the pointers to the attachments initially stored on the communication device may point to their location on the communication device to the copy on the messaging server after the messaging server receives the attachments in the local composition or to both locations. In one embodiment the pointer to the attachments on the messaging server may include a unique identifier or ID code generated by the communication device in order to facilitate later identification of the attachments at the server. The server may store the received attachments in association with their respective unique identifiers.

At event the communication device compiles applies securing encoding to and stores a first portion of the email on the communication device. The first portion includes the email text and pointers to the attachments initially stored on the communication device. If the communication device applies security encoding by signing the first portion the signature may be stored with the first portion .

At event the communication device may apply security encoding to the entire message and sends the message to the messaging server . If the communication device applies security encoding by signing the entire message the communication device may store a copy of the signature for the entire message with the first portion .

At event the messaging server forwards the message received from the communication device on to the destination . The messaging server may store a copy of the attachments initially stored on the communication device.

In some examples the communication device may be configured by the data protection module to protect the local attachments in any of the manners as described above.

As described above the pointers to the attachments initially stored on the communication device may point to their location on the communication device to the copy that will be stored on the messaging server after the messaging server receives the attachments in the message or to both locations.

In any of the above examples in which the first portion is signed the first portion can be directly verified against the signature for the first portion by using the verification algorithm corresponding to the algorithm used to generate the signature. In some examples this includes verifying the signature for the first portion and comparing it either directly to the first portion or to a hash of the first portion.

In the examples above in which the communication device is configured to store the first portion and the complete message signature in order to verify on the communication device that the complete message matches the complete message signature the communication device may be configured to compile the complete message before the comparison can be performed.

To compile the message the communication device may be configured to retrieve the components not included in the first portion using the pointers stored with the first portion. In some examples the pointers may point to components stored on the communication device which may have to be decrypted before they can be accessed. In some examples the pointers may point to components stored on a server which may have to be requested and downloaded onto the communication device.

After retrieving all the components the communication device may combine the components to form the complete message which can be verified against the signature.

The above described embodiments of the present disclosure are intended to be examples only. Alterations modifications and variations may be effected to the particular embodiments by those skilled in the art having the benefit of the present disclosure without departing from the scope of the disclosure which is defined by the claims appended hereto. The subject matter described herein and in the recited claims intends to cover and embrace all suitable changes in technology.

