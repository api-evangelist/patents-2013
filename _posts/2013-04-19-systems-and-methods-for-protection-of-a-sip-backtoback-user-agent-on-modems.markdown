---

title: Systems and methods for protection of a SIP back-to-back user agent on modems
abstract: Systems and methods are provided for authenticating Internet Protocol (IP) Multimedia Subsystem (IMS) applications in a User Equipment (UE). A method includes: receiving a first Session Initiation Protocol (SIP) REGISTER message from an IMS application operating on the UE; transmitting a response message to the IMS application based on the received first SIP REGISTER message; receiving a second SIP REGISTER message from the IMS application operating on the UE; determining authentication for the IMS application based on the received second SIP REGISTER message from the IMS application operating on the UE; and based on the step of determining authentication for the IMS application, if the IMS application is authorized, then transmitting information associated with the first and second SIP REGISTER messages toward a SIP node or if the IMS application is unauthorized, then discarding data associated with the first and second SIP REGISTER messages.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09027088&OS=09027088&RS=09027088
owner: Ericsson Modems SA
number: 09027088
owner_city: le Grand-Saconnex
owner_country: CH
publication_date: 20130419
---
The embodiments of the subject matter disclosed herein generally relate to communication devices and more particularly to systems methods and devices for protection of a Session Initiation Protocol SIP Back to Back User Agent B2BUA on modems in such communication devices.

During the past years the interest in using mobile and landline wireline computing devices in day to day communications has increased. Desktop computers workstations and other wireline computers currently allow users to communicate for example via e mail video conferencing and instant messaging IM . Mobile devices for example mobile telephones handheld computers personal digital assistants PDAs etc. also allow users to communicate via e mail video conferencing IM and the like. Mobile telephones have conventionally served as voice communication devices but through technological advancements they have recently proved to be effective devices for communicating data graphics etc. Wireless and landline technologies continue to merge into a more unified communication system as user demand for seamless communications across different platforms increases which in turn creates more usage and leads to more services and system improvements. Additionally these communication systems can evolve into new generations or partial generations of communication systems.

Various systems and methods have been used to deliver and or request information between devices nodes and networks in support of customer demand. In the context of networking applications and components such as user equipments UEs routers and gateways networking systems are processing an increasing amount of data bandwidth year after year. With the rapidly growing popularity of the Internet and various accessible content on fixed and mobile networks many networking systems often need to process more data offer more bandwidth and to quickly introduce more features to the system while minimizing any negative impact on the currently existing capabilities of the systems themselves. Additionally there is a desire to minimize the ability of malicious intrusion while continuing to improve the capabilities of these various systems and their components including UEs e.g. mobile phones.

Some UEs can execute a number of Internet Protocol IP Multimedia Subsystem IMS applications and it is expected that this will be true for more UEs in the future. In many cases Internet Protocol IP Multimedia Subsystem IMS services and applications are deployed on a UE. IMS applications when initially executed on a UE will typically attempt to get authorization to connect through a radio access network RAN that the UE is connected to to a node in an IMS network. If multiple IMS applications are attempting to obtain access authorization at a same similar time this can generate a large amount of traffic. This can be further complicated if the IMS application attempting to gain access authorization is not a desirable IMS application from the point of view of the user the operator network or other service providers potentially involved.

For example a malicious application operating on a UE may attempt authorization for various purposes like utilizing IMS to send data at low or no cost setting up hidden IMS calls to premium rate numbers and performing different denial of service attacks.

Accordingly it would be desirable for communication devices to be protected from usage by malicious applications.

Exemplary embodiments describe among other things that a Back to Back User Agent B2BUA on a modem subsystem of a User Equipment UE authenticates applications that try to make use of the B2BUA. The B2BUA on the modem subsystem shares a common secret with trusted applications and authenticates the applications by for example reusing the standard Session Initiation Protocol SIP Authentication that is normally used for authentication of users between a SIP UA and a SIP registrar. This means that among other things no new Application Programming Interface API between the Application Processing Engine APE and the modem has to be introduced.

According to an exemplary embodiment there is a method for authenticating IMS applications in a UE the method includes receiving a first Session Initiation Protocol SIP REGISTER message from an IMS application operating on the UE transmitting a response message to the IMS application based on the received first SIP REGISTER message receiving a second SIP REGISTER message from the IMS application operating on the UE determining authentication for the IMS application based on the received second SIP REGISTER message from the IMS application operating on the UE based on the step of determining authentication for the IMS application if the IMS application is authorized then transmitting information associated with the first and second SIP REGISTER messages toward a SIP node or if the IMS application is unauthorized then discarding data associated with the first and second SIP REGISTER messages.

According to another exemplary embodiment there is a User Equipment UE for authenticating Internet Protocol IP Multimedia Subsystem IMS the UE includes a processor in conjunction with a memory and a transceiver configured to perform the functions of a Back to Back User Agent B2BUA function which is configured to perform the steps of receiving a first Session Initiation Protocol SIP REGISTER message from an IMS application operating on the UE transmitting a response message to the IMS application based on the received first SIP REGISTER message receiving a second SIP REGISTER message from the IMS application operating on the UE determining authentication for the IMS application based on the received second SIP REGISTER message from the IMS application operating on the UE and based on the step of determining authentication for the IMS application if the IMS application is authorized then transmitting information associated with the first and second SIP REGISTER messages toward a SIP node or if the IMS application is unauthorized then discarding data associated with the first and second SIP REGISTER messages.

The following detailed description of the exemplary embodiments refers to the accompanying drawings. The same reference numbers in different drawings identify the same or similar elements. Additionally the drawings are not necessarily drawn to scale. Also the following detailed description does not limit the invention.

Reference throughout the specification to one embodiment or an embodiment means that a particular feature structure or characteristic described in connection with an embodiment is included in at least one embodiment of the subject matter disclosed. Thus the appearance of the phrases in one embodiment or in an embodiment in various places throughout the specification is not necessarily referring to the same embodiment. Further the particular features structures or characteristics may be combined in any suitable manner in one or more embodiments.

According to exemplary embodiments and in order to address among other things the problems discussed in the Background a Back to Back User Agent B2BUA can be installed on a modem subsystem of a user equipment UE which can authenticate applications e.g. Internet Protocol IP Multimedia Subsystem IMS applications that try to make use of the B2BUA when attempting to gain access authorization to operate in a network. The B2BUA which is also a Session Initiation Protocol SIP B2BUA as used herein is considered to be a logical function which separates calls and or communication sessions into two separate legs and mediates SIP signaling between the call or session ends. In other words the SIP B2BUA can perform the functions of a user agent server and the functions of a user agent client. In this context B2BUAs differ from proxy servers in that B2BUAs are capable of providing a wider range of features e.g. the B2BUAs participate in requests and maintain dialog state information for all active IMS applications and not just the traditional feature of a proxy server e.g. to connect clients.

The B2BUA on the modem subsystem can share a common secret with trusted applications and authenticates the applications by for example reusing the standard SIP Authentication that is normally used for authentication of users between a SIP User Agent UA and a SIP registrar. This means that among other things no new Application Programming Interface API between an Application Processing Engine APE and the modem on a UE has to be introduced. According to some embodiments the B2BUA authenticates all of the applications which attempt to use the B2BUA. According to other exemplary embodiments the B2BUA may authenticate only a subset of all of the applications which attempt to use the B2BUA. Prior to describing these systems and methods an environment in which these systems and methods can be used will first be described with respect to .

According to an exemplary embodiment includes a UE which is in communication with a radio access network RAN which can facilitate communications between the UE and an IMS network . The RAN can be a Long Term Evolution LTE RAN or other type of legacy RAN such as a Universal Mobile Telecommunications System UMTS RAN a Code Division Multiple Access CDMA RAN or a Global System for Mobile Communications GSM RAN. Additionally a user s home can include multiple devices e.g. IPTV and personal computer PC which can use services provided by the IMS network . IPTV and PC can communicate with a home gateway GW which in turn is in communications with an operator network which can communicate with the IMS network i.e. data can be sent back and forth for the IPTV and PC to the IMS network via the home GW and operator network . The IMS network can include a Call Session Control Function CSCF and a plurality of application servers e.g. APP Server1 and APP Server2 .

Communications originating from the UE the IPTV and the PC can go to the CSCF in the IMS network prior to being forwarded on to the application servers and or . While the application servers and are shown as being a part of the IMS network they can be located in other networks. The CSCF can represent one or more Proxy P CSCFs and or one or more Serving S CSCFs. While only certain networks communication nodes devices and associated communication links are shown it is to be understood that this is a simplified representation and that more or fewer networks nodes devices and communication links can be used.

According to an embodiment parts of the UE e.g. a mobile phone can include a modem subsystem and an Application Processing Engine APE . In many cases IMS services can be deployed both on the modem subsystem and the APE. A telephony oriented IMS service e.g. Voice over LTE or multimedia telephony IMS service is naturally deployed on the modem subsystem as a counterpart to the circuit switched CS telephony service. A rich communication IMS service e.g. Rich Communication Suite RCS Presence and file transfer is naturally deployed on the APE close to deployment of phone book and file system. An APE can consist of a central processing unit CPU system which executes an operating system and applications. RCS Presence is an IMS service that can provide the status of contacts in e.g. a phone book. The status may be for example busy available or offline.

According to an exemplary embodiment as shown in the system of a SIP B2BUA can be deployed on the modem subsystem of the UE . The SIP B2BUA captures all of the SIP messages having as their destination the outbound SIP proxy server P CSCF . The SIP B2BUA 100 can merge SIP REGISTER messages from all running IMS services e.g. IMS service so that one single SIP REGISTER message carries information about all running IMS services e.g. IMS applications to the SIP registrar in the IMS network .

Furthermore the SIP B2BUA on the modem subsystem can handle authentications and the Security Association SA to the outbound SIP proxy server P CSCF prior to service requests being passed onto an application server via an S CSCF . This can be done by the B2BUA for all received requests or for a subset of the received requests. The SIP B2BUA thus can autonomously generate and transmit SIP response messages which include response code 401 and or 407. The 401 code message or the 407 code per RFC 3261 can be issued by the B2BUA in response to a received request for access authorization by an IMS application on either the APE or the IMS service when there is either an incorrect Authorization header or no Authorization header as determined by the SIP B2BUA . This means that it can be desirable for there to be a trusted relationship between the SIP B2BUA on the modem subsystem and all IMS services and which can be IMS applications both on the modem subsystem and the APE .

However in systems and devices such as the UE shown in any application which is capable of using SIP can attempt to send SIP messages to the outbound SIP proxy server P CSCF . According to an embodiment the SIP messages are captured all or a subset as desired by the SIP B2BUA on the modem subsystem . However using conventional means since the SIP B2BUA has been authenticated by the P CSCF and has a Security Association SA with the P CSCF any application can make use of that authorization. For example even a malicious application may use this authorization for various purposes like utilizing IMS to send data at low or no cost setting up hidden IMS calls to premium rate numbers and performing different denial of service attacks. An example of a UE which is running multiple applications of which some are malicious is shown in . Exemplary systems and methods can be implemented onto the architecture shown in for the environment shown in to reduce and or eliminate the effect of these malicious attacks as are described below in more detail.

According to an embodiment shows the UE with its component functions of the APE and modem with its B2BUA . Also included are a plurality of functions represented by SIP1 SIP2 SIP3 and SIP4 which have IMS applications which desire to access functions not located on the UE . For this example let SIP3 be a malicious IMS application. As can be seen in all of the requests are routed to the B2BUA prior to any traffic being transmitted from the UE to the SIP Proxy P CSCF . In this case routing to the B2BUA is desirable in case any of the requests are malicious requests for denying the malicious requests access authorization to services in a network and to potentially reduce the quantity of message requests going from the UE to the SIP Proxy P CSCF .

Referring again to according to an embodiment the SIP B2BUA authenticates all applications or alternatively a subset of all of the applications e.g. the subset excluding one or more explicitly trusted applications and authorizes only trusted applications using standard SIP Authentication mechanisms e.g. the Hypertext Transfer Protocol HTTP Basic Authorization or the HTTP Digest Access Authorization specified in Request For Comments RFC 3261 and RFC 2617 which are incorporated herein by reference. For example the SIP B2BUA performs the steps signals shown in .

According to an embodiment when for example the SIP B2BUA receives a SIP REGISTER message the B2BUA can discard all data from applications that have not yet sent any SIP REGISTER message s . As shown by signal step the B2BUA responds with a 401 Unauthorized message to the first SIP REGISTER message received from any IMS application . Stated differently when the B2BUA receives the SIP REGISTER message from an application the B2BUA requests that that particular application authenticate itself prior to allowing the requesting application to use the SIP B2BUA .

In response to the 401 Unauthorized message the IMS application which sent the first SIP REGISTER message sends a further message e.g. SIP REGISTER message which provides the B2BUA with authentication information associated with the requesting IMS application e.g. associated with the shared trusted secret mentioned above. The B2BUA evaluates the authentication information e.g. the authorization header field in the SIP REGISTER message from that application to determine if the IMS application is authorized or not. If the application is authorized then the B2BUA forwards all SIP messages from that application on to the P CSCF e.g. after further handshaking authorization with that node as shown by signals steps . Alternatively if the application is not authorized the B2BUA discards all data received from that application . Additionally the B2BUA may either respond with e.g. a 403 Forbidden message or no message at all to the unauthorized application.

In one embodiment SIP B2BUA authenticates all or some applications using HTTP Digest Access Authentication as described for example in RFC 2617 using e.g. username and password. One advantage with HTTP Digest Access Authentication is that passwords are not sent in the clear between applications and SIP B2BUA . Passwords can be stored either in the clear or encrypted in the SIP B2BUA . MD5 is a Message Digest algorithm is cryptographic hash function. An example of the messages shown in are shown in . shows the SIP REGISTER message from the IMS App and does not include desired authorization information. illustrates the Unauthorized message requesting authentication using the HTTP Digest Access Authentication procedure and shows the SIP REGISTER message from the IMS App and includes desired authorization information . Regarding these Figures are purely illustrative in representing the content of the transmissions between the IMS App to the SIP B2BUA other more specific details can be included which more accurately describe both the IMS App and the SIP B2BUA e.g. the From and To content can be modified based on the correct description of both the IMS App and the SIP B2BUA .

In another embodiment SIP B2BUA authenticates all or some applications using HTTP Basic Access Authentication RFC 2617 . This can be performed in a similar fashion as shown in by modifying the sections which use the HTTP Digest Access Authentication in an appropriate fashion for using the HTTP Basic Access Authentication. Additionally as for the HTTP Digest Access Algorithm the HTTP Basic Access Authentication can be used to authenticate all or some of the captured received IMS applications.

According to an embodiment security and authorization can also be performed through user names and passwords which can for example be defined by Original Equipment Manufacturer OEM operations for trusted IMS application developers and or for trusted IMS applications. OEM can store user names and passwords on the modem subsystems and can also revoke passwords by updating suitable memory locations in the modem subsystem. These user names and passwords can be stored in a persistent memory in the modem subsystem . Similarly the usernames passwords which are defined by OEM can thus be shared with IMS application developers typically trusted IMS application developers and provided hidden in the IMS application as part of the software development or provided during the IMS application installation. According to an embodiment as shown in above the username and password s are used together for authorization. Additionally OEMs may revoke passwords by Firmware Over the Air update s of the persistent memory in the modem subsystem or the modem itself if present .

According to another embodiment it may be desirable for B2BUA to protect itself from usage from other devices with other IP addresses. The SIP B2BUA can discard data from other Internet Protocol IP addresses than the IP address associated with the B2BUA . Additionally the B2BUA and all IMS applications in the device have the same IP address. This can be performed alternatively or in addition to other embodiments described herein.

Among other advantages and benefits these embodiments enable the SIP B2BUA on the modem subsystem to be protected from usage from malicious applications by authenticating all or some applications without the requirement of providing a new API between the APE and the modem subsystem .

The exemplary embodiments described above provide for authentication of applications e.g. IMS applications by a B2BUA in a modem subsystem of a device e.g. a mobile phone. An exemplary communications UE e.g. mobile phone which can provide such authentication is illustrated in . Therein one or more processor s operate to perform operations e.g. by executing software code which can be stored in one or more memory units or devices . These operations and or software code include those associated with among other things the APE IMS services and modem subsystem to include the B2BUA described above with respect to . The UE can also include a transceiver which enables the device to communicate over a suitable air interface by transmitting and receiving radio signals. The modem subsystem may be a physical or a logical entity within the UE . The modem subsystem can be a part of the transceiver use a portion of the transceiver or be a separate portion of the UE as desired. These signals can include among other things messages forwarded by the SIP B2BUA toward a SIP node e.g. SIP Proxy P CSCF for authorized IMS applications as described above.

Utilizing the above described exemplary systems according to exemplary embodiments a method for authenticating IMS applications in a UE is shown in the flowchart of . The method includes at step receiving a first Session Initiation Protocol SIP REGISTER message from an IMS application operating on the UE at step transmitting a response message to the IMS application based on the received first SIP REGISTER message at step receiving a second SIP REGISTER message from the IMS application operating on the UE at step determining authentication for the IMS application based on the received second SIP REGISTER message from the IMS application operating on the UE and at step based on the step of determining authentication for the IMS application if the IMS application is authorized then transmitting information associated with the first and second SIP REGISTER messages toward a SIP node or if the IMS application is unauthorized then discarding data associated with the first and second SIP REGISTER messages.

According to an exemplary embodiment there is a method for authenticating IMS applications in a device the method comprising receiving at a B2BUA operating on a modem subsystem a SIP REGISTER message from one of the applications requesting by the B2BUA authentication information from the one of the applications determining by the B2BUA whether the one of the applications is authorized to use the B2BUA and if the one of the applications is authorized forwarding by the B2BUA messages and or data received from the one of the applications.

According to another exemplary embodiment there is a method for authenticating an IMS application operating in a device the method comprising receiving by a B2BUA a request from the IMS application requesting by the B2BUA authentication information from the IMS application evaluating by the B2BUA the authentication information to determine whether the IMS application is authorized to send messages and if the IMS application is authorized forwarding by the B2BUA messages received from the authorized IMS application toward a SIP node.

According to another exemplary embodiment there is a communication device for authenticating IMS applications operating in the communication device the communication device including at least one processor configured to execute the IMS applications and a B2BUA wherein the at least one processor is further configured to perform the functions described above with respect to either of the methods described in the previous two paragraphs.

The above described exemplary embodiments are intended to be illustrative in all respects rather than restrictive of the present invention. Thus the present invention is capable of many variations in detailed implementation that can be derived from the description contained herein by a person skilled in the art. No element act or instruction used in the description of the present application should be construed as critical or essential to the invention unless explicitly described as such. Also as used herein the article a is intended to include one or more items.

