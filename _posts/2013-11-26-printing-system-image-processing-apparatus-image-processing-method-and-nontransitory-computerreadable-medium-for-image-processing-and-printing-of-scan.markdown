---

title: Printing system, image processing apparatus, image processing method, and non-transitory computer-readable medium for image processing and printing of scanned image data
abstract: A system comprises a generation unit which generates a browsing image by performing image processing for image data acquired by scanning; a holding unit which holds, in a storage unit for each use when the image data was printed out, information which defines image processing for converting the browsing image into image data for printing; a specification unit which specifies a use of image data corresponding to the browsing image upon accepting an instruction to print the browsing image; a conversion unit which converts the browsing image into image data for printing by deciding, in accordance with the information in the storage unit, image processing corresponding to the use of the specified image data, and applying the decided image processing to the browsing image; and a control unit which controls a printing unit to output the image data for printing.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09071734&OS=09071734&RS=09071734
owner: CANON KABUSHIKI KAISHA
number: 09071734
owner_city: Tokyo
owner_country: JP
publication_date: 20131126
---
The present invention relates to a printing system image processing apparatus image processing method and non transitory computer readable medium and more particularly to image processing and printing of scanned image data.

There is a use to browse and print from a PC data obtained by scanning and digitizing an original. In this case when a scanned document is digitized and saved the image data is saved after undergoing image processes such as image sharpening paper rotation and page separation in consideration of browsability on a PC or terminal used to browse digital data. In some cases the image data undergoes OCR by taking account of reprocessing of a digital document and diversion of data.

When the user prints a document which has been digitized and saved he manually designates a page layout and finishing processing such as punching or stapling.

As a technique of outputting digital image data in Japanese Patent Laid Open No. 10 126607 original information and user identification information are encoded in advance at the hidden information portion of an image. Then a user who operates a copying machine is specified. If the operating user matches the user identification information at the hidden portion the hidden portion is decoded and the image is printed if they do not match each other the image is printed together with the hidden information. In Japanese Patent Laid Open No. 7 146927 when the user designates a printing use in printing the contents of restoration processing are changed to perform use specific printing.

A user who prints digital data obtained by digitizing and saving an original is not always a user who grasps all the contents of the original. For example when an original is bound the user may make finishing settings and print settings different from those of the original. In a printing result with such output settings the body region may be spoiled owing to for example the difference of the binding position. In a case in which a user instructed to print digital data prints mechanically without knowing the origin of the digital data it is difficult to designate a use at the time of printout as in Japanese Patent Laid Open No. 7 146927.

A user who handles many fixed form documents decides an output form for each paper use in most cases. For example for a document such as a trial record the format of a paper document is determined and data is desirably printed out in the same format as that of the original. In contrast a paper such as a fee statement or voucher is digitized saved and undergoes OCR to extract data for use in calculation of an amount claimed. Then the data is pasted to the same format as a requested accompanying material after printing. In this printing use the user wants to print the data in the same direction as that of browsing data regardless of the orientation of the original in scanning composite the data with the form of the requested accompanying material and print.

To reliably print scanned digital data by everyone in accordance with a use it is necessary to convert image data and make print settings in accordance with the state of an original in scanning and the use of the document.

According to one aspect of the present invention there is provided a printing system comprising a generation unit configured to generate a browsing image by performing image processing for image data acquired by scanning a holding unit configured to hold in a storage unit for each use when the image data was printed out information which defines image processing for converting the browsing image into image data for printing a specification unit configured to specify a use of image data corresponding to the browsing image upon accepting an instruction to print the browsing image a conversion unit configured to convert the browsing image into image data for printing by deciding in accordance with the information held in the storage unit image processing corresponding to the use of the image data specified by the specification unit and applying the decided image processing to the browsing image and a control unit configured to control a printing unit to output the image data for printing.

According to another aspect of the present invention there is provided an image processing apparatus comprising a generation unit configured to generate a browsing image by performing image processing for image data acquired by scanning a holding unit configured to hold in a storage unit for each use when the image data was printed out information which defines image processing for converting the browsing image into image data for printing a specification unit configured to specify a use of image data corresponding to the browsing image upon accepting an instruction to print the browsing image a conversion unit configured to convert browsing image into image data for printing by deciding in accordance with the information held in the storage unit image processing corresponding to the use of the image data specified by the specification unit and applying the decided image processing to the browsing image and a control unit configured to control a printing unit to output the image data for printing.

According to another aspect of the present invention there is provided an image processing method comprising generating a browsing image by performing image processing for image data acquired by scanning holding in a storage unit for each use when the image data was printed out information which defines image processing for converting the browsing image into image data for printing specifying a use of image data corresponding to the browsing image upon accepting an instruction to print the browsing image converting the browsing image into image data for printing by deciding in accordance with the information held in the storage unit image processing corresponding to the use of the image data specified in the specifying step and applying the decided image processing to the browsing image and controlling a printing unit to output the image data for printing.

According to another aspect of the present invention there is provided a non transitory computer readable medium storing a program for causing a computer to function as a generation unit configured to generate a browsing image by performing image processing for image data acquired by scanning a holding unit configured to hold in a storage unit for each use when the image data was printed out information which defines image processing for converting the browsing image into image data for printing a specification unit configured to specify a use of image data corresponding to the browsing image upon accepting an instruction to print the browsing image a conversion unit configured to convert the browsing image into image data for printing by deciding in accordance with the information held in the storage unit image processing corresponding to the use of the image data specified by the specification unit and applying the decided image processing to the browsing image and a control unit configured to control a printing unit to output the image data for printing.

According to the present invention even if the user does not know the use of a printing target he can obtain a printing result complying with the use of each printing target.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings .

An embodiment of the present invention will be explained with reference to the accompanying drawings. shows an overall printing system according to the embodiment. This system performs image processing for an image scanned by an image processing apparatus and saves it in a server as an image suited to browsing. An arbitrary user can print the saved image by using an arbitrary image processing apparatus.

A server is an information processing apparatus laid open to the Internet and is connected via a LAN to a database serving as a save location for various data. Although shows only one server for descriptive convenience a plurality of servers physically exist in some cases. Although the database is provided separately from the server in the server may incorporate a database. The server is not limited to the arrangement in which it is laid open to the Internet but may be arranged in for example a LAN .

The server receives image data scanned and input by image processing apparatuses and . The server performs image processing to be described later for the received image data and stores the processed image data in the database . When printing image data stored in the database the server performs image processing for printing on image data and provides the user with a user interface for issuing a print instruction. The database receives image data via the server and stores it. Also the database saves various programs and data regarding the present invention to be described later .

The image processing apparatuses and and a PC exemplifies a user environment where they are connected via the LAN and also connected to the Internet . Each of the image processing apparatuses and includes a scanner and can transmit information of an original detected in scanning and scanned image data to the server . The user accesses the server via the PC . The user can browse image data stored in the database via the PC and server and print it by using the image processing apparatus or .

Although shows a multi function peripheral as the image processing apparatus the image processing apparatus suffices to be a single scanner for a scanning use. For a printing use the image processing apparatus suffices to be a printer serving as a printing unit having no scanner. Further an image processing apparatus used for scanning and an image processing apparatus used for printing may be different.

In the PC is used to access the server . However the PC need not always be connected to the LAN as long as the PC can access the server . The device can be a mobile terminal not shown which uses a telephone line or the like. Further an image processing apparatus used for printing need not be connected via the LAN to the PC which issues a print instruction as long as the server can transmit data.

An HDD stores image data various programs or various information tables. An operation unit I F connects an operation unit and the control unit . The operation unit includes a liquid crystal display having the touch panel function and a key board neither is shown . A Web browser and applications and of the image processing apparatus call an API Application Programming Interface and virtual machine API in accordance with processing and request the processing of the controller control unit thereby displaying an operation screen on the liquid crystal display of the operation unit .

A printer I F connects a printer and the control unit . Image data to be printed by the printer is transferred from the control unit via the printer I F and the printer prints it on a printing medium such as paper. The Web browser and applications and of the image processing apparatus call the API and virtual machine API in accordance with processing and request the processing of the controller control unit thereby executing print processing.

A scanner I F connects a scanner and the control unit . The scanner reads an image on an original to generate image data and inputs the image data to the control unit via the scanner I F . The Web browser and applications and of the image processing apparatus to be described later call the API and virtual machine API in accordance with processing and request the processing of the controller control unit thereby executing scan processing and receiving image data.

An accessory I F connects a finisher and the control unit . In the embodiment the finisher is capable of punch processing. Although shows the finisher as an example of an accessory to be connected one or a plurality of other accessories are also connectable. Examples of other accessories are a puncher which forms a punch hole a stapler which performs stapling a bookbinding unit which performs bookbinding and a sorter which sorts output materials.

A network I F connects the control unit image processing apparatus to the LAN . The network I F transmits image data and information to an external apparatus on the LAN and receives various kinds of information from the external apparatus on the LAN .

Note that the image processing apparatus has been explained with reference to but the image processing apparatus also has the same arrangement except for an accessory connected via the accessory I F .

A network I F connects the control unit server to the LAN . The network I F transmits receives various kinds of information to from another apparatus on the LAN .

The controller control unit runs on the OS and is formed from modules which control the scanner printer and the like. The API performs processing to access the controller control unit in response to an input command string from an application. The API has a function of sending a control command to a device connected to a network or the like via the network I F . The Web browser is an application running on the OS and requests various processes of the controller control unit by using the API .

A virtual machine is the second execution environment for executing a specific application and is implemented by a Java virtual machine or the like. The virtual machine API is an API which allows an application on the virtual machine to access the controller control unit running on the OS . In the embodiment the virtual machine API has the function of a conversion module for calling the API . The embodiment assumes the applications and as an application but an application such as the Web browser is also applicable.

A framework is a module having a function of performing centralized control of applications on the virtual machine . An application management application is an application for managing other applications on the virtual machine and performs downloading uploading erase and invalidation of an application in cooperation with the framework . The applications and run on the virtual machine and request various processes of the controller control unit by using the virtual machine API .

A resource management unit runs on the OS and manages resources used by the virtual machine . The resource management unit restricts the use of more than a predetermined number of resources when the virtual machine itself the virtual machine API the framework or all applications on the OS use resources such as a memory. For example when applications displayed on the screen of the operation unit exceed a predetermined application upper limit the resource management unit imposes a restriction not to perform UI User Interface display. Note that the image processing apparatus has been explained with reference to but the image processing apparatus also has the same arrangement.

In accordance with setting contents in the UI control unit a scan processing control unit performs processing considering whether the contents of output settings match the processing capability of the image processing apparatus itself. In accordance with setting contents in the UI control unit a print processing control unit performs processing considering whether the contents of output settings match the processing capability of the image processing apparatus itself. Details of this processing will be described later. A communication unit communicates with the server and performs data transmission reception and file transmission reception complying with a protocol such as FTP File Transfer Protocol SMB Server Message Block or WebDAV. The Web browser cooperative unit communicates with the Web browser and performs processing of calling the Web browser or receiving an operation end notification from the Web browser . When the Web browser cooperative unit receives an operation end notification from the Web browser it requests the UI control unit to display the screen of the application or on the foreground of the operation unit .

The UI control unit analyzes an HTML Hyper Text Markup Language file contained in a response received by the communication unit and displays an operation screen on the operation unit based on the analysis result. The UI control unit controls to display the screen of the Web browser on the foreground of the operation unit in accordance with a request from an application cooperative unit to be described later . A session management unit manages session information when the server and Web browser communicate with each other.

The application cooperative unit communicates with the application and performs processing of receiving a request from the application to call the Web browser or transmitting an operation end notification to the application . When the application cooperative unit receives a request from the application to call the Web browser it requests the UI control unit to display the screen of the Web browser on the foreground of the operation unit .

The memory map is formed from a basic I O program a system program which provides an operating environment to each program various programs a related data area which stores related data and a work area which is temporarily used when various programs run. When a region used as each area in the memory runs short owing to the restriction of the capacity it is also possible to handle the HDD as part of the area of the RAM or handle the HDD as part of the area of the RAM .

Reference numeral denotes a state of an original to be scanned by the image processing apparatus . Reference numeral denotes a state of data which is obtained by processing by the server data scanned by the image processing apparatus and is stored in the database . Reference numeral denotes a state in which the image processing apparatus prints the data stored in the database in accordance with an instruction from the PC to the server .

As the first example an original will be exemplified. The original is a spread original and punch holes are formed as a binding means. A left page is in the portrait orientation and has horizontal writing. A right page has horizontal writing on landscape paper and is in the portrait orientation. The user uses the operation unit to designate a storage destination folder in the server and execute the scan operation. The processing at this time will be explained with reference to .

The server performs image processing B and for data received from the image processing apparatus and stores the data in a record paper folder in the database that has been designated by the user in scanning.

A table shown in represents contents detected from data obtained by scanning the original by a scan application program not shown of the server and the contents of image processing at the time of storage in the database . First an original region is detected to detect that the original is an A4 size spread original. At this time extraction of each page and detection of a margin are also performed. The presence of a punch hole and the position of the punch hole in the page are also detected. Sharpening is performed to increase the OCR accuracy and improve the visibility in browsing and then OCR is executed. If an original is distorted upon detecting the original region image processing such as skew correction or trapezoidal distortion correction may be performed.

After that each page undergoes image processing to adapt its digital data to browsing. First images are separated extracted for respective pages. At this time the original margin is also held as margin information. A detected punch hole trace is erased from the first page left page of the original . The second page right page of the original is rotated clockwise by 90 based on the OCR result so that it can be browsed from the same direction as that of the first page. Similar to the first page a punch hole trace is also erased. The database stores document data in which pages of page data and are clearly separated by the above processing. The page data and serve as image data browsing images to be browsed by the user.

Thereafter the document data containing the page data and undergoes processes according to the embodiment. Printing results and are results of printing by the image processing apparatus . The printing results and are obtained by changing the printing position performing page rotation processing and forming punch holes. By binding the printing results and at the punch holes the state of the original can be restored.

As the next example an original will be exemplified. The original is an original of one sheet of a single page. The original has horizontal writing on landscape paper. The user uses the operation unit to designate a storage destination folder in the server and execute the scan operation. The processing at this time will be explained with reference to . The server performs image processing B and for data received from the image processing apparatus and stores the data in a bill paper folder in the database that has been designated by the user in scanning.

A table shown in represents contents detected from data obtained by scanning the original by the scan application program not shown of the server and the contents of image processing at the time of storage in the database . First an original region is detected to detect that the original has a single page and A6 size. At this time extraction of each page and detection of a margin are also performed. Sharpening is performed to increase the OCR accuracy and improve the visibility in browsing and then OCR is executed. Note that a paper in the bill paper folder is used for calculation by extracting a numerical value such as an amount of money as data. OCR is executed even for this purpose.

Thereafter each page undergoes image processing to adapt its digital data to browsing. The original is rotated clockwise by 90 based on the OCR result so that it can be browsed to face straight on the PC . Data undergoes processes according to the embodiment and is printed by the image processing apparatus obtaining a printing result . The data is changed into the state of the printing result upon page rotation processing and form composition. A folder is a provisional folder . If the user does not designate a save destination in scanning by the image processing apparatus scanned data is stored in the folder .

A table shown in is a conversion table for the record paper folder . This table defines the correspondence between processing for browsing and processing for printing. In correspondence with rotation processing in processing for browsing the table describes a counter rotation instruction to return the state of an original. In correspondence with page extraction processing the table describes an instruction to restore a printing position based on detected margin information. In correspondence with punch trace erase processing the table describes a punching instruction. In correspondence with the spread punch binding the table describes no instruction definition . In correspondence with the spread bookbinding the table describes an instruction to perform page composition. Although the embodiment describes only conversion information necessary for the description paper size conversion in page composition and conversion complying with the type of binding such as stapling can also be defined.

A table shown in is a conversion table for the bill paper folder . In the embodiment papers stored in the bill paper folder are a receipt voucher and the like. The embodiment assumes that these papers need not be returned to the states of originals in printing and are printed in the same direction as that of the browsing state. Hence no conversion processing for printing is defined for various processes for browsing. This indicates that no conversion processing is performed in printing. The purpose of printing a paper in the bill paper folder is creation of a bill.

The bill paper folder holds an additional processing table which defines processing to be additionally performed regardless of conversion processing for browsing step S . The additional processing table defines that form data form A is composited in printing and then the resultant data is printed. Note that there is neither a restoration processing table nor additional processing table associated with the provisional folder .

Note that the embodiment exemplifies only rotation page extraction punch hole trace erase stapling and spread as restoration processes. However restorable processes such as bookbinding and Z folding are not limited to the example in the embodiment.

Radio buttons and are used to exclusively designate a printing method. The radio button is a choice to execute restoration print processing to be described later. The radio button is a choice to execute not restoration print processing but normal print processing. Print processing based on this setting will be described later with reference to .

A control is used to designate how to perform alternate processing for a portion where an image processing apparatus designated as a printing destination cannot perform restoration processing. The control displays choices of alternate means in accordance with processing to be described later with reference to . The user can designate an alternate processing method of his choice from alternate means displayed on the control . In the embodiment a plurality of alternate means are presented to the user to prompt him to select one of them. However it is also possible to define the priority of alternate processing in advance and automatically derive and provide an alternate means by a program in the processing of .

Radio buttons to are choices to designate a printing range. When the user designates the radio button all document data is set as a printing target. When the user designates the radio button only a range selected by the user while opening document data is set as a printing target. The radio button is a choice to print only pages designated in a document and allows the user to further designate page numbers.

A print button is a printing execution instruction button. In response to clicking of the print button print processing to be described later with reference to is executed in accordance with destination on the print setting screen . A cancel button is used to cancel printing of a document.

The detection target page defines a document page to be processed as a use detection target. The determination condition defines image processing to be performed for use detection. For a normal processing pattern the detection range of the detection target page is extracted and undergoes OCR processing. Then the use is derived in accordance with the presence absence of a specific character string in the OCR result defined in the determination condition .

A line represents a case in which punching is necessary as restoration processing. If there is no puncher at a printing destination alternate processing needs to be presented to the user. As alternate processing for punching stapling is performed. To achieve this the presence absence of a stapler is involved in the alternate necessary arrangement .

If a stapler exists in an image processing apparatus at a printing destination the control presents alternate processing choices staple at two side portions print the shadows of punch holes on only one page and no alternate processing . Note that print the shadows of punch holes on only one page is alternate processing on the premise that the user manually performs punching by using the printed shadows as marks. If no stapler exists in an image processing apparatus at a printing destination alternate processing using the stapler cannot be performed. Hence staple at two side portions is excluded from the three choices and the control presents only the two processes.

A line represents a case in which stapling is necessary as restoration processing. If there is no stapler at a printing destination alternate processing needs to be presented to the user. As alternate processing for stapling punching is performed. Thus the presence absence of a puncher is involved in the alternate necessary arrangement . Further the puncher of an image processing apparatus in the environment according to the embodiment is assumed to be able to punch a hole on only the side. To make a punching position coincide with a staple position the alternate processing is limited to one for binding at two side portions.

If a puncher is arranged in an image processing apparatus at a printing destination and can punch holes at two side portions the control presents alternate processing choices punch two holes print the shadows of staples on only one page and no alternate processing . Note that print the shadows of staples on only one page is alternate processing on the premise that the user manually performs stapling by using the printed shadows as marks. If staple positions are not two side portions no puncher exists in an image processing apparatus at a printing destination and two hole punching is impossible alternate processing using the puncher cannot be performed. In this case punch two holes is excluded from the three choices and the control presents only the two processes.

A line represents a case in which tab paper insertion is necessary as restoration processing. If there is no inserter device for inserting tab paper at a printing destination alternate processing needs to be presented. As alternate processing for tab paper insertion blank paper insertion is performed. Since blank paper insertion can be executed by normal blank paper printing nothing is defined as the alternate necessary arrangement . If no inserter exists in an image processing apparatus at a printing destination the control presents alternate processing choices blank paper insertion and no alternate processing .

The user sets an original on the image processing apparatus and causes the image processing apparatus to scan it. At this time the user designates a save destination folder. In the embodiment the user designates the record paper folder or bill paper folder .

In a loop of steps S and S the image processing apparatus reads the original page by page. After the end of reading all pages YES in step S the image processing apparatus transmits to the server image data and information representing the designated save destination in step S.

The embodiment assumes that a single folder is designated as a save destination. That is a document has only one use. However it is also possible to designate a plurality of uses and copy and save one data in a plurality of folders. If the save destination is a general file system the entity can be stored in only one folder while links shortcuts are saved in the remaining folders. This mechanism enables restoring and printing one original by restoration processes complying with a plurality of uses. If image processes are defined at the time of storage in accordance with uses document data of different forms can be easily created from one original for the respective uses.

If the server determines that conversion processing for browsing is necessary YES in step S the server performs conversion processing for browsing in step S. The conversion processing for browsing includes for example punch trace erase when there is a punch hole trace rotation processing arising from the difference in the printing direction page extraction when the printing region is localized in a page and centering processing.

In step S the server temporarily saves the detection information stored in step S and the processing contents in step S in the RAM in the format of . After processing all the pages YES in step S the server saves the image data converted in step S in a designated save destination in the database in step S. In step S the server saves various kinds of primarily held information and the image data in the database in correspondence with each other.

In the embodiment the server performs original detection processing step S . However the image processing apparatus may perform equivalent detection processing and transmit the detected information to the server in step S.

When the user selects a document and issues a print instruction the server determines in step S whether the use of the printing target document has been specified. In the embodiment the use is identified based on a folder which stores the document in the database . The user designates a folder to store a document when the document is scanned. If the user does not designate a storage destination folder in scanning the document is stored in the provisional folder in the database .

If no use has been specified that is the document exists in the provisional folder in the embodiment NO in step S the server performs use specification processing in step S. The use specification processing is performed in accordance with the use specification table shown in . In step S the server determines whether the use has been specified. If the use has not been specified NO in step S the server excludes the document from restoration printing targets and the process advances to step S. If the use has been specified YES in step S the process advances to step S.

If the use has been specified in step S that is the document exists in the record paper folder or bill paper folder YES in step S the process advances to step S.

In step S the server acquires the original detection image processing information stored in the database in the processing of . Then in step S the server acquires restoration information tables and in associated with the specified use by copying it in the RAM . The purpose of copy acquisition instead of merely referring to restoration information in the database will be explained. The restoration information is configured to perform the same finishing processing such as punching on the premise that printing is performed by an image processing apparatus having the same device arrangement as that in original creation. However an image processing apparatus used by the user to print is arbitrary and does not always have the same device arrangement as that in original creation. For this reason the processing is changed in accordance with user designation input from the control displayed on the print setting screen based on the alternate means table of .

In step S the server acquires additional processing information additional processing table in associated with the use of the printing target document. In the embodiment it is not configured to rewrite the additional processing so the information is neither copied nor acquired. However when it is configured to rewrite the additional processing under various conditions the information can also be copied and acquired similarly to the restoration information in step S.

In step S the server adds the printing method choice restoration printing to the print setting screen . Finally in step S the server displays the print setting screen on the PC via the Web browser.

By the above processing in the embodiment when the use of a printing target document can be specified restoration printing is enabled and the printing method restoration printing can be selected on the print setting screen . If the use of a printing target document cannot be specified restoration printing is disabled and only the printing method normal printing can be selected.

In step S the server determines whether to print the entire document that is whether all has been selected with the radio button . If the entire document has been designated YES in step S the server activates the restoration printing in step S cancels masking if masked . If the server determines that the printing range is not the entire document NO in step S it invalidates the restoration printing in step S. At this time if the restoration printing has been selected the selection shifts to the normal printing .

By the above processing in the embodiment restoration printing can be executed only when the entire document is set as a printing target. Restoration printing is possible for even a partial document unless the original has a complicated layout. For example for an original of A4 single sided printing and left stapling the same binding as that of the original can be executed even not from the start of the document. Even for a spread original a printing result equivalent to the original is obtained by reproducing the same layout and binding as those of the original as long as the printing range starts from the first page to an intermediate one. In this manner the practice of the present invention is not limited to this embodiment.

In step S the server determines whether the printing method radio button restoration printing has been selected. If restoration printing has not been selected NO in step S the server ends the processing sequence without doing anything.

If restoration printing has been selected YES in step S the process advances to step S. In step S the server acquires information of a device image processing apparatus at a printing destination. The information acquired here is mainly the accessory arrangement of the image processing apparatus for example the presence absence of a puncher or the presence absence of a stapler. Further this information includes information representing whether the accessory is usable. In step S the server determines the necessity of restoration alternate processing based on the printing destination device information acquired in step S the original detection image processing information acquired in step S and the restoration information acquired in step S. The necessity of restoration alternate processing is determined by determining whether alternate processing needs to be performed when restoration processing is restricted by the function of an image processing apparatus set as a printing destination. This processing will be described in detail with reference to .

If the server determines that restoration alternate processing is necessary YES in step S the process advances to step S. If restoration alternate processing is unnecessary NO in step S the server ends the processing sequence without performing processing in step S. In step S the server presents choices of the restoration alternate method based on the processing result of step S to allow the user to designate a restoration alternate method. Then the processing sequence ends.

In step S the server determines which of stapling a puncher and tab paper insertion is the type of processing to be restored. If processing to be restored is punching processes in steps S to S are performed. If an image processing apparatus selected as a printing destination includes a puncher YES in step S the server returns to step S without doing anything. That is alternate processing for punching need not be presented.

If the image processing apparatus selected as the printing destination does not include a puncher NO in step S the server sets a do nothing flag to be ON in step S. In step S the server also sets an alternate flag to be ON. In step S the server sets a punch shadow print flag which is processible by normal printing without any special apparatus to be ON. If the image processing apparatus selected as the printing destination includes a stapler YES in step S the server sets a staple alternate flag to be ON in step S and then the process returns to step S. When the stapler runs out of staples it can be determined that the stapler does not exist or that the stapler exists after prompting the user to replenish the stapler with staples. By the processes in step S to S it is set to display as restoration alternate methods on the print setting screen choices of restoration alternate processing for punching described on the line of .

If the type of processing to be restored is tab paper insertion processes in steps S to S are performed. If the image processing apparatus selected as the printing destination includes an inserter YES in step S the server returns to step S without doing anything. That is alternate processing for tab paper insertion need not be presented. When the inserter runs out of paper it can be determined that the inserter does not exist or that the inserter exists after prompting the user to replenish the inserter with paper.

If the image processing apparatus selected as the printing destination does not include an inserter NO in step S the server sets a do nothing flag to be ON in step S. In step S the server also sets an alternate flag to be ON. In step S the server sets a blank paper insertion flag which is processible by normal printing without any special apparatus to be ON. After that the process returns to step S. By the processes in step S to S it is set to display as restoration alternate methods on the print setting screen choices of restoration alternate processing for tab paper insertion described on the line of .

If processing to be restored is stapling processes in steps S to S are performed. If the image processing apparatus selected as the printing destination includes a stapler YES in step S the server returns to step S without doing anything. That is alternate processing for stapling need not be presented. When the stapler runs out of staples it can be determined that the stapler does not exist or that the stapler exists after prompting the user to replenish the stapler with staples.

If the image processing apparatus selected as the printing destination does not include a stapler NO in step S the server sets a do nothing flag to be ON in step S. In step S the server also sets an alternate flag to be ON. In step S the server sets a staple shadow print flag which is processible by normal printing without any special apparatus to be ON. If the image processing apparatus selected as the printing destination includes a puncher and the original is bound at two side portions YES in step S the server sets a punch alternate flag to be ON in step S and then the process returns to step S. If none of the above described conditions is satisfied NO in step S the server returns to step S without doing anything. By the processes in step S to S it is set to display as restoration alternate methods on the print setting screen choices of restoration alternate processing for stapling described on the line of .

If the printing method is normal printing NO in step S the server generates print settings as an instruction to the image processing apparatus in accordance with settings on the print setting screen in step S and then the process advances to step S. In step S the server sends the document data acquired in step S and the print settings generated in step S to the image processing apparatus designated as the printing destination.

If the printing method is restoration printing YES in step S the server performs processes in steps S to S for each page. First in step S the server decides a page to be processed. The page to be printed proceeds one by one in order from the first page.

In step S the server extracts from the original detection image processing information acquired in step S one content of image processing performed for the processing target page in saving. In step S the server refers to the restoration information tables and in rewritten in step S. In step S the server determines whether to perform processing for printing based on the restoration information with respect to the image processing performed for the processing target in saving. If processing for printing is necessary YES in step S the server performs the processing for printing restoration processing in accordance with the restoration information in step S. After that the process advances to step S.

If processing for printing is unnecessary NO in step S the process advances to step S. In step S the server determines whether the processes in steps S to S have been performed for all the image processes performed for the current processing target page in saving. If these processes have been performed YES in step S the process advances to step S.

In step S the server determines whether there is a setting which should be made for only the current processing target page as a print setting. If the server determines that there is such a print setting YES in step S it merges the page specific print setting with print settings. For example when an A4 size portrait document includes an A3 size landscape page the page specific print setting corresponds to Z folding of only this page details of which will not be described in the embodiment.

In step S the server determines whether the processes in steps S to S have been performed for all the pages of the printing target document. If all the pages have been processed YES in step S the server determines in step S whether there is additional image processing acquired in step S. If there is additional image processing YES in step S the server performs the additional image processing in step S. In the embodiment the additional image processing corresponds to for example processing composition of form A defined in the additional processing table applied when printing the data .

In step S the server determines whether there is print setting processing for the entire page for restoration. If there is print setting processing to be performed YES in step S the server adds processing to print settings in step S. In the embodiment this processing corresponds to an instruction punching performed when printing a document represented by the page data and .

Finally in step S the server sends data obtained by performing image processing for image data and the generated print settings to the image processing apparatus designated as the printing destination. As a result the printing result is obtained by restoration processing based on the original.

As described above even if a user who is to print scanned digital data grasps neither the state nor use of an original to be printed the original can be printed in a format complying with the use without making complicated print settings.

In the first embodiment data scanned by the image processing apparatus is transmitted to the server on the Internet and the server executes image detection and conversion processing. In the second embodiment only the image processing apparatus performs all image detection and conversion processing of data scanned by an image processing apparatus saving of document data and processing in printing. That is a printing unit and processing unit are arranged in a single apparatus.

Applications and running in the image processing apparatus have the following functions. The application provides a UI for scanning to an operation unit and accepts input of a file name and type information of scanned data shown in . Scanned image data undergoes processing in and is stored in the HDD as document data of a format in together with original detection image processing information shown in .

In described in the first embodiment image data is received via a network in step S. According to the second embodiment the application in the image processing apparatus receives scanned data in step S. The application provides a UI for printing to the operation unit . The application displays on the operation unit a UI which displays a list of document data stored in the HDD and accepts an instruction from the user to print an arbitrary document.

The application also includes a Web service and the UI for accepting a print instruction is also provided to the Web browsers of network connected PCs and . When printing of a document is designated the application displays a print setting screen in and performs the processes in implementing printing by the image processing apparatus. The HDD stores a use specification table and alternate means table used in this processing. Note that the printing destination can be the image processing apparatus itself or another network connected image processing apparatus.

The PC is connected to the image processing apparatus via a LAN and can access via the Web browser a UI for print processing provided by the application of the image processing apparatus . Also the PC on a LAN is also connectable to the image processing apparatus via the Internet and can use the application similar to the PC .

The file name and type information are coupled as attributes to a file body . In the second embodiment the file name and type information are designated by the user via the UI provided by the application . However a program can automatically generate a file name. Further a file name may be automatically added by executing in the processing in scanning the processing in step S described with reference to in the first embodiment.

Although the first embodiment uses a storage destination folder for use specification in step S the second embodiment uses the type information .

As described above even if a user who is to print scanned digital data grasps neither the state nor use of an original to be printed the original can be printed in a format complying with the use without making complicated print settings.

Aspects of the present invention can also be realized by a computer of a system or apparatus or devices such as a CPU or MPU that reads out and executes a program recorded on a memory device to perform the functions of the above described embodiment s and by a method the steps of which are performed by a computer of a system or apparatus by for example reading out and executing a program recorded on a memory device to perform the functions of the above described embodiment s . For this purpose the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device for example computer readable medium .

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

This application claims the benefit of Japanese Patent Application No. 2012 275101 filed Dec. 17 2012 which is hereby incorporated by reference herein in its entirety.

