---

title: Systems and methods for location assistance with personal area network devices
abstract: Implementations relate to systems and methods for location assistance using devices () in a personal area network (PAN). In one scenario, a user may use two separate location-enabled devices, such as a wearable personal device () and a cellular telephone device (). In cases, one of those devices may have reached a higher or farther-developed state in terms of generating or storing location information () for the user's current position, as compared to the opposite device. This can take place, for instance, when the first (e.g. wearable) device () is first turned on. The two devices use platforms and techniques to exchange location information and carry out GPS or other operations to furnish the device that is lagging in position processing progress with assistance which will speed up or otherwise enhance the position fix for that device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09535164&OS=09535164&RS=09535164
owner: Google Technology Holdings LLC
number: 09535164
owner_city: Mountain View
owner_country: US
publication_date: 20131010
---
The present teachings relate to systems and methods for location assistance using two or more personal area network PAN devices and more particularly to platforms and techniques for allowing one device equipped with a Global Navigation Satellite System GNSS to communicate with another device having positioning capabilities in order to speed up the acquisition of location information and the generation of a position fix.

In the field of personal electronic devices certain recreational devices and services capture and present a user s geographic position using a GNSS receiver. As one example a sports watch or other wearable device may contain for instance a Global Positioning System GPS chip or module to allow that device to receive signals from GPS satellites go through the necessary computation of ephemeris and other data and produce a GPS position fix or precise location reading often including geocoordinates latitude longitude and optionally altitude and direction of travel.

When a sports watch or other personal device with a GNSS receiver has first been turned on or has recently started receiving usable GPS signals e.g. after being obscured by trees or buildings the GPS receiver needs a certain amount of time to re start and begin taking position fixes. That start up delay can be on the order of several minutes. During that start up period the device will typically consume a significant amount of battery power because a significant amount of radio frequency reception and position computation activity must take place.

In those scenarios and others a GPS or other GNSS equipped personal device could benefit by tapping the already generated location information of a nearby device if that nearby device is GNSS equipped and is located in range of a wireless connection to the personal device.

Implementations of the present teachings relate to systems and methods for location assistance using personal area network devices. More particularly implementations relate to platforms and techniques for establishing a short range communication link between a first device and a second device and allowing the two devices to exchange location information to determine whether one device or the other has more up to date location information. If so the more up to date information can be shared with the remaining device to speed up position processing on that remaining device.

Reference will be made in detail to exemplary implementations of the present teachings which are illustrated in the accompanying drawings. Where possible the same reference numbers will be used throughout the drawings to refer to the same or like parts.

The first device can include a processor memory software and or other hardware software or service resources. The first device can in implementations be or include a wearable device such as a watch or glasses a device which can be clipped to a belt or worn on a strap and or other mobile portable and or wearable components. In implementations the first device may not be equipped with a wireless wide area network WWAN transceiver and thus lacks cellular and WiMAX capability. The first device may however be equipped with a wireless local area network WLAN interface . The WLAN interface can be or include a WiFi module or chip configured to support data communications with an access point associated with a home business or other wireless local area network WLAN . It will be understood however that the WLAN interface and WiFi or other WLAN connectivity are optional components of the first device .

The first device can further be equipped with a personal area network PAN interface . The PAN interface can be or include any short range communications link such as for example a Bluetooth or WiFi Direct interface an NFC interface another type of short range radio frequency link an optical link an audio data link a USB cable or the like.

In implementations as shown a second device can operate in the same environment as the first device for instance in the same general proximity as or held by the same user operating the first device . The distance between the first device and the second device can be within a range of error of the GNSS of the first device which can be on the order of a few centimeters a few decimeters a few meters or other distances depending on the GNSS and its implementation in the first device . The second device can be or include a personal electronic device equipped with a GPS module that can likewise be or include a GPS chip software and or related resources. It will be understood again that other GNSS based modules or resources can be used instead of GPS modules or resources. The second device can similarly include a processor memory software and or other hardware software or service resources. The second device can include a personal area network PAN interface compatible with the PAN interface of the first device which can similarly be or include a Bluetooth interface a WiFi Direct interface or other type of short range radio frequency or other communications link.

In implementations the second device can in addition to the noted GPS and short range communication capabilities also be equipped with a wireless wide area network WWAN interface . The WWAN interface can be or include a cellular module or chip or other resources configured to support wireless voice and or data communications with a base station associated with a wide area network such as a 4G LTE Long Term Evolution G CDMA Code Divisional Multiple Access G GSM Global System for Mobile Communications WiMAX IEEE 802.16 and or other cellular or wireless wide area network.

In implementations the second device can further be equipped with a wireless local area network WLAN interface . The WLAN interface can be or include a WiFi module or chip configured to permit data communications with an access point such as an access point operating under an IEEE 802.11 or other wireless local area network standard. In the example of both devices have WLAN interfaces and are wirelessly communicating with the same WLAN access point . In situations where both devices have active WLAN interfaces they may wirelessly communicate with the same or different WLAN access points. Note that the WLAN interface and WiFi or other WLAN connectivity along with the WWAN interface and 4G and or other connectivity are optional components of the second device . While those types or classes of networking connections or resources are optional in the first device and the second device in both devices in general a PAN interface and GNSS based interface will be incorporated as shown.

In aspects the second device can be referred to as the tethered device but it will be appreciated that in a given situation either of first device or second device can act to support and feed location information to the opposite device and serve as the tethered unit.

In the environment as shown the first device and second device can in general communicate and cooperate to exchange location information related to the position of each device and attempt to use that information to accelerate advance speed up shorten or otherwise enhance or improve the process of generating a position fix of one or the other device. The generated position fix may include geocoordinates such as latitude longitude and optionally altitude direction of travel ground speed vertical speed accuracy information for any of these elements and the precise method used to compute the position fix. In aspects and again merely generally logic built into the first device and second device can operate to identify which of the first device and second device is ahead of the other device in terms of acquiring location information and or performing calculations on that location information to acquire a position fix. The device in that ahead state can then pass its location information to the other device to assist the behind device in completing position operations of its own.

In general terms as also shown in a user can turn on activate and or operate the first device in an already powered state and the first device can initiate a series of exchanges with the second device as a tethered device to determine whether the second device can assist the first device by providing location information in a manner that will speed up the process of generating that position fix in the first device . While further details are described in connection with in general the first device can issue a request and or other message or query to the second device via the short range communication link established between the respective PAN interface and PAN interface . If the logic or processing followed by the first device and second device indicates that the second device is capable of speeding up the location operations of the first device the second device can in general respond with a transmission of location information from the second device to the first device . The first device can then use the location information to speed up accelerate and or otherwise enhance or improve the calculation of a position fix by the first device .

In aspects the location information can relate to any aspect of GNSS based or other data stored or generated by the second device that can be used by the first device to improve the computation of the position of the first device . In the case of GPS data the location information can include time information which can include time synchronization data used on time signals arriving from GPS satellites and for other purposes. The location information can also include almanac information which describes orbital information for the fleet of GPS satellites as a whole with relatively coarse accuracy which may be valid or accurate for weeks or months. The location information can also include ephemeris information which allows the fine grained calculation of the position of each satellite in orbit to necessary precision and which may remain accurate for approximately two to four hours after that information is downloaded from a satellite.

Other types of information can be included in the location information to assist the determination of position by the first device and those other types of information can include for example estimated values for position time ephemeris and or other quantities related to position processing that are available to the second device . Those further types of data can include position estimates based on the latitude longitude and or altitude values for the device or for fixed points such as the base station and or access point . The location information can likewise include time estimates as well as estimated ephemeris data that are available to the second device such as from the base station the access point servers in the wireless wide area network servers in the Internet and or other sources. Any or all of those other types of location information can be used to assist the positioning process used by the first device to generate a position. In general the amount currency and degree of precision available to each of the first device and the second device allows the two devices to determine whether each one is in a cold warm or hot location processing state indicating the validity or currency of the location information available to each device and which can be shared to or from each device.

According to implementations and as shown in in general a hot location processing state occupied by either of the first device or second device indicates that that device has valid or current data for both time and broadcast ephemeris which in general may allow immediate or rapid calculation of a position fix.

In general a warm location processing state can reflect any one of a set of states wherein time data is valid without valid broadcast ephemeris data or where estimated ephemeris data is available regardless of valid time or where valid broadcast ephemeris data is available without valid time data.

A cold location processing state can indicate that the device has no valid data available to it such as when the device is first turned on and has not begun location processing or when the device enters a reboot state following a fault or other condition. For convenience of reference any state besides a hot state can be referred to as a non hot state herein.

GPS processing can in general depend on whether a device is in a cold warm or hot location processing state. According to implementations a device can enter or activate a cold state upon power up or wake up. A cold start can be performed every time after the device and or its GPS module is turned off without storage of location information in a persistent memory e.g. when no backup power supply is connected . During a cold start almanac and ephemeris data have to be downloaded first from the GPS satellites to the device GPS module before a position fix can be acquired.

Assuming that location information is stored when a GPS module is powered off e.g. a proper backup power source is provided a device can perform a hot start provided valid time data is available if the associated GPS module is powered on within a predetermined time frame e.g. two hours after the device and or GPS operations were previously turned off. This is the case because accurate ephemeris and almanac data can be retrieved from flash or other memory of the GPS module.

A warm start in general can be performed if the device and or associated GPS module stores previous location information and is started after a predetermined e.g. two hour time frame as some but not all of the GPS satellite data has to be refreshed.

The first device and second device can use comparative information about those associated location processing states to exchange location information useful to one or the other device to speed up location processing as described herein.

More specifically processing to compare location processing states and exchange data can be carried out using a process such as shown in . Processing begins when a first device enters a location mode . Although any device in a personal area network can enter the location mode and start this process for the sake of clarity this description will consider the first device as the subject device and consider the second device as one of the tethered devices in the PAN. If supported the first device as the subject device can download using a WLAN or WWAN communication link and or generate any assistance data that may be initially available such as predicted ephemeris data. In many smartphone devices location assistance data is generally downloaded at least once a day from a WWAN base station to help speed up the process of obtaining position fixes. Information provided at a frequency of once a day generally reflects estimated ephemeris data generated by an associated server. Estimated or predicted ephemeris data can be or include client server generated ephemeris data for GPS satellites which can be valid for a certain period of time such as 7 10 days. The assistance data can likewise or instead include broadcast ephemeris data such as ephemeris data transmitted by GPS satellites which may or may not be slightly out of date but remembered by the first device . Information provided at a frequency of more than once a day generally reflects broadcast ephemeris data requested from or received by way of a WWAN base station . In implementations assistance data can also or instead be downloaded to a smartphone or other device each time a location based application e.g. navigation mapping etc. is launched.

The first device can determine whether a second device is connected or tethered to the first device over a short range communication network e.g. via the PAN interface and PAN interface . If the determination is no processing proceeds to branch alone and the first device attempts to obtain a position fix on its own as will be explained later in more detail.

If the determination is yes processing can proceed to another determination of whether the first device is in a hot warm or cold location processing state as defined herein. If the determination is that the first device is in a hot state processing also proceeds to branch alone. In other words processing proceeds to branch alone when no tethered second device is available i.e. via determination NO and when a tethered second device is available but the first device already has both valid time and valid broadcast ephemeris data i.e. via determination HOT .

If the first device is tethered to a second GNSS device and in a NON HOT state however processing proceeds to both branches and in parallel using both a stand alone positioning process in first device and attempted assistance from the second device .

Continuing with branch which occurs in a parallel or concurrent fashion with branch when the first device is tethered to a second device and in a NON HOT state the first device can transmit a request to the second device and request location information from the second device . The request may ask for any available location information such as time information estimated time information time synchronization data almanac information ephemeris data estimated ephemeris data position information and or estimated position information. Alternately the request may ask for specific information such as any available time information actual or estimated ephemeris data actual or estimated and position information actual or estimated .

A determination can be made whether location information has been received by the first device from the second device . Location information may not be received if there are communication issues within the PAN or if the second device is also in a cold state and has no valid time ephemeris or position information. If no location information has been received processing can enter a loop back to the request until location information is received by the first device from the second device . In implementations a timer and time out condition can be added to the loop back and or the received determination to avoid endless loops race conditions or other faults.

If location information was received by the first device from the second device any available position information actual or estimated from the second device can be displayed on the first device and or provided to one or more software applications operating on the first device such as mapping navigation and location based services software applications. Any received location information is now available to branch to be carried out by first device as will be explained below.

After the tethering and location processing state determinations the first device initiates an attempt to acquire a position fix using its GPS module . Note that branch occurs regardless of whether the first device is tethered or not and regardless of location processing state. The position fix process can be initiated using GPS signals and or can be made using a WLAN service such as a WiFi connection via the WLAN interface . A determination can be made whether a position fix has been obtained. If the GNSS receiver reaches a determination that a position fix has not been obtained the first device checks to see if location information from a tethered device was received and updates its own location information if any tethered device location information was received. Then the process returns to branch to attempt a position fix again. Note that if the first device is traversing branch alone no tethered device location information will be requested or received because only branch requests tethered device location information.

If a position fix has been obtained the position fix and or position information portions of the location information can be displayed on a display screen of the first device and or provided to one or more software applications operating on the first device such as mapping navigation and location based services software applications.

This type of location mode as describe with reference to allows a GNSS enabled first device with a PAN transceiver to request and use location information from a nearby PAN connected GNSS device. This supports a faster position fix for the first device . Note that for a PAN network with two or more GNSS equipment devices each device may consider itself the first GNSS device and each implement a process similar to to request location information from one or more of the tethered GNSS devices in the PAN. In implementations it may be noted that the capture of broadcast ephemeris data by the first device or second device may be more advantageous than other types of data since decoding broadcast ephemeris data requires a higher signal to noise ratio SNR 14 dB or more than decoding and or aligning time data part of the PRN code in GPS systems .

The processor can further communicate with a PAN transceiver via which the electronic device can transmit or receive wireless signals using antenna element and using those signals establish a connection to one or more networks not shown such as the Internet or other public or private networks. In some implementations the connection to the one or more networks via the antenna element and other resources can be or include a broadband wireless connection a WiFi connection via WLAN interface and or wireless data connection not shown . It may be noted that the WLAN interface is optional see elements and can be removed in some implementations and that a wireless wide area network WWAN interface can be optionally be included or added see element . Likewise while radio frequency wireless connections are described it will be appreciated that first device can also connect with one or more networks access points and or services via wired or other types of wireless connections such as Ethernet connections USB connections infrared connections or others.

The processor can in general be or include one or more general purpose and or special purpose processors cores and or related logic and can be programmed or configured to execute and or control the operating system a set of system resources including an application programming interface API a set of applications such as mapping navigation or location based services applications and or other hardware software logic services and or resources. Other configurations of the first device associated network connections and other hardware software and other resources or services are possible. In implementations the second device can be or include the same or similar hardware software and service resources as the first device or in implementations can be or include different or additional hardware software and or services.

The foregoing description is illustrative and variations in configuration and implementation may occur to persons skilled in the art. For example while implementations have been described in which the first device communicates with one additional device in the form of the second device to generate improved or accelerate position fixes in implementations the first device can communicate with two or more additional devices to achieve the same enhanced operations. Similarly the location assistance provided by the second PAN connected GNSS device or two or more additional PAN connected GNSS devices or sources can be used to generate enhanced or speeded up position fixes by more than one GNSS device in a cold or otherwise less advanced location processing state. Other resources described as singular or integrated can in implementations be plural or distributed and resources described as multiple or distributed can in implementations be combined. The scope of the present teachings is accordingly intended to be limited only by the following claims.

