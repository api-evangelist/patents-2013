---

title: Architecture for removable media USB-ARM
abstract: A storage device is coupled to a computing system comprising an operating system and application software. Access to the storage device is blocked by a kernel filter driver, except exclusive access is granted to a first anti-virus engine. The first anti-virus engine is directed to scan the storage device for malicious software and report results. Exclusive access may be granted to one or more other anti-virus engines and they may be directed to scan the storage device and report results. Approval of all or a portion of the information on the storage device is based on the results from the first anti-virus engine and the other anti-virus engines. The storage device is presented to the operating system and access is granted to the approved information. The operating system may be a Microsoft Windows operating system. The kernel filter driver and usage of anti-virus engines may be configurable by a user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09081960&OS=09081960&RS=09081960
owner: UT-Battelle, LLC
number: 09081960
owner_city: Oak Ridge
owner_country: US
publication_date: 20130425
---
This patent application makes reference to and claims priority to U.S. Provisional Patent Application Ser. No. 61 639 172 filed on Apr. 27 2012 which is hereby incorporated herein by reference in its entirety.

This invention was made with government support under Contract No. DE AC05 00OR22725 between UT Battelle LLC. and the U.S. Department of Energy. The government has certain rights in the invention.

The present disclosure relates to removable devices for storing electronic media and more specifically to machines and methods for malware detection of the media for increased network security.

The advent of high capacity mobile storage such as USB flash media has increased the convenience of sharing files between users. Unfortunately this sharing also allows the distribution of viruses and other malicious software called malware. Malware can be distributed from even seemingly innocuous sources such as from fellow conference attendees or from vendors providing a product. When a storage device is plugged into a computer it may be detected by the computer s operating system and identified as having a particular file system. The operating system may read the file system so that it may display its contents to users.

Frequently malware will target auto run functionality of popular operating systems causing them to immediately execute when the media is inserted or attached. Malware has becomes such a significant problem that organizations have taken dramatic steps to avoid malware carried in removable media. In some cases organizations may simply seal USB drives to prevent media from being inserted. Other organizations require that all media be examined by a security consultant who will scan and certify the media before it can be used on company machines. Both of these approaches interfere with the convenience of these media and decrease user productivity.

Architecture for removable media may provide secure access to storage media. A computing system may comprise one or both of an operating system and application software. The computing system may be communicatively coupled to a storage device comprising stored information. The computing system may block all access to the storage device except for granting exclusive access to a first anti virus engine. The first anti virus engine may be directed to scan the information stored on the storage device for malicious software. Results may be received from the first anti virus engine. The storage device may be presented to the operating system. Access to approved information stored on the storage device may be enabled in instances when all or a portion of the stored information is approved.

Other systems methods features and advantages will be or will become apparent to one with skill in the art upon examination of the following figures and detailed description. It is intended that all such additional systems methods features and advantages be included within this description be within the scope of the invention and be protected by the following claims.

Architecture for removable media ARM may protect a computing or communication system from effects of malicious software before presenting a storage device to the system for access. In some systems the storage device may be a removable media device. The ARM system may allow a user the convenience of using the removable media device while overcoming some of the short comings of traditional methods of anti virus scanning. The ARM system may allow access only after anti virus sweeps are complete and may prohibit read or execute access to any executables on the storage device to prevent zero day attacks. In some systems the ARM system may eliminate a race condition between security software and auto run functionality of an operating system or between the security system and a user selecting a file. Moreover the ARM system may enable use of a plurality of third party anti virus engines for scanning files in the storage device.

The ARM system may determine when a memory device is available for access. For example the ARM system may detect when a removable media device is attached to the computing or communication system. The ARM system may isolate information which is stored on the removable device from the computing system s operating system and or application software. The ARM system may comprise low level kernel software that may control access to the removable media device thereby preventing a security breach by any malicious software that may be stored on the removable storage device. Once it is determined that the stored information is clear of any malware the ARM system may present the media to the operating system at which point it may become available to users and applications.

Turning to the figures illustrates an architecture for removable media which may utilize one or more anti virus engines for scanning files stored on a storage device. The system may comprise software including an operating system an architecture for removable memory ARM system one or more anti virus scanning engines and application software . The ARM system may include configuration software and or a kernel filter driver . The one or more anti virus scanning engines may comprise one or more service daemons . The system may also include a removable media device .

The operating system ARM system and one or more anti virus scanning engines may be stored on a computing or communication system for example the computer system described with respect to . The removable media device may be communicatively coupled to the computing system . The ARM system and or the one or more anti virus scanning engines may provide security operations for the computer system prior to allowing the operating system application software or a user to gain access to information stored on the removable media device . In this regard the ARM system may grant exclusive access to an anti virus scanning engine prior to presenting the removable media device to software on the computing system .

The operating system may be stored on the computer system described with respect to . The operating system may comprise software that is operable to manage hardware resources and or provide services for computer programs running in the computer system . In some systems the operating system may include the Microsoft Windows operating system. However the operating system is not limited in this regard and any suitable operating system may be utilized.

The removable media device may be communicatively coupled to the computer system . In some systems the removable media device may comprise a Universal Serial Bus USB flash drive which may include flash memory with an integrated USB interface. It may be referred to as a thumb drive or jump drive for example. The removable media device may be portable and it may be rewritable. However the system is not limited in this regard and any suitable memory device may be utilized as the removable media device or may be referred to as the removable media device . For example the removable media device may comprise an optical disc such as a Blue ray disc DVD or compact disc CD . Moreover the removable media device may comprise FireWire media or a memory card such as a CompactFlash card a Secure Digital SD Card a memory stick and floppy or zip disk. Furthermore the ARM system and or the one or more anti virus engines may be operable to process information stored in a remote memory device or received via a network or email by the computer system . In this regard the remote memory may be referred to as the removable media device . In some systems there may be a plurality of removable media devices included in the system that may be processed in series or in parallel by the ARM system . The removable media device may comprise stored data metadata or software such as executable code or instructions. However the system is not limited with regard to the type of information stored on the removable media device . The removable media device may be referred to as storage memory remote memory or external memory for example.

The one or more anti virus scanning engines may be operable to scan or screen software and or data files which are stored on the removable media device or stored on other memory devices communicatively coupled to the computer system . The one or more anti virus engines may be operable to detect and or remove malicious software which may be referred to as malware. For example the malware may include computer viruses malicious browser helper objects BHOs computer worms ransomware trojan horses keyloggers rootkits spyware dishonest adware hijackers backdoors malicious layered service providers LSPs dialers and fraudtools. The one or more anti virus scanning engines may utilize any suitable method for scanning detecting and or removing malware. For example signature based detection may include searching software files for known patterns of data that may be utilized within executable code. Alternatively heuristic methods such as generic signatures may be utilized where files may be searched for known malicious code or variations of known code. However the system is not limited with respect to a specific method for scanning stored information and or for detecting malicious software. Furthermore the one or more anti virus scanning engines may be operable to detect when a file or information stored on the removable media device comprises executable code. For example in instances when the operating system comprises a Microsoft Windows operating system the one or more anti virus engines may examine the files and look for Portable Executable PE headers. If a PE header is detected in a file the file may be classified as an executable file. The one or more anti virus scanning engines may be referred to as a scanning system. The one or more service daemons may receive requests or messages and from the ARM system and may communicate with or respond to the ARM system .

In some systems one or more of the anti virus scanning engines may comprise third party software. The third party software may comprise a plurality of products from a plurality of different vendors or including different brands of software products. Some exemplary third party products include McAfee Anti virus McAfee Internet Security McAfee Total Protection McAfee All Access Norton Anti virus Norton Internet Security Norton 360 Microsoft Security Essentials Microsoft Forefront and Antivirus Gold AVG .

The ARM system may comprise application software and may include the kernel filter driver . The kernel filter driver may be part of the operating system for example it may be a driver within the operating system and or it may have hooks into the operating system . In some systems the operating system may comprise a Microsoft Windows operating system and the kernel filter driver may comprise a driver in the Windows operating system and may have hooks into the Windows operating system. The kernel filter driver may be operable to broker access to the removable media device or to other media devices which may be communicatively coupled to the computer system . The kernel filter driver may be operable block all access to the removable media device except to software or hardware which it directs to access the removable media device . In this regard the kernel filter driver may be operable make the removable media device exclusively accessible to an anti virus engine . For example the kernel filter driver may block access by one or more of the operating system and associated device drivers not shown the one or more anti virus engines and or other software such as application software . In systems where the operating system includes a Microsoft Windows operating system the kernel filter may be operable to exclude Windows and auto run functions from accessing the removable media device for example when the removable media device is plugged into an interface of the computer system . Moreover the kernel filter may be operable to grant to the operating system the one or more anti virus engines or other software such as application software access to the one or more files on the removable media device or other memory devices which may be communicatively coupled to the computer system . For example in instances when the one or more anti virus engines comprises a plurality of anti virus engines the kernel filter may block access by the operating system and may direct all or a portion of the anti virus engines in serial to access and process the data and or software files stored on the removable media device .

The kernel filter driver may be configured to select one or more of the anti virus engines to scan or process the information stored on the removable media device in a specified way. For example the kernel filter driver may direct McAfee anti virus software to scan the removable media device and may receive results of the scan from the McAfee software. Subsequently the kernel filter driver may direct Norton software to scan the removable media device and provide results. Subsequently the kernel filter driver may direct the Microsoft anti virus software to scan the removable device and report the results. The ARM system may utilize the results from all three scans to determine which files on the removable media device are safe to access and may grant access of the safe files to the operating system and or other software or users requesting access. The kernel filter driver may be referred to as a kernel driver.

In some systems the kernel filter driver may be operable to distribute content from a plurality of removable media devices over a plurality of the anti virus scanning engines . For example the plurality of engines may scan the content concurrently.

In some systems one or more of the anti virus scanning engines may comprise one or more virtual machines. The kernel driver which may sit between the removable media device and the operating system the one or more anti virus scanning engines a user or the application software for example. The kernel driver may isolate the removable media device and may submit the contents of the device to a virtual machine VM containing an entire anti virus scanning system . The VM scanning system may perform scans or other verification mechanisms to ensure the removable media device does not contain malware. The kernel driver may manage the removable media device access to ensure that only authorized scanning software can access the remote media device . After a first scanner finishes the kernel driver may advance to a next scanner if available. Once all the scanners finish a scanning daemon may inform the kernel driver of the results. The kernel driver may not allow access to any file in which at least one scanner indicated an infection. The kernel driver may prohibit access to the file thereby preventing infection of the computer system or any networked devices. Once cleared approved files from the removable media device may be presented to the operating system and they may become available to users and the application software .

The ARM system may be operable to block the operating system or any other software such as operating system drivers not shown or application software from accessing files that may be stored on the removable media device in instances when the files comprise executable code. The kernel filter driver may be operable to direct one or more of application software of the ARM system the one or more virtual machine scanning systems and the one or more anti virus engines to detect executable code on the removable media device . For example in instances when the operating system comprises a Windows operating system the one or more anti virus engines may examine files and look for Portable Executable PE headers which may be associated with executables on Windows systems. If any file includes such a header it may be classified as an executable. The kernel filter driver may then prevent access to any executable files on the removable device . Alternatively the one or more virtual machine scanning systems or the application software of the ARM system may be operable to perform examination of the files to look for the PE headers and classify the files as executable.

In some systems the ARM system may comprise the configuration software which may be utilized to configure one or both of the ARM system and the anti virus engines . The configuration software may determine or define which of the one or more anti virus engines may be utilized to process the information stored on the removable media device or other memory devices. The configuration software may specify specific features of the anti virus engines to utilize or parameters that may be passed to the one or more anti virus engines . Furthermore the configuration software may determine how the kernel filter driver operates and which features of the kernel filter driver may be utilized to process the information stored in the removable media device . In some systems the kernel filter device may be configured to direct one or more of application software of the ARM system a virtual machine scanning system or one or more of the anti virus engines to detect executable code stored on the removable media device and to block the operating system or other software such as application software running on the computer system from accessing the executable code. The ARM system may be configured to process information stored in one or more specified memory devices which are communicatively coupled to the computer system .

In some systems the configuration software may comprise a user interface for example a Microsoft Windows user interface that may allow a user such as a system administrator to configure or select features or parameters of the ARM system . In this manner the user may configure operations of the ARM system for example operations by the kernel filter driver and or specified usage of the one or more anti virus engines as described above.

In line scanning of removable media may reduce system performance and may be incurred each time media is loaded. To avoid this the contents of a scanned media device may be cached by the ARM system . In instances when the media device may be reinserted it may be matched with a cached record and the cached version of files may be returned the system eliminating a need to rescan the files. For new files that may be detected on the media device such as when additional files are added to a USB drive by another machine directory or file allocation table FAT information may be used to detect differences from a cached media device image which may cause the new entries to be scanned and added to the cache. The unmodified files may still be loaded from the cache. Moreover cached removable media content may enable the ARM system to rescan at a later time. Thus an organization may systematically detect machines that may have been previously exposed to zero day attacks in which malware was encountered before scanning software was updated to recognize it. Under existing systems such malware could go undetected in an initial screening and may propagate through a network without any record of an initial point of entry. In this manner the ARM system may increase accountability of media and data sources.

In some systems the ARM system may log scanning history or scanning results which may include information from a plurality of the anti virus scanning engines . The logged information may provide auditing trails for malicious software to system users.

In operation the ARM system may perform all or a portion of the steps described with respect to . In some systems the steps may be performed in a different order than the order shown in .

The removable media device driver may create a disk image of the removable media device and may send it to the scanning system server . The disk image may be communicated in an encrypted format. The anti virus scanner may scan the content of the disk image and may detect malicious software or may determine that the disk image is clear of malicious software. In instances when the disk image is clear of malware the approve and certify unit may approve the content in the disk image and may communicate certification of the disk image to the client system . The certification verification unit may verify the certification. In instances when the verification is successful the removable media device may be submitted to an operating system in the client system and a user or application software may be allowed to access content on the removable media device . In some systems the disk image may be communicated to a plurality of computing devices which comprise scanning systems which may each scan the disk image for malware.

In a networked deployment the computer system may operate in the capacity of a server or as a client user computer in a server client user network environment or as a peer computer system in a peer to peer or distributed network environment. The computer system may also be implemented as or incorporated into various devices such as a personal computer PC a tablet PC a set top box STB a personal digital assistant PDA a mobile device a palmtop computer a laptop computer a desktop computer a communications device or any other machine capable of executing the architecture for removable media system or logic that specifies actions to be taken by that machine. The computer system may comprise electronic devices that provide voice video or data communication. The system implementation may be a single computer system or may include any collection of systems or sub systems that individually or jointly execute a set or multiple sets of instructions to perform any of the processing for the architecture for removable media and communications noted above.

The computer system may include a processor for example a central processing unit CPU a graphics processing unit GPU or both. A processor may be implemented as a controller microprocessor digital signal processor microcontroller application specific integrated circuit ASIC discrete logic or a combination of other types of circuits or logic. Moreover the computer system may include a memory that may communicate via a bus . The memory may be a main memory a static memory or a dynamic memory. The memory may include but may not be limited to internal and or external computer readable storage media such as various types of volatile and non volatile storage media including but not limited to random access memory read only memory programmable read only memory electrically programmable read only memory electrically erasable read only memory flash memory magnetic tape or disk optical media and the like. In one case the memory may include a cache or random access memory for the processor . Alternatively or in addition the memory may be separate from the processor such as a cache memory of a processor the system memory or other memory.

In some systems the computer system may further include a display such as a liquid crystal display LCD an organic light emitting diode OLED a flat panel display a solid state display or a cathode ray tube CRT . Additionally the computer system may include an input device such as a keyboard and or a cursor control device such as a mouse or any other suitable input device. The computer system may also include a disk drive unit a signal generation device such as a speaker or remote control and one or more communication interfaces devices . The one or more communication interface devices may include any suitable type of interface for wireless wire line or optical communication between the computer system and another device or network for example the removable media device the scanning server system and or the ARM protector device . The computer system may be communicatively coupled with a network via the one or more communication interface devices . The computer system may be communicatively coupled via the communication interfaces to an external and or removable memory device for example the removable media device . In some systems the removable media device may be coupled via a USB connection. In some systems an external memory or the removable media device may be communicatively coupled via the network to the communication interface .

The disk drive unit may include a computer readable medium in which one or more sets of instructions for example software may be embedded. Further the instructions may embody one or more of the methods and or logic as described herein for the ARM system the ARM system or the one or more anti virus scanning engines for example. In a particular embodiment the instructions may reside completely or at least partially within the main memory or static memory and or within the processor during execution by the computer system . The memory and or the processor also may include computer readable media.

In general the ARM system or ARM system logic and processing or the anti virus engine logic and processing described above may be encoded and or stored in a machine readable or computer readable medium such as a compact disc read only memory CDROM magnetic or optical disk flash memory random access memory RAM or read only memory ROM erasable programmable read only memory EPROM or other machine readable medium as for examples instructions for execution by a processor controller or other processing device. The medium may be implemented as any device or tangible component that contains stores communicates propagates or transports executable instructions for use by or in connection with an instruction executable system apparatus or device. Alternatively or additionally the logic may be implemented as analog or digital logic using hardware such as one or more integrated circuits or one or more processors executing instructions that perform the processing described above or in software in an application programming interface API or in a Dynamic Link Library DLL functions available in a shared memory or defined as local or remote procedure calls or as a combination of hardware and software. In some systems the ARM protector device may be integrated within the computer system .

The system may include additional or different logic and may be implemented in many different ways. Memories may be Dynamic Random Access Memory DRAM Static Random Access Memory SRAM Flash or other types of memory. Parameters e.g. conditions and thresholds and other data structures may be separately stored and managed may be incorporated into a single memory or database or may be logically and physically organized in many different ways. Programs and instructions may be parts of a single program separate programs implemented in libraries such as Dynamic Link Libraries DLLs or distributed across several memories processors cards and systems.

In some systems a method of protecting a computer system from malware residing on a USB storage device includes the following steps. A USB device scanner may be inserted between a USB storage device and a USB port connected to the computer system. A disk image of the original electronic media stored on the USB storage device may be created with a USB device driver residing on the USB device scanner. The disk image may be sent to a screening server residing on the computer system. The disk image may be screened with malware detection software within the screening server. The disk image may be certified and approved as not being infected with malware by the screening server. The certification may be verified by the USB device scanner and the original media from the USB storage device may be submitted to the computer system if no malware is found.

In some systems a method of protecting a computer system from malware residing on a USB storage device comprises the following steps. A USB storage device may be inserted into a USB port connected to the computer system. An exclusive file system access mount may be provided to the USB device. The media stored on the USB storage device may be submitted to one or more scanning software programs on the computer system. The media may be scanned with the one or more scanning software programs. The disk image may be certified and approved as not being infected with malware by the screening server if no malware is found. The certification may be verified by the USB device scanner and the original media from the USB storage device may be submitted to the computer system as a new USB mount.

In some systems a device for scanning a USB storage device for malware may comprise the following elements. A body may have a port for accepting the USB storage device with stored computer readable media and a plug for insertion into a USB port of a computing system. A software driver may reside on the device the driver may have a series of executable commands for creating a disk image of the media and sending the disk image to a screening server residing on the computing system verifying the screening results from the computing system and presenting the media to the computing system if no malware exists.

While various embodiments of the invention have been described it will be apparent to those of ordinary skill in the art that many more embodiments and implementations are possible within the scope of the invention. Accordingly the invention is not to be restricted except in light of the attached claims and their equivalents.

