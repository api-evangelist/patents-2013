---

title: Secured multi-directional, multi-interface transaction processing
abstract: Embodiments of the present disclosure describe an apparatus, method, and computer readable medium for processing a secure transaction. One embodiment describes an apparatus comprising: a processor; a secure element coupled to the processor; and a connectivity device coupled to the secure element, and configured to exchange communications with a device that is external to the apparatus, and receive and execute one or more unsolicited commands from the secure element.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09594917&OS=09594917&RS=09594917
owner: NXP B.V.
number: 09594917
owner_city: Eindhoven
owner_country: NL
publication_date: 20130628
---
Conducting transactions electronically is becoming more common especially conducting transactions from a mobile device. For example a conventional mobile device such as a mobile telephone laptop computer tablet computer and the like may be capable of sending and receiving electronic payments. Sharing sensitive or confidential information such as credit card information bank account and routing information and the like is often required to process an electronic payment.

In some situations and environments certain components of a conventional mobile device such as a processor may not be secure that is they may be compromised by a computer virus or a hacker. In these situations and environments any sensitive or confidential information exchanged during the transaction may be exposed intercepted and subsequently used maliciously and without authorization.

While the present disclosure is described herein with illustrative embodiments for particular applications it should be understood that the disclosure is not limited thereto. A person skill in the art with access to the teachings provided herein will recognize additional modifications applications and embodiments within the scope thereof and additional fields in which the disclosure would be of significant utility.

The terms embodiments or example embodiments do not require that all embodiments include the discussed feature advantage or mode of operation. Alternate embodiments may be devised without departing from the scope or spirit of the disclosure and well known elements may not be described in detail or may be omitted so as not to obscure the relevant details. In addition the terminology used herein is for the purpose of describing particular embodiments only and is not intended to be limiting. For example as used herein the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will be further understood that the terms comprises comprising includes and including when used herein specify the presence of stated features integers steps operations elements and components but do not preclude the presence or addition of one or more other features integers steps operations elements components or groups thereof.

Some or all of the components of the apparatuses depicted in i.e. and may be implemented in the same integrated circuit or in different integrated circuits. For example and with reference to the apparatus of the processor the secure element and the connectivity device may each be implemented in the same integrated circuit or the secure element and the connectivity device may be implemented in the same integrated circuit and the processor in a different integrated circuit or the processor and the connectivity device may be implemented in the same integrated circuit and the secure element in a different integrated circuit or the processor the secure element and the connectivity device may each be implemented in different integrated circuits. Also as should be apparent to a person skilled in the art other components may be included in the apparatuses depicted in but may not necessary be required to achieve some or all of the aspects of this disclosure.

The apparatus of includes a processor a secure element and a connectivity device . The processor is communicatively coupled to the secure element and to the connectivity device and includes interfaces and to communicate with the secure element and the connectivity device respectively. The processor may be any processing device including but not limited to a general purpose processor a central processing unit CPU a microprocessor an application specific instruction set processor and the like.

The secure element of is communicatively coupled to the processor and to the connectivity device and includes interfaces and to communicate with the processor and the connectivity device respectively. The secure element of includes hardware software or a combination of hardware and software for interfacing and communicating with the processor and the connectivity device and for securely processing transactions. All software described throughout this disclosure may be embodied as one or more instructions on a non transitory computer readable medium.

In some example embodiments the secure element is an integrated circuit or chip that is embedded in a printed circuit board PCB such as a motherboard mainboard logic board and the like along with other components of the apparatus . In other embodiments the secure device is disposed in a subscriber identity module or subscriber identification module SIM that can be coupled to and communicate with the apparatus via an interface. In yet other embodiments the secure element is disposed in a secure digital SD card that can be coupled to and communicate with the apparatus via an interface. In some of these example embodiments the secure element is implemented as a smartcard chip and communicates with other components by sending and receiving one or more application protocol data units APDUs .

In the secure element includes the application which because it is executed on the secure element may be referred to as a secure application. The application which may be an applet or any other set of executable instructions may be activated by the secure element to process a transaction such as a secure transaction. Financial transactions such as sending or receiving a payment personal identification the exchange of sensitive or confidential information such as exchanging personal contact information or personal medical information and the establishment of a secure communication channel or link are non limiting examples of secure transactions. Also while illustrated as a single application in it should be apparent to one of ordinary skill in the art that the application may represent plural applications applets and the like.

In some example embodiments the secure element includes an application for each type of transaction that may be conducted by the secure element . For example the secure element may include a first application for processing secure financial transactions a second application for the secure exchange of sensitive or confidential information and a third application for establishing a secure communication channel. In these or other embodiments the secure element may include an application for each vendor party or device that the apparatus conducts a transaction with. For example the secure element may include a first application for conducting a secure financial transaction with a first banking institution and a second application for conducting a secure financial transaction with a second banking institution.

In some situations and environments such as a mobile computing environment the processor may not be trusted or secure it may be compromised by a computer virus or a hacker and any sensitive or confidential information used by the processor may be exposed. Thus in some example embodiments the secure element includes all necessary hardware e.g. processor memory etc. and software to process a secure transaction without requiring the processor or any other component to process any of the transaction. That is in these embodiments the entire transaction is processed by the secure element as opposed to processing part or all of the transaction at the processor or any other component . As an example the secure element receives a request from either the processor or the communication device to process a secure transaction. In this example the secure element identifies the type of transaction requested and activates an appropriate application residing on the secure element such as application which processes the transaction. This example illustrates that while the secure element may communicate with the processor or the communication device or both to obtain information regarding a transaction the entire transaction may be processed by the secure element .

Turning again to the connectivity device is communicatively coupled to the processor and to the secure element . The connectivity device includes interfaces and to communicate with the secure element and the processor respectively. The connectivity device also includes interface for interfacing and communicating with one or more external devices. As such the connectivity device includes hardware software or a combination of hardware and software for interfacing and communicating with the processor the secure element and one or more external devices. In some example embodiments such as the embodiment depicted by described below an apparatus for processing a secure transaction includes more than one connectivity device.

The connectivity device of may be any device for sending and receiving communications wired or wireless to and from the apparatus . Examples of the connectivity device as well as each of the connectivity devices depicted in i.e. and include but are not limited to a near field communication NFC device a Bluetooth communication device a wireless local area network WLAN communication device a cellular or other radio frequency RF communication device a satellite communication device an infrared communication device and the like.

As mentioned the interfaces and of the connectivity device allow the connectivity device to communicate with the secure element the processor and one or more external devices respectively. In some example embodiments the secure element may generate and send an unsolicited communication including an unsolicited command or instruction to the connectivity device . In these embodiments the connectivity device receives via interface the unsolicited communication from the secure element parses the unsolicited communication to identify the unsolicited command and executes the unsolicited command. Here the communication and the embedded command may be considered unsolicited because the connectivity device did not request the communication from the secure element that is the secure element initiated the communication with the connectivity device . In these embodiments it may be said that the connectivity device or the interface listens to and responds to secure element . The connectivity device may listen to and respond to the processor and one or more external devices in a similar manner. Also the processor may listen to and respond to the secure element in a similar manner.

Each of the interfaces and of may be implemented in hardware software or a combination of hardware and software. Also as should be apparent to one of ordinary skill in the art the processor secure element and connectivity device may include other interfaces for coupling to and communicating with devices circuits chips components and the like other than those shown in .

To facilitate interaction among the elements e.g. and of each element may provide an application programming interface API for the other elements to implement. For example the connectivity device provides an API that the secure element or an application such as application of described further below executing on the secure element implements so that the secure element can interact with and exploit the functionality of the communication device . Likewise the secure element may provide an API that the processor or an application such as application of described further below executing on the processor implements so that the processor can interact with and exploit the functionality of the secure element . Thus each element of may be able to communicate in a format compatible with each other element of .

As mentioned an apparatus for processing a secure transaction may include plural connectivity devices. illustrates an example apparatus for processing a secure transaction that includes a processor and a secure element similar to those depicted and described in accordance with but also includes plural connectivity devices . In the connectivity devices may be the same type of connectivity device or different types of connectivity devices and may communicate with other devices using the same or different communications protocols. For example connectivity devices may all be NFC devices. As another example connectivity device may be a NFC device connectivity device may be a Bluetooth communication device and connectivity device may be a WLAN communication device.

Each of the connectivity devices in the apparatus of may couple to and communicate with the processor and the secure element and vice versa as depicted and described in accordance with . The secure element of may include a single interface such as interface of for communicating with the plural connectivity devices or may include plural interfaces such as one interface for each connectivity device for communicating with the plural connectivity devices . Likewise the processor of may include a single interface such as interface of or plural interfaces such as one interface for each connectivity device for communicating with the plural connectivity devices 

In the interface may support communication with the secure element via the single wire protocol SWP or a similar protocol. The interface may support communication with the processor via for example a high speed bus a high speed inter chip HSIC bus a universal serial bus USB a universal asynchronous receiver transmitter UART a universal synchronous asynchronous receiver transmitter USART a peripheral component interconnect PCI a PCI express PCIe and the like. And the interface is coupled to an antenna to send and receive wireless communications.

The connectivity device of also includes logic unit which is coupled to the interfaces and . The logic unit may be implemented in hardware software or a combination of hardware and software. In some embodiments the logic unit includes firmware. In the logic unit partially or completely controls the connectivity device to function as described in relation to .

The connectivity device of includes plural logic units e.g. and which ma implement the same or different communications protocols. For example the logic unit may implement WLAN communications and the logic unit may implement Bluetooth communications. The logic unit is coupled to the interfaces and for communicating with the processor and one or more external devices respectively. The logic unit is coupled to the interfaces and for communicating with the processor and one or more external devices respectively.

Both logic units and are coupled to a switch which is coupled to the interface for communicating with the secure element . In some embodiments the switch is a multiplexer. In the switch may selectively couple either the logic unit or the logic unit to the interface for communicating with the secure element . In some embodiments the switch selectively couples more than two logic units to the interface . Thus as should be apparent to a person skilled in the art a connectivity device including more than two logic units configured as depicted in is within the scope of this disclosure.

Turning now to an example method for processing a transaction is illustrated. illustrates two apparatuses i.e. and conducting a transaction. Because the apparatus initiates the transaction in the pair and may be referred to as master and slave respectively or as reader and tag respectively however the roles of the apparatuses and may be reversed without departing from the scope of the disclosure.

Turning to stage which corresponds to communication 1 of the processor of the apparatus sends a transaction request to the external destination apparatus via the connectivity device . The transaction request may be generated by an application e.g. application executing on the processor and the application may be used to process in whole or in part the transaction. The transaction request may be generated in response to user input such as a user of the apparatus interacting with an input device coupled to the apparatus . As illustrated by the dotted line representing communication 1 the transaction request from the processor is sent from the apparatus via the connectivity device . The secure element of the apparatus receives the transaction request via the connectivity device and may activate a secure application e.g. application to generate a response to the transaction request.

At stage which corresponds to communication 2 of the processor receives a response from the external destination apparatus via the connectivity device . As illustrated by the dotted line representing communication 2 the secure element transmits the response generated at stage via connectivity device . The connectivity device of the apparatus receives the response and communicates the response to the processor

At stage which corresponds to communication 3 of the processor of the apparatus sends a command to the secure element . The command may include a request for sensitive or confidential information authentication of the information received from the apparatus instructions for processing a portion of the transaction and the like. The secure element receives the command and may activate a secure application e.g. application to generate a response to the command.

At stage which corresponds to communication 4 of the processor receives the response from the secure element and processes the transaction. As mentioned a processor such as the processor may not be trusted or secure in certain situations and environments. In the method of if the processor is compromised by a computer virus or a hacker any sensitive or confidential information used by the processor to process the transaction may be exposed intercepted and subsequently used maliciously and without authorization.

An example transaction illustrates the security risks posed by the method of . In this example Zoey the user of apparatus desires to purchase something from Alex the user of the apparatus . Alex may interact with a keyboard barcode reader or any other input device of the apparatus to request an electronic payment from Zoey. The processor receives the input such as the purchase price generates a request for payment e.g. using application and transmits the request for payment to the apparatus . Upon receiving the request the secure element may activate a secure electronic payment application e.g. application . In this example the secure element may store sensitive or confidential information about Zoey such as Zoey s credit card information and the electronic payment application may access the sensitive or confidential information and prepare a response containing that information.

The response containing Zoey s credit card information is transmitted from the secure element via the connectivity devices and to the processor . The processor may command the secure element to provide sensitive or confidential information about Alex such as Alex s bank account and routing information maintained by the secure element . Upon receiving the command from the processor a secure application e.g. application may gather the information and generate a response.

Next the application provides Alex s bank account and routing information to the processor which having Zoey s credit card information and Alex s bank account and routing information processes the transaction to complete the purchase. In this example if the processor is compromised by a computer virus or a hacker Zoey s credit card information and Alex s bank account and routing information may be exposed intercepted and subsequently used maliciously and without authorization. This example transaction between Alex and Zoey illustrates the security risks associated with the transaction processing method of .

Turning to an example method of processing a secure transaction where the illustrated apparatus i.e. apparatus operates in a master mode or a reader mode is depicted. In this example method the apparatus initiates a secure transaction with an external destination or apparatus that may operate as a slave or a tag. In some situations the external destination or apparatus functions as described in accordance with the apparatus of or the apparatus of described below .

At stage which corresponds to the communication 1 of the processor of the apparatus sends a transaction request to the secure element . The transaction request may be generated by an application e.g. application executing on the processor and may be generated in response to user input such as a user of the apparatus interacting with an input device coupled to the apparatus . Here the processor communicates the transaction request to the secure element .

At stage which corresponds to communication 2 of the secure element activates the application and sends an unsolicited command to the connectivity device . More specifically upon receiving the transaction request in stage the secure element may activate a secure application e.g. application to process the transaction. The secure application may generate a communication which may include a command instructing the connectivity device to send a transaction request to the external destination. In stage the secure element sends the communication to the connectivity device . Here the communication and the embedded command may be considered unsolicited because the connectivity device did not request the communication from the secure element that is the secure element initiated the communication with the connectivity device . In some situations or embodiments the communication sent by secure element to the connectivity device is an APDU.

At stage which corresponds to communication 3 of the connectivity device receives the unsolicited command from the secure element and sends the transaction request to the external destination. As described above the communication device or an interface of the communication device may listen for an unsolicited communication from the secure element . And upon receiving the unsolicited communication from the secure element the connectivity device parses the unsolicited communication to identify the unsolicited command and executes the unsolicited command. In stage the unsolicited command instructs the connectivity device to send a transaction request to the external destination.

At stage which corresponds to communication 4 of the secure element receives the response from the external destination via the connectivity device and processes the secure transaction. In the method of the external destination may function as described in accordance with the apparatus of . And as described in accordance with the response from the external destination may include sensitive or confidential information retrieved from a secure element of the external destination. In stage the transaction may be processed by the secure application thus any sensitive or confidential information from the external destination recall Zoey s credit card information from the example above or maintained by the secure element recall Alex s bank account and routing information from the example above are protected by the secure element and not exposed by the processor .

At stage which corresponds to communication 5 of the secure element communicates with the processor regarding the transaction. For example the secure element may notify the processor that the transaction is processed and the processor may thereafter notify a user of the apparatus e.g. via an output device or the like that the transaction has completed. Stage is optional and in some embodiments is not required.

At stage corresponding to communication 1 of the secure element receives a transaction request from an external destination via the connectivity device . As mentioned the transaction request may seek sensitive or confidential information of the user or a party associated with the apparatus . This information may be stored or maintained by the secure element .

At stage corresponding to communication 2 of the secure element activates the application to process the request and sends an unsolicited command to the processor . In response to receiving the transaction request at stage the secure element activates a secure application e.g. application to respond to the transaction request. The secure application may gather information including sensitive or confidential information to satisfy the request. In some situations the secure application requires additional information authorization to respond to the request or both additional information and authorization from a device entity party etc. outside of the secure element such as a user of the apparatus . For example an electronic payment request seeking payment over a certain amount may require authorization e.g. entry of a personal identification number PIN from the paying party.

In stage when it is necessary obtain information from outside of the secure element the secure application may generate a communication which may include a command instructing the processor to obtain and provide that information. The secure element sends the communication to the processor . Here the communication and the embedded command may be considered unsolicited because the processor did not request the communication from the secure element that is the secure element initiated the communication with the processor . In some situations or embodiments the communication sent by secure element to the processor is an APDU.

At stage corresponding to communication 3 of the processor responds to the command from the secure element . As described above the processor or an interface of the processor may listen for an unsolicited communication from the secure element . And upon receiving the unsolicited communication from the secure element the processor parses the unsolicited communication to identify the unsolicited command and executes the unsolicited command. Here the processor may obtain and provide the information authorization or both that are required by the secure element and the secure application to respond to the transaction request.

At stage corresponding to communication 4 of the application generates a response and the secure element sends the response to the external destination via the connectivity device . Upon receiving the information authorization or both from the processor in stage the secure application may generate a response to the transaction request which is subsequently sent from the secure element to the external destination via the connectivity device .

At stage corresponding to communication 1 of the connectivity device receives a transaction request from an external destination. Here the transaction request may seek to establish a secure communication channel other than the communication channel carrying the transaction request. For example the connectivity devices and of the apparatus may be a NFC device and a WLAN communication device respectively. In this example the transaction request arrives via the NFC device and seeks to establish a secure WLAN communication channel or vice versa.

At stage corresponding to communication 2 of the secure element receives the transaction request via the connectivity device and activates the application to respond to the transaction request. More specifically upon receiving the transaction request in stage the secure element may activate a secure application e.g. application to respond to and process the transaction.

In some embodiments the secure element or the secure application includes one or more encryption keys that may be used to perform cryptography such as public key cryptography and private key cryptography. Using these keys and cryptography techniques the secure application and an application at an external destination may encrypt all communications to increase the security of their communications. Also the secure application and an application at an external destination may use encryption keys to authenticate over a completely open communication channel such as Bluetooth or WLAN without concern over the security of the communication channel. For example the secure application and an application at an external destination may include pre shared private keys. These private keys may be used to authenticate the source of communications between the secure application and the application at the external destination. These cryptography and authentication techniques may also apply to the apparatuses and methods of .

At stage corresponding to communication 3 of the secure element sends an unsolicited command to the connectivity device . The secure application may generate a communication which may include a command instructing the connectivity device to establish a communication link to an external device the secure element sends the communication to the connectivity device . Here the communication and the embedded command may be considered unsolicited because the connectivity device did not request the communication from the secure element that is the secure element initiated the communication with the connectivity device . In some situations or embodiments the communication sent by secure element to the connectivity device is an APDU.

At stage corresponding to communication 4 of the connectivity device sends a response to an external destination. As described above the connectivity device or an interface of the connectivity device may listen for an unsolicited communication from the secure element . And upon receiving the unsolicited communication from the secure element the connectivity device parses the unsolicited communication to identify the unsolicited command and executes the unsolicited command. Here the connectivity device establishes a secure communication channel with an external destination. The external destination in stage may be the same as or different than the external destination in stage . Consider again the example of establishing a secure WLAN communication channel described in relation to stage a NFC reader that sends a transaction request to the apparatus may be disposed at a first physical location e.g. a cash register and a WiFi router to which the apparatus establishes the secure WLAN communication channel may be disposed at a second physical location e.g. a utility closet .

As should be apparent to one of skill in the art the apparatus of may include any number of connectivity devices and the secure element may choose which connectivity device to send the command based on the transaction request. For example the secure element may send an unsolicited command to a Bluetooth communication device when the transaction request seeks a Bluetooth communication channel a WLAN communication device when the transaction request seeks a WLAN communication channel a cellular communication device when the transaction request seeks a cellular communication channel and the like.

It is to be appreciated that the Detailed Description section and not the Summary and Abstract sections is intended to be used to interpret the claims. The Summary and Abstract sections may set forth one or more but not all example embodiments of the present disclosure as contemplated by the inventor s and thus are not intended to limit the present disclosure and the appended claims in any way.

The present disclosure has been described above with the aid of functional building blocks illustrating the implementation of specified functions and relationships thereof. The boundaries of these functional building blocks have been arbitrarily defined herein for the convenience of the description. Alternate boundaries can be defined so long as the specified functions and relationships thereof are appropriately performed.

The foregoing description of the specific embodiments will so fully reveal the general nature of the disclosure that others can by applying knowledge within the skill of the art readily modify and or adapt for various applications such specific embodiments without undue experimentation without departing from the general concept of the present disclosure. Therefore such adaptations and modifications are intended to be within the meaning and range of equivalents of the disclosed embodiments based on the teaching and guidance presented herein. It is to be understood that the phraseology or terminology herein is for the purpose of description and not of limitation such that the terminology or phraseology of the present specification is to be interpreted by one of ordinary skill in the art in light of the teachings and guidance.

The breadth and scope of the present disclosure should not be limited by any of the above described example embodiments but should be defined only in accordance with the following claims and their equivalents.

The claims in the instant application are different than those of other related applications. The Applicant therefore rescinds any disclaimer of claim scope made in any predecessor application in relation to the instant application. The Examiner is therefore advised that any such previous disclaimer and the cited references that it was made to avoid may need to be revisited. Further the Examiner is also reminded that any disclaimer made in the instant application should not be read into or against any other application.

