---

title: Managing application access to certificates and keys
abstract: Plural modes of operation, each associated with a class attribute, may be established on a mobile device. The present application discloses a method of handling an application launch request, a computing device for carrying out the method and a computer readable medium for adapting a processor to carry out the method. The method includes receiving a launch request identifying an application that is to be launched, acquiring an identity for the application, acquiring a class for the application, labeling the application with the identity and the class and launching the application.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09386451&OS=09386451&RS=09386451
owner: BlackBerry Limited
number: 09386451
owner_city: Waterloo
owner_country: CA
publication_date: 20130311
---
The present application claims priority to U.S. Provisional Patent Application No. 61 757 989 filed Jan. 29 2013 the contents of which are incorporated herein by reference.

The present application relates generally to management of digital identity certificates and cryptographic keys and more specifically to managing application access to certificates and keys.

Mobile devices are used for a variety of purposes. Users may wish to use a particular mobile device for personal applications such as games reading news distributed using really simple syndication RSS web browsing and general leisure. Corporations may want the same mobile device to be used for a subset of functionality required for a user to complete their job.

However when a mobile device is used for both corporate and personal matters a corporation may choose to limit the risk of exposure of data on the mobile device. This may be done for example through the implementation of information technology IT policies on the mobile device. Such policies sometimes lead to a poor user experience as the mobile device may be locked such that no new applications may be loaded onto the mobile device. Alternatively the mobile device may be restricted regarding which non work related applications may be loaded onto the device. For example an IT policy on the mobile device may in an effort to prevent potential spread of viruses prohibit the user of the mobile device from downloading software from any location other than a specifically approved location. In this manner the range of applications that the user can install may be significantly limited.

Rather than restricting access to an entire mobile device that is used for both personal and corporate functionality the present disclosure contemplates the creation of dual or plural modes of operations on the mobile device. In particular each application of a plurality of applications may be segregated into one of a plurality of groups. In an example scenario involving a corporate mode of operation and a personal mode of operation applications can be designated as either corporate applications or personal applications. In some cases where an application may be both corporate and personal a copy of the application code can be saved in both a personal memory space and a corporate memory space on the mobile device.

The present disclosure provides for a mobile device but is not meant to be limited to any particular mobile device. Examples of mobile devices include smart phones personal digital assistants data enabled cellular telephones tablet computers among others.

The mobile device in the present disclosure implements an IT policy to control corporate data. This may be done by connection to an enterprise server which provides the IT policy for the device. In other embodiments the IT policy may be implemented on a per device basis individually.

Notably the segregation of applications discussed hereinbefore may have far reaching implications for management of security aspects of the mobile device. For example public and private cryptographic keys may be saved in memory in such a manner that the keys are associated with the mobile device and not with a mode of operation of the mobile device. Similarly digital identity certificates may be saved in memory in such a manner that the identity certificates are associated with a user of the mobile device and not with a mode of operation of the mobile device.

Before launching an application the application may be labeled with an identity attribute and a class attribute. The class attribute may be associated with a mode of operation. The application s identity and class may then be taken into consideration when processing an application s request to access a store or create a new store.

According to an aspect of the present disclosure there is provided a method of handling an application launch request. The method comprises receiving a launch request identifying an application that is to be launched acquiring an identity for the application acquiring a class for the application labeling the application with the identity and the class and launching the application. In other aspects of the present application a mobile communication device with a processor is provided for carrying out this method and a computer readable medium is provided for adapting a processor in a mobile communication device to carry out this method.

According to another aspect of the present disclosure there is provided a method of handling attempted access to a store in a memory of a device. The method comprises receiving from an application a request for access to a store detecting an identity for the application detecting a class for the application determining whether the application can access the store and based on the determining processing the request. In other aspects of the present application a mobile communication device with a processor is provided for carrying out this method and a computer readable medium is provided for adapting a processor in a mobile communication device to carry out this method.

According to a further aspect of the present disclosure there is provided a method of handling creation of a store in a memory of a device. The method comprises receiving from an application a request to create a store detecting an identity for the application detecting a class for the application creating conditions to access the store the creating based on the identity and the class and creating the store with the conditions. In other aspects of the present application a mobile communication device with a processor is provided for carrying out this method and a computer readable medium is provided for adapting a processor in a mobile communication device to carry out this method.

Other aspects and features of the present disclosure will become apparent to those of ordinary skill in the art upon review of the following description of specific implementations of the disclosure in conjunction with the accompanying figures.

Reference is now made to which shows a block diagram of a memory of a mobile device. The memory is configured to maintain executable code for various applications and data related to the operation of the various applications such combination of code and data being referred to herein as an application space . As illustrated in the example of the memory is divided into a personal space and a corporate space .

The corporate space generally comprises a portion of memory on the mobile device segregated for data applications or both. The data and or applications may be considered sensitive to a business corporation enterprise government non profit organization user of the device or any other entity responsible for the setting of an IT policy for the mobile device.

The personal space generally comprises a portion of memory segregated for personal applications and data where such applications or data may be considered outside of or separate from those applications that are subject to an IT policy.

An application executed from code saved within the personal space may access data that is also saved within the personal space . The data that is saved within the personal space may be considered to be personal data.

Similarly an application executed from code saved within the corporate space may access data that is also saved within the corporate space . The data that is saved within the corporate space may be considered to be corporate data.

By segregating corporate applications from personal applications and data associated with each a corporate IT policy may be implemented on the mobile device for the corporate data thereby protecting the data while still allowing for personal applications and personal data on the device. This provides more flexibility to a user of the mobile device and an arguably better user experience.

The designation of each application loaded onto the mobile device as either a personal application or a corporate application may be done in several ways. In one embodiment a corporate IT policy can be set for the loading of applications onto the mobile device where certain specified applications are designated by the IT policy to be on a list of corporate applications. Other applications which are not the list of corporate applications could be considered by default to be personal applications. In other embodiments a user administrator carrier or other entity can use a configuration program or a navigation entity application launcher to designate the various applications on the device as either a personal application or a corporate application. Further signatures applied to applications could also be used for making a distinction between personal applications and corporate applications. Other examples of the designation of applications as corporate and personal would be apparent to those skilled in the art having the benefit of the present disclosure.

In further embodiments hybrid applications which have both personal and corporate uses could be duplicated between the corporate space and the personal space . In this way if a user wants to use a particular application for personal reasons the user could execute the application code that is saved in the personal space . Conversely if the user wants to use the same application for corporate purposes the user could execute the application code that is saved in the corporate space .

Thus for example one copy of the code for a document editor could be saved in the personal space and another copy of the code for the document editor could be saved in the corporate space thereby allowing the editing of both personal documents and corporate documents while maintaining security for the corporate data .

In one embodiment the corporate applications may be provided with additional security over the personal applications . For example before allowing one of the corporate applications to be launched the operating system may prompt the user to provide authentication e.g. the operating system may prompt the user to enter a password and the operating system may authenticate the password. Further inactivity timers could be implemented such that the corporate applications may be locked after a period of inactivity while leaving the personal applications unlocked. The operating system may require a user to enter a password to unlock a locked corporate application so that the corporate data related to the corporate application may be accessed.

The designation e.g. personal or corporate of a given application may further limit the data to which the given application has access. Thus for example the corporate applications may execute in their own mode in which mode any data that is written by the corporate applications may not be accessed by the personal applications . The limitation would be that personal applications are not able to read corporate data nor is a corporate application capable of writing to personal data .

Similarly a given personal application may not be able to write to the corporate data . In some embodiments the corporate applications may not be able to read the personal data . In other embodiments the corporate applications may be able to read the personal data .

The corporate data may also have date of deletion policies in effect on the mobile device. Thus if a subset of the corporate data is not accessed within a certain time period a date of deletion policy may dictate that the subset is to be erased. The date of deletion policy may be pursuant to a corporate data reaping timeline. For example if data is not accessed on the mobile or computing device for seven days the data may be deleted from the mobile device. The user would then need to download the data again if the data was required for the mobile device. This may be implemented through tags or data tables associated with the data.

The operating system may handle the enforcement of the above differentiating rules between the corporate space and the personal space . For example the operating system may implement data access for the various applications and where each application is given a group permission similar to UNIX group permissions. In other embodiments other user permission or other permission system may also be used. Data is further designated in files that allow access by certain groups. Thus the operating system may allow the corporate data to be accessed only by the corporate applications that have group permissions to access such data. Similarly the personal data may be written to or read only by the personal applications based on the group permissions of the personal applications with regard to the personal data . The corporate applications however may not have group permissions to write to the personal data in one embodiment as enforced by the operating system .

As shown by a dashed line with an arrow tip in the personal data may have some form of public permissions that would allow the corporate applications to read the personal data .

Access to the data may be maintained for other data functionalities thereby preventing the corporate data from being accessed in the personal mode. For example copy or cut functionality may be managed between the personal mode and corporate mode. Potentially no cutting or copying would be allowed in the corporate mode of operation by the corporate applications .

In other embodiments cutting and copying may be allowed between corporate applications but may be restricted when trying to paste outside corporate mode. As will be appreciated this could again be managed by a UNIX group permission type model using the operating system . When cutting or copying various text or images or other data a new data file is created which could have group permissions that would restrict where the pasting of that file is allowed to occur. Thus when using a personal application if trying to paste corporate data an error might be returned or the paste operation may simply not function.

In one embodiment the corporate data may be provided to a mobile device based on a secure connection with the corporate network. For example this may be done through a virtual private network or other secure connection to an enterprise server.

Further in one embodiment the memory may be located on a mobile device. In this case the mobile device may have a pre established secure connection with an enterprise server.

The housing may be elongated vertically or may take on other sizes and shapes including clamshell housing structures . In the case in which the keyboard includes keys that are associated with at least one alphabetic character and at least one numeric character the keyboard may include a mode selection key or other hardware or software for switching between alphabetic entry and numeric entry.

In addition to the microprocessor other parts of the mobile communication device are shown schematically in . These may include a communications subsystem a short range communications subsystem the keyboard and the display . The mobile communication device may further include other input output devices such as a set of auxiliary I O devices a serial port a speaker and a microphone . The mobile communication device may further include memory devices including a flash memory and a Random Access Memory RAM and various other device subsystems . The mobile communication device may comprise a two way radio frequency RF communication device having voice and data communication capabilities. In addition the mobile communication device may have the capability to communicate with other computer systems via the Internet.

Operating system software executed by the microprocessor may be saved in a computer readable medium such as the flash memory but may be saved in other types of memory devices such as a read only memory ROM or similar storage element. In addition system software specific device applications or parts thereof may be temporarily loaded into a volatile store such as the RAM . Communication signals received by the mobile device may also be saved to the RAM .

The microprocessor in addition to its operating system functions enables execution of software applications on the mobile communication device . A predetermined set of software applications that control basic device operations such as a voice communications module A and a data communications module B may be installed on the mobile communication device during manufacture. A space management module C a certificate manager D and an installer module E may also be installed on the mobile communication device during manufacture to implement aspects of the present disclosure. As well additional software modules illustrated as an other software module N which may comprise for instance a personal information manager PIM application may be installed during manufacture. The PIM application may be capable of organizing and managing data items such as e mail messages calendar events voice mail messages appointments and task items. The PIM application may also be capable of sending and receiving data items via a wireless carrier network represented by a radio tower. The data items managed by the PIM application may be seamlessly integrated synchronized and updated via the wireless carrier network with the device user s corresponding data items saved or associated with a host computer system.

Communication functions including data and voice communications are performed through the communication subsystem and possibly through the short range communications subsystem . The communication subsystem includes a receiver a transmitter and one or more antennas illustrated as a receive antenna and a transmit antenna . In addition the communication subsystem also includes a processing module such as a digital signal processor DSP and local oscillators LOs . The specific design and implementation of the communication subsystem is dependent upon the communication network in which the mobile communication device is intended to operate. For example the communication subsystem of the mobile communication device may be designed to operate with the Mobitex DataTAC or General Packet Radio Service GPRS mobile data communication networks and also designed to operate with any of a variety of voice communication networks such as Advanced Mobile Phone Service AMPS Time Division Multiple Access TDMA Code Division Multiple Access CDMA Personal Communications Service PCS Global System for Mobile Communications GSM Enhanced Data rates for GSM Evolution EDGE Universal Mobile Telecommunications System UMTS Wideband Code Division Multiple Access W CDMA High Speed Packet Access HSPA Long Term Evolution LTE etc. Other types of data and voice networks both separate and integrated may also be utilized with the mobile communication device .

Network access requirements vary depending upon the type of communication system. Typically an identifier is associated with each mobile device that uniquely identifies the mobile device or subscriber to which the mobile device has been assigned. The identifier is unique within a specific network or network technology. For example in Mobitex networks mobile devices are registered on the network using a Mobitex Access Number MAN associated with each device and in DataTAC networks mobile devices are registered on the network using a Logical Link Identifier LLI associated with each device. In GPRS networks however network access is associated with a subscriber or user of a device. A GPRS device therefore uses a subscriber identity module commonly referred to as a Subscriber Identity Module SIM in order to operate on a GPRS network. Despite identifying a subscriber by SIM mobile devices within GSM GPRS networks are uniquely identified using an International Mobile Equipment Identity IMEI number.

When required network registration or activation procedures have been completed the mobile communication device may send and receive communication signals over the wireless carrier network . Signals received from the wireless carrier network by the receive antenna are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and may also provide analog to digital conversion. Analog to digital conversion of the received signal allows the DSP to perform more complex communication functions such as demodulation and decoding. In a similar manner signals to be transmitted to the wireless carrier network are processed e.g. modulated and encoded by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the wireless carrier network or networks via the transmit antenna .

In addition to processing communication signals the DSP provides for control of the receiver and the transmitter . For example gains applied to communication signals in the receiver and the transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP .

In a data communication mode a received signal such as a text message or web page download is processed by the communication subsystem and is input to the microprocessor . The received signal is then further processed by the microprocessor for output to the display or alternatively to some auxiliary I O devices . A device user may also compose data items such as e mail messages using the keyboard and or some other auxiliary I O device such as a touchpad a rocker switch a thumb wheel a trackball a touchscreen or some other type of input device. The composed data items may then be transmitted over the wireless carrier network via the communication subsystem .

In a voice communication mode overall operation of the device is substantially similar to the data communication mode except that received signals are output to the speaker and signals for transmission are generated by a microphone . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile communication device . In addition the display may also be utilized in voice communication mode for example to display the identity of a calling party the duration of a voice call or other voice call related information.

The short range communications subsystem enables communication between the mobile communication device and other proximate systems or devices which need not necessarily be similar devices. For example the short range communications subsystem may include an infrared device and associated circuits and components or a Bluetooth communication module to provide for communication with similarly enabled systems and devices or a near field communication module etc.

The mobile communication device may generate cryptographic keys for use in a public key infrastructure PKI scheme. In a PKI scheme a device generates a public cryptographic key public key and a corresponding private cryptographic key private key . However such cryptographic keys are of little use unless the public key is reliably associated with the identity of the mobile communication device or the identity of the user of the mobile communication device .

A public key certificate or digital identity certificate is an electronic document issued by a trusted party. The public key certificate incorporates a digital signature to bind together a public key with an identity information such as the name of a person or an organization an associated address and so forth. The certificate can be used to verify that a public key belongs to an individual.

A Certificate Authority CA may act as the trusted party the entity that issues digital certificates. The digital certificate certifies the ownership of a public key by the named subject of the digital certificate.

Upon receiving a communication and an associated signature the microprocessor of the mobile communication device may act to authenticate the communication. The microprocessor may generate a hash of the communication. The microprocessor may also decrypt the signature using a public key associated with the source of the communication. Upon matching the decrypted signature to the generated hash of the communication the microprocessor may consider the communication to have reliably originated at the source.

When the microprocessor requires the public key associated with the source of the communication the microprocessor may review a local key store. Upon failing to locate the public key in the local key store the microprocessor may seeks to import a digital certificate associated with the source of the communication. The microprocessor may obtain the digital certificate directly from the source of the communication or from a trusted CA. Upon obtaining the digital certificate the microprocessor may save the digital certificate at the mobile communication device in a certificate store. Furthermore the microprocessor may extract the public key from the digital certificate and save the public key in a key store.

Historically certificate stores and key stores have been implemented independent of the concept of the mobile communication device having distinct modes of operation and corresponding memory spaces.

In aspects of the present application a class designation may be used within the existing certificate store structure and key store structure. Accordingly individual certificates and keys can be assigned to one space among plural spaces. In operation the microprocessor may consider a class of a certificate when importing the certificate validating the certificate and deleting the certificate. Similarly the microprocessor may consider a class of a key when importing the key and when deleting the key.

The space management module C executed by the microprocessor may be configured to handle such tasks as space creation and space removal.

The same method may be repeated for the corporate space. Similarly the method illustrated in can be used to create a personal key store or a corporate key store.

Initially the space management module C may receive step a command to create a corporate space. Responsively the space management module C may designate step a range of addresses in the memory for the corporate space . The space management module C may send step inter process messages to the certificate manager D to indicate that the corporate certificate stores are to be initialized for the corporate space . The certificate manager D may then initialize step one or more corporate certificate stores. For example a corporate certificate store may be created for certificates related to the browsing by the mobile communication device of the world wide web. For another example a corporate certificate store may be created for certificates related to use by the mobile communication device of WiFi networks. For a further example a corporate certificate store may be created for certificates related to use by the mobile communication device of Virtual Private Networks VPNs .

Hereinbefore creation step of a certificate store associated with the designation of a class has been presented in the context of creation of a space associated with the designation of the same class e.g. corporate . Notably however a certificate store may be created independent of the creation of a space and responsive to a command to create a certificate store.

Similarly responsive to receiving step a command to delete a space of a particular class the space management module C may send step inter process messages to the certificate manager D to indicate that corporate key stores are to be deleted. The certificate manager D may then delete one or more key stores of the same class.

Notably the deletion step of the one or more corporate certificate stores by the certificate manager D may occur without messaging between the space management module C and the certificate manager D. In such a case the space management module C merely receives step a command to delete a space of a particular class and responsively deletes step the applications of the particular class.

The certificate manager D as part of the operating system may occasionally be called upon by a given application among the applications to verify the validity of a certificate. For example the certificate manager D may receive step see a certificate validation command when the given application executed on the mobile communication device has received a certificate from a source of a communication.

In typical operation it is expected that the certificate manager D will build step a certificate chain for the received certificate. The received certificate is expected to indicate an issuing CA. The issuing CA may be trusted based on a certificate issued by a further CA and so on ending at a so called root CA certificate. Having built the chain the certificate manager D attempts to validate step the chain by determining that the root CA is saved in one of the trusted certificate stores for the given application and is explicitly trusted. Upon determining that the root CA certificate for the received certificate is saved in one of the trusted certificate stores the certificate manager D may reply step to the given application from which the certificate validation command was received with an indication of a validation status. As will be familiar to those skilled in the art the indication may include a message indicating successful validation or a message indicating unsuccessful validation.

The certificate manager D will typically attempt to validate step the chain by locating the root CA certificate in any one of the trusted certificate stores without regard for whether a particular certificate store is a corporate certificate store or a personal certificate store. This could lead to a situation where the given application running in the corporate space may cause the certificate manager D to successfully validate step a chain based on a root CA certificate that is explicitly trusted in a personal certificate store but not specifically trusted in one of the corporate certificate stores.

The certificate validation command created by the given application may specify one or more certificate stores. As one solution the certificate manager API may be altered such that for example certificate manager D may only validate step a chain based on a root CA certificate in a specific personal certificate store thereby leading to validation of the certificate with a root CA certificate trusted in the personal space . The certificate manager D may for another example only validate step a chain based on a root CA certificate in a specific corporate certificate store thereby leading to validation of the certificate with a root CA certificate trusted in the corporate space . If the certificate store is not specified then the certificate manager D may validate step a chain based on a root CA certificate in a personal certificate store or a corporate certificate store thereby leading to validation of the certificate with either a root CA certificate trusted in the personal space or a root CA certificate trusted in the corporate space .

As mentioned hereinbefore the certificate validation command created by the given application may specify multiple certificate stores. However it is noted that all of the certificate stores will be in the same space. In such a case the certificate manager D may attempt to validate step a chain against root CA certificates in all of the multiple certificate stores.

With memory arranged in spaces as described herein some care may be exercised when launching applications and allowing applications to import and use certificates while also restricting access to these certificates. Access control for a given application may take into account the identity of application and the class of the application.

The identity of an application is unique and is assigned to the application before launch. In the case of an installed application the identity of the application may be assigned by the installer module E see executed by the microprocessor . In the case of a system service application that comes pre installed on a device the identity of the system service application may be assigned by the device manufacturer during development.

The class of an application may be assigned at the time of launching the application by a class manager. The class manager may for example select a class based on user interactions that lead to the launching of the application. For example the user may cause an application to launch while working within the corporate mode of operation and accordingly select the corporate class. Certain system service applications may be assigned one or more classes. The function of a class manager may be carried out by the space management module C. Alternatively a distinct class management module may be executed by the microprocessor to handle class manager functions. Such a class management module may be among the other modules N illustrated in .

Enforcing application access to certificates may be accomplished by enforcing application access to certificate stores. A given application may be provided with a store namespace only those stores to which the given application has access are visible to the given application. An application s identity and class may be detected at the time of a certificate operation request and the request may be handled based on the visible store namespace.

The application launcher acquires step an identity and a class for the application that is to be launched. Indeed the application launcher may extract the identity for the application from the launch request. Similarly the application launcher may extract the class for the application from the launch request.

Upon acquiring step an identity and a class for the application that is to be launched the application launcher may label step the application that is to be launched with an identity attribute and a class attribute. The application launcher may then launch step the application.

Example conditions that may be attached to a store may be based on whitelists. One or more identities applications may be granted access with the owner the application that created the store always having read write access. Each application as identified by its identity or identity group may be granted either read only or read write access. One example for an identity group may be a list of identities of applications. Another example for an identity group may be all applications of a certain class. A further example for an identity group may be all applications. The latter example may employ a wildcard character.

The read only and read write whitelists are properties of a given store created and updated by the owner application implicitly or explicitly and are always present. An application without knowledge of other applications that just wants a store may create a store with only its own identity added to the read write whitelist.

A list of all stores to which a given application has access may be called a namespace for the given application. Stores that are accessible by multiple applications will appear in multiple namespaces. Stores that are accessible by only a single application will appear in only one namespace.

For example if the application has requested access to a certificate store that is in the namespace of the application processing step the request may involve the certificate manager D allowing the application access to the certificate store. Furthermore processing step the request may involve carrying out the request. However if the application has requested access to a certificate store that is not in the namespace of the application processing step the request may involve the certificate manager D denying the application access to the certificate store.

The descriptions of the methods whose example steps are illustrated in reference certificate stores specifically. It should be clear that access to key stores may be managed in a similar manner. Indeed there may be stores for data items that are neither certificates nor keys and yet the methods described hereinbefore may be applied.

Conveniently designation of a class for certificates and keys allows for specific spaces to be associated with distinct certificate stores and keys stores thereby allowing for space aware import validation and deletion of certificates and keys. As described hereinbefore validation does not cross space boundaries. Furthermore on deletion of a space associated certificates are also deleted.

The above described implementations of the present application are intended to be examples only. Alterations modifications and variations may be effected to the particular implementations by those skilled in the art without departing from the scope of the application which is defined by the claims appended hereto.

