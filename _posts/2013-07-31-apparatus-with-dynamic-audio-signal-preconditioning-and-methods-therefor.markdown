---

title: Apparatus with dynamic audio signal pre-conditioning and methods therefor
abstract: An apparatus includes an echo canceller having an audio signal input and an audio signal output and dynamic pre-conditioning logic. The dynamic pre-conditioning logic is operatively coupled to the echo canceller audio signal output as a feedback signal and has a dynamic pre-conditioning logic output operatively coupled to the echo canceller audio signal input. The dynamic pre-conditioning logic is also operative to receive an audio signal input from at least one microphone. The dynamic pre-conditioning logic is operative to analyze the feedback signal to obtain at least one characteristic, and pre-condition the audio signal input, based on the at least one characteristic of the feedback signal, and provide a pre-conditioned audio signal at the echo canceller audio signal input. The echo canceller audio signal output is then provided to a noise suppressor for the send path of a full duplex communication channel.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09237225&OS=09237225&RS=09237225
owner: Google Technology Holdings LLC
number: 09237225
owner_city: Mountain View
owner_country: US
publication_date: 20130731
---
The present patent application claims priority to U.S. Provisional Patent Application No. 61 844 989 filed Jul. 11 2013 entitled APPARATUS WITH DYNAMIC AUDIO SIGNAL PRE CONDITIONING AND METHODS THEREFOR and further claims priority to U.S. Provisional Patent Application No. 61 798 097 filed Mar. 15 2013 entitled VOICE RECOGNITION FOR A MOBILE DEVICE and further claims priority to U.S. Provisional Pat. App. No. 61 776 793 filed Mar. 12 2013 entitled VOICE RECOGNITION FOR A MOBILE DEVICE all of which are assigned to the same assignee as the present patent application and all of which are hereby incorporated by reference herein in their entirety.

The present disclosure relates generally to audio processing and more particularly to methods and apparatuses for audio filtering and noise suppression in audio processing systems.

Communication devices such as but not limited to stationary telephones cordless telephones mobile phones smart phones tablets laptops etc. include or may include audio processing for voice communications or to drive voice recognition systems to provide hands free voice control of the devices. Such communication devices employ mechanisms to cancel or reduce near field ambient noise in order to sustain a level of clarity during two way voice i.e. full duplex communications. Most systems employ noise suppressors as one mechanism to stop minimize or subtract unintended audio signals from contaminating desired speech signals during voice communications.

Most of such systems also utilize pre conditioning processing which is applied prior to the application of more sophisticated noise suppression. For example high pass filtering may help block or reduce wind noise or road noise. More generally the pre conditioning processing may include various filters or amplifiers that may be applied to one or more microphone signal outputs prior to noise suppression. This pre conditioning however is fixed and treats all signals in the same manner. However because input signal characteristics are dynamic and change with external conditions including orientation of the device the fixed pre conditioning may not be appropriate for the given signal characteristics. Therefore in some situations the pre conditioning may adversely impact subsequent noise suppression if the audio signal input to the noise suppression is inappropriately filtered or amplified.

The disclosed embodiments provide a method that includes receiving an echo canceller audio signal output as a feedback signal analyzing the feedback signal to obtain at least one characteristic and pre conditioning an audio signal based on the at least one characteristic of the feedback signal and providing a pre conditioned audio signal as an echo canceller audio signal input. The method may include providing a pre conditioned echo canceller audio signal output based on the pre conditioning audio signal as a noise suppressor input and performing noise suppression on the noise suppressor input. In some embodiments obtaining at least one characteristic includes obtaining at least one of a frequency characteristic or an amplitude characteristic of the feedback signal. In one embodiment analyzing the feedback signal includes performing a Fast Fourier Transform FFT on the feedback signal.

In some embodiments the method may include providing a noise suppressor output on a send path of a full duplex communication channel to a transceiver for transmission on the full duplex communication channel. The method may also include disabling fixed pre conditioner filtering prior to pre conditioning the audio signal.

In some embodiments the method may include determining if noise contained in the feedback signal is below a cutoff frequency as the at least one characteristic of the feedback signal and pre conditioning the audio signal by applying a high pass filter. The method may also include determining if a near talker s voice contained in the feedback signal is within a given frequency range as the at least one characteristic of the feedback signal and pre conditioning the audio signal by applying a pre emphasis filter to emphasize the given frequency range. For example a male or female voice may have a frequency within a given frequency range which if determined by the method can be emphasized with an appropriate pre determined filter.

The method may also include determining if frequency response modification is needed based on the feedback signal as the at least one characteristic of the feedback signal and pre conditioning the audio signal by applying a frequency modification filter. In some embodiments the method may include determining processing time available to perform filtering of the audio signal and selecting audio signal filters based on the processing time available.

The present disclosure also provides an apparatus that is operative to perform the various disclosed methods. In one embodiment an apparatus includes an echo canceller having an audio signal input and an audio signal output and dynamic pre conditioning logic operatively coupled to the echo canceller audio signal output as a feedback signal and having a dynamic pre conditioning logic output operatively coupled to the echo canceller audio signal input. The dynamic pre conditioning logic is also operative to receive an audio signal input from at least one microphone.

The dynamic pre conditioning logic is operative to analyze the feedback signal to obtain at least one characteristic and pre condition the audio signal input based on the at least one characteristic of the feedback signal and provide a pre conditioned audio signal at the echo canceller audio signal input. The apparatus may further include a noise suppressor having a noise suppressor input operatively coupled to the echo canceller audio signal output and having a noise suppressor output.

In some embodiments the dynamic pre conditioning logic may include configurable filter logic at least one amplifier and a filter and gain selector operatively coupled to the configurable filter logic and to the at least one amplifier. The filter and gain selector is also operatively coupled to the echo canceller audio signal output to receive the feedback signal and is operative to obtain at least one characteristic by obtaining at least one of a frequency characteristic or an amplitude characteristic of the feedback signal.

In some embodiments the filter and gain selector may be operative to analyze the feedback signal by performing frequency domain analysis on the feedback signal such as but not limited to an FFT. In some embodiments the configurable filter logic may be configurable to provide at least one of a high pass filter a band pass filter or a pre emphasis filter to emphasize the given frequency range.

In some embodiments the apparatus may include a fixed pre conditioner including fixed filter logic operatively coupled to at least one microphone and operatively coupled to the dynamic pre conditioning logic to provide the audio signal input from the at least one microphone. The fixed pre conditioner may have an enable and disable input to enable or disable the fixed filter logic.

Another disclosed method of operation includes receiving an echo canceller audio signal output as a feedback signal analyzing the feedback signal to obtain at least one characteristic selecting at least one filter from a plurality of selectable filters based on the at least one characteristic applying the at least one filter to filter an audio signal and obtain a filtered audio signal and providing the filtered audio signal as an echo canceller audio signal input.

In some embodiments the method may include performing a table lookup to obtain filter coefficients for the at least one filter where the table lookup is based on the at least one characteristic. The method may then include applying the at least one filter using the filter coefficients to filter the audio signal and obtain the filtered audio signal. The method may analyze the feedback signal to obtain at least one characteristic by performing frequency domain analysis on the feedback signal.

Turning now to the drawings is a schematic block diagram of an apparatus with dynamic pre conditioning logic in accordance with the embodiments. In accordance with the embodiments the apparatus may be any of various communication devices such as but not limited to a stationary telephone cordless telephone mobile phone smart phone tablet laptop etc. that may include audio processing for voice communications or to drive voice recognition systems to provide hands free voice control of the device. For example the apparatus may include voice command recognition logic which provides a control signal to a system control . The system control may be any suitable system control and may control features or functions of the apparatus or may control features or functions of one or more software or firmware applications that run on the apparatus etc.

The apparatus includes fixed pre conditioning logic which is operatively coupled to one or more microphones and to a speaker . The fixed preconditioning logic may include analog to digital converters ADC digital to analog converters DAC fixed predetermined audio filters and fixed predetermined amplifiers having predetermined gain levels based on assumptions made about the audio signals received by the one or more microphones . The fixed pre conditioning logic is operatively coupled along a send path of a full duplex communication channel to provide at least one audio output signal to the dynamic pre conditioning logic . The dynamic pre conditioning logic is operatively coupled to an echo canceller to provide a pre conditioned audio signal as an echo canceller audio signal input . The dynamic pre conditioning logic is also operatively coupled to the echo canceller to receive the echo canceller audio signal output as a feedback signal . The echo canceller is operatively coupled to a noise suppressor and provides the echo canceller audio signal output as a noise suppressor input. The noise suppressor in turn is operatively coupled to a transceiver to provide a noise suppressor audio signal output as a transceiver for the full duplex communication channel send path. It is to be understood that other intervening post processing logic components may exist between the noise suppressor and the transceiver such as gain more filtering etc. however such components are not shown for the purpose of clarity. The transceiver may be a wireline transceiver or may be a wireless transceiver in accordance with the various embodiments. The transceiver may also operate in a Voice Over Internet Protocol VoIP system in some embodiments and may provide IP packet voice over a wireline or wireless VoIP connection.

The noise suppressor may also be operatively coupled to the voice command recognition logic . As mentioned above the voice command recognition logic is operatively coupled to the system control and provides a control signal to control various functions or features of the apparatus or to control functions and features of applications running on the apparatus as appropriate. The full duplex communication channel also includes a receive path which begins with received voice which is provided to the echo canceller from the transceiver as received audio signal . It is to be understood that some signal processing logic components may also be present between the transceiver and the echo canceller however such components are now shown for the purpose of clarity. The echo canceller monitors the received voice and makes adjustments prior to sending an echo canceller audio output signal to the fixed pre conditioning logic . The fixed preconditioning logic further provides an audio signal through a DAC to the speaker .

The apparatus send path of the full duplex communication channel includes the audio signal from the fixed pre conditioning logic which is processed by the dynamic pre conditioning logic to provide the pre conditioned audio signal to the echo canceller . The send path continues with the echo canceller audio signal output which is provided to the noise suppressor and the noise suppressor output audio signal which is provided to the transceiver for transmission on the full duplex communication channel. The apparatus receive path of the full duplex communication channel includes the received voice which is provided to the echo canceller from transceiver as received audio signal and includes the echo canceller audio output signal which is provided to the fixed preconditioning logic for provision of audio to the speaker .

Therefore in the example of the apparatus is operative to implement a full duplex communication channel for two way voice communication. One or more microphones receive audio such as the user s voice for transmission on the send path of the full duplex communication channel and the speaker provides sound received on the receive path of the full duplex communication channel for two way telephonic voice communications. Because sound emanating from the speaker may be received by the one or more microphones and create interference and echoes between the send and receive paths an echo canceller is employed. The echo canceller operates to monitor audio on the send path determine if any part of the send path audio shows up on the receive path and reduce or block undesirable audio from the send path accordingly. Noise suppression is also applied to the echo canceller audio signal output by the noise suppressor to further reduce effects caused by stationary or non stationary noise sources that may contaminate the voice signal. The noise suppressor provides noise suppressor audio output to the transceiver for transmission of full duplex communication channel.

Any of the predetermined filtering or predetermined gain imposed by corresponding filters and amplifiers within the fixed pre conditioning logic is based on assumptions made about characteristics of the voice signal received by the one or more microphones . In other words the fixed pre conditioning logic treats all audio signals in the same way. Because of these assumptions inappropriate filtering or gain may be applied for certain types of audio signals having certain types of noise characteristics that deviate from the assumed characteristics. Further because of possible inappropriate filtering or application of inappropriate gain the echo canceller and the noise suppressor may not operate under optimum conditions due to an erroneous input signal received from the fixed pre conditioning logic .

Therefore in accordance with the embodiments the dynamic pre conditioning logic monitors the audio signal received from the one or more microphones and based on signal analysis makes decisions regarding appropriate pre conditioning filtering or pre conditioning amplification gain for the specific audio signal accordingly. This dynamic pre conditioning results in better noise suppression by the noise suppressor . That is the echo canceller audio signal output which is provided as an input to noise suppressor will be more realistic because it is pre conditioned based on at least one characteristic of the audio signal detected by the dynamic pre conditioning logic . The dynamic pre conditioning logic monitors the echo canceller audio signal output as feedback signal and analyzes it to obtain at least one characteristic of the feedback signal . Based on this analysis and on the at least one characteristic the dynamic pre conditioning logic makes decisions regarding application of filtering or gain.

In some embodiments the fixed preconditioning can be disabled such that any pre conditioning on the send path is only performed by the dynamic pre conditioning logic . The dynamic pre conditioning logic is dynamic because it monitors the audio signal and adjusts the audio signal as environmental or other noise causing conditions such as but not limited to apparatus orientation etc. create changes in the audio signal . Put another way the dynamic pre conditioning logic applies appropriate filtering and or gain to accommodate such changing audio environment conditions.

In the example apparatus shown in a fixed pre conditioning unit includes fixed pre conditioning logic along with microphone configuration logic . The fixed preconditioning unit may be a commercially available hardware codec and or may be implemented as a programmable processor an ASIC a DSP an FPGA or in some other suitable manner etc. The microphone configuration logic is operatively coupled to the group of microphones to receive audio signal inputs and is operatively coupled to send path fixed pre conditioning logic . The microphone configuration logic includes a microphone on off control input that may receive a control signal to turn one or more of the microphones on or off under certain conditions. For example an application processor may be operatively coupled to the fixed pre conditioning unit and may be operative to run various applications from system memory . Any of the various applications may be operative to send the control signal to the microphone configuration logic and configure the group of microphones as needed by the application such as for example for speakerphone operation handheld operation etc. or for some other purpose. Likewise the application processor may send the control signal to the enable disable input of the fixed preconditioning logic to enable or disable it under certain conditions. Alternatively in the various embodiments the fixed pre conditioning logic may be disabled such that the dynamic pre conditioning logic may replace it completely. The dynamic pre conditioning logic may include filter and gain selector which may also be operative to send control signal and or control signal to the fixed pre conditioning unit .

In accordance with the embodiments fixed pre conditioning logic for the send path is operatively coupled to the dynamic pre conditioning logic and provides an audio signal . The dynamic pre conditioning logic is operatively coupled to the echo canceller to provide a pre conditioned audio signal as echo canceller audio signal input and to receive an echo canceller audio signal output as a feedback signal . The echo canceller is operatively coupled to a buffer to provide an echo canceller audio signal output to the buffer . The echo canceller is also operatively coupled to the transceiver to obtain a received audio signal and is operatively coupled to fixed pre conditioning logic for the receive path to provide an echo canceller audio signal output signal . The fixed pre conditioning logic for the receive path is operatively coupled to the speaker to provide the output audio signal. The transceiver may be a wireline transceiver or may be a wireless transceiver or a VoIP component in accordance with the various embodiments as mentioned previously above.

The apparatus also includes a noise suppressor which is operatively coupled to the buffer to receive the buffer audio output signal and to provide a noise suppressor audio signal output to the transceiver for transmission on the full duplex communication channel. The noise suppressor audio signal output may also be provided to voice command recognition logic . The voice command recognition logic is operatively coupled to the system control to provide the control signal .

In accordance with some embodiments the dynamic pre conditioning logic echo canceller buffer and noise suppressor may be implemented in an integrated manner for example in a single signal processing unit . The signal processing unit may be implemented on a programmable processor ASIC DSP FPGA or in some other appropriate manner. The signal processing unit may also be considered to be a type of apparatus in accordance with some embodiments in that the signal processing unit may be included in various other apparatuses such as apparatus to provide the advantages features and functions described herein.

The apparatus may also include a system memory which is a non volatile non transitory memory. The system memory may store a lookup table a table of noise suppression algorithms one or more applications and a table of echo canceller algorithms . The application processor is operatively coupled to the system memory by read write interface and may access and execute any of the various one or more applications . The system memory is also operatively coupled to the noise suppressor and the echo canceller . In some embodiments the echo canceller may access the system memory over read write interface to access the echo canceller algorithms . Similarly the noise suppressor may access the system memory over read write interface to access and execute noise suppression algorithms . In some embodiments the signal processing unit may have its own integrated memory in addition to system memory and may store the lookup table noise suppression algorithms or the echo canceller algorithms independently and independent from the system memory .

In some embodiments the dynamic pre conditioning logic includes configurable filter logic amplifier or gain and a filter and gain selector . The filter and gain selector is operatively coupled to the configurable filter logic and to the adjustable gain and provides respective control signal and control signal . The filter and gain selector is also operatively coupled to the echo canceller and receives the feedback signal . The filter and gain selector is also operatively coupled to system memory and is operative to access a lookup table which contains sets of filter coefficients that may be used to configure one or more filters of the configurable filter logic . The audio signal which is received by the dynamic pre conditioning logic is initially passed through to the echo canceller as audio signal which is processed by the echo canceller . The feedback signal is then provided to the filter and gain selector which performs analysis of the feedback signal .

The filter and gain selector is operatively coupled to a buffer and sends a control signal to control the buffer to begin buffering the echo canceller audio signal output . The purpose of the buffer is to delay the audio signal i.e. buffer audio output signal provided to the noise suppressor in order to provide time for the dynamic pre conditioning logic to make adjustments. The buffer buffers the echo canceller audio signal output in response to the control signal from the filter and gain selector . That is the filter and gain selector controls the buffer to buffer the echo canceller audio signal output to provide a time delay such that the filter and gain selector may dynamically adjust the echo canceller audio signal output using configurable filter logic and adjustable gain prior to applying the noise suppressor . Therefore under some audio environment conditions if the filter gain and selector logic determines that no filtering or gain adjustment to the audio signal is required the buffer may proceed to send the buffer audio output signal to the noise suppressor .

However if audio filtering is required the filter and gain selector may send control signal to the buffer to clear the buffer and to pass through without buffering the echo canceller audio signal output after application of pre conditioning filters or gain to the noise suppressor . Put another way the buffer is operative to either buffer the echo canceller audio signal output or may pass through the signal with no buffering i.e. with no added buffering delay after pre conditioning has been applied.

The pre conditioning applied is based on analysis of the feedback signal . That is the filter and gain selector analyzes the feedback signal and determines at least one characteristic of the feedback signal . Based on the characteristic the filter and gain selector accesses the lookup table over read write interface and selects a set of filter coefficients for one or more filters corresponding to the characteristics observed in the feedback signal . The observed characteristics may include voice or noise information obtained from the echo canceller output as the feedback signal such as but not limited to energy spectral content phonetic content frequency range noise type noise level amplitude etc. that may be used in the decision making process. The filter and gain selector also determines what if any filters of the configurable filter logic will be applied to the audio signal based on the observed characteristic.

Turning to details of one example of the configurable filter logic are provided. The configurable filter logic receives the audio signal from the fixed pre conditioning logic for the send path. Based on the control signal received from the filter and gain selector one or more of the various filters filter 1 through filter N will be turned on by controlling appropriate filter bypass switch logic filter 1 bypass through filter N bypass . The filter bypass switch logic may be implemented in any appropriate manners including but not limited to using tri state logic or some other appropriate logic or software or firmware etc. By selecting appropriate filter bypass switch logic a sequential series of filters may be configured. Each filter of filter 1 through filter N is a predetermined filter that has predetermined characteristics such as but not limited to a high pass filter characteristic a bandpass filter characteristic frequency pre emphasis or some other predetermined filter characteristic that may be selected and applied to the audio signal as deemed necessary. Some filters may be adjusted by control signal by changing filter coefficients where the filter coefficients are selected from the lookup table stored in system memory .

Therefore the configurable filter logic may consist of a plurality of filters such as filter 1 through filter N which are selectable to configure a series of filters. Further the individual filters are configurable by adjusting the filter s coefficients. The configurable filter logic is operatively coupled to the adjustable gain i.e. amplification . The adjustable gain also has gain bypass switch logic that is controllable by control signal to bypass the gain . The pre conditioned audio signal is thus provided as an echo canceller audio signal input as shown. The control signal also controls the gain level of adjustable gain . The control signal from the filter and gain selector therefore can switch any of the filters on or off by controlling the appropriate filter bypass switch logic. In one example filter 1 and filter 3 may be configured to operate in series while filter 2 and filter 4 through filter N are turned off i.e. bypassed in accordance with the control signal . If the adjustable gain is switched on i.e. not bypassed then the control signal may control the gain to provide the appropriate level of gain.

In one example an FFT may be performed and the results may have one or more characteristics that match known characteristics in the lookup table that indicate the presence of stationary noise. In this situation the configurable filter logic may be configured to provide high pass and frequency specific filters. If the FFT results have one or more characteristics that match known characteristics in the lookup table that indicate the presence of non stationary noise then frequency specific filters may be applied. For example filters that emphasize the frequency spectrum in the 1 KHz to 2 KHz range may be applied. In some embodiments the filter and gain selector may also determine the type of echo cancellation that is being applied and make adjustments based on the specific type of echo cancellation.

Returning to the filter and gain selector is therefore operative to send a control signal to the configurable filter logic to configure a series of filters as appropriate for the audio signal based on analysis of the feedback signal . The filter and gain selector is also operative to send the control signal to the adjustable gain to provide an appropriate level of gain adjustment. The dynamic pre conditioning logic then provides the preconditioned audio signal as an echo canceller audio signal input to the echo canceller . At that point the buffer may provide the buffer audio output signal to the noise suppressor .

The noise suppressor may access the system memory over read write interface and select an appropriate noise suppression algorithm from the noise suppression algorithms . The noise suppressor audio signal output is provided to the transceiver for transmission on the full duplex communication channel.

In some embodiments the filter and gain selector is operative to send the control signal to enable or disable the send path fixed pre conditioning logic and may also be operative to send control signal to the microphone configuration logic to turn microphones on or off. In other embodiments the send path fixed pre conditioning logic may continue to operate in conjunction with the dynamic pre conditioning logic . In this scenario the dynamic pre conditioning logic may operate together with the fixed pre conditioning logic or may be operative to disable all or portions of the fixed pre conditioning logic as needed.

On a receive path of the apparatus the transceiver provides received voice as received audio signal to the echo canceller which in turn provides the echo canceller audio output signal to the receive path fixed pre conditioning logic for further provision to the speaker .

The signal analysis logic therefore in some embodiments may include an FFT or another frequency domain analysis or some other analysis logic and level analysis logic which determines whether filtering and or gain needs to be applied. Based on level analysis the signal analysis logic may provide the control signal to the adjustable gain to adjust the gain amplification level accordingly. The signal analysis logic also provides the control signal to the buffer to control the buffer to begin buffering the echo canceller audio signal output so that if no pre conditioning is required the buffer audio output signal may be provided to the noise suppressor .

The operation of the dynamic pre conditioning logic may be driven by a clock which may receive input from a system clock not shown of the apparatus in some embodiments. All components of the dynamic pre conditioning logic are operatively coupled to the clock however these inputs are not shown for clarity. The dynamic pre conditioning logic includes buffer which buffers audio frames according to a clock signal from clock . The audio frames are received as the audio signal which is provided by one or more ADCs of the fixed pre conditioning unit . For each audio frame switch logic is closed in accordance with the clock signal from clock for a length of time long enough to pass the audio frame to the echo canceller so that the echo canceller may initially process the audio frame. Buffer shown in will buffer the echo canceller audio signal output for a period of time long enough for the dynamic pre conditioning logic to either determine that no pre conditioning is needed or to determine that pre conditioning is needed and apply filtering and or gain accordingly. The buffer delays the audio frame for a period of time long enough for the echo canceller to process the audio frame and provide the feedback signal to the signal analysis logic . The buffer also provides time for the signal analysis logic to perform frequency domain such as FFT and level analysis and for the table look up generator to obtain filter coefficients from lookup table and configure the configurable filter logic . The buffer then passes the audio frame to the filter logic and subsequent adjustable gain which is applied if needed. The pre conditioned audio signal is then provided as echo canceller audio signal input to the echo canceller . The signal analysis logic may also send control signal to buffer to clear the buffer and to control the buffer to pass through the adjusted audio frame from the echo canceller to the noise suppressor . In other words an optimized audio signal is provided to the noise suppressor .

Because the allowable processing time on the send path determines the number of filter stages that may be applied to the audio signal in some embodiments the filter and gain selector determines the allowable number of filters from the configurable filter logic that can be applied while still maintaining an allotted processing time. That is if the processing time is not sufficient for all filtering that would be useful to apply to the audio frame the filter and gain selector will prioritize the applied filters and apply only those that have the most impact on audio signal improvement. For example noise filtering may be prioritized over emphasis filters or vice versa. Also the filter and gain selector may apply additional filters to fill up any available processing time if such additional filters would further improve the audio signal.

The flowchart of illustrates one method of operation in accordance with the embodiments. In operation block an apparatus performs signal analysis on an echo canceller output. In operation block the apparatus applies filters and or gain based on the signal analysis. In operation block the apparatus sends the pre conditioned audio signal to a noise suppressor. The method of operation then ends.

The flowchart of illustrates another method of operation. The method of operation begins in operation block and the dynamic pre conditioning logic performs signal analysis on the echo canceller output. In operation block the dynamic pre conditioning logic applies frequency specific filters for noise as determined by the filter and gain selector . In operation block the dynamic pre conditioning logic applies frequency specific filters to filter a talker s voice and in operation block the dynamic pre conditioning logic sends a preconditioned audio signal to the noise suppressor . The method of operation then ends.

The flowchart of provides details of a method of operation of the filter and gain selector and the configurable filter logic . The method of operation begins and in operation block the filter and gain selector examines the echo canceller output for its frequency content. For example the signal analysis logic of the filter and gain selector may perform an FFT or some other frequency domain analysis on the echo canceller output i.e. feedback signal to determine the frequency content. In decision block the signal analysis logic determines if excessive constant apparent noise is below a predetermined cutoff frequency. If yes then the signal analysis logic sends the control signal to the table lookup generator . The table lookup generator sends the control signal to the configurable filter logic to apply a predetermined high pass filter as shown in operation block . If no in decision block then the method of operation proceeds to decision block . The signal analysis logic may determine if a near talker i.e. a talker near to one or more of the microphones is male or female in some embodiments by determining whether the talker s voice is within a given known frequency range. If not then the method of operation proceeds to decision block . If the near talker s voice is determined to be within a given known frequency range in decision block then the appropriate control signal is sent to the configurable filter logic to apply appropriate pre emphasis filters as shown in operation block .

In decision block the signal analysis logic determines based on the feedback signal if frequency response modification is needed. If not then the method of operation proceeds to decision block . If yes then the appropriate control signal is sent to the configurable filter logic to apply a frequency modification filter or filters as needed as shown in operation block . In decision block the signal analysis logic may also determine the processing time available to perform additional filtering or to perform the filtering described in the flowchart above. In other words the echo canceller audio signal output that is buffered by the buffer may only delay the audio frame by a certain period of time. That is the full duplex communication channel must process and send out audio frames on a schedule for apparatus such that the user experience of a real time conversation is maintained. Therefore based on the processing time available as determined in decision block the signal analysis logic may determine that additional filtering may be applied as needed as shown in operation block . Otherwise operation block is bypassed and the buffer audio output signal is provided as a pass through to the noise suppressor as shown in operation block and the method of operation ends.

Therefore among other advantages of the various embodiments the noise suppression applied by noise suppressor is improved because the audio signal input to the noise suppressor is enhanced by the dynamic pre conditioning logic prior to applying noise suppression algorithms. The fixed pre conditioning which would otherwise be applied by the send path fixed pre conditioning logic may be disabled

However as mentioned above the fixed pre conditioning logic may still be used in some embodiments depending on the granularity of its controllability. For example if predetermined filters of the fixed preconditioning logic may be individually enabled and disabled or if amplifier gains may be individually adjusted then the filter and gain selector may directly control enabling and disabling of such fixed pre conditioning filters and or gain via the control signal . However in other embodiments the fixed preconditioning logic is globally disabled such that no features operate while the dynamic preconditioning logic is operational other than necessary ADCs DACs etc. that may be included in the fixed pre conditioning unit .

It is to be understood that the various schematic block diagrams provided in through are limited to showing only those components useful to describe the features and advantages of the various embodiments and to describe how to make and use the various embodiments to those of ordinary skill. It is therefore to be understood that various other components circuitry and devices etc. may be present in order to implement a an apparatus and that those various other components circuitry devices etc. are understood to be present by those of ordinary skill. For example one of ordinary skill will understand that a power source such as a battery will be present in the various apparatuses. In another example one of ordinary skill will understand that the transceiver may provide various processing such as but not limited to interleaving channelization control etc.

The various components circuitry devices etc. described with respect to the figures including but not limited to those described using the term logic such as but not limited to the dynamic pre conditioning logic echo canceller noise suppressor buffers switch logic etc. and or the fixed pre conditioning unit or signal processing unit etc. may be implemented in various ways such as by software and or firmware executing on one or more programmable processors such as a central processing unit CPU or the like or by ASICs DSPs FPGAs hardwired circuitry logic circuitry or the like or by any combinations thereof. In one example the signal processing unit may be implemented as an ASIC a DSP and FPGA or a programmable processor executing executable instructions that implement the methods of operation herein described. In another example the dynamic pre conditioning logic may be implemented using an FPGA that interfaces with another FPGA that includes the echo canceller noise suppressor etc. Other examples that may occur to those of ordinary skill are contemplated by the examples and disclosure provided herein.

The terminology operatively coupled as used herein refers to coupling that enables operational and or functional communication and relationships between the various components circuitry devices etc. described as being operatively coupled and may include any intervening items i.e. buses connectors other components circuitry devices etc. that may be present to enable such communication such as for example data communication buses or any other intervening items that one of ordinary skill would understand to be present. Also it is to be understood that other intervening items may be present between operatively coupled items even though such other intervening items are not necessary to the functional communication facilitated by the operative coupling. For example a data communication bus may be present in various embodiments and may provide data to several items along a pathway along which two or more items are operatively coupled etc. Such operative coupling is shown generally in through described herein.

It is to be understood that the various control signals described herein with respect to various components such as but not limited to the dynamic pre conditioning logic filter and gain selector various switch logic fixed pre conditioning unit etc. may be implemented in various ways such as using application programming interfaces APIs between the various components. Additionally operations involving the lookup table may be implemented using pointers where the components access the lookup table as directed by the filter and gain selector in some embodiments. In other words control signal and control signal may be implemented such that the configurable filter logic and adjustable gain obtain control information such as but not limited to filter coefficients gain values etc. from the lookup table stored in system memory and that such implementations are contemplated embodiments and are in accordance with the various embodiments and examples described herein.

While various embodiments have been illustrated and described it is to be understood that the invention is not so limited. Numerous modifications changes variations substitutions and equivalents will occur to those skilled in the art without departing from the scope of the present invention as defined by the appended claims.

