---

title: Systems and methods for full-duplex signal shaping
abstract: The current subject matter relates to a system and a method for processing signals. The system can include a transmitting antenna for transmitting a signal over a plurality of wireless spectrum fragments, a receiving antenna for receiving a signal from the plurality of wireless spectrum fragments, and a signal processing layer in communication with the transmitting and receiving antennas for simultaneously causing reception of the received signal and transmission of the transmitted signal. The signal processing layer can include an interference cancellation component for removing a first portion of interference from the received signal and a filtering component for removing a second portion of the interference from the received signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09325432&OS=09325432&RS=09325432
owner: The Board of Trustees of the Leland Stanford Junior University
number: 09325432
owner_city: Palo Alto
owner_country: US
publication_date: 20130207
---
The present application claims priority to U.S. Provisional Patent Application No. 61 596 628 to Hong et al. filed Feb. 8 2012 and is entitled Enabling Algorithms and RF Circuitry for Full duplex Communication Over Arbitrary Spectrum Fragments and incorporates its disclosure herein by reference in its entirety.

In some implementations the subject matter described herein relates to wireless communications processing and in particular to full duplex signal shaping in communication systems.

Communication systems are essential to everyday life as they provide necessary connections between parties devices networks and systems allowing vital exchange of information. Communication systems come in different varieties and can include optical communication systems radio communication systems power communication systems duplex communication systems and others. A duplex communication system is a point to point system that connects two parties or devices communicating with one another in both directions. An example of a duplex device is a telephone which includes a speaker and a microphone and can be used to conduct a telephone call. The parties at both ends of the call can speak at the same time where the speakers of the parties telephones reproduce the sounds transmitted by the microphones of the other party telephone. Thus duplex communication systems provide a two way street between connected parties as opposed to a one way street in simplex communication systems where one device transmits and the other one listens e.g. broadcast radio and television garage door openers baby monitors wireless microphones radio controlled models surveillance cameras etc. .

A full duplex FDX or sometimes double duplex system allows communication in both directions and unlike half duplex allows this to happen simultaneously. Land line telephone networks are full duplex since they allow both callers to speak and be heard at the same time.

However conventional full duplex communication systems suffer from a variety of drawbacks including an inability to simultaneously receive and transmit signals without reduction or elimination of interference and or receiver saturation. These drawbacks can significantly reduce communication system s throughput acid ability to provide fast and reliable service to consumers.

In some implementations the current subject matter relates to a system for processing signals. The system can include a transmitting antenna for transmitting a signal over a plurality of wireless spectrum fragments a receiving antenna for receiving a signal from the plurality of wireless spectrum fragments and a signal processing layer in communication with the transmitting and receiving antennas for simultaneously causing reception of the received signal and transmission of the transmitted signal. The signal processing layer can include an interference cancellation component for removing a first portion of interference from the received signal and a filtering component for removing a second portion of the interference from the received signal. The interference can be caused by the transmitted signal and affecting the received signal.

In some implementations the current subject matter can include one or more of the following optional features. The portion of interference to be removed by the interference cancellation component can equal to a predetermined amount of power to be removed from the received signal. The predetermined amount of power can be determined based on at least one of the following dynamic range of at least one of the received and transmitted signals and a range of expected signal strength the dynamic range of the received signal is determined based on a ratio of powers of a strongest received signal and a weakest received signal the dynamic range of the transmitted signal is determined based on a ratio of powers of a strongest transmitted signal and a weakest transmitted signal and the range of expected signal strength is determined based on a distance separating the transmitting antenna and a receiving antenna. The interference cancellation component can include a balanced unbalanced transformer component for subtracting the predetermined amount of power from the received signal. In some implementations the interference cancellation component can include at least one passive electronic component.

In some implementations the filtering component can chide a receiver circuitry for performing at least one of the following operations sampling of the received signal down converting the sampled received signal into a narrowband stream and filtering the down converted signal to remove the second portion of the interference. The filtering component can include a transmitter circuitry fir performing at least one of the following operations up converting of the transmitted signal and filtering the up converted signal to prevent aliasing of the transmitted signal with at least another signal. The filtering component can include a plurality of filters arranged in a sequence for performing sampling and filtering of the received signal processed by the interference cancellation component to remove the second portion of the interference. The plurality of filters can include at least one programmable filter which includes at least one of the following a finite impulse response filter infinite impulse response filter and a resampling filter. In some implementations the filtering component can perform mapping of at least one signal received from at least one communication protocol layer to at least one frequency fragment in a wireless frequency band for transmission by the transmitting antenna.

In some implementations the current subject matter relates to a method for processing of signals using the above referenced system. The method can include removing using an interface cancellation component of the signal processing layer a first portion of interference from the received signal and removing using a filtering component of the signal processing layer a second portion of the interference from the received signal.

The details of one or more variations of the subject matter described herein are set forth in the accompanying drawings and the description below. Other features and advantages of the subject matter described herein will be apparent from the description and drawings and from the claims.

To address the above noted deficiencies of conventional communication systems in some implementations the current subject matter relates to a system for processing signals and in particular to a full duplex signal shaping system. The system can include a transmitting antenna for transmitting a signal over a plurality of wireless spectrum fragments a receiving antenna for receiving a signal from the plurality of wireless spectrum fragments and a signal processing layer in communication with the transmitting and receiving antennas for simultaneously causing reception of the received signal and transmission of the transmitted signal. The signal processing layer can include an interference cancellation component tier eliminating a portion of interference from the received signal. The interference can be caused by the transmitted signal and affect the received signal. The signal processing layer can also include a filtering component for programmatically removing remaining interference from the received signal. Thus the current subject matter system is capable of simultaneous transmission and reception of signals substantially without interference affecting the transmitting and or receiving antennas.

In conventional communications systems simultaneous transmission and reception even over different bands cannot typically be achieved without some form of ancillary processing because the transmitted signal can be orders of magnitude stronger than the received signal. Specifically if a radio has two antennas one for transmit and one for receive the transmit antenna signal can interfere and cause receiver saturation. For example when the analog to digital converter ADC samples the analog signal on the receive antenna the ADC can convert each sample into a number corresponding to a voltage level. The value of each sampled point can be represented by a fixed length variable which can have a size determined by the resolution or dynamic range of the ADC. If for example the ADC has a resolution of n bits e.g. n 12 thee the ADC can only hold values from 0 to 2. As such the self interference can typically be billions of times stronger than the received signal. Indeed in the example case of WiFi the self interference can be nearly 60 70 dB stronger than the received signal. The dynamic range of an ADC is typically not large enough to acquire the received signal in the face of such large self interference so the receiver can become saturated and the received signal is effectively lost in quantization. In addition this saturation can occur even when the transmitted signal are on a different spectrum fragment than received signal.

In some implementations the subject matter system can enable a full duplex communication over arbitrary spectrum fragments so that simultaneous transmission and reception over different frequency channels can occur over the different frequency channels which can arbitrary e.g. not specified in advance and which can vary in time . In some implementations the subject matter system can utilize a combination of mechanisms e.g. analog circuitry and digital processes to achieve full duplex communication over a plurality of spectrum fragments e.g. arbitrary portions of the spectrum fragments . To prevent receiver saturation the current subject matter system can cancel the self interference e.g. between the transmission and the received rather than filter the self interference. In other words the self interference signal can be subtracted from the received signal so that the self interference is eliminated and as such receiver saturation may not occur.

In some implementations the analog circuitry component the current subject matter system can provide sufficient cancellation to ensure that the receiver saturation does not take place. Moreover the analog circuitry component of the current subject matter system can be configured so that it cannot leak any interference to adjacent spectrum fragments. For example the analog circuitry can provide analog cancellation based on the use of passive components and or the use of a balanced unbalanced transformer balun as a subtractor as discussed below.

Active cancellation components can often cause interference leakage because these components can face power saturation and clip the signal. Hence to avoid interference leakage the current subject matter system can use passive components to avoid introducing distortion. While programmable passive attenuators are available off the shelf passive delay lines are typically not. Nevertheless because the active cancellation only needs in some implementations 20 25 dB of cancellation the analog circuitry for analog cancellation can include a passive programmable attenuator and a simple wire whose length is statically matched roughly to the over the air delay for the transmitted signal.

Furthermore instead of using the balun as a signal inversion technique which typically introduces about a 3 dB power loss the analog cancellation can implement a subtractor circuit some implementations. For example a balun in a typical operational configuration takes an input signal on the unbalanced tap and produces two output signals that are inverses of each other on the balanced taps. The same operation can be modeled in reverse as taking two inputs on the balanced side and producing the subtraction of the input signals as the signal on the unbalanced side. Hence if the two inputs of the balun are exact replicas of each other the output of the balun will be a zero signal.

Self interference cancellation can thus prevent the receiver ADC from saturating but by itself self interference cancellation may not be sufficient to fully cancel out the interference between bands. But now with the ADC dynamic range no longer saturated the subject matter described herein can provide systems which utilize programmable digital filters also referred to as a filter engine to digitally remove any remaining self interference from the received signal. The filter engine can be configured to ensure that the transmitted or received signals are shaped according to for example a higher layer specification defining which spectrum fragments to use for transmission reception. At the receiver side this can include converting the sampled wideband signal into narrowband streams by down converting and filtering to remove adjacent band interference. The reverse functionality is needed at the transmitter side narrowband baseband streams have to be up converted and filtered to prevent aliasing.

In some implementations a system can be provided which includes a self interference cancellation circuitry block and a filtering engine. This combination can in some implementations enable full duplex signal shaping.

In some implementations there can be provided a system for full duplex signal shaping by allowing radios to transmit and receive simultaneously on different arbitrary channels that are not specified in advance. This can be used in a wide range of radios e.g. mobile cellular devices IEEE 802.22 white space devices. IEEE 802.15.4 sensor network nodes and enable them to either replace several discrete components such as duplexers and operate on different channels of varying widths at different times.

In some implementations there can be provided a centralized access points e.g. cellular base station or WiFi access point configured to provide full duplex signal shaping which would allow an access point to utilize varying amounts of spectrum to support different users. Also because the ability to simultaneously transmit and receive across different fragments decouples the use of each fragment different users can run different applications with varying latency requirements and not substantially affect one another.

In some implementations full duplex signal shaping can enhance outing protocols e.g. wireless mesh networks . Full duplex operation can reduce latency and the overhead associated with synchronizing all of the nodes to ensure that nodes do not attempt to transmit when they should be receiving a packet. Routing benefits created by full duplex signal shaping can also be used to aggregate backhaul capacity e.g. if one backhaul link is overloaded the node could act as a router and offload the data it cannot support onto a node which has excess backhaul capacity .

Fall duplex signal shaping can in some exemplary embodiments be used in the context f peer to peer networks e.g. WiFi Direct . Without full duplex operation one node cannot transmit to another node if it is already receiving from another node. Full duplex signal shaping enables different peer to peer connections to operate independently and reduces the overhead associated with sending out beacons to announce availability to receive.

In some implementations an advantage is that full duplex signal shaping enables radios to cleanly separate the concern of utilizing fragmented spectrum from the design of higher physical media access control PHY MAC layers. Existing methods for signal shaping e.g. discontiguous orthogonal frequency division multiplexing OMNI do not allow for full duplex and as such couple the usage of all spectrum fragments. By contrast in some implementations of the system and methods described herein every single spectrum fragment can be used for either transmit or receive.

Moreover current methods and devices that enable full duplex filter the self interference rather than cancelling the self interference. These filters are typically designed with fixed analog components and operate over a pre specified range of frequencies e.g. notching out the transmitted signal in a particular range of pre determined frequencies while allowing the received signal to pass through a different range of pre determined frequencies . One of the advantages of the current subject matter system is that while different filter components are required to filter different frequency ranges a single cancellation system can cancel the transmitted signal no matter what frequency ranges it is operating on. Thus a single cancellation system could replace several discrete filtering components and allow for operation that is more flexible.

In some implementations the current subject matter system can provide self interference cancellation as opposed to analog filtering to enable simultaneous transmission and reception on different bands. For example an analog self interference cancellation might involve a single antenna utilizing a circulator or isolator to separate out the transmit and receive signals. It can also involve more than two antennas e.g. 3 antennas such as 2 transmit 1 receive and the 2 transmit antennas can be placed half of a wavelength apart from one another . A different digital cancellation system can implement filters such as for example Butterworth Chebyshev etc.

Many everyday devices e.g. mobile phones wireless local area networks LANs Bluetooth enabled devices ZigBee small low power digital radios global positioning systems GPS two way radios such as Land Mobile FRS and GMRS radios operate in a ultra high frequency communication spectrum of 300 3000 MHz. Given the types of devices that operate in this band this spectrum can become increasingly fragmented. The most common operational frequency for these devices is approximately 2.4 GHz where these devices operate in an Industrial Scientific and Medical ISM radio band as established by first established at the International Telecommunications Conference of the International Telecommunications Union in 1947 the unlicensed ISM band it is not uncommon for users any multiple wireless devices e.g. WiFi devices Bluetooth enabled devices ZigBee radios where each device can operate in its own contiguous narrow band of varying widths. This can lead to fragmentation of the 2.4 GHz ISM band into various chunks e.g. 100 MHz chunks . Spectrum fragmentation can vary over time and space as the set of available ISM bands can depend on which devices are operating at a particular location at any given time. illustrates a plurality of devices that can share a wireless spectrum and can operate on different fragments. The devices can include Bluetooth enabled device a ZigBee radio and a WiFi device . Other devices can share the wireless spectrum as well.

Most conventional devices operate on contiguous spectrum bands and thus are unable to take advantage of the fragmented spectrum. Some conventional devices include modified physical layers PHY and media access control MAC layers also referred to as higher layers so that they can operate on the fragmented spectrum. Such modifications include a wideband orthogonal frequency division multiplexing OFDM PHY layer that uses only subcarriers that are arc in the empty spectrum fragments and a modified MAC layer to ensure that all available spectrum fragments are utilized fully. However because conventional radios cannot transmit and receive simultaneously over arbitrary different bands these devices cannot exploit fragmented spectrum without a significant complexity and still provide suboptimal performance. For example if a radio device decides to use even one fragment to transmit on then its only choice if it wants to use any of the other fragments is to transmit there too and vice versa for receive. Consequently in order to maximize spectrum utilization among a set of nodes competing for fragmented spectrum the MAC protocol has to dynamically estimate which node is sending to whom and then coordinate nodes such that any transmitting node does not have any transmission intended for it at the same time all while ensuring that all fragments are assigned for use. Inevitably complexity of such distributed coordination grows leading to inefficient spectrum utilization.

Functionalities of a communications system are governed by the Open Systems Interconnection OSI model ISO IEC 7498 1 whereby functions of the communications system are grouped in terms of abstraction layers. There are seven layers in the OSI model which include

In some implementations the current subject matter provides a full duplex signal shaping capability to the higher layers e.g. PHY MAC etc. to use fragmented spectrum. A full duplex signal shaping can include transmitting on an arbitrary set of spectrum fragments of the wireless spectrum and receiving on a different arbitrary set of spectrum fragments of the wireless spectrum. If necessary the transmitting and receiving can be performed simultaneously. Thus the current subject matter system can decouple use of different spectrum fragments instead of having one complex wideband PHY and MAC protocol that operates over the entire fragmented spectrum the system can run several independent contiguous narrowband PHY and MAC instances on each spectrum fragment. Hence the current subject matter system s signal shaping can preserve design modularity and enable reuse of higher layers of a communication system.

In some implementations the current subject matter relates to a system and a method for providing high performance full duplex signal shaping signals in communication devices. An exemplary communication device can include a receiver circuitry that can receive signals transmitted by another communication device a transmitter circuitry that can transmit signals for reception by another communication device and various processing circuitry that can process received signals prepare signals for transmission and or perform various other functions. An exemplary communication device can include a mobile telephone a Bluetooth enabled device a ZigBee small low power digital radio a GPS device a two way radio such as Land Mobile Family Radio Service FRS and General Mobile Radio Service GMRS radios and or any other devices. The current subject matter system can perform at least one of the following functions a full duplex operation and a dynamic signal shaping. The following is a brief discussion of each of these functions.

In some implementations during the full duplex operation a signal shaping radio device can allow higher layers e.g. PHY MAC etc. of the communication device to simultaneously transmit and receive on arbitrary but different sets of spectrum fragments of the wireless spectrum. The current subject matter system can resolve receiver saturation during such simultaneous receive transmit operations. Receiver saturation refers to self interference that saturates the receive circuit s analog to digital converter circuitry and zeroes out the received signal during transmission by the transmitter circuitry even if the reception is on a different band.

In some implementations the current subject matter can include a programmable digital fitter to shaped signals in order to fit spectrum fragments that are available for the purposes of dynamic signal shaping functionality. This can account for the dynamic nature of the available spectrum fragments as well as their ability to change over time.

In some implementations to enable full duplex operation on separate bands the current subject matter can include a self interference cancellation mechanism that can reduce an amount of self interference and ensure that an analog to digital converter in the receive circuitry as shown in and discussed below is not saturated. The self interference cancellation mechanism does not leak interference into adjacent bands and does not hurt receive performance. It can include a reconfigurable filter engine that can provide efficient and programmable digital filtering as discussed below with regard to .

The system can include a self interference cancellation component and a filter engine component . The system can include a receiver antenna or component Rx and a transmitter antenna or component Tx . The components and can be part of the self interference cancellation component circuitry. The component can include a power splitter that can include a high power port and a low power port where the high power port of the power splitter can be coupled to the transmitter antenna and the low power port can be coupled to an attenuation and delay circuitry . The power splitter can be a passive device that can couple a defined amount of the electromagnetic power in a transmission line to a port enabling the signal to be used in another circuit. The splitter can couple power flowing in one direction whereby power entering the output port can be coupled to an isolated port but not to the coupled port. In an exemplary embodiment the power splitter can be an 8 dB power splitter that can be used to obtain a reference signal and reduce the transmit power by 8 dB. The circuitry can be coupled to a balun transformer circuitry . A balun can be an electrical device that can convert between a balanced signal two signals working against each other where ground is irrelevant and an unbalanced signal a single signal working against a ground or a pseudo ground . A balun can take many forms and can include devices that transform impedances but need not do so where transformer baluns can be used to connect lines of differing impedance. In this case the balun can be used as a subtractor circuit where the transmitted signal does not suffer a power loss e.g. 3 dB power loss . This is contrary to conventional systems where baluns are used as inverters resulting in a power loss e.g. 3 dB power loss . In the conventional systems transmit antenna transmits a positive signal and to cancel self interference the radio combines a negative signal with its received signal after adjusting the delay and attenuation of the negative signal to match the self interference.

The filter engine can programmable filtering elements that can include various filtering structures and intermediate frequency converters . The filter engine can also include a filter engine application programming interface API .

The self interference cancellation circuitry can be coupled to the filter engine circuitry via at least one receive line and at least one transmit line . The receive line can be coupled to the receive antenna via the balun transformer . It can process a received radio frequency RF signal through a power source that converts RF signal to a baseband signal. The baseband signal can be filtered through a low pass filter and passed onto an analog to digital converter ADC . The ADC can sample the received signal at a predetermined sampling frequency and pass it onto to the fitter engine . The engine can filter the signal and output it as digital baseband Rx signal to protocol layers. The transmit line can be coupled to the transmit antenna via the power splitter and can perform functions similar to those performed during signal processing on the receive line but in a reverse order as follows. The filter engine can pass a filtered digital baseband Tx signal from protocol layers to a digital to analog converter DAC . The DAC can resample the signal and pass it to a low pass filter which can apply it to a power source to generate a transmission RIP signal from the baseband signal for transmission by the transmit antenna .

In some implementations the current subject matter system can achieve full duplex operation over different but arbitrary spectrum fragments by cancelling self interference in analog instead of filtering it. The self interference signal can be subtracted from the received signal so that its effect is eliminated and receiver saturation does not occur. This can be accomplished by using the balun transformer . The current subject matter system can also determine how much cancellation is needed to ensure receiver saturation does not occur. The amount of cancellation needed can be determined based on at least the following two fact 1 dynamic range resolution ADC and 2 range of signal strengths that are expected.

Dynamic range DR is defined as the ratio between largest and smallest possible values of a variable of interest. At the transmitter the dynamic range of the DAC can determine the maximum ratio between the powers of the strongest and weakest transmissions. At the receiver the ADC s dynamic range can define the maximum ratio between the strongest and weakest received signal power. When the dynamic range is exceeded the converter s quantization noise can bury he weaker signals. The dynamic range of the ADC can be calculated through the following formula DR dB 6.02 n 1.76 dB 1 

where n is the number of bits in the DAC ADC resolution. Higher dynamic ranges can equate with better performance. In some implementations the current subject matter system can use a 12 bit DAC ADCs which can provide about 74 dB of dynamic range.

At the transmitter the maximum ratio between transmit powers over different fragments will rarely exceed 30 dB so DAC dynamic range is usually not a concern. On the other hand if the transmitter is operating while the system attempts to receive the dynamic range of the ADC at the receiver can be critical because the transmitted signal can be much stronger than the received signal. To determine the required ADC dynamic range the range of expected signal strengths can be calculated. Assuming that the transmit and receive antennas are reasonably separated the attenuation between the two due to path loss can be calculated as follows Path Loss dB 36.56 20 log 20 log 2 

Thus the amplitude of the self interference signal at the receiver is 0 dBm. assuming 23 dBm transmit power the maximum in WiFi . Thus ADC can require 90 dB 0 90 in dynamic range in order to simultaneously transmit and receive. In some implementations the amount of cancellation required can increase as ADC resolution drops.

In some implementations the current subject matter system s self interference cancellation mechanism can provide sufficient cancellation to ensure receive saturation does not take place does not leak any interference to adjacent spectrum fragments and does not cause signal power loss for the transmitted signal.

In some implementations to avoid interference leakage passive components that do not introduce distortion can be used in the current subject matter system such as the one shown in . The current subject matter system can provide for cancellation of a certain amount of signal power e.g. 20 25 dB of cancellation compared to the 35 dB required for single channel full duplex . Hence precise delay matching with the over the air transmitted signal may not be needed an almost good delay match might suffice. Further as stated above balun transformer can be used as a subtractor circuit as shown in . The balun transformer in typical operation can take an input signal on the unbalanced tap and produce two output signals which can be inverses of each other on the balanced taps. The same operation can be modeled in reverse as taking two inputs on the balanced side and producing the subtraction of the input signals as the signal on the unbalanced side. Hence if the two inputs are exact replicas of each other the output will be a zero signal.

In some implementations the self interference cancellation can prevent the receiver ADC from saturating but by itself it can be insufficient to fully cancel out the interference between bands. However with the ADC dynamic range no longer saturated the current subject matter system can utilize programmable digital filters of the filter engine shown in to digitally remove the remaining self interference from the received signal for programmatically shaping the signal at the transmit and receive antennas.

The filter engine can ensure that the transmitted and or received signals are shaped according to the higher layer specification of which spectrum fragments to use. At the receiver side the sampled wideband signal can be converted into narrowband streams by down converting and filtering to remove adjacent band interference. The reverse functionality can be performed at the transmitter side where narrowband baseband streams can be up converted and filtered to prevent aliasing i.e. an effect that causes different signals to become indistinguishable or aliases of one another when sampled.

The filter engine can include the ADC and DAC both of which can be capable of operating at a predetermined. Nyquist rate e.g. which can be the required Nyquist rate to create signals that span the entire 100 MHz ISM band . Further on the analog RF side there is a single oscillator at 2.45 GHz which can up convert the shaped signal to the ISM band. The filter engine can perform the following tasks to shape the signals for transmission resampling filtering and mapping of signal streams.

For resampling since the DAC expects an input signal at the predetermined. Nyquist rate e.g. 200 MS s the digital baseband transmission streams can he up sampled e.g. 40 Msamples sec streams can be up sampled to 200 Msamples sec . To accomplish this the up sampler can interpolate i.e. insert extra samples to reach the predetermined. Nyquist rate e.g. 200 MS s .

For filtering the filter engine can low pass filter both up sampled streams to remove any undesirable aliasing effects generated by the resampling and retain only the up sampled baseband version of each stream.

Subsequent to resampling and filtering the filter engine can perform a mapping operation. For mapping the filter engine can process two 200 MS s streams each occupying 20 MHz at a center frequency. The filter engine can move the 20 MHz frequencies to the specified fragments in the 100 MHz band i.e. to 38 MHz and 22 MHz respectively corresponding to 2.412 GHz and 2.472 GHz at a center frequency of 2.45 GHz . The signal streams can be added together and sent to the DAC . After that the signal streams can be up converted to the carrier frequency of 2.45 GHz and transmitted over the air.

As stated above the filter engine can include filter structures intermediate frequency converters and filter engine application programming interface API . The filter structures can include a collection of configurable programmable filters. The filters can include at least one of the following a finite impulse response FIR filter which is a filter whose impulse response or response to any finite length input is of finite duration and settles to zero in finite time an infinite impulse response HR filter which is a filter that has an impulse response function that is non zero over an infinite length of time a resampling filter and or any other filters. The filters in the filter structures can be configured and sequenced to provide resampling and filtering functionalities discussed above.

The intermediate frequency converters can nap the signal from an incoming digital baseband to a digital intermediate frequency IF and provide mapping functionality.

The filter engine API can act as a substrate that can allow programmable interconnection of the filter structures and IF converter to obtain the desired signal shaping. The. API can configure the filters up down samplers and digital up down converters. It can also coordinate movement of signal streams across these elements. It can collect all of the input signal streams add them and send the final stream to the DAC . The analog output of the DAC can be upconverted to a 2.45 GHz signal frequency and transmitted by the transmission antenna . For the receiving shaped signals the API can perform the above process but in a reverse manner. Thus by performing the above operations the current subject matter system s self interference cancellation component and the filtering engine component can perform full duplex signal shaping.

At a portion of interference from the received signal can be removed or cancelled. The interference can be caused by the transmitted signal and affect the received signal. It can be cancelled using the interference cancellation component shown in of the signal processing layer. As discussed above the interference cancellation component can include a balun transformer that can subtract a certain amount of power for the signal to reduce interference. The amount of power to be deducted can be determined based on a various characteristics associated with the system as well as the received transmitted signals.

At a remaining portion of the interfence can be removed from the received signal. This can be accomplished using the filtering component or filter engine shown in of the signal processing layer.

In some implementations the portion of the interference to be cancelled by the interference cancellation component can equal to a predetermined amount of power to be removed from the received signal. The predetermined amount of power can be determined based on at least one of the following dynamic range of at least one of the received and transmitted signals and a range of expected signal strength. The dynamic range of the received signal can be determined based on a ratio of powers of a strongest received signal and a weakest received signal. The dynamic range of the transmitted signal can be determined based on a ratio of powers of a strongest transmitted signal and a weakest transmitted signal. The range of expected signal strength can be determined based on a distance separating the transmitting antenna and a receiving antenna.

In some implementations the interference cancellation component can include a balanced unbalanced transformer component for subtracting the predetermined amount of power from the received signal. The interference cancellation component can include at least one passive electronic component.

In some implementations the filtering component can include a receiver circuitry for performing at least one of the following operations sampling of the received signal down converting the sampled received signal into a narrowband stream and filtering the down converted signal to remove the second portion of the interference. The filtering component can also include a transmitter circuitry for performing at least one of the following operations up converting of the transmitted signal and filtering the up converted signal to prevent aliasing of the transmitted signal with at least another signal Further the filtering component can include a plurality of filters arranged in a sequence for performing sampling and filtering of the received signal processed by the interference cancellation component to remove the second portion of the interference. The plurality of filters can include at least one programmable filter which includes at least one of the following a finite impulse response filter an infinite impulse response filter and a resampling filter.

In some implementations the filtering component can perform mapping of at least one signal received from at least one communication protocol layer to at least one frequency fragment in a wireless frequency band for transmission by the transmitting antenna.

The following is a brief discussion of an exemplary experimental implementation of the current subject matter system . The below discussion is not to be construed as limiting the scope of the current subject matter system and or any of its components in any way. It is provided here for purely illustrative purposes.

The current subject matter system was experimentally implemented using a Virtex 5 LX30 field programmable gate array FPGA which is an integrated circuit designed to be configured by a customer after manufacturing based software radios available from National Instruments Corporation Austin Tex. USA. The FPGA used had a total of 19 200 basic LUT FF and 32 DSP48E arithmetic unit resources. The FPGS was connected to an NI5781 baseband transceiver also available from National Instruments Corporation Austin Tex. USA which served as both the ADC and the DAC. The NI5781 was operated at 100 MS s for both the in phase and quadrature components allowing the current subject matter system to cover approximately 100 MHz of total bandwidth and provide signal shaping over almost the entire 2.4 GHz ISM band. The NI5781 baseband transceiver included quadrature 100 MS s 12 bit ADCs and 100 MS s 16 bit DACs and provided approximately 86 dB of dynamic range at the receiver. The converter was attached to the interposer board through differential connections which formatted the signals for the XCVR2540 high performance transceiver operating in the 2.4 GHz range also available from National Instruments Corporation Austin Tex. USA .

The XCVR2450 performed the analog down conversion to baseband and the bandwidth and receiver gain were controllable from the NI PXIe 8133 RT Module also available from National Instruments Corporation Austin Tex. USA . Because the XCV2450 operated in the ISM band there were several sources of external interference which came from devices such as WiFi Bluetooth wireless devices etc.

The experimental system was connected to the two XCVR2450 daughter cards with the received signal wires connecting to one card and the transmit signal wires connecting to the other. The signal from the transmit daughter card was first passed through an 8 dB power splitter and the high power port output was fed to the transmitter antenna. The lower power port output eras fed into a programmable attenuator line which was then connected to one end of the balanced tap of the balun. The signal from the received antenna was directly connected to the other balanced tap and the unbalanced output of the balun which was the subtraction of the two input signals was connected to the receiver daughter card. The two antennas one for transmit and one for receive were placed within 10 cm of one another.

A programmable attenuator of the experimental system s self interference cancellation block was tuned once for a particular transmit power and location of the node. After the block was static thereby making it a passive component. While channel fluctuations caused the amount of self interference to vary slightly the mean cancellation was determined to be around 25 dB. Because the experimental system s self interference cancellation component did not require an active component it provided flat cancellation.

The filter engine hardware used in the experimental system included an NI PXIe 7695 FPGA and a real time processor NI PXIe 8133 RT Module also available from National Instruments Corporation Austin Tex. USA . The FPGA was directly connected to the ADC DAC NI 5781 Adapter Module and received baseband sample at a rate of 100 complex MS s. The FPGA was then connected to the real tune processor which controlled the FPGA resources via the filter engine API.

The FPGA was a Virtex 5 95T with 14 720 slices and nearly 9 Mb of random access memory RAM . The slices were used for almost every operation on the FPGA while the RAM use was limited to storing data while averaging and providing temporary storage when restructuring the output of the definition of FFTs from bit order to natural order. For the filter structures DSP48E slices available on the Xilinx LX30 were utilized. Each of these slices is a highly configurable arithmetic logic unit which feature pipelined multiplier adder and accumulator stages and can he clocked at up to 550 MHz. Slices can be individually programmed and or cascaded to implement FIR IIR and resampling filtering with relative case.

The IF converters were implemented using the standard Coordinate Rotation Digital Computer CORDIC algorithm which is an algorithm to calculate hyperbolic and trigonometric functions and a complex multiplier. In total each IF converter requires approximately 1100 LUT FF resources and 3 DSP48E slices and can be clocked at up to 300 MHz. Based upon stream requirements both the CORDICs and DSP48E slices can be time division multiplexed to support multiple streams. The experimental system had 10 filter structures 10 DSP48E slices and 3 IF converters 9 DSP48E slices and 3300 LUT FFs . Thus the overall resource consumption on an off the shelf mid range FPGA was around 15 of the hardware resources.

The NI PXIe 8133 RT Module operates with four 1.733 GHz cores which were capable of dynamically splitting tasks between two threads each giving the RT module a total of 8 processing threads. These threads were utilized to implement the filter engine API channel estimation frequency offset information and symbol decoding. The filter engine API also specifying which fragments to transmit and receive over along with the desired bandwidths of each fragment. The filter engine then configured the filter structures IF converters and fractional resamplers to fit the user specifications.

In the experimental system a WiFi style OFDM PHY and a carrier sense multiple access CSMA MAC on the realtime operating system OS were implemented. The OFDM PHY was configured to operate over different bandwidths from 20 MHz to 5 MHz and ran in realtime on the SDR platform. It supported all WiFi constellations from BPSK to 64 QAM as well as channel coding rates convolutional coding .

During experimental operation the above experimental system achieved more than 24 dBm self interference cancellation. The system achieved the same throughput over multiple links as multiple independent radio devices receiving multiple signal streams. Further as compared to conventional active cancellation systems that introduce sideband leakage thereby reducing system throughput the experimental system produced near optimal throughput.

In some implementations the current subject matter system can be implemented in access point networks cellular networks WiFi direct networks and or any other networks.

In access point networks signals can be shaped to avoid interferences and latency for multiple clients can be appropriately mitigated. The current subject matter system can provide nearly three times throughput increase. The current subject matter system can improve throughput because the PHY MAC instance on each spectrum fragment can be decoupled from the others. In the current subject matter system each spectrum fragment behaves as if it is an independent WiFi network and no client has to be blocked because a client on some other spectrum fragment is being serviced. Thus the current subject matter system can improve overall spectrum utilization and network throughput. The current subject matter system further can improve latency and provide a better quality of service.

In the WiFi Direct WD networks that are used for peer to peer connectivity between gadgets the current subject matter system can enable a device to connect to an access point and to the WD peer on separate spectrum fragments and completely decouple their operation. The device can be transmitting receiving or both on any combination of the two networks it does not have to worry about synchronized scheduling thereby simplifying the design of the WD networks.

The subject matter described herein may be embodied in systems apparatus methods and or articles depending on the desired configuration. In particular various implementations of the subject matter described herein may be realized in digital electronic circuitry integrated circuit specially designed ASICs application specific integrated circuits computer hardware firmware software and or combinations thereof. These various implementations may include implementation in one or more computer programs that are executable and or interpretable on a programmable system including at least one programmable processor which may be special or general purpose coupled to receive data and instructions from and to transmit data and instructions to a storage system at least one input device and at least one output device.

These computer programs also known as programs software software applications applications components or code include machine instructions for a programmable processor and may be implemented in a high level procedural and or object oriented programming language and or in assembly machine language. As used herein the term machine readable medium refers to any computer program product apparatus and or device e.g. magnetic discs optical disks memory Programmable Logic Devices PLDs used to provide machine instructions and or data to a programmable processor including a machine readable medium that receives machine instructions as a machine readable signal.

Similarly systems are also described herein that may include a processor and a memory coupled to the processor. The memory may include one or more programs that cause the processor to perform one or more of the operations described herein.

Although a few variations have been described in detail above other modifications or additions are possible. In particular further features and or variations may be provided in addition to those set forth herein. For example the implementations described above may be directed to various combinations and subcombinations of the disclosed features and or combinations and subcombinations of several further features disclosed above. In addition the logic flow depicted in the accompanying figures and or described herein does not require the particular order shown or sequential order to achieve desirable results. Other embodiments may be within the scope of the following claims.

The systems and methods disclosed herein can be embodied in various forms including for example a data processor such as a computer that also includes a database digital electronic circuitry firmware software or in combinations of them. Moreover the above noted features and other aspects and principles of the present disclosed implementations can be implemented in various environments. Such environments and related applications can be specially constructed for performing the various processes and operations according to the disclosed implementations or they can include a general purpose computer or computing platform selectively activated or reconfigured by code to provide the necessary functionality. The processes disclosed herein are not inherently related to any particular computer network architecture environment or other apparatus and can be implemented by a suitable combination of hardware software and or firmware. For example various general purpose machines can be used with programs written in accordance with teachings of the disclosed implementations or it can be more convenient to construct a specialized apparatus or system to perform the required methods and techniques.

Although ordinal numbers such as first second and the like can in some situations relate to an order as used in this document ordinal numbers do not necessarily imply an order. For example ordinal numbers can be merely used to distinguish one item from another. For example to distinguish a first event from a second event but need not imply any chronological ordering or a fixed reference system such that a first event in one paragraph of the description can be different from a first event in another paragraph of the description .

The foregoing description is intended to illustrate but not to limit the scope of the invention which is defined by the scope of the appended claims. Other implementations are within the scope of the following claims.

To provide for interaction with a user the subject matter described herein can be implemented on a computer having a display device such as for example a cathode ray tube CRT or a liquid crystal display LCD monitor for displaying information to the user and a keyboard and a pointing device such as for example a mouse or a trackball by which the user can provide input to the computer. Other kinds of devices can be used to provide for interaction with a user as well. For example feedback provided to the user can be any form of sensory feedback such as for example visual feedback auditory feedback or tactile feedback and input from the user can be received in any form including but not limited to acoustic speech or tactile input.

The implementations set forth in the foregoing description do not represent all implementations consistent with the subject matter described herein. Instead they are merely some examples consistent with aspects related to the described subject matter. Although a few variations have been described in detail above other modifications or additions are possible. In particular further features and or variations can be provided in addition to those set forth herein. For example the implementations described above can be directed to various combinations and sub combinations of the disclosed features and or combinations and sub combinations of several further features disclosed above. In addition the logic flows depicted in the accompanying figures and or described herein do not necessarily require the particular order shown or sequential order to achieve desirable results. Other implementations can be within the scope of the following claims.

