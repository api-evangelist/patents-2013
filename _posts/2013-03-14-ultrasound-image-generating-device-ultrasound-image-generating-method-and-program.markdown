---

title: Ultrasound image generating device, ultrasound image generating method, and program
abstract: This ultrasound image generating device includes an ultrasound probe which transmits ultrasound into a subject, receives reflected sound, and outputs an ultrasound detection signal, the ultrasound image generating device generating a topographical image which represents a shape. The ultrasound image generating device further includes a sound speed value computation unit which computes a sound speed value in a region of interest in the topographical image; and a degree of reliability information generation unit which generates degree of reliability information of the sound speed value on the basis of the sound speed value corresponding to the region of interest.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09486182&OS=09486182&RS=09486182
owner: FUJIFILM CORPORATION
number: 09486182
owner_city: Tokyo
owner_country: JP
publication_date: 20130314
---
This application is a continuation application of International Application No. PCT JP2011 072089 filed Sep. 27 2011 which was published under PCT Article 21 2 in Japanese which is based upon and claims the benefit of priority from Japanese Application No. 2010 215735 filed on Sep. 27 2010 the contents of all of which are incorporated by reference herein in their entirety.

The present invention relates to an ultrasound image generating device an ultrasound image generating method and a program which transmit an ultrasonic wave toward a subject receive a reflected wave and display an image and in particular to an ultrasound image generating device an ultrasound image generating method and a program which image sound speed of a region of interest and reliability of the sound speed from the received reflected wave.

Heretofore as one morphological image of an ultrasound image a B mode image an image in which amplitude of an ultrasonic echo is represented by point luminance representing a shape is used. In order to achieve high image quality of the B mode image a technique is suggested in which a sound speed value is corrected with focus data obtained by setting the sound speed of the subject thereby improving the focus of the B mode image. Furthermore a measurement of a sound speed value in a portion of the subject hereinafter referred to as a local sound speed value is tried.

For example Patent Literature 1 discloses an ultrasound tomographic device in which focus calculation is performed using an input ultrasonic sound speed value as set sound speed of the whole device and an ultrasound image is taken using the obtained focus data to correct the set ultrasonic sound speed value that is using an ambient sound speed value hereinafter sometimes referred to as an optimum sound speed value thereby improving the focus.

Patent Literature 2 discloses an ultrasound diagnostic device in which a lattice point set in a region shallower than a region of interest in a subject and an optimum sound speed value in the region of interest are determined using the Huygens principle a reception wave received from the region of interest when an ultrasonic wave is transmitted toward the region of interest is calculated on the basis of the optimum sound speed value in the region of interest an assumed sound speed in the region of interest is assumed a reception wave from each lattice point obtained from the optimum sound speed value at each lattice point on the basis of the assumed sound speed is synthesized to obtain a synthesized reception wave and a local sound speed value in the region of interest is decided on the basis of the reception wave and the synthesized reception wave.

However in Patent Literature 1 while the focus of the B mode image is improved it is not possible to obtain a sound speed value in an arbitrary region of an image. In Patent Literature 2 while there are disclosures in obtaining the local sound speed value of the region of interest improving the focus by use of the obtained sound speed value reconstructing the B mode image and achieving high image quality and displaying the B mode image and the decision result of the local sound speed value in an overlapping manner for example changing color or luminance depending on a local sound speed value there is no disclosure in obtaining reliability of a sound speed value.

An object of the invention is to provide an ultrasound image generating device an ultrasound image generating method and a program which obtain not only an ambient sound speed value or a local sound speed value of a region of interest but also reliability thereof use only the reliable ambient sound speed value or local sound speed value for a focus or directly display or image and display these values thereby generating an ultrasound image such that a lesion in a subject is more easily detected.

To achieve the above object the present invention provides an ultrasound image generating device which has an ultrasound probe which transmits an ultrasonic wave toward a subject receives a reflected wave and outputs an ultrasonic detection signal and which generates a morphological image representing a shape the ultrasound image generating device comprising a sound speed value calculator which calculates a sound speed value in a region of interest of the morphological image and a reliability information generator which generates reliability information of the sound speed value on the basis of the sound speed value corresponding to the region of interest.

Preferably further comprising a sound speed image generator which generates a sound speed image on the basis of the sound speed value corresponding to the region of interest wherein the reliability information generator is adapted to generate the reliability information for each region corresponding to the region of interest of the sound speed image.

Preferably further comprising a reliability image generator which generates a reliability image on the basis of the reliability information.

Preferably further comprising an image processor which generates a display image from at least one of the morphological image the sound speed image and the reliability image and a display unit which displays the display image.

Preferably the reliability information is information obtained from each of pixels of the sound speed image and a predetermined range of pixels around each of the pixels.

Preferably the reliability information is information obtained from each of pixels between a plurality of the sound speed images.

Preferably the reliability information is measurement error information acquired when a discontinuous point is detected by edge detection processing or gap detection processing on the sound speed image.

Preferably the sound speed value is an ambient sound speed value and the sound speed image is an ambient sound speed image.

Preferably the sound speed value calculator has an ambient sound speed value calculator which calculates an ambient sound speed value and a local sound speed value calculator which calculates a local sound speed value on the basis of the ambient sound speed value and the sound speed value is the local sound speed value and the sound speed image is a local sound speed image.

Preferably the sound speed value calculator is adapted to obtain a focus index value of each of pixels of the morphological image or obtain an error of a virtual reception wave and a virtual synthesized reception wave in each of pixels for each of assumed local sound speeds from each of the pixels and a predetermined range of pixels around the each of the pixels for each of set sound speeds and the reliability information generator is adapted to generate reliability information on the basis of the focus index value for each of the set sound speeds or the error for each of the assumed local sound speeds.

Preferably further comprising a sound speed image generator wherein the sound speed value calculator is adapted further to calculate an ambient sound speed value or a local sound speed value in a region of interest of the morphological image on the basis of the focus index value for each of the set sound speeds and the error for each of the assumed local sound speeds the sound speed image generator is adapted to generate a sound speed image on the basis of the ambient sound speed value or the local sound speed value corresponding to the region of interest and the reliability information generator is adapted further to generate the reliability information for each region corresponding to the region of interest of the sound speed image.

Preferably further comprising a reliability image generator which generates a reliability image on the basis of the reliability information.

Preferably further comprising an image processor which generates a display image from at least one of the morphological image the sound speed image and the reliability image and a display unit which displays the display image.

Preferably the morphological image and the sound speed image or the reliability image are displayed on the display unit in an overlay manner.

Preferably display is performed in a state where pixels having the reliability information lower than a predetermined value among the pixels of the reliability image are masked.

Also to achieve the above object the present invention provides an ultrasound image generating method which transmits an ultrasonic wave toward a subject receives a reflected wave and generates a morphological image representing a shape the ultrasound image generating method comprising a sound speed value calculating step of calculating a sound speed value in a region of interest of the morphological image and a reliability information generating step of generating reliability information of the sound speed value on the basis of the sound speed value corresponding to the region of interest.

Preferably further comprising a sound speed image generating step of generating a sound speed image on the basis of the sound speed value corresponding to the region of interest wherein the reliability information generating step generates the reliability information for each region corresponding to the region of interest of the sound speed image.

Preferably the sound speed value calculating step obtains a focus index value of each of pixels of the morphological image for each of set sound speeds or obtains an error of a virtual reception wave and a virtual synthesized reception wave in each of the pixels for each of assumed local sound speeds from each of the pixels and a predetermined range of pixels around each of the pixels and the reliability information generating step generates reliability information on the basis of the focus index value for each of the set sound speeds or the error for each of the assumed local sound speeds.

Preferably further comprising a sound speed image generating step wherein the sound speed value calculating step calculates an ambient sound speed value or a local sound speed value in a region of interest of the morphological image on the basis of the focus index value for each of the set sound speeds or the error for each of the assumed local sound speeds the sound speed image generating step generates a sound speed image on the basis of the ambient sound speed value or the local sound speed value corresponding to the region of interest and the reliability information generating step generates reliability information for each region corresponding to the region of interest of the sound speed image.

Preferably further comprising a reliability image generating step of generating a reliability image on the basis of the reliability information.

Also to achieve the above object the present invention provides a program which causes a computer to execute the steps of the ultrasound image generating method according to any one of the above described method.

Also to achieve the above object the present invention provides a computer readable recording medium having the program described above recorded thereon.

According to the invention it is possible to provide an ambient sound speed image or a local sound speed image and a reliability image such that a lesion in a subject is more easily detected without using a configuration in which a dedicated ultrasonic wave for measuring an ambient sound speed value or a local sound speed value is transmitted and received.

Hereinafter an ultrasound image generating device according to the invention which executes an ultrasound image generating method according to the invention will be described in detail on the basis of preferred embodiments illustrated in the accompanying drawings. In the following embodiments a case where a B mode image is used as a morphological image will be described.

The ultrasound image generating device illustrated in includes an operating unit a controller an ultrasound probe a transmitter receiver a signal processor an ambient sound speed value calculator a sound speed image generator a first reliability image generator a second reliability image generator an image processor a display unit and an RF data recorder reproducer . The ambient sound speed value calculator includes a focus index calculator an ambient sound speed profile generator and an ambient sound speed value determiner .

The operating unit is used when an operator performs various operations on the ultrasound image generating device and outputs operation information. The configuration of the operating unit is not particularly limited and various known operating devices such as a keyboard a mouse and a touch panel may be used.

The controller controls the operation of each unit of the ultrasound image generating device . Furthermore the controller outputs a control signal CTL to each unit such that various kinds of processing are performed in accordance with the operation information and also sets a set sound speed or a reception delay pattern for obtaining an ambient sound speed value in the transmitter receiver described below.

The ultrasound probe is a probe which is used in contact with the subject and includes a plurality of ultrasound transducers constituting a one dimensional or two dimensional transducer array. In each ultrasound transducer an ultrasonic beam is transmitted toward the subject on the basis of an actuation signal which is applied from the transmitter receiver an ultrasonic echo which is reflected from the subject is received and a detection signal is output.

Each ultrasound transducer includes a vibrator in which electrodes are formed at both ends of a piezoelectric material piezoelectric body . As a piezoelectric body which constitutes the vibrator for example a piezoelectric ceramic such as PZT Pb lead zirconate titanate or a polymer piezoelectric element such as PVDF polyvinylidene difluoride may be used. If an electric signal is sent to the electrodes of the vibrator to apply a voltage across the electrodes the piezoelectric body expands and contracts whereby ultrasonic waves are generated in each vibrator with the expansion and contraction of the piezoelectric body. For example if a pulsed electric signal is sent to the electrodes of the vibrator a pulsed ultrasonic wave is generated and if a continuous wave electric signal is sent to the electrodes of the vibrator a continuous wave ultrasonic wave is generated. The ultrasonic waves generated in the respective vibrators are synthesized to form an ultrasonic beam. If an ultrasonic wave is received by each vibrator the piezoelectric body of each vibrator expands and contracts to generate an electric signal. The electric signals generated in the respective vibrators are output to the transmitter receiver as the detection signals of the ultrasonic waves.

As the ultrasound transducer a plurality kinds of ultrasonic conversion elements which are different from each other in ultrasonic wave conversion method may be used. For example a vibrator which is constituted by the above described piezoelectric body may be used as an element which transmits an ultrasonic wave and an ultrasound transducer of optical detection type may be used as an element which receives an ultrasonic wave. Here the ultrasound transducer of optical detection type is an ultrasound transducer which converts an ultrasound signal to an optical signal and detects the optical signal and the example thereof is a Fabry Perot resonator or a FBG Fiber Bragg Grating .

The transmission circuit generates an actuation signal in accordance with a control signal from the controller and applies the actuation signal to the ultrasound transducer . At this time the transmission circuit delays the actuation signal to be applied to each ultrasound transducer on the basis of a transmission delay pattern selected by the controller . That is the transmission circuit adjusts delays the timing of applying the actuation signal to each ultrasound transducer such that ultrasonic waves to be transmitted from the plurality of ultrasound transducers form an ultrasonic beam. Alternatively the timing of applying the actuation signal may be adjusted such that ultrasonic waves to be transmitted simultaneously from the plurality of ultrasound transducers reach the whole imaging region of the subject.

The reception circuit receives and amplifies the ultrasonic detection signal output from each ultrasound transducer . Since the distances between the respective ultrasound transducers and an ultrasonic wave reflection source in the subject differ from each other the times until a reflected wave reaches the respective ultrasound transducers differ from each other. The reception circuit includes a delay circuit and delays each detection signal by the amount corresponding to the difference delay time in the reaching time of the reflected wave in accordance with a reception delay pattern which is set on the basis of sound speed hereinafter referred to as assumed sound speed or distribution of sound speed selected by controller .

Next the reception circuit performs reception focus processing by matching and adding the detection signals to which the delay time is given. When different ultrasonic wave reflection sources exist at positions different from an ultrasonic wave reflection source X since ultrasonic detection signals from the different ultrasonic wave reflection sources are different from each other in the reaching time the phases of the ultrasonic detection signals from the different ultrasonic wave reflection sources are canceled each other out by the addition in the addition circuit. Accordingly the reception signal from the ultrasonic wave reflection source X becomes largest and comes into focus. With this reception focus processing the focus of the ultrasonic echo is narrowed to generate a sound ray signal hereinafter referred to as an RF signal .

In the A D converter an analog RF signal which is output from the reception circuit is converted to a digital RF signal hereinafter referred to as RF data and the RF data is output. The RF data includes phase information of a reception wave carrier wave .

In the signal processor after correction of attenuation depending on the distance in accordance with the depth of the reflection position of the ultrasonic wave is made for the RF data through STC Sensitivity Time gain Control an envelope detection processing is performed and B mode image data is generated and output.

The B mode image data and the RF data for each set sound speed are input to the focus index calculator and a focus index for each set sound speed necessary for obtaining the ambient sound speed value is calculated for each pixel of the B mode image. If the focus index for a certain set sound speed is calculated the set sound speed is changed and the focus index is calculated. That is the focus indices are calculated and output for all set sound speeds. As the focus index for example contrast and sharpness of the image or the period or amplitude of the ultrasonic detection signal in each pixel is used from the B mode image data and a beam width is used from the RF data.

The focus indices of all set sound speeds for each pixel of the B mode image are input to the ambient sound speed profile generator . The focus indices input are plotted on a graph in which the horizontal axis represents the set sound speed and the vertical axis represents the focus index and a set sound speed profile hereinafter referred to an ambient sound speed profile is generated and output.

The ambient sound speed profile obtained for each pixel of the B mode image is input to the ambient sound speed value determiner . The optimum sound speed value hereinafter referred to as an ambient sound speed value for each pixel is determined on the basis of the input ambient sound speed profile and output. Here the optimum sound speed value ambient sound speed value is a sound speed value at which contrast and sharpness of the image are highest and a sound speed value at which the beam width is smallest and is not necessarily consistent with an actual sound speed value local sound speed value in each pixel.

Alternatively as a method which obtains an ambient sound speed value for example a method which decides an ambient sound speed value from the spatial frequency dispersion or the like in a scanning direction for example JP 8 317926 A may be used.

The ambient sound speed value obtained for each pixel of the B mode image is input to the sound speed image generator . In the sound speed image generator an image in which values corresponding to the ambient sound speed values for example a given range of numerical values associated with a given range of sound speeds such that gradation expression is possible are allocated to the respective pixels of the B mode image hereinafter this image is referred to as a sound speed image is generated and output as sound speed image data. Pseudo color imaging may be performed for a given range of numerical values capable of a gradation expression.

Furthermore in a state where the ultrasound probe remains stationary a plurality of sound speed images may be generated and the average value between the plurality of sound speed images in a time axis frame direction may be calculated such that a measurement error suppressed sound speed image in which measurement errors are suppressed may be obtained.

The sound speed image data is input to the first reliability image generator . The first reliability image generator serves as a reliability information generator and a reliability image generator. In the first reliability image generator reliability information is generated for each pixel of the sound speed image and a reliability image is generated by imaging the reliability information and output as reliability image data. In regard to the reliability information for example the standard deviation of variations in the ambient sound speed value of each pixel of the sound speed image and a predetermined range of pixels for example 3 3 pixels around each pixel may be obtained and defined as a value of a center pixel. The reliability information obtained for all pixels is imaged and output as reliability image standard deviation image data.

Alternatively in regard to the reliability information the standard deviation of variations in the ambient sound speed value of the corresponding pixel between a plurality of sound speed images of the same region of interest with different acquisition times may be obtained imaged in the same manner as described above and output as reliability image data. These may be combined that is the standard deviation of variations in the ambient sound speed value of a three dimensional predetermined range of pixels with respect to the x axis the y axis and the time axis frame of an image may be obtained.

Even if the ambient sound speed in each pixel is constant when there are mediums with different sound speeds between the ultrasound probe and the region of interest the ambient sound speed changes in the depth direction. Accordingly in order to exclude this change from calculation of reliability approximation may be made with a plane which changes in the depth direction in accordance with a liner expression or a quadratic expression and the standard deviation may be obtained after subtracting the ambient sound speed value obtained by the approximation from the ambient sound speed value in each pixel.

Furthermore when the ultrasound probe is moved and a plurality of sound speed images are generated the standard deviation of variations in the ambient sound speed value of the same pixel of interest between the sound speed images frames may be obtained.

The ambient sound speed profile obtained for each pixel of the B mode image is input to the second reliability image generator . The second reliability image generator serves as a reliability information generator and a reliability image generator. In the second reliability image generator reliability information is generated on the basis of the shape of the input ambient sound speed profile or the sound speed image for each pixel of the B mode image the reliability information is imaged to generate a reliability image and reliability image data is output. The reliability information generator and the reliability image generator are constituted by the first reliability image generator and the second reliability image generator separately or in combination.

The shape of the ambient sound speed profile will be described. When the reliability of the ambient sound speed value is high for example as illustrated in the focus index undergoes monomodal change in which the closer it is to the ambient sound speed value the greater it becomes monotonously. The difference between the focus index at the ambient sound speed value and the focus index at the set sound speed value out of the ambient sound speed value becomes large. That is contrast increases.

On the other hand when the reliability of the ambient sound speed value is low for example as illustrated in the focus index may change intricately depending on the set sound speed and may undergo bimodal or trimodal change. The difference between the focus index at the ambient sound speed value and the focus index at the set sound speed value out of the ambient sound speed value becomes small. That is contrast decreases.

For this reason the reliability information may be generated using distortion of the shape of the ambient sound speed profile for example using an order capable of reducing error in curve fitting error with a result of quadratic curve fitting with the maximum value as an apex dispersion second moment of the set sound speed value and third moment of the set sound speed value.

Moreover the reliability information may be generated using the contrast of the focus index for example using the difference between the maximum value and the minimum value of the focus index the focus index expressed by the following Expression 1 and the average value of the derivative absolute values of the focus index. Focus Index Maximum Focus Index Focus Index 1400 Focus Index 1650 2 1 

Moreover on the basis of the fact that the focus index depends on luminance of the B mode image or frequency the reliability information may be generated using a value obtained by normalizing the above described error or contrast with the average value or the maximum value of the focus index.

The B mode image data the sound speed image data and the reliability image data are input to the image processor . The image processor has a DSC Digital Scan Converter function and an image processing function such as edge detection gap detection overlay display of various kinds of image data B mode image data sound speed image data and reliability image data highlighting and mask processing. Display image data implemented with DSC and image processing is output from the image processor . In regard to the B mode image data which is used in overlay display or the like it is preferable to use data at the set sound speed at which the focus of the whole image is most excellent.

In the DSC function since the B mode image data and the sound speed image data and the reliability image data generated based on the B mode image data are based on a scan system different from a normal television signal scan system conversion raster conversion to normal image data for example image data of a television signal scan system NTSC system is performed so as to be displayable on the display unit described below.

In the image processing function for example overlay images of various kinds of image data are generated reliable pixels are highlighted or less reliable pixels are masked and not displayed whereby images which assist diagnosis by a physician are generated. For example a measurement error image may be generated on the basis of measurement error information acquired from of pixels of a reliability image pixels of interest having reliability information equal to or less than a predetermined value which is considered as measurement error and the measurement error image may be displayed on the sound speed image in an overlay manner.

For example when edge detection processing or gap detection processing is performed on a sound speed image that is when a plurality of pixels are set within a two dimensional section or three dimensionally by including the time axis frame direction around a pixel of interest and a set of pixels in which the difference in the ambient sound speed value between adjacent pixels is equal to or larger than a predetermined value is included that is when discontinuous point is included by detecting the pixel of interest as measurement error measurement error information may be acquired to generate a measurement error image as a reliability image and the measurement error image may be displayed on the sound speed image in an overlay manner. At this time approximation may be made with a plane which changes in the depth direction in accordance with a linear expression or a quadratic expression and a discontinuous portion may be decided after subtracting the ambient sound speed value obtained by the approximation from the ambient sound speed value in each pixel and detected as measurement error.

The display image data is input to and displayed on the display unit . The display unit is constituted by an FPD Flat Panel Display such as liquid crystal plasma or organic EL Electro Luminescence or a CRT Cathode Ray Tube . For the display unit a display unit having a large display area and a large number of pixels may preferably be used such that a plurality of images can be displayed in parallel.

Information for example parameters representing the depth of the reflection position of the ultrasonic wave the density of the scan lines and the visual field width relating to the RF data and a frame rate is input to the RF data recorder reproducer and is recorded in an internal cine memory. The RF data recorder reproducer has two operation modes of a cine memory recording mode and a cine memory reproduction mode. At the time of normal observation live mode the RF data recorder reproducer operates in the cine memory recording mode to record the RF data.

The cine memory reproduction mode is a mode in which an ultrasound diagnostic image is displayed analyzed and measured on the basis of the RF data stored in the cine memory. In the cine memory reproduction mode the RF data stored in the cine memory is output to the signal processor in accordance with operation by an operator and the operator can view the B mode image the sound speed image and the reliability image based on the RF data recorded in the RF data recorder reproducer .

Next the operation of the ultrasound image generating device according to the invention which realizes the ultrasound image generating method according to the invention will be described.

First a plurality of set sound speeds for obtaining the ambient sound speed value are selected by the controller and are set for the transmitter receiver Step S . In regard to the set sound speed a plurality of sound speeds are selected and set from a range of sound speed in a human body about 1400 m s to 1650 m s . The number L of sound speeds to be selected may be set such that when plotting them on a graph which has the horizontal axis representing the set sound speed and the vertical axis representing the focus index a graph such as in is drawn. Alternatively the operator may set the set sound speeds.

Subsequently the operator brings the ultrasound probe into contact with the subject to perform transmission and reception of an ultrasonic wave and an ultrasonic detection signal is output from the ultrasound probe Step S . The ultrasonic detection signal is input to the transmitter receiver subjected to the reception focus processing or transmission and reception focus processing for each set sound speed on the basis of the reception delay patterns corresponding to the selected set sound speeds A D Analog Digital converted and output as RF data for each set sound speed Step S .

The RF data for each set sound speed is input to the signal processor subjected to correction of attenuation depending on the distance through the STC in accordance with the depth of the reflection position of the ultrasonic wave and subjected to the envelope detection processing and B mode image data of a B mode image such as shown in is generated for each set sound speed and output Step S .

The B mode image data and the RF data for all the set sound speeds are input to the ambient sound speed value calculator . In the ambient sound speed value calculator a region of the B mode image where a sound speed image or a reliability image is desired to be obtained is designated as a region of interest Step S . In regard to the region of interest for example as illustrated in the whole B mode image may be set automatically as a region of interest at the initial setting or a part of the B mode image may be set automatically as a region of interest. The operator may operate the operating unit to set a part of the B mode image as a region of interest. The region of interest is designated by for example start point coordinates x y and end point coordinates x y . In the flowchart of as an example x is set in a range of n to N and y is set in a range of m to M.

If the region of interest is set a start pixel of interest for example x n y m for starting calculation of the ambient sound speed value is set Step S and calculation of the ambient sound speed value of the pixel of interest is performed Step S .

Here the details of the calculation of the ambient sound speed value of the pixel of interest will be described on the basis of a flowchart of .

First the number of the sound speeds number of the set sound speeds selected for obtaining the ambient sound speed value set in Step S is set to have an initial value c 1 and a maximum value c L Step S .

Next the focus index of the set sound speed Cis calculated and output Step S . As the focus index value for example the values of contrast and sharpness of the B mode image data are calculated and output. A predetermined index may be calculated from the beam width of the RF data of the pixel of interest and output as a focus index.

If the calculation of the focus index for C 1 initial value ends the values of Cand C maximum value are compared with each other Step S . When the value of Cis less than C N in Step S 1 is added to C Step S and the process is returned to the calculation of the focus index in Step S. The calculation Step S of the focus index is repeated until achieving C C and the focus index is calculated and output for all the set sound speeds of the pixel of interest.

The focus indices for all the set sound speeds of the pixel of interest are input to the ambient sound speed profile generator and are plotted on a graph which has the horizontal axis representing the set sound speed and the vertical axis representing the focus index. Thus an ambient sound speed profile is generated and output Step S .

The ambient sound speed profile is input to the ambient sound speed value determiner and for example in the case where the ambient sound speed profile is one as shown in the set sound speed value with the maximum value of the focus index is determined as the ambient sound speed value and output Step S .

If the calculation of the ambient sound speed value of the pixel of interest ends that is if Step S ends the value of the y coordinate of the pixel of interest is compared with y Step S . When the value of y is less than y N in Step S 1 is added to y Step S and the process is returned to the calculation of the ambient sound speed value of the pixel of interest in Step S. The calculation of the ambient sound speed value of the pixel of interest Step S is repeated until achieving y y.

Upon achieving y y Y in Step S the value of the x coordinate of the pixel of interest is compared with x Step S . When the value of x is less than x N in Step S 1 is added to x Step S the value of the y coordinate is set to y y m Step S and the process is returned to the calculation of the ambient sound speed value of the pixel of interest in Step S. That is when the y coordinate direction is referred to as a line if the ambient sound speed value of the first line with the x coordinate of n is calculated the x coordinate is incremented by 1 n 1 and the ambient sound speed value of the second line is calculated. The calculation of the ambient sound speed value of the pixel of interest Step S is repeated until the ambient sound speed value is calculated for the whole region of interest until achieving x x x N y y y M .

If the calculation of the ambient sound speed value for the whole region of interest ends the ambient sound speed value is input to the sound speed image generator and the ambient sound speed profile is input to the second reliability image generator .

Here selection information relating to a reliability image is set in advance or the operating unit is operated by the operator and a reliability image is selected by the controller Step S . When a standard deviation image is selected as a reliability image standard deviation in Step S in the sound speed image generator the ambient sound speed value corresponding to each pixel of the B mode image is allocated and the ambient sound speed image is generated and output as ambient sound speed image data Step S .

The ambient sound speed image data is input to the first reliability image generator and the image processor . In the first reliability image generator reliability information for each pixel of the sound speed image is generated and the reliability information is imaged to generate a reliability image and output as reliability image data Step S .

On the other hand when an ambient sound speed profile shape image is selected as a reliability image in Step S profile shape in Step S reliability information is generated for each pixel of the B mode image on the basis of the ambient sound speed profile shape for each pixel of the B mode image input to the second reliability image generator without using the ambient sound speed image and the reliability information is imaged to generate a reliability image and output as reliability image data Step S .

The B mode image data the ambient sound speed image data and the reliability image data are input to the image processor . In the image processor conversion to normal image data overlay display highlighting mask processing and the like are performed for various kinds of input image data to generate display image data and the display image data is output to and displayed on the display unit Step S . Edge detection gap detection and the like may be performed for various kinds of image data to acquire measurement error information to generate a measurement error image.

An example of display image data which is displayed on the display unit will be described. For example the B mode image illustrated in or the ambient sound speed image illustrated in and the reliability image standard deviation image illustrated in or the reliability image sound speed profile shape illustrated in can be displayed in parallel.

Also for example as illustrated in the color luminance hue color saturation of the ambient sound speed image may be modulated and displayed alone or in parallel or the color of the reliability image or the measurement error image may be modulated instead of the ambient sound speed image and displayed alone or in parallel. Furthermore as illustrated in the B mode image of and the ambient sound speed image of may be displayed in an overlay manner.

The display of the B mode image or the ambient sound speed image may be limitedly performed such that less reliable pixels or pixels with measurement errors are not displayed or only reliable pixels are displayed. For example as illustrated in the ambient sound speed image of can be displayed in a state of being masked with the reliability image of .

In addition to the above for example as illustrated in the B mode image illustrated in and an image in which the color of the ambient sound speed image illustrated in is modulated may be displayed in an overlay manner or as illustrated in the B mode image illustrated in and an image in which the ambient sound speed image illustrated in is masked with the reliability image may be displayed in an overlay manner.

The operator may arbitrarily switch the display mode of the foregoing various display images through the operating unit .

As described above it is possible to provide various ambient sound speed images and reliability images such that a lesion in the subject is more easily detected without using a configuration in which a dedicated ultrasonic wave for measuring the ambient sound speed value is transmitted and received.

Next as a second embodiment a case where the local sound speed value is used instead of the ambient sound speed value will be described. is a block diagram illustrating the configuration of an ultrasound image generating device according to the second embodiment which is different from the above mentioned first embodiment of the invention.

The ultrasound image generating device basically has the same configuration as the ultrasound image generating device according to the first embodiment of the invention illustrated in except that a local sound speed value is further obtained from an ambient sound speed value and a sound speed image and a reliability image are generated using the local sound speed value. Accordingly the same constituent elements are represented by the same reference numerals and detailed description thereof will not be repeated.

In the ultrasound image generating device illustrated in an ambient sound speed value of each pixel which is an output of the ambient sound speed value calculator is input to a local sound speed value calculator a local sound speed value which is output from the local sound speed value calculator is input to the sound speed image generator and the second reliability image generator and an error profile which is also output from the local sound speed value calculator is input to the second reliability image generator .

The local sound speed value calculator includes a virtual reception wave virtual synthesized reception wave error calculator an error profile generator and a local sound speed value determiner .

B mode image data and the ambient sound speed value are input to the virtual reception wave virtual synthesized reception wave error calculator and error between a virtual reception wave and a virtual synthesized reception wave is calculated for each assumed local sound speed necessary for obtaining the local sound speed value for each pixel of the B mode image. That is the error between the virtual reception wave and the virtual synthesized reception wave is calculated and output for all the assumed local sound speeds.

The errors between the virtual reception wave and the virtual synthesized reception wave for all the assumed local sound speeds for each pixel of the B mode image are input to the error profile generator . The input errors between the virtual reception wave and the virtual synthesized reception wave are plotted on a graph which has the horizontal axis representing the assumed local sound speed and the vertical axis representing the error between the virtual reception wave and the virtual synthesized reception wave to generate an error profile and the error profile is output.

The error profile obtained for each pixel of the B mode image is input to the local sound speed value determiner . The local sound speed value for each pixel is determined on the basis of the input error profile and output.

As illustrated in it is assumed that a lattice point representing a region of interest ROI in a subject OBJ is referred to as X lattice points which are arranged at regular intervals in the XY direction at positions shallower than the lattice point X close to the ultrasound transducer are referred to as A1 A2 . . . and at least the sound speed between the lattice point Xand each of the lattice points A1 A2 . . . is constant.

In this example it is assumed that T and the delay time T of the reception waves W W . . . from the lattice points A1 A2 . . . are known and the local sound speed value at the lattice point Xis obtained from the positional relationship between the lattice point Xand the lattice points A1 A2 . . . . Specifically On the basis of the Huygens principle the fact that a reception wave Wfrom the lattice point Xis consistent with a reception wave Wobtained by virtually synthesizing the reception waves from the lattice points A1 A2 . . . is used.

The range and the number of the lattice points A1 A2 . . . which are used for calculation for obtaining the local sound speed value at the lattice point Xare determined in advance. If the range of the lattice points which are used for calculating the local sound speed value is wide the error of the local sound speed value increases and if the range is narrow the error with the virtual reception wave increases. For this reason the range of the lattice points is determined taking this fact into consideration.

The interval between the lattice points A1 A2 . . . in the X direction is determined taking into consideration the resolution and the processing time. As an example the interval between the lattice points A1 A2 . . . in the X direction is 1 mm to 1 cm.

If the interval between the lattice points A1 A2 . . . in the Y direction is narrow error in error calculation increases and if the interval is wide error of the local sound speed value increases. The interval between the lattice points A1 A2 . . . in the Y direction is determined on the basis of the setting of the image resolution of the ultrasound image. As an example the interval between the lattice points A1 A2 . . . in the Y direction is 1 cm.

When the interval between the lattice points A1 A2 . . . is wide since the calculation of the synthesized wave becomes difficult fine lattice points may be generated by interpolation.

Since the operation of the ultrasound image generating device of the second embodiment is about the same as the ultrasound image generating device of the first embodiment description thereof will not be repeated and only different portions will be described with reference to the flowchart shown in .

Subsequently a start pixel of interest for example x n y m for starting calculation of the local sound speed value is set Step S and calculation of the local sound speed value of the pixel of interest is performed Step S .

The details of the calculation of the local sound speed value of the pixel of interest will be described on the basis of the flowchart of .

First the waveform of the virtual reception wave Wwhen the lattice point Xis defined as a reflection point is calculated on the basis of the ambient sound speed value at the lattice point X Step S .

Next the initial value of an assumed sound speed at the lattice point Xis set Step S . Then the assumed sound speed is changed by one step Step S and the virtual synthesized reception wave Wis calculated Step S . If it is assumed that the local sound speed value at the lattice point Xis V the time until an ultrasonic wave which propagates from the lattice point Xreaches the lattice points A1 A2 . . . becomes XA1 v XA2 V . . . . Here XA1 XA2 . . . are the distances between the lattice points A1 A2 . . . and the lattice point X respectively. Since the ambient sound speed values at the lattice points A1 A2 . . . are known through the process up to Step S of the reception waves from the lattice points A1 A2 . . . can be obtained in advance. Accordingly the reflected waves ultrasonic echo radiated from the lattice points A1 A2 . . . with the respective delay XA1 V XA2 V . . . are synthesized thereby obtaining the virtual synthesized reception wave W.

Practically since the above described processing is performed on element data RF signal the time T1 T2 . . . respectively taken to reach the lattice points A1 A2 . . . from the lattice point Xis expressed by the following Expression 2 . In Expression 2 X X . . . are the distances between the lattice points A1 A2 . . . and the lattice point X in the scan direction X direction respectively and t is the time interval of Y direction between the lattice points. Equation 1 1 square root over 2 2 square root over 2 3 . . . 2 

The reception waves from the lattice points A1 A2 . . . with the delay obtained by adding the time t 2 taken to reach the lattice point Xfrom a lattice point An of the same sound ray as the lattice point Xto T1 T2 . . . above are synthesized thereby obtaining the virtual synthesized reception wave W.

When the lattice points are set at regular time intervals t in the Y direction the interval on a space is not necessarily a regular interval. Accordingly when calculating the time until an ultrasonic wave reaches each lattice point instead of t 2 corrected t 2 may be used in Expression 2 . The corrected t 2 is a value which is obtained by adding or subtracting to or from t 2 a value obtained by dividing the difference in the depth the distance in the Y direction between A1 A2 . . . and the lattice point An of the same sound ray as the lattice point Xby V. The depth of each of the lattice points A1 A2 . . . is obtained on the basis of the fact that a local sound speed value at a shallower lattice point than the lattice points A1 A2 . . . is known.

The calculation of the virtual synthesized reception wave Wis performed by superimposing default pulse waves W W . . . practically radiated from the lattice points A1 A2 . . . with the delay XA1 v XA2 V . . . .

Next the error between the virtual reception wave Wand the virtual synthesized reception wave Wis calculated Step S . The error between the virtual reception wave Wand the virtual synthesized reception wave Wis calculated by a method which takes a cross correlation a method which multiplies the virtual reception wave Wand the delay obtained from the virtual synthesized reception wave Wtogether and performs phase matching and adding or a method which conversely multiplies the virtual synthesized reception wave Wand the delay obtained from the virtual reception wave Wtogether and performs phase matching and adding. In order to obtain the delay from the virtual reception wave W it should suffice that the lattice point Xis defined as a reflection point and the time until an ultrasonic wave propagating at the sound speed V reaches each element is defined as a delay. In order to obtain the delay from the virtual synthesized reception wave W an equiphase line may be extracted from the phase difference between the synthesized reception waves from adjacent elements and the equiphase line may be defined as a delay or the phase difference at the maximum peak position of the synthesized reception wave of each element may be simply defined as a delay. Moreover a cross correlated peak position of the synthesized reception waves from the respective elements may be defined as a delay. The error at the time of phase matching and adding is obtained by a method which defines as the peak to peak of a waveform after phase matching and adding or a method which defines as the maximum value of amplitude after envelope detection.

Next Steps S to S are repeated and if the calculation with the values of all the assumed sound speeds ends Y in Step S the local sound speed value at the lattice point Xis decided Step S . When the Huygens principle is strictly applied the waveform of the virtual synthesized reception wave Wobtained in the above Step S is identical to the waveform of the virtual reception wave reflected wave Wof when it is assumed that the local sound speed value at the lattice point Xis V. In Step S the value of assumed sound speed at which the difference between the virtual reception wave Wand the virtual synthesized reception wave Wis minimal is decided as the local sound speed value at the lattice point X.

Instead of the above described methods calculation of the virtual synthesized reception waveform calculation of the error with the virtual reception waveform and sound speed decision a table which has the ambient sound speed value of the lattice point Xand the ambient sound speed values of the lattice points A1 A2 . . . as input and the sound speed value at the lattice point Xas output may be used.

The decision of the local sound speed value may be made multiple times using lattice points at different intervals or in different ranges.

If the calculation of the local sound speed value of the pixel of interest ends that is if Step S ends the value of the y coordinate of the pixel of interest is compared with y Step S . When the value of y is less than y N in Step S is added to y Step S and the process is returned to the calculation of the local sound speed value of the pixel of interest in Step S. The calculation of the local sound speed value of the pixel of interest Step S is repeated until achieving y y.

If y y Y in Step S the value of the x coordinate of the pixel of interest is compared with x Step S . When the value of x is less than x N in Step S is added to x Step S the value of the y coordinate is set to y y m Step S and the process is returned to the calculation of the local sound speed value of the pixel of interest in Step S. That is when the y coordinate direction is referred to as a line if the local sound speed value of the first line with the x coordinate of n is calculated the x coordinate is incremented by 1 n 1 and the local sound speed value of the second line is calculated. The calculation of the local sound speed value of the pixel of interest Step S is repeated until the local sound speed value is calculated for the whole region of interest until achieving x x x N y y y m .

If the calculation of the local sound speed value for the whole region of interest ends similarly to the process from Step S onward of the first embodiment local sound speed image data and reliability image data are generated and displayed on the display unit .

As in the first embodiment display image data which is displayed on the display unit may be various types of display image data.

In this way even when not only the ambient sound speed value but also the local sound speed value is used it is possible to provide a local sound speed image and a reliability image such that a lesion in a subject is more easily detected without using a configuration in which a dedicated ultrasonic wave for measuring a local sound speed value is transmitted and received.

Although in each embodiment the B mode image is generated and a pixel of the B mode image is defined as a pixel of interest the B mode image may not be generated the region of interest may be divided into a plurality of pixels on the basis of RF data and the sound speed image may be generated with the plurality of pixels as pixels of interest.

Although in each embodiment the ambient sound speed value or the local sound speed value is allocated to each pixel of the B mode image to generate the sound speed image the invention is not limited thereto and the pixels of the sound speed image may not correspond to the pixels of the B mode image on a one to one basis. For example four pixels of the B mode image may correspond to one pixel of the sound speed image.

Although in each embodiment the operation at the time of the normal observation live mode has been described the B mode image the sound speed image and the reliability image may be generated on the basis of RF data recorded in the RF data recorder reproducer .

The invention may be constituted as an ultrasound image generating program which causes a computer to execute each step of the above described ultrasound image generating method or an ultrasound image generating program which causes a computer to function as means for executing each step of the ultrasound image generating method or to function as means constituting the above described ultrasound image generating device.

The invention may be constituted as a computer readable medium or a computer readable memory on which the above described ultrasound image generating program is recorded.

Although the ultrasound image generating device the ultrasound image generating method and the program according to the invention have been described in detail the invention is not limited to the foregoing embodiments and it is needless to say that various improvements and modifications are possible without departing from the gist of the invention.

