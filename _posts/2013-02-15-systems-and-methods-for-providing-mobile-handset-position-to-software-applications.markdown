---

title: Systems and methods for providing mobile handset position to software applications
abstract: Providing information as to location of a mobile station involves receiving a mobile station location request from a requesting software application at an API gateway of a wireless communications network. The API gateway provides a network-initiated request to the wireless communications network for the location of the mobile station after determining that the requesting application is authorized to receive the location of the specified mobile station. The location of the mobile station can be determined, according to either a coarse or granular location position resolution, or accuracy, based on the request of the application and/or the conditions of the wireless communication network. Information as to location of the mobile station can be produced, and provided to the requesting software application, which can be resident on the mobile station itself or at a different location/platform.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08774765&OS=08774765&RS=08774765
owner: Cellco Partnership
number: 08774765
owner_city: Basking Ridge
owner_country: US
publication_date: 20130215
---
This application is a continuation of and claims priority to U.S. application Ser. No. 12 836 290 filed on Jul. 14 2010 the entire contents of which are incorporated herein by reference.

In recent years mobile stations have become must have devices for most people in many countries. The communications that such devices offer via wireless mobile communications network enable users to talk and exchange various types of messages for business and personal reasons and to access information all from or while traveling through any location where a network provides service. As the technology has advanced the size of mobile stations has decreased so that today most can be carried in a pocket or purse clipped to a belt etc. There are situations where it is desirable to determine the location of a mobile station and various industry players have developed technologies to meet such demands. For example in the US today most mobile devices are equipped with Global Positioning Satellite GPS receivers processors sufficient to enable emergency services to obtain information as to the location of a device as part of the processing of an emergency call e.g. to 911. The advanced location capabilities of such mobile stations however have also enabled service providers to offer services and applications today that will allow a user of a mobile station to learn their present location and possibly obtain information about that locale and or related navigation information via the mobile station itself.

Situations arise where it is desirable for another person to learn the location of a mobile station and the service providers have developed technologies for many such situations. For example mobile network service providers today offer at least some types of Mobile Location Based Service MLBS that enable a user of or associated with one mobile station to locate a user of another mobile station based on the location of the second mobile station. Examples of such services today include Family Locator formerly Chaperone offered by Verizon Wireless and Boost Loop offered by BoostMobile .

Family Locator is a simple and secure method for parents to keep a closer tab on their children. The mobile stations are GPS enabled. Family Locator allows a customer e.g. a parent to view on a map a location of the Family Locator enabled phone of another customer e.g. a child and to receive alerts when the Family Locator enabled phone enters or leaves a particular zone.

Boost Loop expanded this type of location service to include keeping tabs on a wider range of friends and family member. In this connection Boost Loop is another location based social service that uses a mobile phone with built in GPS to automatically update a customer location for a private list of friends. To illustrate the customer downloads the Boost Loop software onto her mobile phone and publishes its location on a Boost Loop map. Thereafter the customer may invite other friends who have installed Boost Loop to join the customer s networks. If friends accept such invitation their locations will also be published on the map. As such the customer can identify the locations of her friends in real time on a map display on the customer s mobile station.

Although these mobile station location technologies allow a requesting device as operated by a user to monitor or learn the current location of a mobile station that is the target of a location information request or procedure the existing technologies do not allow software applications to make a request for and be giving access to the location of a mobile station for performing software functions based on the location of that mobile station.

Hence there is still a need for an improved simplified technique for obtaining information as to the location of a mobile station.

In the following detailed description numerous specific details are set forth by way of examples in order to provide a thorough understanding of the relevant teachings. However the present teachings may be practiced without such details. In other instances well known methods procedures components and or circuitry have been described at a relatively high level without detail in order to avoid unnecessarily obscuring aspects of the present teachings.

Functionality systems and methods for determining the location of a mobile station are shown and described. By use of such the location of a mobile station can be determined and provided to one or more software applications such as local weather forecasting and asset tracking applications.

Reference now is made in detail to the examples illustrated in the accompanying drawings and discussed below. illustrates a mobile communication network as may be operated by a carrier or service provider to provide a wide range of mobile communication services and ancillary services or features to its subscriber customers and associated mobile station MS users. The elements collectively indicated by the reference numeral generally are elements of the network and are operated by or on behalf of the carrier although the mobile stations may be sold to and owned by the carrier s customers. The mobile communication network provides communications between mobile stations as well as communications for the mobile stations with networks and stations not shown outside the mobile communication network .

The wireless mobile communication network might be implemented as a network conforming to the code division multiple access CDMA IS 95 standard the 3rd Generation Partnership Project 2 3GPP2 wireless IP network standard or the Evolution Data Optimized EVDO standard the Global System for Mobile GSM communication standard a time division multiple access TDMA standard or other standards used for public mobile wireless communications. The mobile stations may be capable of conventional voice telephone communications and data communications.

For purposes of later discussion several mobile stations appear in the drawing to represent examples of the mobile stations that may receive various services via the mobile communication network .

Mobile stations can take the form of portable handsets smart phones or personal digital assistants although they may be implemented in other form factors. Mobile stations can include media content. The media content can be configured to execute on many different types of mobile stations . For example a mobile station application can be written to execute on a binary runtime environment for mobile BREW based mobile station. In further instances a mobile station application can be written to execute on a Windows Mobile based mobile station Android I Phone Java Mobile or RIM based mobile station such as a BlackBerry or the like.

The mobile communication network can be implemented by a number of interconnected networks. Hence the overall network may include a number of radio access networks RANs as well as regional ground networks interconnecting a number of RANs and a wide area network WAN interconnecting the regional ground networks to core network elements. A regional portion of the network such as that serving mobile stations can include one or more RANs and a regional circuit and or packet switched network and associated signaling network facilities.

Physical elements of a RAN operated by one of the mobile service providers or carriers include a number of base stations represented in the example by the base stations BSs . Although not separately shown such a base station can include a base transceiver system BTS which can communicate via an antennae system at the site of base station and over the airlink with one or more of the mobile stations when the mobile stations are within range. Each base station can include a BTS coupled to several antennae mounted on a radio tower within a coverage area often referred to as a cell. The BTS is the part of the radio network that sends and receives RF signals to from the mobile stations that are served by the base station .

The radio access networks can also include a traffic network represented generally by the cloud at which carries the user communications and data for the mobile stations between the base stations and other elements with or through which the mobile stations communicate. In some examples the mobile traffic network includes network elements that support mobile station media content transfer services such as mobile switching centers MSCs signal transfer points STPs and an application server App. Server . The network can also include other elements that support functionality other than media content transfer services such as messaging service messages and voice communications. Examples of other network elements that may be used in support of messaging service message communications include but are not limited to message centers MCs home location registers HLRs simple messaging service point to point SMPP gateway and other network elements such as wireless internet gateways WIGs and visitor location registers VLRs not shown . Other individual elements such as switches and or routers forming the traffic network are omitted here form simplicity. It will be understood that the various network elements can communicate with each other and other aspects of the mobile communications network and other networks e.g. the public switched telephone network PSTN and the Internet either directly or indirectly.

The mobile switching center MSC is responsible for managing communications between the mobile station and the other elements of the network . In addition the MSC is responsible for handling voice calls and messaging service message requests as well as other services such as conference calls FAX and circuit switched data messaging service communications Internet access etc. . The MSC sets up and releases the end to end connection or session and handles mobility and hand over requirements during the call. The MSC also routes messaging service messages to from the mobile stations typically from to an appropriate MC . The MSC is sometimes referred to as a switch . The MSC manages the cell sites the voice trunks voicemail and SS7 links.

The message center MC in some examples allows messaging service messages to be exchanged between mobile telephones and other networks. For SMS messaging for example the MC receives packet communications containing text messages from originating mobile stations and forwards the messages via the signaling resources and the signaling channels to the appropriate destination mobile stations. The MC may receive messages from external devices for similar delivery to mobile stations and the MC may receive similar messages from the mobile devices and forward them to servers or terminal devices in either case via an Internet Protocol IP packet data network.

In some examples the MC can also be considered or include functionality that may be considered that of a Short Messaging Service Message Center SMSC or a Message Register MR . Wireless carriers developed the short message service SMS to transmit text messages for display on the mobile stations. In many existing network architectures the SMS traffic uses the signaling portion of the network to carry message traffic between a Short Message Service Center SMSC and the mobile stations. The SMSC supports mobile station to mobile station delivery of text messages. However the SMSC also supports communication of messages between the mobile stations and devices coupled to other networks. For example the SMSC may receive incoming IP message packets from the Internet for delivery via the network one of the base stations and a signaling channel over the air link to a destination mobile station. For this later type of SMS related communications the network also includes one or more Short Message Peer to Peer SMPP protocol gateways .

In other examples the MC can include functionality related to the Enhanced Messaging Service EMS or Multimedia Messaging service MMS . An EMS message can have special text formatting e.g. such as bold or italic animations pictures icons sound effects and special ring tones. MMS messages support the sending and receiving of multimedia messages e.g. images audio video and their combinations to or from MMS enabled mobile stations. In some examples the MC can be considered in whole or in part a multimedia messaging service center MMSC .

Although a single MC is shown a network can have many geographically dispersed MCs . The MCs can include destination routing tables DRTs . In essence the DRTs are databases within the MCs . A DRT contains a list of the MDNs which are associated with the various MCs . For example a first MDN is associated with a MC in California while a second MDN is associated with a MC in Virginia. The DRTs are used to determine which MC should attempt to deliver an incoming messaging service message to the destination MDN. For example if a user associated with the MC in California sends an SMS to a user associated with the MC in Virginia the California MC sends the SMS to the Virginia MC for delivery to the destination MDN. The communication among the MCs occurs using know protocols such SMPP and the like.

The HLR in some examples stores a subscriber profile for each of the wireless subscribers and their associated mobile stations and . The HLR may reside in an MSC or in a centralized service control point that communicates with the MSC s via an out of band signaling system such as an SS7 network. The HLR stores for each mobile subscriber the subscriber s mobile directory number MDN the mobile identification number MIN . and information specifying the wireless services subscribed to by the mobile subscriber such as numeric paging or text based paging data communication services etc. Of course the HLR can also be a stand alone device. The HLR also tracks the current point of attachment of the mobile station to the network e.g. the identification of the MSC with which the mobile station is currently registered to receive service.

The visitor location register VLR not shown is in some examples a temporary database of the mobile stations that have roamed into the particular area which it serves. The VLRs for a region often are implemented in or in association with a MSC . Each base station in the network is served by a single VLR hence a subscriber cannot be present in more than one VLR at a time. The data stored in the VLR has either been received from the HLR or collected from the mobile station.

The SMPP gateway provides functionality to transport messaging service messages to other mobile communication networks and also receive messaging service messages from other networks. The SMPP gateway supports communications using the SMPP protocol. SMPP gateways are Short Message Peer to Peer SMPP gateways used to connect the wireless communication network such as an Internal Protocol IP network on the left of the SMPP Gateway in to another network such as a public Internet network on the right of the SMPP Gateway in . The SMPP Gateway allows the MC to receive and send messages in IP packet format. The SMPP Gateway is an entity within the wireless network that acts as an intermediary between the wireless service provider network and other networks. For example the SMPP Gateway converts messages in protocol s used by other applications and devices e.g. Extensible Markup Language XML Hypertext Mail Protocol HTMP etc. to and from the SMPP protocol. The SMPP messages ride on IP transport e.g. between the SMPP Gateway and the MC .

In addition the traffic network portion of the mobile communications network connects to a private data network . The private data network connects to the traffic network portion via a gateway not shown . The gateway can provide protocol conversions between the protocols used by the traffic network and the protocols used by the private data network .

The private data network can be in communication with various auxiliary services servers e.g. such as those providing additional services to the users of the network and or to operations support personnel of the service provider or carrier that operates the network . For example the carrier can also offer its subscribers on line access to a variety of functions related to the subscribers accounts such as review of billing statements and usage data on line payment subscription changes password control or the like. For that purpose the carrier can operate a customer account web server offering a MyAccount type subscriber interface via the Internet e.g. a My Verizon page for a user having a Verizon Wireless account. Hence a user s terminal such as PC may be used to access on line information about a subscriber s account which the mobile carrier makes available via the carrier s MyAccount web site accessible through the Internet .

In addition a group provisioning manager device GPMD a zone provisioning device ZPD and a service creation manager device SCMD can be provided in communication with the private data network media content transfer functions e.g. downloading of media content. The GPMD can also be referred to as a group provisioning manager network device. For discussion purposes each of the GPMD ZPD and SCMD can be a stand alone computing device such as a server. The functionality described below with respect to each of the GPMD ZPD and SCMD can however be provided by one or multiple different computing devices. In other words the GPMD ZPD and SCMD need not be a stand alone computing device in various configurations. The SCMD can maintains provisioning information for a particular end user and mobile station . As explained in further detail below for a network can be provided with various elements for determining the location of a mobile and allowing software applications to make use of such position information.

An example of a wireless network with location based services infrastructure LBSI for support of granular and coarse location via a network initiated request is shown . Network includes elements similar to those of network of including one or more mobile stations . The mobile device or station can be an advanced device e.g. a Blackberry RIM Android Palm LiMo Java or Linux device. API gateway API GW functions to allow software applications e.g. third party applications shown by application server to send requests to locate mobile handsets. Such software applications can be resident on the mobile station itself or resident on another platform. Examples of such software applications include but are not limited to weather forecasting reporting applications and asset or person tracking and or location applications. The API GW is interfaced with a location gateway LGW for supporting location requests from the software application s . The API GW and LGW are connected to a wireless data network WDN of the network which can include SMPP Gateway GW AAA server cache and position determining entity PDE . The LGW is also connected to a mobile position center MPC which is connected to one or more mobile switching centers MSCs and home location registers HLRs of the wireless network . After verifying that the requesting software application indicated by is authorized to receive the position information for the mobile station the request can be processed and the position information can be determined at different resolutions or accuracies based on the request itself and or network conditions. One position resolution of location or position accuracy is coarse which is cell ID based position of a mobile using the latitude longitude of the centroid of a cell in which the mobile station is operating. Another resolution or accuracy is granular which can offer a more precise location of the mobile station e.g. based on GPS determined latitude and longitude of the mobile station. Assisted GPS Advanced Forward Link Triangulation AFLT or other suitable techniques can be used for facilitating granular position determination as is described in further detail below.

As an overview of a process by which a third party application is provided with the location of a mobile station by way of the LBSI API GW LGW and MPC the API GW of provides the single point of interface to third party applications shown by . The API GW receives requests for location from third party applications translates them into mobile location protocol MLP commands toward the LGW receives responses from the LGW and responds to third party applications with the location of the mobile station . The LGW provides an interface to the API GW to extract device positions in a user plane positioning environment. The LGW can be connected to the WDN via e.g. two dedicated T1 connections. MPC is provided for coarse location determination and interfaces with the LGW for determining the status of the mobile station e.g. available or unavailable identifying the network location of the mobile station i.e. by way of he Serving Mobile Switching Center and determining the coarse location of the mobile station . The MPC is preferably provisioned with the following data MDN range to HLR address mapping data MSC identifiers to lat long mapping data cell ID to lat long mapping data and MSC Point Code SSN to MSCID data. In physical connectivity between network elements is indicated by solid lines while logical interfaces are indicated by dashed lines suitable examples of which are described below.

As for interfaces between the location specific network elements of network the interface between the API GW and LGW can be based on OMA Mobile Location Protocol MLP v. 3.2 over HTTP. The API GW can be connected to the WDN so existing WDN connectivity to the LGW can be utilized for this interface. This interface can be and preferably is secured using SSL. The interface between the MPC and LGW can be based on Open Mobile Alliance OMA Mobile Location Protocol MLP v. 3.2. The MPC can interface with the home location registers HLRs using e.g. TIA 41 D and the MSCs which can include visitor location registers VLRs using e.g. TIA EIA IS 881 links respectively. The API GW itself can interface with the software application s via Parlay X 2.1 Web Services API.

PDEs have resulted from the mobile telecom industry developing a number of technologies to locate mobile stations both for emergency services e.g. 911 and for location based applications. In an increasingly common network implementation the mobile station has the capability to take GPS signal measurements and communicate those measurements to one or more network elements or software applications for processing depending on the particular application. Typically a PDE communicates with an appropriately equipped mobile station MS to determine the location of the MS and for non emergency services a Location gateway LGW makes that information accessible to various user applications including some applications that reside on mobile stations. Hence the location determination software in the mobile station enables that station to obtain the location information by working with elements of a location based service LBS platform of the mobile wireless communication network such as a location gateway LGW and a PDE .

The PDE is a network element that manages the position or geographic location determination of each mobile station. For discussion purposes at this point it can be assumed that exemplary network utilizes an assisted GPS AGPS approach to the determination of mobile station location in which the mobile station takes measurements of signals from a number of GPS satellites only three of which are shown for convenience and interacts with the PDE to process those measurements so as to determine the latitude and longitude and possibly altitude of the current location of the mobile station . The PDE system is essentially a general purpose programmable device with an interface for data communication via the network running server software and running programming for implementation of the PDE functions. The PDE stores e.g. in cache memory or has access to a complete and up to date set of the satellite data for the constellation of GPS satellites needed to allow computation of position based on pseudorange measurements from satellite signals. The data may include that associated with the entire constellation but will at least include the data for the satellites expected to be broadcasting into the geographic region serviced by the network .

When a mobile station such as attempts a GPS position fix the mobile station provides information allowing the PDE to perform a pre fix. Typically the mobile station will provide data identifying the base station through which it is receiving service and possibly the serving sector . In some implementations the PDE may receive data regarding several base stations sectors and signal strengths thereof for trilateration. The PDE uses information about base station location s to process the data received from the mobile station so as to determine a region e.g. area of the cell or sector or a general area triangulated based on signals from several base stations that the mobile station is likely located within. The PDE then uses the pre fix location to parse the satellite data down to assistance data that the mobile station at the particular location needs in order to take GPS readings. The PDE sends the parsed satellite data to the mobile station e.g. to target mobile station for use in taking measurements of signals from appropriate satellites . The GPS assistance data may contain selected satellite almanac satellite visibility Doppler and clock correction information.

The mobile station in turn uses this information also known as acquisition assistance records to take multiple satellite pseudorange measurements. Depending on the device network configuration the mobile station such as or the PDE can then calculate a final fix using these pseudorange measurements. The final fix computation provides latitude and longitude and possibly altitude coordinates for the current location of the mobile station . If the mobile station has full GPS computation capability the station would know its current latitude and longitude and would communicate that data to the PDE through the network . In many cases however the mobile station has only measurement capability and the mobile station forwards the measurement data to the PDE to determine the final fix. In either case the GPS processing leads to a situation in which the PDE knows the latitude and longitude of the mobile station that is to say in the given example. If necessary the PDE can provide coordinates to the mobile station .

For many location based applications today further processing or access is needed. To provide access to general users e.g. mobile subscribers and authorized third party users the carrier also operates a location gateway LGW . The LGW is essentially a general purpose programmable device with an interface for data communication via the network running server software and running programming for implementation of the LGW functionality. In the example the server platform runs a queue manager for managing communications and access to the various LGW program modules. The LGW program modules can include a thin API proxy client for client server proxy communications with the mobile stations such as the target mobile station . The LGW program modules can also include a PDE adapter for communications through the network with the PDE e.g. for situations in which the LGW needs to obtain mobile station position data from the PDE .

Continuing with the description of network upon receipt of a location request from a third party application the API GW sends a request for location to the LGW . The LGW makes a determination if coarse or granular location is needed. If granular location is required the LGW uses user plane location technology. For supporting granular location a Location Agent LA client can be installed on the mobile handset . If coarse location is requested the LGW sends a request to the Control Plane Mobile Position Center MPC . As indicated the MPC can interface with a pre existing SS7 network for communicating with HLRs and MSCs.

The LGW determines whether granular or coarse location is required by examining the requested horizontal accuracy of the location request. If the requested horizontal accuracy is less than a specified threshold e.g. 500 meters 1000 meters 1 500 meters granular location may be attempted. Of course the specified threshold can be selected as desired and may be based on operational parameters of the wireless network and or the GPS system. If the requested horizontal accuracy is equal to or more than a specified threshold e.g. 1000 meters or 1 500 meters coarse location may be attempted. In various examples described below the following location capabilities can be available for supporting network initiated location requests single shot location granular location with automatic fallback to coarse location or coarse location and triggered location including i geographic notification or geofencing ii scheduled notification granular location with automatic fallback to coarse location or coarse location . Additionally the subscriber s location privacy can be managed by an API GW resident Privacy Engine PE which can validate all location requests from third party applications against the subscriber s privacy profile.

An example of the call flow for coarse location request scenario is shown in with reference to network elements of network shown and described for . The scenario shown is for when the mobile station in question is within network and idle. Upon receipt of a request for location from a third party application the API GW sends a Standard Location Immediate Request SLIR command to the LGW as shown at step . The MLP message posted to the LGW and as referenced elsewhere herein can be written in suitable HTTP script. The SLIR message identifies the third party application. The LGW MPC pair stores the third party application ID. LGW MPC determines that cached location information for this mobile does not meet the criteria specified in the request in step and sends an SMSREQ message to the home location registry HLR associated with the identified mobile as shown at step .

A SMSREQ or an LPREQ message can be used for SMSC to HLR queries for short messaging applications. In the scenario depicted in the MPC uses the SMSREQ message to query the HLR for the MSC that is currently serving the targeted mobile station .

The HLR can respond with a smsreq message as shown at step providing the SS7 network address of the MSC serving the targeted mobile station .

Following step the MPC sends an ISPOSREQ to the MSC serving the mobile as shown at step . Coarse location is not necessarily supported when the target mobile is outside the e.g. VzW network. The MPC can make this determination by comparing the SS7 network address of the serving MSC returned by the HLR against provided SS7 network addresses of all MSCs provisioned on the MPC. If the serving MSC address provided by the HLR is not in the MPC records the MPC can conclude that the handset or mobile station is outside the network and can return an error code e.g. 500 MS Roamed Out via the LGW to the API GW .

The serving MSC establishes radio contact with the MS e.g. pages the MS to obtain the current serving cell information as shown at step . The serving MSC can then send an isposreq message to the MPC including the serving cell ID and MSC ID information as shown at step .

If the serving MSC is a Wireless SoftSwitch WSS it can additionally return POSINFO parameter containing the location latitude longitude of the e.g. Femto cell a.k.a. Network Extender in the isposreq message.

Continuing with the description of the example the MPC will look up the cell centroid latitude longitude for the serving cell ID received in isposreq. To facilitate such the network provider or third parties can prepare and supply Base Station Almanac BSA data for provisioning on the MPC . If the isposreq includes the POSINFO parameter the MPC can use the latitude longitude information provided in the POSINFO parameter instead. The LGW returns a Standard Location Immediate Answer SLIA message to the API GW as shown at step . The pos method attribute can be returned in the SLIA message. Communication between the MPC and HLR is indicated at while communication between the MPC and the MSC VLR is indicated at .

An example of the call flow for granular location request scenario is shown in with reference to network elements of network shown and described for . Step is the same as step in with the caveat the requested accuracy in this scenario is m. Steps are the same as steps in . Steps are executed to support fallback to coarse location in the event that granular location position determination is unavailable.

Continuing with the description of at step the LGW now has the status of the mobile available and has the coarse location of the mobile . The LGW will provide the coarse location if granular location cannot be determined for any reason. The LGW sends a mobile terminated MT SMS message to the Location Agent in the mobile handset . If the name of the third party application is provided in step the LGW will include it in the MT SMS message to allow the Location Agent to display it on the mobile handset . The Location Agent sends a StartPositionProcessRequest message to the LGW via HTTPS as described at step .

At step the LGW checks in the AAA cache indicated by for availability of MIN IP pair in cache. If cache is not available a request is made to an AAA server also indicated by to authenticate client. The response can be cached at the LGW with SPPRequest. As part of this authentication process the IP MDN MIN and carrier ID for the device are extracted from the AAA server. The LGW can consider a request as authorized if the IP MDN MIN from AAA server match the IP MIN and MDN as part of the SPPRequest and if the carrier ID returned by the AAA server for the device is of a supported authorized carrier. If null is returned as a carrier ID or if no value is returned for carrier ID by the AAA server the request is considered as authorized.

At step the LGW returns an SPPResponse to the handset containing IP address of the PDE. At step upon receipt of the PDE IP addresses in the SPPResponse message the Location Agent invokes the native IPOSDET GetGPSInfo function. The mobile device or station can be an advanced device e.g. a Blackberry RIM Android Palm LiMo Java or Linux device. For example if the mobile station is a BREW device the BREW OS connects to the PDE on IS 801 Authenticator port to begin the IS 801 session. At step the PDE calls the LGW to do IP MIN authentication IS 801 Auth Req to make sure the requester is a valid handset a corresponding SPPRequest exist and if the device is on an authorized network if roaming . At step the LGW validates that an SPPRequest exist corresponding to this request. IS 801 Authentication result IS 801 Auth Resp is sent to the PDE asynchronously.

As shown a step the PDE completes the IS 801 session. After the IS 801 session is competed successfully the MS has the current location information. At step the Location Agent LA sends the updated location to the LGW in a Position Report message. At step the LGW updates its local cache with position from position report and sends a response to the Location Agent LA . This position information can be made available for any future location requests. The call flow ends at step where the LGW returns a Standard Location Immediate Answer SLIA message to the API GW as shown at step . The pos method attribute can be returned in the SLIA message for use by the API GW in providing the requested mobile station location to the software . Communication between the MPC and HLR is indicated at while communication between the MPC and the MSCNLR is indicted at .

An example of the call flow for geographic notification scenario is shown in with reference to network elements of network shown and described for . At step the API GW sends a Triggered Location Reporting Request TLRR command to the LGW . Steps are the same as steps of . At step the LGW sends a Triggered Location Reporting Answer TLRA message to the API GW . At step the geographic notification criteria is indicated as being met on the LA resident on the mobile station . Steps are the same as steps of . These steps are executed by the Location Agent Handset when the trigger criteria for the requested geographic notification is met. As shown as step the LGW returns a TLREP message to the API GW .

An example of the call flow for cancellation of geographic notification scenario is shown in with reference to network elements of network shown and described for . At step a periodic notification is successfully established using the triggered location reporting call flow in . At step the API GW sends a TLRSR message to the LGW . At step the LGW sends a Cancel periodic notification SMS trigger message to Location Agent MS . At step the Location Agent MS sends a PositionReport message to the LGW . The ReportReason parameter is set to PositionReportCancelConfirmation 00000110 and the Status Indicator parameter is set to Success 00000000 . At step the LGW does an IP MIN check to validate that the sender of the PositionReport message is a valid subscriber. At step the LGW sends a PositionReportResponse message to the MS . Finally as indicated at step the LGW returns TLRSA response to the API GW.

The call flow for a scheduled or triggered notification scenario is shown in with reference to network elements of network shown and described for . As indicated at step the API GW sends a TLRR command to the LGW . As indicated at step the LGW sends a TLRA message in response to acknowledge the TLRR command. At step the scheduled notification criteria is indicated as being met on the LGW. Communication between the MPC and HLR is indicated at while communication between the MPC and the MSC VLR is indicted at . Steps are the same as steps of . At step the PLS returns a TLRP message to the API GW which in turn provide position information of the mobile station to the requesting application.

For purposes of such a discussion provides a block diagram illustration of an exemplary wireless device which may be used as mobile station shown in . Although the wireless device may be a smart phone or may be incorporated into another device such as a personal digital assistant PDA or the like for discussion purposes the illustration shows the wireless device in the form of a handset. The handset embodiment of the wireless device functions as a normal digital wireless telephone station. For that function the station includes a microphone for audio signal input and a speaker for audio signal output. The microphone and speaker connect to voice coding and decoding circuitry vocoder . For a voice telephone call for example the vocoder provides two way conversion between analog audio signals representing speech or other audio and digital samples at a compressed bit rate compatible with the digital protocol of wireless telephone network communications or voice over packet Internet Protocol communications.

For digital wireless communications the handset also includes at least one digital transceiver XCVR . The handset can be configured for digital wireless communications using one or more of the common network technology types. For example the handset may be a dual mode device capable of utilizing either or both of CDMA IS 95 1XRTT or EV DO technologies and or 3GPP LTE GSM UMTS technologies. For that purpose the transceiver XCVR can be a multimode transceiver or the handset may include two or more transceivers each of which supports a subset of the various technologies or modes. The concepts discussed here encompass implementations of the station that can utilize any digital transceivers that conform to current or future developed digital wireless communication standards. The mobile station may also be capable of analog operation via a legacy network technology.

The transceiver functions to provide two way wireless communication of information such as vocoded speech samples and or digital message information in accordance with the technology of the associated network e.g. network of . The transceiver also sends and receives a variety of signaling messages in support of the various voice and data services provided via the station and the communication network. Each transceiver connects through RF send and receive amplifiers not separately shown to an antenna . In the example the transceiver is configured for RF communication in accord with a digital wireless protocol such as the current CDMA and 3GPP protocols. Of note for purposes of this discussion the transceiver also supports mobile messaging service message communications to and from the handset . In the example the transceiver supports at least SMS type messaging although it may also support other mobile messaging such as EMS and or MMS.

The station includes a display for displaying messages menus or the like call related information dialed by the user calling party numbers etc. A keypad enables dialing digits for voice and or data calls as well as generating selection inputs for example as may be keyed in by the user based on a displayed menu or as a cursor control and selection of a highlighted item on a displayed screen. The display and keypad are the physical elements providing a textual or graphical user interface. Various combinations of the keypad display microphone and speaker may be used as the physical input output elements of the graphical user interface GUI for multimedia e.g. audio and or video communications. Of course other user interface elements may be used such as a stylus and touch sensitive display screen as in a PDA or smart phone.

In addition to normal telephone and data communication related input output including message input and message display functions the user interface elements also may be used for display of menus and other information to the user and user input of selections including any needed during a device location operation. For example if used as the requesting mobile station the keypad would be used to input the MDN of the target station as well as the requisite code activation code and password and then initiate transmission. Then based on the response from the mobile station the device would display the current location information on display .

A microprocessor serves as a programmable controller for the wireless device in that it controls all operations of the wireless device in accord with programming that it executes for all normal operations and for operations involved in the device location procedure under consideration here. In the example the wireless device includes flash type program memory for storage of various software or firmware program routines and mobile configuration settings such as mobile directory number MDN and or mobile identification number MIN etc. The wireless device may also include a non volatile random access memory RAM for a working data processing memory. Of course other storage devices or configurations may be added to or substituted for those in the example. In a present implementation the flash type program memory stores firmware such as a boot routine device driver software an operating system call processing software and vocoder control software and any of a wide variety of other applications such as client browser software and short message service software. The memories also store various data such as telephone numbers and server addresses downloaded data such as multimedia content and various data input by the user. Programming stored in the flash type program memory sometimes referred to as firmware is loaded into and executed by the microprocessor .

For position determination and associated location based functions the mobile station can also include a GPS receiver . Under control of the microprocessor the GPS receiver receives and processes signals from one or more satellites of the GPS constellation e.g. represented by satellites in . From its processing the GPS receiver supplies GPS data to the microprocessor such as pseudorange measurements and associated PN codes for measured satellite signals. Associated computations may be performed in the microprocessor or by a processor or the like included in the GPS receiver.

If the receiver or the combination of the receiver and the microprocessor are configured to provide a fully functional GPS position determination device the station could process the pseudorange measurements absolute times of transmission of the GPS signals and satellite position data to compute at least the station s latitude and longitude and possibly translate that data into location information such as street address. However because of size space cost constraints on the design of the mobile stations the GPS receiver in the mobile station often will have only reception capability not the full GPS processing capability to resolve position from signals received from the satellites e.g. satellites in . Hence the receiver supplies the GPS measurement and code data to the microprocessor which in turn formats the data and sends it to a PDE e.g. PDE of using the wireless transceiver . As outlined above the PDE performs the data processing necessary to determine the latitude and longitude of the station and transmits that data where needed e.g. for use by LGW in to provide the street address or the like back to the mobile station for inclusion in the location response message sent at S.

As outlined above the mobile station includes a processor and programming stored in the flash memory configures the processor so that the mobile station is capable of performing various desired functions including in this case the functions involved in the technique for providing location information.

In the example the executable programming stored in the flash memory includes at least some minimal location determination software . The location determination software in the example can control the checking of the user password and that programming controls the operation of the GPS receiver the processing of the GPS measurements and the interactions through the network e.g. with LGW and PDE of to determine location essentially as discussed above. The executable programming also includes SMS message communication programming for recognizing the activation code to start the program and to receive send the various SMS messages. Hence the executable programming configures the microprocessor so that the mobile station is capable of providing the location information as did the target mobile station in the example of .

The structure and operation of the mobile station as outlined above were described to by way of example only.

As shown by the above discussion functions relating to the automated locating of a mobile station may be implemented on programmable mobile stations configured for wireless communication via a mobile communication network operating as an one of the mobile stations as shown by way of example in .

The software functionalities involve programming including executable code as well as associated stored data e.g. files used for the code recognition. The programming code is executable by the processor microprocessor or the like that functions as the control element of the particular mobile station device. In operation the code is stored within the memory of the mobile station for loading and execution by the processor. At other times however the executable code may be stored at other locations and or transported for loading into the mobile station. Execution of such code by the processor of the mobile station enables the mobile station to implement the methodology for providing location information in essentially the manner performed in the examples discussed and illustrated herein.

Hence aspects of the methods of providing location information outlined above may be embodied in programming. Program aspects of the technology may be thought of as products or articles of manufacture typically in the form of executable code and or associated data that is carried on or embodied in a type of machine readable medium. Storage type media include any or all of the non transitory tangible memory of the computers processors mobile stations or the like or associated modules thereof such as various semiconductor memories tape drives disk drives and the like which may provide non transitory storage at any time for the software programming. All or portions of the software may at times be communicated through the Internet or various other telecommunication networks. Such communications for example may enable loading of the software from a computer or processor into the mobile station to add or update the functionality to that device. Thus another type of media that may bear the software elements includes optical electrical and electromagnetic waves such as used across physical interfaces between local devices through wired and optical landline networks and over various air links. The physical elements that carry such waves such as wired or wireless links optical links or the like also may be considered as media bearing the software. As used herein storage media relates to tangible non transitory media for storing programming and or data and unless restricted to such storage media terms such as computer or machine readable medium refer to any medium that participates in providing instructions to a processor for execution.

Such a machine readable medium may take many forms including but not limited to a tangible storage medium a carrier wave medium or physical transmission medium. Non volatile storage media include for example optical or magnetic disks such as any of the storage devices in the mobile stations illustrated in the drawings. Volatile storage media include dynamic memory such as main memory of such a computer platform. Tangible transmission media include coaxial cables copper wire and fiber optics including the wires that comprise a bus within a computer system. Carrier wave transmission media can take the form of electric or electromagnetic signals or acoustic or light waves such as those generated during radio frequency RF and infrared IR data communications. Common forms of computer readable media therefore include for example a floppy disk a flexible disk hard disk magnetic tape any other magnetic medium a CD ROM DVD or DVD ROM any other optical medium punch cards paper tape any other physical storage medium with patterns of holes a RAM a ROM a PROM and EPROM a Flash EPROM any other memory chip or cartridge a carrier wave transporting data or instructions cables or links transporting such a carrier wave or any other medium from which a computer can read programming code and or data. Many of these forms of computer readable media may be involved in carrying one or more sequences of one or more instructions to a processor for execution.

While the foregoing has described what are considered to be the best mode and or other examples it is understood that various modifications may be made therein and that the subject matter disclosed herein may be implemented in various forms and examples and that the teachings may be applied in numerous applications only some of which have been described herein. It is intended by the following claims to claim any and all applications modifications and variations that fall within the true scope of the present teachings.

The description above has used a large number of acronyms to refer to various services messages and system components. Although generally known use of several of these acronyms is not strictly standardized in the art. For the convenience of the reader the following list correlates terms to acronyms as used in the detailed description above.

