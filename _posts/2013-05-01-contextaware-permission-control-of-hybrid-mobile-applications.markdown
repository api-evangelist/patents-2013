---

title: Context-aware permission control of hybrid mobile applications
abstract: Controlling access to secure resources of a data processing system is provided. An input-to-output mapping of an application installed on the data processing system is generated that determines whether a secure resource in the data processing system is shared with an external entity associated with the application and under what specified conditions. It is determined whether the specified conditions exist during runtime of the application. In response to determining that the specified conditions do not exist during runtime of the application, sharing of the secure resource of the data processing system with the external entity associated with the application is prevented. In response to determining that the specified conditions do exist during runtime of the application, sharing of the secure resource of the data processing system with the external entity associated with the application is allowed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09275221&OS=09275221&RS=09275221
owner: GLOBALFOUNDRIES INC.
number: 09275221
owner_city: Grand Cayman
owner_country: KY
publication_date: 20130501
---
The disclosure relates generally to hybrid mobile applications and more specifically to controlling access to secure resources of a mobile device by hybrid mobile applications running on the mobile device based on user defined context aware security policies.

With the development of new mobile operating system platforms mobile computing has grown in popularity exponentially in recent years. A major factor driving this exponential growth is the availability of a large number of mobile applications that provide functionality ranging from banking to gaming to social networking. To benefit from the constantly growing consumer market for these mobile applications enterprises are producing new mobile applications that are built from the composition of existing ones at breakneck speed.

According to one illustrative embodiment a method for controlling access to secure resources of a data processing system is provided. A data processing system generates an input to output mapping of an application installed on the data processing system that determines whether a secure resource in the data processing system is shared with an external entity associated with the application and under what specified conditions. The data processing system determines whether the specified conditions exist during runtime of the application. In response to the data processing system determining that the specified conditions do not exist during runtime of the application the data processing system prevents sharing of the secure resource of the data processing system with the external entity associated with the application. In response to the data processing system determining that the specified conditions do exist during runtime of the application the data processing system allows sharing of the secure resource of the data processing system with the external entity associated with the application.

According to other illustrative embodiments a data processing system and a computer program product for controlling access to secure resources of the data processing system are provided.

As will be appreciated by one skilled in the art aspects of the illustrative embodiments may be embodied as a data processing system method or computer program product. Accordingly aspects of the illustrative embodiments may take the form of an entirely hardware embodiment an entirely software embodiment including firmware resident software micro code etc. or an embodiment combining software and hardware aspects that may all generally be referred to herein as a circuit module or system. Furthermore aspects of the illustrative embodiments may take the form of a computer program product embodied in one or more computer readable medium s having computer readable program code embodied thereon.

Any combination of one or more computer readable medium s may be utilized. The computer readable medium may be a computer readable signal medium or a computer readable storage medium. A computer readable storage medium may be for example but not limited to an electronic magnetic optical or semiconductor system apparatus or device or any suitable combination of the foregoing. More specific examples a non exhaustive list of the computer readable storage medium would include the following a portable computer diskette a hard disk a random access memory RAM a read only memory ROM an erasable programmable read only memory EPROM or Flash memory a portable compact disc read only memory CD ROM an optical storage device a magnetic storage device or any suitable combination of the foregoing. In the context of this document a computer readable storage medium may be any tangible medium that can store a program for use by or in connection with an instruction execution system apparatus or device. In addition a computer readable storage medium does not include a propagation medium such as a signal or carrier wave.

A computer readable signal medium may include a propagated data signal with computer readable program code embodied therein for example in baseband or as part of a carrier wave. Such a propagated signal may take any of a variety of forms including but not limited to electro magnetic infra red or any suitable combination thereof. A computer readable signal medium may be any computer readable medium that is not a computer readable storage medium and that can communicate propagate or transport a program for use by or in connection with an instruction execution system apparatus or device.

Program code embodied on a computer readable medium may be transmitted using any appropriate medium including but not limited to wireless wireline optical fiber cable RF etc. or any suitable combination of the foregoing.

Computer program code for carrying out operations for aspects of the illustrative embodiments may be written in any combination of one or more programming languages including an object oriented programming language such as Java Smalltalk C or the like and conventional procedural programming languages such as the C programming language or similar programming languages. The program code may execute entirely on the user s computer partly on the user s computer as a stand alone software package partly on the user s computer and partly on a remote computer or entirely on the remote computer or server. In the latter scenario the remote computer may be connected to the user s computer through any type of network including a local area network LAN or a wide area network WAN or the connection may be made to an external computer for example through the Internet using an Internet Service Provider .

Aspects of the illustrative embodiments are described below with reference to flowchart illustrations and or block diagrams of methods data processing systems and computer program products according to illustrative embodiments. It will be understood that each block of the flowchart illustrations and or block diagrams and combinations of blocks in the flowchart illustrations and or block diagrams can be implemented by computer program instructions. These computer program instructions may be provided to a processor of a general purpose computer special purpose computer or other programmable data processing apparatus to produce a machine such that the instructions which execute via the processor of the computer or other programmable data processing apparatus create means for implementing the functions acts specified in the flowchart and or block diagram block or blocks.

These computer program instructions may also be stored in a computer readable storage medium that can direct a computer other programmable data processing apparatus or other devices to function in a particular manner such that the instructions stored in the computer readable storage medium produce an article of manufacture including instructions which implement the function act specified in the flowchart and or block diagram block or blocks.

The computer program instructions may also be loaded onto a computer other programmable data processing apparatus or other devices to cause a series of operational steps to be performed on the computer other programmable apparatus or other devices to produce a computer implemented process such that the instructions which execute on the computer or other programmable apparatus provide processes for implementing the functions acts specified in the flowchart and or block diagram block or blocks.

With reference now to the figures and in particular with reference to diagrams of data processing environments are provided in which illustrative embodiments may be implemented. It should be appreciated that are only meant as examples and are not intended to assert or imply any limitation with regard to the environments in which different embodiments may be implemented. Many modifications to the depicted environments may be made.

In the depicted example server and server connect to network along with storage . Server and server may be for example server computers with high speed connections to network . In addition server and or server may provide one or more services to applications located on client devices connected to network . For example server may provide banking services to associated banking applications running on the client devices. Also server may provide for example a map service to the client devices.

Clients and also connect to network . Clients and are clients to server and or server . In the depicted example server and or server may provide information such as boot files operating system images and applications to clients and . Users of clients and utilize clients and to access the services provided by server and or server .

Clients and may be for example mobile data processing systems such as cellular telephones smart phones personal digital assistants gaming devices or handheld computers with wireless communication links to network . In addition clients and may be personal computers network computers and or portable computers such as laptop computers with wire and or wireless communication links to network . It should be noted that clients and may represent any combination of computers and mobile data processing systems connected to network .

Storage is a network storage device capable of storing data in a structured or unstructured format. Storage may provide for example storage of names and identification numbers of a plurality of users account information associated with each of the plurality of users applications installed on data processing systems associated with each of the plurality of users and user history data for each of the plurality of users that may include services accessed by each of the plurality of users. Storage also may store a plurality of different types of applications used to access a plurality of different types of network services. Furthermore storage unit may store other data such as authentication or credential data that may include user names passwords and or biometric data associated with each of the plurality of users.

Also it should be noted that network data processing system may include any number of additional server devices client devices and other devices not shown. Program code located in network data processing system may be stored on a computer readable storage medium and downloaded to a computer or other data processing device for use. For example program code may be stored on a computer readable storage medium on server and downloaded to client over network for use on client .

In the depicted example network data processing system is the Internet with network representing a worldwide collection of networks and gateways that use the Transmission Control Protocol Internet Protocol TCP IP suite of protocols to communicate with one another. At the heart of the Internet is a backbone of high speed data communication lines between major nodes or host computers consisting of thousands of commercial governmental educational and other computer systems that route data and messages. Of course network data processing system also may be implemented as a number of different types of networks such as for example an intranet a local area network LAN or a wide area network WAN . is intended as an example and not as an architectural limitation for the different illustrative embodiments.

With reference now to a diagram of a data processing system is depicted in accordance with an illustrative embodiment. Data processing system is an example of a mobile data processing device such as client in in which computer readable program code or instructions implementing processes of illustrative embodiments may be located. In this illustrative example data processing system includes communications fabric which provides communications between processor unit memory persistent storage imaging unit geolocation unit communications unit input output I O unit and display .

Processor unit serves to execute instructions for software applications or programs that may be loaded into memory . Processor unit may be a set of one or more processors or may be a multi processor core depending on the particular implementation. Further processor unit may be implemented using one or more heterogeneous processor systems in which a main processor is present with secondary processors on a single chip. As another illustrative example processor unit may be a symmetric multi processor system containing multiple processors of the same type.

Memory and persistent storage are examples of computer readable storage devices . A computer readable storage device is any piece of hardware that is capable of storing information such as for example without limitation data computer readable program code in functional form and or other suitable information either on a transient basis and or a persistent basis. Further a computer readable storage device does not include a propagation medium. Memory in these examples may be for example a random access memory or any other suitable volatile or non volatile storage device. Persistent storage may take various forms depending on the particular implementation. For example persistent storage may contain one or more devices. For example persistent storage may be a hard drive a flash memory a rewritable optical disk a rewritable magnetic tape or some combination of the above. The media used by persistent storage may be removable. For example a removable hard drive may be used for persistent storage .

In this example persistent storage stores user data hybrid mobile application and information flow control IFC module . However it should be noted that persistent storage may store any type of application module and data utilized by the different illustrative embodiments. User data may be any data such as for example one or more lists of personal contacts and email addresses input by a user of data processing system that the user wants to keep as private or secure data.

Hybrid mobile application is a software application developed to access one or more network services by data processing system and consume user data to perform their functionality. For example hybrid mobile application may be a hybrid mobile banking application developed to access banking services provided by a network banking server device such as server in which is associated with hybrid mobile application . Hybrid mobile application may further access a geolocation of data processing system to show a map of the location provided by a network map service server device such as server in which also is associated with hybrid mobile application . Hybrid mobile application is a software application that was developed as a web application i.e. developed using web technologies but is hosted on data processing system as a native application. A web application is a software application coded in a browser supported programming language such as JavaScript . JavaScript is a trademark of the Oracle Corporation. A native application is a software application developed for a particular mobile data processing device. In other words hybrid mobile application combines benefits of web and native applications.

In this example hybrid mobile application includes manifest application chunk specification and code chunks . Manifest lists the data permission and access requirements of hybrid mobile application . A developer of hybrid mobile application creates and defines application chunk specification . Application chunk specification is a specification that lists a set of one or more code chunks within hybrid mobile application . A code chunk is the smallest segment of code on which a security policy may be administered. The developer defines a code chunk based on what information or data the code chunk has access to within data processing system and what external entity the code chunk is permitted to communicate with.

Application chunk specification lists all external communications of code chunks within hybrid mobile application and the secure resources of data processing system shared with the external entities. A secure resource of data processing system may be for example user data image data generated by imaging unit geolocation data generated by geolocation unit and or a number of network connections established by communications unit .

An external entity may be for example a network server such as server in which provides a service to hybrid mobile application installed on data processing system . For example a hybrid mobile social networking application installed on data processing system may communicate with a network server associated with news.com to receive a news feed for the user of data processing system . Each code chunk in code chunks contains a safe object or a safe subset of JavaScript that has direct application programming interface API calls to the secure resources of data processing system removed. In other words each code chunk cannot directly access a secure resource of data processing system but instead must utilize a custom information flow control application programming interface included within information flow control module .

Information flow control module is a software program that controls the access to the secure resources of data processing system by all hybrid mobile applications running on data processing system . In this example information flow control module includes context aware security policies custom information flow control application programming interfaces and secure resource access monitor . Context aware security policies are a set of security policies that define permissions granted to external entities to access the secure resources of data processing system .

A user of data processing system defines context aware security policies and grants the permissions to access the secure resources of data processing system by the external entities. The permissions grant access to share the secure resources with the external entities based on a context or a set of specified conditions that may exist during run time of any of the hybrid mobile applications installed on data processing system . The specified conditions may be for example at least one of a current geographic location of the data processing system an identity of the external entity associated with hybrid mobile application and an access control threshold value associated with the secure resource. As used herein the phrase at least one of when used with a list of items means different combinations of one or more of the listed items may be used and only one of each item in the list may be needed. For example at least one of item A item B and item C may include without limitation item A item A and item B or item B. This example also may include item A item B and item C or item B and item C. The item may be a particular object thing or a category. In other words at least one of means any combination of items and number of items may be used from the list but not all of the items in the list are required.

Information flow control module requires that only custom information flow control application programming interfaces are to be used to call the secure resources of data processing system . Custom information flow control application programming interfaces prevent malicious or accidental damage or intrusion to the secure resources of data processing system . Thus information flow control module controls and protects the sharing of a set of one or more secure resources of data processing system with a set of one or more external entities associated with hybrid mobile application . Secure resource access monitor monitors and tracks secure resource access statistics . Secure resource access statistics list the number of accesses to each secure resource in data processing system by each external entity.

Access control threshold values list a maximum number of accesses to each secure resource of data processing system by an external entity possibly within a particular timeframe. The user of data processing system defines access control threshold values . Information flow control module utilizes access control threshold values to limit the number of accesses to a secure resource in data processing system by a particular external entity.

Imaging unit may be for example a camera embedded in or coupled to data processing system . Imaging unit is capable of taking still photographs and or video clips. Geolocation unit may be for example a global positioning system GPS transceiver unit. Geolocation unit is capable of determining a current geographic position of data processing system .

Communications unit in this example provides for communication with other data processing systems and computing devices. Communications unit may provide communications through the use of either or both physical and wireless communications links. The physical communications link may utilize for example a wire cable universal serial bus or any other physical technology to establish a physical communications link for data processing system . The wireless communications link may utilize for example shortwave high frequency ultra high frequency microwave wireless fidelity Wi Fi bluetooth technology global system for mobile communications GSM code division multiple access CDMA second generation 2G third generation 3G fourth generation 4G or any other wireless communication technology or standard to establish a wireless communications link for data processing system .

Input output unit allows for the input and output of data with other devices that may be connected to data processing system . For example input output unit may provide a connection for user input through a keypad a keyboard a mouse and or some other suitable input device. Display provides a mechanism to display information to a user. In addition display may provide touch screen capabilities.

Instructions for the operating system applications and or programs may be located in storage devices which are in communication with processor unit through communications fabric . In this illustrative example the instructions are in a functional form on persistent storage . These instructions may be loaded into memory for running by processor unit . The processes of the different embodiments may be performed by processor unit using computer implemented instructions which may be located in a memory such as memory . These instructions are referred to as program code computer usable program code or computer readable program code that may be read and run by a processor in processor unit . The program code in the different embodiments may be embodied on different physical computer readable storage devices such as memory or persistent storage .

Program code is located in a functional form on computer readable media that is selectively removable and may be loaded onto or transferred to data processing system for running by processor unit . Program code and computer readable media form computer program product . In one example computer readable media may be computer readable storage media or computer readable signal media . Computer readable storage media may include for example an optical or magnetic disc that is inserted or placed into a drive or other device that is part of persistent storage for transfer onto a storage device such as a hard drive that is part of persistent storage . Computer readable storage media also may take the form of a persistent storage such as a hard drive a thumb drive or a flash memory that is connected to data processing system . In some instances computer readable storage media may not be removable from data processing system .

Alternatively program code may be transferred to data processing system using computer readable signal media . Computer readable signal media may be for example a propagated data signal containing program code . For example computer readable signal media may be an electro magnetic signal an optical signal and or any other suitable type of signal. These signals may be transmitted over communication links such as wireless communication links an optical fiber cable a coaxial cable a wire and or any other suitable type of communications link. In other words the communications link and or the connection may be physical or wireless in the illustrative examples. The computer readable media also may take the form of non tangible media such as communication links or wireless transmissions containing the program code.

In some illustrative embodiments program code may be downloaded over a network to persistent storage from another device or data processing system through computer readable signal media for use within data processing system . For instance program code stored in a computer readable storage media in a server data processing system may be downloaded over a network from the server to data processing system . The data processing system providing program code may be a server computer a client computer or some other device capable of storing and transmitting program code .

The different components illustrated for data processing system are not meant to provide architectural limitations to the manner in which different embodiments may be implemented. The different illustrative embodiments may be implemented in a data processing system including components in addition to or in place of those illustrated for data processing system . Other components shown in can be varied from the illustrative examples shown. The different embodiments may be implemented using any hardware device or system capable of executing program code. As one example data processing system may include organic components integrated with inorganic components and or may be comprised entirely of organic components excluding a human being. For example a storage device may be comprised of an organic semiconductor.

As another example a computer readable storage device in data processing system is any hardware apparatus that may store data. Memory persistent storage and computer readable storage media are examples of physical storage devices in a tangible form.

In another example a bus system may be used to implement communications fabric and may be comprised of one or more buses such as a system bus or an input output bus. Of course the bus system may be implemented using any suitable type of architecture that provides for a transfer of data between different components or devices attached to the bus system. Additionally a communications unit may include one or more devices used to transmit and receive data such as a modem or a network adapter. Further a memory may be for example memory or a cache such as found in an interface and memory controller hub that may be present in communications fabric .

In the course of developing illustrative embodiments it was discovered that most mobile operating systems use a capability based permission model that mediates applications access to secure mobile device resources such as image data generated by a camera of the mobile device or contact list data input by a user of the mobile device. Mobile operating systems vary in the way permissions are granted to the secure resources. For example in one mobile operating system type users approve the permissions granted to an application at install time whereas in another operating system type such user approval of permissions granted to an application is performed when the application is first used.

The capability based permission model is coarse grained and lacks flexibility to support rich security policies. For example the capability based permission model does not allow conditional policies such as location based policies to control permissions. Moreover the granted permissions cannot be modified at runtime of an application and require a reinstallation of the application to include any changes to the granted permissions. In addition the capability based permission model only provides access control over the secure mobile device resources by explicitly releasing corresponding capabilities to the applications. However static access control policies are not sufficient to enforce the privacy of a user. For example once an application is granted access to secure data the application is free to leak this secure data at anytime to a malicious external entity. Further no provision exits to grant or revoke permissions based on the context of the hybrid mobile application or the mobile device. For example permissions cannot be customized to limit an application s access to the mobile device s camera based on the location of the mobile device.

Illustrative embodiments protect the secure resources of the mobile device from leaks by untrusted i.e. malicious or vulnerable hybrid mobile applications. Illustrative embodiments protect the secure resources of a mobile device by utilizing a mobile information flow control IFC module that leverages the mediation layer of the hybrid platform to support runtime enforcement of context aware security policies associated with hybrid mobile applications. The mobile information flow control module allows the user to define the context aware security policies for protection of the secure resources of the mobile device while at the same time enabling hybrid mobile applications to be more specific about their permission requirements. For example the user may specify context based security policies such as camera pictures taken while the mobile device is located at a specified work location should only be shared with a company s server. In addition the hybrid mobile applications also may specify a finer grained permission requirement such as camera pictures are only shared with a specified photo editing software program. 

For supporting fine grain security policy enforcement the mobile information flow control module of illustrative embodiments provides tracking of information flow of the hybrid mobile applications. The mobile information flow control module redesigns the untrusted hybrid mobile applications in such a way that the untrusted hybrid mobile applications have access to any secure data requested by the untrusted hybrid mobile applications by utilizing user granted permissions thus allowing the untrusted hybrid mobile applications to perform their functionality and at the same time not allowing the untrusted hybrid mobile applications to pass the secure data to an unauthorized external entity. The mobile information flow control module achieves this by splitting the untrusted hybrid mobile applications into chunks of code along security relevant boundaries and mapping user granted permissions to each of the individual code chunks. This code chunk design forces the untrusted hybrid mobile applications into making any secure data sharing with external entities explicit to user granted permissions. In addition this code chunk design only allows communications with external entities that satisfy user defined context aware policies or communications that are explicitly granted by the user.

To enable the context aware security policies the mobile information flow control module determines the context of the mobile device and or the hybrid mobile application at runtime when secure resource access is requested by the hybrid mobile application. The mobile information flow control module grants permission to share a secure resource with an external entity based on the determined context. For location based security policies as an example the mobile information flow control module utilizes a custom information flow control geolocation application programming interface of the hybrid platform to determine the current geographic location of the mobile device before retrieving the associated context aware security policies. By utilizing custom information flow control application programming interfaces illustrative embodiments do not require modification of the underlying native mobile operating system.

Thus the mobile information flow control module prevents hybrid mobile applications from leaking secure data on a mobile device. The mobile information flow control module prevents secure data leaks by mediating all communication to and from the hybrid mobile applications at runtime enabling users to administer context aware security policies that satisfy the privacy requirements of the users. Typically hybrid mobile applications utilize services provided by network servers. As a result the hybrid mobile applications need to communicate with external entities to perform specific tasks. For example a hybrid mobile social networking application may seek to utilize a camera application located on a mobile device to take and post a picture of a user of the mobile device to the user s profile on a social networking web site.

When a particular hybrid mobile application is installed on a mobile device the information flow control module presents the user with a manifest that lists what secure resources are needed by the hybrid mobile application and which external entities the secure resources will be shared with. For example the social networking application s manifest would specify that the social networking application will share pictures taken by the mobile device s camera with the social network s server only. In addition to the approval based approach the information flow control module also allows the user to define security policies as functions of secure resources as input external entities as output and mobile device or mobile application context as an associated condition . For example the user may specify that the mobile device s camera should not be available to any mobile application at work thus revoking social networking application s camera access at user s work location.

It should be noted that all external entities are untrusted by default unless the external entities are approved by the user of the mobile device for secure resource sharing. Once approved an external entity is considered semi trusted i.e. the external entity may only receive the secure data for which the external entity was granted permission by the user . Thus illustrative embodiments provide a method data processing system and computer program product for controlling access to secure resources of the data processing system.

With reference now to a diagram of a mobile device is depicted in accordance with an illustrative embodiment. Mobile device may be implemented in for example data processing system in . Also mobile device may be a smart phone for example.

In this example mobile device includes native mobile operating system OS mobile information flow control IFC module and hybrid mobile application . Native mobile operating system is a mobile operating system that is native to mobile device . Native mobile operating system may represent any type of mobile operating system that may run on mobile device . In addition hybrid framework software technology runs on top of native operating system . Hybrid framework software technology represents a set of software programs that supports the execution of hybrid mobile applications installed on mobile device .

Mobile information flow control module may be for example information flow control module in . Mobile information flow control module controls the flow of information in and out of all hybrid mobile applications such as hybrid mobile application running on mobile device . More specifically mobile information flow control module controls the flow of information in and out of a set of code chunks within each of the running hybrid mobile applications. For example mobile information flow control module controls the flow of information through chunk C1 chunk C2 and chunk C3 within hybrid mobile application . Code chunks within hybrid mobile application may be for example code chunks within hybrid mobile application in .

In this example mobile information flow control module includes policy manager policy enforcement engine and custom information flow control application programming interfaces . Policy manager receives from user context aware security policies . User also approves application manifest that is associated with hybrid mobile application before application is installed on user s mobile device . In addition policy manager may verify that user approved application manifest complies with context aware security policies . Context aware security policies may be for example context aware security policies in . Context aware security policies are a set of security policies that define permissions granted by user to external entity bank.com and external entity map.com to access secure resources of mobile device . User approved application manifest is all or a portion of application manifest that user selected as being authorized for external entity communication. Application manifest is a manifest file associated with hybrid mobile application and may be for example manifest in .

Policy manager may display a notification to user for resolution of any selection in user approved application manifest that is non compliant with context aware security policies . Afterward policy manager forwards context aware security policies and user approved application manifest to policy enforcement engine . Policy enforcement engine utilizes context aware security policies and user approved application manifest to enforce information flow control through chunk C1 chunk C2 and chunk C3 within hybrid mobile application . In other words policy enforcement engine utilizes context aware security policies and user approved application manifest to grant permission to particular code chunks within hybrid mobile application to share a set of one or more particular secure resources within mobile device with a particular external entity.

Secure resources may include user data input by user and stored in secure database DB . User data may be for example user data in . In addition secure resources also may include for example image data such as still photographs or video clips generated by a camera in mobile device or geolocation data such as GPS coordinates generated by a geolocation unit in mobile device . The camera and the geolocation unit may be for example imaging unit and geolocation unit in . Further secure resources also may include a network communications unit in mobile device such as communications unit in and a number of network connections established by the network communications unit.

During deployment of hybrid mobile application on mobile device mobile information flow control module removes all direct application programming interface calls to secure resources on mobile device . Thus mobile information flow control module modifies hybrid mobile application to exclude any direct application programming interface calls that provide a direct handle to access secure resources and to invoke the functionality of secure resources . As a result mobile information flow control module requires hybrid mobile application to utilize custom information flow control application programming interfaces of mobile information flow control module to call one or more of secure resources to be shared with external entity and or external entity . Custom information flow control application programming interfaces may be made available as for example an add on library and packaged into mobile information flow control module to be made available to hybrid mobile application code at runtime. Using custom information flow control application programming interfaces as an add on library minimizes the complexity of code changes a developer is required to make to hybrid mobile application . Also custom information flow control application programming interfaces support unidirectional and bidirectional communication between chunk C1 chunk C2 and chunk C3 within hybrid mobile application .

In the example of hybrid mobile application represents a hybrid mobile banking application to show how context aware security policies may be defined and enforced in mobile information flow control module to prevent hybrid mobile application from leaking secure user data . Context aware security policies are expressed via user granted permissions along with other security policies such as enterprise based security policies which are enforced at runtime of hybrid mobile application by mobile information flow control module .

It should be noted that while context aware security policies may allow user of mobile device to enforce privacy requirements of user and potentially prevent malicious behavior of hybrid mobile application illustrative embodiments anticipate that tradeoffs may arise such as for example certain security policy requirements may prevent malicious behavior by hybrid mobile application but also may disrupt the functionality of non malicious behavior of other hybrid mobile applications running on mobile device . Consequently user must make security policy decisions based on the specific privacy requirements of user and or the security restrictions imposed by an enterprise associated with user .

User approved application manifest provides finer grained user granted permissions for external entity communication. Specifically user approved application manifest provides an input to output mapping that represents what set of secure resources is to be shared with which external entity. Using the hybrid mobile banking application example this input to output mapping would correspond to mapping login credential data of user to external entity bank.com and mapping geolocation data of mobile device to external entity map.com.

Context aware security policies may address conditional use of secure resources by the hybrid mobile banking application. The conditional use may be a derivative of the state of mobile device such as for example the current GPS coordinates of mobile device or the time of day. As an example of a situation where granted permissions depend on context consider a scenario where a governmental agency such as the Department of Defense wants to impose a conditional requirement of No images are to be captured at the Pentagon. This conditional requirement maps to the context aware security policy If the current geographic location of mobile device corresponds to the Pentagon s location coordinates then a hybrid mobile application s camera capture capability is disabled. This is an example of a negative context aware condition i.e. do not allow access to the secure resource e.g. camera capture capability of mobile device when the condition exists . However it should be noted that illustrative embodiments also utilize positive context aware conditions i.e. allow access to the secure resource of mobile device when the condition exists . For example if the current geographic location of mobile device corresponds to the GPS coordinates of a company that employs the user of mobile device then a hybrid mobile application s functionality associated with the company may be enabled for access and use by the user.

Mobile information flow control module ensures that the camera is only activated when the current geolocation of mobile device is in a certain state. To address such a scenario mobile information flow control module restricts the hybrid mobile application to access the camera of mobile device only through custom information flow control application programming interfaces . Mobile information flow control module utilizes custom information flow control application programming interfaces to resolve the required context to determine the current geographic location of mobile device and to ensure that the camera is only activated in accordance with the appropriate context aware security policy.

Further mobile information flow control module may utilize usage based security policies to prevent or limit any malicious damage by a hybrid mobile application by limiting the usage of or access to secure resources . One example of a usage based security policy may be that a hybrid mobile application is not granted permission to send more than one hundred short message service SMS messages per day. Another example may be that a hybrid mobile application is not granted permission to establish more than five network connections at the same time.

In other words the usage based requirements for various secure resources which a hybrid mobile application is requesting must be explicitly specified in security policies. If the requested number is more than a maximum number specified by the security policies user would have to explicitly provide such an exception. User may rely on a number of factors to make such an exception decision such as the reputation of the external entities to which network connections are being made the previous track record of the developer of the hybrid mobile application et cetera. As a result context aware security policies ensure that the permissions are fail safe where the minimum permissions are initially provided and all exceptions to these permissions are explicitly approved by user .

For usage based security policies mobile information flow control module utilizes a monitor such as secure resource access monitor in to keep statistics on access to or usage of secure resources such as the number of network connections made by a network communications device in mobile device and to prevent access to or usage of secure resources once a pre defined access control threshold value such as access control threshold values in is reached or exceeded. For context aware security policies mobile information flow control module analyzes the input data security policy to resolve any unknown contexts before verifying the contexts against a specified condition in a particular context aware security policy. For conditional location based security policies as an example mobile information flow control module determines a current geographic location of mobile device before checking the associated specified condition. It should be noted that mobile information flow control module runs within the trust domain of mobile device so mobile information flow control module is privileged with all the necessary permissions to determine contexts by utilizing the sensors of mobile device .

Code chunks of hybrid mobile application encapsulate different levels of private information associated with user . Therefore mobile information flow control module isolates code chunks from each other in order to prevent private information leaks. In addition mobile information flow control module maintains a mapping between permissions and the corresponding custom information flow control application programming interfaces that require these permissions.

With reference now to a diagram illustrating a lifecycle of a hybrid mobile application is depicted in accordance with an illustrative embodiment. Hybrid mobile application lifecycle represents an example of a typical lifecycle of a hybrid mobile application such as hybrid mobile application in in accordance with illustrative embodiments. Hybrid mobile application lifecycle includes user registration with mobile information flow controller on mobile device hybrid mobile application deployment on mobile information flow controller and hybrid mobile application installation on mobile device by user .

The user performs user registration with a mobile information flow controller on a mobile device at . During user registration at the user defines context aware security policies at . For example user defines context aware security policies and registers context aware security policies with policy manager within mobile information flow control module in . When the user defines context aware security policies the user may specify for example that the contact list of the user should never be shared with any external entity.

At hybrid mobile application deployment the application developer defines a hybrid mobile application chunk specification at such as application chunk specification in . The hybrid mobile application chunk specification includes a listing of code chunks with associated secure resources and external entity communication . In this example code chunks includes code chunks C1 C2 and C3 such as chunk C1 chunk C2 and chunk C3 in . Secure resources include login credential data input by a user of a mobile device and image data generated by an imaging unit in the mobile device which are associated with code chunk C1 geolocation data generated by a geolocation unit in the mobile device which is associated with code chunk C2 and contact list data input by the user which is associated with code chunk C3. External entity communication lists which external entities are granted permission to share one or more of secure resources . External entity communication includes bank.com which is associated with code chunk C1 that is granted permission to share the login credential data and the image data with bank.com. External entity communication also includes map.com which is associated with code chunk C2 that is granted permission to share the geolocation data with map.com. Code chunk C3 is not granted permission to share the contact list data with any external entity. The hybrid mobile application chunk specification is sent to the mobile information flow control module at installation of the hybrid mobile application on the mobile device at . The mobile information flow control module utilizes the information within the chunk specification to generate a manifest file such as manifest in for the hybrid mobile application.

At hybrid mobile application installation a hybrid mobile application manifest is displayed to the user at installation by the mobile information flow control module at . As illustrated in this example the manifest is basically a specification of the hybrid mobile application s external entity communications irrespective of the code chunks along with the secure resources that are shared during each external entity communication. The user of the mobile device approves the manifest such as user approved application manifest in prior to installation of the hybrid mobile application on the mobile device. The user selects which external entity communications are permitted in the manifest at .

Additionally the mobile information flow control module ensures that all of the code chunks within the hybrid mobile application comply with the user defined context aware security policies and the manifest approved by the user. For any context aware security policies the mobile information flow control module determines the context at runtime and verifies specified conditions associated with the context aware security policies before granting any access to a set of secure resources on the mobile device. Chunk labels are used by the mobile information flow control module to enforce the user defined context aware security policies on the installed hybrid mobile application in the mobile device at .

With reference now to a diagram illustrating an example of controlling the flow of information used by a hybrid application is depicted in accordance with an illustrative embodiment. Controlled information flow represents the flow of data and information through a hybrid mobile application running on a mobile device such as mobile device in .

Data input from mobile information flow controller to a specified code chunk in a particular hybrid mobile application represents the flow of data into code chunks of hybrid mobile application . Information displayed to a user of a mobile device represents the flow of information received by code chunks from external entities that is to be displayed on a display of the mobile device.

To satisfy the user s privacy requirements using the hybrid mobile banking application example from above two conditions should be met 1 no bank account information is to be shared with map.com and 2 the contact list data is to be kept private i.e. not shared with any external entity . Splitting hybrid mobile application into multiple code chunks such as code chunk C1 code chunk C2 and code chunk C3 allows the application developer to segment functionality within hybrid mobile application that relies on different secure resources within the mobile device. A mobile information flow control module such as mobile information flow control module in in the mobile device splits hybrid mobile application into three code chunks for example based on at least one of a chunk specification of hybrid mobile application created by the developer and a set of context aware security policies associated with hybrid mobile application created by the user. Splitting hybrid mobile application into different code chunks exposes the security relevant information flows within hybrid mobile application . A code chunk represents a segment of code that is uniquely identified by the input data into a particular code chunk and the external entities the particular code chunk needs to communicate with. For example code chunk C2 takes in geolocation data as the input data and communicates geolocation data to external entity map.com.

In this example code chunk C1 only communicates with external entity bank.com and accesses login credentials and image data . The login credential data may be for example a user identification and password. External entity bank.com verifies the login credentials prior to sending any information to the mobile device. The image data may be for example an image of a check generated by a camera of the mobile device. After receiving login credentials and image data external entity bank.com sends account information to code chunk C1. Account information may be for example bank account balances associated with the user.

Code chunk C2 has no access to any bank associated data but shares with external entity map.com geolocation data . Geolocation data is the current geographic location of the mobile device generated by a geolocation unit located in the mobile device. Using geolocation data external entity map.com sends map information to code chunk C2. Map information may be for example bank locations nearest to the current geographic position of the mobile device.

Hybrid mobile application also may want to access contact list data i.e. a secure resource of the user of the mobile device to facilitate selection of recipients for person to person payments. However in this example contact list data is not shared with any external entity. In other words code chunk C3 has access to contact list data but the user of the mobile device has not granted code chunk C3 permission to communicate or share the contact list with any external entity.

Because code chunk C2 is only granted access to geolocation data this is the only data code chunk C2 may communicate to an external entity such as external entity map.com. Moreover code chunk C2 is restricted to communicating only with external entity map.com. It should be noted that data and information may flow from a less restricted code chunk to a more restricted code chunk thereby allowing one way communication between code chunks. For example code chunk C2 may pass to code chunk C1 the user s selection of a bank branch location on map information . Code chunk C1 may then use the selection of the bank branch location to show information associated with that bank branch. Because code chunk C3 cannot communicate with any external entity code chunk C3 cannot leak any secure data outside the mobile device. This external entity communication restriction enables code chunk C3 to receive any secure data from other code chunks as well as any other secure user data in addition to contact list data .

Also it should be noted that the user of the mobile device can decide not to share geolocation data with external entity map.com by not selecting that portion of the manifest associated with that particular external entity communication. Not selecting that particular external entity communication to share geolocation data would not impact the core banking functionality of hybrid mobile application and may only partially impact the overall experience of the user.

With reference now to an illustration of a specific example of a manifest for a hybrid mobile banking application deployed on a mobile information flow control module in a mobile device is depicted in accordance with an illustrative embodiment. Example manifest for a hybrid mobile banking application deployed on a mobile information flow controller may be for example user approved application manifest deployed on mobile information flow control module in . Example manifest for a hybrid mobile banking application deployed on a mobile information flow controller specifies each requested communication between each code chunk in the set of code chunks within the hybrid mobile application and a respective external entity that a particular code chunk wants to communicate with and also specifies the secure resource that will be shared with the respective external entity.

For example example manifest for a hybrid mobile banking application lists chunk name C1 with inputs of permission name permission.CAMERA and data name credentials and an output of external entity name bank.com chunk name C2 with an input of permission name permission.ACCESS COARSE LOCATION and an output of external entity name map.com and chunk name C3 with an input of permission name permission.READ CONTACTS and no specified output.

With reference now to an illustration of a specific example of a user defined context aware policy within a mobile information control module in a mobile device is depicted in accordance with an illustrative embodiment. Example context aware security policy in a mobile information flow controller may be for example one of context aware security policies in mobile information flow control module in . Example context aware security policy in a mobile information flow controller defines a particular condition under which permission to access a secure resource of the mobile device is either granted or denied.

For example example context aware security policy lists a condition name worklocation with a value geolocation of specified latitude and longitude coordinates and a permission name permission.CAMERA with a condition worklocation and a condition match deny . In other words example context aware security policy denies permission to the camera to take images when the current geographic location of the mobile device is at the specified work location coordinates.

With reference now to a flowchart illustrating a process for controlling access to secure resources of a data processing system is shown in accordance with an illustrative embodiment. The process shown in may be implemented in a data processing system such as for example data processing system in .

The process begins when the data processing system generates an input to output mapping of a hybrid mobile application installed on the data processing system that determines whether a secure resource in the data processing system is shared with an external entity associated with the hybrid mobile application and under what specified conditions step . The hybrid mobile application installed on the data processing system may be for example hybrid mobile application installed on mobile device in . The secure resource in the data processing system that is shared with the external entity associated with the hybrid mobile application may be for example a secure resource in secure resources in mobile device that is shared with external entity bank.com and or external entity map.com in .

The specified conditions may be for example at least one of a current geographic location of the data processing system an identity of the external entity and an access control threshold value associated with the secure resource. The specified conditions may be listed in for example one or more context aware security policies such as context aware security policies in . The current geographic location of the data processing system may be determined using for example a geolocation sensor such as geolocation unit in in the data processing system. However it should be noted that the data processing system may utilize any sensor associated with the data processing system to determine whether a specified condition exists or not. The identity of the external entity may be determined using for example an internet protocol address a media access control address a web address a universal resource locator a port number or any other network identifier. The access control threshold value may be for example one of the access control threshold values in access control threshold values in .

Subsequently the data processing system detects whether the specified conditions exist during runtime of the hybrid mobile application on the data processing system step . Afterward the data processing system makes a determination as to whether the specified conditions exist during runtime of the hybrid mobile application step . If the data processing system determines that the specified conditions do not exist during runtime of the hybrid mobile application no output of step then the data processing system prevents sharing of the secure resource of the data processing system with the external entity associated with the hybrid mobile application step . Thereafter the process returns to step where the data processing system continues to detect whether the specified conditions exist. If the data processing system determines that the specified conditions do exist during runtime of the hybrid mobile application yes output of step then the data processing system allows sharing of the secure resource of the data processing system with the external entity associated with the hybrid mobile application step .

In addition the data processing system monitors a number of accesses sharing the secure resource of the data processing system with the external entity associated with the hybrid mobile application step . The data processing system may utilize a monitor such as secure resource access monitor in to determine the number of accesses to share secure resources of the data processing system. Further the data processing system makes a determination as to whether the number of accesses sharing the secure resource of the data processing system exceeded an access control threshold value corresponding to the secure resource step . The access control threshold value may be for example one of the access control threshold values in access control threshold values in . If the data processing system determines that the number of accesses sharing the secure resource of the data processing system does not exceed the access control threshold value corresponding to the secure resource no output of step then the process returns to step where the data processing system continues to detect whether the specified conditions exist during runtime of the hybrid mobile application. If the data processing system determines that the number of accesses sharing the secure resource of the data processing system does exceed the access control threshold value corresponding to the secure resource yes output of step then the data processing system terminates the sharing of the secure resource of the data processing system with the external entity associated with the hybrid mobile application step . The process terminates thereafter.

With reference now to and a flowchart illustrating a process for installing a hybrid mobile application on a data processing system is shown in accordance with an illustrative embodiment. The process shown in may be implemented in a data processing system such as for example data processing system in .

The process begins when the data processing system receives a chunk specification defined by an application developer. The chunk specification may be for example hybrid mobile application chunk specification in . The chunk specification specifies a set of code chunks such as code chunks in within a hybrid mobile application deployed on the data processing system. Each particular code chunk is associated with a particular set of one or more secure resources of the data processing system that the particular code chunk has access to and a particular external entity that the particular code chunk has been granted permission to communicate with step . The set of secure resources may be for example secure resources in . The granted external entity communication may be for example external entity communication in .

In addition the data processing system receives a set of context aware security policies defined by a user of the data processing system that is associated with the hybrid mobile application deployed on the data processing system and defines particular conditions under which permission to access secure resources of the data processing system are either granted or denied step . The context aware security policies may be for example context aware security policies defined by user in . Then the data processing system splits the hybrid mobile application deployed on the data processing system into the set of code chunks based on at least one of the chunk specification and the set of context aware security policies step . Further the data processing system removes direct application programming interface calls by the hybrid mobile application to the secure resources of the data processing system step .

Subsequently the data processing system receives an input to install the hybrid application on the data processing system step . Afterward the data processing system generates a manifest file associated with the hybrid mobile application that specifies each requested communication between each code chunk in the set of code chunks within the hybrid mobile application and a respective external entity that a particular code chunk wants to communicate with and also specifies the secure resource that will be shared with the respective external entity based on the chunk specification step . The manifest may be for example manifest in . Then the data processing system displays the manifest file in a display such as display in associated with the data processing system step .

Subsequently the data processing system receives selections granting permission to a set of requested communications between code chunks within the hybrid mobile application and respective external entities specified in the manifest file step . Afterward the data processing system installs the hybrid application on the data processing system step . Then the data processing system verifies that the selections granting permission to the set of requested communications complies with the set of context aware security policies step .

In addition the data processing system notifies a user of the data processing system of any non compliant selections granting permission to the set of requested communications step . Furthermore the data processing system requires the set of code chunks within the hybrid mobile application accessing the secure resources of the data processing system to utilize a set of custom information flow control application programming interfaces located in an information flow control module of the data processing system to enforce the set of context aware security policies step . The set of custom information flow control application programming interfaces located in the information flow control module may be for example custom information flow control application programming interfaces located in mobile information flow control module in . Moreover the data processing system generates a mapping between the set of context aware security policies that grant permission to access the secure resources of the data processing system and the set of custom information flow control application programming interfaces that are required to call the secure resources shared with the external entities step . The process terminates thereafter.

Thus illustrative embodiments provide a method computer program product and mobile data processing device for controlling access to secure resources of the mobile device by hybrid mobile applications running on the mobile device based on user defined context aware security policies. The descriptions of the various illustrative embodiments have been presented for purposes of illustration but are not intended to be exhaustive or limited to the embodiments disclosed. Many modifications and variations will be apparent to those of ordinary skill in the art without departing from the scope and spirit of the described embodiment. The terminology used herein was chosen to best explain the principles of the embodiment the practical application or technical improvement over technologies found in the marketplace or to enable others of ordinary skill in the art to understand the embodiments disclosed here.

The flowchart and block diagrams in the figures illustrate the architecture functionality and operation of possible implementations of computer systems computer implemented methods and computer program products according to various illustrative embodiments. In this regard each block in the flowchart or block diagrams may represent a module segment or portion of code which comprises one or more executable instructions for implementing the specified logical function s . It should also be noted that in some alternative implementations the functions noted in the block may occur out of the order noted in the figures. For example two blocks shown in succession may in fact be executed substantially concurrently or the blocks may sometimes be executed in the reverse order depending upon the functionality involved. It will also be noted that each block of the block diagrams and or flowchart illustration and combinations of blocks in the block diagrams and or flowchart illustration can be implemented by special purpose hardware based systems that perform the specified functions or acts or combinations of special purpose hardware and computer instructions.

