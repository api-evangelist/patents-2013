---

title: Method and system for regulation and control of a multi-core central processing unit
abstract: A method and system for regulation and control of a multi-core CPU includes receiving an operating command associated with regulation and control of the multi-core CPU, responding to the operating command, and performing regulation and control on the CPU cores of the multi-core CPU via a bottom layer core interface according to a preset CPU regulation and control mode. Thereby, a working state of every CPU core of a multi-core CPU is regulated and controlled, processing capability of the multi-core CPU is improved, and energy and electric power are saved.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09600330&OS=09600330&RS=09600330
owner: HUIZHOU TCL MOBILE COMMUNICATION CO., LTD.
number: 09600330
owner_city: Huizhou
owner_country: CN
publication_date: 20130704
---
The present invention relates to the computer field and in particular to a method and system for regulation and control of multi core central processing unit CPU .

It has become a trend for Android based mobile devices such as smart phones and tablet computers to use dual core and quad core processors. As a multi core CPU has certain advantages in regard to processing capabilities applications of a multi core CPU on mobile devices are increasingly extensive. While a multi core CPU improves performance of mobile devices to a certain degree availability of electrical power in mobile devices is increasingly a bottleneck.

Android multi core smart phones schedule processes to multiple cores of the multi core CPU according to a load balancing mechanism . With such a load balancing mechanism however multiple cores of a multi core CPU are always in an operating mode even when a mobile phone is in an idle or low power state. As a result electric energy that has already been in short supply is wasted in great quantities. When a mobile phone is in an idle or low power state a user may pay more attention to how to save power rather than to an improvement of mobile phone performance. When a mobile phone has sufficient power a user may want to improve mobile phone performance using processing capability of a multi core CPU. However available mobile devices cannot perform regulation and control on a multi core CPU based on a user s needs.

In light of the above shortcomings of the prior art a method and system is provided for regulation and control of a multi core CPU which is intended to solve the problem of the prior art that multi core CPU cannot be regulated and controlled based on a user s needs.

A method for regulation and control of a multi core CPU includes receiving an operating command associated with regulation and control of the multi core CPU responding to the operating command and performing regulation and control on CPU cores of the multi core CPU via a bottom layer core interface according to a preset CPU regulation and control mode the CPU regulation and control mode comprising at least one of regulating a number of CPU cores that are turned on regulating an operating frequency of the CPU cores migrating processes of the CPU cores and controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU by calling a subsystem of the multi core CPU.

In another embodiment of a method for regulation and control of a multi core CPU a CPU regulation and control mode includes a first regulation and control mode and a second regulation and control mode the first regulation and control mode corresponds to at least one CPU core of a multi core CPU that is turned on and runs in a high frequency state the second regulation and control mode corresponds to one of the CPU cores of the multi core CPU that is turned on and runs in a low frequency state wherein when the CPU regulation and control mode is the first regulation and control mode the method further comprises recording a number of CPU cores used by a process and a time of the CPU cores used by the process and migrating a high frequency process to an idle CPU core for processing and regulating the idle CPU core to the high frequency operating state wherein when the CPU regulation and control mode is the second regulation and control mode the method further comprises recording a number of CPU cores used by a process and a time of the CPU cores used by the process and shutting down the idle CPU cores keeping a CPU core in operation and performing frequency reduction processing on the CPU core in operation.

In a further embodiment of a method for regulation and control of a multi core CPU a CPU regulation and control mode includes a third regulation and control mode when the CPU regulation and control mode is the third regulation and control mode the method comprises acquiring information regarding operating states of CPU cores of a multi core CPU at a predetermined time interval when a utilization of all CPU cores of the multi core CPU is lower than a first predetermined value keeping one of the CPU cores in operation and shutting down other CPU cores and performing frequency reduction processing on the CPU core in operation when a utilization of the CPU cores in operation is greater than a second predetermined value turning on all CPU cores and maintaining a balance of a utilization of the CPU cores of the multi core CPU by migrating processes.

In yet another embodiment of a method for regulation and control of a multi core CPU controlling switching frequency modulation and process migration of CPU cores of a multi core CPU by calling a subsystem of the multi core CPU includes calling a function at a bottom layer or communicating with a bottom layer core via a socket mechanism acquiring a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration and controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU via the function.

In yet a further embodiment a method for regulation and control of a multi core CPU includes receiving an operating command associated with regulation and control of the multi core CPU responding to the operating command and performing regulation and control on CPU cores of the multi core CPU via a bottom layer core interface according to a preset CPU regulation and control mode.

In another embodiment of a method for regulation and control of a multi core CPU a CPU regulation and control mode includes at least one of regulating a number of CPU cores that are turned on regulating an operating frequency of the CPU cores and migrating processes of the CPU cores.

In a further embodiment a CPU regulation and control mode includes a first regulation and control mode and a second regulation and control mode the first regulation and control mode corresponds to at least one of the CPU cores of the multi core CPU that is turned on and runs in a high frequency state the second regulation and control mode corresponds to one of the CPU cores of the multi core CPU that is turned on and runs in a low frequency state.

In yet a further embodiment of a method for regulation and control of a multi core CPU when a CPU regulation and control mode is a first regulation and control mode a method comprises recording a number of CPU cores used by a process and a time of the CPU cores used by the process and migrating a high frequency process to an idle CPU core for processing and regulating the idle CPU core to the high frequency operating state.

In another embodiment of a method for regulation and control of a multi core CPU when a CPU regulation and control mode is a second regulation and control mode a method comprises recording a number of CPU cores used by a process and a time of the CPU cores used by the process and shutting down idle CPU cores keeping a CPU core in operation and performing frequency reduction processing on the CPU core in operation.

In a further embodiment of a method for regulation and control of a multi core CPU a CPU regulation and control mode includes a third regulation and control mode when the CPU regulation and control mode is the third regulation and control mode the method includes acquiring information regarding operating states of CPU cores of a multi core CPU at a predetermined time interval when a utilization of all CPU cores of the multi core CPU is lower than a first predetermined value keeping one of the CPU cores in operation and shutting down other CPU cores and performing frequency reduction processing on the CPU core in operation when a utilization of CPU cores in operation is greater than a second predetermined value turning on all CPU cores and maintaining a balance of a utilization of the CPU cores of the multi core CPU by migrating processes.

In yet a further embodiment of a method for regulation and control of a multi core CPU controlling switching frequency modulation and process migration of CPU cores of a multi core CPU includes calling a subsystem of the multi core CPU.

In another embodiment of a method for regulation and control of a multi core CPU controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU by calling a subsystem of the multi core CPU includes calling a function at a bottom layer or communicating with a bottom layer core via a socket mechanism acquiring a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration and controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU via the function.

In a further embodiment a system for regulation and control of a multi core CPU includes an operating command receiving module for receiving an operating command associated with regulation and control of the multi core CPU and a regulation and control module for responding to the operating command and performing regulation and control on the CPU cores of the multi core CPU via a bottom layer core interface according to a preset CPU regulation and control mode.

In another embodiment a system for regulation and control of a multi core CPU a CPU regulation and control mode includes at least one of regulating a number of CPU cores that are turned on regulating an operating frequency of the CPU cores and migrating processes of the CPU cores.

In a further embodiment of a system for regulation and control of a multi core CPU a CPU regulation and control mode at least includes a first regulation and control mode and a second regulation and control mode the first regulation and control mode corresponds to at least one CPU core of a multi core CPU that is turned on and runs in a high frequency state the second regulation and control mode corresponds to one of CPU core of the multi core CPU that is turned on and runs in a low frequency state.

In yet a further embodiment of a system for regulation and control of a multi core CPU when a CPU regulation and control mode is a first regulation and control mode the regulation and control module is used for recording a number of the CPU cores used by a process and a time of the CPU cores used by the process for migrating a high frequency process to an idle CPU core for processing and for regulating the idle CPU core to the high frequency operating state.

In another embodiment of a system for regulation and control of a multi core CPU when a CPU regulation and control mode is a second regulation and control mode the regulation and control module is used for recording a number of CPU cores used by a process and a time of the CPU cores used by the process for shutting down idle CPU cores and keeping a CPU core in operation and for performing frequency reduction processing on the CPU core in operation.

In a further embodiment of a system for regulation and control of a multi core CPU a CPU regulation and control mode includes a third regulation and control mode when the CPU regulation and control mode is the third regulation and control mode the regulation and control module is used for acquiring information regarding operating states of CPU cores of the multi core CPU at a predetermined time interval and for when a utilization of all CPU cores of the multi core CPU is lower than a first predetermined value keeping one of the CPU cores in operation and shutting down other CPU cores and performing frequency reduction processing on the CPU core in operation moreover the regulation and control module is also used for when a utilization of the CPU cores in operation is greater than a second predetermined value turning on all CPU cores and for maintaining a balance of a utilization of the CPU cores of the multi core CPU by migrating processes.

In yet a further embodiment of a system for regulation and control of a multi core CPU a regulation and control module is used for controlling switching frequency modulation and process migration of CPU cores of the multi core CPU by calling a subsystem of the multi core CPU.

In another embodiment of a system for regulation and control of a multi core CPU a regulation and control module includes a native service module for calling a function at a bottom layer or communicating with a bottom layer core via a socket mechanism an acquisition module for acquiring a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration and a control module for controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU via the function.

In a further embodiment a working state of every CPU core of a multi core CPU is regulated and controlled and a processing capability of the multi core CPU is improved or a goal of saving energy and electric power is attained.

A method and system for regulation and control of a multi core CPU is described in detail below. It should be understood that specific embodiments described herein are for illustrative purposes only and are not intended to limit the scope of the appended claims in any way. The term multi core CPU as used herein is in reference to a CPU having at least two cores such as a dual core CPU a triple core CPU a quad core CPU etc.

Specific embodiments of methods and systems for regulation and control of a multi core CPU are described with reference to modules blocks of computer readable instructions and symbols of operations executed by one or more computers mobile devices unless otherwise stated. These modules blocks of computer readable instructions and operations shall be understood wherein execution by a computer mobile device is mentioned several times including manipulation by a computer mobile device processing unit as being representative of electronic signals of data in a structured type. Manipulation of data may convert data or may keep data at particular positions in a memory system of a computer mobile device which can be reconfigured or otherwise changed in a way familiar to those skilled in the art of operations of a computer mobile device. The term data structure as used herein may be in reference to a structure maintained by data within a physical position of a memory which may possess specific properties defined by a data format. However it should be understood that a variety of modules and operations described below may be implemented in hardware e.g. a discrete circuit an analog circuit an application specific integrated circuit etc. .

Principles of the present invention may employ many computations communication environments and or configurations for other general or specific purposes in the disclosed operations. Examples of computing systems environments or configurations applicable for embodiments of the present invention may include but are not limited to tablet computers mobile phones personal computers servers multi processor systems systems primarily with microcomputers mainframe computers and distributed computing environment and any of the above systems or devices as included herein.

The term of module or unit used herein may be a software object or routine executed on a computing system. Various components modules engines and services described herein may be implemented as objects or processes executed on a computing system. While the systems and methods described herein may be implemented as software implementations in a combination of software and hardware and or implementations exclusively in hardware are included within the scope of the present invention.

A method and system for regulation and control of a multi core CPU may run on a computer mobile device a computer one or more of personal computers servers etc. and the mobile device may be a system formed by one or more tablet computers mobile phones PDAs Personal Digital Assistant laptop computers etc. A computer mobile device may include any combination of processor memory sensor switching element power source clock signal generator input and output apparatus. Any combination of processor memory sensor switching element power source clock signal generator input and or output apparatus in the above computer mobile device may be used to implement a method for regulation and control of a multi core CPU and or functions of a system for regulation and control of a multi core CPU.

Software program commands used to implement a system for regulation and control of a multi core CPU may be stored in a non transitory computer readable memory and may be executed by a processor to realize process management in an operating system.

A memory may be a storage medium that can be read by a computer and the storage medium may be magnetic disc CD Read Only Memory ROM or Random Access Memory RAM .

Turning to a flow chart of a method for regulation and control of a multi core CPU may include receiving an operating command associated with regulation and control of a multi core CPU block S responding to the operating command and performing regulation and control on CPU cores of the multi core CPU via a bottom layer core interface according to a preset CPU regulation and control mode.

A preset CPU regulation and control mode may be generated through presetting a CPU regulation and control mode for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration. The CPU regulation and control mode may include a predefined regulation and control mode and an automatic regulation and control mode.

A CPU regulation and control mode may include at least one of regulating a number of CPU cores that are turned on regulating an operating frequency of the CPU cores and migrating processes of the CPU cores. The CPU regulation and control mode may include at least a first regulation and control mode and a second regulation and control mode the first regulation and control mode may correspond to at least one of the CPU cores of the multi core CPU that is turned on and runs in a high frequency state the second regulation and control mode may correspond to one of the CPU cores of the multi core CPU that is turned on and runs in a low frequency state.

CPU regulation and control modes can be divided into two types predefined regulation and control modes and automatic regulation and control modes. Predefined regulation and control mode may be divided into optimal performance modes and power save modes an optimal performance mode may correspond to a first regulation and control mode and a power save mode may correspond to a second regulation and control mode i.e. an optimal performance mode may indicate that all the CPU cores of a multi core CPU are turned on and are running in a high frequency state and a power save mode may indicate that one CPU core of the multi core CPU is turned on and is running in a low frequency state. These modes will be described in further detail below.

In circumstance where a user s mobile device has sufficient power or can be charged the user may want to use the mobile device to experience some large games or perform frequent online operations. In such processes of mobile device operations or game experiences the user may pay more attention to performance of the mobile device. Therefore an embodiment of the present invention may provide an optimal performance mode of a multi core CPU such that a mobile device maintains its operation at an optimal performance.

When a CPU regulation and control mode is a first regulation and control mode a method for regulation and control of a multi core CPU may include recording a number of CPU cores used by a process and a time of the CPU cores used by the process migrating a high frequency process to an idle CPU core for processing and regulating the idle CPU core to the high frequency operating state. When a CPU regulation and control mode is a second regulation and control mode a method for regulation and control of a multi core CPU may include recording the number of the CPU cores used by the process and the time of the CPU cores used by the process shutting down the idle CPU cores keeping a CPU core in operation and performing frequency reduction processing on the CPU core in operation.

With respect to how to keep a multi core CPU in a state of optimal performance a number of CPU cores used by a process may be recorded through a multi core CPU architecture and a time of the CPU cores used by the process may be recorded using its subsystem CPUACCT a node system in Cgroups that may generate a CPU use state report thereby migrating a high frequency process to an idle CPU core for processing through its subsystem CPUSET a node in Cgroups that may allocate independent CPU and memory to a process according to a number of CPU cores and a time of the CPU cores used by a process and moreover the CPU cores in use may be fixed to run in a high frequency operating state through a subsystem CPUSET such that all CPU cores of the multi core CPU may run and may remain in a high frequency operating state thus making full use of advantage of strong processing capability of multi core CPU and improving user experience in playing games or going online.

In circumstance where a user s mobile device is low in power and cannot be charged the user may only want to use the mobile device for normal communications. Therefore a power save mode may be provided to shut down idle CPU cores and perform frequency reduction processing on a CPU core in use thereby attaining a goal of saving power.

In a power save mode process management may be performed through a multi core CPU architecture for example recording a number of CPU cores used by a process and using a subsystem CPUACCT to record a time of the CPU cores used by the process shutting down idle CPU cores according to the number of the CPU cores and the time of the CPU cores used keeping one CPU core in operation and performing frequency reduction processing on the CPU core in operation within an acceptable range.

In circumstance where a user s mobile device is not low in power and can run normally the user may want the mobile device to trigger automatic regulation and control of CPU cores according to specific situations for example through a specific event. In light of this an automatic regulation and control mode may be provide to regulate and control operations of any given CPU core according to its own use situation.

With reference to a CPU regulation and control mode may include a third regulation and control mode when the CPU regulation and control mode is the third regulation and control mode a method for regulation and control of a multi core CPU may include acquiring information regarding operating states of CPU cores of the multi core CPU at a predetermined time interval block S when a utilization of all CPU cores of the multi core CPU is lower than a first predetermined value keeping one of the CPU cores in operation and shutting down other CPU cores and performing frequency reduction processing on the CPU core in operation. When a utilization of the CPU cores in operation is greater than a second predetermined value turning on all CPU cores block S . Maintaining a balance of a utilization of the CPU cores of the multi core CPU by migrating processes block S . The first predetermined value may be a value in a range of 1 to 50 for example 22 35 43 50 etc. The second predetermined value may be a value in a range of 50 to 99 for example 61 77 89 92 etc.

In an automatic regulation and control mode information regarding operating states of CPU cores of a multi core CPU may be acquired at a predetermined time interval a bottom layer may actively report information regarding an operating state of every CPU core of the multi core CPU through a CPUACCT subsystem at a predetermined time interval then the information regarding the operating state may be reported in a socket message which may be acquired by an automatic regulation and control system. The automatic regulation and control system may automatically issue a regulation and control command according to the acquired information regarding the operating states of the multi core CPU. When a utilization of all CPU cores of the multi core CPU is lower than 20 extra CPU cores may be shut down and one CPU core may be kept in operation and frequency reduction processing may be performed on the CPU core in operation when a utilization of every CPU core of the multi core CPU is lower than 20 a CPUSET subsystem may be used to shut down idle CPU cores and may only keep one CPU core in operation. When a utilization of the CPU core in operation is greater than 90 all CPU cores may be turned on when the utilization of the CPU core in operation is greater than 90 all or some CPU cores may be turned on through CPUSET to increase a processing capability of the mobile device. A balance of a utilization of the multi core CPU may be maintained by regulating process migration. When multiple CPU cores are in operation and when it is found that the utilization of multiple CPU cores of the multi core CPU is not balanced for example the utilization of CPU is 95 while the utilization of CPU is 20 each CPU core of the multi core CPU may be kept balanced through a dynamic process migration operation.

A regulation and control mode of a multi core CPU may encapsulate a Cgroups i.e. a mechanism provided in Linux kernel for limiting isolating and recording physical resources used by a process and physical resources include CPU I O port etc. interface mainly via a bottom layer core interface and may call its subsystem CPUSET to realize control on switching frequency modulation and process migration of CPU cores of the multi core CPU.

Turning to a method for regulation and control mode of a multi core CPU may include controlling switching frequency modulation and process migration of CPU cores of the multi core CPU by calling a subsystem CPUSET of the multi core CPU.

Controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU by calling the subsystem CPUSET of the multi core CPU may include calling a function at a bottom layer or communicating with a bottom layer core via a socket mechanism block S . The method for regulation and control mode of a multi core CPU may include acquiring a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration block . The method for regulation and control mode of a multi core CPU may include controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU via the function.

A method for regulation and control mode of a multi core CPU may include setting up a system service for calling a function at a bottom layer or communicating with a bottom layer core via a socket mechanism this may be mainly a design of a Deamon service system service through Native Service and the Deamon service may be activated by an init root a first process for a Linux kernel activation in an Android system process thereby achieving a remote calling of a function specifically it may directly call a function at a bottom layer or communicate with a bottom layer core via a socket mechanism an inter process communication mechanism .

Calling a Deamon service and providing a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration through the Deamon service a goal is to use Framework to complete a direct connection between a Native Service and a JAVA API Application Programming Interface then complete the calling of the Deamon service through inter process communication and subsequently provide a series of JNI interface functions such as opencpu closecpu etc. opencpu closecpu etc. are self defined function names for opening and closing CPU cores by aiming at an upper layer.

Controlling switching frequency modulation and process migration of CPU cores of a multi core CPU may be implemented through a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration. A JNI interface provided by an API may be used by aiming at an upper layer to complete a CPUControl class the CPUControl class is a self defined class name realize a series of API interfaces for use by an Android apk program and then achieve functions such as opening CPU cores closing CPU cores regulating a CPU frequency and progress migration.

Turning to a system for regulation and control of a multi core CPU may include an operating command receiving module for receiving an operating command associated with regulation and control of the multi core CPU a regulation and control module for responding to the operating command and performing regulation and control on CPU cores of the multi core CPU via a bottom layer core interface according to a preset CPU regulation and control mode.

A CPU regulation and control mode of the system may include at least one of regulating a number of CPU cores that are turned on regulating an operating frequency of the CPU cores and migrating processes of the CPU cores. The CPU regulation and control mode may include at least a first regulation and control mode and a second regulation and control mode the first regulation and control mode may correspond to at least one CPU core of the multi core CPU that is turned on and runs in a high frequency state the second regulation and control mode may correspond to one CPU core of the multi core CPU that is turned on and runs in a low frequency state.

When a CPU regulation and control mode is the first regulation and control mode the regulation and control module may be used for recording a number of CPU cores used by a process and a time of the CPU cores used by the process for migrating a high frequency process to an idle CPU core for processing and for regulating the idle CPU core to the high frequency operating state.

When a CPU regulation and control mode is a second regulation and control mode the regulation and control module may be used for recording a number of CPU cores used by a process and a time of the CPU cores used by the process for shutting down idle CPU cores and keeping a CPU core in operation and for performing frequency reduction processing on the CPU core in operation.

A CPU regulation and control mode for a system may include a third regulation and control mode when a CPU regulation and control mode is the third regulation and control mode the regulation and control module may be used for acquiring information regarding operating states of CPU cores of the multi core CPU at a predetermined time interval and for when a utilization of all CPU cores of the multi core CPU is lower than a first predetermined value keeping one of the CPU cores in operation and shutting down other CPU cores and performing frequency reduction processing on the CPU core in operation. Moreover the regulation and control module may also be used for when a utilization of the CPU cores in operation is greater than a second predetermined value turning on all CPU cores and for maintaining a balance of a utilization of the CPU cores of the multi core CPU by migrating processes.

The regulation and control module may be used for controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU by calling a subsystem CPUSET of the multi core CPU. The regulation and control module may include a native service module for calling a function at a bottom layer or communicating with a bottom layer core via a socket mechanism an acquisition module for acquiring a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration and a control module for controlling switching frequency modulation and process migration of the CPU cores of the multi core CPU via the function.

The regulation and control module may include a bottom layer core interface module for encapsulating a Cgroups interface and calling a subsystem CPUSET of the multi core CPU to realize control on switching frequency modulation and process migration of the CPU cores of the multi core CPU. The native service module may be used to set up a system service for calling a function at a bottom layer or communicating with a bottom layer core via a socket mechanism. A frame module for calling the system service and providing a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration through the system service. An API module for controlling switching frequency modulation and process migration of CPU cores of a multi core CPU through a function for regulating a number of CPU cores that are turned on an operating frequency of the CPU cores and process migration. Functions of all of the above functional units have been described in detail in the methods above and therefore will not be described.

A method and system for regulation and control of a multi core CPU may provide a predefined regulation and control mode and an automatic regulation and control mode of a multi core CPU in response to specific use situations and performance demand of a user s mobile device such that the mobile device may run in an optimal performance state when power is sufficient and may run in a power save mode when the power is insufficient. In addition a user may further set up an automatic regulation and control mode such that a mobile device can automatically regulate switching frequency modulation and process migration functions of a CPU based on a use situation of its CPU. Accordingly a mobile device user can choose to input commands in different scenarios to regulate and control a working state of every CPU core of a multi core CPU improve a processing capability of a multi core CPU or attain a goal of saving energy and electric power.

It should be understood that applications of the present invention are not limited to the above examples. Improvements and or modifications may be made based on the description above and all of these improvements or modifications shall be encompassed by the appended claims.

