---

title: Methods and systems for transmitting and receiving packets
abstract: A method carried out at a network node for managing aggregated Virtual Private Network (VPN) connection. The network node establishes an aggregated VPN connection with a network element and determines a first uplink bandwidth limit and/or a first downlink bandwidth limit. The uplink bandwidth at the network node is limited to the first uplink bandwidth limit if the first uplink bandwidth limit is determined. The downlink bandwidth at the network node is limited to the first downlink bandwidth limit if the first downlink bandwidth limit is determined. The network node encapsulates first data packets in first encapsulating packets and then transmits the first encapsulating packets to the network element through the aggregated VPN connection within the first uplink bandwidth limit. The network node receives second encapsulating packets from the network element within the first downlink bandwidth limit, and then decapsulates second data packets from the second encapsulating packets.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09531565&OS=09531565&RS=09531565
owner: PISMO LABS TECHNOLOGY LIMITED
number: 09531565
owner_city: Hong Kong
owner_country: HK
publication_date: 20131210
---
The present invention relates in general to the field of computer networking. More particularly the present invention relates to methods for managing performance of aggregated VPN connections at a network node by limiting uplink bandwidth and or downlink bandwidth of the aggregated VPN connections. The present invention also relates to methods for transmitting and receiving encapsulating packets through aggregated end to end connections.

Virtual private network VPN service providers are able to allow a user to privately browse the web share files and access streaming media. VPN service providers deploy VPN concentrators to terminate VPN tunnels. There are two major factors that affect network performance a user can enjoy when connecting to the Internet an intranet or network node through a VPNs provided by a VPN service provider.

The first factor is the VPN tunnel bandwidth between a user s device and the VPN concentrator deployed by the VPN service provider to terminate the VPN tunnel.

The second factor is the connection bandwidth between the VPN concentrator and the destination that the user wants to access such as a web site YouTube or a file server in an intranet.

If the VPN tunnel bandwidth between the user s device and the VPN concentrator is high but the connection bandwidth between the VPN concentrator and the destination is low the overall bandwidth experienced by the user would still be low. This is not only limited to bandwidth but is also applicable in case of other performance criteria such as latency packet drop packet jitters round trip time bit error rate etc.

It is common that a VPN service provider does not provide unlimited VPN service so that it may limit VPN tunnel bandwidth by limiting VPN tunnel bandwidth between a user s device and the VPN concentrator by limiting connection bandwidth between the VPN concentrator and the destination that the user and or by limiting number of transfer sessions that can be carried by the VPN.

U.S. Pat. No. 7 921 215 filed on Jan. 12 2009 and entitled Method and apparatus for optimizing and prioritizing the creation of a large number of VPN tunnels has disclosed a number of issues of and solutions for creation of a large number of VPN tunnels and solutions. U.S. Pat. No. 7 631 059 filed on Dec. 8 2009 and entitled VPN service management system having a VPN service manager for a provider network and a VPN service agent for a customer network and enabling rapid change of VPN service conditions has taught embodiments for provisioning VPN services with rapid change of VPN service conditions.

However when a user s device has a plurality of network interfaces and capable of establishing one or more aggregated VPN connections by aggregating a plurality of VPN tunnels with the VPN concentrator the VPN concentrator needs to take into the account of the plurality of VPN tunnels established with the user s device when limiting the resource allocated to an aggregated VPN connection and the corresponding VPN tunnels.

According to one of the embodiments of the present invention a Virtual Private Network VPN concentrator limits the bandwidth available to an aggregated VPN connection by limiting the bandwidth allocated to each of VPN tunnel in the aggregated VPN connection. An aggregated VPN connection comprises a plurality of VPN tunnels. Alternatively the VPN concentrator limits the bandwidth available to the aggregated VPN connection without limiting the bandwidth available to each of VPN tunnel in the aggregated VPN connection. In one variant the bandwidth allocated to the VPN tunnel in the aggregated VPN connection is allocated dynamically allocated according to a policy and or allocated according to a predefined configuration among all corresponding VPN tunnels. One of the policies is to allocate bandwidth substantially based on price.

According to one of the embodiments of the present invention a VPN concentrator encapsulates first data packets in first encapsulating packets and transmits the encapsulating packets through a first aggregated VPN connection to a first network element. The VPN concentrator also receives second encapsulating packets from the first network element through the first aggregated VPN connection. The VPN concentrator then decapsulates second data packets from the second encapsulating packets. The second data packets can be transmitted to a second network element if the destination address of the second data packets is the address of the second network element. In one of the embodiments when the destination address of the second data packets is the address of the second network element the second data packets are first encapsulated in third encapsulating packets and then the third encapsulating packets are transmitted to the second network element through a second aggregated VPN connection.

According to one of the embodiments of the present invention a VPN concentrator limits the bandwidth available to an aggregated VPN connection by limiting the uplink bandwidth and or downlink bandwidth.

According to one of the embodiments of the present invention a VPN concentrator does not impose restriction on data packets carried by the aggregated VPN connection if the data packets are originated from a first host of a first VPN and destined to a second host of the first VPN. On the other hand if the data packets are not originated from a host or not destined for a host of the first VPN the VPN concentrator imposes restriction such as bandwidth limitation and different priority on the data packets.

According to one of the embodiments of the present invention in order to limit bandwidth used by an aggregated VPN connection the VPN concentrator informs corresponding node or host of the aggregated VPN connection to limit data packet transmission within a bandwidth limit. The VPN concentrator informs the corresponding node or host by sending the corresponding node or host a tunnel management message.

According to one of the embodiments of the present invention a VPN concentrator limits number of sessions that can be carried in an aggregated VPN connection simultaneously.

The ensuing description provides preferred exemplary embodiment s and exemplary embodiments only and is not intended to limit the scope applicability or configuration of the invention. Rather the ensuing description of the preferred exemplary embodiment s and exemplary embodiments will provide those skilled in the art with an enabling description for implementing a preferred exemplary embodiment of the invention. It is understood that various changes may be made in the function and arrangement of elements without departing from the spirit and scope of the invention as set forth in the appended claims.

Also it is noted that the embodiments may be described as a process which is depicted as a flowchart a flow diagram a data flow diagram a structure diagram or a block diagram. Although a flowchart may describe the operations as a sequential process many of the operations can be performed in parallel or concurrently. In addition the order of the operations may be rearranged. A process is terminated when its operations are completed but could have additional steps not included in the figure. A process may correspond to a method a function a procedure a subroutine a subprogram etc. When a process corresponds to a function its termination corresponds to a return of the function to the calling function or the main function.

Embodiments or portions thereof may be embodied in program instructions operable upon a processing unit for performing functions and operations as described herein. The program instructions making up the various embodiments may be stored in a storage unit such as a secondary storage.

Moreover as disclosed herein the term secondary storage and main memory may represent one or more devices for storing data including read only memory ROM random access memory RAM magnetic RAM core memory magnetic disk storage mediums optical storage mediums flash memory devices and or other machine readable mediums for storing information. The term machine readable medium includes but is not limited to portable or fixed storage devices optical storage devices wireless channels and various other mediums capable of storing containing or carrying instruction s and or data. A machine readable medium can be realized by virtualization and can be a virtual machine readable medium including a virtual machine readable medium in a cloud based instance.

Furthermore embodiments may be implemented by hardware software firmware middleware microcode hardware description languages or any combination thereof. When implemented in software firmware middleware or microcode the program instructions or code segments to perform the necessary tasks may be stored in a machine readable medium such as storage unit. A processing unit s may perform the necessary tasks. A processing unit s can be a CPU an ASIC semiconductor chip a semiconductor chip a logical unit a digital processor an analog processor a FPGA or any processor that is capable of performing logical and arithmetic functions. A program instruction may represent a procedure a function a subprogram a program a routine a subroutine a module a software package a class or any combination of instructions data structures or program statements. A program instruction may be coupled to another program instruction or a hardware circuit by passing and or receiving information data arguments parameters or memory contents. Information arguments parameters data etc. may be passed forwarded or transmitted via any suitable means including memory sharing message passing token passing network transmission etc. A processing unit s can be realized by virtualization and can be a virtual processing unit s including a virtual processing unit in a cloud based instance.

A network interface may be implemented by a standalone electronic component or may be integrated with other electronic components. A network interface may have no network connection or at least one network connection depending on the configuration. A network interface is only connected to one accessible network. Therefore there may be more than one network connection being carried by one accessible network. A network interface may be an Ethernet interface a frame relay interface a fibre optic interface a cable interface a DSL interface a token ring interface a serial bus interface a universal serial bus USB interface Firewire interface Peripheral Component Interconnect PCI interface etc.

Embodiments or portions thereof may be embodied in a computer data signal which may be in any suitable form for communication over a transmission medium such that it is readable for execution by a functional device e.g. processing unit for performing the operations described herein. The computer data signal may include any binary digital electronic signal that can propagate over a transmission medium such as electronic network channels optical fibers air electromagnetic media radio frequency RF links and the like and thus the data signal may be in the form of an electrical signal optical signal radio frequency or other wireless communication signal etc. The program instructions may in certain embodiments be downloaded via computer networks such as the Internet an intranet LAN MAN WAN the PSTN a satellite communication system a cable transmission system and or the like.

A network element can be a host or a node. A host can be a personal computer workstations mainframes file servers thin client PDA smart phone or other computing device. A node can be modem a hub a bridge a router an access point a gateway a virtual machine or a server. A node acts as a connection point a redistribution point or a communication endpoint. A node is capable of sending receiving or forwarding data packets. The term node may represent a network node. A node or network node can be realized by virtualization and can be virtual network node.

A plurality of Virtual Private Network VPN tunnels are aggregated or bonded together to form one aggregated VPN connection. Those skilled in the arts would appreciate that there are myriad ways to aggregate or bond a plurality of VPN tunnels to form one aggregated VPN connection. An aggregated VPN connection could be perceived as one VPN connection by sessions or applications that are using it. One example of an aggregated VPN connection is SpeedFusion developed by Peplink.

A data packet can be an IP packet. A data packet can be encapsulated in an encapsulating IP packet. A data packet can also be an encapsulating IP packet if it encapsulates another data packet. A data packet and an encapsulating packet that encapsulates the data packet may be of the same protocol or different protocols.

In one of the embodiments VPN concentrator may establish VPN tunnels and or aggregated VPN connections with hosts or nodes belonging to same or multiple users or administrators. The hosts or nodes belonging to different users or administrators may establish separate VPNs with VPN concentrator and hosts or nodes in one VPN do not have access to another VPN or the data communicated through the another VPN.

Preferably the number of VPN tunnels and aggregated VPN connections are not so large that it impacts computing and or network resources of devices forming VPN tunnels with VPN concentrator and or of VPN concentrator .

For illustration purpose node and database server are public web server and public database server respectively. Therefore VPN concentrator may not be able to form VPN tunnels with them. VPN concentrator forms aggregated VPN connections with gateway server mobile phone and router respectively. In each aggregated VPN connection there are at least two VPN tunnels. For example VPN concentrator may establish two VPN tunnels with mobile phone and the two VPN tunnels are aggregated together to form an aggregated VPN connection.

VPN tunnels can be established between a host or node and VPN concentrator for example between router and VPN concentrator between mobile phone and VPN concentrator between gateway and VPN concentrator and between server and VPN concentrator . VPN concentrator may communicate with hosts and nodes not using VPN tunnels such as with node and database server .

All data packets transmitted and received through public private interconnected networks by server gateway mobile phone and router should go through VPN concentrator . Therefore VPN concentrator performs as a gateway for server gateway mobile phone and router . There are many reasons why such design is desirable. For example gateway can take advantage of aggregated bandwidth of access connections and . In another example through the VPN tunnels provided by an aggregated VPN connection between mobile phone and VPN concentrator and through the VPN tunnels provided by another aggregated VPN connection between router and VPN concentrator mobile phone is able to communicate with laptop as though mobile phone is in the same LAN. In another example in order to provide better security server communicates with node through VPN tunnels provided by an aggregated VPN connection between server and VPN concentrator and an end to end connection between node and VPN concentrator .

Node may be a modem a hub a bridge a computing device a router an access point a gateway a virtual machine a mobile phone or a server. Node acts as a connection point a redistribution point or a communication endpoint. Node is capable of sending receiving or forwarding data packets.

Server can be a database server file server mail server print server web server gaming server application server or the like. Server is a computing device which may be connected to one or more clients through public private interconnected networks or any other network. Server can also be a virtualized server.

Database server may contain data required by devices connecting to public private interconnected networks . Database server may be a computing device comprising an internal storage unit.

Gateway can be a router a gateway an access point an IEEE 802.11 access point a computing device a virtual machine or a network node.

Router is a network device that forwards and routes data packets received through public private interconnected networks to devices connected to it such as laptop and mobile phone . A gateway is capable of establishing VPN tunnels and allowing devices connecting to the gateway s LAN interfaces to transmit and receive data packets through the VPN tunnels.

Public private interconnected networks can be a public network such as the Internet a private network administered by one or more entity or a private network provided by the administrator of the VPN concentrator.

When data packets are transmitted through VPN tunnels established between a node or a host and VPN concentrator the data packets are encapsulated in encapsulating packets. When the encapsulating packets have arrived at the end of the VPN tunnels the encapsulating data packets can then be decapsulated and data packets can be extracted. illustrates the relationship among data packets and encapsulating packets. For illustration purpose only when mobile phone transmits data packet to laptop the following processes will take place.

Data packet has header and payload . Header is used to store source address destination address and other information. Payload is used to hold data that mobile phone tries to send to laptop . In this illustration the source address is the address of mobile phone and the address is the address of laptop . Those who are skilled in the arts would appreciate that data packet can be an Internet Protocol IP packet Ethernet frame X.25 packet and etc. As illustrated by the processes in the flowchart of data packet is encapsulated in first encapsulating packet in step and transmitted by mobile phone to VPN concentrator through a first aggregated VPN connection comprising two or more VPN tunnels in step . Encapsulating packet has header and a payload section. Header contains a destination address field set to be the address of a network interface of VPN concentrator and a source address field set to be the address of a network interface of mobile phone . The payload section is used to hold packet . After VPN concentrator receives first encapsulating packet in step VPN concentrator then decapsulates data packet from first encapsulating packet in step . Data packet is then encapsulated in second encapsulating packet by VPN concentrator in step . Similar to encapsulating packet encapsulating packet has header and a payload section. Header contains a destination address field set to be the address of a network interface of gateway and a source address field set to be the address of a network interface of VPN concentrator . The payload section is used to hold packet .

In step VPN concentrator transmits second encapsulating packet to gateway through public private interconnected networks using a second aggregated VPN connection comprising two or more VPN tunnels established between gateway and VPN concentrator . Network nodes of public private interconnected networks is able to route second encapsulating packets to gateway according to the destination address in header . Gateway then decapsulates data packet from second encapsulating packet and transmits data packet to the destination i.e. laptop . VPN concentrator is capable of transmitting data packet encapsulated in second encapsulating packet to gateway because VPN concentrator is able to determine that gateway is the destination for the first encapsulating packets after examining the destination address in header . In this illustration VPN concentrator performs routing decapsulation and encapsulation functions.

In one variant as illustrated in VPN concentrator performs no decapsulation and no encapsulation for data packet . When mobile phone transmits data packet to laptop data packet is encapsulated in third encapsulating packet in step . Mobile phone transmits third encapsulating packet through a first aggregated VPN connection comprising two or more VPN tunnels in step . Encapsulating packet has header address information and a payload field. The payload field holds data packet . The destination address in header is the IP address of VPN concentrator . Address information is the address of gateway . When VPN concentrator receives third encapsulating packet in step it determines that third encapsulating packet should be forwarded to gateway through a second aggregated VPN connection by examining address information in step . As a result it updates the destination address in header with the destination address of gateway in step . Those skilled in the art would appreciate that when the destination address in header is updated other fields of third encapsulating packet may also need to be updated such as checksum. VPN concentrator transmits third encapsulating packet with the updated destination address to gateway in step . When gateway receives third encapsulating packet it decapsulates data packet from third encapsulating packet and transmits data packet to the destination i.e. laptop . The benefit of mobile phone including address information in third encapsulating packet is that VPN concentrator does not need to examine the destination address information in header of third encapsulating packet . This may reduce computing resources required and may also result in quicker decision being made for the forwarding third encapsulating packet . However in order to determine the address for address information mobile phone has to know the address of gateway in advance.

In another example as illustrated in the flowchart of when mobile phone transmits data packet to node mobile phone encapsulates data packets in first encapsulating packets in step and then transmits first encapsulating packet through an aggregated VPN connection to VPN concentrator in step . After receiving first encapsulating packet in step VPN concentrator decapsulates data packet from first encapsulating packet in step . Depending on the protocol of data packet a connection such as Hypertext Transfer Protocol and Secure Sockets Layer SSL may be formed between VPN concentrator and node or connectionless data transfer is used such as User Datagram Protocol UDP . VPN concentrator performs network address translation NAT on data packets in step as the source IP address of data packets should be updated to the IP address of VPN concentrator . VPN concentrator then transmits updated data packets to node in step .

Similarly when node transmits data packets to mobile phone node transmits the data packets to VPN concentrator . Then VPN concentrator encapsulates the data packets into encapsulating packets and transmits the encapsulating packets to mobile phone through VPN tunnels of an aggregated VPN connection that has been established with mobile phone . When mobile phone receives the encapsulating packets it decapsulates the encapsulating packets to retrieve the data packets.

As an aggregated VPN connection has one or more VPN tunnels when data packets are encapsulated in encapsulating packets and the encapsulating packets are transmitted through a plurality of VPN tunnels of the aggregated VPN connection encapsulating packets may be distributed among the plurality of VPN tunnels according to predefined outbound policy algorithms or load balancing techniques. The node host and or VPN concentrator that form the aggregated VPN connection are able to decapsulate the encapsulating packets and retrieve the data packets into original order.

For illustration purpose when processing unit of VPN concentrator limits the bandwidth for transmitting and or receiving data packets between mobile phone and laptop processing unit can limit the uplink bandwidth of each VPN tunnel downlink bandwidth of each VPN tunnel total VPN tunnels uplink bandwidth total VPN tunnels downlink bandwidth aggregated VPN connection uplink bandwidth and aggregated VPN connection downlink bandwidth.

In one of the embodiments when a node or host at the one end of a VPN tunnel or an aggregated VPN connection assists or instructs the other node or host at the other end of the VPN tunnel or the aggregated VPN connection to limit the uplink bandwidth and or downlink bandwidth the node or host needs to inform the other node or host through a tunnel management message.

In one variant the tunnel management message is sent by VPN concentrator before the corresponding VPN tunnel or aggregated VPN connection is established with a host or node such as mobile phone . Mobile phone can then establish the VPN tunnel or aggregated VPN connection based on information in the tunnel management message. For example VPN concentrator sends the tunnel management message to mobile phone and the VPN tunnel or aggregated VPN connection is established some time after the tunnel management message has been sent. The uplink bandwidth limit and or downlink bandwidth limit at mobile phone is applied according to the tunnel management message immediately after establishing the VPN tunnel or the aggregated VPN connection. The computing resources required at mobile phone for establishing the VPN tunnel or the aggregated VPN connection may be less if the establishment is based on the tunnel management message.

In one variant VPN concentrator sends the tunnel management message to mobile phone during establishment of the corresponding VPN tunnel or aggregated VPN connection. For illustration purpose VPN concentrator determines the uplink bandwidth limit and or the downlink bandwidth limit at mobile phone according to the network bandwidth availability during the time of establishment of the VPN tunnel or the aggregated VPN connection. The determined uplink bandwidth limit and or the downlink bandwidth limit is then included in the tunnel management message. This is beneficial because the current network status is taken into account by VPN concentrator while creating and sending the tunnel management message.

In one variant the tunnel management message is sent by VPN concentrator after establishing a VPN tunnel or an aggregated VPN connection with mobile phone . This may be beneficial because the uplink bandwidth limit and or downlink bandwidth limit at mobile phone can be determined based on the actual amount of traffic passing through the VPN tunnel or the aggregated VPN connection. The uplink bandwidth limit and or downlink bandwidth limit can also be determined according to criteria such as port number an application a time and or a destination address corresponding to traffic passing through the VPN tunnel or the aggregated VPN connection. These criteria and the actual amount of traffic may not be known before or during establishment of the VPN tunnel or the aggregated VPN connection. Therefore the tunnel management message is sent after establishing the VPN tunnel or aggregated VPN connection.

In one variant the tunnel management message can be sent anytime while the corresponding VPN tunnel or aggregated VPN connection is still in operation. This allows the limit to be changed if necessary. The tunnel management message can be in the format of binary data text and Extensible Markup Language XML format message.

The tunnel management message includes uplink flag downlink flag VPN tunnel identity and the amount of bandwidth to be limited. The uplink flag is used to indicate whether the bandwidth limitation is uplink bandwidth limit. The downlink flag is used to indicate whether the bandwidth limitation is downlink bandwidth limit. The VPN tunnel identity is used for determining which VPN tunnel the bandwidth limitation should be applied. The amount of bandwidth to be limited is used for stating the amount of bandwidth to be limited in the VPN tunnel i.e. the uplink bandwidth limit or the downlink bandwidth limit. In one variant the identity of the VPN tunnel can be omitted. Then the bandwidth limitation is applied to all VPN tunnels of the aggregated VPN connection.

In one variant the tunnel management message includes VPN tunnel identity and information for number of sessions allowed. The VPN tunnel identity is used for determining which VPN tunnel the number of sessions limitation should be applied. The information for number of sessions allowed is used for determining the number of sessions that should be allowed through the VPN tunnel simultaneously. In one variant the identity of the VPN tunnel can be omitted. Then the number of sessions limitation is applied to all VPN tunnels of the aggregated VPN connection.

In one variant the tunnel management message comprises information for at least one of port number application a time a location network bandwidth availability destination address. For example the information for the port number is used to indicate which port number should the bandwidth limitation be applied. Therefore bandwidth of a VPN tunnel using a port number specified in the tunnel management message is limited. The information for the application is used to indicate which application should the bandwidth limitation be applied. Therefore bandwidth of a VPN tunnel being used for an application specified in the tunnel management message is limited. The information for the time is used to indicate at which time or the time period after which the bandwidth limitation should be applied. Therefore bandwidth of a VPN tunnel is limited at a time specified in the tunnel management message or the bandwidth of the VPN tunnel is limited after the VPN tunnel has been used for a time period specified in the tunnel management message. The information for the location is used to indicate in which location the bandwidth limitation should be or should not be applied. For example when host or node receiving the tunnel management message is within a first location the bandwidth limitation should not be applied. When the host or node is outside the first location the bandwidth limitation should be applied. The information for the network bandwidth availability is used to indicate the network bandwidth when the bandwidth limitation should be applied. Therefore when network bandwidth availability is equal to or less than that specified in the tunnel management message bandwidth of one or more VPN tunnels in the aggregated VPN connection is limited. The identity of the one or more VPN tunnels can be specified in the VPN tunnel identity of the tunnel management message.

In one of the embodiments of the present invention the uplink bandwidth of a VPN tunnel is limited by specifying an uplink bandwidth limit. For example router establishes a VPN tunnel with VPN concentrator using access connections and . For illustration purpose only uplink bandwidth of the VPN tunnel is limited to 15 Mbps by configuring router to transmit data packets to VPN concentrator using no more than 15 Mbps and configuring VPN concentrator to transmit data packets to router using no more than 15 Mbps. Therefore the uplink bandwidth of both router and VPN concentrator is limited to 15 Mbps for the VPN tunnel. Uplink bandwidth at each end of the VPN tunnel may or may not be different. For example uplink bandwidth of the VPN tunnel is limited to 10 Mbps at router and is limited to 15 Mbps at VPN concentrator .

Alternatively downlink bandwidth of the VPN tunnel is limited by specifying a downlink bandwidth limit. For illustration purpose only downlink bandwidth of the VPN tunnel is limited to 15 Mbps at VPN concentrator . When data packets arriving rate approaches a threshold VPN concentrator first buffer the data packets in secondary storage in order to limit the downlink bandwidth to 15 Mbps. When there is no more buffer space available to temporarily store the data packets processing unit starts dropping the data packets.

In one variant both uplink and downlink bandwidth of a VPN tunnel is limited. The limit of uplink bandwidth and the limit of downlink bandwidth can be the same or different. For example the uplink bandwidth limit of a VPN tunnel is 10 Mbps while the downlink bandwidth limit of the VPN tunnel is 20 Mbps. In another example both the uplink bandwidth limit and the downlink bandwidth limit of the VPN tunnel is 10 Mbps.

In one of the embodiments of the present invention the uplink bandwidth of an aggregated VPN connection is limited. For example server establishes a first aggregated VPN connection with VPN concentrator . The first aggregated VPN connection is formed by aggregating a first VPN tunnel and a second VPN tunnel and both first VPN tunnel and second VPN tunnel can be used to carry data packets belonging to one same session. The first VPN tunnel for example is established using access connections and and the second VPN tunnel is established using access connections and . For illustration purpose only the uplink bandwidth limit of the first aggregated VPN connection is determined to be 15 Mbps. Therefore uplink bandwidth of the first aggregated VPN connection is limited to 15 Mbps by configuring server to transmit data packets to VPN concentrator through the first and second VPN tunnels using no more than a combined bandwidth of 15 Mbps. Similarly for example VPN concentrator is configured to transmit data packets to server through the first and second VPN tunnels using no more than a combined bandwidth of 15 Mbps. Therefore data packets can be transmitted through the first aggregated VPN connection using no more than 15 Mbps bandwidth. In one variant uplink bandwidth is limited by limiting the uplink bandwidth of each of the first and second VPN tunnels. For example the uplink bandwidth of the first and second VPN tunnels is limited to 8 Mbps and 7 Mbps respectively such that the combined uplink bandwidth of the first aggregated VPN connection is limited to 15 Mbps.

Alternatively downlink bandwidth of an aggregated VPN connection is limited. For illustration purpose only downlink bandwidth limit is determined to be 15 Mbps. Therefore the downlink bandwidth of the first aggregated VPN connection is limited at VPN concentrator to 15 Mbps. When data packet arriving rate through the first aggregated VPN connection approaches a threshold VPN concentrator starts dropping data packets in one or more VPN tunnels of the first aggregated VPN connection in order to limit the downlink bandwidth to 15 Mbps. It is preferred to drop data packets in the worst performing VPN tunnel first because overall network performance could be affected less significantly comparing to dropping data packets in other well performing VPN tunnels. Other techniques to choose which VPN tunnels to drop data packets including choosing the most expensive VPN tunnel and choosing one or more VPN tunnels according to a predefined priority corresponding to each of the one or more VPN tunnels etc.

In one variant both uplink bandwidth and downlink bandwidth of an aggregated VPN connection are limited. The limit of uplink bandwidth and the limit of downlink bandwidth can be the same or different. For example the uplink bandwidth limit of an aggregated VPN connection is 10 Mbps while the downlink bandwidth limit of the aggregated VPN connection is 20 Mbps.

The difference between a combined VPN connection and an aggregated VPN connection is that in a combined VPN connection data packets belonging to one session are carried by one of the tunnels of the combined VPN connection consistently and no other tunnels of the combined VPN connection should be used to transmit or receive data packets of the same one session in an aggregated VPN connection any of the tunnels of the aggregated VPN connection can be used to transmit and received data packets of the same one session.

According to one of the embodiments of the present invention the uplink bandwidth of a combined VPN connection is limited. When the uplink bandwidth of one of a plurality of or all of the VPN tunnels in the combined VPN connection is more than or and about to be more than the uplink bandwidth limit processing unit of a host or node that establishes the combined VPN connections stop transmitting data packets. In one variant the downlink bandwidth of a combined VPN connection is limited. When the downlink bandwidth of one of a plurality of or all of the VPN tunnels in the combined VPN connection is more than or and about to be more than the downlink bandwidth limit processing unit of the host or node that establishes the combined VPN connections starts dropping data packets.

In one variant both uplink and downlink bandwidth of a combined VPN connection is limited. The limit of uplink bandwidth and the limit of downlink bandwidth can be the same or different. For example the uplink bandwidth limit of a combined VPN connection is 10 Mbps while the downlink bandwidth limit of the combined VPN connection is 20 Mbps.

According to one of the embodiments VPN concentrator limits the bandwidth available to access connections if VPN concentrator can control bandwidth available to access connections. For example if the total uplink bandwidth of access connections and is limited to 10 Mbps mobile phone cannot transmit data packets with a bandwidth higher than 10 Mbps through a wireless connection mobile phone established with a wireless network even if the wireless network allows mobile phone to transmit data packets with more than 10 Mbps bandwidth. In another example uplink bandwidth of access connection is limited to 20 Mbps but downlink bandwidth of access connection is limited to 5 Mbps. Then mobile phone can transmit data packets with a bandwidth not higher than 5 Mbps to devices connected to router namely laptop or mobile phone and packet drop may be experienced at router .

In a preferred embodiment uplink bandwidth of a VPN tunnel is limited. For example a first VPN tunnel is established between server and VPN concentrator through access connections and and the uplink bandwidth of the first VPN tunnel is limited. For illustration purpose only VPN concentrator sends a tunnel management message to server for limiting the uplink bandwidth at server for the first VPN tunnel 15 Mbps such that the VPN concentrator may not need to limit the downlink bandwidth at VPN concentrator to 15 Mbps for the first VPN tunnel. Similarly the uplink bandwidth at VPN concentrator for the first VPN tunnel is limited to 10 Mbps instead of limiting the downlink bandwidth at server to 10 Mbps. It is preferred to limit uplink bandwidth of server and VPN concentrator than to limit downlink bandwidth of server and VPN concentrator because when uplink bandwidth is limited fewer data packets are transmitted. When limiting downlink bandwidth of server and VPN concentrator data packets are still being transmitted but are dropped when reaching the destination and results in less efficient use of bandwidth. Similarly it is preferred to limit egress bandwidth than to limit ingress bandwidth because when limiting transmission of data packets the bandwidth is preserved. When dropping received data packets to limit the downlink bandwidth the received data packets have already consumed resources such as bandwidth and processing time. Therefore dropping received data packets is not preferred. Limiting the uplink bandwidth at one end of a VPN tunnel can result in the same effect of limiting the downlink bandwidth at the other end of the VPN tunnel.

One of the benefits of limiting the uplink bandwidth of a VPN tunnel is that less data packets are dropped at the device receiving the data packets. It is preferred that downlink bandwidth of a VPN tunnel at a device receiving the data packets is higher than the uplink bandwidth of the VPN tunnel at a device transmitting the data packets. For example downlink bandwidth of a VPN tunnel at server is higher than uplink bandwidth of the VPN tunnel at VPN concentrator and downlink bandwidth of the VPN tunnel at VPN concentrator is higher than uplink bandwidth of the VPN tunnel at server . Therefore when data packets are transmitted from server to VPN concentrator using the uplink bandwidth through the VPN tunnel at server the packet drop at VPN concentrator is minimized because the downlink bandwidth of the VPN tunnel at VPN concentrator is higher than the uplink bandwidth at server . The same applies to uplink and downlink bandwidths of aggregated VPN connections.

In one variant the uplink bandwidth at server is managed by a management software module running in VPN concentrator . This provides a central management capability such that aggregated VPN connections established at VPN concentrator can be managed through the management software module. In one variant the uplink bandwidth at server is managed by a management software module running in a host as the management software module can be executed in one or more computing devices different from VPN concentrator . For example the management software module is hosted at node and is executed by a processing unit of node . The management software module communicates with VPN concentrator and server in order to manage the VPN tunnel bandwidth and or network performance. The management software module can also be used for managing aggregated VPN connections established between hosts or nodes and VPN concentrator .

In one variant server transmits data packets to VPN concentrator through a first aggregated VPN connection and the data packets are then forwarded to mobile phone by VPN concentrator through a second aggregated VPN connection. Therefore server is able to communicate with mobile phone through VPN concentrator . For example server and mobile phone communicate only with each other through VPN concentrator . For illustration purpose only uplink bandwidth of the first aggregated VPN connection at mobile phone is limited to 10 Mbps and uplink bandwidth of the second aggregated VPN connection at VPN concentrator is limited to 7 Mbps. When server is transmitting data packets with the rate of more than 7 Mbps to mobile phone through the first aggregated VPN connection and the second aggregated VPN connection VPN concentrator will buffer data packets that cannot be transmitted through the second aggregated VPN connection in secondary storage . When there is no more buffer space available to temporarily store the data packets VPN concentrator starts dropping the data packets in order to limit the uplink bandwidth of the second aggregated VPN connection to the mobile phone within 7 Mbps. In order to minimize packet drop the uplink bandwidth limit of the first aggregated VPN connection at server for transmitting data packets to mobile phone through VPN concentrator should be lower than the uplink bandwidth limit of the second aggregated VPN connection at VPN concentrator for transmitting the data packets to mobile phone . Similarly in order to minimize packet drop for data packets that are transmitted by mobile phone to server through VPN concentrator uplink bandwidth limit of the second aggregated VPN connection at mobile phone for transmitting data packets to server should be lower than the uplink bandwidth of the first aggregated VPN connection at VPN concentrator for transmitting data packets to server .

In one variant multiple hosts or nodes are able to communicate with mobile phone through VPN concentrator . For illustration purpose only the uplink bandwidth at VPN concentrator for transmitting data packets to mobile phone is limited to 20 Mbps and the total uplink bandwidth for data packets transmitted by the multiple hosts or nodes to mobile phone through VPN concentrator is limited to 30 Mbps. When data packets destined to mobile phone are arriving at VPN concentrator at a rate of more than 20 Mbps VPN concentrator buffers data packets that cannot be transmitted to mobile phone in secondary storage . When there is no more buffer space available to temporarily store the arriving data packets VPN concentrator starts dropping the data packets in order to limit the uplink bandwidth at VPN concentrator for transmitting data packets to mobile phone to 20 Mbps. In order to minimize packet drop at VPN concentrator the total uplink bandwidth of data packets transmitted by the multiple hosts or nodes to mobile phone through VPN concentrator should be lower than the uplink bandwidth at VPN concentrator for transmitting the data packets to mobile phone .

According to one of the embodiments VPN concentrator limits the downlink bandwidth available for data transfer through a VPN tunnel or aggregated VPN connection regardless of whether VPN concentrator can control uplink bandwidth of hosts or nodes connecting to public private interconnected networks . In this embodiment VPN concentrator is unable to control uplink or downlink bandwidth at a host or node on the other end of the VPN tunnel or aggregated VPN connection. For example a first VPN tunnel is established between VPN concentrator and server . Server is not fully compatible with VPN concentrator because its firmware is not up to date or cannot be managed by VPN concentrator . In this case when VPN concentrator cannot limit the uplink bandwidth of at server for the first VPN tunnel VPN concentrator limits the downlink bandwidth at VPN concentrator for data packets arriving from server i.e. for the first VPN tunnel. When data packets arriving rate from server exceeds a threshold VPN concentrator drops some or all of the data packets to try to limit the downlink bandwidth. As data packets are dropped server notices from protocol such as TCP that it may need to reduce the data packet transmission rate to VPN concentrator .

Alternatively when a node or host is not compatible with VPN concentrator such that the node or host is not manageable by VPN concentrator to limit the uplink bandwidth at the node or host the node or host is required to upgrade its firmware in order to be compatible with the VPN concentrator . For example server is required to be upgraded with a firmware in order to be fully compatible with VPN concentrator . Then VPN concentrator can limit the uplink bandwidth at server . In one variant if a node or host tries to establish a VPN tunnel with VPN concentrator and the node or host is not compatible with VPN concentrator the administrator of the node or host is prompted to upgrade its firmware or software before one or more VPN tunnels can be established. In one variant the node or host automatically upgrades its firmware or software by retrieving the updated version from a server.

According to one of the embodiments when there is a plurality of VPN tunnels between two network nodes or hosts such as between server and VPN concentrator different uplink and or downlink bandwidth limits are applied to the VPN tunnels. For illustration purpose only the uplink bandwidth of a first VPN tunnel of a combined VPN connection is limited to 10 Mbps while the uplink bandwidth of a second VPN tunnel of the combined VPN connection is limited to 30 Mbps. The first VPN tunnel is established using access connection and the second VPN tunnel is established using access connection . There are myriad reasons why different bandwidth limits are allocated to the first and second VPN tunnels. For example the usage price of access connection is lower than that of access connection . Therefore the first VPN tunnel is allowed to utilize lower bandwidth in order to minimize the cost. The ratio of a bandwidth limit among the VPN tunnels of a combined VPN connection or an aggregated VPN connection formed between VPN concentrator and a network element may be set dynamically according to a policy or according to a predefined configuration. The bandwidth limit of the aggregated VPN connection could be the uplink bandwidth limit at VPN concentrator the downlink bandwidth limit at VPN concentrator uplink bandwidth limit at the network element or downlink bandwidth limit at the network element.

In one variant when the bandwidth limit is allocated among the VPN tunnels of an aggregated VPN connection dynamically processing unit determines which VPN tunnel has the highest traffic at a given time and allocates the highest ratio of the bandwidth limit to a VPN tunnel having the highest traffic. The bandwidth limit allocation may change frequently depending on the amount of traffic and or the nature of traffic in each of the VPN tunnels of the aggregated VPN connection.

In another variant the bandwidth limit is allocated among VPN tunnels of an aggregated VPN connection according to a policy. For illustration purpose the policy is to allocate two thirds of the bandwidth limit to a first VPN tunnel of the aggregated VPN connection during a first predefined time period and one thirds of the bandwidth limit to a second VPN tunnel of the aggregated VPN connection during the first predefined time period. The policy is also to allocate equal ratios of the bandwidth limit to the first VPN tunnel and the second VPN tunnel of the aggregated VPN connection during a second predefined time period. Therefore the policy is based on time. There are many reasons why such a policy may be desired. For example the cost of using the first VPN tunnel is significantly lower than the cost of using the second VPN tunnel during the first predefined time period. During the second predefined time period the cost of using the first VPN tunnel and the second VPN tunnel is almost the same. Therefore higher bandwidth limit is allocated to the first VPN tunnel during the first predefined time period. It is common that usage price of connecting to networks provided by some carriers differs in peak and off peak hours. The policy can also be based on service provider usage location price security user identity communication protocol and or communication technology.

In another variant the bandwidth limit is allocated among VPN tunnels of an aggregated VPN connection according to a predefined configuration. For illustration purpose VPN concentrator is configured with a predefined configuration to allocate equal bandwidth limits to each VPN tunnel of an aggregated VPN connection. Therefore if the bandwidth limit of an aggregated VPN connection is 30 Mbps and the aggregated VPN connection comprises a first VPN tunnel and a second VPN tunnel the bandwidth limit of the first VPN tunnel is 15 Mbps and the bandwidth limit of the second VPN tunnel is 15 Mbps. In another example VPN concentrator is configured with a predefined configuration increase the allocated bandwidth limit of the first VPN tunnel to 30 Mbps if the second VPN tunnel is disconnected.

In one variant the policy and or the predefined configuration is sent to VPN concentrator by an administrator manually through a web interface command line interface and or application programming interface API . The policy and or the predefined configuration can then be stored remotely in a server or locally in secondary storage or main memory .

According to one of the embodiments of the present invention VPN concentrator limits VPN tunnel performance or aggregated VPN connection performance through VPN concentrator and or devices establishing VPN tunnels with VPN concentrator . The VPN tunnel performance restriction or aggregated VPN connection performance restriction is applied according to one or more criteria. Examples of criteria include port number application time location price network bandwidth availability and destination address. The criteria may be stored in a storage unit such as secondary storage or main memory . The bandwidth limit or consequence when the criterion criteria is are met is also stored in the storage unit.

In one variant bandwidth limitation is applied if data packets that are carried in a VPN tunnel using one of predefined Internet Protocol ports. For example the predefined Internet Protocol port number is 20 for a file transfer and the bandwidth limit is 3 Mbps. Then the bandwidth that can be used for data packets with port number is limited to 3 Mbps. The same applies to data packets that are carried in an aggregated VPN connection.

In one variant the bandwidth is limited according to application for which the VPN tunnel or aggregated VPN connection is being used. The application may be determined by deep packet inspection. In one embodiment for illustration purpose VPN concentrator detects that a host or node such as mobile phone is using an aggregated VPN connection established between gateway and VPN concentrator for video conferencing. VPN concentrator then limits the bandwidth of the aggregated VPN connection to 20 Mbps. In a preferred embodiment the uplink bandwidth of the aggregated VPN connection at gateway and at VPN concentrator are limited by VPN concentrator . Alternatively the downlink bandwidth of the aggregated VPN connection at gateway and at VPN concentrator can also be limited.

In one variant the bandwidth is limited according to the time. Mobile phone establishes a VPN tunnel with VPN concentrator using access connection . For illustration purpose VPN concentrator limits the uplink bandwidth of access connection or the uplink bandwidth of the VPN tunnel at mobile phone to 10 Mbps during office hours such as nine o clock in the morning to five o clock in the evening. From five o clock in the evening to nine o clock in the morning VPN concentrator does not limit the uplink bandwidth or the uplink bandwidth limit is higher such as 20 Mbps. This may help in preventing any one host or node such as mobile phone to overuse bandwidth during office hours so that other hosts or nodes can also have considerable amount of bandwidth. In another embodiment after a certain period of time has passed since establishing a VPN tunnel between mobile phone and VPN concentrator VPN concentrator limits the uplink and or downlink bandwidth of the access connection to 10 Mbps. As some carriers may start charging higher usage price after a certain period of time the bandwidth can be limited after the certain period of time in order to reduce the cost.

In one variant the bandwidth is limited according to location. Mobile phone establishes an aggregated VPN connection with VPN concentrator . For illustration purpose when mobile phone is being used within a first location the uplink bandwidth limit and the downlink bandwidth limit of the aggregated VPN connection is 10 Mbps. When mobile phone is being used outside the first location the uplink bandwidth limit and the downlink bandwidth limit of the aggregated VPN connection is 5 Mbps. There are many reasons why limiting bandwidth according to location may be desirable. For example when a mobile phone is outside a specific country or region the cost of connecting to a network may be higher than that when the mobile phone is inside the specific country or region. The signal quality may also deteriorate when the mobile phone is outside the specific country or region.

In one variant the bandwidth is limited according to price. Server establishes an aggregated VPN connection with VPN concentrator . For illustration purposes the uplink and downlink bandwidth limit at server is 15 Mbps each when price for connecting to the VPN provided by the aggregated VPN connection is below a predefined threshold. The price for connecting to the VPN provided by the aggregated VPN connection includes the price corresponding to each VPN tunnel of the aggregated VPN connection. When the price becomes over the predefined threshold the uplink and downlink bandwidth limit at server is lowered to 5 Mbps each. This may be beneficial for minimizing the cost.

In one variant the bandwidth is limited according to network bandwidth availability. When many devices are connecting to a same network limited uplink and or downlink bandwidth should be allotted to each device. Mobile phone establishes a first VPN tunnel with VPN concentrator using access connection and server establishes a second VPN tunnel with VPN concentrator using access connection . Both mobile phone and server connect to public private interconnected networks to establish the first and second VPN tunnels respectively. For illustration purpose only when the total network bandwidth availability for hosts or nodes connecting to VPN concentrator through access connections and is 20 Mbps VPN concentrator limits the uplink bandwidth for mobile phone to 12 Mbps. Therefore not all bandwidth of VPN concentrator is consumed by mobile phone . In another variant VPN concentrator allots bandwidth to each VPN tunnel that it has established. For example uplink bandwidth of 12 Mbps is allotted to the first VPN tunnel and uplink bandwidth of 8 Mbps is allotted to the second VPN tunnel by VPN concentrator as the total network bandwidth available is 20 Mbps. In one variant VPN concentrator allots more bandwidth than it has in order to achieve higher bandwidth usage efficiency when all of the allotted bandwidth is not being used by the hosts or nodes. However over allotment may result in congestion and lower bandwidth usage efficiency.

In another example the bandwidth is limited according to destination of data packets. This is useful in an office setting where employees are restricted to access certain websites. For example node provides a video hosting service and server contains important official files. Laptop is an office computer. For illustration purpose only when laptop establishes a VPN tunnel with VPN concentrator for transmitting and or receiving data packets to or from a website hosted at node the bandwidth is limited to 5 Mbps. However for other websites hosted at node such bandwidth limit is not applied.

In one of the embodiments of the present invention the criterion to limit bandwidth is whether the source or destination of data packets belongs to a public network. Therefore bandwidth limitation only applies to hosts and nodes that have not established a VPN tunnel with VPN concentrator . If a host or node has not established a VPN tunnel with VPN concentrator it is likely that the host or node is an external host or node. An administrator of a private network may want to allot more bandwidth for data packets belonging to the private network than to external networks.

For illustration purpose only server is a server capable of forming VPN tunnels with VPN concentrator and database server is a public server accessible through the Internet. Mobile phone has formed an aggregated VPN connection with VPN concentrator through access connections and . The aggregated VPN connection between mobile phone and VPN concentrator comprises a plurality of VPN tunnels. All data packets from and to mobile phone go through VPN concentrator and the aggregated VPN connection. Server and mobile phone are in the same VPN. Therefore when mobile phone sends and receives data packets to and from server the data packets are encapsulated. VPN concentrator performs as a gateway for mobile phone when communicating with database server . Also for illustration purpose only the administrator tries to limit bandwidth available for accessing external server with 3 Mbps while not imposing any bandwidth limit for accessing internal server. As a result VPN concentrator is configured to allow mobile phone to use less than 3 Mbps of bandwidth when communicating with hosts and nodes not belonging to the VPN such as database server . When mobile phone sends and receives data packets to and from server the data packets go through VPN concentrator . When mobile phone transmits and receives data packets to and from database server VPN concentrator limits the uplink bandwidth and downlink bandwidth within 3 Mbps. On the other hand when mobile phone transmits and receives data packets to and from server VPN concentrator does not impose bandwidth limitation.

In one variant VPN concentrator also limits the bandwidth available for transmitting and receiving data packets to and from hosts or nodes belonging to the same VPN but the limit is higher than the bandwidth limited for sending and receiving data packets to and from hosts or nodes not belonging to the same VPN. This allows more bandwidth being allotted for communications within the same VPN.

In one variant VPN concentrator has lower quality of service target assigned for data packets being sent to or received from a host or a node that is not in a same VPN comparing to quality of service target assigned for data packets being sent to or received from a host or a node that is in a same VPN. This allows data packets belonging to the VPN to have higher quality of service. For illustration purpose only laptop and mobile phone are in a first VPN that passes through VPN concentrator while node is a public node that does not belong to the first VPN. VPN concentrator will give data packets being sent to and received from laptop and mobile phone higher priority or better quality of service than data packets being sent to and received from and node .

In one of the embodiments of the present invention the number of sessions allowed simultaneously in a VPN tunnel or an aggregated VPN connection is limited. For example the number of sessions allowed by VPN concentrator in an aggregated VPN connection established with server is limited to six sessions. Therefore when there are more than six sessions in the aggregated VPN connection such as three HTTP sessions with node one Telnet session with laptop and two FTP sessions with mobile phone VPN concentrator will not accept new sessions in the aggregated VPN connection. This can be beneficial as it can help controlling bandwidth used up by server and reduce usage of computing and or network resources of server . Those who are skilled in the arts would appreciate the consequences if too many sessions are allowed such as memory bloat.

In one of the embodiments of the present invention in addition to limiting bandwidth a VPN tunnel or aggregated VPN connection network performance of the VPN tunnel or aggregated VPN connection is limited by VPN concentrator . Network performance that is limited may include packet drop rate maximum transmission unit MTU and or quality of service QoS . For example packet drop rate of an aggregated VPN connection or a VPN tunnel is increased by VPN concentrator in order to limit uplink and or downlink bandwidth of the aggregated VPN connection or the VPN tunnel. In another example the MTU of IP data packets transmitted through a VPN tunnel or aggregated VPN connection is limited by VPN concentrator in order to reduce delay and latency through the VPN tunnel or aggregated VPN connection. Lowering the MTU of IP data packets may especially be beneficial in reducing latency of VPN tunnels or aggregated VPN connections with low uplink and or downlink bandwidth limit. In another example VPN concentrator configures QoS for each VPN tunnel or aggregated VPN connection established with VPN concentrator so that resources are allocated to hosts or nodes according to criterion criteria defined in VPN concentrator .

In one variant an aggregated VPN connection is established between server and VPN concentrator . The aggregated VPN connection comprises a first VPN tunnel using access connections and and a second VPN tunnel using access connections and . For illustration purpose only in step VPN concentrator determines to limit bandwidth of traffic from server to VPN concentrator to 20 Mbps and determines to limit bandwidth of traffic from VPN concentrator to server to 15 Mbps. Processing unit of VPN concentrator determines whether the uplink bandwidth of the aggregated VPN connection at server can be limited in step . If uplink bandwidth of the aggregated VPN connection at server can be limited VPN concentrator limits the total uplink bandwidth of the aggregated VPN connection at server to 20 Mbps in step . The 20 Mbps uplink bandwidth may be shared between the first VPN tunnel and the second VPN tunnel according to policies set by a VPN service provider. If uplink bandwidth of the aggregated VPN connection at server cannot be limited downlink bandwidth of the aggregated VPN connection at VPN concentrator is limited to 20 Mbps. For traffic from VPN concentrator to server total uplink bandwidth of the aggregated VPN connection at VPN concentrator is limited to 15 Mbps. The 15 Mbps bandwidth may be shared between the first VPN tunnel and the second VPN tunnel equally or unequally.

The program instructions for limiting bandwidth of VPN tunnels and or aggregated VPN connections established between hosts or nodes connected to network may be stored in secondary storage or main memory and executed by processing unit . The program instructions for limiting bandwidth may also be stored in storage units of the hosts or nodes and executed in the processing unit s of the hosts or nodes. In one variant when the management software module is not running at VPN concentrator the program instructions may also be retrieved by VPN concentrator remotely from a device running the management software module. The program instructions may be stored in secondary storage or main memory after being retrieved remotely. The program instructions are then executed by processing unit .

