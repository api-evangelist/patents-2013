---

title: Silent SMS triggering for mobile billing at a billing server
abstract: The invention provides a method of processing transactions with a billing server, including receiving, with the billing server, a transaction request API call from a merchant computer including a msisdn, transmitting, with the billing server, a transaction request response to the merchant computer in response to the transaction request API call, including a transmission ID, receiving, with the billing server, a payment authorization text message from a consumer device at the msisdn including a transaction ID, determining, with the billing server, a match between the transaction ID in the text message with the transaction ID in the transaction request response and if a match is determined between the transaction ID's, transmitting, with the billing server, a charge request to a carrier server to charge an account on the carrier server corresponding to the msisdn.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09633341&OS=09633341&RS=09633341
owner: Boku, Inc.
number: 09633341
owner_city: San Francisco
owner_country: US
publication_date: 20130816
---
Merchant servers often have stores allowing consumers to use browsers within mobile devices to select goods virtual goods or services from the merchant server and then to make a purchase from the merchant server. The consumer may be asked to select payment options such as credit card details payment via an account having a stored value or have a charge placed on their phone bill. If the consumer selects their phone bill the merchant server transmits a payment authorization to a billing server. The billing server is aligned with one or more carrier servers and places a charge on a phone bill of the consumer at the carrier server. There are methods that exist in the art for the billing server to determine a phone number and or a carrier corresponding to a consumer mobile phone of the consumer.

The carriers in different countries have different requirement with respect to currency and price points that are supported. In addition a merchant server may have a number of different options available for purchase at different target prices. For example a merchant may sell 100 points 200 points or 300 points. The different levels of service sold by the merchant server may not be in exact multiples due to carrier restrictions with respect to price points. Alternatively a merchant may wish to provide different levels of service at different price points that are optically more favorable e.g. 1.99 2.99 and 3.99 or that factor in discounts for larger purchases.

The invention provides a method of processing transactions with a billing server including receiving with the billing server a transaction request API call from a merchant computer including a msisdn transmitting with the billing server a transaction request response to the merchant computer in response to the transaction request API call including a transmission ID receiving with the billing server a payment authorization text message from a consumer device at the msisdn including a transaction ID determining with the billing server a match between the transaction ID in the text message with the transaction ID in the transaction request response and if a match is determined between the transaction ID s transmitting with the billing server a charge request to a carrier server to charge an account on the carrier server corresponding to the msisdn.

The method may further include receiving with the billing server a charge confirmation from the merchant server and transmitting with the billing server in response to the charge confirmation a callback notification to the merchant computer.

The method may further include receiving at the billing server a configuration input from at least one merchant computer the configuration input configuring a pricing matrix of countries and target prices the pricing matrix having a set of cells each cell corresponding to an intersection between a respective country and a respective target price such that each country has a subset of the set of cells the subset having different price points storing with the billing server the pricing matrix receiving with the billing server a pricing call from the merchant computer transmitting with the billing server the pricing matrix to the merchant computer in response to the pricing call and determining with the billing server a carrier server based on the payment authorization.

The method may further include registering with the billing server a public portal account for the merchant computer on the billing server creating with the billing server a service in the account adding with the billing server the countries at the pricing matrix to the service wherein the pricing matrix is configured by the merchant computer on the billing server and approving with the billing server the pricing service.

The method may further include that at least one price point for one of the countries differs from all price points of another country.

The method may further include that the price points for two different countries are in different currencies.

The method may further include that the one target price has a plurality of different price points between countries.

The method may further include that the price points for at least one country is only supported below a predetermined amount.

The method may further include that the price points for at lone country are only supported for a set of predetermined amounts.

The method may further include transmitting with the billing server a payment confirmation to a handset at the phone number after transmitting the charge request to the carrier server.

The method may further include that the transaction request API call includes a merchant id a service id a handset locale an mcc mobile country code and an mnc mobile network code .

The method may further include that the transaction request response includes an api version a trx id a result code a result msg a price a product description a service name a client message and a client action.

The invention also provides a non transitory computer readable medium having stored thereon a set of instructions wherein when executed by a processor of a computer performs a method of processing transactions with a billing server including configuring with at least one merchant computer a pricing matrix of countries and target prices the pricing matrix having a set of cells each cell corresponding to an intersection between a respective country and a respective target price such that each country has a subset of the set of cells the subset having different price points storing with at least one merchant computer the pricing matrix receiving with at least one merchant computer a transaction request from a consumer device identifying with at least one merchant computer a country of the consumer device based on the payment request matching with at least one merchant computer the country of the consumer device with a country in the pricing matrix determining with at least one merchant computer at least one price point for the country that has been matched in the pricing matrix transmitting with at least one merchant computer the price point that has been extracted to the consumer device allowing a user of the consumer device to make a purchase and receiving with at least one merchant computer a transaction callback notification from a billing server in response to the transmission of the price point.

The invention further provides a billing server including a processor a computer readable medium connected to the processor and a set of instructions on the computer readable medium and executable by the processor. The set of instructions includes a transaction application programmable interface management module executing the steps of receiving a configuration input from at least one merchant computer the configuration input configuring a pricing matrix of countries and target prices the pricing matrix having a set of cells each cell corresponding to an intersection between a respective country and a respective target price such that each country has a subset of the set of cells the subset having different price points storing the pricing matrix transmitting the pricing matrix to the merchant computer in response to the pricing call and a carrier billing module executing the steps of receiving with the billing server a payment authorization based on the price point determining with the billing server a carrier server based on the payment authorization sending with the billing server a charge request to a carrier server to charge an account on the carrier server corresponding to the phone number and transmitting with the billing server a transaction callback notification to the merchant computer.

The billing server includes a transaction application programmable interface API management module a carrier billing module and a Short Message Service SMS messaging module . The merchant server includes a transaction API management module . The merchant development computer includes an application writing and publishing tool . The consumer mobile phone includes a mobile phone application and an SMS messaging application . The mobile phone application includes a shopping browser and a purchasing unit . The purchasing unit includes a service call .

The application writing and publishing tool is used for developing the mobile phone application . The mobile phone application is used to shop at a store at the merchant server and for processing payments through the billing server . The billing server then places a charge corresponding to a phone number of the consumer mobile phone at the carrier server .

As illustrated in at development and setup is first completed. The development and setup comprises configuring of a pricing matrix and associated functioning and the writing and development of the mobile phone application . At a transaction is processed using the mobile phone application and the pricing matrix together with associated functioning.

At the merchant development computer is used to create a service in the account. The billing server then creates the service in the account on the billing server .

At the merchant development computer is used for adding countries for a pricing matrix to the service. The billing server receives the countries of the pricing matrix as part of a configuration input from the merchant server and adds the countries of the pricing matrix to the service and allows for an operator at the merchant development computer to configure the pricing matrix on the billing server .

At the merchant development computer is used for configuring a pricing matrix on the billing server . The billing server receives a configuration input from the merchant development computer .

Steps through are primarily carried out by the application writing and publishing tool of the merchant development computer in . At the application writing and publishing tool is used to write a mobile phone application that eventually becomes the mobile phone application residing on the consumer mobile phone .

At the application writing and publishing tool is used to set permissions of the service call . By adding these permissions when the user downloads the application the application will request permission to receive and send SMS which is required for the service call to successfully process transactions.

At the application writing and publishing tool is used to create a payment request that directs the service call to make a payment request to the billing server . At the application writing and publishing tool is used to publish the mobile phone application to a consumer device in this case the consumer mobile phone .

At a developer at a merchant also stores a prompting routine on the merchant server . The prompting routine prompts the merchant server to call a billing service application programmable interface API which retrieves price points from the billing server . The merchant server then retrieves the price points from the billing server . The price points that are retrieved are general price points that can be retrieved at longer intervals that do not necessarily coincide with purchasing intervals. For example the price points that are retrieved in general can be retrieved on a daily basis a weekly basis or a monthly basis.

The price points depend on the type of items that are being sold. There are primarily two types of items available for purchase in a mobile application which are 

Virtual currency packages are divisible and therefore can be adjusted to match up with fixed price points. For example if 1 gold coin USD 0.01 rounded to the nearest 5 coins may result in price point packages as illustrated in Table 1 

When selling virtual currency selecting up to five price points for each country are advisable to ensure that every user around the world sees mobile price points that are available to them.

Virtual goods e.g. a magic sword or a castle upgrade are more cumbersome to price because they cannot be partially awarded. Therefore a merchant has to determine a price range that they are willing to offer for the product. If there is no price point available in a given country within the range the merchant will disable the mobile payment option for the product in that country. For example if the merchant is willing to accept a price range between USD 0.75 to 1.25 for a magic sword Table 2 illustrates how the merchant will select what prices to offer in each market.

What should also be noted is that at least one price point e.g. GPB 10.00 for one of the countries e.g. United Kingdom differs from all price points USD 2.00 USD 5.00 USD 9.99 USD 19.99 USD 24.99 of another country United States of America . What should also be noted is that two different countries e.g. United Kingdom and United States of America are in different currencies GPB and USD .

Other restrictions may also be provided depending on the country. Table 3 illustrates certain restrictions that are supported by respective countries.

As can be seen from Table 3 the price point for at least one country e.g. Romania is only supported below a predetermined amount e.g. 2.99 . The price points for at least one country e.g. Philippines are only supported for a set of predetermined amounts e.g. Php20.00 Php40.00 Php60.00 Php100.00 Php200.00 Php300.00 Php400.00 Php500.00 .

Once the pricing matrix of is configured the operator at the merchant development computer then selects a button to store the pricing matrix on the billing server . The billing server then stores the pricing matrix on the billing server .

The remainder of and B illustrate one transaction that is executed based on the price point received at . As mentioned earlier the shopping browser in is used by a consumer to shop within a store on the merchant server . At checkout the consumer mobile phone transmits a transaction request to the merchant server . When the merchant server receives the transaction request the merchant server identifies a country of the consumer mobile phone based on the payment request. The payment request may for example include the country of the consumer mobile phone . Alternatively the payment request may include a phone number of the consumer mobile phone that is used in a lookup to determine a country corresponding to the phone number. Other methods are known in the art for determining a country of a consumer mobile phone . The merchant server then matches the country of the consumer mobile phone with a country in the pricing matrix. For example if the country of the consumer mobile phone is determined to be Spain then the merchant server matches the country of the consumer mobile phone with the fifth column in for Spain.

At the merchant server responds to the transaction request received at to transmit and display price points to the consumer mobile phone . illustrates price points that are displayed on the consumer mobile phone for three different levels. In the example the consumer can buy multiples of 100 points for three different prices at three different price points. At in the consumer selects one of the price points on the consumer mobile phone . At the user selection of product and price is transmitted from the consumer mobile phone to the merchant server . At the merchant server transmits a transaction request API call to the billing server . The making of the transaction request API call at will initiate a transaction at the billing server . At the billing server returns an transaction request Extensible Markup Language XML response with a unique transaction ID and SMS instructions to the merchant server .

Parameters that are included in the transaction request XML response transmitted at are listed in Table 5

At the merchant server transmits a purchase confirmation to the consumer mobile for display thereon. shows a payment dialogue that is displayed on the consumer mobile phone when the consumer selects one of the options in and following the purchase confirmation that is received at in . At the consumer clicks Buy to confirm the purchase. At the consumer mobile phone transmits a confirmation of the purchase to the merchant server . The merchant server then receives the confirmation of the purchase from the consumer mobile phone .

As shown in the merchant server at triggers a silent SMS message to the consumer mobile phone in response to the purchase confirmation received at . The silent SMS message includes the unique transaction ID received by the merchant server in the transaction request XML response at . At the service call of the purchasing unit shown in responds to the silent SMS message by sending an SMS message with the unique transaction ID to a short code of the billing server . The SMS message transmitted at is transmitted through the carrier server and at the carrier server forwards the SMS message to the billing server . The carrier server appends its identifier to the SMS message. The billing server then retrieves the msisdn of the consumer mobile phone from the SMS message and the identifier of the particular carrier server . The billing server then determines whether there is a match between the transaction ID in the SMS text message received at and the transaction ID in the transaction request response at . If a match exists the billing server then proceeds to attempt to charge an account on the carrier server .

At the billing server transmits a charge request to the carrier server to charge an account on the carrier server corresponding to the phone number. The carrier server then attempts to place a charge on an account the carrier server corresponding to the phone number. If the charge is successful the carrier server at returns a confirmation message to the billing server that the charge has been placed. The billing server at responds to the charge confirmation to transmit a billingresult callback notification a final transaction callback notification to the merchant server . The billing server then at transmits an SMS message to the carrier server that includes the confirmation and the phone number of the consumer mobile phone . At the carrier server automatically forwards the SMS confirmation message to the consumer mobile phone . The SMS messaging application in is used for transmitting the payment authorization and for receiving and displaying the payment the confirmation received at in .

The billing server at displays the transaction results within the application of the consumer mobile phone . The transaction result transmitted at is transmitted in response to the callback notification received at . shows a payment dialogue that is displayed on the consumer mobile phone after the consumer has selected Buy in and before the transaction result is received at . illustrate views that are displayed on the consumer mobile phone respectively if the account on the carrier server was successfully charged or if the account on the carrier server was not charged because of temporary unavailability of services. The billing server at transmits a final transaction callback notification to the merchant server . The merchant server then records the transaction as completed within an account for the consumer mobile phone on the merchant server .

The various components shown in may be implemented in hardware software or a combination of hardware and software including one or more signal processing and or application specific integrated circuits.

The memory may include high speed random access memory and may also include non volatile memory such as one or more magnetic disk storage devices flash memory devices or other non volatile solid state memory devices. Access to the memory by other components of the consumer mobile phone such as the CPU and the peripherals interface is controlled by the memory controller .

The peripherals interface connects the input and output peripherals of the device to the CPU and memory . The one or more processors run or execute various software programs and or sets of instructions stored in the memory to perform various functions for the consumer mobile phone and to process data.

The RF radio frequency circuitry receives and sends RF signals also called electromagnetic signals. The RF circuitry converts electrical signals to from electromagnetic signals and communicates with communications networks and other communications devices via the electromagnetic signals. The RF circuitry includes well known circuitry for performing these functions including an antenna system an RF transceiver one or more amplifiers a tuner one or more oscillators a digital signal processor a CODEC chipset a subscriber identity module SIM card memory and so forth. The RF circuitry may communicate with networks such as the Internet also referred to as the World Wide Web WWW an intranet and or a wireless network such as a cellular telephone network a wireless local area network LAN and or a metropolitan area network MAN and other devices by wireless communication. The wireless communication may use any of a plurality of communications standards protocols and technologies that are known in the art.

The audio circuitry the speaker and the microphone provide an audio interface between a user and the consumer mobile phone . The audio circuitry receives audio data from the peripherals interface converts the audio data to an electrical signal and transmits the electrical signal to the speaker . The speaker converts the electrical signal to human audible sound waves. The audio circuitry also receives electrical signals converted by the microphone from sound waves. The audio circuitry converts the electrical signal to audio data and transmits the audio data to the peripherals interface for processing. The audio circuitry also includes a headset jack serving as an interface between the audio circuitry and removable audio input output peripherals such as output only headphones or a headset with both output e.g. a headphone for one or both ears and input e.g. a microphone .

The I O subsystem connects input output peripherals on the consumer mobile phone such as the touch screen and other input control devices to the peripherals interface . The I O subsystem includes a display controller and one or more input controllers for other input or control devices. The one or more input controllers receive send electrical signals from to other input or control devices . The other input control devices may include physical buttons e.g. push buttons rocker buttons etc. dials slider switches joysticks click wheels and so forth all serving as forming part of an interface. The input controllers may be connected to any of the following a keyboard infrared port USB port and a pointer device such as a mouse. The one or more buttons may include an up down button for volume control of the speaker and or the microphone . The one or more buttons may include a push button. A quick press of the push button may disengage a lock of the touch screen or begin a process that uses gestures on the touch screen to unlock the device. A longer press of the push button may turn power to the consumer mobile phone on or off. The touch screen is used to implement virtual or soft buttons and one or more soft keyboards.

The touch sensitive touch screen provides an input interface and an output interface between the device and a user. The display controller receives and or sends electrical signals from to the touch screen . The touch screen displays visual output to the user. The visual output may include graphics text icons video and any combination thereof collectively termed graphics . In some embodiments some or all of the visual output may correspond to user interface objects further details of which are described below.

A touch screen has a touch sensitive surface sensor or set of sensors that accepts input from the user based on haptic and or tactile contact. The touch screen and the display controller along with any associated modules and or sets of instructions in memory detect contact and any movement or breaking of the contact on the touch screen and converts the detected contact into interaction with user interface objects e.g. one or more soft keys icons web pages or images that are displayed on the touch screen. In an exemplary embodiment a point of contact between a touch screen and the user corresponds to a finger of the user.

The touch screen may use LCD liquid crystal display technology or LPD light emitting polymer display technology although other display technologies may be used in other embodiments. The touch screen and the display controller may detect contact and any movement or breaking thereof using any of a plurality of touch sensing technologies now known or later developed including but not limited to capacitive resistive infrared and surface acoustic wave technologies as well as other proximity sensor arrays or other elements for determining one or more points of contact with a touch screen .

The user may make contact with the touch screen using any suitable object or appendage such as a stylus a finger and so forth. In some embodiments the user interface is designed to work primarily with finger based contacts and gestures which are much less precise than stylus based input due to the larger area of contact of a finger on the touch screen. In some embodiments the device translates the rough finger based input into a precise pointer cursor position or command for performing the actions desired by the user.

The consumer mobile phone also includes a power system for powering the various components. The power system may include a power management system one or more power sources e.g. battery alternating current AC a recharging system a power failure detection circuit a power converter or inverter a power status indicator e.g. a light emitting diode LED and any other components associated with the generation management and distribution of power in portable devices.

The software components stored in memory include an operating system a communication module or set of instructions a contact motion module or set of instructions a graphics module or set of instructions a text input module or set of instructions and applications or set of instructions .

The operating system e.g. Darwin RTXC LINUX UNIX OS X WINDOWS or an embedded operating system such as VxWorks includes various software components and or drivers for controlling and managing general system tasks e.g. memory management storage device control power management etc. and facilitates communication between various hardware and software components.

The communication module facilitates communication with other devices over one or more external ports and also includes various software components for handling data received by the RF circuitry and or the external port . The external port e.g. Universal Serial Bus USB FIREWIRE etc. is adapted for coupling directly to other devices or indirectly over a network e.g. the Internet wireless LAN etc. .

The contact motion module may detect contact with the touch screen in conjunction with the display controller and other touch sensitive devices e.g. a touchpad or physical click wheel . The contact motion module includes various software components for performing various operations related to detection of contact such as determining if contact has occurred determining if there is movement of the contact and tracking the movement across the touch screen and determining if the contact has been broken i.e. if the contact has ceased . Determining movement of the point of contact may include determining speed magnitude velocity magnitude and direction and or an acceleration a change in magnitude and or direction of the point of contact. These operations may be applied to single contacts e.g. one finger contacts or to multiple simultaneous contacts e.g. multitouch multiple finger contacts . The contact motion module and the display controller also detects contact on a touchpad.

The graphics module includes various known software components for rendering and displaying graphics on the touch screen including components for changing the intensity of graphics that are displayed. As used herein the term graphics includes any object that can be displayed to a user including text web pages icons such as user interface objects including soft keys digital images videos animations and the like.

The text input module which may be a component of graphics module provides soft keyboards for entering text in various applications e.g. contacts e mail IM blogging browser and any other application that needs text input . The applications may include the mobile application .

The exemplary computer system includes a processor e.g. a central processing unit CPU a graphics processing unit GPU or both a main memory e.g. read only memory ROM flash memory dynamic random access memory DRAM such as synchronous DRAM SDRAM or Rambus DRAM RDRAM etc. and a static memory e.g. flash memory static random access memory SRAM etc. which communicate with each other via a bus .

The computer system may further include a video display e.g. a liquid crystal displays LCD or a cathode ray tube CRT . The computer system also includes an alpha numeric input device e.g. a keyboard a cursor control device e.g. a mouse a disk drive unit a signal generation device e.g. a speaker and a network interface device .

The disk drive unit includes a machine readable medium on which is stored one or more sets of instructions e.g. software embodying any one or more of the methodologies or functions described herein. The software may also reside completely or at least partially within the main memory and or within the processor during execution thereof by the computer system the memory and the processor also constituting machine readable media. The software may further be transmitted or received over a network via the network interface device .

While certain exemplary embodiments have been described and shown in the accompanying drawings it is to be understood that such embodiments are merely illustrative and not restrictive of the current invention and that this invention is not restricted to the specific constructions and arrangements shown and described since modifications may occur to those ordinarily skilled in the art.

