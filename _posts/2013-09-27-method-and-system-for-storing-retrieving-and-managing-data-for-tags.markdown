---

title: Method and system for storing, retrieving, and managing data for tags
abstract: This invention relates generally to a method and system for storing, retrieving, and managing data for tags that are associated in some manner to any type of object. More particularly, the present invention writes data to these tags, reads data from these tags, and manages data that is written to and/or read from these tags.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09460233&OS=09460233&RS=09460233
owner: MOTEDATA INC.
number: 09460233
owner_city: Summerlin
owner_country: US
publication_date: 20130927
---
This application is a continuation of U.S. patent application Ser. No. 12 125 998 filed May 23 2008 which is a division of U.S. patent application Ser. No. 10 952 789 filed Sep. 30 2004 now U.S. Pat. No. 7 388 488 which claims priority from U.S. Provisional Patent Application Ser. No. 60 515 449 filed Oct. 30 2003 the contents of all of which is incorporated herein by reference.

This invention relates generally to a method and system for storing retrieving and managing data for tags that are associated in some manner to any type of object. More particularly the present invention writes data to these tags reads data from these tags and manages data that is written to and or read from these tags.

This invention involves a method and system for storing retrieving and managing data for any type of tag that is associated in any type of manner to any type of object physical or abstract animate or inanimate. A tag is any device that sends receives and or stores data about whatever it is monitoring or is associated with it includes many different types such as radio frequency identification device RFID tags laser tags cellular phones devices that receive and transmit signals from television networks any type of satellite communication network such as a Global Positioning System GPS etc. A tag may be powered by any type of power source such as a DC power source an AC power source solar etc. Identification devices are further described in U.S. Pat. No. 3 752 960 to Charles Walton entitled Electronic Identification Recognition System the contents of which are herein incorporated by reference. The types of objects that may be associated with tags include but are not limited to people animals plants things of any kind real property such as houses lots condominiums mobile homes and townhouses valuable items such as paintings diamonds jewelry watches and antiques movable items such as automobiles airplanes military vehicles bicycles motorcycles boats ships components thereof locations environmental conditions abstractions concepts phenomena etc. Associations between tags and objects can be of any type including but not limited to one to many many to one or one to one physical logical etc. Physical associations may include attaching and or inserting the tag to its associated object.

The present invention is adapted for a wide variety of uses. For example the method and system of the present invention may be used to authenticate valuable items to manage inventory such as the tracking of objects of any kind through manufacturing supply chain distribution etc. to the point of sale and beyond to track the movements of objects such as people animals plants movable items etc. to retrieve historical data such as price histories from things such as valuable items and real property to retrieve any type of health data such as medical conditions treatment history medication instructions etc. from people and animals to track any type of health conditions such as heart rate pulse rate temperature the amount of different things in the blood such as oxygen sugar etc. for people and animals.

Many different benefits may arise from the various uses of the present invention. For example its use may decrease the costs of determining the value of a thing such as a valuable item because for instance the price history and other similar data for that item could be easily stored and retrieved from its associated tag. The availability of price history from a tag associated with a house as well as that from other houses in the same neighborhood may prevent a seller from charging an excessively high value to a buyer with little or no knowledge of the actual value of the house. Use of the present invention may prevent the fraudulent substitution of a counterfeit for a valuable item because identification data from the item s associated tag could be used to verify that item s authenticity. Use of the present invention may prevent a car owner from passing off a damaged car as an undamaged one to an unsuspecting buyer because a car s accident history could be stored and retrieved from the car s associated tag. Use of the present invention could prevent the theft of military secrets because clearance information could be easily accessed from the tag associated with a person to determine whether that person should have access to such secrets. Use of the present invention may avoid injury or even death to athletes that may occur while they are performing because their heart rate temperature and other medical conditions could be easily monitored. For similar reasons a coach could use the present invention to quickly determine which players are too fatigued to be effective an athletic recruiter could use the present invention to determine which players are better able to handle the rigors of competition and athletic trainers could use the present invention to tailor training programs to particular athletes. Use of the present invention may ease the authentication of evidence at trial because chain of custody could be easily retrieved from the evidence s associated tag at trial. Use of the present invention will further automate and simplify the management of inventory.

Tags and similar devices have been disclosed in other references but no prior art reference discloses the use of such tags in a system and method for storing retrieving and managing data for a variety of applications including authentication tracking health care monitoring health care management knowledge acquisition etc. In contrast for example U.S. Pat. Nos. 6 440 096 5 358 514 5 193 540 6 107 102 and 6 405 066 discuss the implantation of microdevices in people. U.S. Pat. Nos. 5 606 260 4 892 709 5 367 878 6 152 181 5 834 790 5 186 001 5 839 056 and 5 144 298 discuss the use of microdevices as sensors or controllers.

Accordingly there exists a need for a system and method for storing retrieving and managing data for any type of tag that is associated in any type of manner to any type of object.

The invention provides a system and method for storing retrieving and managing data for any type of tag that is associated in any type of manner to any type of object for a variety of applications.

In particular it is an aspect of the present invention to present a system for storing retrieving and managing data for one or more objects comprising 

at least one receiver for receiving control data and information data from at least one of said components into at least one of said tags wherein said information data is about the object that is associated with said at least one tag 

at least one transmitter for transmitting at least a portion of said information data to at least one of said components in accordance with said control data and

at least one communication network for facilitating said communicating among said components and said tags 

wherein at least one of said components transmits at least one query to receive at least a portion of said information data about said object associated with said at least one tag.

It is a further aspect of the present invention to present a method for storing retrieving and managing data for one or more objects comprising the steps of 

receiving control data and information data from at least one of said components into at least one of said tags wherein said information data is about the object that is associated with said at least one tag 

transmitting at least a portion of said information data from said at least one tag to at least one of said components in accordance with said control data and

transmitting from said at least one of said components at least one query to receive at least a portion of said information data about said object associated with said at least one tag.

It is a further aspect of the present invention to present a method for managing children comprising the steps of 

receiving said information data into said one or more tags said information data concerning one or more of the following the identity of people that came into contact with the one or more children at least one measurement of at least one environmental condition to which the one or more children was exposed the academic performance of the one or more children the athletic performance of the one or more children at least one measurement of the medical condition of the one or more children and

transmitting at least a portion of said information data from said at least one tag in accordance with said control data.

The invention provides a system and method for storing retrieving and managing data for any type of tag that is associated in any type of manner to any type of object physical or abstract animate or inanimate for a variety of applications.

While the present invention will be explained within the context of several different applications such as the authentication of objects including valuable items and evidence and the monitoring of children by their parents the present invention can be applied to any application which would benefit from the storage retrieval and management of data for tags that are associated with any kind of object. These applications include the exchange of objects such as real property goods and service monitoring the vital signs of the ill the elderly and athletes athletic training programs monitoring environmental conditions traffic and consumer behavior in various settings such as amusement parks shopping centers casinos tracking the location of people such as prisoners students foreigners military personnel and workers in classified areas tracking the location of goods of any type such as inventory from manufacturing the supply chain distribution etc. to the point of sale and beyond tracking the location of classified material tracking the manufacturing sale and repair histories of goods such as machinery cars airplanes trains and components thereof monitoring movement of people and things such as vehicles traffic etc. at locations such as a battlefield a highway etc. monitoring the flow of oil and other fluids in pipelines etc.

The tags may be one of a variety of a different types including Radio Frequency Identification Device RFID tags laser tags cellular phones devices that receive and transmit signals from a Global Positioning System GPS etc. The tags may be powered by any kind of power source such as a DC power source an AC power source solar power etc. Each tag may have the ability to receive data store data sense data and or transmit data. Data may be received and transmitted to other tags sensors computers and database management systems . The tags may have the ability to sense data from its associated object its environment etc. Data sensed from an associated object such as a person or animal may include medical data such as temperature oxygen content in the blood heart rate etc. Data sensed from the environment may include the content of various gases poisons and pollutants in the air or water the temperature the humidity barometric pressure chemicals motion light sound etc.

The present invention may further include sensors . Sensors may be of any type and may sense any kind of data. Sensors may be powered by any type of power source such as an AC power source a DC power source solar power etc. Sensors may include thermometers motion detectors Global Positioning System GPS devices chemical sensors etc. Computers may include database management systems for the storage and management of data associated with tags in any way including data transmitted to and or retrieved from the tags . Data may be transmitted to tags from computers for storage within the tags and may be transmitted from the tags to computers . Data retrieved from tags may be stored and managed in database management system .

The present invention may further include a communication network which may include a variety of different types of components and software to communicate different types of data among the tags sensors computers etc. These components and software may include modulator demodulators modems satellites up and down frequency converters including those for communications with the satellites audio video encoders routers hubs bridges etc. In one embodiment the communication network may be a cellular telephone network. In another embodiment the communication network may be any type of satellite network such as GPS. In another embodiment the communication network may be a television network. In another embodiment the communication network may include the Internet. Communication may be accomplished on the Internet by one or more internet applications including the World Wide Web. Communication network may be an intranet or an extranet. An intranet is a private network typically a local area network LAN or a wide area network WAN that enables the use of Internet based applications in a secure private environment. Extranets are intranet type networks that link multiple sites or organizations using intranet related technologies.

The World Wide Web is built on a protocol called the Hypertext Transport Protocol HTTP . Computers may include browser software for requesting data input by tags and sensors and or data stored in a database management system . Requests for data from browser software may be handled by server software . The server software may locate the requested data and may transmit it to the requesting browser software . Computers may further include application server software which may extend the capabilities of the server software . In particular the application server software may pre process a page of data before it is sent to the requesting browser software .

In one embodiment the application server software is a Cold Fusion application. Cold Fusion is a World Wide Web application for creating dynamic page applications and interactive Web sites by combining standard Hypertext Markup Language HTML files with Cold Fusion Markup Language CFML instructions as specified in The Macromedia Cold Fusion 5 Web Application Construction Kit Ben Forta and Nate Weiss Fourth Edition hereinafter Cold Fusion 5 Chapter 1 the contents of which are herein incorporated by reference. HTML is a page markup language that enables the creation and layout of pages and forms. In one embodiment of the present invention a Cold Fusion application defines fill out forms for entry of data including the data to control the operation of the tags and sensors and queries for data.

In one embodiment a Cold Fusion application is used to retrieve or update data in the database management system . The Cold Fusion application may access the database management system through an interface called Open Database Connectivity ODBC which is a standard Application Programming Interface API for accessing information from different database systems and different formats as explained in ColdFusion 5 Chapter 6 the contents of which are herein incorporated by reference.

In an alternate embodiment data may be input using a program written in a language that manipulates text files and information. An exemplary language is PERL as specified in Programming Perl Larry Ward and Randal L. Schwartz O Reilly Associates Inc. March 1992 the contents of which are herein incorporated by reference.

The database may be a distributed database which may be stored among many computers or may be a central database. Database may be of any type including a relational database or a hierarchical database. Databases and database management systems are described in Database System Concepts Henry F. Korth Abraham Silberschatz McGraw Hill 1986 Chapter 1 the contents of which are herein incorporated by reference. Exemplary databases include Microsoft Structured Query Language SQL Server Microsoft Access 1.0 2.0 and 7.0 Microsoft FoxPro 2.0 2.5 and 2.6 Oracle 7.0 Borland Paradox 3.X and 4.X Borland dBase III and dBase IV and Microsoft Excel 3.0 4.0 and 5.0.

In one embodiment data is retrieved inserted updated or deleted from database using Structured Query Language SQL . SQL is described in SAMS Teach Yourself SQL 2Edition Ben Forta the contents of which are herein incorporated by reference.

The present invention may include additional components to manage the data received from tags sensors and elsewhere. These additional components may include a search tool. In one embodiment the search tool is Verity. Data may be organized into one or more collections. Verity may then be used to index the collection and compile metadata about the collection to enable it to search the collection quickly. Conceptually Verity s usefulness is attributed to its ability to index and compile information about the collection and use this information to quickly search the collection when asked to do so. Searches and queries may be specified using Verity operators including concept operators such as STEM WORD and WILDCARD proximity operators such as NEAR and PHRASE relation operators such as CONTAINS MATCHES STARTS ENDS and SUBSTRING search modifiers such as CASE MANY NOT and ORDER and score operators such as YES NO COMPLEMENT PRODUCT and SUM. Search forms and search results pages may be defined using HTML with Cold Fusion tags. The creation and searching of collections and the display of search results using Verity is described in ColdFusion 5 Chapter 36 the contents of which are herein incorporated by reference. Web Browser software may display the web pages from the server software including the fill out form for data input the fill out form for input of search criteria and the search results text data. The present invention may also display audio and video data input by tags and sensors using an on demand video and audio streaming server such as RealServer as explained in RealServer Administration and Content Creation Guide the contents of which are herein incorporated by reference.

In another embodiment the search engine may be a commercial search engine such as Alta Vista Google Yahoo etc. A commercial search engine may be integrated into the present invention using Cold Fusion tags as explained in ColdFusion 5 Chapter 36.

Before performing the search the search engine may optimize the queries as specified in Database System Concepts Henry F. Korth Abraham Silberschatz McGraw Hill 1986 Chapter 9 the contents of which are herein incorporated by reference.

The checking may be performed by a variety of different techniques including but not limited to those using cryptography the art and science of keeping messages secure and any other type of secure communication including an intranet a virtual private network VPN etc. Cryptography may be used in the present invention for authentication integrity and or non repudiation. Authentication enables a receiver of a message to ascertain its origin. Integrity enables a receiver of a message to verify that the message has not been modified in transit. Non repudiation prevents a sender of a message from falsely denying that it did indeed send the message.

In one embodiment a symmetric algorithm is used. With symmetric algorithms the encryption key can be calculated from the decryption key and vice versa. The key must remain secret to keep the communication secret. In another embodiment a public key algorithm also called asymmetric algorithm is used. With a public key algorithm the decryption key cannot be computed from the encryption key in a reasonable amount of time. The encryption key is made public and is called the public key. The decryption key is kept secret and is called the private key. In another embodiment digital signatures may be used. With digital signatures a message is encrypted with a private key by a sender thereby signing the message and decrypted with a public key by the recipient thereby verifying the signature. Exemplary digital signature algorithms include Rivest Shamir Adelman RSA and the Digital Signature Algorithm DSA proposed by the National Institute of Standards and Technology NIST . Cryptography including symmetric algorithms public key algorithms and digital signatures are described in Applied Cryptography by Bruce Schneier Chapters 1 2 19 and 20 the contents of which are herein incorporated by reference.

If the check in step indicates that the received data is authorized to be stored in the tag then control proceeds to step . In step the data is stored in the tag . After step control proceeds to step where the tag waits for the receipt of new data. If the check in step indicates that the received data is not authorized to be stored in the tag then control returns to step .

In step the tag awaits a request for data. Control remains in step until such a request is received after which it proceeds to step . In step the tag may receive the request which may have been transmitted from any type of component including but not limited to a client a server a database a sensor another tag etc. In step a check may be done to determine whether or not the received request is authorized to receive a response in the tag . Step may include checking whether the source of the request has the authority to receive the type of data that is requested. The checking may be performed by a variety of different techniques including those using cryptography as explained in detail above. The checking may alternatively be done by some form of password verification. If the check in step indicates that the request is authorized to receive data in response then control proceeds to step . In step the requested data is transmitted to the source of the request. After step control proceeds to step where the tag waits for the receipt of a new request. If the check in step indicates that the request is not authorized to receive data in response then control returns to step .

In one embodiment communication between one or more of the tags and one or more of the sensors with the server software may be performed using a Wireless Application Protocol WAP which is described in ColdFusion 5 Chapter 34 the contents of which are incorporated by reference.

The present invention may have many different uses. For example it could be used by parents to monitor their children s activities. A parent may associate a tag to a child by any means such as by physically attaching or implanting the tag on the child. From browser software or elsewhere a parent may transmit control data to the child s tag to indicate that the tag should accept data from other tags associated with particular people sensors such as global positioning system GPS satellites identifying the child s location throughout the day or environmental sensors identifying the content of the air or water i.e toxins to which the child is exposed. The tag on the child executes the process for the storage of data in tags illustrated by the flow diagram of in order to analyze and store the control information sent by the parent. At a subsequent time the parent may transmit one or more queries from browser software or elsewhere to learn the identity of the people that came into contact with the child to retrieve test scores or notes from a teacher that the child may have received that day the quality of the air and water to which the child was exposed and the child s movements. The tag associated with the child executes the process for transmitting data from the child s tag illustrated by the flow diagrams of in order to respond to the parent s query.

The parent may in the alternative transmit additional control data to the child s tag from browser software or elsewhere instructing the child s tag to periodically transmit data from the tag to a database . At any subsequent time the parent may transmit one or more queries from browser software or elsewhere to a database to learn the same information about the child.

Authorized Components For Receipt Table This field specifies the components i.e tags sensors etc. from which the child s tag may receive data.

Authorized Data For Receipt Table This field specifies the types of data i.e data identifying the people associated with the tags with which the child came into contact test scores teacher notes environmental data location data etc. that the child s tag may receive.

Authorized Components For Transmission Table This field specifies the components i.e database etc. to which the child s tag may transmit data.

Authorized Data For Transmission This field specifies the types of data that the child s tag may transmit.

Identification Query This field requests the identify of the tagged objects such as people and animals that came into contact with the child.

Environmental Query This field requests the content of the water and air to which the child had contact.

Performance Query This field requests data on the child s behavior academic performance and athletic performance.

The present invention may be used to authenticate objects such as valuable items sports memorabilia and evidence. A vendor may associate a tag to a valuable item such as a diamond or painting by any means such as by physically attaching or implanting the tag on the item. From browser software or elsewhere a vendor may transmit control data to the object s tag to indicate that the tag should accept data from other tags identifying the people associated with the other tags sensors such as global positioning system GPS satellites identifying the object s location throughout the day or environmental sensors identifying the content of the air or water i.e toxins to which the object is exposed. The tag on the object executes the process for the storage of data in tags illustrated by the flow diagram of in order to analyze and store the control information sent by the vendor. At a subsequent time the vendor can transmit one or more queries from browser software or elsewhere to learn the identity of the people that handled the object the quality of the air and water to which the object was exposed the object s movements the chain of title the chain of possession and the identity of the object s manufacturers retailers and distributors. The tag associated with the object executes the process for transmitting data from the object s tag illustrated by the flow diagrams of in order to respond to the vendor s query.

The vendor may in the alternative transmit additional control data to the object s tag from browser software or elsewhere instructing the object s tag to periodically transmit data from the tag to a database . At any subsequent time the vendor may transmit one or more queries from browser software or elsewhere to the database to learn information about the object.

Another embodiment of the invention performs proximity tracking. In this embodiment an event may be recorded within a tag when it comes within a range of other tags. These recorded events may be later sent to a database. This embodiment may be used generally to track the objects that have come into proximity with another object. For example this embodiment may be used to track the people that have come into contact with a child or the places where a child has been. This embodiment may also be used to track the movement of objects with respect to locations within a secure facility.

In one embodiment the tags may contain one or more of the following a radio transmitter a radio receiver a memory control software a processor and a clock. The memory may include a RAM and a ROM. The control software may be stored in the ROM. The processor may be of a type that consumes less power.

The tags may contain one or more data structures including a tag identifier a tag identifier map and a time field. The tag identifier may be a variable length string of up to 255 bytes and may be used to distinguish tags from each other. The tag identifier map may map a tag identifier to a public key and a counter. In one embodiment the tag identifier map is implemented with a hash table. In another embodiment the tag identifier is implemented with a binary search tree. The tag identifier map may be initialized with the public keys of certain tags such as those that are expected to be encountered and or those that are determined to be sensitive. This scheme enables tags to quickly discard messages from tags with invalid signatures. Entries in the tag identifier map may be discarded after the map becomes full. Entries may be discarded in any order such as first in first out FIFO least recently used LRU etc. The time field may be a four byte unsigned integer and may contain the current time in any form such as Greenwich Mean Time GMT .

If the protocol identifier is a tag identifier broadcast control proceeds to step . In step the tag identifier of the tag identifier broadcast is checked to determine if it is valid. If it is not valid the broadcast is ignored and control returns to step . If it is valid control proceeds to step . In step the time in the tag identifier broadcast is checked to determine whether it is within one minute of the current time. If it is not then the broadcast is ignored and control returns to step . If it is then control proceeds to step . In step the tag identifier in the tag identifier broadcast is checked to determine whether it is present in the tag identifier map i.e. has been previously encountered by the tag . If not control proceeds to step . In step a new entry is created for the tag identifier in the tag identifier map and the number of encounters for that entry is set to one. Control then proceeds to step .

If the tag identifier is determined to be present in the tag identifier map in step then control proceeds to step . In step it is determined whether the tag identifier in the tag identifier broadcast has a public key. If so then control passes to step . In step the public key is used to verify the signature. If the signature verification in step is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the number of encounters for the tag identifier in the tag identifier map is incremented.

If the protocol identifier is determined to be a central authority broadcast in step then control proceeds to step . In step the time in the central authority broadcast is checked to determine if it is within one minute of the current time. If not then the broadcast is ignored and control returns to step . If so control proceeds to step . In step the public key of the central authority is used to verify the signature in the central authority broadcast. If the signature verification is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the tag identifier map is encrypted with the central authority public key. In step the encrypted tag identifier map is broadcast. Control then returns to step .

If the interrupt is determined to be a timer interrupt in step control proceeds to step . In one embodiment the timer interrupt occurs every 15 seconds. In step the signature is created using the tag s private key. In step the signature the tag identifier and the current time are written to the tag identifier broadcast. In step the tag identifier broadcast is broadcast. Control then returns to step .

The embodiment of has a number of advantages. The signature makes it infeasible for any preregistered tag to spoof a real tag. Replay attacks are blocked by the time stamp.

The private keys may be secured the central authority may be in a secure location and the tags may be tamper resistant. These options prevent one tag from repudiating contact with another tag. A replacement strategy may be used to prevent attempts to flood the tag identifier map by broadcasting of spurious tag identifiers. In another embodiment a global public private key pair may be used to authenticate broadcasts.

Another embodiment of the invention sounds an alarm within a predetermined time if a tag goes outside a particular range of one or more other tags. In one embodiment the range is a mutual transmit receive range. In one embodiment the predetermined time is sixty seconds. One tag may be physically attached to a sensitive object that must not leave a secure area. The other tag may be built into a secure immobile location such as a floor or ceiling or may be carried by authorized personnel. In one embodiment a protocol enables and disable tags so that objections can be removed by authorized parties.

This embodiment may be used to alert security personnel to the movement of objects out of a secure facility to alert employees to theft of inventory from a store to alert a parent or day care provider to a child that strays outside of a certain area to alert a person to the theft of a motor vehicle or to the theft of valuable objects from the home to alert a escort in a secure facility of abandonment by a guest to alert the authorities of the escape of a criminal from prison or from a house for those criminals under house arrest etc.

In one embodiment the tags may contain one or more of the following a radio transmitter a radio receiver a memory control software a processor a clock and an audible alarm. The memory may include a RAM and a ROM. The control software may be stored in the ROM. The processor may be of a type that consumes less power.

The tags may contain one or more data structures including a tag identifier a tag identifier of a partner tag a private key for the tag a public key for the partner tag a public key of a control authority an alarm counter an enable flag and a time field. The tag identifier may be a variable length string of up to 255 bytes and may be used to distinguish tags from each other. The tag identifier of the partner tag may be a variable length string of up to 255 bytes. The private and public keys may be 16 bytes. The alarm counter may be four bytes. The enable flag may be four bytes. The time field may be a four byte unsigned integer and may contain the current time in any form such as Greenwich Mean Time GMT .

If the protocol identifier is a tag identifier broadcast control proceeds to step . In step the tag identifier of the tag identifier broadcast is checked to determine if it is valid. If it is not valid the broadcast is ignored and control returns to step . If it is valid control proceeds to step . In step the time in the tag identifier broadcast is checked to determine whether it is within one minute of the current time. If it is not then the broadcast is ignored and control returns to step . If it is then control proceeds to step . In step the public key of a partner tag may be used to verify the signature in the tag identifier broadcast. If the signature verification in step is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the alarm counter is reset to zero.

If the protocol identifier is determined to be a control authority enable broadcast in step then control proceeds to step . In step the time in the control authority enable broadcast is checked to determine if it is within one minute of the current time. If not then the broadcast is ignored and control returns to step . If so control proceeds to step . In step the public key of the control authority is used to verify the signature in the control authority enable broadcast. If the signature verification is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the enable flag is set to one. Control then returns to step .

If the protocol identifier is determined to be a control authority disable broadcast in step then control proceeds to step . In step the time in the control authority disable broadcast is checked to determine if it is within one minute of the current time. If not then the broadcast is ignored and control returns to step . If so control proceeds to step . In step the public key of the control authority is used to verify the signature in the control authority enable broadcast. If the signature verification is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the enable flag is set to zero. Control then returns to step .

If the interrupt is determined to be a timer interrupt in step control proceeds to step . In one embodiment the timer interrupt occurs every six seconds. In step the enable flag is added to the alarm counter. In step the alarm counter is checked to determine if it is greater than a limit. In one embodiment the limit may be 10 seconds. If the alarm counter is greater than the limit control proceeds to step . In step the tag sounds an alarm. Control then proceeds to step .

If the alarm counter is determined to be less than or equal to the limit in step then control proceeds to step . In step a signature is created using the tag s private key. In one embodiment the signature is taken over the tag identifier of a partner and the current time. In step the signature the protocol identifier the tag identifier of a partner and the current time are written to the tag identifier broadcast. In step the tag identifier broadcast is broadcast. Control then returns to step .

The embodiment of has a number of advantages. The signature makes it infeasible for a phony partner tag to spoof a real tag. The signature also makes it infeasible for a phony control authority to disable a tag. Replay attacks are blocked by the time stamp. Destroying a tag sounds the alarm of a partner tag.

Another embodiment of the invention sounds an alarm if a tag comes within a particular range of one or more other tags. Each tag may maintain a sensitive tag list of such other tags that cause its alarm to sound. In one embodiment the range is a mutual transmit receive range. One tag may be physically attached to a sensitive object that must not enter a secure area. The other tag may be built into a secure immobile location such as a floor or ceiling or may be carried by authorized personnel. This embodiment may include a protocol for adding tags to and deleting tags from the sensitive tag list.

This embodiment may be used to alert security personnel to the movement of objects such as dangerous or hazardous object into a sensitive facility to alert employees to inventory that is being carried near the exit of a store to alert a parent or child care provider to the movement of a child toward a dangerous area or to designated persons to warn a pedestrian who is approaching a hazardous area to warn a motor vehicle driver who is approaching hazardous conditions to alert security personnel to visitors who are entering or approaching a restricted area etc.

In one embodiment the tags may contain one or more of the following a radio transmitter a radio receiver a memory control software a processor a clock and an audible alarm. The memory may include a RAM and a ROM. The control software may be stored in the ROM. The processor may be of a type that consumes less power.

The tags may contain one or more data structures including a tag identifier a private key for the tag a public key of a control authority a tag identifier map and a time field. The tag identifier may be a variable length string of up to 255 bytes and may be used to distinguish tags from each other. The private and public keys may be 16 bytes. The tag identifier map may map a sensitive tag identifier to a public key. The tag identifier map may be implemented by a hash table or a binary search tree. Entries in the tag identifier map may expire in least recently used order if the tag identifier map becomes full. The time field may be a four byte unsigned integer and may contain the current time in any form such as Greenwich Mean Time GMT .

If the protocol identifier is a tag identifier broadcast control proceeds to step . In step the tag identifier of the tag identifier broadcast is checked to determine if it is in the tag s list of sensitive tags. If it is not in the list of sensitive tags the broadcast is ignored and control returns to step . If it is in the list of sensitive tags control proceeds to step . In step the time in the tag identifier broadcast is checked to determine whether it is within one minute of the current time. If it is not then the broadcast is ignored and control returns to step . If it is then control proceeds to step . In step the public key of the tag identifier in the tag identifier broadcast may be used to verify the signature in the tag identifier broadcast. If the signature verification in step is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the alarm sounds.

If the protocol identifier is determined to be a control authority add tag broadcast in step then control proceeds to step . In step the target tag identifier is checked to determine if it matches the tag identifier of the tag receiving the broadcast. If there is not a match the broadcast is ignored and control returns to step . If there is a match control proceeds to step . In step the time in the control authority add tag broadcast is checked to determine if it is within one minute of the current time. If it is not then the broadcast is ignored and control returns to step . If it is within one minute control proceeds to step . In step the public key of the control authority is used to verify the signature in the control authority add tag broadcast. If the signature verification is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the sensitive tag identifier in the control authority add tag broadcast and its public key are stored in the tag identifier map. Control then returns to step .

If the protocol identifier is determined to be a control authority delete tag broadcast in step then control proceeds to step . In step the target tag identifier is checked to determine if it matches the tag identifier of the tag receiving the broadcast. If there is not a match the broadcast is ignored and control returns to step . If there is a match control proceeds to step . In step the time in the control authority delete tag broadcast is checked to determine if it is within one minute of the current time. If it is not then the broadcast is ignored and control returns to step . If it is within one minute control proceeds to step . In step the public key of the control authority is used to verify the signature in the control authority delete tag broadcast. If the signature verification is not successful then the broadcast is ignored and control returns to step . If the signature verification in step is successful then control proceeds to step . In step the sensitive tag identifier in the control authority delete tag broadcast and its public key are removed from the tag identifier map. Control then returns to step .

If the interrupt is determined to be a timer interrupt in step control proceeds to step . In one embodiment the timer interrupt occurs every fifteen seconds. In step a signature is created using the tag s private key. In one embodiment the signature is taken over the tag identifier and the current time. In step the signature the protocol identifier the tag identifier and the current time are written to the tag identifier broadcast. In step the tag identifier broadcast is broadcast. Control then returns to step .

The embodiment of has a number of advantages. The signature makes it infeasible for a phony sensitive tag to spoof a real tag. The signature also makes it infeasible for a phony control authority to add or delete a tag. Replay attacks are blocked by the time stamp. Tags may be made to be resistant to tampering to lessen their vulnerability to physical destruction or removal.

While the above invention has been described with reference to certain preferred embodiments the scope of the present invention is not limited to these embodiments. One skilled in the art may find variations of these preferred embodiments which nevertheless fall within the spirit of the present invention whose scope is defined by the claims set forth below.

