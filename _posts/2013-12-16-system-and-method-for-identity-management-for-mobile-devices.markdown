---

title: System and method for identity management for mobile devices
abstract: Systems and methods for managing a user identity on a mobile device are provided. The system comprises the mobile device comprising a user agent and a client application, the user agent and the client application in communication with each other. The system further comprises an identity provider in communication with the mobile device, and a client service in communication with the mobile device. The user agent is configured to communicate with the identity provider and retrieve the user identity for the client application, and the client application is configured to transmit the user identity to the client service.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09363272&OS=09363272&RS=09363272
owner: BlackBerry Limited
number: 09363272
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20131216
---
The present application is a Continuation of U.S. patent application Ser. No. 13 397 348 filed on Feb. 15 2012 and claims priority from U.S. Provisional Application No. 61 443 168 filed on Feb. 15 2011 and U.S. Provisional Application No. 61 443 175 filed on Feb. 15 2011 the contents of which are hereby incorporated by reference in their entirety.

A mobile device can be used for running various types of client applications. Examples of client applications include social networking applications communication applications advertising applications and banking applications. Several client applications may be loaded onto a mobile device which makes the mobile device a resourceful tool.

Each application may require a user s personal information to operate. Such personal information is used to identify the user and is herein interchangeably referred to as user identity information and user profile data. Non limiting examples of user identity information include first name middle name last name birth date sex address phone number email address citizenship etc. For example when registering to use a client application on a mobile device a user typically provides the information requested by the client application. A user may also be required to provide further information upon logging into the client application on their mobile device.

Mobile devices are used to operate many different types of applications also called software programs. Many applications require a user to sign in register or log in to an account. Typically a user identification e.g. a user name and a password are used to verify that the correct user is logging into a particular account. If there are more applications that are used on a mobile device then a user is required to remember more user identifications and passwords. This can be troublesome. Further if a user would like to use multiple applications upon turning on the device then the user typically needs to manually enter a user identification and password for each of the applications. This is a time consuming process.

The management of user identifications and passwords becomes more cumbersome when a user owns multiple mobile devices which may operate common applications. When using multiple mobile devices the user may need to sign on to the same application on each mobile device. Thus the user needs to sign on multiple times. This process is also time consuming and inconvenient.

In other words if there are many client applications that require a user to provide user identity information the process of providing the requested user identity information requested becomes repetitive. If the user also owns multiple mobile devices each with multiple client applications the repetitive effect of providing the requested information is multiplied.

Many client applications communicate with a remotely located client service for certain functionality. The client service often requires particular user profile data corresponding to the user of the mobile device. However many users do not trust the mobile application with the user profile data.

It is recognized that user identity information also referred herein as user profile data is often used to register a new user onto an application account or to sign a user into an application. The user identity information may be personal information and a user may not wish to have the personal information provided to entities that are not trusted. The user identity information can for example be used to commit identity fraud. It is recognized that when a user repetitively provides this personal information it is possible that an adversary person or program has an increased chance to obtain the user identity information.

To address the above issues turning to the proposed systems and methods provide an ID user agent on a mobile device which communicates with an identity provider over a network . The ID user agent also referred to herein as a user agent and identity provider manage the user identity information which may be required or requested by one or more client applications on the mobile device or one or more client service in communication with the client applications . The identity provider and the client service are computing devices such as for example servers. A user s identity information may be stored centrally on the identity provider . This may provide centralized security for the user identity information as well as centralized access from multiple devices belonging to the user.

The mobile device includes an operating system user agent ID secure persistent credential store and client application . One or more client applications can be stored on the mobile device . Each client application includes a partner API which is an application programming interface used to interact with the user agent . The user agent is invoked by the operating system for example when the mobile device is powering up. The user agent can store and retrieve data from the ID secure persistent credential store . The user agent can also store and retrieve data external to the mobile device on the identity provider through network .

The user interacts with the user agent to provide and retrieve data. The user also interacts with the client application .

The user agent is used to manage the storage and retrieval of user identity information requested from either the client application or from the client service . Notably the client service can communicate to the user agent through the client application over the network .

In an example embodiment the client service cannot communicate directly with the user agent or the identity provider . This limits access to the user identity information stored on the identity provider . The user agent on the mobile device may for example be the only entity able to communicate with the identity provider .

In general a system for managing user identity information on a mobile device is provided. The system comprises the mobile device comprising a user agent and a client application the user agent and the client application in communication with each other. The system further comprises an identity provider in communication with the mobile device and a client service in communication with the mobile device . The user agent is configured to communicate with the identity provider and retrieve the user identity information for the client application and the client application is configured to transmit the user identity information to the client service .

Turning to a user can use multiple mobile devices . Each of the mobile devices interact with the identity provider and the client service through the network . Examples of different types of mobile devices include smart phones cell phones personal digital assistants pagers hand held wireless devices e readers tablets laptops netbooks etc.

The proposed systems and methods provide users with a single sign on experience when using client applications and services on the mobile device . In other words by signing into the user agent a user can sign into multiple client applications simultaneously. The user is also able to manage their identity information across multiple mobile devices . Therefore regardless of which mobile device the user is using the user is able to sign on to the same applications without repetitively entering their information. The proposed systems and methods also provide privacy and security of the user s personal information from client applications . From the user s perspective the user s identity information is managed in a consistent simple and non intrusive manner.

The following examples include communications between mobile or handheld devices which will be commonly referred to as mobile devices hereinafter and referred to by numeral .

The mobile device can be a multi way communication device with advanced data communication capabilities including the capability to communicate with other mobile devices or computer systems through a network of transceiver stations. The mobile device may also have the capability to allow voice communication. Depending on the functionality provided by the mobile device it may be referred to as a data messaging device tablet a multi way pager a cellular telephone with data messaging capabilities a laptop an e reader a wireless Internet appliance or a data communication device with or without telephony capabilities . The mobile device can also be one that is used in a system that is configured for continuously routing all forms of pushed information from a host system to the mobile device . One example of such a system will now be described making reference to .

Message C in represents an external message from a sender that is not directly connected to the host system such as the user s mobile device some other user s mobile device not shown or any user connected to the public or private network e.g. the Internet . Message C could be e mail voice mail event information database updates web page updates or could even represent a command message from the user s mobile device to the host system . The host system may comprise along with the typical communication links hardware and software associated with a computer network system one or more wireless mobility agents a TCP IP connection a collection of data stores for example a data store for e mail could be an off the shelf mail server like Microsoft Exchange Server or Lotus Notes Server all within and behind a network firewall.

The mobile device may be adapted for communication within wireless network via wireless links as required by each wireless network being used. As an illustrative example of the operation for a wireless router shown in consider a data item A repackaged in outer envelope B the packaged data item A now referred to as data item A and sent to the mobile device from an Application Service Provider ASP in the host system . Within the ASP is a computer program similar to a wireless mobility agent running on any computer in the ASP s environment that is sending requested data items from a data store to a mobile device . The mobile destined data item A is routed through the network and through the wireless router s firewall protecting the wireless router not shown .

Although the above describes the host system as being used within a networked environment this is just one embodiment of one type of host service that offers push based messages for a handheld wireless device that is capable of notifying and presenting the data to the user in real time at the mobile device when data arrives at the host system.

By offering a wireless router sometimes referred to as a relay message server data redirector etc. there are a number of major advantages to both the host system and the wireless network . The host system in general runs a host service that is considered to be any computer program that is running on one or more computer systems. The host service is said to be running on a host system and one host system can support any number of host services. A host service may or may not be aware of the fact that information is being channeled to mobile devices . For example an e mail or message program see might be receiving and processing e mail while an associated program e.g. an e mail wireless mobility agent is also monitoring the mailbox for the user and forwarding or pushing the same e mail to a wireless device . A host service might also be modified to prepared and exchange information with mobile devices via the wireless router like customer relationship management software. In a third example there might be a common access to a range of host services. For example a mobility agent might offer a Wireless Access Protocol WAP connection to several databases.

Although the system is exemplified as operating in a multi way communications mode certain aspects of the system could be used in a one and one half or acknowledgment paging environment or even with a one way paging system. In such limited data messaging environments the wireless router still could abstract the mobile device and wireless network offer push services to standard web based server systems and allow a host service in a host system to reach the mobile device in many countries.

The host system shown herein can have many methods when establishing a communication link to the wireless router . For one skilled in the art of data communications the host system could use connection protocols like TCP IP X.25 Frame Relay ISDN ATM or many other protocols to establish a point to point connection. Over this connection there are several tunneling methods available to package and send the data some of these include HTTP HTML HTTP XML HTTP Proprietary FTP SMTP or some other proprietary data exchange protocol. The type of host systems that might employ the wireless router to perform push could include field service applications e mail services stock quote services banking services stock trading services field sales applications advertising messages and many others. This wireless network abstraction is made possible by the wireless router which implements this routing and push functionality. The type of user selected data items being exchanged by the host could include E mail messages events meeting notifications address entries journal entries personal alerts alarms warnings stock quotes news bulletins bank account transactions field service updates stock trades heart monitoring information vending machine stock levels meter reading data GPS data etc. but could alternatively include any other type of message that is transmitted to the host system or that the host system acquires through the use of intelligent agents such as data that is received after the host system initiates a search of a database or a website or a bulletin board.

The wireless router provides a range of services to make creating a push based host service possible. These networks may comprise 1 the Code Division Multiple Access CDMA network 2 the Groupe Special Mobile or the Global System for Mobile Communications GSM and the General Packet Radio Service GPRS and 3 the existing and upcoming third generation 3G and fourth generation 4G networks like EDGE UMTS and HSDPA LTE Wi Max etc. Some older examples of data centric networks include but are not limited to 1 the Mobitex Radio Network Mobitex and 2 the DataTAC Radio Network DataTAC .

To be effective in providing push services for host systems the wireless router may implement a set of defined functions. It can be appreciated that one could select many different hardware configurations for the wireless router however many of the same or similar set of features would likely be present in the different configurations. The wireless router may offer any one or more of the following features for host services 1 An addressing method so that mobile device traffic can be addressed to a host system without the need for the wireless network to assign an identity to each host system 2 An efficient and authenticated method for the host system to initiate a communication connection to the wireless router for the purposes of opening a communication tunnel to the one or more mobile devices that the host system wishes to communicate with 3 A reliable method for exchanging data between the host system and the mobile device in a manner consistent with the abilities of the wireless network 4 Providing feedback to the host system when data is delivered which allows the host system to clean up any wireless delivery queues if necessary or inform the original sender user or program that the data has been delivered to the mobile device 5 Implementation of a wireless network initiated push of services or data to a mobile device from a wireless router and 6 Connect to a wide range of wireless networks and provide a way of tracking the user s location so that a follow you anywhere solution can be provided.

An example configuration for the mobile device is illustrated in . Referring first to shown therein is a block diagram of an example embodiment of a mobile device . The mobile device comprises a number of components such as a main processor that controls the overall operation of the mobile device . Communication functions including data and voice communications are performed through a communication subsystem . It is appreciated however that the mobile device does not necessarily have voice communication capabilities such as in tablets and e readers amongst others. The communication subsystem receives messages from and sends messages to a wireless network . In this example embodiment of the mobile device the communication subsystem is configured in accordance with the GSM and GPRS standards which are used worldwide. Other communication configurations that are equally applicable are the 3G and 4G networks discussed above. New standards are still being defined but it is believed that they will have similarities to the network behaviour described herein and it will also be understood by persons skilled in the art that the embodiments described herein are intended to use any other suitable standards that are developed in the future. The wireless link connecting the communication subsystem with the wireless network represents one or more different Radio Frequency RF channels operating according to defined protocols specified for GSM GPRS communications.

The main processor also interacts with additional subsystems such as a Random Access Memory RAM a flash memory a display an auxiliary input output I O subsystem a data port a keyboard a speaker a microphone a GPS receiver short range communications and other device subsystems . As will be discussed below the short range communications can implement any suitable or desirable device to device or peer to peer communications protocol capable of communicating at a relatively short range e.g. directly from one device to another. Examples include Bluetooth ad hoc WiFi radio frequency identification RFID near field communications NFC infrared or any long range protocol re configured to utilize available short range components. It will therefore be appreciated that short range communications may represent any hardware software or combination of both that enable a communication protocol to be implemented between devices or entities in a short range scenario such protocol being standard or proprietary.

Some of the subsystems of the mobile device perform communication related functions whereas other subsystems may provide resident or on device functions. By way of example the display and the keyboard may be used for both communication related functions such as entering a text message for transmission over the network and device resident functions such as a calculator or task list.

The mobile device can send and receive communication signals over the wireless network after required network registration or activation procedures have been completed. Network access is associated with a subscriber or user of the mobile device . To identify a subscriber the mobile device may use a subscriber module component or smart card such as a Subscriber Identity Module SIM a Removable User Identity Module RUIM and a Universal Subscriber Identity Module USIM . In the example shown a SIM RUIM USIM is to be inserted into a SIM RUIM USIM interface in order to communicate with a network. Without the component the mobile device may not be fully operational for communication with the wireless network . Once the SIM RUIM USIM is inserted into the SIM RUIM USIM interface it is coupled to the main processor . It can be appreciated that in other example embodiments of the mobile device a SIM RUIM USIM card is not required such as in tablets e readers laptops etc.

The mobile device is typically a battery powered device and in this example includes a battery interface for receiving one or more rechargeable batteries . In at least some embodiments the battery can be a smart battery with an embedded microprocessor. The battery interface is coupled to a regulator not shown which assists the battery in providing power V to the mobile device . Although current technology makes use of a battery future technologies such as micro fuel cells may provide the power to the mobile device .

In the examples described herein the mobile device comprises or otherwise has access to a cryptographic processor which can be embodied in hardware software or a combination of the two. Also as will be discussed below the cryptographic processor may control a user agent shown in which may represent a cryptographic or security related application that cryptographically processes data. The mobile device may also comprise internal or external memory or other computer readable media for storing computer executable instructions for enabling the cryptographic processor to perform cryptographic operations as is known in the art. As can be seen in the cryptographic processor may be independent of the main processor in a mobile device configuration or may be implemented by special instructions or hardware associated with the main processor itself.

The mobile device also includes an operating system and software components to which are described in more detail below. The operating system and the software components to that are executed by the main processor are typically stored in a persistent store such as the flash memory which may alternatively be a read only memory ROM or similar storage element not shown . Those skilled in the art will appreciate that portions of the operating system and the software components to such as specific device applications or parts thereof may be temporarily loaded into a volatile store such as the RAM . Other software components can also be included as is well known to those skilled in the art.

The subset of software applications that control basic device operations including data and voice communication applications may be installed on the mobile device during its manufacture. Software applications may include a message application a device state module a Personal Information Manager PIM a connect module and an IT policy module . A message application can be any suitable software program that allows a user of the mobile device to send and receive electronic messages wherein messages are typically stored in the flash memory of the mobile device . A device state module provides persistence i.e. the device state module ensures that important device data is stored in persistent memory such as the flash memory so that the data is not lost when the mobile device is turned off or loses power. A PIM includes functionality for organizing and controlling data items of interest to the user such as but not limited to e mail text messages instant messages contacts events and voice mails and may interact with the wireless network . A connect module implements the communication protocols that are required for the mobile device to communicate with the wireless infrastructure and any host system such as an enterprise system that the mobile device is authorized to interface with. An IT policy module receives IT policy data that encodes the IT policy and may be responsible for organizing and securing rules such as the Set Maximum Password Attempts IT policy.

Other types of software applications or components can also be installed on the mobile device . These software applications can include pre installed applications i.e. other than message application and third party applications which may be added after the manufacture of the mobile device . Examples of the applications include games calculators utilities social media applications shopping applications banking and other financial applications additional messaging applications etc. The additional applications can be loaded onto the mobile device through at least one of the wireless network the auxiliary I O subsystem the data port the short range communications subsystem or any other suitable device subsystem .

The data port can be any suitable port that enables data communication between the mobile device and another computing device. The data port can include a serial or a parallel port. In some instances the data port can include a USB port that includes data lines for data transfer and a supply line that can provide a charging current to charge the battery of the mobile device .

For voice communications received signals are output to the speaker and signals for transmission are generated by the microphone . Although voice or audio signal output is accomplished primarily through the speaker the display can also be used to provide additional information such as the identity of a calling party duration of a voice call or other voice call related information.

For composing data items such as e mail messages for example a user or subscriber could use a touch sensitive overlay not shown on the display that is part of a touch screen display not shown in addition to possibly the auxiliary I O subsystem . The auxiliary I O subsystem may include devices such as a mouse track ball track pad infrared fingerprint detector or a roller wheel with dynamic button pressing capability. A composed item may be transmitted over the wireless network through the communication subsystem .

The instant messaging application is an instant messaging service that may hosted and provided by the host system e.g. using a messaging server at the wireless router or may be associated with a third party instant messaging service not shown . The instant messaging application comprises or otherwise has access to contact information often referred to as a buddy list . The calendar application comprises or otherwise has access to a portion of memory database or other data storage device storing calendar entries which may include any data or information associated with a particular date and time in the calendar application and may be displayed in a graphical user interface GUI therefor. It can be appreciated that such software applications and components may require one or more operational certificates to operate or function on the mobile device .

Continuing with the user agent comprises or otherwise has access to a portion of memory database or other data storage device for cryptographic data which may include any data or information associated with cryptographic functions. In particular the stored data includes for example certificates tokens public and private keys and a listing of certificate authorities.

The user agent also has access to the ID secure persistent credential storage . This data includes credential information that is highly sensitive. For example in a mobile banking application the credentials stored are the verification code and PIN number. In government related client applications the credentials stored are a person s the social security number or social insurance number.

It will be appreciated that any module or component exemplified herein that executes instructions may include or otherwise have access to computer readable media such as storage media computer storage media or data storage devices removable and or non removable such as for example magnetic disks optical disks or tape. Computer storage media may include volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data except transitory signals per se. Examples of computer storage media include RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by an application module or both. Any such computer storage media may be part of the mobile device identity provider client service etc. or accessible or connectable thereto. Any application or module herein described may be implemented using computer readable executable instructions that may be stored or otherwise held by such computer readable media.

A number of figures are discussed below with respect to the method of establishing and managing the personal identity information.

Turning now to example computer executable instructions are provided for establishing a user identity when the mobile device is a new mobile device. For example when the mobile device comes out of the box it is when a user first purchases a new mobile device and takes the mobile device out of its box. At block information and software libraries for the identity account are installed onto the mobile device during the factory setup. However at this stage the user s identity has not been created or registered.

It is appreciated that the user identity is in some cases referred to in the drawings as BBID. The term BBID refers to BlackBerry ID. However more generally BBID is the user identity and the principles described herein apply to managing identity information on various types of mobile devices.

At block the mobile device provides one or more GUI s to facilitate registering a user s identity when the user first turns on the mobile device . It is determined if the user would like to create a new user identity account or would like to sign in to an existing user identity account block . If the user selects the option to sign in then at block the sign in process is invoked. Otherwise if the user selects the option to create a new user identity account at block the account setup process is invoked. After the user ID has been established and the user has signed into the user account there may be further setup operations block . At block there are other system setup operations that take place such as setting up email downloading the user agent etc. When the overall setup is done the system downloads the actual running image and reboots. The running image for example refers to the software installed after the first setup. In an example embodiment the version of the running image that is downloaded is considered to be the latest or most recent version.

The process for establishing the user identity is different when powering up a mobile device in a non factory setting for example when the user has already been the owner of the mobile device for some time or there is a previous owner of the mobile device . Turning to at block the mobile device is powered up or turned on. At block it is determined if there is a previously authorized or authenticated user having user identity information associated with the mobile device . This user identity information would be known to the user agent . If not at block the user identity sign in process is invoked. From the sign in process an identity token is created and stored on the mobile device block . If however there is a previously authorized user at block the previously authorized user s identity token is refreshed. If the token is successfully refreshed the refreshed token is stored block . If the token is not able to be refreshed then the sign in process is invoked block .

Upon storing the token the GUI returns to a main screen provided by the user agent or the client application s screen block .

Turning to example computer executable instructions are provided for signing into a user identity account. At block the mobile device through the user agent displays a sign in GUI. The options provided include creating a new user identity account signing into an existing user identity account or retrieving access information if the user identity sign in information is forgotten block .

If the user selects the forgot option at block the password recovery GUI is invoked. One or more secret questions may be provided to confirm the identity of the user. If the correct answer or answers are provided block then the successful password recovery GUI is invoked block . Otherwise the failed password recovery GUI is invoked block and the process returns to block .

If the user selects the sign in option at block the user s identity information is authenticated. For example a user enters a username and password into the mobile device and the mobile device confirms if the provided information is correct. If the authentication process has passed block then an identity token is created and stored block . If the authentication process has failed block then a GUI showing that the failed authentication is displayed block and the process returns to block .

If the user selects the create option at block the identity account setup process is invoked. Upon creating the account the sign in process begins continuing with block .

Turning to example computer executable instructions and system are provided for creating a user identity. At the operating system triggers the user identity login process. The process is performed by the user agent . At the user agent displays a login GUI on the display of the mobile device . At the mobile user agent receives an indication from the user to create a new user identity. At the user agent displays a GUI to create new user identity account on the mobile device . At the user agent receives the account data e.g. user name password etc. and the user identity information. At the user agent contacts the identity provider to create a new user identity. At the identity provider responds with its status. The status information includes indicating whether an account exists or if there are general server processing errors or if the request for a user identity is accepted. If the identity provider responds that the request is accepted at the user agent sends the user s credentials to the identity provider . The identity provider checks the credentials to determine their authenticity and accuracy. Non limiting examples of credentials include username password facial recognition speech recognition biometric feature s etc. If the credentials are successfully verified then the identity provider issues an identity token to the user agent . The token has an expiry date to ensure that identity and credential information is updated or refreshed periodically. The token is periodically refreshed by the user agent re submitting credentials e.g. username and password to the identity provider . If authentication fails the user is prompted again to submit the credentials. At the identity username and password as well as the token issued by the identity provider is stored in the ID secure persistent credential store .

Usefully user agent is able to automatically refresh the token e.g. by contacting the identity provider without prompting the user. Furthermore in an example embodiment only the identity provider is able to extract and use the token stored on the ID secure persistent credential store .

Turning to example computer executable instructions and system are provided for allowing a user to log into the user agent . At the operating system on the mobile device triggers the user identity login process at the user agent . The operating system can trigger this action when powering up the mobile device having no previous user or when setting up the mobile device having no previous user. The user sign in process is persistent across power cycles. In other words if the user has signed in on the mobile device at least once on a previous occasion for future occasions for example the user does not need to sign in every time when powering the mobile device on and off.

At the user agent displays a user login screen e.g. display GUI on the mobile device s display . At the mobile device receives from the user their credentials such as their username and password. At the user s credentials are forwarded from the user agent on the mobile device to the identity provider . The identity provider verifies whether the credentials are correct. If the credentials are successfully verified at the identity provider generates a user identity token and returns the token to the mobile device . If the credentials provided fail in the verification process then the mobile device prompts the user again to provide the credentials.

At upon the mobile device receiving a token from the identity provider a secure credential store for the user is created. The user s username password and token are stored in the secure credential store . The token stored in the secure credential store is refreshed by the user agent and the identity provider without prompting the user . The identity provider has access to extract and use the token on the mobile device through the user agent . Other applications such as the client application on mobile device or the client service are not able to access the token.

It can be understood that the ID secure persistent credential store can store the credentials for logging into the user agent e.g. username and password the token and the credentials for the client application or the client applications.

It is appreciated that each client application includes a partner API that allows the client application to interface or communicate with the user agent .

In it is assumed that the user is already signed into the user agent using their user identity. At the user invokes the client application such as by opening the client application . Alternatively the partner API autonomously initiates a request for the user identity credentials associated with the user agent .

At if the client application is not already logged into by the user the partner API requests the user s credentials e.g. username and password from the user agent . If the client application is already associated or registered with the user agent then the user s credentials for the client application will be stored in the ID secure persistent credential store and retrievable through the user agent . If the client application is not already associated or registered with the user agent then the user s credentials for the client application must be obtained and then stored in the ID secure persistent credential store .

Usefully the client application can only access the credentials associated with the client application that have been stored on the ID secure persistent credential store . The client application has a public key and corresponding private key which is provided by the partner API . The client application s public key and private key pair is provided by the code signing authority. For example when a client application developer signs up to develop an application for the mobile device the developer receives from the code signing authority a signing key that is used to sign their files. The proposed system uses the signing key to determine identity of the client application .

At if the user agent determines that the credentials for the client application have not been stored in the ID secure persistent credential store then the user agent sends a response to the partner API that there no credentials for the client application . At the partner API displays a GUI on the display to prompt the user to provide the credentials for the client application . At the mobile device receives the credentials for the client application . The partner API then requests the user agent to store the credentials of the client application . At the user agent stores the credentials for the client application onto the ID secure persistent credential store . At using the credentials for the client application the client application can then log into the client service over the network . The client service can then return information back to the client application on the mobile device .

Alternatively if the user agent determines that the credentials for the client application are stored in the ID secure persistent credential store then the user agent retrieves the credentials for the client application and provides them to the partner API . The client application then uses the retrieved credentials for the client application to log into the client service . It can be appreciated that in this latter scenario in which the credentials for the client application have already been stored on the mobile device the user agent can automatically log a user into the client service without requiring the user to input any credentials. This conveniently saves time.

In another example embodiment the identity provider may also store user identity information e.g. personal information that is requested by the client service . The client service may send a request for the user identity information data to the client application . The client application through the partner API forwards the request for user identity information to the user agent . The user agent then forwards the request for user identity information along with the user identity token to the identity provider . Upon the identity provider successfully authenticating the user identity token the identity provider provides the requested user identity information back to the user agent . The user agent then sends the retrieved user identity information to the client application which transmits the same to the client service . It can be appreciated that the user identity information may be encrypted by the identity provider such that only the client service can decrypt the encrypted user data.

In general an example system and method are provided for managing user identity information on a mobile device. The system includes the mobile device comprising a user agent and a client application the user agent and the client application in communication with each other an identity provider in communication with the mobile device the user identity information stored on the identity provider a client service in communication with the mobile device and wherein the user agent is configured to communicate with the identity provider and retrieve the user identity information for the client application and the client application is configured to transmit the user identity information to the client service.

In another aspect the identity provider is a server and the client service is another server. In another aspect the system further comprises an application program interface API in association with the client application the API configured to allow the client application to communicate with the client application. In another aspect the mobile device comprises an operating system the operating system configured to invoke the user agent when turning on the mobile device. In another aspect the mobile device comprises multiple client applications and the mobile device is configured to upon signing into the user agent sign into the multiple client applications. In another aspect the mobile device further comprises a credential store configured to store at least user credentials the credential store in communication with the user agent. In another aspect the user credentials comprises a username and a password. In another aspect the user agent is further configured to display a graphical user interface and receive through the GUI the user credentials send the user credentials to the identity provider for verification if the user credentials are verified receiving a token from the identity provider and store the token and the user credentials in the credential store. In another aspect the client application is configured to receive a request from the client service for the user identity information forward the request and the token to the identity provider and receive the user identity information from the identity provider. In another aspect the identity provider is configured to authenticate the token and if authenticated the identity provider is further configured to send the user identity information to the identity provider. In another aspect the credential store is further configured to store credentials for the client application. In another aspect to sign into the client application the user agent is further configured to retrieve from the credential store the credentials for the client application and send the credentials for the client application to the client application and the client application is further configured to use the credentials for the client application to log into the client application.

It is also recognized that one or more client services corresponding to one or more client applications of the mobile device may not have or want the capability to authenticate users of the client service or compile user profile data of these users.

For example a user may not trust a client application to have or communicate its user profile data or the client application may assume that the user does not trust the client application with this user profile data.

In another example the user may not trust the network such as the internet or a wireless channel over which user profile data would have been communicated between the client application and the client service.

It has been recognized that in order to address the above problems a trusted user agent and trusted identity provider may enable secure communication of user profile data to client services. The user may prefer to enable the trusted identity provider to provide only required user profile data to client services without exposing the user profile data to client applications.

Such a secure communication method prevents a client application which may be untrusted from obtaining user profile data while enabling a user to utilize a client service corresponding to that client application.

Furthermore such a secure communication method enables a user to utilize a plurality of such client services without requiring manually providing user profile data to each of the plurality of such client services.

In another example embodiment of the identity management system and referring to the system comprises a mobile device on which a user can be authenticated the mobile device comprising a user agent and one or more client applications . The system also includes an identity provider operable to establish network communication with the user agent over the network and one or more client services operable to establish network communication with the client application over the network or another network . The identity provider is linked to a user profile database configured to store user profile data associated with the user .

The client service requests user profile data from the client application and in response an encrypted token comprising user profile data and a token secret is generated by the identity provider and communicated to the client service for decryption. The token secret is also communicated to the client application to provide proof of ownership of the token secret which can be provided to the client service to validate the token. The client application does not require knowledge of any user profile data in order for the client service to validate the user profile data.

The identity provider may be linked to a key store and each client service may each be linked to a key store each key store operable to store encryption keys. The encryption keys may be provided in accordance with a public key infrastructure PKI encryption scheme and more particularly may be provided in accordance with an elliptic curve cryptographic ECC scheme.

For example the identity provider is associated with the encryption key pair comprising an identity provider s public key and corresponding private key . The client service is associated with the encryption key pair comprising a client service s public key and corresponding private key . The identity provider s private key and the client service s public key are stored on the key store . The identity provider s public key and the client service s private key are stored on the key store .

Turning to although the user may not trust the client application with user profile data the user may trust the client application to interact with the client service on the user s behalf. The user may also trust the identity provider with the user s information and the user agent to impersonate the user .

The identity provider correspondingly may trust the user based on the user s knowledge of appropriate credentials provided on the mobile device and known to the user agent. The identity provider may also trust the client service with the user profile data that it provides to the client service.

The client service may trust that the identity provider is providing the client service with correct user profile data that it requested. Such a trust can be established for example prior to an administrator of the identity provider enabling a particular client service to participate in the secure communication method.

Each particular client service may rely on the identity provider for user profile data including for authentication or compilation or both of user profile data and may interface with the user agent to communicate requested user profile data to the client service.

Although the secure communication method may be applied to any number of one or more client services and one or more client applications corresponding to a mobile device having one or more users for simplicity a single client service in communication with a single client application corresponding to a mobile device having one user will be described.

In another aspect and referring now to the method comprises generating an encrypted token comprising user profile data and a token secret that is decryptable only by the client service communicating the token to the client service for decryption communicating the token secret to the client application and verifying that the token secret communicated to the client application is equal to the token secret of the token . If the token secret communicated to the client application is equal to the token secret of the token then the client service can have a high confidence that the token includes the user profile data requested and may use the user profile data as desired. In an example embodiment if the token secret communicated to the client application is equal to the token secret of the token the client service concludes or records that the token includes the user profile data requested and uses the user profile data. Otherwise the steps may be repeated or the client service may abandon the request for user profile data. It should be appreciated that steps and may be carried out concurrently or sequentially in either order. For example execute then execute or execute then execute or asynchronously in either order.

In another example embodiment and referring now to the method more specifically may comprise a client application generating a request to a user agent for user profile data the user agent providing the request to an identity provider the identity provider generating a token secret and an encrypted token comprising the user profile data and a token secret and communicating the token and token secret to the client application via the user agent the client application providing the client service with the token for decrypting the token and the client application providing a proof of ownership of the token based on the token secret to the client service to validate the user profile data.

Turning now to a client service may request user profile data corresponding to a user once the user is associated with a user account by the identity provider as previously described. The user may be one of the one or more users presently authenticated to the mobile device the present user being identifiable among the remaining users as previously described. The user agent is aware of which user is presently authenticated to the mobile device.

User profile data may comprise one or more claims. In an example embodiment a claim comprises a fact about the user which can be stated by another entity. The other entity which states the facts or generates claims is considered an authority and can also attest to the truth of the claim. Some claims are mandatory e.g. must be included in the token and other claims are optional e.g. optionally included in the token . Examples of claims include a user identifier and a username. In an example embodiment the user identifier in a claim is referred to as an ecoID. It is an identification that remains with the user across all devices belonging to the user. The ecoID also does not change. For example although the user may change the username or the password the ecoID does not change. The ecoID comprises for example a number.

The user profile data may comprise an authentication status of the user so as to enable authentication of the user on the particular client service requesting the user profile data and user personal data that the identity provider or the user or both has authorized to be shared with the client service. It should be understood that the communication of user personal data from the identity provider to the client service does not necessarily include personally identifiable information about the user.

User profile data is requested by the client service from the identity provider via the client application and user agent. For example a user may access a client application on the mobile device. The client application corresponds to a client service. The client application may communicate with the client service to initiate use of the client service . The client service may correspondingly issue a challenge to the client application requiring that the client application provide particular user profile data such as authentication information to authenticate the user for example to the client service. However the client application may not be trusted by the user with this user profile data.

The client application requests the user profile data such as authentication information in this example from the user agent and provides the user agent with a client application identifier. The user agent determines whether it has previously requested the particular user profile data for the particular user service and has cached a corresponding token and token secret.

If the user agent has not it requests the user profile data from the identity provider . Since the user agent is in possession of user credentials for the current user of the mobile device the user agent can communicate all or part of the user credentials to the identity provider to inform the identity provider of which user the client service is inquiring. If the user agent has a cached corresponding token and token secret it may not need to request the user profile data from the identity provider.

If requested the identity provider generates an encrypted token that can be decrypted only by the client service preventing the client application from accessing the user profile data. The token may comprise the user profile data a token secret and any other data which is also referred to as metadata.

The token and token secret are provided by the identity provider to the user agent which the user agent may cache. The client application may request the token and token secret from the user agent.

Optionally the user agent initiates a prompt to be provided to the user via a user interface of the mobile device. The prompt may request explicit consent from the user to enable the user agent to provide the token and token secret to the client application. If the user does not consent the user agent does not release at least the token to the client application. If the user does consent the user agent releases the token and token secret to the client application.

Communication of the token and token secret to the correct client application can be ensured by establishing security between each client application and the user agent. This can be by issuing or recognizing an existing certificate to verify the identity of any particular client application. Certificates may be administered by a certifying authority.

Alternatively or in addition the user agent may be configured to recognize a certain set of client applications and communicate securely with the certain set of client applications so as to prevent tokens and token secrets from being provided to client applications other than those intended.

The token and token secret may only be provided to the client application that has a client application identifier matching the client application identifier provided to the user agent at the time of the request. Upon receipt of the token and token secret from the user agent the client application may then communicate the token to the client service .

The client service decrypts the token to obtain the user profile data metadata and token secret. The client service can also request that the client application communicate its copy of the token secret or other proof of ownership of the token secret to the client service for verifying that the client application is the particular client application that the client service wishes to rely upon enabling the client service to rely on the received user profile data and metadata.

The identity provider may be operable to generate a specific token and token secret for each client application and corresponding client service. This can be provided by encryption.

Communication of the request for user profile data and corresponding communications of the token may be encrypted. The encryption may for example be provided by PKI that comprises a public key and corresponding private key. The particular PKI may be provided by ECC.

At least two public private key pairs may be provided a first key pair referred to herein as the client service encryption key pair and a second key pair referred to herein as the authentication token signing key pair.

The client service encryption key pair comprises a private key known only to a particular client service and a public key known at least by the identity provider. The client service may comprise a key store for storing the private key of the client service encryption key pair. The identity provider may comprise a key store for storing the public key of the client service encryption key pair. Each client service may be associated with a unique client service encryption key pair and the identity provider s key store may store all public keys for all client services.

The authentication token signing key pair comprises a private key known only to the identity provider and a public key known by all client services. The key store of the identity provider may store the private key of the authentication token signing key pair. The key store of each client service may store the public key of the authentication token signing key pair.

The tokens and token secrets may be cacheable by the user agent for a predetermined amount of time to reduce the amount of communication required between the user agent and the identity provider and to enable services to receive user profile data when the mobile device is not connected by network to the identity provider. The token secret may be regenerated by the identity provider after the predetermined amount of time which may be for example hours or days. When the token secret is regenerated tokens must also be regenerated by the identity provider.

The authentication token signing key pair and the client service encryption key pair may also be regenerated and the present key pair revoked after predetermined amounts of time to increase security. The client services and the identity provider may be configured to recognize recently revoked key pairs for a predetermined amount of time during a transition period until the new key pair has become known to all client services. This enables cached and in flight authentication tokens to remain valid until received. Once revoked the particular keys may be deleted from their respective key stores.

For example the client services and the identity provider may be configured to recognize a recently revoked authentication token signing key pair until all client services have confirmed receipt of the new public key of the authentication token signing key pair to the identity provider.

Similarly each client service and the identity provider may be configured to recognize a recently revoked client service encryption key pair until the identity provider has confirmed receipt of the new public key of the particular client service encryption key pair to the particular client service.

Any of the keys and key pairs may also be regenerated on demand for example when a breach of security has been detected.

By way of background asymmetric encryption algorithms have a low limit on the size of the encrypted data. In practice an example process called Asymmetric encryption is composed of generating an ephemeral symmetric key encrypting the data with the symmetric key encrypting the symmetric key with an asymmetric crypto method e.g. RSA ECC etc. . . . and concatenate the encrypted symmetric key with the encrypted data. Even though it uses a combination of symmetric and asymmetric algorithms this process is considered asymmetric because only the process that knows the asymmetric decryption key can decrypt the ephemeral symmetric key and hence decrypt the data.

Turning now to the client application issues a service request to the client service. This request may be service specific. The client service may issue a challenge to the client application and indicates to the client application the particular claims required for example that an authentication token is required. The challenge may be service specific. In a separate example embodiment the fact that a client service requires a specific authentication token may be a pre established policy within the client application.

The client application requests a token corresponding to the required claims from the user agent including by providing a client application identifier to the user agent. The request specifies a token type that is needed by the client service and a client service identifier that identifies the client service. The client service identifier enables the identity provider to encrypt the token with the applicable public key for the particular requesting client service. The token type or the client service identifier or both may be encoded in the challenge configured at run time or known at compile time based on particular implementation details.

The user agent determines whether it has a valid token for the particular client service in its cache . If it does not the user agent requests a token from the identity provider.

The identity provider generates a token comprising user profile data that includes the particular claims required by the client service a token secret and metadata and encrypts the token with public key of the particular client service s client service encryption key pair. The identity provider further signs the token by encrypting a digest of the token or the token itself with the private key of the identity provider s signing key pair.

If the user agent does have the valid token in its cache it provides it to the client application . Regardless of whether the user agent required the token from the identity provider or had the token in its cache the user agent then provides the token and token secret to the client application that has a client application identifier matching the client application identifier provided with the request. The client application sends the proof of ownership which may be computed based on the client service s challenge and communicates the service request token and proof of ownership to the client service .

The client service decrypts the token with the private key of its client service encryption key pair validates the token by decrypting the signed token with the identity provider s public key of the identity provider s encryption key pair and extracts the token secret and user profile data. The client service then optionally computes the challenge response based on token secret and challenge and optionally verifies that the proof of ownership sent by the client application matches the expected value. The client application also provides the client service with proof of ownership of the token secret which can for example be by http digest or another service specific mechanism to proving knowledge of a shared secret.

If the client service is able to decrypt the token and validate the token secret the client service knows that the token was issued by the identity provider for the particular client service and was provided by the client application that knows the token secret. The client application that sent the token is also known to be the client application that requested the token on the basis of the user agent only providing the token and token secret to the client application that made the request. It is also known that the user profile data that is the claims were valid at the time the identity provider generated the token and that the token refers to the user that was authenticated on the user device at the time the token was generated.

In general an example system and method are provided for secure communication of data to a client service in communication with a client application. The method includes generating an encrypted token the token comprising user profile data and a token secret the token being decryptable by the client service communicating the token to the client service for decryption and communicating the token secret to the client application wherein the client service is operable to verify that the token secret communicated to the client application is equal to the token secret of the token.

In another aspect the identity provider generates the token secret the identity provider in communication with a mobile device and the mobile device comprising the client application. In another aspect if the token secret communicated to the client application is equal to the token secret of the token the client service has a high confidence that the token comprises the user profile data.

The steps or operations in the flow charts described herein are just for example. There may be many variations to these steps or operations without departing from the spirit of the invention or inventions. For instance the steps may be performed in a differing order or steps may be added deleted or modified.

Although the above principles have been described with reference to certain specific embodiments various modifications thereof will be apparent to those skilled in the art without departing from the scope of the claims appended hereto.

