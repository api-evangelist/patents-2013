---

title: Method and apparatus to use audio port to provide power and data communications for peripheral devices
abstract: Techniques for providing power and communicating data via an audio interface to a peripheral device are described herein. In one embodiment, a peripheral device is communicatively coupled to a host device via an audio interface of the host device, where the audio interface includes a first stereo output channel, a second stereo output channel, an audio input channel, and a ground pin. The peripheral device receives from the host device a first audio signal via the first stereo output channel and a second audio signal via the second stereo output channel. In response, the peripheral device harvests energy from both the first audio signal and the second audio signal to generate direct current (DC) power to power one or more hardware components of the peripheral device including a processor of the peripheral device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09271099&OS=09271099&RS=09271099
owner: 
number: 09271099
owner_city: 
owner_country: 
publication_date: 20130808
---
This application claims the benefit of U.S. Provisional Patent Application No. 61 692 238 filed Aug. 23 2012 which is incorporated by reference herein in its entirety.

Embodiments of the present invention relate generally to operations of electronic devices. More particularly embodiments of the invention relate to providing power and communicating between a host device and a peripheral device via an audio interface.

An audio port in a personal computer and a mobile electronics device is very rarely used for data communication and power transferring. As a modern electronics device is getting smaller and more powerful it can be made with more and more functions due to the portability requirement. Most of them have very limited external interfaces to communicate with a peripheral device. Besides universal serial bus USB and wireless interface an audio port or interface provides a very non expensive approach for a host device to communicate with a peripheral device.

In the mean time to simplify the design of both host and peripheral devices and reduce the cost it is desirable to transfer power from the host device to the peripheral device through the audio interface. Conventional systems use one channel of stereo audio port to provide power to a peripheral device and the other channel used for data communication. Limited to the driving strength of audio port one audio channel is not sufficient to provide enough power for many applications.

Various embodiments and aspects of the inventions will be described with reference to details discussed below and the accompanying drawings will illustrate the various embodiments. The following description and drawings are illustrative of the invention and are not to be construed as limiting the invention. Numerous specific details are described to provide a thorough understanding of various embodiments of the present invention. However in certain instances well known or conventional details are not described in order to provide a concise discussion of embodiments of the present inventions.

Reference in the specification to one embodiment or an embodiment means that a particular feature structure or characteristic described in conjunction with the embodiment can be included in at least one embodiment of the invention. The appearances of the phrase in one embodiment in various places in the specification do not necessarily all refer to the same embodiment.

According to some embodiments an improved method is provided to use an audio port or interface to connect a host device with a peripheral device. Through this connection the host device delivers power to the peripheral device and duplex data communication is established between the host device and its peripheral device. Referring to host device is communicatively coupled to peripheral device via audio interface which in this example is an audio cable.

Host device can be any of the computing or electronics device such as for example a desktop a laptop a tablet a personal digital assistant PDA a gaming device a media player a mobile phone a set top box or any other devices that can run user application program to do data processing and have a compatible audio interface or port. In one embodiment audio interface can be any of audio plug or jack that have four contact pins representing with respect to host device a left stereo output channel right stereo output channel an audio input channel e.g. microphone and a ground. In a particular embodiment audio interface is a 3.5 millimeter mm audio plug having four contacts as described above.

The term peripheral device is generally defined as any data acquisition devices such as an electrocardiography ECG sensor a temperature sensor a humidity sensor auxiliary devices such as a mouse keyboard etc. that connects to and communicates with the host device through this host device s audio port.

Unlike a conventional method which uses one of the stereo output channels to deliver power and uses the other channel to transmit data in one embodiment of the invention host device utilizes two audio output channels and audio interface as a differential pair to deliver power to peripheral device . In addition host device will use a differential audio signal which delivers power to peripheral device as a carrier modulate data onto this differential audio carrier signal and transmit data to peripheral device via this differential pair. Peripheral device is configured to harvest power from the audio signals received from the differential pair and also to demodulate the data from the audio signals. When peripheral device attempts to respond or communicate data back to host device peripheral device may transmit the data which may be encoded to a format can be transferred direct in audio interface or may also be modulated onto a separate audio carrier signal via an audio input channel of audio interface .

In this example by driving two stereo output channels with complementary AC signals host device can deliver as much as twice power to peripheral device compared to using only one channel by a conventional system. By modulating data onto the differential AC signal data also transferred to peripheral using same audio port. Assuming the maximum output peak to peak voltage delivered to one audio channel is Vpp if we drive the other channel Vpp phase inverted we will obtain 2Vpp on the peripheral side. Assuming that output impedance of each audio channel of host device equals to Zo and input impedance of peripheral device optimized to 2Zo the maximum power received by peripheral device is

An operating system e.g. Andriod iOS Windows will run on the host device processor s includes various software components and or drivers to make all components work.

A software application not shown may be executed from memory by processor s which will request services from the peripheral device through the audio port. For example host device may be a mobile device having a mobile application running therein to communicate with peripheral device via the audio interface In one embodiment when the application is launched within the host device such as a mobile device the application attempts to access an audio stack or framework of an operating system of the host device. For example the application may attempt to drive predetermined audio data or waveforms to the audio interface via the audio framework provided by the operating system.

According to one embodiment when an application is activated or executed by processor from memory the application communicates with an operating system e.g. Andriod iOS Windows to drive audio data onto audio output channels . The application may communicate with an audio subsystem of the operating system for example via an application programming interface API provided by the operating system. The audio data is handled by an audio driver and converted to audio signals by the audio circuitry . The audio signals may be delivered via paths and received by peripheral device . The audio signals transmitted on paths are complementary signals to form differential audio signals. The differential audio signals are received by voltage converter . Voltage converter is to convert the signals received from host device to a predetermined range optimized for circuit in power harvest module . One embodiment of voltage converter may be a transformer if the power harvest circuit can work with differential audio signal voltage from host device directly then voltage converter can be just two wires pass through the original signal. The output of voltage converter is connected to a power harvest module and a downstream data path to be processed by analog to digital A D converter .

In one embodiment power harvest module is to harvest energy from the differential audio signals and convert the energy into DC voltage to power up other components such as microcontroller and user application circuit of peripheral device . In one embodiment power harvest module may include a variety of rectifier such as for example circuits as shown in or B. Referring to the circuit includes a rectifying bridge having four metal oxide semiconductor field effect transistors MOSFETs to convert the AC signals into DC voltage. The output of the rectifying bridge is coupled to a diode to prevent the current from going backward. The capacitor serves a low pass filter to filter certain high frequency noise. In one embodiment the circuit further includes a voltage regulator to regulate the output DC voltage. Voltage regulator can be linear regulator or switching regulator. Alternative implementation can use other rectifier as shown in are just two examples of the rectifier circuits the rectifier has many varieties for example half wave rectifier and voltage multiplying rectifier are not shown.

Referring back to in one embodiment microcontroller and the program running on it will manage the operation of peripheral device. Microcontroller is a small computer on a single integrated circuit containing a processor core memory and programmable input output peripherals. Microcontroller may integrate other function like ADC DAC Comparator timer etc. Program running on the microcontroller will 1 receive information from host device explained in 2 control the user application circuit e.g. temperature sensors and exchange information with it and 3 convert data to a format that can be transmitted in audio signal and transmit to host device through the microphone input port of host device.

Referring to A D converter includes a comparator to convert differential analog audio signal e.g. audio signal with modulated data to a two level digital signal. The digital signals are used by microcontroller for demodulating and processing. In one embodiment as shown in a program running on the microcontroller demodulates and decodes the raw data from the comparator and sends the result data to other processing logic for example user application circuit as an intended recipient of the data. In one embodiment this comparator is inside the microcontroller.

Referring to when microcontroller transfers data to host device through voltage converter a program running on microcontroller will convert the data to a format that can be transferred through an audio channel. One embodiment is to modulate a signal to a carrier for example using Bell signaling method. Another embodiment is to use line code technology to eliminate the DC component of the raw data and transfer digital signal in base band. Both methods will be referred as a modulate method in this data transmission from a peripheral device to a host device.

Voltage converter is used to convert the voltage level of output of microcontroller to a proper range required by host device audio input channel. In one embodiment voltage converter is a voltage divider consists of two resistors.

The data may be modulated onto the audio carrier signals via a phase shift keying PSK method or a frequency shift keying FSK modulation method. shows the complementary audio signals with FSK modulation according to one embodiment is binary one data which is represented by a first predetermined number of consecutive cycles e.g. 10 cycles of a first predetermined frequency e.g. 11.025 kilohertz or KHz . is binary zero data which is represented by a second predetermined number of consecutive cycles e.g. 8 cycles of a second predetermined frequency e.g. 8.82 KHz .

Referring back to according to one embodiment microcontroller is programmed to set timer interrupt clock cycle to Tint 1 44.1 k 4 seconds. The number of this timer interrupt will be counted between two rising edges of the A D converter output. Each 11.025K signal cycle will have 16 Tint clock count and each 8.82 KHz signal cycle will have 20 Tint clock count. If is selected as a threshold and the bit rate is 1.1025 KHz baud each bit will take 907.029 micro second us . Every bit will last eight 8.82 k cycles and every bit will last ten 11.025 KHz cycles. Microcontroller will count the Tint cycles between two rising edge of comparator output. If the count is smaller than 18 then this is an 11.025 KHz signal otherwise it is an 8.82 KHz signal.

At block the host device s processing logic e.g. application and or operating system transmits a differential audio signal on the audio interface e.g. audio socket or jack of the host device which is communicatively coupled to and received by the peripheral device. The transmitted differential audio signals are used to provide power to the peripheral device. At block host device s processing logic waits for a response from the peripheral device via the audio interface of the host device input channel e.g. microphone for a predetermined time period. If the host device application receives a response from the peripheral device which confirms the peripheral power on process completes successfully and then host device application starts a process at block otherwise the application will inform a user to check connection of the peripheral device and keeps executing black until a confirmation is received. At block processing logic starts duplex data communication by encoding and modulating data onto the differential audio signals as carrier signals on output channels to be sent to the peripheral device. At the same time the application will receive data from the input audio channel.

At block when it is determined that the application has data to be sent to the peripheral device the application drives a second predetermined frequency and number of cycles of pulses onto the audio carrier signal at block . In one embodiment the application drives T seconds e.g. 1 1102.5 seconds or 907.029 microseconds or s of a differential signal at a second predetermined frequency. The second predetermined frequency may be 8.82 KHz. The first T seconds of the second predetermined frequency after IDLE state may be used as a start bit for receiver to synchronize with the transmitter. After the start bit at block application will send out data bit including parity check bit or cyclic redundancy check CRC bits depend on the communication protocol e.g. universal asynchronous receiver transmitter or UART protocol . In one embodiment for each bit having a logical value of one processing logic sends out T seconds of pulses having the first predetermined frequency at block . For each bit having a logical value of zero processing logic will send out T seconds of pulses having the second predetermined frequency at block . After all data bits are completed processing logic completes the transaction with T seconds of pulses having the first predetermined frequency at block which serve as a stop bit and keep sending until next data are ready.

The following table is an example sending a byte A at 1102.5 baud rate it sends out 907.029 us of 8.82K signal as start bit. Then it sends 907.029 s of 11.025K as binary 1 and so on until all data bits and stop bit are sent and return to idle state.

In one embodiment at block a predetermined number of cycles in this example 18 is selected as a threshold to determine types of signals received. Since the bit rate is 1.1025 KHz baud each bit will take 907.029 s. Every bit will last eight 8.82 KHz cycles block and every bit will last ten 11.025 KHz cycles block . After application starts the host will keep sending the 11.025 KHz signal to the peripheral device which represents an IDLE state block . The microcontroller will count the Tcycles between two rising edges of comparator output. If the count is smaller than 18 then the signal is an 11.025 KHz signal otherwise it is 8.82 KHz signal cycle.

After the peripheral receives first consecutive 8.82 KHz signal cycles which represents a start bit in many communication protocols the peripheral device enters a DATA state block . In the DATA state for 10 consecutive 11.025 KHz cycles a bit is received block . For 8 consecutive 8.82 KHz cycles a bit is received block . The microcontroller keeps receiving data until all data bits in one transfer session are received block . After one transfer session is done the host will keep sending 11.025 KHz signal cycles which put the transfer in an IDLE state block .

Note that while illustrates various components of a data processing system it is not intended to represent any particular architecture or manner of interconnecting the components as such details are not germane to embodiments of the present invention. It will also be appreciated that network computers handheld computers mobile phones and other data processing systems which have fewer components or perhaps more components may also be used with embodiments of the invention.

Some portions of the preceding detailed descriptions have been presented in terms of algorithms and symbolic representations of operations on data bits within a computer memory. These algorithmic descriptions and representations are the ways used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. An algorithm is here and generally conceived to be a self consistent sequence of operations leading to a desired result. The operations are those requiring physical manipulations of physical quantities.

It should be borne in mind however that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the above discussion it is appreciated that throughout the description discussions utilizing terms such as those set forth in the claims below refer to the action and processes of a computer system or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission or display devices.

The techniques shown in the figures can be implemented using code and data stored and executed on one or more electronic devices. Such electronic devices store and communicate internally and or with other electronic devices over a network code and data using computer readable media such as non transitory computer readable storage media e.g. magnetic disks optical disks random access memory read only memory flash memory devices phase change memory and transitory computer readable transmission media e.g. electrical optical acoustical or other form of propagated signals such as carrier waves infrared signals digital signals .

The processes or methods depicted in the preceding figures may be performed by processing logic that comprises hardware e.g. circuitry dedicated logic etc. firmware software e.g. embodied on a non transitory computer readable medium or a combination of both. Although the processes or methods are described above in terms of some sequential operations it should be appreciated that some of the operations described may be performed in a different order. Moreover some operations may be performed in parallel rather than sequentially.

In the foregoing specification embodiments of the invention have been described with reference to specific exemplary embodiments thereof. It will be evident that various modifications may be made thereto without departing from the broader spirit and scope of the invention as set forth in the following claims. The specification and drawings are accordingly to be regarded in an illustrative sense rather than a restrictive sense.

