---

title: Simulation-based estimation of elasticity parameters and use of same for non-invasive cancer detection and cancer staging
abstract: Simulation-based estimation of elasticity parameters and use of same for non-invasive cancer detection and cancer staging are disclosed. According to one aspect, a method for simulation-based estimation of elasticity parameters includes constructing a 3D model of an object comprising biological tissue, the model having a first shape and an elasticity value. A simulation iteration is then performed, which includes simulating the application of an external force to the model, causing the model to have a second shape, measuring the difference between the second shape and a target shape, and determining whether the measured difference between the second shape and the target shape is within a threshold of error. If the measured difference is not within the threshold of error, the process performs additional iterations using adjusted elasticity or force values until the measured difference is within the threshold of error, at which time the final elasticity and force values are reported. In one embodiment, the elasticity value is mapped to a diagnostic parameter, such as an indication of the possibility, presence, or stage of cancer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09636075&OS=09636075&RS=09636075
owner: THE UNIVERSITY OF NORTH CAROLINA AT CHAPEL HILL
number: 09636075
owner_city: Chapel Hill
owner_country: US
publication_date: 20130806
---
This application claims the benefit of U.S. Provisional Patent Application Ser. No. 61 680 116 filed Aug. 6 2012 the disclosure of which is incorporated herein by reference in its entirety.

This invention was made with government support under Grant No. W911NF 06 1 0355 awarded by the U.S. Army Research Office and Grant No. R01 RR018615 awarded by the National Center for Research Resources and the National Cancer Institute. The U.S. Government has certain rights in the invention.

The subject matter described herein relates to methods and systems for characterization of biological tissue elasticity using non invasive means. More specifically the subject matter described herein relates to simulation based estimation of elasticity parameters which may be used for non invasive cancer detection and cancer staging.

Estimation of tissue stiffness is an important means of noninvasive cancer detection. Existing elasticity reconstruction methods usually depend on a dense displacement field given by ultrasound or MR images and known external forces. Many imaging modalities however cannot provide details within an organ and therefore cannot provide such a displacement field. Furthermore force exertion and measurement can be difficult for some internal organs making boundary forces another missing parameter.

Material property estimation has been an important topic in noninvasive cancer diagnosis since cancerous tissues tend to be stiffer than normal tissues. Traditional physical examination methods such as palpation are limited to detecting lesions close to the skin and reproducible measurements are hard to achieve. With the advance of medical imaging technologies it becomes possible to quantitatively study the material properties using noninvasive procedures.

Computer vision methods in combination with force or pressure sensing devices have been proposed to find material properties of tissues 1 2 . These methods require a controlled environment in order to capture the video and force pressure and therefore the experiments are usually done ex vivo. Kauer et al. 1 combined the video and pressure capturing components into a single device to simplify the measurement process so that it can be performed in vivo during a surgical intervention. However the device still needs to be in direct contact with the tissue and only a small portion of the tissue can be measured due to the size of the device.

Elasticity reconstruction or elastography is a noninvasive method for acquiring strain or stiffness images using known external forces and a known displacement field 3 4 . The reconstruction is usually formulated as an inverse problem of a physically based simulation of elastic bodies and a popular choice of the simulator is based on a linear elasticity model solved with the finite element method FEM 5 where the domain of the image is subdivided into tetrahedrons or hexahedrons called elements with vertices known as nodes. Boundary conditions displacement vectors or forces on some of the nodes must be given to drive the simulation. Under this framework nodal displacement vectors need to be computed based on a pair of images and the force exertion mechanism needs to be controlled so that external forces can be measured. Otherwise without measured forces only relative elasticity values can be recovered. Ultrasound elastography 6 for example compares two ultrasound images one taken at the rest pose and the other taken when a known force is applied. The displacement vector for each pixel can be estimated using cross correlation analysis 3 7 or dynamic programming 8 to maximize the similarity of echo amplitude and displacement continuity. Alternatively in dynamic elastography for example magnetic resonance elastography MRE and vibroelastography an MRI or ultrasound machine in tune with an applied mechanical vibration shear wave is used to find the displacement field 4 9 . With known external forces and displacement field the elasticity can be computed by solving a least squares problem 10 11 12 if the algebraic equations resulting from the physical model is linear. A real time performance has been reported using this direct method with a simplified 2D domain that assumes homogeneous material within a region 12 . Another type of method uses iterative optimization to minimize the error in the displacement field generated by the simulator 13 14 15 . Although slower than directly solving the inverse problem this type of method does not assume linearity of the underlying physical model. A different kind of elastography 16 17 18 maximizes image similarity without requiring the displacement field or boundary conditions to be known but the method relies on salient features within the object such as the breast which may not be present in CT images of organs such as the prostate. A phantom study applied the method to the prostate 17 but the model and boundary conditions are greatly simplified and their method has not been applied to real patient data. A Bayesian framework has also been proposed to solve the elastography problem without requiring known boundary conditions 19 . That method however depends on assumptions about probability distribution functions and extensive sampling in a very high dimensional parameter space elasticity and boundary conditions which significantly limits the number of boundary nodes. While these methods are instrumental in their respective fields of interest they are less well suited for a more general multi organ case where the image intensity may be almost constant within an organ such as the prostate and the lack of image details within the object makes it impossible to rely on pixel wise correspondence. Moreover the force exertion or vibration actuation mechanism can become complicated when the target tissues are deep inside the body. For example for an elastography of the prostate an actuator or a pressure sensor is sometimes inserted into the urethra or the rectum 20 9 21 .

Elasticity parameters are also essential in cardiac function estimation where sequential data assimilation 22 23 has been applied to estimate simulation parameters and displacements simultaneously for dynamic mechanical systems. The parameters and observations of displacements states at each time step are modeled with a probability distribution and a filtering procedure is applied over some time to estimate the states. Due to the computational complexity of the method the number of estimated parameters has been very limited in work on cardiac function estimation 22 . On the other hand our parameter space includes external forces as well as the Young s modulus and the displacement field cannot be acquired directly from some common imaging modality like CT.

Accordingly there exists a need for the ability to estimate biological tissue elasticity parameters where either the force or displacement is unknown or cannot be determined. Specifically there exists a need for non invasive estimation of biological tissue elasticity parameters and use of same for non invasive cancer detection and cancer staging.

We propose a general method for estimating elasticity and boundary forces automatically using an iterative optimization framework given the desired target output surface. During the optimization the input model is deformed by the simulator and an objective function based on the distance between the deformed surface and the target surface is minimized numerically. The optimization framework does not depend on a particular simulation method and is therefore suitable for different physical models. We show a positive correlation between clinical prostate cancer stage a clinical measure of severity and the recovered elasticity of the organ. Since the surface correspondence is established our method also provides a non rigid image registration where the quality of the deformation fields is guaranteed as they are computed using a physics based simulation.

According to one aspect of the subject matter described herein a method for simulation based estimation of elasticity parameters includes constructing a 3D model of an object comprising biological tissue the model having a first shape and an elasticity value. A simulation iteration is then performed which includes simulating the application of an external force to the model causing the model to have a second shape measuring the difference between the second shape and a target shape and determining whether the measured difference between the second shape and the target shape is within a threshold of error. If the measured difference is not within the threshold of error the process performs additional iterations using adjusted elasticity or force values until the measured difference is within the threshold of error at which time the final elasticity and force values are reported. In one embodiment the elasticity value is mapped to a diagnostic parameter such as an indication of the possibility presence or stage of cancer.

According to another aspect of the subject matter described herein a system for three dimensional estimation of elasticity parameters includes a simulator configured to simulate the application of an external force to a 3D model of an object comprising biological tissue the model having a first shape and an elasticity value the simulated external force having a force value and the application of the simulated force causing the model to deform to a second shape. The system also includes a parameter estimation module configured to measure a difference between the second shape and a target shape to determine whether the measured difference between the second shape and the target shape is within a threshold of error in response to a determination that the measured difference is not within the threshold of error to adjust at least one of the elasticity value and the force value and repeated the simulating measuring and determining until the measured difference is within the threshold of error and in response to a determination that the measured difference is within the threshold of error to map the elasticity value to a diagnostic parameter.

The subject matter described herein can be implemented in hardware or hardware in combination with software and or firmware. For example the subject matter described herein can be implemented in software executed by a processor. In one exemplary implementation the subject matter described herein can be implemented using a non transitory computer readable medium having stored thereon computer executable instructions that when executed by the processor of a computer control the computer to perform steps. Exemplary computer readable media suitable for implementing the subject matter described herein include non transitory computer readable media such as disk memory devices chip memory devices programmable logic devices and application specific integrated circuits. In addition a computer readable medium that implements the subject matter described herein may be located on a single device or computing platform or may be distributed across multiple devices or computing platforms.

In accordance with the subject matter disclosed herein systems methods and computer readable media for simulation based estimation of elasticity parameters and use of same for non invasive cancer detection and cancer staging are provided. Reference will now be made in detail to exemplary embodiments of the present invention examples of which are illustrated in the accompanying drawings. Wherever possible the same reference numbers will be used throughout the drawings to refer to the same or like parts.

We propose an entirely passive analysis of a pair of images that only uses information about the boundaries of corresponding internal objects. We assume the images have already been segmented that is the organ boundaries have been found. Since we do not assume a good correspondence for pixels inside an object the resolution of the resulting elastogram is limited to the object boundaries. Namely we assume that the elasticity is fixed within each object whose boundary can be identified. Natural movements inside the body provide the deformation of the organs and we do not need an additional force exertion or vibration actuating mechanism. We minimize the distance between the deformed reference surface and the target surface and optimize for the elasticities and boundary forces. Currently as a simplification we consider only Young s modulus which measures the stiffness or elasticity of the material . It is the simplest parameter to work with and it is also important in noninvasive cancer detection techniques. The general optimization framework extends naturally to the inclusion of other parameters such as Poisson s ratio which measures compressibility of the material and in fact is suitable for a variety of physical models. In our experiments the images are obtained from a prostate radiotherapy where there is one reference planning CT image and multiple target daily images for each patient and the Young s moduli of the prostate recovered from the pairs of images are averaged. Our initial investigation involving 10 patient data sets shows that the recovered elasticity values positively correlate with the clinical tumor stages which demonstrates its potential as a means of cancer stage assessment. Furthermore compared broadly to other work on simulation parameter estimation our method does not require the inclusion of forces as part of the input and can therefore avoid the process of measuring the external forces at the cost of only providing relative force information in our results .

Our method also produces an image registration 24 25 pixel wise correspondence between images since the distance between the pair of surfaces segmentations is minimized. The FEM has been applied to image registration given that the images are segmented 26 27 28 29 30 31 32 . Material properties however are not trivial to find from the images and most authors use ex vivo experimental results to set up the materials. Moreover due to the patient to patient differences these material properties sometimes need hand adjustments. Alterovitz et al. 33 incorporated an optimization of Young s modulus and Poisson s ratio into an FEM based registration but the method has only been implemented for coarse 2D meshes. As a non rigid image registration method ours improves over previous simulation based methods by providing an automatic means of finding the parameters that are missing in the images. Our current implementation uses both standard linear and nonlinear material models but the optimization framework should be applicable to tissues with more advanced and complex physical models.

At step the process checks to see if the error is minimized i.e. below some acceptable threshold value. If not then at step one or more parameters into the FEM simulation e.g. elasticity forces etc. are updated and the process returns to step . Steps and are repeated until at step the error has been minimized to an acceptably low level at which point the process moves to step . At step the elasticity value last used by FEM simulation is mapped to a diagnostic parameter such as an indication of probability that the tissue being modeled is cancerous pre cancerous or non cancerous. Example calculations used during the process described in will be discussed in more detail below.

The specific algorithms used by exemplary methods and systems of the subject matter described herein will now be described in detail. We explain the elastic model and the optimization scheme in Section II followed in Section III by experimental results using two synthetic scenes and 10 sets of real CT images to demonstrate the feasibility of our method. We conclude with a summary.

The idea of the algorithm is to optimize a function based on the separation between corresponding organ boundaries. In each iteration the objective function is computed by first simulating and deforming the surface using the current set of parameters and then computing surface distances. We consider only the elasticity value Young s modulus with Poisson s ratios being chosen according to previous work on simulation based medical image registration 30 .

The inputs to the correspondence problem are two segmented images a fixed image with segmentation Sand a moving image with segmentation S. The bones are already aligned using a rigid registration method described in 34 . Each segmentation is represented as a set of closed triangulated surfaces one for each segmented object. We construct a tetrahedralization of the moving volume such that each face of Sis a face in the tetrahedralization so that Sis characterized entirely by its set of nodes. Our optimization framework is built on a physically based simulator that generates deformation fields with n unknown parameters x x . . . x and a numerical optimizer to minimize an objective function x defined by the deformation and surface matching metrics. During the optimization process the physical model is refined in terms of more accurate parameters and converges to a model describing the deformation needed for the particular surface matching problem. Here we use the linear FEM to illustrate the optimization scheme although the framework can also be incorporated with a nonlinear FEM. A flow chart of our algorithm is shown in and will be explained in detail in this section.

In the optimization loop the displacement field u u v w is always generated by a physically based simulation where the FEM is used to solve the constitutive equations of the linear elasticity model. Assuming isotropic linear elasticity we can write D where is the stress vector induced by the surface forces is the strain vector defined by the spatial derivatives of the displacement u and D is a matrix defined by the material properties assuming an isotropic material the properties are Young s modulus E and Poisson s ratio v .

Assuming linear elasticity the stress vector is a linear transformation of the strain vector change of shape or size and the transformation is defined by the material properties assuming isotropic material the properties are Young s modulus and Poisson s ratio of the elastic body. The strain vector is defined by the derivatives of the deformation u u v w 

To solve the equations numerically we approximate the derivatives of the deformation with the FEM where the domain is subdivided into a finite set of elements and each element consists of several nodes.

To make the nodes deform some boundary conditions need to be enforced either by assigning displacement values or by assigning forces to some nodes. If all the surface nodes including boundaries between two materials are assigned displacement values then the simulation is essentially an interpolation of the displacement field from surface matching results. This means that the elasticity values only affect internal nodes for which we do not know the target positions. Therefore the elasticity cannot be recovered. Instead we only assign boundary conditions to a part of the surface nodes and other surface nodes without boundary conditions will be affected by the relative elasticities. For example in a simulation of the male pelvis area the bladder and the rectum are usually the organs that drive the deformation of the prostate while the pelvic bone is considered static. An intuitive choice is to apply boundary conditions on boundary nodes of the bladder the rectum and the pelvic bone and set all other entries in the force vector to zero no external forces as proposed in 30 .

Since our method is based on the assumption that the deformed surface depends on both the elasticity and the external forces we first conduct an experiment of forward simulations using different parameter values to see how sensitive the surface is to these parameters.

The parameters needed in the simulator are x E F where E consists of the material properties in our case the Young s moduli and F is the vector of external forces on boundary nodes. The objective function to be minimized is defined as the difference between the segmentations in the moving and target images 

The gradient of the objective function which is needed in the iterative optimization is given by the chain rule 

We use a line search scheme for optimization in each iteration k we find a descent direction pfind an optimal step size a in that direction with a line search algorithm and then update the parameters with x x p. The descent direction can be computed by using Newton s method to solve the equation 0 p B x where B is the Hessian matrix

Quasi Newton methods can reduce the computation yet still retain a super linear convergence rate. A line search enforcing the curvature condition sy 0 needs to be performed to keep the approximate Hessian positive definite. In our case the number of parameters can be in the thousands and therefore we adopt a limited memory quasi Newton method known as the L BFGS method 35 .

A good initial guess can prevent the optimizer from getting stuck in a local minimum. Our initial guess for the forces is based on the distance field of the target surface each node requiring a boundary condition is moved according to the distance field to compute a Dirichlet boundary condition. A forward simulation is performed using the set of boundary conditions and the initial guess of elasticities and the output deformation is used via 1 to compute the corresponding forces which become the initial guess for the forces.

In the case of medical image registration the initial guess of the elasticity is chosen based on knowledge of the simulated organs. Our example images involve two materials the prostate and the surrounding tissue. There have been ex vivo experiments on the prostate using different elasticity models. Krouskop et al. 36 reported an elastic modulus of 40 80 kPa for normal prostate tissue 28 52 kPa for BPH tissue and 80 260 kPa for cancerous tissue when receiving 4 compression.

They also reported 10 30 kPa for breast fat tissue. Based on these numbers for fat tissue we chose an elasticity value of 10 kPa for the tissue surrounding the prostate. This value is fixed in our calculations since only the ratio of the elasticity values matters.

The initial guess of elasticity for the prostate is chosen by a parameter search we perform force optimizations with several elasticity values between 30 kPa and 200 kPa and choose the elasticity with the lowest objective function value after the force optimization.

We used the male pelvis area as the test scene. To build the reference surfaces we obtained segmentations of a 3D CT image of the male pelvis area including the surfaces of the bladder prostate rectum and bones. A tetrahedral finite element mesh is constructed from a set of reference surfaces as shown in . The corresponding target surfaces are used to compute the distance map as shown in . In the tetrahedral mesh the bladder and the rectum are made hollow to reflect the actual structure and the bones are fixed during the simulations. Since the prostate is the main organ of interest we apply forces only on the boundaries of the bladder and the rectum to reduce the uncertainty on the prostate which will be moved by surrounding tissues. The setting also reflects the fact that the bladder and the rectum are the organs that have larger deformations due to different amount of fluid and gas and the prostate is usually deformed by their movement.

During the iterative optimization the objective function is evaluated over the surfaces of the bladder rectum and prostate. The Poisson s ratios are fixed 0.40 for the prostate and 0.35 for surrounding tissues chosen based on literature in image registration 28 37 30 and we optimize for the elasticity values because of its importance in noninvasive cancer detection. Since only the relative values of material properties can be recovered we fix the Young s modulus of the surrounding tissues the region outside all organs and bones to 10 kPa and optimize that of the prostate.

We tested our algorithm on two types of surface data. First we tested the accuracy of the optimization scheme using synthetic target surfaces generated by forward simulations so that we know the true elasticity values. We then applied the technique to prostate cancer stage assessment based on multiple segmented target images of the same patient to show applicability to real data. Since the distances between reference and target surfaces are minimized we also compare the visual result the warped image with that of an image based image registration method.

The reference and target organ surfaces are obtained from real 3D CT images of the male pelvis area using the software MxAnatomy Morphormics Durham N.C. and the bones are segmented using ITK SNAP 38 . Given the moving surfaces in the form of triangle meshes the tetrahedral model for the entire domain is built with the software TetGen 39 and the library ITK 40 is used to compute the vector distance maps of the target surface. The FEM simulator uses the linear algebra library PETSc 41 .

The image segmentation was done with an early semi automatic version of software MxAnatomy. For the prostate the user typically needed to specify 15 20 initial boundary points on five image slices and it usually took 20 minutes to segment the three main organs prostate bladder and rectum in a CT image. The semi automatic segmentation of bones ITK SNAP requires some initial pixels specified with a few spheres that are roughly in line with the bones and the algorithm iteratively grows or shrinks from these initial pixels until an optimal binary image of the bone is achieved. It usually takes 15 minutes for the segmentation of bones. Once the surface meshes are generated the tetrahedralization takes a few seconds using the software TetGen.

To test how well our algorithm recovers elasticity values we use synthetic target surfaces generated with known elasticity and boundary conditions. The target surfaces are generated by a forward simulation with Dirichlet boundary conditions acquired from a real pair of segmented images applied to the bladder and rectum surfaces.

To show the effectiveness of our method applied to prostate cancer assessment we repeated the experiments on the multi organ settings but with both the deformed and target surfaces taken from segmented 3D CT images of the male pelvis area. We consider 10 patient data sets taken throughout courses of radiotherapy for prostate cancer. Each patient data set consists of a set of reference surfaces bladder prostate rectum and bones which is from the CT image reference image taken before the radiotherapy and multiple sets of target surfaces each of them representing the internal structures in one daily CT image during the therapy. The reference image is taken about a week before the first treatment and treatment target images are typically taken twice a week. For each patient data set we repeated the process of deforming the reference surfaces toward a set of target surfaces with our method so that one elasticity value of the prostate is recovered for each daily image.

Each of the 10 patient data sets tested include 6 to 17 sets of target surfaces daily images namely 112 target images in total and the recovered elasticity values of the prostate for each patient are shown in Table II. Notice that the recovered values from all image pairs are within the range suggested in the literature 36 and the result shows consistency within each patient.

The aim of this study is to assess the relation between the recovered elasticity value and the cancer stage of each patient under the assumption that prostates with more advanced tumors have higher stiffness. A common cancer staging system is the TNM Tumor lymph Nodes Metastasis system where the clinical T stage describes the size and extent of the primary tumor 42 . The definitions of T stages are shown in Table III.

We focus on the T stage because of its relevance to the stiffness of the prostate. The clinical T stages for the patients are shown in the last column of Table II. In order to analyze the data statistically we treat the average recovered elasticities and tumor stages as two random variables and use numbers 1 2 and 3 to represent T stages Ti T2 and T3 respectively TO and T4 are not present in our data sets and we test if the recovered elasticity values and the T stages are positively correlated. The resulting Pearson linear correlation coefficient is 0.662 and the p value for the two sided correlation test is 0.037 which indicates a significant positive correlation between the recovered elasticity values and the T stages based on a p value threshold of 0.05. Since the tumor stage values are discrete and might be nonlinear with respect to the elasticity a rank correlation coefficient such as the Spearman s rank correlation may be more suited for the test. From the samples we have Spearman s 0.701 and an estimated p value of 0.024 which shows again a significant positive correlation. The box plot of the elasticity values and cancer stages is shown in .

We assume a constant material property within an organ due to the limitation of the image modality where the intensity is almost constant within the prostate so that it is impossible to segment the tumor. The elasticity values recovered by our method are therefore average values in some sense and a higher recovered elasticity indicates either a stiffer tumor or a larger tumor. Since the clinical T stage for prostate cancer depends on the extent of the tumor we conducted a study to show the correlation between the tumor size and the recovered elasticity value.

Since the distance between the fixed and moving surfaces is minimized during the optimization process we also have an image registration as a result of optimizing for forces and elasticities. In our experiments the final average value of the objective function is 0.09 corresponding to an RMS error of 0.01 cm and a maximum of 0.22 cm which are within the image resolution 0.1 0.1 0.3 cm.

We also compared our registration results with a popular image based approach the Demons method 43 by looking at some landmarks inside the prostate. In most cases the image intensity is almost constant inside an organ but five of the patient data sets a total of 32 image pairs we experimented on have three seeds implanted in the prostate for location tracking during each treatment fraction resulting in bright spots that can be observed in the CT image. The distance between the target and the deformed landmark positions from the two methods are shown in Table V and the two tail t tests for paired samples distances show that our method produces statistically significantly better results in three out of five patient data sets with a p value threshold of 0.05 .

For regions with nearly uniform intensity the deformation computed by the Demons method is entirely governed by the registration regularization terms which do not need to be physically meaningful for the image based method. Our method enforces physically based constraints and results in errors within the diameter of the spot. Notice that for the Demons method we replaced the voxel values inside the prostate with the average intensity within the organ since the intensity and gradient information from the landmarks could also be utilized in the image based registration giving it an additional advantage while our method is based purely on the physics based simulation and does not take advantage of the landmarks.

To demonstrate that our optimization framework can also be applicable to nonlinear models we incorporated a geometrically nonlinear FEM and the neo Hookean model with the elasticity optimization scheme. The linearized equilibrium formulation of the nonlinear FEM is 5 where fand fare the external and internal force vectors K u is the stiffness matrix that depends on the current displacement vector u and u is used to update the vector uin a Newton iteration u u u . The Jacobian matrix

We used the same multi organ scenes in Section III A and deformed them using the nonlinear FEM to generate the synthetic target surfaces. That is the nonlinear FEM is used in both generating synthetic cases and in the optimization scheme. The resulting recovered elasticity values are shown in Table VI. The errors are within 13 for the range we tested 50 200 kPa .

We repeated the experiments in Section III B using the nonlinear FEM. The recovered elasticity values for the 10 patient data sets are shown in Table VII.

The iterative optimization scheme requires a large number of solutions of the global linear system provided by the FEM. While the performance is acceptable for simple models with low degrees of freedom it may take more than eight hours for some complex 3D models with many thousands of degrees of freedom for boundary forces. Here we present an acceleration method that reduces the dimensionality of the parameter space the boundary forces and thus improves the convergence of the optimizer.

Krysl et al 2001 51 suggested that the FE model could be simplified with a set of basis vectors for the displacement field. The reduced dimension displacement vector is computed with 6 where W is the column matrix of orthonormal basis vectors called the reduced basis. Substituting Equation 4 into Equation 1 and left multiply both sides with W we have the reduced dimension linear system 7 where circumflex over K WKW and circumflex over f Wf.

In order to obtain W a set of example displacements is used in a principal component analysis PCA and some of the resulting principal components serve as the basis vectors. However the generation of the example displacements is nontrivial and depends on the specifics of the application. In keyframe based animation for instance the keyframes can serve as the examples 44 .

In medical image analysis there can be multiple 3D images of each patient taken on different days. Once the organs in the images are delineated they can provide examples of organ deformations. Furthermore if images from different patients can all be used as example deformations the resulting basis vectors can more effectively represent the general set of displacements even for surfaces that are not used in the training process. In order to achieve this a one to one correspondence must exist between boundary nodes in each pair of FE models and only the degrees of freedom for these boundary nodes can be reduced and other degrees of freedom are not affected by W .

We have implemented the elasticity parameter estimation algorithm and the acceleration techniques introduced here. We have applied our method to 2D shape deformations and a 3D elastography example using the reduced dimension modeling.

In 2D shape deformation with a single material the elasticity Young s modulus cannot be estimated since we do not know the true force applied. On the other hand the compressibility Poisson s ratio is the main source of difference in deformed shape if the same first type boundary conditions are applied. A perfectly incompressible material has the value 0.5 but in the isotropic linear elasticity model the value cannot be exactly 0.5 . Given the source piecewise linear represented by vertices and edges shape we build the triangular finite element mesh that fills the shape using the library Triangle 57 . The target shape is also given in the piecewise linear format and the distance function between the two shapes is based on distance between corresponding vertices. The boundary forces to be optimized are applied to a subset of nodes which can be chosen by the user. The FE mesh and the recovered Poisson s ratio can be used to generate other deformations of the same object.

Referring again to which shows a finite element model of a domain that consists of the bladder the prostate the rectum and the bones our framework is applied to 3D elastography of the prostate. The space is filled with tetrahedral elements using the library TetGen 39 and the bladder and the rectum are hollow to reflect their structure as shown in . There are two material properties one assigned to the prostate red elements in and the other assigned to the elements between organs shown in green in . The goal of the elastography is to find the ratio of Young s moduli of the prostate to that of the other elements. The bone is always fixed so its material property is irrelevant. The Young s modulus is the material property to be optimized here because of its significance in non invasive cancer detection. Poisson s ratios are set to 0.4 and 0.35 for the two materials based on common values used in medical simulations 30 . Boundary forces are applied to the surface nodes of the bladder and the rectum. The parameters to be optimized are the Young s modulus of the prostate and the boundary forces applied to the bladder and the rectum.

Reduced basis training. The degrees of freedom for the boundary forces are around 4 900 which makes the optimizer slow to converge taking thousands of iterations . Therefore a dimension reduction is performed with 108 example deformations from CT images. These images are from nine patient data sets each has one source image and several target images. The first step of generating examples is to create the node to node correspondence between source surfaces from different patient data sets. We use a surface matching approach to establish the correspondence an atlas surface is iteratively deformed to match each patient specific source surface and therefore each patient specific surface has the same set of nodes. The patient specific source surface is then matched with corresponding target surfaces to generate the example deformations for the organ.

We then test the accuracy of estimated elasticity values using two patient specific FE models that are not used in the training process. The models are deformed using three different elasticity values to generate the target surfaces so that we know the ground truth for the optimization. The relative errors range from 0.1 up to 8.1 and are generally less than 10 for the set of basis vectors chosen. The optimizer takes around 100 200 iterations to converge in an amount of time that is about 1 30 of what would otherwise be needed when using a full FE model. The average time needed for each iteration of force optimization is about 9 seconds.

We have presented a novel physically based method for simultaneously estimating the 3D deformation of soft bodies and determining the unknown material properties and boundary conditions. Previous elastography methods are limited by imaging modalities and force measurement schemes and we overcome these limitations by utilizing the surface information extracted from 3D images. Although the resolution of the resulting elastogram is limited to the object boundaries we showed that the recovered value reflects the distribution of materials within the object and the recovered elasticity values have a significant positive correlation with clinical prostate cancer staging in small scale experiments. Therefore our method has the potential to become a means of noninvasive cancer detection.

As a non rigid image registration method ours automatically determines the patient specific material properties during the registration. The resulting deformation field is enforced to be physically plausible since it is computed by the 3D FEM simulator with appropriate contact constraints among organs. The observed error on the boundary is within the resolution of the segmented images and the error on the internal bright spots as landmarks in the prostate is comparable to the diameter of the spots.

The optimization framework for joint estimation of both 3D deformation and material parameters is generalizable. It is not limited to elasticity reconstruction and could be used for more sophisticated physiological models than the basic linear and nonlinear elasticity models we chose for simplicity in our current implementation. As an image registration technique our method is reliable in terms of the registration error as a parameter estimation method our system can save an enormous amount of efforts adjusting the simulation parameters manually by automatically extracting patient specific tissue properties. Furthermore since only the 3D surfaces are used in our algorithm applications other than medical image analysis could also adopt the method.

It will be understood that various details of the subject matter described herein may be changed without departing from the scope of the subject matter described herein. Furthermore the foregoing description is for the purpose of illustration only and not for the purpose of limitation.

