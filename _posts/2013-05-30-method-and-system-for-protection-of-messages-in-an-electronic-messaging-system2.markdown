---

title: Method and system for protection of messages in an electronic messaging system
abstract: Methods, computer program products, computer systems, and the like, which protect messages in an electronic messaging system, are disclosed. The methods, computer program products, computer systems, and the like include detecting an occurrence of an event, and, in response to the detecting the occurrence of the event, scanning a message. The occurrence of the event indicates that the message should be scanned. The message includes recipient information, which identifies a recipient of the message, and is stored in a message store. The message has been received at a message destination associated with the recipient. The scanning uses a malware definition. The scanning is performed prior to the message being retrieved from the message store in response to a request by the recipient to retrieve the message from the message store. The event is other than the request by the recipient to retrieve the message from the message store.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09560069&OS=09560069&RS=09560069
owner: Symantec Corporation
number: 09560069
owner_city: Mountain View
owner_country: US
publication_date: 20130530
---
This application claims the benefit of Provisional Patent Application Nos. 61 732 388 filed on Dec. 2 2012 and 61 732 721 filed on Dec. 3 2012 both entitled Method and System for Protection of Messages in an Electronic Messaging System and both having Preeti Agarwal and Rohit Bhagwat as inventors. The above referenced provisional applications are hereby incorporated by reference in their entirety and for all purposes.

The present disclosure relates to the protection of electronic messaging systems and more particularly to the detection of malware associated with electronic messages conveyed via such electronic messaging systems.

Electronic messaging systems including e.g. electronic mail email systems instant messaging systems text messaging systems and other such messaging systems have become ubiquitous in both the commercial and private spheres and have changed the way businesses and individuals communicate with one another allowing users to quickly and easily exchange information. For example an individual can easily send and receive text messages emails or the like using one of any number of computing devices including personal computing devices e.g. so called smart phones tablet devices and the like laptop computers desktop computers and the like as well as larger computing systems e.g. availing themselves of access to server systems cloud based systems and the like . In a business setting an employee can draft an electronic document attach that document to an electronic message and send the message including the attached document to other employees allowing those employees to access the document at their convenience without having to obtain a physical copy of the document.

As businesses and individuals increase their usage of electronic forms of communication however new problems have begun to arise. For example the increasing use of email over both the Internet and private networks increases the exposure of individual users and operations to malicious disruption. One such problem is the possibility of malware attacks by way of such electronic messaging systems. For example email borne malware outbreaks have occurred with some frequency spreading across the globe in a matter of hours at times. Some degree of protection can be achieved by scanning emails and their attachments for malware while the emails are being conveyed through the network e.g. the Internet and or upon receipt. Typically the scanning of emails during their transport is done on a centralized basis e.g. by Internet Service Providers ISPs and or others who operate email gateways . Scanning can also be performed at an end user s machine upon the receipt of a given email and prior to storage thereof and ultimately access thereto by the intended recipient .

However even with the scanning of emails during transport and upon receipt there is still a problem with regard to new malware. For example it is possible for new malware to be released onto the Internet and begin infecting computers before a new malware definition containing information allowing identification of the new malware can be promulgated. In such a scenario a given email message may contain the new malware which would then go undetected as the given email message and new malware was conveyed to the intended recipient regardless of having been scanned during transport and upon receipt as a result of the old malware definition being used . Thus there exists a window of vulnerability in such messaging systems in which the period of time between when the last malware definition was made available and a new such malware definition is made available. In such scenarios then messaging systems lack protection from new malware introduced during such periods. Thus even leaving aside the question of how a new virus might first be detected and whether or not the given message was scanned during transport or receipt with a given malware definition there remains the need for functionality that protects messaging systems in such situations.

The present disclosure describes methods computer program products computer systems and the like that provide for detecting an occurrence of an event in response to the detecting the occurrence of the event scanning a message. The occurrence of the event indicates that the message should be scanned. The message includes recipient information which identifies a recipient of the message and is stored in a message store. The message has been received at a message destination associated with the recipient. The scanning uses a malware definition. The scanning is performed prior to the message being retrieved from the message store in response to a request by the recipient to retrieve the message from the message store. The event is other than the request by the recipient to retrieve the message from the message store.

In some embodiments the scanning includes reading the message from the message store. In other embodiments determining whether a time period has expired and if the time period has expired determining whether the message should be scanned. In such embodiments the event can include at least one of the receipt of a new malware definition the expiration of a time period or the receipt of the message. Such embodiments may further provide that the determination as to whether the message should be scanned includes determining whether a new malware definition is available from a local cache and if the new malware definition is available from the local cache retrieving the new malware definition from the local cache and indicating that the message should be scanned using the new malware definition retrieved from the local cache.

In certain embodiments the determination as to whether the message should be scanned further includes if the new malware definition is not available from the local cache determining whether the new malware definition is available from a server if the new malware definition is available from the server obtaining the new malware definition from the server and indicating that the message should be scanned using the new malware definition from the server and if the new malware definition is not available from the server indicating that the message should not be scanned.

In still other embodiments the message is one of a number of messages and the embodiments further include assigning a priority level of a number of priority levels to each message of the messages determining a scan order in which to scan the messages and scanning the messages. In such embodiments the order is based at least in part on a priority level of a number of priority levels assigned to each message of the messages and the messages are scanned using the scan order.

In still other embodiments the embodiments further include scheduling the scanning to occur at a specified time where the event is the occurrence of the specified time for the scheduled scan. Such embodiments can include scheduling a number of scheduled scans where the scheduled scans includes the scanning and performing certain scheduled scans of the scheduled scans according to a priority level of each of the certain scheduled scans. Such embodiments can further include the scheduling the scheduled scans including scheduling each scheduled scan of the scheduled scans to occur at one of a number of specified times and assigning a priority level to the each scheduled scan of the scheduled scan. The each of the certain scheduled scans are scheduled to be performed at a scheduled time of the scheduled times.

In other embodiments still the embodiments further include receiving a new malware definition where the event is the receiving of the new malware definition. Such embodiments can also include receiving the message where the event is the receiving of the message. Certain embodiments include assigning a priority level of a number of priority levels to each message of a number of messages where the priority level is based at least in part on a reputation of a message destination of the each message of the messages and scanning the messages where the scanning uses a malware definition the scanning scans the messages in a scan order and the scan order is based on a priority level of the each message of the messages.

In other embodiments still the embodiments further include assigning a priority level of the priority levels to each message destination of a number of message destinations where the message destinations include the message destination of the each message of the messages and the assigning the priority level of the priority levels to the each message destination of the message destinations results in the assigning the priority level of the priority levels to the each message of the messages. In certain ones of such embodiments the assigning the priority levels to the message destinations includes determining one or more criteria by which to prioritize the message destinations evaluating each of the message destinations using the one or more criteria and assigning the each of the message destinations a message destination reputation of a number of message destination reputations. In such embodiments the message destination reputations include the reputation and the assigning is based at least in part on the evaluating.

The foregoing is a summary and thus contains by necessity simplifications generalizations and omissions of detail consequently those skilled in the art will appreciate that the summary is illustrative only and is not intended to be in any way limiting. Other aspects inventive features and advantages of various embodiments as defined solely by the claims will become apparent in the non limiting detailed description set forth below.

In systems in which real time scanning scanning of messages upon their being accessed is not supported or has failed there is a vulnerability window in which a user may access messages that have yet to be scanned using the latest malware definition and hence have the potential to result in the infection of the user s computing system and or those of other users. Embodiments of the systems described herein protect users computing systems in such situations by addressing such deficiencies.

Embodiments of the present method and apparatus provide for the protection of messages in a messaging system e.g. emails providing a level of protection comparable to that provided by real time scanning of messages in which messages are scanned upon being retrieved also referred to as being accessed or read by a user . Further systems such as those described herein address the need for efficiently scanning messages e.g. emails in an email system by providing for the identification and scanning of high risk messages message destinations prior to the scanning of lower risk messages message destinations. Such techniques can be used to improve the protection provided by the manual scanning of messages and the automated scanning of messages as well using an historical based risk assessment approach for example. Further still an estimation of the risk to which one or more message destinations might be exposed can be determined by analyzing the messaging communications that occur between such message destinations using graph based clustering techniques.

The aforementioned techniques can be employed to good effect in email systems for example. More specifically certain email systems lack support for real time scanning or may in certain situations suffer failures which render such support unavailable such that a message stored in a message store is not scanned upon retrieval from the message store by a recipient to whom the message is addressed as would otherwise be the case were real time scanning of messages supported . To address such scenarios scanning can be provided via for example an existing interface to a messaging system e.g. an Application Programming Interfaces API configured to allow access to stored messages a newly constructed API or some other comparable mechanism. Such access once configured can be accessed by modules e.g. what are referred to herein as plug ins designed to provide the requisite functionality. Using an approach according to embodiments described herein such modules can be used as a plug in into an email system s mail store in order to provide scanning prior to a user accessing a given piece of email. Such an arrangement minimizes vulnerability to malware attacks in which a message containing malware might be accessed by a user prior to the message having been scanned using the latest malware definition.

With regard to the scanning of messages whether during the aforementioned vulnerability window or otherwise it will be appreciated that message scanning e.g. the manual scanning of emails in email systems is presently a slow affair particularly when performed in a serial fashion as is typically the case in manual scanning . This approach is both inefficient and potentially less effective in protecting a given user. There is thus a need for improved scanning of email mailboxes that provides improved efficiency and greater effectiveness when performing such scanning such that the risk to a given user is reduced. One way of addressing such needs is to performs scans of high risk mailboxes prior to mailboxes which have shown a generally lower risk of infection e.g. based on a determination as to whether the mailbox in question was subject to attacks in the past . Further manual scans currently take a long time to complete. In addressing the aforementioned challenges a system according to one embodiment addresses the obstacles caused by such long completion times by giving higher priority to the scanning of mailboxes determined to be at a higher risk of infection.

Embodiments of the systems described herein provide a method and apparatus that offer continuous protection of messaging systems and address the risks associated with the aforementioned vulnerability window as well as allow a system according to such embodiments to address certain other of the existing needs by focusing malware scanning on higher priority message destinations. In an email system according to embodiments of the systems described herein a scheduled scanning operation is performed on a mail store which is triggered based on a malware definition being updated. This scanning operation scans the messages that have been delivered into the mailbox during a preceding period of time e.g. in the past 24 hours though this time window is configurable by the user as per the requirements of the situation at hand . As a result emails already delivered and so already stored in the mail store are scanned using the latest malware definitions. In certain embodiments this scanning of emails is performed before the user accesses those emails by way of preventing access thereto until a specified point in time. This scanning operation is preferably though not necessarily made available with the given email product in question and can be enabled disabled by the end user. In certain embodiments emails that have already been scanned using the latest definitions are skipped in order to enhance efficiency. For example newer emails delivered after the receipt of new malware definition information and thus while the scheduled scan is being performed can be skipped as such emails will be presumed to have already been scanned with the latest definitions during transport.

Further certain embodiments of the systems described herein identify the reputation of one or more message destinations e.g. mailboxes in order to enhance the performance of scanning operations by providing information that allows the scanning of mailboxes to be prioritized. In one embodiment such a system provides for the generation of reputation statistics over time. Such reputation statistics can be calculated for example based on characteristics such as the following 

Using the values observed for such characteristics a given mailbox can be scored and its reputation calculated. Once such a reputation is calculated for the mailboxes in questions such information can then be used to prioritize the scanning of those mailboxes e.g. for use in manual scanning 

At this juncture it should be noted that the discussions of malicious software in certain quarters use the term malware in a narrow sense as relating to software having particular characteristics for example in terms of propagation the possibly of multiplication and the effects thereof in a manner distinct from other forms of malicious software such as a virus Trojan horse worm and other such malicious software. However in the present specification including the appended claims the term malware is used in a generic sense to refer generally to any software which by malice or accident causes or might cause undesired effects.

Message transport system architecture also provides for communication via intranet WAN using one or more other devices. Such devices can include for example a general packet radio service GPRS client e.g. a smart phone or comparable mobile device a secure web client depicted in as a secure hypertext transfer protocol HTTPS client and a cellular phone using standard texting protocols depicted in as a simple messaging service SMS client . HTTPS client can be for example a laptop computer using the HTTP Secure HTTPS protocol. Support for GPRS clients SMS clients HTTP clients and the like thereby provide users with messaging functionality according to one embodiment in a mobile environment. As is also depicted in SMS client can communicate via internet WAN via several channels. SMS client can communicate directly for example with an SMS gateway which in turn communicates with internet WAN via a messaging gateway and optionally elements within intranet for example. Alternatively SMS client can via SMS gateway communicate with intranet and so internet WAN via public messaging services to which SMS gateway and intranet are connected.

As is also depicted in a client is also able to communicate via internet WAN by way of public messaging services and intranet . In order to support such communications as well as other communications according to one embodiment intranet includes a server system as well as providing for a number of clients now shown in the manner of intranet . Server system includes a number of elements that allow server system to support messaging communications according to one embodiment. Among these elements are a web server implemented in hardware and or software hardware and or software configured to facilitate the sending and receiving of messages represented in by a messaging server hardware and or software configured to provide message storage represented in by a message store and hardware and or software configured to provide message scanning functionality represented in by a scanning module among other possible such servers and modules in communication with one another e.g. directly via various application programming interfaces APIs and or other such interfaces and or other such mechanisms and or constructs . Various configurations of the elements of server system are discussed in greater detail for example in connection with . It will also be appreciated that in light of the present disclosure message store can be implemented using any manner of computer readable storage medium as described subsequently herein.

It will be appreciated that in light of the present disclosure the variable identifier N is used in several instances in various of the figures herein to more simply designate the final element of a series of related or similar elements e.g. intranets N clients N and web servers N . The repeated use of such variable identifiers is not meant to imply a correlation between the sizes of such series of elements. The use of variable identifiers of this sort in no way is intended to and does not require that each series of elements have the same number of elements as another series delimited by the same variable identifier. Rather in each instance of use variables thus identified may represent the same or a different value than other instances of the same variable identifier.

In this example location represents the location of the sender of one or more messages e.g. an email sender and location represents the recipient of such message s e.g. the location of an email recipient . Scanning module generically represents an implementation of scanning module of in an email environment and can be implemented in software e.g. an application plug in applet object routine subroutine function program library or the like and or hardware e.g. a general purpose processor a field programmable gate array FPGA a gate array a custom integrated circuit or other such hardware . Personnel and computing devices at the sender s location location provide information to one or more recipients at location . It is noted that the relationship between locations as well as the number of locations and the connections between and within locations can vary among embodiments. Typically firewalls and other security devices prevent users at location from accessing computing devices and or data attached to LAN in location . Similar security devices prevent users at location from accessing computing devices and or data in location via LAN . Accordingly access to computing devices and data tends to be restricted to a limited set of users.

In operation a message e.g. an email is composed by a sender at location using for example a mail user agent MUA such as email client . Such a message can include for example various information attachments and or requests for information any of which can be in a variety of formats e.g. text graphics and so on and will include message destination information also referred to herein as recipient information regarding the message destination s associated with one or more recipients of the message sufficient to allow the message destination s one or more destinations of the message such as recipients mailboxes to be determined. After the email is composed the sender uses email client to send the email to the local mail submission agent MSA in this case email server . In an email environment such as message transport system architecture the MUA formats the message in the proper format e.g. an email format and uses a protocol such as the Submission Protocol a profile of the Simple Mail Transfer Protocol SMTP to send the message to email server .

Since the email is addressed to the user of email client email server then sends the email to email server . To accomplish this task the MSA email server analyzes the destination address provided via the SMTP protocol in order to resolve a domain name to determine the fully qualified domain name of the appropriate mail exchange server in the Domain Name System DNS . Such mail exchange servers can include for example one or more mail transfer agents MTAs located in internetwork for example.

The MSA e.g. email server then sends the email message to the appropriate MTA which in turn forwards the email message to the next MTA if any and so on until the email message is ultimately delivered to the appropriate message delivery agent MDA in this case email server . Email server which is running on computing device receives and stores the email message delivering the email message to the recipient s mailbox .

The recipient can then using their MUA in this case email client communicate with email server in order to check for and obtain email messages from email server . Email client as the MUA of the recipient can use email protocols such as the Post Office Protocol POP or the Internet Message Access Protocol IMAP to retrieve messages from the MDA email server .

It is noted that in some embodiments scanning module need not be running when email messages are received by email server though typically such will be the case. Further there will typically be a delay between the time at which email server receives an email and the time at which a recipient accesses that email using email interface though such need not be the case. As discussed elsewhere herein embodiments of the systems described herein comprehend scanning module scanning email messages stored at email server prior to their retrieval by the intended recipient s in the case in which such email messages have not yet been scanned using a given malware definition e.g. the latest malware definition promulgated by a source of such malware definitions . As will be apparent in light of the present disclosure and as discussed in the examples that follow such scanning can be performed based on certain events e.g. at regular intervals upon receipt of the email message s upon receipt of new malware definitions based on user defined criteria and the like at advantageous times and or the like. Alternatively or in combination therewith recipients can be prevented from retrieving email messages that have yet to be scanned either strictly or based on one or more appropriate criteria e.g. the priority of the email message the recipient s position analysis of one or more of the email messages and or other such criteria . Such restrictions can also be overridden in certain circumstances as may be deemed appropriate and advisable by persons such as system administrators executives officials and or other persons of comparable position.

Messaging storage systems and messaging system server are communicatively coupled to one another and thus support communications necessary to provide for the transport and storage of messages. Communications between messaging storage systems and messaging system servers can be and often will be effected in a number of ways. Such communications can include for example an authentication authorization accounting AAA protocol connection which supports communication between authentication server and authentication store . In at least certain scenarios authentication server accesses authentication store to validate login information for a given messaging system user such that access to and use of the requisite systems and information maintained therein can be managed and controlled.

Communications between storage systems and messaging system servers can also include for example a lightweight directory access protocol LDAP connection and the use of a Message Submission Agent MSA Application Programming Interface API MSAAPI . As depicted LDAP connection supports communications between directory server and directory store and supports access to and the maintenance of messages in message store . In comparable fashion MSAAPI provides for communications between various components of messaging system architecture and message store including access to and from message store by inbound server and outbound server of message transport agent .

Also communicatively coupled to messaging system is an internal network which can include for example a number of client systems depicted in as client systems N . Client systems N of internal network and messaging system servers communicate with one another via for example a messaging connector . The access to messaging servers provided to client systems N by messaging connector supports functionality needed for messaging therebetween as well as with external users.

Messaging system servers in addition to other functionalities provided thereby facilitate the communications of messages between internal network an example of what is referred to herein as internal communications as well as other messaging system end users via for example an internetwork e.g. the Internet an example of what is referred to herein as external communications . In facilitating the transport and storage of messages in this fashion messaging system architecture supports security measures such that the transport and storage of the aforementioned messages does not result in unwanted and or untoward effects for users e.g. virus infections spamming unintended delivery of malware and the like .

The protection of users and systems when communicating by way of messages can be effected through the use for example of a scan module depicted in as a scan module . Scan module includes mechanisms such as a scanning engine and interfaces with messaging system servers . Scan module also interfaces with messaging storage systems . Scan module can interface with messaging storage systems by way of one of several methods. For example scan module can interface with messaging storage systems via messaging submission agent API . However in the case in which no message submission agent API is provided or message submission agent API is damaged for some reason scan module can interface with messaging storage systems via a storage system scanning interface which can be constructed such that more direct access to directory store and message store is provided for example.

Email system also includes a number of mail system servers which are depicted in the aggregate as mail system servers comparable in certain respects to certain elements of messaging system servers of . Mail system servers include a directory server and mail access servers . As alluded to in the discussion of mail access servers can include for example a Post Office Protocol POP server an Internet Message Access Protocol IMAP server and a Hyper Text Transfer Protocol HTTP server . Mail system servers can also include for example a mail transfer agent . Mail transfer agent can include servers such as a Simple Mail Transfer Protocol SMTP inbound server and an SMTP outbound server .

As depicted in email system also includes a scanning module comparable in certain respects to certain elements of scanning module of . In turn scanning module includes for example a scanning control module and a scanning engine . Scanning module interfaces with other elements of email system via one or more interfaces I F such as a storage interface configured to interface with the elements of mail host and a server interface configured to interface with the servers within mail system servers . To this end server interface interfaces with a mail system server MSS scanning module interface SMI .

In a similar fashion storage interface is communicatively coupled to and facilitate communications between scanning module and the various storage elements of mail host via a storage system scanning interface module . Storage system scanning interface module comparable in certain respects to certain elements of storage system scanning interface of includes a scanning module interface in counterpart to an in communication with storage interface of scanning module . Storage system scanning interface module also includes a message store interface and a content store interface . As is depicted in message store interface supports communications with message store . Similarly content store interface supports communication with content store . In this manner scanning module is able to communication with message store and content store of mail store via storage system scanning interface module .

Once the message is received at the intended messaging system e.g. messaging system the message is scanned e.g. by a scan module such as scan module during the process of storing the message e.g. in a message store such as Message Store step . In systems that support the scanning of messages upon their being accessed by their intended recipients a scan module such as scan module scans the messages as they are transferred to their intended recipient s via for example a mechanism such as message submission agent API . However in cases in which such a message submission agent API fails at least with regard to the scanning of messages there is no access to such functionality or as depicted in no such functionality is provided by the messaging system architecture used an alternative is needed that prevents messages from being delivered to their intended recipient s without having been scanned using the latest definition information.

In such scenarios embodiments of the systems described herein provide for the scanning of messages stored in a message store e.g. before and or during such messages storage in a message store and or while such messages are stored in elements such as message store message store content store or other such storage mechanisms . Thus the process depicted in provides for scanning the message s while such message s is are stored in such a message store step . Such operations can be accomplished in a number of ways. For example a scanning module can read the message s in question from a storage system via a storage system scanning interface and perform scanning on the message s thus read in order to identify infected messages. Alternatively the scanning module could read the message s in question from a storage system via a storage system scanning interface perform scanning on the message s thus read cleaning any messages found to be infected optionally and writing the now scanned and optionally cleaned message s back into the storage system. As will be appreciated such transformations are intended to come within the scope of this detailed description as well as the claims appended hereto.

The process of begins with a determination as to whether new definition information has been received step . It will be appreciated in light of the present disclosure that such an operation can also be performed in response to the receipt of one or more messages in the alternative or in combination therewith . If new definition information has been received step the new definition information is stored for example by a scanning module under the control of a scanning control module such as scanning module and scanning control module of step . As will be appreciated in light of the present disclosure this new malware definition information and definition information in general can be stored within scanning module and or one of its sub elements or in a storage system accessible by a scanning module for example. Once the new definition information has been stored step the process of indicates that the scanning of messages should proceed step .

If new definition information has not been received at that point in time step a determination is made as to whether a given time period has expired e.g. that a scheduled scan should be performed step . If the given time period has expired step a determination is made e.g. by the scanning control module of the scanning module as to whether new definition information is available locally step . Such locally available definition information can for example be cached information and thus is stored locally as opposed to having just been received steps and . If the requisite definition information is available locally step there is no need to perform any storage operations as the new definition information is already stored locally and so the process proceeds to indicate that the in store scanning of messages should proceed step .

Alternatively if new definition information is not available locally step a server to which the scanning module has access and which is configured to maintain definition information is queried as to the availability of new definition information therefrom step . If new definition information is available from such a source step the scanning module obtains this new definition information from the appropriate server step and stores the definition information thus obtained locally step . Alternatively if new definition information is not available locally step and is also not available from a server step the process indicates that the in store scanning of messages is not warranted at this time step .

If new definition information has not been received e.g. by the scanning module nor is available either locally or remotely other criteria for initiating the in store scan of messages can be evaluated step . If such criteria indicate that an in store scan should be initiated step the process indicates that in store scanning of messages should proceed step . However if such criteria indicate that an in store scan of messages is not warranted at this time step an indication is provided that indicates a scanning of in store messages is not warranted at this time step . Once the aforementioned indications have been provided in an appropriate manner the process then concludes.

It should also be appreciated that the events described in connection with the process of that result in scanning being performed can be configured to include the scanning of messages upon their receipt. For example the process of can be designed such that the receipt of a message during the process of scanning messages in a message store also results in the scanning of such late received messages. In this regard such scanning can take into account various criteria as a way of deciding whether or not to include a given message in the scanning operations being performed e.g. message priority recipient s time until next scheduled mail store scan and or the like . Alternatively or additionally such messages can be scanned upon their receipt regardless of whether scanning operations are being performed on messages already stored in the given mail store. For example if a message is received subsequent to the receipt of a new malware definition but prior to the scanning of existing messages stored in the mail store the newly received message can be scanned notwithstanding either before or after being stored in the mail store . These foregoing variations and other such alternatives are intended to be and are comprehended by the present disclosure.

As noted the order in which messages are scanned can be important because for example the time required to scan the messages needing to be scanned e.g. creating a lag of 2 4 hours for example can create the aforementioned vulnerability window while the scanning is in progress. This can lead to a situation in which a recipient accesses one or more messages scanned only with an older malware definition thus potentially and inadvertently accessing a message containing malware . One approach using the concepts presented herein is to prioritize messages message destinations such that the messages message destinations are scanned in an order referred to herein as a scan order that results in more vulnerable messages e.g. email messages message destinations e.g. mailboxes being scanned before less vulnerable messages message destinations.

The following list provides examples of ways in which vulnerable message destinations can be identified 

Reputation A message destination reputation can be computed based policy violations associated with the message destination over some period of time. A message destination e.g. mailbox with more violations and infections is assigned a lower reputation indicating that the message destination is more vulnerable to such violations .

Reputation Cluster A graph or similar construct can be created to represent the communication pattern of low reputation message destinations. A node in the graph thus represents a given message destination. Similarly an edge can represent how often the one user represented by a first node communicates with another represented by a second node . In one such embodiment the edge s length is inversely proportional to the frequency of communications between these users. The more the users communicate the closer the nodes representing the users become. Using this graph users can be clustered with one another on the basis of their communication pattern. Users with a higher frequency of cross communication will end up in the same cluster. Message destinations in clusters of low reputation message destinations can be scanned first. This computation can be performed in conjunction simultaneously with message flow minimizing the overhead required during such message destination scanning.

Vulnerable Recipients If a violation is found in a message then other recipients e.g. other email addresses in the to cc and bcc fields of an email and sender of the message can be considered as vulnerable and the scanning of their message destinations given higher scanning priority.

Manual Prioritization a person such as an administrator can also manually configure critical message destinations e.g. mailboxes of users groups that need 24 7 access thereto and thus need to be given higher scanning priority .

The following passages provide further details regarding the techniques listed above and the parameters established thereby.

With regard to message destination reputation the number of policy violations experienced by a given user s message destination indicate the reputation of that message destination. In certain embodiments both inbound and outbound message traffic can be taken into account in this regard. In such a scenario inbound message traffic resulting in violations of whatever type s indicates that the user is receiving the malicious messages in at least some respect. Conversely outbound message traffic indicates that the user is sending messages that are malicious. The use of message destination reputation allows message destinations that are more likely to receive and thus send malicious messages to be identified.

Some of the characteristics that can be used to account for a low reputation are listed below. Such characteristics are typically monitored over some period of time in order to arrive at a reputation value 

Other parameters can be included in such analyses as required. Further the use of such characteristics can be made configurable. Further still the threshold for each parameter as to what constitutes a violation can be configured e.g. anything 0 . In addition the above parameters can be assigned different weights based on the enterprise use cases and which parameters are deemed of greater or less importance.

With regard to message destination reputation a weighted cluster of mailboxes is created to identify the email communication pattern of message destinations. This allows for the identification of message destinations that are sending or receiving messages from low reputation message destinations and are thus more likely to become infected. As noted each node in the graph represents a given message destination while the edges therebetween represent the communications between the nodes thus coupled. In certain embodiments the weight of each edge indicates the frequency of communications between the nodes thus coupled. Thus the more communications occur between two nodes the greater the weight of the edge between the nodes becomes. Such a graph allows for the identification of clusters of users with relatively high frequency of communications therebetween. Users with a higher frequency of cross communication will therefore typically be included in the same cluster. The message destinations in a given cluster are assigned a scanning priority based on the reputation of the cluster. In the manner noted previously such computations can be performed along with the message flow thus minimizing overhead during the scanning of message destinations.

With regard to vulnerable recipients if a violation is detected in a message then in additional to the primary recipient of the message e.g. the first or only recipient listed in the to field of an email other recipients of the message which can be identified e.g. by determining any other email addresses in the to cc and bcc fields of the email as well as the sender of the message e.g. as listed in the from field of the email can be considered as vulnerable and the affected message destination s given higher priority for scanning.

Moreover the scanning of message destinations can take into account the likelihood of a given message destination being accessed during the aforementioned vulnerability window by any number of mechanisms. For example in global organizations the prioritization of message destinations in this regard can place higher priority on message destinations of users who might be expected to be at work during that period of time e.g. if a user s work hours overlap the vulnerability window that user s mailbox can be scanned before those of users who are not at work during that time . Similarly the message destinations of users who require access to their messages around the clock may also be given higher priority. Further still other techniques such as statistical methods historical analyses and the like can also be used to good effect in prioritizing message destinations for scanning according to embodiments of the systems described herein. Ultimately in this regard it is the question of the likelihood of a given message being accessed by a given recipient that informs the order of message scanning that is to be performed. It will be appreciated that in light of the present disclosure the aforementioned techniques as well as those that will be apparent in light thereof can also be combined advantageously e.g. scanning the message destinations of low reputation message destinations for users who are at work during the scanning process .

Embodiments of the systems described herein also provide mechanisms for improving the efficiency of message scanning such that the scanning of messages is performed in a manner that is expected to result in a message destination having a relatively higher likelihood of infection being scanned before those having a relatively lower likelihood of infection. That being the case one example of the order in which messages destinations might be scanned taking into account the vulnerability of the given message destinations their likelihood of infection being accessed and so on follows 

The process of begins with a determination as to the criteria to be used in prioritizing the one or more identified messages for scanning step . Once the requisite criteria and or prioritization algorithms have been selected or otherwise determined step one or more messages are selected based on the aforementioned criteria step . The selected message s is are then prioritized by assigning the selected message s the appropriate priority level s step . It will be appreciated that in light of the present disclosure the operations performed in the process of can for example select messages to be assigned a given priority level and assign that priority level to them or evaluate messages on an individual basis and assign each an appropriate priority level based on such evaluation. As will also be appreciated in this regard message destinations can also be assigned priority levels in a comparable fashion which as will be apparent results in any messages in the message destinations thus prioritized being themselves being assigned the given priority level . As noted above such selection evaluation can be based on a number of criteria with the determination of such criteria being performed either separately or in combination. Further such techniques can also include the clustering techniques described in connection with . A determination is then made as to whether any messages remain to be prioritized step . If further messages remain to be prioritized step the process loops back to the selection of additional messages based on the aforementioned criteria step and the process repeats. Otherwise an indication is provided that indicates that the identified messages have been prioritized step .

Typically when a scan is begun message destinations e.g. mailboxes are scanned serially. In some scenarios such serial scanning can take hours to complete and in so doing leave a bigger window in which malware can act e.g. via access by an unsuspecting user before being detected. The performance of and thus protection afforded by such scanning can be improved by prioritizing the scanning of mailboxes through the use of message destination reputation also referred to herein as trust level . To determine the reputation of a given message destination a number of factors can be considered including but not limited to past history of violations the number and source s of emails received from outside domains and the like.

In general terms the reputation of each mailbox can be determined e.g. calculated for example by summing up the mailbox various rankings. As will be appreciated in light of the present description other approaches to such a determination can be used and are intended to be comprehended by the present disclosure. In any event each time a violation is detected the database entries for that particular recipient is updated. The received mails columns is cleared periodically e.g. after each full manual scan . This is done so that for the next scan new entries are made. The ranking for each kind of violation can be modified by the user though it will be appreciated that for some organizations content filtering CF operations may be more critical than antivirus AV protection making CF operations more critical than that AV operations or other such operations.

Several kinds of scans can use the aforementioned processes. For example using these processes two kinds of manual scans among others are possible 

Thus in determining a reputation of a message destination e.g. mailbox a determination is made as to whether the evaluation criteria to be used in evaluating the given message destination step . Once the evaluation criteria have been identified e.g. selected by a system administrator identified through the use of artificial intelligence techniques and or other such approaches the process of determining message destination s reputation is begun. Thus message destinations are identified and evaluated by first identifying a given message destination to evaluate step . In evaluating the message destination thus identified using the aforementioned evaluation criteria step . A determination is then made as to whether further message destinations remain to be evaluated step . If additional message destinations are to be evaluated step the process loops to the identification of the next message destination to be evaluated step and evaluates that message destination step in an iterative fashion. Otherwise an indication is provided as to the identified messages having been prioritized step . The process then concludes.

As will be appreciated mailbox name fields N are designed to store information regarding the name s or other identifier s of the mailbox with which the given entry is associated. In certain embodiments AV violations field N maintain a count of the number of antivirus violations e.g. malware identified that have occurred with regard to the given mailbox. Similarly CF violations fields N maintain information regarding the number s and or severity as well as other information regarding content filtering violations that have occurred with respect to the given mailbox. As will be appreciated in light of the present disclosure the antivirus and content filtering violations that occurred their severity and other information regarding such violations can all be used to determine the information stored in the field in question as well as other such information being maintained in additional fields not shown as being part of reputation database . In a similar fashion external email count fields N and internal email count fields N are used to maintain information e.g. counts of emails sent to and or received from external destinations e.g. those outside the recipient s local area network and internal destinations e.g. those within the recipient s local area network respectively. The foregoing information can all be used or portions thereof as well as other information either stored in reputation database or obtained from other sources to arrive at a reputation ranking for the given message destination e.g. the given mailbox . Such reputation information can then be maintained in reputation database using reputation fields N .

The process of begins with a determination as to whether an event of interest has been detected step . While no such events have occurred step the process loops awaiting such individuality. Once an event of interest has been detected step the mailbox associated with event is identified step . Such operations can be performed for example by functionality based in the scanning control module of a scanning module within the male host itself or by some other mechanism. Once the mailbox has been identified step a determination is made as to the type of event which has occurred step . Based on the event and or type of event that has occurred step the reputation database is updated step . Information regarding the given mailbox having been thus updated step a new reputation value can be calculated using event information stored in the reputation database including the new information just added step . In certain embodiments an administrator or other use can adjust a given mailbox s reputation value either before or after that reputation value has been calculated based on the updated reputation information. Thus inquiry is made in the process of as to whether the reputation value calculated should be adjusted step . If the calculated reputation value is to be adjusted step the calculated reputation value is adjusted as needed step . Such adjustments can be made for example in the case in which filtering is to be performed on the frequency of such events maxima and or minima are to be employed and or other such processing is to be performed on the information stored in the reputation database. If the calculated reputation value need not be adjusted step or such adjustments have been made step the newly calculated reputation value is stored in the reputation field of the mailbox entry in the reputation database step . The process then returns to awaiting the occurrence of the next event step .

The process depicted in provides for the creation and maintenance of cluster information regarding the reputation of message destinations in a messaging system. The process of begins with the creation of a reputation graph step . An example of such a graph and its description are provided in connection with . Once a reputation graph is created for the mailboxes in question step a determination is made as to whether an event of interest has been detected step . While no such events have been detected step the process loops waiting for the occurrence of such an event. Upon the detection of an event of interest step information associated with the affected node s and edge s in the reputation graph are updated step .

Using a threshold value for creating a reputation cluster of the numerical value 5 the relatedness between any two reputation nodes can be determined by whether the specific one of reputation graph edges therebetween has associated therewith a value of 5 or less or a value of more than five. In the example presented in it can be seen that certain reputation graph edges RGE RGE RGE RGE RGE carry respective values of 9 5 10 6 and 12 respectively and are self referential to their respective reputation nodes. Further these reputation graph edges each have values that are all greater than 5. Inter node reputation graph edges run between reputation nodes and have the values indicated in Table 1. It can also be seen that certain reputation graph edges RGE RGE RGE RGE and RGE carry respective values of 4 2 2 1 and 2 respectively. Further these reputation graph edges each have values that are all less than 5. Thus a reputation cluster depicted in as a reputation cluster can be formed therefrom and thus include these reputation nodes. Based on this and other information reputation cluster can be assigned an appropriate priority. This reputation cluster priority can be used to determine the priority of the reputation nodes for scanning. Further even if a reputation cluster has been assigned a given priority the individual reputations of the message destinations within the reputation cluster can be assigned their own priority within the reputation cluster.

In a manner similar to that of the creation of a reputation cluster described above each message destination of as represented by reputation nodes reflects an overall reputation for the given message destination. The reputation for each message destination is depicted in as a numerical value in brackets. Further to this end the information presented below in Table 2 reflects these values for each of reputation nodes and so informs the topology thereof and the operations with respect to clustering performed.

It will be appreciated that in light of the present disclosure the reputation of a given reputation node message destination can be considered in determining the overall reputation of the reputation cluster to which the reputation node and so message destination belongs. Thus once a reputation cluster has been defined the reputations of the reputation nodes message destinations therein can be used to determine an overall reputation for the given reputation cluster. Further in the creation of a reputation cluster such reputation information can be considered in the operations that aggregate reputation nodes into reputation clusters.

For example reputation nodes having a reputation at or below a certain threshold can be clustered together based simply on the existence of an edge therebetween regardless of the degree to which the reputation nodes are related to one another as indicated by the value assigned to the reputation graph edge value therebetween although such degree of relatedness can be used in conjunction therewith. In the example depicted in this might result in reputation nodes and being in the same cluster in the manner shown with an overall cluster reputation calculated by averaging each reputation node s reputation value resulting in a cluster reputation of 3 . As will be apparent in light of the present disclosure a cluster reputation value can be calculated in any number of ways. Alternatively e.g. with a reputation threshold of 3 only reputation nodes and would be in the same cluster or could form a sub cluster of reputation cluster . As will be appreciated in the posited example using an average of the reputation nodes reputation values the cluster reputation value or sub cluster reputation value would be 2.5. Further still the aforementioned techniques are examples of the more general concept of identifying interactions that a given set of message destinations may have with a given low reputation message destination as represented by their respective reputation nodes. A cluster can be defined as including the k nearest reputation nodes message destinations .

Thus the more recently and or frequently a given reputation node message destination receives messages from the low reputation reputation node message destination the closer the given reputation node message destination is deemed to be to the low reputation reputation node message destination . Once such relationships are determined a cluster is defined by the closeness between two reputation nodes required to constitute reputation nodes being in the same cluster. As will be apparent in light of the present disclosure then the clustering of reputation nodes and determination of cluster reputation values can be determined in a number of ways.

As shown above the systems described herein can be implemented using a variety of computer systems and networks. Examples of such computing and network environments are described below with reference to .

Bus allows data communication between central processor and system memory which may include read only memory ROM or flash memory neither shown and random access memory RAM not shown as previously noted. RAM is generally the main memory into which the operating system and application programs are loaded. The ROM or flash memory can contain among other code the Basic Input Output System BIOS which controls basic hardware operation such as the interaction with peripheral components. Applications resident with computer system are generally stored on and accessed from a computer readable storage medium such as a hard disk drive e.g. fixed disk an optical drive e.g. optical drive a floppy disk unit or other computer readable storage medium.

Storage interface as with the other storage interfaces of computer system can connect to a standard computer readable medium for storage and or retrieval of information such as a fixed disk drive . Fixed disk drive may be a part of computer system or may be separate and accessed through other interface systems. Modem may provide a direct connection to a remote server via a telephone link or to the Internet via an internet service provider ISP . Network interface may provide a direct connection to a remote server via a direct network link to the Internet via a POP point of presence . Network interface may provide such connection using wireless techniques including digital cellular telephone connection Cellular Digital Packet Data CDPD connection digital satellite data connection or the like.

Many other devices or subsystems not shown may be connected in a similar manner e.g. document scanners digital cameras and so on . Conversely all of the devices shown in need not be present to practice the systems described herein. The devices and subsystems can be interconnected in different ways from that shown in . The operation of a computer system such as that shown in is readily known in the art and is not discussed in detail in this application. Code to implement the modules of the systems described herein can be stored in computer readable storage media such as one or more of system memory fixed disk optical disk or floppy disk . The operating system provided on computer system may be MS DOS MS WINDOWS UNIX Linux or other operating system.

Moreover regarding the signals described herein those skilled in the art will recognize that a signal can be directly transmitted from a first block to a second block or a signal can be modified e.g. amplified attenuated delayed latched buffered inverted filtered or otherwise modified between the blocks. Although the signals of the above described embodiment are characterized as transmitted from one block to the next other embodiments may include modified signals in place of such directly transmitted signals as long as the informational and or functional aspect of the signal is transmitted between blocks. To some extent a signal input at a second block can be conceptualized as a second signal derived from a first signal output from a first block due to physical limitations of the circuitry involved e.g. there will inevitably be some attenuation and delay . Therefore as used herein a second signal derived from a first signal includes the first signal or any modifications to the first signal whether due to circuit limitations or due to passage through other circuit elements which do not change the informational and or final functional aspect of the first signal.

With reference to computer system modem network interface or some other method can be used to provide connectivity from each of client computer systems and to network . Client systems and are able to access information on storage server A or B using for example a web browser or other client software not shown . Such a client allows client systems and to access data hosted by storage server A or B or one of storage devices A N B N N or intelligent storage array . depicts the use of a network such as the Internet for exchanging data but the systems described herein are not limited to the Internet or any particular network based environment.

The systems described herein are well adapted to attain the advantages mentioned as well as others inherent therein. While such systems have been depicted described and are defined by reference to particular descriptions such references do not imply a limitation on the claims and no such limitation is to be inferred. The systems described herein are capable of considerable modification alteration and equivalents in form and function as will occur to those ordinarily skilled in the pertinent arts in considering the present disclosure. The depicted and described embodiments are examples only and are in no way exhaustive of the scope of the claims.

The foregoing describes embodiments including components contained within other components e.g. the various elements shown as components of computer system . Such architectures are merely examples and in fact many other architectures can be implemented which achieve the same functionality. In an abstract but still definite sense any arrangement of components to achieve the same functionality is effectively associated such that the desired functionality is achieved. Hence any two components herein combined to achieve a particular functionality can be seen as associated with each other such that the desired functionality is achieved irrespective of architectures or intermediate components. Likewise any two components so associated can also be viewed as being operably connected or operably coupled to each other to achieve the desired functionality.

The foregoing detailed description has set forth various embodiments of the systems described herein via the use of block diagrams flowcharts and examples. It will be understood by those within the art that each block diagram component flowchart step operation and or component illustrated by the use of examples can be implemented individually and or collectively by a wide range of hardware software firmware or any combination thereof.

The systems described herein have been described in the context of fully functional computer systems however those skilled in the art will appreciate that the systems described herein are capable of being distributed as a program product in a variety of forms and that the systems described herein apply equally regardless of the particular type of computer readable media used to actually carry out the distribution. Examples of computer readable media include computer readable storage media as well as media storage and distribution systems developed in the future.

The above discussed embodiments can be implemented by software modules that perform one or more tasks associated with the embodiments. The software modules discussed herein may include script batch or other executable files. The software modules may be stored on a machine readable or computer readable storage media such as magnetic floppy disks hard disks semiconductor memory e.g. RAM ROM and flash type media optical discs e.g. CD ROMs CD Rs and DVDs or other types of memory modules. A storage device used for storing firmware or hardware modules in accordance with an embodiment can also include a semiconductor based memory which may be permanently removably or remotely coupled to a microprocessor memory system. Thus the modules can be stored within a computer system memory to configure the computer system to perform the functions of the module. Other new and various types of computer readable storage media may be used to store the modules discussed herein.

The above description is intended to be illustrative and should not be taken to be limiting. As will be appreciated in light of the present disclosure other embodiments are possible. Those skilled in the art will readily implement the steps necessary to provide the structures and the methods disclosed herein and will understand that the process parameters and sequence of steps are given by way of example only and can be varied to achieve the desired structure as well as modifications that are within the scope of the claims. Variations and modifications of the embodiments disclosed herein can be made based on the description set forth herein without departing from the scope of the claims giving full cognizance to equivalents thereto in all respects.

Although the systems described herein have been described in connection with several embodiments these embodiments and their descriptions are not intended to be limited to the specific forms set forth herein. On the contrary it is intended that such embodiments address such alternatives modifications and equivalents as can be reasonably included within the scope of the appended claims.

