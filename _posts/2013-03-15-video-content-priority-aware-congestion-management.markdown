---

title: Video content priority aware congestion management
abstract: In one embodiment, a method includes assigning at a server, priority levels to channels associated with video broadcast content, transmitting the assigned priority levels to a network device transmitting the video broadcast content to receivers, and updating the assigned priority levels based on channel information received at the server. A policy is applied to the video broadcast content based on the assigned priority levels when network congestion occurs. An apparatus is also disclosed herein.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09154819&OS=09154819&RS=09154819
owner: Cisco Technology, Inc.
number: 09154819
owner_city: San Jose
owner_country: US
publication_date: 20130315
---
The present disclosure relates generally to communication networks and more particularly to congestion management for video services.

In order to attract subscribers providers of video services over IP Internet Protocol networks need to meet or exceed the video experience provided by existing services. The visual quality experience provided by IP networks may be impacted by many factors including packet loss due to network congestion.

Corresponding reference characters indicate corresponding parts throughout the several views of the drawings.

In one embodiment a method generally comprises assigning at a server priority levels to channels associated with video broadcast content transmitting the assigned priority levels to a network device transmitting the video broadcast content to receivers and updating the assigned priority levels based on channel information received at the server. A policy is applied to the video broadcast content based on the assigned priority levels when network congestion occurs.

In another embodiment an apparatus generally comprises a processor for assigning at a server priority levels to channels associated with video broadcast content transmitting the assigned priority levels to a network device transmitting the video broadcast content to receivers and updating the assigned priority levels based on channel information received at the server. The apparatus further includes memory for storing the assigned priority levels. A policy is applied to the video broadcast content based on the assigned priority levels when network congestion occurs.

The following description is presented to enable one of ordinary skill in the art to make and use the embodiments. Descriptions of specific embodiments and applications are provided only as examples and various modifications will be readily apparent to those skilled in the art. The general principles described herein may be applied to other applications without departing from the scope of the embodiments. Thus the embodiments are not to be limited to those shown but are to be accorded the widest scope consistent with the principles and features described herein. For purpose of clarity details relating to technical material that is known in the technical fields related to the embodiments have not been described in detail.

Network devices used to forward video traffic may forward tens or hundreds of channels based on the number of channels offered and the number of viewers interested in the channels. Popularity ranking charts which categorize channels according to the number of receivers per channel at various points in time provide power distribution for what is referred to as long tail content . These charts have shown that a relatively small set of channels typically attract the majority of viewers while the remaining channels long tail have relatively few receivers. The long tail content often consumes a large amount of bandwidth. This is because linear broadcast video is distributed in a multicast manner wherein content is sent to a region even if it has only a single viewer.

In a conventional system when the network device experiences congestion in a broadcast video class it will drop packets from the class without regard to the importance of the video contained within the packets. This may impact the majority of viewers because both important and unimportant content is affected. Since the popularity of content is dynamic a static QoS Quality of Service configuration is not sufficient.

The embodiments described herein allow a server to communicate information about the importance of video broadcast content to a network device such as an edge router or a video source so that action can be taken to preserve the quality of important content when the network experiences congestion. In one embodiment a video caching server that has knowledge of video content popularity for a specific region assigns different priority levels to the channels video streams and communicates this to a router that can drop packets based on priority if there is congestion on the network links. This allows video quality of the most important content to be preserved thereby resulting in higher customer satisfaction.

Referring now to the drawings and first to an example of a network in which embodiments described herein may be implemented is shown. The embodiments operate in the context of a data communication network including multiple network devices. The network includes a communication system comprising a media source and receivers clients in communication over a network . The network may include one or more networks e.g. local area network metropolitan area network wide area network enterprise network Internet intranet radio access network public switched network or any other network or combination of networks . The source and receivers are connected via communication links and one or more nodes. In only one node edge router is shown interposed between the source and receivers however the media flow path between the source and receivers may include any number or type of intermediate nodes e.g. routers switches gateways access nodes or other network devices which facilitate passage of data between the endpoints. The system may also include any number of sources or receivers . For simplification only two receivers are shown in however the edge router may transmit video content to any number of receivers .

The edge router is also in communication with a video caching server which may be positioned at the edge of a broadcast video delivery network for example. Although the video caching server is not in the data path itself it still has knowledge of the popularity ranking and can make the link between content channels and multicast groups based on the configuration of a channel line up. As described below the video caching server may be used to improve the quality of the video experience for viewers in a network and has knowledge of the behavior of clients with regard to channels supplied to the receivers . The source may be in communication with any number of video caching servers and each server may service one or more edge routers .

The source sends packets in a media stream to any combination of receivers via the network . In the example shown in source transmits a media stream to edge router on path . The media stream may include content such as audio video text or other data. In one embodiment Real time Transport Protocol RTP is used to carry video packets over multicast streams from the source to the receivers and RTP Control Protocol RTCP is used to transmit statistics and control information between network devices. It is to be understood that the protocols described herein are only examples and that other protocols may be used without departing from the scope of the embodiments.

The source and receiver are configured to originate or terminate communications over the network . The source and receiver may be any device or combination of devices configured for receiving transmitting or receiving and transmitting media streams. The media source may be for example a server that stores the media locally or receives the media from another server or media source via another network satellite cable or any other communication device. The receiver may be for example a personal computer set top box personal digital assistant PDA VoIP phone tablet Internet connected television cellular telephone telepresence device media center device or any other network device that receives media packets.

The network device may be any type of device configured for forwarding traffic from the source to the receivers . It is to be understood that the term transmitting as used herein may refer to transmitting video from the network device or forwarding video received at the network device. In one embodiment the network device is an edge router configured to forward video traffic for a region serviced by the video caching server . The region may be a geographical region such as a city or state or other network region. Each region is assigned one or more servers and has a population of viewers. The server may service multiple edge routers .

In one example the server is a Visual Quality of Experience VQE server operable to improve the quality of video experience for viewers in a given region of the network. The VQE server receives a multicast stream for each channel from the source via the edge router and caches for example a few seconds of the most recently received program content for each channel. The VQE server may provide various services to downstream clients such as error repair rapid channel change and statistics reporting. The server may comprise software hosted on a content delivery system appliance for example and preferably maintains per channel and per component state information.

The VQE server communicates with a VQE client e.g. software component integrated in the receiver e.g. set top box or other suitable device e.g. home access gateway . The server listens for inbound RTCP messages from downstream VQE clients. The messages may request services such as error repair or RCC rapid channel change or provide RTP receiver statistics. The server responds to the client with appropriate action. For example the VQE server may use its cached video data to service retransmission requests from the client. If an error in video transmission occurs the VQE client detects the packet loss and requests a retransmission while holding the video sequence in queue. The VQE server automatically repairs the error by transmitting the missing packet which is re sequenced by the receiver without interruption. The VQE client also notifies the VQE server of a channel change request from the viewer.

It is to be understood that the VQE server and VQE client described herein are only examples and that other types of servers or clients may be used without departing from the scope of the embodiments. Also the services provided by the server described above are only examples of services that may be provided by a video caching server .

Referring again to the server receives from the receivers channel data identifying the channels the users are viewing. This information is transmitted to the server via the edge router . As described in detail below the server uses the channel data e.g. popularity information to calculate a priority for each channel. Content priority information is stored at the server and priority data is transmitted to the edge router or source for use in preserving quality of the most important video content.

The priority information allows the edge router to make informed decisions that result in preserved QoE Quality of Experience for the important channels and a lowered QoE for non important channels. For example when the edge router experiences congestion the router can drop packets associated with low priority channels since packet losses on popular channels may result in a large population of unhappy viewers while the impact of packet loss for less popular channels may be minimal or go unnoticed. Dropping packets of less popular channels will also result in less retransmission requests from clients.

It is to be understood that the network shown in and described herein is only an example and that the embodiments may be implemented in networks having different network topologies or network devices without departing from the scope of the embodiments.

Logic may be encoded in one or more tangible media for execution by the processor . For example the processor may execute codes stored in a computer readable medium such as memory . The computer readable medium may be for example electronic e.g. RAM random access memory ROM read only memory EPROM erasable programmable read only memory magnetic optical e.g. CD DVD electromagnetic semiconductor technology or any other suitable medium.

The network interface may comprise any number of interfaces linecards ports for receiving data or transmitting data to other devices. The interface may include for example an Ethernet interface for connection to a computer or network.

It is to be understood that the network device shown in and described above is only an example and that different configurations of network devices may be used. For example the network device may further include any suitable combination of hardware software algorithms processors devices components or elements operable to facilitate the capabilities described herein.

It is to be understood that the process shown in and described above is only an example and that steps may be added or modified without departing from the scope of the embodiments.

The channel information provided to the server includes details as to what channels the viewers are watching. For example the VQE client at the receiver may transmit a channel change request to the VQE server thus providing channel information to the server. As previously discussed the server uses this channel information to calculate a priority level for each channel video content video stream .

In one embodiment each channel is assigned one of three priorities high medium or low based on the current popularity. The priority levels may use default values or may be determined by an administrator. For example if 80 of the viewer population is watching a channel the channel may be assigned a high priority. If only 5 of the viewer population is watching a channel the channel may be assigned a low priority. It is to be understood that these are only examples and that any number of priority levels or percentage of viewers for each priority level may be used.

The server may continuously monitor the popularity ranking and perform calculations to determine popularity periodically e.g. every five minutes or any other time period . The priority levels assigned to the channels may be updated based on a change in the popularity distribution. For example if a channel shifts from one priority level to another then the priority level assigned to that channel may be updated and new priority data transmitted to the edge router or source .

Since the server has knowledge of the popularity distribution within a region of the network an administrator can configure rules on the server that determine what channels are the most important. In one embodiment the most popular channels are defined as the most important ones. A provider may also choose other rules to determine the importance priority of a channel. Thus the assignment of priority levels is not limited to the content popularity distribution.

In one embodiment the priority level is configured by setting a specific DSCP Differentiated Services Code Point value in the IP packet. Differentiated services Diffserv allow traffic to be treated by intermediate systems with relative priority based on a field in the packet see for example IETF RFC 2474 Definition of the Differentiated Services Field DS Field in the IPv4 and IPv6 Headers K. Nichols et al. December 1998 . The Diffsery architecture defines an AF Assured Forwarding class see for example IETF RFC 2597 Assured Forwarding PHB Group J. Heinanen et al. June 1999 with three different priority levels referred to as drop precedence three LSB least significant bits of the DSCP value . In one example video broadcast traffic is assigned to an AF class and these three priority levels are configured on the streams in accordance with the content priority settings determined by the video caching server .

The DSCP value is used so that packets associated with lower priority channels will be dropped first. In one example the edge router first drops traffic with a low drop precedence value when it is experiencing congestion thereby preserving traffic with medium and high drop precedence values. When more traffic needs to be dropped traffic with medium drop precedence will also be dropped. The server determines how many channels receive the low medium or high drop precedence value as previously discussed.

The setting of the drop precedence in the DSCP field of the IP packet on the streams may be done at the source impacting a global area or at the edge router impacting a regional area. When done at the source the server may communicate using an RTCP RTP connection that it has established with the source for example .

The priority information may be communicated from the server to the edge router via an API application programming interface or as a configuration change using a command line interface CLI for example. It is to be understood that these are only examples and that other mechanisms may be used to communicate the settings of the DSCP value from the server .

In one embodiment the edge router is configured to set or change the DSCP value of traffic arriving on its ingress core facing interface according to a priority level assigned to the channel by the server . The egress interface applies a policy in place for congestion and uses the DSCP value to select the traffic to drop if needed. For example there may be an overlay QoS policy in place to drop a percentage of the multicast traffic if congestion occurs.

If the edge router already has a basic QoS configuration where it sets the DSCP on ingress and does the scheduling and dropping on the egress interface then preferably only an IP access list defining the source and multicast destination IP addresses is configured by the server in order to change the DSCP value. In this way the server can on a regular basis change only the IP access list entries in line with the current content popularity. This allows each edge router to be configured with a different access list based on the region that it serves.

As previously discussed one source may serve multiple regions with each region having a different content popularity distribution. As each region has its own server the content popularity for each region can be listed. Thus each region gets the correct DSCP setting that is in line with the popularity for that region. The fact that one region can have multiple edge routers and that these edge routers will get the same access list configuration is not an issue even if they are not exactly forwarding the same streams as the DSCP value determination is on a per region basis.

When the server configures the router with an access list to change the DSCP value for the different stream the router can selectively drop the least important content first thereby saving bandwidth and preserving the quality of the most important content.

Although the method and apparatus have been described in accordance with the embodiments shown one of ordinary skill in the art will readily recognize that there could be variations made without departing from the scope of the embodiments. Accordingly it is intended that all matter contained in the above description and shown in the accompanying drawings shall be interpreted as illustrative and not in a limiting sense.

