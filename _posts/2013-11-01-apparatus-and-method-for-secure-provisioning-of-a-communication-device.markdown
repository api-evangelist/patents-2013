---

title: Apparatus and method for secure provisioning of a communication device
abstract: A system that incorporates the subject disclosure may perform, for example, receiving an over-the-air programming message that includes programming data for use by the mobile communication device, decrypting the over-the-air programming message utilizing a first keyset to generate a decrypted over-the-air programming message, determining a schedule for providing messages from a secure device processor to a secure element of the mobile communication device where the secure device processor is separate from the secure element and in communication with the secure element, and providing the decrypted over-the-air programming message to the secure element according to the schedule. Other embodiments are disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09313660&OS=09313660&RS=09313660
owner: AT&T INTELLECTUAL PROPERTY I, LP
number: 09313660
owner_city: Atlanta
owner_country: US
publication_date: 20131101
---
The subject disclosure relates to an apparatus and method for secure provisioning of a communication device.

Electronic devices are being utilized with more frequency to conduct various types of transactions and exchanges of information. The electronic devices can be provisioned with programming data including an initial provisioning and subsequent provisioning s . The provisioning can sometimes include receiving the programming data from a remote source.

The subject disclosure describes among other things illustrative embodiments in which provisioning can be performed for a communication device such as via Over The Air programming OTA messages securely delivered to a communication device s . The secure delivery can be performed utilizing authentication and or encryption based on various keysets that are provided to various combinations of devices and or components. In one embodiment device based traffic management for Internet Protocol IP based e.g. Hypertext Transfer Protocol HTTP can be performed. In one embodiment security mechanisms for HTTP based OTA can be provided. In one embodiment network and or device functionality may be managed remotely. In one embodiment support for multiple HTTP based OTA servers can be provided for securely provisioning one or more communication devices via OTA messaging.

In one embodiment a device based proxy can be utilized to provide traffic management for HTTP based OTA messages. In one embodiment a device based proxy and a secure element e.g. a Universal Integrated Circuit Card UICC can be utilized to provide security for HTTP based OTA messages such as through authentication and or encryption. In one embodiment a Secure Device Processor SDP can be utilized as the device based proxy. In one embodiment remote management of the device and or network components can be performed. In one embodiment an administrative agent key function is provided that may be located in the UICC. In one embodiment an administrative agent function is loaded into an SDP of a communication device such as a mobile smart phone. In one embodiment a remote management function can be provided in a remote management server in order to manage in whole or in part the administrative agent function the administrative agent key function and or the transport keys that are distributed such as to the SDP and or OTA server s .

In one or more embodiments the secure element e.g. executing the administrative agent key function the secure device processor e.g. executing the administrative agent function and or the device processor can be separate but in communication with each other. The secure element e.g. UICC can be a highly secure computing platform for storing secrets such as encryption keys and authentication credentials and can host and execute applets. The SDP can be a processor that is logically and or physically separate from the device processor and or the secure element and can offer more security than the device processor but not as much security as the secure element. Examples of an SDP include a Trusted Execution Environment TEE and an embedded Secure Element eSE . In one or more embodiments the administrative agent function of the SDP in conjunction with the OTA server can provide a secure means for delivering messages and response associated with OTA including various programming data to the secure element to enable the secure element to utilize the programming data e.g. executing software updates adjusting configuration settings or parameters and so forth .

One embodiment of the subject disclosure is a method including registering by an administrative agent function operating in a secure device processor of a mobile communication device an internet protocol address with an over the air programming server where the internet protocol address is associated with the administrative agent function. The method can include receiving from the over the air programming server by the administrative agent function an over the air programming message that includes programming data for use by the mobile communication device where the over the air programming message is encrypted by the over the air programming server and where the over the air programming message utilizes a hypertext transfer protocol. The method can include decrypting by the administrative agent function the over the air programming message utilizing a first keyset to generate a decrypted over the air programming message. The method can include determining by the administrative agent function a schedule for providing messages to a secure element of the mobile communication device where the secure device processor is separate from the secure element and in communication with the secure element. The method can include providing by the administrative agent function the decrypted over the air programming message to the secure element according to the schedule.

One embodiment of the subject disclosure is a method that includes receiving by a server including a processor a registration request including an internet protocol address where the registration request is received from a secure device processor of a mobile communication device. The method can include encrypting by the server an over the air programming message utilizing a first keyset to generate an encrypted over the air programming message where the over the air programming message includes programming data for use by the mobile communication device. The method can include providing by the server the encrypted over the air programming message to the secure device processor to enable the secure device processor to decrypt the encrypted over the air programming message utilizing the first keyset where the providing of the encrypted over the air programming message further enables the secure device processor to provide the programming data to a secure element of the mobile communication device for provisioning of the mobile communication device and wherein the secure device processor is separate from the secure element and in communication with the secure element.

One embodiment of the subject disclosure is a method that includes receiving by a secure element of a mobile communication device a request for a first keyset where the request is received from a secure device processor of the mobile communication device and where the secure element is separate from the secure device processor and in communication with the secure device processor. The method can include providing by the secure element the first keyset to the secure device processor to enable the secure device processor to decrypt an over the air programming message to generate a decrypted over the air programming message where the over the air programming message includes programming data for provisioning the mobile communication device. The method can include receiving by the secure element from the secure device processor the decrypted over the air programming message. The method can include performing by the secure element an additional decryption of the decrypted over the air message utilizing a second keyset where the secure device processor does not have access to the second keyset.

In accordance with an embodiment of the disclosure depicts a system that includes a communication device connected to or otherwise in communication with a network and provided with a secure services platform enabling authentication of other communication devices encrypted communication with those devices and or secure communications related to OTA messages. Device can be loaded with an administrative agent function e.g. loaded into a secure device processor and or an administrative agent key function e.g. loaded into a secure element to enable or otherwise facilitate processing of messages and responses related to OTA including messaging with a service provisioning system via one or more OTA servers.

It will be appreciated that the communication device may be any device including a user device which has a secure element and a secure device processor. The term user in this example refers to a human user of the communication device. However in other embodiments the user can be a machine that exchanges data with the communication device after being authenticated to the communication device. Communication device can include a device processor the SDP and the secure element e.g. which can include a UICC . The secure element can be various types of smart cards including a Subscriber Identification Module SIM card or other types of secure element. The secure element can be a secure computing platform and can offer a high level of security for storing encryption keys authentication credentials and the like. The secure element may be removable from the device. In other embodiments the secure element may be embedded in the device and not removable. In other embodiments the secure element can be placed on a memory card or an embedded chip.

The SDP can be logically and or physically separate from the device processor and can be connected to both the device processor and the secure element . In this embodiment the SDP can offer a higher level of security than the device processor and can store and execute secure applications. The SDP can for example run applications in a trusted execution environment. The secure element and SDP together can form a secure services platform resident on the device . In this embodiment secure element SDP and device processor can each have a security level associated therewith and the security level associated with the SDP can be intermediate between that of the secure element and that of the device processor . The SDP and secure element can use mutual authentication as described in more detail below.

The secure element and SDP can communicate with a remote management function server located remotely from device . The Remote Management Server RMS can be a platform for provisioning and or managing applications in the secure element and SDP . The RMS can also manage data such as keys credentials and so forth that are used by the applications. Examples of remote management servers are described in U.S. patent application Ser. No. 13 679 479 filed on Nov. 16 2012 and U.S. patent application Ser. No. 13 680 680 filed on Nov. 19 2012 the disclosures of both of which are hereby incorporated by reference.

In this embodiment user device can be a wireless communication device connected to a cellular network . Network can also be other types of networks operating according to various communication protocols such as a WiFi network. In other embodiments device can be connected to other devices via a wired connection through a computer. In still other embodiments user devices can communicate with each other using Bluetooth infrared communications IRDa and or near field communications NFC . A communication session between user devices wherein information is transferred between the users can be effected by a wide variety of arrangements. A secure application server SAS can be used in some embodiments to establish a secure communication session between devices. However in some embodiments a secure application server may not be used where the communication session is established in a peer to peer manner such as in Bluetooth IRDa or NFC.

System enables components of the secure services platform e.g. an administrative agent function of the SDP to perform operations including one or more of registering an Internet Protocol IP address with the OTA server where the IP address is associated with the administrative agent function receiving from the OTA server an OTA message that includes programming data for use by the mobile communication device where the OTA message is encrypted by the OTA server and where the OTA message utilizes a hypertext transfer protocol decrypting the OTA message utilizing a first keyset e.g. a transport keyset to generate a decrypted OTA message determining a schedule for providing messages to a secure element of the mobile communication device where the SDP is separate from the secure element and in communication with the secure element and providing the decrypted OTA message to the secure element according to the schedule.

System enables components of the secure services platform e.g. the secure element to perform operations including one or more of receiving a request for a first keyset e.g. a transport keyset where the request is received from an SDP of the mobile communication device and where the secure element is separate from the SDP and in communication with the SDP providing the first keyset to the SDP to enable the SDP to decrypt an OTA message to generate a decrypted OTA message where the OTA message includes programming data for provisioning the mobile communication device receiving the decrypted OTA message and performing an additional decryption of the decrypted OTA message utilizing a second keyset where the SDP does not have access to the second keyset. In one embodiment the secure element can receive a static key from the remote management server where the remote management server provides the static key to the OTA server that transmitted the OTA message to the SDP and can generate the first keyset from the static key. In one embodiment the secure element can include a UICC wherein the OTA message utilizes HTTP and where the receiving of the decrypted OTA message is according to a schedule generated by the SDP. In one embodiment the secure element can generate a response to the OTA message can encrypt the response utilizing the second keyset e.g. application keyset to generate an encrypted response and can provide the encrypted response to the SDP for transmission to a service provisioning system that originated the OTA message to enable the service provisioning system to decrypt the encrypted response utilizing the second keyset.

In one embodiment the OTA server can receive a registration request including an internet protocol address where the registration request is received from SDP of a mobile communication device. The OTA server can encrypt an OTA message utilizing a first keyset to generate an encrypted OTA message where the OTA message includes programming data for use by the mobile communication device. The OTA server can provide the encrypted OTA message to the SDP to enable the SDP to decrypt the encrypted OTA message utilizing the first keyset where the providing of the encrypted OTA message further enables the SDP to provide the programming data to a secure element e.g. UICC of the mobile communication device for provisioning of the mobile communication device and where the SDP is separate from the secure element and in communication with the secure element. In one embodiment the OTA server can receive the OTA message from the service provisioning system where the OTA message is encrypted by the service provisioning system utilizing a second keyset e.g. application keyset where the second keyset is accessible to the secure element and the service provisioning system and where the second keyset is not accessible to the server and the secure device processor. In one embodiment the providing of the encrypted OTA message to the SDP utilizes HTTP. In one embodiment the OTA server can receive a static key from the remote management server where the remote management server provides the static key to the secure element to enable the secure element to generate or otherwise derive a key of the first keyset from the static key and to enable the secure element to provide the first keyset to the SDP. In one embodiment the OTA server can generate another key of the first keyset from the static key. In one embodiment the first keyset can be provided to the OTA server and to the mobile communication device by the remote management server . In one embodiment the OTA server can receive the OTA message from the service provisioning system can receive a request from the service provisioning system to provide the OTA message to another mobile communication device can determine that another secure device processor of the other mobile communication device is not registered with the OTA server and can provide a notice to the service provisioning system indicating that the other secure device processor is not registered with the server. In one embodiment the OTA server can receive a response to the OTA message can decrypt the response utilizing the first keyset to generate a decrypted response and can provide the decrypted response to the service provisioning system that originated the OTA message. In one embodiment the OTA server can store the message for transmission later. In another embodiment the OTA server can retransmit the message if necessary.

The RMS can perform a remote provisioning and management function to load applications content and or other information e.g. various keysets into the secure element and or SDP . In this embodiment the RMS can provision the authentication management function and real time encryption key generator on the secure element and can provision the real time encryption engine on the SDP . This can be done securely by the use of one or more remote management keysets. In one embodiment before the secure services platform can be used for communication the SDP can be authenticated by the secure element . In one embodiment this can be done using a UICC SDP keyset. The UICC SDP keyset may be provisioned remotely by the RMS or locally by an authorized user. In this embodiment after the secure element and SDP are mutually authenticated using the UICC SDP keyset they can communicate via a signaling path within the secure services platform . The UICC SDP keyset may be used for secure communication during initial loading and provisioning. However the keys being utilized may be different. In one embodiment the path between the secure element and the SDP can go through the device processor rather than directly between the secure element and the SDP.

In this embodiment of the secure services platform enables processing messages and responses related to OTA. These messages can be authenticated and or encrypted utilizing various keysets that are exclusive to various devices or components so that the end points of the communication e.g. the secure element and the service provisioning system securely receive the programming data and or the response related to the programming data. Various keysets can be distributed between pairs of devices or components such as providing an SDP keyset to both of the administrative agent key function of the secure element and the administrative agent function of the SDP providing a transport keyset to both of the OTA server and the administrative agent function and or providing an application keyset to both the service provisioning system and the secure element. In one embodiment the provisioning of one or more of these keysets can be performed by the remote management server such as through use of remote management keysets.

Referring to a system is depicted which illustrates a secure process for providing messages and responses related to OTA. System can include managing HTTP based OTA traffic from multiple sources to the secure element e.g. UICC . In one embodiment HTTP based OTA messages can be sent from a service provisioning system to the secure element via a network based OTA server and a device based administrative agent function e.g. operating in the secure device processor . The OTA server can prepare the message for OTA transport and may provide additional security such as in the form of authentication and or encryption. The administrative agent function which can be located in or otherwise operated by the SDP can receive HTTP based OTA messages from one or more OTA servers and can manage the delivery of the messages to the secure element such as the UICC. The administrative agent function can also support additional security measures that were performed by the OTA server.

In one embodiment the OTA server can perform transmitting and receiving messages to from one or more service provisioning systems transmitting and receiving messages to from the UICC via the administrative agent function and or authenticating the administrative agent function and encrypting the OTA message.

In one embodiment the SDP can contain or otherwise execute the administrative agent function. The SDP can be a processor that is logically and or physically separate from the device processor and or the secure element and can offer more hardened security than the device processor but not as much security as the UICC. The administrative agent function can perform one or more of transmitting and receiving messages to from one or more OTA servers providing transport security between itself and an OTA server encrypting and decrypting messages using one or more transport keys transmitting and receiving messages to from the secure element and managing the communication path to the secure element such as message queuing scheduling e.g. scheduling packets for transmission response correlation e.g. tracking and correlating responses for each transmission and or reliable delivery via retransmission. The SDP can also register an IP address e.g. the IP address associated with the administrative agent function with the OTA server.

In one embodiment the secure element e.g. the UICC may contain or otherwise execute an administrative agent key function that can provide transport key s which are derived from a static key s to the administrative agent function. The secure element can perform security operations that were initiated by the service provisioning system such as decryption based on application keysets. In one embodiment multiple OTA servers can communicate with a single administrative agent function. In one embodiment the transport key can be preloaded into the UICC and or the OTA server or the transport key can be generated or otherwise derived from a static key which in some embodiments can be derived from a master key .

In one embodiment the remote management server can manage the applications on both the secure element and the SDP. For example the remote management server can manage the download of static keys for deriving the transport keys and or transport keys as well as the status of existing transport keys. These transport keys may exist in either or both of the administrative agent key function and the administrative agent function. The remote management server can also provide a static key for generating a transport key and or transport keys to other devices such as the OTA server. These operations can be done securely by the use of one or more remote management keysets. These keysets can be used to mutually authenticate the secure element and SDP with the remote management server and or to enable encryption between them. In one embodiment the remote management server may use existing Short Message Service SMS based OTA messaging to manage the secure element including the administrative agent key function.

In one embodiment the remote management server can be the source of the static key and or may store the static key. In one embodiment the remote management server can provide the static key to the secure element and to the OTA server. In one embodiment the secure element and the OTA server can use the static key to generate or otherwise derive the transport key.

In another embodiment the remote management server can provide a static keyset to the secure element and the OTA server. In one embodiment the static keyset can be a master key or can be a static key that is derived from the master key. In one example both the secure element and the OTA server can use the static key to derive the transport keys of the transport keyset. In one embodiment the remote management server may store the static keyset. In another embodiment a static key e.g. derived from a master key by the remote management server may be sent to the UICC and the OTA server such as by the remote management server. The static key can be used to derive dynamic transport keys. In one embodiment the UICC and the OTA server can be provided with the first keyset e.g. transport keys such as by the remote management server.

Referring to system is depicted which illustrates loading or otherwise provisioning the end user device s with the applications that are utilized by the secure services platform for performing the secure OTA messaging process. In one embodiment there can be a plurality of applications to be loaded or otherwise provisioned such as the administrative agent function and the administrative agent key function. For example if the applications have not been loaded at the factory then at the remote management server can download the administrative agent function to the SDP and the administrative agent key function to the secure element. In one embodiment remote management keysets can be used to securely transmit information from the remote management server to the UE s . This process can utilize mutual authentication and or encryption. In one embodiment the remote management server may use SMS based OTA to manage the secure element including the download of the administrative agent key function.

At the administrative agent function and the administrative agent key function can mutually authenticate with each other such as through utilizing an SDP keyset. The administrative agent function can verify that it is able to communicate with the administrative agent key function. At the remote management server can download one or more transport keys to the administrative agent key function and or directly to the administrative agent function. This can be performed using a remote management keyset. As described above the remote management server may use SMS based OTA to manage the secure element which may include the loading of the transport keys. In one embodiment the remote management server may download the static key which can be a master key or can be derived from a master key or one or more transport keys to the administrative agent key function and or directly to the administrative agent function. The static key can be used for deriving by the remote management server a key of the transport keys. At the remote management server can provide the transport key to one or more OTA servers. In one embodiment the remote management server may download the a static key which can be a master key or one or more transport keys to the OTA server. The static key can be used for deriving by the OTA server a key of the transport keys. At the administrative agent function can register its IP address with one or more OTA servers. This process can include mutual authentication and or encryption using the transport keys.

Referring to system is depicted which illustrates a process for securely communicating messages and responses related to OTA. The process is based on the OTA server forwarding an OTA message from a service provisioning system to the administrative agent function for transmission to the secure element. At a service provisioning system can prepare a message to be sent to the secure element. This message can be HTTP based and may be encrypted using an application keyset. At the OTA server can receive the OTA message and can prepare to transmit the OTA message to the administrative agent function via HTTP. The OTA server may use a suitable transport key to authenticate the administrative agent function and encrypt the message. In one embodiment if the administrative agent function has not registered with the OTA server the OTA server can provide a suitable response back to the service provisioning system. In one embodiment if the administrative agent function is not registered with the OTA server then the OTA server can store the OTA message for transmission at a later time such as when the administrative agent function becomes registered. In one embodiment periodic monitoring for registration can be performed.

At the administrative agent function can receive the message and can check to see if it is encrypted and authenticated with a transport key. If not the administrative agent function can act upon the message as described in Step . If so the administrative agent function can determine whether or not it has the proper key to decrypt the message and can authenticate the OTA server. If it does then it can decrypt the message using its own transport key can authenticate the OTA server and can act upon the message as described in Step

At if the message is encrypted with a transport key and the administrative agent function does not have a corresponding transport key to decrypt it the administrative agent function can ask the administrative agent key function to provide one. To do this the administrative agent function can generate a request and can transmit the request to the administrative agent key function which can respond with a suitable transport key. In one embodiment the key provided by the administrative agent key function can be derived from a static key stored by or otherwise accessible to the administrative agent key function. At the administrative agent function can decrypt the message using either its own transport key or one provided by the administrative agent key function. The administrative agent function can then authenticate the OTA server. At the administrative agent function can schedule the message for transmission to a UICC terminating entity such as through generating a messaging schedule . Once the message is ready for transmission the administrative agent function can schedule it for transmission can transmit it at the scheduled time can track the response from the secure element and can retransmit if necessary.

At the UICC terminating entity can receive the message and can perform actions based on the content of the message such as software update configuration setting adjustments and so forth. If the message is encrypted with an application key the UICC terminating entity can decrypt the message using its own application key. The UICC terminating entity may also respond to the message. At if a response is provided then the response will travel back to the administrative agent function. The administrative agent function can correlate or otherwise map the response to the initial OTA message encrypt the response with a transport key if desired and transmit the response to the OTA server. At the OTA server can receive the response to the initial OTA message. In one embodiment the OTA server can perform decryption utilizing the first keyset e.g. a transport key . At the OTA server can transmit the response back to the service provisioning system. In one embodiment the service provisioning system can perform decryption utilizing another keyset e.g. an application key .

At the administrative agent function can detect an encryption of the OTA message and can decrypt it utilizing a first keyset e.g. a transport keyset to generate a decrypted OTA message. In one embodiment at the administrative agent function can determine whether it has possession of the first keyset e.g. stored in a memory of the secure device processor and if not the administrative agent function can provide a keyset request to the secure element. In response to the request the secure element e.g. an administrative agent key function operating in a UICC can provide the requested keyset e.g. the transport keyset to the administrative agent function. In one embodiment the communication between the administrative agent function of the secure device processor and the administrative agent key function of the secure element can be based on a mutual authentication that utilizes SDP keyset provided to both the secure element and the secure device processor by the remote management server utilizing remote management keyset.

At the administrative agent function can determine or otherwise generate a schedule for providing messages to the secure element of the mobile communication device. In this embodiment the secure device processor is separate from the secure element and in communication with the secure element as described in . At the administrative agent function can provide the decrypted OTA message to the secure element according to the schedule to enable the secure element e.g. a UICC terminating entity operating in the secure element to utilize the programming data of the OTA message such as for provisioning of the mobile communication device e.g. software updates configuration setting adjustments and so forth .

In one embodiment the secure element can comprise a UICC. In one embodiment the method can further include one or more of monitoring by the administrative agent function for a response provided by the secure element determining by the administrative agent function that the response is associated with the OTA message encrypting by the administrative agent function the response utilizing the first keyset to generate an encrypted response and providing by the administrative agent function the encrypted response to the OTA server to enable the OTA server to decrypt the encrypted response for transmission such as to a service provisioning system that originated or is otherwise associated with the OTA message. In one embodiment the providing of the decrypted OTA message to the secure element enables the secure element to further decrypt the decrypted OTA message utilizing a second keyset e.g. an application keyset . In one embodiment the application keyset can be stored by or otherwise accessible to the secure element and the service provisioning system. In another embodiment the application keyset may not be accessible to the secure device processor. In another embodiment the application keyset may not be accessible to the OTA server.

In one embodiment method can include authenticating by the administrative agent function with the secure element utilizing a third keyset e.g. an SDP keyset . In one embodiment the first keyset can be generated or otherwise derived by the secure element e.g. the administrative agent key function from a static key that is provided by a remote management server to the secure element and to the OTA server. In another embodiment the providing of the static key to the secure element by the remote management server can be based on another OTA message that utilizes SMS transport protocol e.g. SMPP . In one embodiment the static key can be a master key or can be derived from a master key.

In one embodiment method can include receiving by the administrative agent function the first keyset e.g. transport keyset from a remote management server where the remote management server provides the first keyset to the OTA server and where the receiving of the first keyset by the administrative agent function is performed utilizing a remote management keyset.

In one embodiment the administrative agent function can be downloaded to the secure device processor utilizing the remote management keyset. In one embodiment the administrative agent key function can be downloaded to the secure element utilizing the remote management keyset.

In one embodiment the OTA message can originate from a service provisioning system where the providing of the decrypted OTA message to the secure element enables the secure element to further decrypt the decrypted OTA message utilizing a second keyset e.g. application keyset where the administrative agent function and the OTA server do not have access to the second keyset and wherein the service provisioning system has access to the second keyset.

In one embodiment the method can include one or more of determining by the administrative agent function that a response has been generated by the secure element and is associated with the OTA message and providing by the administrative agent function the response to the OTA server for transmission to the service provisioning system. In one embodiment the response can be encrypted by the secure element utilizing the second keyset e.g. application keyset where the response is configured for decryption by the service provisioning system utilizing the second keyset.

In one embodiment method can include providing by the administrative agent function a request to the secure element for the first keyset responsive to a determination that the OTA message has been encrypted and receiving by the administrative agent function the first keyset from the secure element. In another embodiment the static key can be provided to the secure element e.g. the administrative agent key function and the OTA server for deriving of the transport keys respectively of the transport keyset. In one embodiment method can include retransmitting by the administrative agent function the decrypted OTA message to the secure element.

In one or more embodiments system enables authentication and or encryption to be performed between various devices or components of a single device based on keysets distributed between pairs of devices or components such as providing an SDP keyset to both of the secure element and the SDP providing a transport keyset to both of the SDP and the OTA server and or providing an application keyset to both the secure element and the service provisioning system. The distribution of these keysets can be exclusive between the pairs of devices or components or can be non exclusive.

The IPTV media system can include a super head end office SHO with at least one super headend office server SHS which receives media content from satellite and or terrestrial communication systems. In the present context media content can represent for example audio content moving image content such as 2D or 3D videos video games virtual reality content still image content and combinations thereof. The SHS server can forward packets associated with the media content to one or more video head end servers VHS via a network of video head end offices VHO according to a multicast communication protocol.

The VHS can distribute multimedia broadcast content via an access network to commercial and or residential buildings housing a gateway such as a residential or commercial gateway . The access network can represent a group of digital subscriber line access multiplexers DSLAMs located in a central office or a service area interface that provide broadband services over fiber optical links or copper twisted pairs to buildings . The gateway can use communication technology to distribute broadcast signals to media processors such as Set Top Boxes STBs which in turn present broadcast channels to media devices such as computers or television sets managed in some instances by a media controller such as an infrared or RF remote controller .

The gateway the media processors and media devices can utilize tethered communication technologies such as coaxial powerline or phone line wiring or can operate over a wireless access protocol such as Wireless Fidelity WiFi Bluetooth Zigbee or other present or next generation local or personal area wireless network technologies. By way of these interfaces unicast communications can also be invoked between the media processors and subsystems of the IPTV media system for services such as video on demand VoD browsing an electronic programming guide EPG or other infrastructure services.

A satellite broadcast television system can be used in the media system of . The satellite broadcast television system can be overlaid operably coupled with or replace the IPTV system as another representative embodiment of communication system . In this embodiment signals transmitted by a satellite that include media content can be received by a satellite dish receiver coupled to the building . Modulated signals received by the satellite dish receiver can be transferred to the media processors for demodulating decoding encoding and or distributing broadcast channels to the media devices . The media processors can be equipped with a broadband port to an Internet Service Provider ISP network to enable interactive services such as VoD and EPG as described above.

In yet another embodiment an analog or digital cable broadcast distribution system such as cable TV system can be overlaid operably coupled with or replace the IPTV system and or the satellite TV system as another representative embodiment of communication system . In this embodiment the cable TV system can also provide Internet telephony and interactive media services.

The subject disclosure can apply to other present or next generation over the air and or landline media content services system.

Some of the network elements of the IPTV media system can be coupled to one or more computing devices a portion of which can operate as a web server for providing web portal services over the ISP network to wireline media devices or wireless communication devices .

Communication system can also provide for computing devices to function as a remote management server an OTA server and or a service provisioning system herein referred to as server . The server can use computing and communication technology to perform function which can include among other things provisioning various devices or components such as through use of remote management keysets. The provisioning can be of applications such as the administrative agent function and or the administrative agent key function and or can be of keysets such as transport keysets. Function can include one or more of receiving a registration request including an IP address where the registration request is received from a secure device processor of a mobile communication device encrypting an OTA message utilizing a first keyset to generate an encrypted OTA message where the OTA message includes programming data for use by the mobile communication device and providing the encrypted OTA message to the secure device processor to enable the secure device processor to decrypt the encrypted OTA message utilizing the first keyset. In one embodiment the providing of the encrypted OTA message can further enable the secure device processor to provide the programming data to a secure element of the mobile communication device for provisioning of the mobile communication device. In another embodiment the secure device processor can be separate from the secure element and in communication with the secure element.

Function can include functions being performed at the secure element including one or more of receiving a request for a first keyset where the request is received from a secure device processor of the mobile communication device and where the secure element is separate from the secure device processor and in communication with the secure device processor providing the first keyset to the secure device processor to enable the secure device processor to decrypt an OTA message to generate a decrypted OTA message where the OTA message includes programming data for provisioning the mobile communication device receiving from the secure device processor the decrypted OTA message and performing an additional decryption of the decrypted OTA message utilizing a second keyset. In one embodiment the secure device processor does not have access to the second keyset.

Function can also include functions being performed at the SDP such as one or more of registering an IP address with an OTA server where the IP address is associated with the administrative agent function receiving from the OTA server an OTA message that includes programming data for use by the mobile communication device where the OTA message is encrypted by the OTA server where the OTA message utilizes HTTP decrypting the OTA message utilizing a first keyset e.g. transport keyset to generate a decrypted OTA message determining a schedule for providing messages to a secure element of the mobile communication device where the secure device processor is separate from the secure element and in communication with the secure element and providing the decrypted OTA message to the secure element according to the schedule.

Multiple forms of media services can be offered to media devices over landline technologies such as those described above. Additionally media services can be offered to media devices by way of a wireless access base station operating according to common wireless access protocols such as Global System for Mobile or GSM Code Division Multiple Access or CDMA Time Division Multiple Access or TDMA Universal Mobile Telecommunications or UMTS World interoperability for Microwave or WiMAX Software Defined Radio or SDR Long Term Evolution or LTE and so on. Other present and next generation wide area wireless access network technologies can be used in one or more embodiments of the subject disclosure.

In one or more embodiments the secure element of device can perform operations including generating transport keys from a static key and providing the transport key to the SDP so that the SDP can authenticate encrypt and or decrypt in conjunction to messages responses of the OTA server. The secure element can also decrypt OTA messages originated from the service provisioning system generate and encrypt responses to the OTA message that are to be transmitted by the SDP to the service provisioning system and or utilize programming data included in the OTA message e.g. updating software adjusting device settings and so forth . In other embodiments static keys can be selectively distributed to enable deriving the transport keyset.

In one or more embodiments the SDP e.g. the administrative agent function of device can perform operations including authenticate encrypt and or decrypt in conjunction to messages responses of the OTA server request transport keys from the secure element schedule transmissions of OTA messages to the secure element and or retransmit OTA messages to the secure element.

To enable these features communication device can comprise a wireline and or wireless transceiver herein transceiver a user interface UI a power supply a location receiver a motion sensor an orientation sensor and a controller for managing operations thereof. The transceiver can support short range or long range wireless access technologies such as Bluetooth ZigBee WiFi DECT or cellular communication technologies just to mention a few. Cellular technologies can include for example CDMA 1X UMTS HSDPA GSM GPRS TDMA EDGE EV DO WiMAX SDR LTE NFC as well as other next generation wireless communication technologies as they arise. The transceiver can also be adapted to support circuit switched wireline access technologies such as PSTN packet switched wireline access technologies such as TCP IP VoIP etc. and combinations thereof.

The UI can include a depressible or touch sensitive keypad with a navigation mechanism such as a roller ball a joystick a mouse or a navigation disk for manipulating operations of the communication device . The keypad can be an integral part of a housing assembly of the communication device or an independent device operably coupled thereto by a tethered wireline interface such as a USB cable or a wireless interface supporting for example Bluetooth. The keypad can represent a numeric keypad commonly used by phones and or a QWERTY keypad with alphanumeric keys. The UI can further include a display such as monochrome or color LCD Liquid Crystal Display OLED Organic Light Emitting Diode or other suitable display technology for conveying images to an end user of the communication device . In an embodiment where the display is touch sensitive a portion or all of the keypad can be presented by way of the display with navigation features.

The display can use touch screen technology to also serve as a user interface for detecting user input. As a touch screen display the communication device can be adapted to present a user interface with graphical user interface GUI elements that can be selected by a user with a touch of a finger. The touch screen display can be equipped with capacitive resistive or other forms of sensing technology to detect how much surface area of a user s finger has been placed on a portion of the touch screen display. This sensing information can be used to control the manipulation of the GUI elements or other functions of the user interface. The display can be an integral part of the housing assembly of the communication device or an independent device communicatively coupled thereto by a tethered wireline interface such as a cable or a wireless interface.

The UI can also include an audio system that utilizes audio technology for conveying low volume audio such as audio heard in proximity of a human ear and high volume audio such as speakerphone for hands free operation . The audio system can further include a microphone for receiving audible signals of an end user. The audio system can also be used for voice recognition applications. The UI can further include an image sensor such as a charged coupled device CCD camera for capturing still or moving images.

The power supply can utilize common power management technologies such as replaceable and rechargeable batteries supply regulation technologies and or charging system technologies for supplying energy to the components of the communication device to facilitate long range or short range portable applications. Alternatively or in combination the charging system can utilize external power sources such as DC power supplied over a physical interface such as a USB port or other suitable tethering technologies.

The location receiver can utilize location technology such as a global positioning system GPS receiver capable of assisted GPS for identifying a location of the communication device based on signals generated by a constellation of GPS satellites which can be used for facilitating location services such as navigation. The motion sensor can utilize motion sensing technology such as an accelerometer a gyroscope or other suitable motion sensing technology to detect motion of the communication device in three dimensional space. The orientation sensor can utilize orientation sensing technology such as a magnetometer to detect the orientation of the communication device north south west and east as well as combined orientations in degrees minutes or other suitable orientation metrics .

The communication device can use the transceiver to also determine a proximity to a cellular WiFi Bluetooth or other wireless access points by sensing techniques such as utilizing a received signal strength indicator RSSI and or signal time of arrival TOA or time of flight TOF measurements. The controller can utilize computing technologies such as a microprocessor a digital signal processor DSP programmable gate arrays application specific integrated circuits and or a video processor with associated storage memory such as Flash ROM RAM SRAM DRAM or other storage technologies for executing computer instructions controlling and processing data supplied by the aforementioned components of the communication device .

Other components not shown in can be used in one or more embodiments of the subject disclosure. For instance the communication device can include a reset button not shown . The reset button can be used to reset the controller of the communication device . In yet another embodiment the communication device can also include a factory default setting button positioned for example below a small hole in a housing assembly of the communication device to force the communication device to re establish factory settings. In this embodiment a user can use a protruding object such as a pen or paper clip tip to reach into the hole and depress the default setting button. In one embodiment the communication device can also include a slot for adding or removing the UICC.

The communication device as described herein can operate with more or less of the circuit components shown in . These variant embodiments can be used in one or more embodiments of the subject disclosure.

The communication device can be adapted to perform the functions of the media processor the media devices the portable communication devices and or the server of . It will be appreciated that the communication device can also represent other devices that can operate in communication system of such as a gaming console and a media player.

The communication device shown in or portions thereof can serve as a representation of one or more of the devices of including end user devices customer premises equipment remote management servers OTA servers and or service provisioning system. In one or more embodiments the OTA server and or the service provisioning system can be operated by or otherwise affiliated with a third party entity that is different from and or independent of the service provider operating the RMS . In addition the controller can perform the functions and or .

Upon reviewing the aforementioned embodiments it would be evident to an artisan with ordinary skill in the art that said embodiments can be modified reduced or enhanced without departing from the scope of the claims described below. For example in the event that a secure element and or SDP is determined to be inaccessible such as via an HTTP message from the OTA server an alert can be generated to implement techniques for delivering of the OTA message as described in the U.S patent application Ser. No. 14 069 908 entitled Apparatus and Method for Secure Over The Air Programming of a Communication Device the disclosure of which is hereby incorporated by reference. For instance the alert can be transmitted to the mobile device to indicate that OTA programming data is available. In another embodiment the alert can cause a network interworking function or another network element to determine if there are other alternate delivery techniques available for the secure element.

In one embodiment encryption can be applied by the service provisioning system to the OTA message or by the secure element to the response based on various encryption techniques including elliptical curve cryptography Advance Encryption Standard AES and so forth. Other encryption techniques can be utilized including symmetrical and or asymmetrical cryptographic methods. In another embodiment the mobile communication device can communicate with the service provisioning system or another device via the administrative agent function to transfer various information e.g. in a secure message which may or may not be related to the OTA message. This information can be provided with the various security procedures described above with respect to one or more of the exemplary embodiments including encrypting with application keyset e.g. done at the secure element encrypting with transport keyset e.g. done at an application agent function of the mobile communication device and or authentication between various devices and or components e.g. authentication between the secure element and the administrative agent function authentication between the OTA server and the administrative agent function and so forth .

As an example the secure element can generate a secure message for transmission encrypt the secure message utilizing the second keyset e.g. application keyset to generate an encrypted secure message and provide the encrypted secure message to the secure device processor for transmission to a destination device via an intermediate server e.g. OTA server to enable the destination device to decrypt the encrypted secure message utilizing the second keyset where the encrypted secure message is further encrypted by the secure device processor utilizing the first keyset e.g. transport keyset and where the encrypted secure message is further decrypted by the intermediate server utilizing the first keyset prior to delivery to the intermediate server. In one embodiment the OTA server can re encrypt a message that the OTA server received from a device before transmitting to another device. In one embodiment the OTA server can be an OTA server function the remote management server can be a remote management server function and both the OTA server function and the remote management server function can operate from a single device or from a group of devices where each device of the group executes both functions . In another embodiment the OTA server and the remote management server are separate devices. In one embodiment each transport key of the transport keyset can be static or dynamic.

It should be understood that devices described in the exemplary embodiments can be in communication with each other via various wireless and or wired methodologies. The methodologies can be links that are described as coupled connected and so forth which can include unidirectional and or bidirectional communication over wireless paths and or wired paths that utilize one or more of various protocols or methodologies where the coupling and or connection can be direct e.g. no intervening processing device and or indirect e.g. an intermediary processing device such as a router .

The machine may comprise a server computer a client user computer a personal computer PC a tablet PC a smart phone a laptop computer a desktop computer a control system a network router switch or bridge or any machine capable of executing a set of instructions sequential or otherwise that specify actions to be taken by that machine. It will be understood that a communication device of the subject disclosure includes broadly any electronic device that provides voice video or data communication. Further while a single machine is illustrated the term machine shall also be taken to include any collection of machines that individually or jointly execute a set or multiple sets of instructions to perform any one or more of the methods discussed herein.

The computer system may include a processor or controller e.g. a central processing unit CPU a graphics processing unit GPU or both a main memory and a static memory which communicate with each other via a bus . The computer system may further include a display unit e.g. a liquid crystal display LCD a flat panel or a solid state display . The computer system may include an input device e.g. a keyboard a cursor control device e.g. a mouse a disk drive unit a signal generation device e.g. a speaker or remote control and a network interface device . In distributed environments the embodiments described in the subject disclosure can be adapted to utilize multiple display units controlled by two or more computer systems . In this configuration presentations described by the subject disclosure may in part be shown in a first of the display units while the remaining portion is presented in a second of the display units .

The disk drive unit may include a tangible computer readable storage medium on which is stored one or more sets of instructions e.g. software embodying any one or more of the methods or functions described herein including those methods illustrated above. The instructions may also reside completely or at least partially within the main memory the static memory and or within the processor during execution thereof by the computer system . The main memory and the processor also may constitute tangible computer readable storage media.

Dedicated hardware implementations including but not limited to application specific integrated circuits programmable logic arrays and other hardware devices that can likewise be constructed to implement the methods described herein. Application specific integrated circuits and programmable logic array can use downloadable instructions for executing state machines and or circuit configurations to implement embodiments of the subject disclosure. Applications that may include the apparatus and systems of various embodiments broadly include a variety of electronic and computer systems. Some embodiments implement functions in two or more specific interconnected hardware modules or devices with related control and data signals communicated between and through the modules or as portions of an application specific integrated circuit. Thus the example system is applicable to software firmware and hardware implementations.

In accordance with various embodiments of the subject disclosure the operations or methods described herein are intended for operation as software programs or instructions running on or executed by a computer processor or other computing device and which may include other forms of instructions manifested as a state machine implemented with logic components in an application specific integrated circuit or field programmable gate array. Furthermore software implementations e.g. software programs instructions etc. including but not limited to distributed processing or component object distributed processing parallel processing or virtual machine processing can also be constructed to implement the methods described herein. It is further noted that a computing device such as a processor a controller a state machine or other suitable device for executing instructions to perform operations or methods may perform such operations directly or indirectly by way of one or more intermediate devices directed by the computing device.

While the tangible computer readable storage medium is shown in an example embodiment to be a single medium the term tangible computer readable storage medium should be taken to include a single medium or multiple media e.g. a centralized or distributed database and or associated caches and servers that store the one or more sets of instructions. The term tangible computer readable storage medium shall also be taken to include any non transitory medium that is capable of storing or encoding a set of instructions for execution by the machine and that cause the machine to perform any one or more of the methods of the subject disclosure. The term non transitory as in a non transitory computer readable storage includes without limitation memories drives devices and anything tangible but not a signal per se.

The term separate can include a component or device that is logically and or physically separate from another component or device which can include components devices that operate independently of each other while being in communication with each other. In one or more embodiments devices can be separate in that they do not share any common component although such separate devices can be in communication with each other such as via an electrode coupling. In one or more embodiments devices can be separate in that they each have one or more components that are not shared between each other but have one or more components that may be shared with each other.

The term tangible computer readable storage medium shall accordingly be taken to include but not be limited to solid state memories such as a memory card or other package that houses one or more read only non volatile memories random access memories or other re writable volatile memories a magneto optical or optical medium such as a disk or tape or other tangible media which can be used to store information. Accordingly the disclosure is considered to include any one or more of a tangible computer readable storage medium as listed herein and including art recognized equivalents and successor media in which the software implementations herein are stored.

Although the present specification describes components and functions implemented in the embodiments with reference to particular standards and protocols the disclosure is not limited to such standards and protocols. Each of the standards for Internet and other packet switched network transmission e.g. TCP IP UDP IP HTML HTTP NFC represent examples of the state of the art. Such standards are from time to time superseded by faster or more efficient equivalents having essentially the same functions. Wireless standards for device detection e.g. RFID short range communications e.g. Bluetooth WiFi Zigbee NFC and long range communications e.g. WiMAX GSM CDMA LTE can be used by computer system .

The illustrations of embodiments described herein are intended to provide a general understanding of the structure of various embodiments and they are not intended to serve as a complete description of all the elements and features of apparatus and systems that might make use of the structures described herein. Many other embodiments will be apparent to those of skill in the art upon reviewing the above description. The exemplary embodiments can include combinations of features and or steps from multiple embodiments. Other embodiments may be utilized and derived therefrom such that structural and logical substitutions and changes may be made without departing from the scope of this disclosure. Figures are also merely representational and may not be drawn to scale. Certain proportions thereof may be exaggerated while others may be minimized. Accordingly the specification and drawings are to be regarded in an illustrative rather than a restrictive sense.

Although specific embodiments have been illustrated and described herein it should be appreciated that any arrangement calculated to achieve the same purpose may be substituted for the specific embodiments shown. This disclosure is intended to cover any and all adaptations or variations of various embodiments. Combinations of the above embodiments and other embodiments not specifically described herein can be used in the subject disclosure. In one or more embodiments features that are positively recited can also be excluded from the embodiment with or without replacement by another component or step. The steps or functions described with respect to the exemplary processes or methods can be performed in any order. The steps or functions described with respect to the exemplary processes or methods can be performed alone or in combination with other steps or functions from other embodiments or from other steps that have not been described . Less than all of the steps or functions described with respect to the exemplary processes or methods can also be performed in one or more of the exemplary embodiments. Further the use of numerical terms to describe a device component step or function such as first second third and so forth is not intended to describe an order or function unless expressly stated so. The use of the terms first second third and so forth is generally to distinguish between devices components steps or functions unless expressly stated otherwise. Additionally one or more devices or components described with respect to the exemplary embodiments can facilitate one or more functions where the facilitating e.g. facilitating access or facilitating establishing a connection can include less than every step needed to perform the function or can include all of the steps needed to perform the function.

The Abstract of the Disclosure is provided with the understanding that it will not be used to interpret or limit the scope or meaning of the claims. In addition in the foregoing Detailed Description it can be seen that various features are grouped together in a single embodiment for the purpose of streamlining the disclosure. This method of disclosure is not to be interpreted as reflecting an intention that the claimed embodiments require more features than are expressly recited in each claim. Rather as the following claims reflect inventive subject matter lies in less than all features of a single disclosed embodiment. Thus the following claims are hereby incorporated into the Detailed Description with each claim standing on its own as a separately claimed subject matter.

