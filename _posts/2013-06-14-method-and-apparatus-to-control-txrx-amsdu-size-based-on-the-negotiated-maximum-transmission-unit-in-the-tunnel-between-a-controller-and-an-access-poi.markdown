---

title: Method and apparatus to control TX/RX AMSDU size based on the negotiated maximum transmission unit in the tunnel between a controller and an access point
abstract: A method includes selecting upstream and downstream aggregated MAC service data unit (AMSDU) sizes for communications between a client device, an access point, and an controller in a network system. The upstream and downstream AMSDU sizes may be separately selected based on the maximum transmission unit (MTU) size for communications in a secure tunnel between the controller and the access point to avoid fragmentation and reassembly of AMSDUs transmitted in a single MTU. The upstream and downstream AMSDU sizes may be selected to be less or equal to the MTU size.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09154432&OS=09154432&RS=09154432
owner: Hewlett-Packard Development Company, L.P.
number: 09154432
owner_city: Houston
owner_country: US
publication_date: 20130614
---
The present disclosure relates to selecting aggregated MAC service data unit AMSDU sizes for communications between a client device an access point and a controller based on a maximum transmission unit MTU size for communications in a secure tunnel between the controller and the access point.

Over the last decade there has been a substantial increase in the use and deployment of wireless client devices from dual mode smartphones to tablets capable of operating in accordance with a particular Institute of Electrical and Electronics Engineers IEEE standard. With wireless becoming the de facto medium for connectivity among users it has become increasingly important for network systems to intelligently manage connections.

In some systems wireless client devices may connect with an access point over a wireless connection to transfer and receive data. In upstream communications the wireless client devices aggregate packets into aggregated MAC service data units AMSDUs for transmission to the access point. Similarly in downstream communications the wireless client devices deaggregate packets transmitted in AMSDUs from the access point.

In some systems the access point may establish a tunnel with a controller to enable centralized security thereby eliminating packet tampering in intermediate devices. In transmissions through the tunnel AMSDUs may be fragmented such that they may be transmitted in maximum transmission units MTUs . This fragmentation may lead to a reduction of performance for a datapath between the client device the controller and the access point as a result of significant processing and delay overhead.

The approaches described in this section are approaches that could be pursued but not necessarily approaches that have been previously conceived or pursued. Therefore unless otherwise indicated it should not be assumed that any of the approaches described in this section qualify as prior art merely by virtue of their inclusion in this section.

In the following description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding. One or more embodiments may be practiced without these specific details. Features described in one embodiment may be combined with features described in a different embodiment. In some examples well known structures and devices are described with reference to a block diagram form in order to avoid unnecessarily obscuring the present invention.

Herein certain terminology is used to describe features for embodiments of the disclosure. For example the term digital device generally refers to any hardware device that includes processing circuitry running at least one process adapted to control the flow of traffic into the device. Examples of digital devices include a computer a tablet a laptop a desktop a netbook a server a web server authentication server an authentication authorization accounting AAA server a Domain Name System DNS server a Dynamic Host Configuration Protocol DHCP server an Internet Protocol IP server a Virtual Private Network VPN server a network policy server a mainframe a television a content receiver a set top box a video gaming console a television peripheral a printer a mobile handset a smartphone a personal digital assistant PDA a wireless receiver and or transmitter an access point a base station a communication management device a router a switch and or a controller.

It is contemplated that a digital device may include hardware logic such as one or more of the following i processing circuitry ii one or more communication interfaces such as a radio e.g. component that handles the wireless data transmission reception and or a physical connector to support wired connectivity and or iii a non transitory computer readable storage medium e.g. a programmable circuit a semiconductor memory such as a volatile memory and or random access memory RAM or non volatile memory such as read only memory power backed RAM flash memory phase change memory or the like a hard disk drive an optical disc drive etc. or any connector for receiving a portable memory device such as a Universal Serial Bus USB flash drive portable hard disk drive or the like.

Herein the terms logic or logic unit are generally defined as hardware and or software. For example as hardware logic may include a processor e.g. a microcontroller a microprocessor a CPU core a programmable gate array an application specific integrated circuit etc. semiconductor memory combinatorial logic or the like. As software logic may be one or more software modules such as executable code in the form of an executable application an application programming interface API a subroutine a function a procedure an object method implementation an applet a servlet a routine source code object code a shared library dynamic load library or one or more instructions. These software modules may be stored in any type of a suitable non transitory storage medium or transitory computer readable transmission medium e.g. electrical optical acoustical or other form of propagated signals such as carrier waves infrared signals or digital signals .

Lastly the terms or and and or as used herein are to be interpreted as inclusive or meaning any one or any combination. Therefore A B or C or A B and or C mean any of the following A B C A and B A and C B and C A B and C. An exception to this definition will occur only when a combination of elements functions steps or acts are in some way inherently mutually exclusive.

In one embodiment as shown in the client device A may be a network device that comprises one or more of a hardware processor data storage an input output I O interface and device configuration logic . Other client devices within system may be configured similarly or differently than the client device A shown in .

The data storage of the client device A may include a fast read write memory for storing programs and data during client device A s operations and a hierarchy of persistent memory such as Read Only Memory ROM Erasable Programmable Read Only Memory EPROM and or Flash memory for example for storing instructions and data needed for the startup and or operations of the client device A. The data storage may store data that is to be transmitted from the client device A or data that is received by the client device A. In an embodiment the data storage is a distributed set of data storage components.

In one embodiment the I O interface corresponds to one or more components used for communicating with other devices e.g. the access point via wired or wireless signals. The I O interface may include a wired network interface such as an IEEE 802.3 Ethernet interface and or a wireless interface such as an IEEE 802.11 WiFi interface. The I O interface may communicate with the access point over corresponding wireless channels in the system . The I O interface may include one or more antennas for communicating with the access point and other wireless devices in the network system . For example multiple antennas may be used for forming transmission beams to the access point through adjustment of gain and phase values for corresponding antenna transmissions. The generated beams may avoid objects and create an unobstructed path to the access point .

In one embodiment the hardware processor is coupled to the data storage and the I O interface . The hardware processor may be any processing device including but not limited to a MIPS ARM class processor a microprocessor a digital signal processor an application specific integrated circuit a microcontroller a state machine or any type of programmable logic array.

In one embodiment the device configuration logic includes one or more functional units implemented using firmware hardware software or a combination thereof for configuring parameters associated with the access point and the client device A. In one embodiment the device configuration logic may be configured to adjust the size of aggregated MAC service data units AMSDUs transmitted between the client device A and the access point based on the maximum transmission unit MTU size for communications in a secure tunnel between the controller and the access point as will be described in further detail below.

The access point may be any device that can associate with the client devices to transmit and receive data over the wireless channels . For example the access point may facilitate the transfer of data 1 from the client devices to the remote devices and or 2 to the client devices from the remote devices . In one embodiment the access point may correspond to a network device such as a wireless access point a switch a router or any combination thereof. For example the access point may be a router or any device that may be configured as a hotspot e.g. a cell phone a tablet a laptop etc. . The access point may be communicatively coupled to other networks such as network to send and receive data to the remote devices . The data may include for example web data video data and or voice data. In one embodiment the access point is a digital device that includes a hardware processor memory hierarchy and input output I O interfaces including a wireless interface such as an IEEE 802.11 wireless interface. In one embodiment the configuration of the components within the access point may be similar to those discussed above in relation to the client device A.

In one embodiment the controller is coupled to the network through a wireless or wired connection that facilitates the transfer of data between the access point and the controller . In one embodiment the controller and the access point may establish a tunnel for enabling centralized security thereby eliminating any packet tampering in intermediate devices. The tunnel may be implemented using any protocol suite for securing the transmission of packets through the use of authentication and encryption operations.

In one embodiment the controller may correspond to a network device such as a switch a router or any combination thereof. In one embodiment the controller is a digital device that includes a hardware processor memory hierarchy and input output I O interfaces including a wired interface such as an IEEE 802.3 interface and or wireless interface such as an IEEE 802.11 interface. In one embodiment the configuration of the components within the controller may be similar to those discussed above in relation to the client device A.

In one embodiment the access point the controller and the remote devices are coupled to the network . The network may be any network capable of transferring data between the access point the controller and the remote devices . For example the network may include one or more wired or wireless routers switches and other digital networking devices that operate using one or more protocols e.g. IEEE 802.3 and IEEE 802.11 .

The remote devices may be any wireless or wired electronic devices capable of receiving and transmitting video or other data streams such as personal computers laptop computers netbook computers wireless music players portable telephone communication devices smart phones tablets and digital televisions. In one embodiment the remote devices are digital devices that include a hardware processor memory hierarchy and input output I O interfaces including a wired and or wireless interface such as an IEEE 802.3 interface. In one embodiment the configuration of the components within the remote devices may be similar to those discussed above in relation to the client device A.

The client device A may aggregate two or more data packets into an upstream aggregated MAC service data unit AMSDU . The size of the upstream AMSDU may be negotiated by the client device and the access point . For example the upstream AMSDU size may be set to one of 3895 bytes 7991 bytes and 11454 bytes. In one embodiment the upstream AMSDU size is determined based on the maximum transmission unit MTU size between the access point and the controller . In one embodiment the upstream AMSDU size may be set to be less than or equal to the MTU size for the secure tunnel between the access point and the controller . For example when the MTU size between the access point and the controller is 9000 bytes the upstream AMSDU size may be set to either 3895 bytes or 7991 bytes.

The client device may thereafter perform authentication and encryption operations on the AMSDU frame using shared authentication and security information with the controller . Authentication and encryption operations ensure that the AMSDU is not compromised while being transferred over the wireless channels to the access point . Any form of authentication and encryption may be used by the client device .

Following the aggregation of packets into an AMSDU frame and possible encryption of the AMSDU the client device A may aggregate two or more AMSDUs into an aggregated MAC protocol data unit AMPDU . The AMPDU may be transmitted over the wireless channels to the access point . The access point deaggregates the AMPDU into the original AMSDUs and transmits the AMSDUs to the controller . In one embodiment described above the upstream AMSDU size is set to be less than or equal to the MTU size of the tunnel between the access point and the controller . In this embodiment a single AMSDU may be transmitted through the tunnel without fragmentation of the AMSDU since the size of the AMSDU is less than or equal to the size of the MTU for the tunnel between the access point and the controller . By eliminating fragmentation of AMSDUs during transmission between the access point and the controller performance of the upstream datapath is improved through the elimination of fragmentation processing delays. In one embodiment the upstream AMSDU size is determined through negotiations between the client device A and the access point . The upstream AMSDU size may be periodically updated upon the detection of a changed MTU size.

Upon receipt the controller may decrypt the AMSDU using the authentication and security information shared with the client device A. The controller may thereafter deaggregate the AMSDU into two or more data packets. The data packets may thereafter be transmitted to the remote device A through the external network . The transmission may use any suitable protocol including the Transmission Control Protocol Internet Protocol standards.

The remote device A transmits the data packets to the controller through the external network . The transmission may use any suitable protocol including the Transmission Control Protocol Internet Protocol standards.

The controller may aggregate two or more encrypted data packets into a downstream AMSDU. The size of the downstream AMSDUs may be negotiated by the client device and the access point in a similar fashion as described above in relation to the upstream AMSDUs. For example the downstream AMSDU size may be set to one of 3895 bytes 7991 bytes and 11454 bytes. In one embodiment the downstream AMSDU size is determined based on the MTU size between the access point and the controller . In one embodiment the downstream AMSDU size may be set to be less than or equal to the MTU size for the secure tunnel between the access point and the controller . For example when the MTU size between the access point and the controller is 9000 bytes the downstream AMSDU size may be set to either 3895 bytes or 7991 bytes. Although both the upstream and downstream AMSDU sizes may be set based on the MTU size in some embodiments the upstream and downstream AMSDU sizes are distinct and different. For example when the MTU size between the access point and the controller is 9000 bytes the upstream AMSDU size may be set to 3895 bytes and the downstream AMSDU size may be set to 7991 bytes.

In one embodiment the controller may perform authentication and encryption operations on each AMSDU using authentication and security information shared with the client device A. Authentication and encryption operations ensure that the data packets are not compromised while being transferred over the wireless channels to the client device A. Any form of authentication and encryption may be used by the controller .

Following the aggregation of data packets and possible encryption of the AMSDU each downstream AMSDU may be transmitted to the access point through the secure tunnel. Since the size of the downstream AMSDU is less than or equal to the size of the MTU fragmentation of the AMSDUs does not occur. By eliminating fragmentation of AMSDUs during transmission between the controller and the access point performance of the downstream datapath is improved through the elimination of fragmentation processing delays.

Upon receipt the access point may aggregate two or more AMSDUs into an AMPDU and transmit the AMPDU over the wireless channels to the client device A. Following receipt the client device A may deaggregate the AMPDU into the original two or more AMSDUs. Each AMSDU may be decrypted using the authentication and security information shared between the controller and the client device A. The decrypted AMSDU may be deaggregated into two or more data packets. The data packets may thereafter be processed by one or more applications running on the hardware processor and or stored in the data storage of the client device A.

As described above the upstream and downstream AMSDUs sizes are determined based on the MTU size for the secure tunnel between the access point and the controller . shows a method for determining the upstream and downstream AMSDUs sizes for communications between the client devices the access point and the controller according to one embodiment. The method may be performed by one or more elements of the network system . For example in one embodiment each of the client devices perform the operation of the method in conjunction with the access point .

In one embodiment the method begins at operation with the controller and the access point negotiating an MTU size for the secure tunnel between the access point and the controller . In one embodiment the MTU size may be negotiated to be one of 6000 bytes and 9000 bytes. The MTU size may be determined based on the capabilities and configuration of the networking devices within the network .

Upon determining negotiating a MTU size operations and select upstream and downstream AMSDU sizes respectively. In one embodiment the upstream and downstream AMSDU sizes are selected based on the MTU size between the access point and the controller which was determined at operation . In one embodiment the upstream and downstream AMSDU sizes may be each selected to be less than or equal to the MTU size for the secure tunnel between the access point and the controller . For example when the MTU size between the access point and the controller is 9000 bytes the upstream and downstream AMSDU sizes may be set to either 3895 bytes or 7991 bytes. Although both the upstream and downstream AMSDU sizes may be set based on the MTU size in some embodiments the upstream and downstream AMSDU sizes are distinct and different. For example when the MTU size between the access point and the controller is 9000 bytes the upstream AMSDU size may be set to 3895 bytes and the downstream AMSDU size may be set to 7991 bytes.

The selected AMSDU sizes may be utilized for upstream and downstream communications between the client devices and the remote devices . At operation the method determines detects if a new MTU size has been set between the access point and the controller . If a new MTU size is detected the method moves back to operations and to select new upstream and downstream AMSDU sizes respectively. As described above the upstream and downstream AMSDU sizes are selected based on the MTU size between the access point and the controller . In one embodiment the upstream and downstream AMSDU sizes may be set to be less than or equal to the MTU size for the secure tunnel between the access point and the controller . By setting the upstream and downstream AMSDU sizes to be less than or equal to the MTU size each AMSDU may be transported in a single MTU without fragmentation. By eliminating fragmentation of AMSDUs during transmission between the access point and the controller performance of the upstream and downstream datapaths are improved through the elimination of fragmentation processing delays.

An embodiment of the invention may be an article of manufacture in which a machine readable medium such as microelectronic memory has stored thereon instructions which program one or more data processing components generically referred to here as a processor to perform the operations described above. In other embodiments some of these operations might be performed by specific hardware components that contain hardwired logic e.g. dedicated digital filter blocks and state machines . Those operations might alternatively be performed by any combination of programmed data processing components and fixed hardwired circuit components. Also although the discussion focuses on uplink medium control with respect to frame aggregation it is contemplated that control of other types of messages are applicable.

Any combination of the above features and functionalities may used in accordance with one or more embodiments. In the foregoing specification embodiments have been described with reference to numerous specific details that may vary from implementation to implementation. The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense. The sole and exclusive indicator of the scope of the invention and what is intended by the applicants to be the scope of the invention is the literal and equivalent scope of the set of claims that issue from this application in the specific form in which such claims issue including any subsequent correction.

