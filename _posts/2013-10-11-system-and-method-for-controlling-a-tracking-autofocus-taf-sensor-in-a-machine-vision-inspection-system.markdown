---

title: System and method for controlling a tracking autofocus (TAF) sensor in a machine vision inspection system
abstract: A method is provided for controlling a Tracking AutoFocus (TAF) portion of a machine vision inspection system including an imaging portion, a movable workpiece stage, a control portion, and graphical user interface (GUI). The TAF portion automatically adjusts a focus position of the imaging portion to focus at a Z height corresponding to a current surface height of the workpiece. The method includes providing the TAF portion, and providing TAF enable and disable operations, wherein: the TAF disable operations comprise a first set of TAF automatic interrupt operations that are automatically triggered by user-initiated operations that include changing the Z height, and the TAF disable operations may further comprise automatic interrupt operations that are automatically triggered based on at least one respective TAF Z height surface tracking characteristic exceeding a previously set TAF disable limit for that respective TAF Z height surface tracking characteristic.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09444995&OS=09444995&RS=09444995
owner: Mitutoyo Corporation
number: 09444995
owner_city: Kanagawa-ken
owner_country: JP
publication_date: 20131011
---
The invention relates generally to machine vision inspection systems and more particularly to systems and computer implemented methods for controlling a Tracking AutoFocus TAF sensor in a machine vision inspection system.

Precision machine vision inspection systems or vision systems for short can be utilized to obtain precise dimensional measurements of inspected objects and to inspect various other object characteristics. Such systems may include a computer a camera and optical system and a precision workstage that is movable in multiple directions to allow the camera to scan the features of a workpiece that is being inspected. One exemplary prior art system that is commercially available is the QUICK VISION series of PC based vision systems and QVPAK software available from Mitutoyo America Corporation MAC located in Aurora Ill. The features and operation of the QUICK VISION series of vision systems and the QVPAK software are generally described for example in the QVPAK 3D CNC Vision Measuring Machine User s Guide published January 2003 and the QVPAK 3D CNC Vision Measuring Machine Operation Guide published September 1996 each of which is hereby incorporated by reference in their entirety. This series of products for example is able to use a microscope type optical system to provide images of a workpiece at various magnifications and move the stage as necessary to traverse the workpiece surface beyond the limits of any single video image. A single video image typically encompasses only a portion of the workpiece being observed or inspected given the desired magnification measurement resolution and physical size limitations of such systems.

Machine vision inspection systems generally utilize automated video inspection. U.S. Pat. No. 6 542 180 the 180 patent teaches various aspects of such automated video inspection and is incorporated herein by reference in its entirety. As taught in the 180 patent automated video inspection metrology instruments generally have a programming capability that allows an automatic inspection event sequence to be defined by the user for each particular workpiece configuration. This can be implemented by text based programming for example or through a recording mode which progressively learns the inspection event sequence by storing a sequence of machine control instructions corresponding to a sequence of inspection operations performed by a user with the aid of a graphical user interface GUI or through a combination of both methods. Such a recording mode is often referred to as learn mode or training mode. Once the inspection event sequence is defined in learn mode such a sequence can then be used to automatically acquire and additionally analyze or inspect images of a workpiece during run mode. 

The machine control instructions including the specific inspection event sequence i.e. how to acquire each image and how to analyze inspect each acquired image are generally stored as a part program or workpiece program that is specific to the particular workpiece configuration. For example a part program defines how to acquire each image such as how to position the camera relative to the workpiece at what lighting level at what magnification level etc. Further the part program defines how to analyze inspect an acquired image for example by using one or more video tools such as edge boundary detection video tools.

Video tools or tools for short and other GUI features may be set up manually to accomplish inspection and or other machine control operations. Video tools set up parameters and operations can also be recorded during learn mode in order to create automatic inspection programs or part programs which incorporate measurement analytical operations to be performed by various video tools. Video tools may include for example edge boundary detection tools autofocus tools shape or pattern matching tools dimension measuring tools and the like. Other GUI features may include dialog boxes related to data analysis step and repeat loop programming as disclosed for example in U.S. Pat. No. 8 271 895 which is incorporated herein by reference in its entirety etc. For example such tools and GUI features are routinely used in a variety of commercially available machine vision inspection systems such as the QUICK VISION series of vision systems and the associated QVPAK software discussed above.

Machine vision inspection systems are known to incorporate various types of focus measurement in automated video inspection for controlling continuous auto focus and or for making surface height measurements. Generally there are two types of focus measurement image based focus measurement and signal based focus measurement. The image based focus measurement is based on analysis of the contrast in acquired images. For a given field of view the highest contrast image generally corresponds to the best focused image. A surface height measurement may be inferred from the best focused image position since the camera object distance corresponding to any image is generally known in machine vision inspection systems.

The signal based focus measurement is based on the use of an auxiliary focus sensor that does not rely on the images of the machine vision inspection system for determining the best focus position or surface height. Various types of auxiliary focus sensors are known including triangulation sensors knife edge focus sensors chromatic confocal sensors Shack Hartmann type wavefront sensors etc. as described in U.S. Pat. Nos. 4 336 997 4 950 878 6 184 974 7 301 133 7 723 657 and 7 728 961 which are incorporated by reference herein. Generally auxiliary focus sensors perform focus measurement by receiving optical signals from an object converting them to electrical signals and comparing them with a reference signal corresponding to the best focus zero position or a workpiece object surface height. Thus by determining that an obtained electrical signal is above or below the reference signal by how much it can be determined that an image is out of focus in a positive or a negative direction by how much along the optical e.g. vertical axis relative to the best focus zero position of the object lens. Typically the signal based focus measurement is faster than the image based focus measurement and thus is suited for application in a Tracking AutoFocus TAF sensor that is configured to continuously and automatically maintain focus in a vision system in real time.

The present invention is directed to providing an improved system GUI and computer implemented method for controlling a TAF sensor in a machine vision inspection system.

This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This summary is not intended to identify key features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

In various embodiments a method is provided for controlling operation of a Tracking AutoFocus TAF portion of a machine vision inspection system including an imaging portion a movable stage for holding one or more workpieces in a field of view of the imaging portion a control portion and graphical user interface GUI . The TAF portion operates to automatically adjust a focus position of the imaging portion to focus at a Z height corresponding to a current surface height of the workpiece in the field of view. The method includes step A of providing the TAF portion which includes a focus sensor and a motion control portion that is responsive to a focus signal derived from the focus sensor to focus the imaging portion at the Z height corresponding to the current surface height when TAF is enabled. The method also includes step B of providing TAF enable and disable operations wherein B1 the TAF disable operations include a first set of TAF automatic interrupt operations that are automatically triggered by user initiated operations that include changing the Z height. For example when a user performs an explicit Z height adjustment operation to move the imaging portion relative to the movable stage along the Z axis this triggers the first set of TAF automatic interrupt operations to for example disable the TAF portion i.e. to terminate TAF adjustments of the Z height TAF disabled mode . In various embodiments once the first set of TAF automatic interrupt operations is triggered to disable the TAF portion there are no conditions under which the TAF portion automatically resumes Z height adjustments without a user initiated instruction which restarts TAF Z height control operations. The first set of TAF automatic interrupt operations are useful because user initiated operations that include changing the Z height may likely exceed the TAF portion s capability to automatically adjust to the new user defined Z height to continue maintaining focus at that new Z height.

In some embodiments in addition to the first set of TAF automatic interrupt operations described above B2 the TAF disable operations may further comprise a second set of TAF automatic interrupt operations that are automatically triggered based on at least one respective TAF Z height surface tracking characteristic exceeding a previously set TAF disable limit for that respective TAF Z height surface tracking characteristic. For example the at least one respective TAF Z height surface tracking characteristic may be the Z height as controlled by the TAF portion and the previously set TAF disable limit for that TAF Z height surface tracking characteristic may be an relative Z height limit defined relative to a current baseline Z height. More generally in various embodiments the at least one respective TAF Z height surface tracking characteristic may comprise at least one of a the Z height as controlled by the TAF portion b the rate of change of the Z height as a function of time and c the rate of change of the Z height as a function of distance along an X Y direction d a surface tracking error comprising a difference between the current Z height at a current XY position and an indication of the required TAF focus Z height at the current XY position and e a TAF deviation signal that is indicative of a difference between the current Z height at a current XY position and the required TAF focus Z height at the current XY position and the previously set TAF disable limit for that TAF Z height surface tracking characteristic may comprise at least one of f an absolute Z height limit g a relative Z height limit defined relative to a current baseline Z height of the TAF portion h a limit on the rate of change of the Z height as a function of time i a limit on the rate of change of the Z height as a function of distance along an X Y direction j a limit on the surface tracking error and k a limit on the TAF deviation signal. In this connection a TAF disable limit definition element may be provided in the GUI to permit a user to define the previously set TAF disable limit. When a user sets the relative Z height limit as 0.4 mm and 0.2 mm for example and when the Z height measured by the TAF portion becomes more than 0.4 mm higher than or more than 0.2 mm lower than the baseline Z height this triggers the second set of TAF automatic interrupt operations. In various embodiments the second set of TAF automatic interrupt operations include a TAF holding mode wherein the TAF adjustments of the height are discontinued but if the TAF Z height surface tracking characteristic returns below the previously set TAF disable limit during the TAF holding mode then TAF Z height adjustments are automatically resumed without a user initiated instruction. Continuing the above described example after the vision inspection system enters into TAF holding mode upon detecting the Z height that exceeds the relative Z height limit when it is detected that the relative Z height returns below the relative Z height limit during the TAF holding mode then TAF Z height adjustments are automatically resumed without a user initiated instruction.

The second set of TAF automatic interrupt operations including TAF holding mode are useful for example when the vision inspection system is used to inspect a workpiece including holes or bosses wherein oftentimes what needs to be inspected is an edge of each hole or a boss as opposed to the bottom surface of each hole or the top surface of the boss. Then it is useful to suspend operation of the TAF portion in the hole or on the boss to maintain focus at the edges. Specifically if the TAF portion remains enabled after it traverses a first edge of a hole i.e. a falling edge the TAF portion operates to attempt to focus the imaging portion at the bottom surface of the hole which enters the field of view and when it next traverses a second edge of the same hole i.e. a rising edge the TAF portion must quickly adjust the focus back to the original surface height in order to obtain a well focused image of the top rising edge. However this may be difficult to achieve in a timely manner especially when the hole is deep or when the hardware e.g. a camera system that needs to be moved to effect the adjustment is massive. The second set of TAF automatic interrupt operations including the TAF holding mode are useful in allowing to selectively suspend or hold operation of the TAF portion so as to maintain focus on the edges of interest and maintain high throughput especially at large surface discontinuities at edges found in a workpiece.

According to another aspect of the inventions the GUI of the machine vision inspection system includes a part program editing window including part program instruction representations displayed during learn mode operations of the machine vision inspections system. A user may program various TAF related operations including TAF enable and disable operations in the part program editing window.

In accordance with further embodiments a computer readable non transitory medium is provided which includes computer executable instructions configured to be loaded onto a computer to control a machine vision inspection system. The machine vision inspection system includes an imaging portion a movable stage for holding one or more workpieces in a field of view of the imaging portion and a Tracking AutoFocus TAF portion that operates to automatically adjust a focus position of the imaging portion to focus at a Z height corresponding to a current surface height of the workpiece in the field of view. The TAF portion includes a focus sensor and a motion control portion that is responsive to a focus signal derived from the focus sensor to focus the imaging portion at the Z height corresponding to the current surface height when TAF is enabled. The machine vision inspection system further includes a graphical user interface GUI . The GUI under control of the computer executable instructions operates to display instruction representations corresponding to TAF enable and disable operations in a part program editing window including part program instruction representations displayed during learn mode operations of the machine vision inspection system. The TAF disable operations include a first set of TAF automatic interrupt operations that are automatically triggered by user initiated operations that include changing the Z height.

In accordance with still further embodiments a machine vision inspection system is provided including an imaging portion a movable stage for holding one or more workpieces in a field of view of the imaging portion a control portion and a Tracking AutoFocus TAF portion that operates to automatically adjust a focus position of the imaging portion to focus at a Z height corresponding to a current surface height of the workpiece in the field of view. The TAF portion includes a focus sensor and a motion control portion that is responsive to a focus signal derived from the focus sensor to focus the imaging portion at the Z height corresponding to the current surface height when TAF is enabled. The machine vision inspection system further includes a graphical user interface GUI . The control portion of the machine vision inspection system is configured to provide TAF enable and disable operations wherein the TAF disable operations include a first set of TAF automatic interrupt operations that are automatically triggered by user initiated operations that include changing the Z height.

The vision measuring machine includes a moveable workpiece stage and an optical imaging system . The machine vision inspection system is generally comparable to the QUICK VISION series of vision systems and the QVPAK software discussed above and similar state of the art commercially available precision machine vision inspection systems. The machine vision inspection system is also described in commonly assigned U.S. Pat. Nos. 7 454 053 7 324 682 8 111 938 and 8 111 905 which are each incorporated herein by reference.

A workpiece or a tray or fixture holding a plurality of workpieces which is to be imaged using the machine vision inspection system is placed on the workpiece stage . The workpiece stage may be controlled to move relative to the imaging portion such that the objective lens moves between locations on a workpiece and or among a plurality of workpieces . One or more of a stage light a coaxial light and a surface light may emit source light or respectively to illuminate the workpiece or workpieces . The source light is reflected or transmitted as workpiece light which passes through the objective lens and the turret lens assembly and is gathered by the camera system . The image of the workpiece s captured by the camera system is output on a signal line to the control system portion . The light sources and may be connected to the control system portion through signal lines or busses and respectively. To alter the image magnification the control system portion may rotate the turret lens assembly along axis to select a turret lens through a signal line or bus .

In various exemplary embodiments the imaging portion is movable in the vertical Z axis direction relative to the workpiece stage using a controllable motor that drives an actuator a connecting cable or the like to move the imaging portion along the Z axis to change the focus of the image of the workpiece captured by the camera system . The term Z axis as used herein refers to the axis that is intended to be used for focusing the image obtained by the imaging portion . The controllable motor is connected to the input output interface via a signal line .

The motion control portion is configured to make automatic adjustment necessary to align the nominal focus plane FP of the objective lens with the workpiece surface so as to maintain focus for the imaging portion based on the focus signal derived from the focus sensor . In the objective lens provides a workpiece inspection image via image light transmitted through the second beamsplitting surface to the camera system . The objective lens also provides a reflected beam to be reflected from the second beamsplitting surface along the optical axis OA of the TAF portion toward the focus sensor . In operation radiation from the illumination source is input to collimation lens which outputs an illumination beam to the first beamsplitting surface which outputs and deflects it to be input to the second beamsplitting surface which outputs and deflects it to the objective lens . The objective lens inputs the illumination beam and focuses it at the nominal focus plane FP along the optical axis OA. The nominal focus plane FP is located at a distance ZNOM from a reference plane REF that is fixed relative to the objective lens .

The workpiece surface may be located along the optical axis OA at a sensed distance ZNOM Z as shown in . The workpiece surface reflects the focused illumination beam to provide a reflected beam . The objective lens receives and transmits the reflected beam . The transmitted reflected beam is then input to the second beamsplitting surface which outputs and deflects it to the first beamsplitting surface which outputs it along the optical axis OA to be input to the focus sensor .

The focus sensor may be based on any of the various auxiliary focus sensor techniques described above such as the knife edge focus technique chromatic confocal technique and Shack Hartmann type of wavefront sensing technique. The focus sensor is capable of receiving optical signals e.g. the transmitted reflected beam from the object i.e. the workpiece surface and converting them to electrical signals e.g. in voltage V and comparing them with a reference signal corresponding to the best focus zero position or surface height corresponding to the nominal focus plane FP as shown in a graph for example. Specifically when V is determined to be positive or negative the workpiece surface generating the reflected beam is determined to be at a distance Z away from the objective lens or at a distance Z closer to the objective lens relative to the nominal focus plane FP. In the example of the workpiece surface is illustrated at a position that is separated by Z from the focus plane FP in the Z positive direction. Based on the focus signal derived from the focus sensor the motion control portion may make necessary adjustment to focus the imaging portion at the Z height corresponding to the current surface height . To that end in the illustrated example the motion control portion may move the objective lens by Z in the Z positive direction along the optical axis may move a workpiece stage not shown supporting the workpiece surface by Z in the Z negative direction along the optical axis or may move both the objective lens and the workpiece stage supporting the workpiece surface so as to align the nominal focus plane FP with the workpiece surface . In this connection the motion control portion may control the controllable motor see to actuate the objective lens and or control a suitable linear actuator and a linear encoder to focus the imaging portion at the current surface height .

In yet another example the imaging portion may further include a collimation adjustment element and the motion control portion may control the collimation adjustment element based on the focus signal derived from the focus sensor to provide an amount of collimation adjustment to the illumination beam so as to focus the imaging portion at the Z height corresponding to the current surface height . The collimation adjustment element may be a variable focus lens that is electronically adjustable and may be provided between the first beamsplitting surface and the second beamsplitting surface .

In various embodiments the TAF portion is configured to apply a laser beam point LP at a current XY position of the current Z height so that an operator can visually verify the current XY position that the TAF portion is tracking. To that end a suitable laser beam source not shown is arranged.

As shown in the TAF portion may be fully or partially included in the vision components portion or may be fully or partially included in the control system portion see . The TAF portion may be partially included in the vision components portion for example when only the focus sensor is included in the vision components portion while the motion control portion is included in the control system portion . As will be apparent to those skilled in the art various operations regarding the TAF portion may be implemented by hardware configuration software configuration or a combination of hardware and software configuration and therefore various hardware and or software components and features of the TAF portion may be suitably arranged between the vision components portion and the control system portion of the machine vision inspection system depending on each implementation.

Still referring to in various exemplary embodiments the control system portion includes a controller a power supply portion an input output interface a memory a workpiece program part program generator and executor a recorder translator a learn mode executor a run mode executor an editing portion a node manager and part or a whole of the TAF portion . Each of these components as well as the additional components described below may be interconnected by one or more data control buses and or application programming interfaces or by direct connections between the various elements. As apparent to those skilled in the art any of these components may be merged together may consist of multiple sub components or any of their respective sub components may be merged together depending on each implementation.

The input output interface includes an imaging control interface a motion control interface a lighting control interface a lens control interface and TAF GUI elements . The TAF GUI elements are responsible for providing GUI for controlling and programming TAF operations such as TAF enable and TAF disable operations according to various embodiments of the present invention. The motion control interface may include a position control element and a speed acceleration control element although such elements may be merged and or indistinguishable. The lighting control interface controls for example the selection power intensity on off switch and strobe pulse timing if applicable for the various corresponding light sources of the machine vision inspection system .

The memory includes an image file memory portion a workpiece program memory portion that may include one or more part programs PP and a video tool portion . The video tool portion includes various video tools collectively each including the GUI and image processing operation defined to perform a specific function such as edge boundary detection tools image based autofocus tools shape or pattern matching tools e.g. circle tools and box tools and dimension measuring tools. Many known video tools are included in commercially available machine vision inspection systems such as the QUICK VISION series of vision systems and the associated QVPAK software discussed above. The video tool portion also includes a region of interest ROI generator that supports automatic semi automatic and or manual operations that define various ROIs that are operable in various video tools included in the video tool portion .

In general the memory portion stores data usable to operate the machine vision inspection system to acquire an image of the workpiece such that the acquired image has desired image characteristics. The memory portion may further store data usable to operate the machine vision inspection system to perform various inspection and measurement operations on the acquired image e.g. implemented in part as video tools and to output the measurement results through the input output interface . The memory portion may also contain data defining a graphical user interface GUI operable through the input output interface .

The signal lines or busses and of the stage light the coaxial light and the surface light respectively are all connected to the input output interface . The signal line of the camera system and the signal line of the controllable motor are connected to the input output interface . Referring additionally to signal lines A B and C for controlling the Z height of the objective lens the Z height of the workpiece stage and the variable focus of the collimation adjustment element respectively to focus the imaging portion at the current Z surface height may also be connected to the input output interface if the TAF motion control portion is included in the control system portion . In addition a signal input line into the TAF focus sensor may be connected to the input output interface if the focus sensor is included in the control system portion .

One or more display devices e.g. the display of and one or more input devices e.g. the joystick keyboard and mouse of can also be connected to the input output interface . The display devices and input devices can be used to display a GUI which may include various user interface features usable to create and or edit part programs including TAF enable and disable operations to monitor operation of the TAF portion to view the images captured by the camera system and or to directly control various components of the vision system components portion .

The workpiece program or part program generator and executor recorder translator learn mode executor run mode executor editing portion node manager and TAF portion may be considered to be part of a general machine controller block MC that is linked to the controller . The workpiece program generator and executor is responsible for creating and executing part programs or workpiece programs . Based on the operations of the workpiece program generator and executor a user utilizes the machine vision inspection system to create a part program for the workpiece either by explicitly coding the instructions automatically semi automatically or manually using a workpiece programming language and or by generating the instructions by operating the machine vision inspection system in a learn mode e.g. as controlled by the learn mode executor to provide a desired image acquisition training sequence. For example a training sequence may comprise positioning a workpiece feature in the field of view FOV setting light levels focusing or autofocusing acquiring an image and providing an inspection training sequence applied to the image e.g. using video tools . The learn mode operates such that the learned operation sequence s are recorded and converted to corresponding part program steps i.e. instructions . These part program steps when the part program is executed in a run mode e.g. as controlled by the run mode executor will cause the machine vision inspection system to reproduce the trained image acquisition and inspection operations to automatically inspect a workpiece or workpieces matching the workpiece used when creating the part program.

The recorder translator is utilized for translating machine operations into part program code. In other words if a user performs an action e.g. such as manually changing the Z height corresponding to the current surface height a basic instruction is generated that is translated into a machine readable language to form a part program and a reverse translation may also be performed. In various embodiments of the present invention user initiated operations that include changing the Z height in learn mode of operation are translated into part program code corresponding to editable instruction representations of disabling the TAF portion wherein such instruction representations e.g. Turn TAF Off may be displayed on a part program editing window GUI. The recorder translator may perform translation between the editable instruction representations and their corresponding code instructions. The editing portion provides or activates various operations and user interface features related to editing a part program. In one embodiment the node manager is responsible for managing node numbers that are assigned to nodes in a part program. In one implementation within a representation of a part program each of the instruction representations is assigned a node number. In certain implementations an organizational tree structure may be utilized that includes parent nodes and child nodes. In certain implementations every line of a part program representation that is generated by the recorder translator is assigned a node number by the node manager . The node numbers controlled by the node manager may be used for example to arrange the part program instruction representations including TAF enable and disable operations in a defined order according to various embodiments of the present invention as will be described below.

The TAF portion provides or activates various operations and user interface features such as those captured in the TAF GUI elements related to TAF functionality in a machine vision inspection system . illustrates one example configuration of the TAF portion and the TAF GUI elements according to some embodiments of the present application. The TAF portion includes a servo control portion A including a stage motion control B which in turn includes a Z height position speed sensor C and a X Y position speed sensor D. The TAF portion also includes a TAF sensor E which includes a signal deviation signal portion F a status signal portion G a limit processing portion H and a Z calibration portion I. In general the servo control portion A corresponds to the motion control portion of and is configured to focus the imaging portion at the Z height corresponding to the current surface height in response to a focus signal derived from the TAF sensor E which corresponds to the focus sensor of . Specifically based on the focus signal derived from the TAF sensor E the servo control portion A may actuate the imaging portion and or the workpiece stage . In the illustrated embodiment the servo control portion A may actuate the workpiece stage using the stage motion control in reference to feedback signals received from the Z height position speed sensor C and the X Y position speed sensor D which are respectively indicative of where the current Z height is and how fast the current Z height is changing and where the current X Y position is and how fast the current X Y position is changing.

The TAF sensor E is configured to generate electrical signals e.g. in voltage V that are indicative of a current focus status relative to a reference signal corresponding to the best focus e.g. V 0 position as schematically shown in the graph in . V can be converted to a corresponding current Z height such that for example when V is determined to be positive or negative the current Z height at a current XY position is determined to be different by Z or Z relative to the required TAF focus Z height at the current XY position. The signal deviation signal portion F of the TAF sensor E is configured to generate a surface tracking error signal such as in voltage V which includes a difference between the current Z height at a current XY position and an indication of the required TAF focus Z height at the current XY position. Alternatively or additionally the signal deviation signal portion F may generate a TAF deviation signal such as in Z or Z which is indicative of the difference between the current Z height at a current XY position and the required TAF focus Z height at the current XY position.

The status signal portion G of the TAF sensor E is configured to generate signals indicative of different states or operation modes of TAF at least some of which may be entered into based on the surface tracking error or TAF deviation signal generated by the signal deviation signal portion F in various embodiments. For example according to various exemplary embodiments of the present invention a second set of TAF automatic interrupt operations including TAF holding mode are automatically triggered based on a TAF Z height surface tracking characteristic e.g. a surface tracking error exceeding a previously set TAF disable limit. As used herein the holding mode means a TAF operation mode in which TAF is on but is suspended such that the signal deviation signal portion F is generating a focus signal e.g. a surface tracking error signal in V but the focus signal is not used by the servo control portion A to focus the imaging portion at the Z height corresponding to the current surface height. That is TAF Z height adjustments are suspended and not performed during the holding mode. If the TAF portion is configured to apply a laser beam point LP at its focus tracked XY position see the LP is on during the holding mode because a surface tracking error signal is generated but no active control of the Z height to maintain auto focus is performed. According to embodiments of the present invention the status signal portion G generates signals indicative of at least three different states of TAF TAF enabled or on TAF disabled or off and TAF suspended or holding mode. The TAF enabled or on mode means that TAF is on and is actively controlling the Z height to maintain focus and the laser beam point LP is visible. The TAF disabled or off mode means that TAF is off and is not actively controlling the Z height to maintain focus and not even generating a surface tracking error signal and the laser beam point LP is off. In various embodiments of the present invention user initiated operations that include changing the Z height of the machine vision inspection system automatically trigger the TAF disabled or off mode. The status signals generated by the status signal portion G are used to control the status message and its color as displayed on the GUI to inform an operator of the current operation state or mode of the TAF portion .

The limit processing portion H of the TAF sensor E is configured to input TAF Z height surface tracking characteristic limits e.g. a surface tracking error limit defined by an operator and to perform processing to compare the TAF Z height surface tracking characteristic derived from the TAF sensor E to the limits on a real time basis. For example when the operator defines the surface tracking error limit as V limit relative to a baseline V the limit processing portion H performs processing to compare the obtained surface tracking error signal in V to the previously set TAF disable limit to determine whether V is exceeding the limit i.e. whether it is beyond the V limit relative to the baseline V.

The Z calibration portion I of the TAF sensor E is configured to operate on a surface tracking error signal e.g. in voltage V or a TAF deviation signal in Z height deviation such as in Z or Z generated by the signal deviation signal portion F. Generally the Z calibration portion I performs processing necessary to calibrate the Z height dimension for a given magnification of the objective lens . For example for a low magnification objective lens a full scale TAF deviation signal corresponds to a large Z range while for a high magnification lens a full scale TAF deviation signal corresponds to a small Z range. This is because the focus is not so sensitive to Z at low magnification and thus the TAF deviation signal is likewise not so sensitive to Z. Conversely the focus is sensitive to Z at high magnification and thus the TAF deviation signal is likewise sensitive to Z. Therefore a different scale factor and hence a different Z calibration are preferably used for each lens for the purpose of most accurate operation. The Z calibration information generated by the Z calibration portion I is used by the limit processing portion H and the servo control portion A so as to adjust i.e. Z calibrate the TAF disable limit and to focus the imaging portion at the adjusted i.e. Z calibrated Z height corresponding to the current surface height. Although illustrated conceptually as part of the TAF Sensor E it will be understood that in some embodiments the Z calibration portion I and the limit processing portion H may be implemented in hardware and or software as a portion of the servo control portion A.

The TAF portion also includes the TAF enable disable portion J which is responsible for providing TAF enable TAF on and disable including TAF off and TAF holding operations according to various exemplary embodiments of the present invention. The TAF enable disable portion J includes a manual start stop portion K and an automatic interrupt Type 1 operation triggered portion L that includes a Z motion and or incompatible operation detection portion M and a Type 1 interrupt operations portion N. The TAF enable disable portion J also includes an automatic interrupt Type 2 TAF surface profile triggered portion O which in turn includes a TAF profile trigger definition s limit definition s portion P a TAF profile trigger limit detection portion Q and a Type 2 interrupt operations portion R. The Type 2 interrupt operations portion R includes a TAF suspension mode operations portion S which in turn includes a TAF suspension Z hold operations portion T and a TAF automatic resumption operations portion V. The TAF suspension Z hold operations portion T includes a baseline Z height operations portion U. Finally the TAF enable disable portion J also includes a program instruction generation operations portion W and a program instruction representation operations portion X.

The manual start stop portion K is operable to permit an operator to manually enable turn on or disable turn off the TAF sensor E and the servo control portion A to start or stop active TAF Z height adjustments. In this connection the manual start stop portion K may cooperate with the TAF GUI elements to display a TAF manual start stop selection element included in a selection bar of an example GUI as shown in . In the illustrated example the manual start stop selection element is a toggle switch that turns on and off the active Z height controlling function of the TAF portion each time an operator selects the manual start stop selection element .

The automatic interrupt Type 1 operation triggered portion L is responsible for providing a first set of TAF automatic interrupt operations Type 1 operations that are automatically triggered by user initiated operations that include changing the Z height. In various embodiments Type 1 operations terminate TAF adjustments of the Z height i.e. entering into TAF disabled or off mode wherein there are no conditions under which the TAF portion automatically resumes Z height adjustments without a user initiated instruction to restart Z height adjustments. For example unless an operator manually selects the manual start stop selection element described above in reference to to resume TAF adjustments of the Z height the TAF portion remains in TAF disabled or off mode. The automatic interrupt Type 1 operations are defined in the Type 1 interrupt operations portion N.

The first set Type 1 of TAF automatic interrupt operations are useful because user initiated operations that include changing the Z height may likely exceed the TAF portion s capability to automatically adjust to the new user defined Z height to continue maintaining focus at that new Z height. Examples of user initiated operations that include changing the Z height include an explicit Z height adjustment operation wherein an operator explicitly sets or adjusts the current Z height at via the input devices such as by entering a numeric Z height value using the keyboard or by physically moving the relative positions of the imaging portion and the workpiece stage using the joystick . Further examples of user initiated operations that include changing the Z height include operations associated with an image based autofocus video tool e.g. in that may be included in the machine vision inspection system . As described in the background section above machine vision inspection systems may include both image based autofocus video tools and signal based autofocus devices for controlling continuous autofocus. The TAF portion is an example of the signal based autofocus devices. The image based autofocus video tools are configured to maintain autofocus based on analysis of acquired images such as analysis of the contrast in acquired images. The operations associated with an image based autofocus video tool are likely to cause adjustments of the Z height as a result of the image analysis which may be incompatible with the adjustments of the Z height performed by the TAF portion . Thus in accordance with various embodiments of the present invention operations associated with an image based autofocus video tool are treated as the user initiated operations that include changing the Z height which automatically trigger the first set Type 1 of TAF automatic interrupt operations. The Z motion and or incompatible operation detection portion M is responsible for detecting any user initiated operations that include changing the Z height and that trigger the first set Type 1 of TAF automatic interrupt operations.

The automatic interrupt Type 2 TAF profile triggered portion O is responsible for providing a second set of TAF automatic interrupt operations Type 2 operations that are automatically triggered based on at least one respective TAF Z height surface tracking characteristic e.g. a surface tracking error exceeding a previously set TAF disable limit. In various embodiments the Type 2 operations include the TAF suspended or holding mode wherein the TAF holding mode includes discontinuing TAF adjustments of the Z height and further includes that if the at least one respective TAF Z height surface tracking characteristic returns below the previously set TAF disable limit during the TAF holding mode then TAF Z height adjustments are automatically resumed without a user initiated instruction.

For example the at least one respective TAF Z height surface tracking characteristic may be the TAF deviation signal e.g. Z Z height generated by the signal deviation signal portion F and the previously set TAF disable limit may be a limit on the TAF deviation signal. In this connection as shown in TAF disable limit definition elements A and B may be provided in a GUI window of the machine vision inspection system to permit an operator to define the previously set TAF disable limits. In the illustrated example of the GUI window an operator has set the TAF disable limits as 0.4 mm and 0.2 mm for a rising surface and a falling surface respectively. Then according to exemplary embodiments of the present invention when the TAF deviation signal derived from the signal deviation signal portion F exceeds the 0.4 mm limit in the positive direction or exceeds the 0.2 mm limit in the negative direction this triggers the second set Type 2 of TAF automatic interrupt operations. In various embodiments the second set of TAF automatic interrupt operations include the TAF holding mode wherein TAF adjustments of the height are discontinued but if the TAF Z height surface tracking characteristic returns below the previously set TAF disable limit during the TAF holding mode then TAF Z height adjustments are automatically resumed without a user initiated instruction. Continuing the above described example after the TAF portion enters into the TAF holding mode when the TAF deviation signal returns below the previously set TAF disable limits i.e. returns within the 0.4 mm and 0.2 mm range in the illustrated embodiment then TAF Z height adjustments are automatically resumed without a user initiated instruction.

The second set Type 2 of TAF automatic interrupt operations are defined in the Type 2 interrupt operations portion R. The Type 2 interrupt operations portion R includes the TAF suspended mode operations portion S that defines operations of the TAF portion during the TAF suspended holding mode. The TAF suspended mode operations portion S includes the TAF suspension Z hold operations portion T which defines the operations to be performed by the TAF portion upon entering the TAF suspended holding mode in which TAF Z height adjustments are discontinued. The TAF suspension mode operations portion S also includes the TAF automatic resumption operations portion V which defines the operations to be performed in exiting the TAF suspended holding mode to automatically resume TAF Z height adjustments.

The second set of TAF automatic interrupt operations including the TAF holding mode are useful for example when the vision inspection system is used to inspect a workpiece including holes or bosses wherein oftentimes what needs to be inspected is an edge of each hole or a boss as opposed to the bottom surface of each hole or the top surface of the boss. Then it is useful to suspend operation of the TAF portion in the hole or on the boss to ease the burden on the TAF portion to track and maintain focus at the edges. Specifically when the TAF portion remains enabled after it traverses a first edge of a hole i.e. a falling edge the TAF portion operates to ensure that the imaging portion is focused at the bottom surface of the hole and when it next traverses a second edge of the same hole i.e. a rising edge the TAF portion must quickly adjust the focus back to the original surface height in order to obtain a well focused image of the rising edge. This however may be difficult to achieve especially when the hole is deep or when the hardware e.g. a camera system that needs to be moved for the adjustment is massive. The second set of TAF automatic interrupt operations including the TAF holding mode are useful in allowing to selectively suspend or hold operation of the TAF portion so as to ease the burden on the TAF portion especially at surface discontinuities such as at edges found in a workpiece.

The TAF profile trigger definition s limit definition s portion P defines what limits e.g. Z increase Z Z decrease Z are used to trigger what operations suspend resume stop etc. in the first and second sets of TAF automatic interrupt operations according to various embodiments of the present invention. The TAF Z height surface tracking characteristics for which an operator may define respective limits may include as non limiting examples the Z height as controlled by the TAF portion the rate of change in the Z height as a function of time the rate of change of the Z height as a function of distance along an X Y direction a surface tracking error comprising a difference between the current Z height at a current XY position and an indication of the required TAF focus Z height at the current XY position e.g. a voltage V signal as derived from the signal deviation signal portion F described above and a TAF deviation signal that is indicative of a difference between the current Z height at a current XY position and the required TAF focus Z height at the current X Y position e.g. the TAF deviation signal in Z as derived from the signal deviation signal portion F . The TAF disable limits that may be previously set for the corresponding TAF Z height surface tracking characteristics include as non limiting examples an absolute Z height limit a relative Z height limit defined relative to a current baseline Z height of the TAF portion a limit on the rate of change in the Z height as a function of time a limit on the rate of change of the Z height as a function of distance along an X Y direction a limit on the surface tracking error and a limit on the TYAF deviation signal.

The limits may be generally related to abrupt and or large discontinuities on a workpiece surface and may be especially related to the edges of certain types of holes such as those holes having steeply falling and rising edges. In various embodiments absolute Z height limit s may be set relative to the Z height corresponding to when the TAF portion is turned on or may be fixed at the Z height s defined by the user during learn mode operations. Absolute Z height limit s may be fixed either in a workpiece coordinate system e.g. using one corner of a rectangular workpiece as the X Y Z origin or in a machine coordinate system defined by the linear scales of the workpiece stage having the X Y Z origin. In various embodiments relative Z height limit s are default limits such as those corresponding to a reliable sensing range or normal control range of the TAF portion . Alternatively relative Z height limit s may be defined and or redefined by an operator during learn mode operations. For example the operator may define redefine relative limit s to ensure that TAF Z height adjustments are suspended at a Z height of holes found in a workpiece for which a part program is created.

When a relative Z height limit is defined relative to a current baseline Z height the current baseline Z height may be a fixed Z height defined for a current instance of TAF Z height adjustment operations. For example the current baseline Z height may be fixed at the Z height corresponding to when the current instance of the TAF portion is turned on or may be fixed at a Z height defined by an operator during learn mode of operations. As a further example the current baseline Z height may be an adaptively changing baseline Z that is determined based on a set of recent Z heights as controlled by the TAF portion . For example the adaptively changing baseline Z may be the average of a set of the most recent controlled Z heights over the last X milliseconds or over the last X millimeters of XY distance which may be in proportion to the extent of the field of view depending on magnification. As further examples when TAF Z height adjustments are automatically resumed the adaptively changing baseline Z may be set to a new value based on a current actual Z height as adjusted corrected by the TAF deviation signal derived from the signal deviation signal portion F or as adjusted corrected by way of the actual TAF adjustments of the Z height implemented by the TAF portion after resuming. In various embodiments the current baseline Z height is automatically set to correspond to the null zero TAF deviation signal that is indicative of the best focus position. The current baseline Z height may be fixed either in a workpiece coordinate system or in a machine coordinate system. The baseline Z height operations portion U of the TAF suspension Z hold operations portion T is responsible for setting the baseline Z height to be compared to relative Z height limit s that may be set by an operator.

The TAF profile trigger definition s limit definition s portion P may define what limits e.g. Z increase Z Z decrease Z are used to trigger what operations suspend resume stop etc. in the first Type 1 and second Type 2 sets of TAF automatic interrupt operations according to various embodiments of the present invention. Referring additionally to for example the GUI window allows an operator to set Z increase and Z decrease limits A and B respectively that automatically trigger the first Type 1 set of TAF automatic interrupt operations to stop disable or turn off TAF Z height adjustments of the TAF portion . As described above the GUI window also allows an operator to set Z increase and Z decrease limits A and B respectively that automatically trigger the second Type 2 set of TAF automatic interrupt operations to suspend or hold TAF Z height adjustments. As described above in various embodiments those same TAF disable limits A and B used to automatically trigger the second set of TAF automatic interrupt operations may also be used to automatically resume TAF Z height adjustments when the tracked characteristic returns below the limits. For example once respective TAF Z height surface tracking characteristics that have exceeded the limits to automatically trigger the TAF suspension holding mode return below the limits TAF Z height adjustments may be automatically resumed without a user initiated instruction.

Alternatively in other embodiments an operator may wish to set the TAF resume limits for the second Type 2 set of TAF automatic interrupt operations differently from the TAF disable limits. For example it is possible to set the TAF disable limit as 0.4 mm and the TAF resume limit as 0.2 mm. In this example TAF Z height adjustments are automatically suspended when the TAF deviation signal exceeds the TAF disable limit of 0.4 mm while TAF Z height adjustments are automatically resumed only after the TAF deviation signal returns to below the TAF resume limit of 0.2 mm.

As shown in an operator may be allowed to set different limits A and B and A and B respectively to trigger the first set of TAF automatic interrupt operations TAF stop and the second set of TAF automatic interrupt operations TAF hold . Further the operator may be allowed to select which one of the first set and the second set of TAF automatic interrupt operations is to be triggered. In the example of the operator has defined the Z increase limit of 0.4 mm in each of the TAF disable limit definition element A to trigger the stop disabled mode and the TAF disable limit definition element A to trigger the holding suspended mode but the operator has selected to activate the TAF disable limit definition element A for the stop mode. On the other hand the operator has defined the Z decrease limit of 0.2 mm in each of the TAF disable limit definition element B to trigger the stop disabled mode and the TAF disable limit definition element B to trigger the holding suspended mode but the operator has selected to activate the TAF disable limit definition element B for the holding mode. Thus in operation when the Z increase limit of 0.4 mm is exceeded the TAF portion automatically enters into the stop disabled or off mode as opposed to the holding mode. On the other hand when the Z decrease limit of 0.2 mm is exceeded the TAF portion automatically enters into the holding suspended mode as opposed to the stop mode. The TAF profile trigger limit detection portion Q of the TAF enable disable portion J is responsible for triggering defined TAF automatic interrupt operations of Type 1 or Type 2 upon detecting that a previously set TAF disable limit for the corresponding type set of TAF automatic interrupt operations is exceeded.

The TAF disabled or off mode and the TAF stop mode described above are the same in that the TAF portion is completely disabled or turned off and the TAF sensor E does not generate a focus signal in both. However the TAF stop mode is entered into automatically when corresponding TAF disable limits A A are exceeded which is different from the TAF disabled or off mode that is entered into by default or based on user selection of the TAF manual start stop selection element see . Therefore in some embodiments the status signal portion G of the TAF sensor E may generate signals that cause the GUI to display the TAF stop or error mode differently from the TAF disabled or off mode such that an operator may appreciate what has triggered disabling of the TAF portion in a particular instance.

As will be apparent to those skilled in the art various operations regarding the TAF portion described above may be implemented by hardware configuration software configuration or a combination of hardware and software configuration and therefore various hardware and or software components of the TAF portion may be suitably arranged between the vision components portion and the control system portion of the machine vision inspection system depending on each implementation. In some embodiments TAF disable limits may be defined on the software side and passed to the hardware side of the servo control portion A and the TAF sensor E as limits and subsequent operations are performed on the hardware side. In other embodiments the TAF enable and disable operations described above are mostly carried out on the software side in the control system portion based on feedback signals received from various components on the hardware side of the machine vision inspection system . For example TAF deviation signals generated by the signal deviation signal portion F may depend not only on the surface profile of a workpiece being imaged but also on the XY speed of the workpiece stage when crossing the surface profile. Thus the signal deviation signal portion F on the software side may generate TAF deviation signals which take into consideration various factors such as the XY speed of the workpiece stage . Accordingly the structure and hierarchy of the TAF portion depicted in is an example possible architecture and different architectures are equally possible depending on each implementation.

Still referring to the TAF GUI elements in cooperation with the TAF portion provide GUI related to the TAF enable and disable operations described above.

The TAF GUI elements include a TAF status indication portion A which displays on the GUI the TAF deviation signal as in Z and Z outputted from the signal deviation signal portion F as well as the TAF operation status mode signal outputted from the status signal portion G. shows an example GUI in the TAF enabled on mode. The GUI of shows Tracking AF in the color green as a TAF status mode message meaning that TAF is on next to the TAF deviation signal value of 0.0048828 in a TAF deviation signal display indicating a positive Z height deviation of 0.0048828 mm relative to the required TAF focus Z height. shows an example GUI in the TAF disabled off mode. The GUI of shows Tracking AF in the color red meaning that TAF is off. Because TAF is off nothing appears in the TAF deviation signal display in the TAF disabled off mode. shows an example GUI in the TAF suspended holding mode. The GUI of shows Tracking AF in the color green meaning that a focus signal e.g. a TAF deviation signal is generated by the TAF sensor E but is not used to implement TAF Z height adjustments as indicated by the word Holding appearing in the TAF deviation signal display . The TAF status mode message and the TAF deviation signal display are shown in real time to assist an operator in verifying the current status or operation mode of the TAF enable and disable operations including verifying the relevant TAF Z height surface tracking characteristic value such as the TAF deviation signal value.

The TAF GUI elements also include a TAF setup UI portion B which includes an interrupt disable limits UI portion C and a resume limits UI portion D. The interrupt disable limits UI portion C is responsible for generating and displaying various GUI windows to assist an operator in defining TAF disable limits which may be used to trigger the second set Type 2 of TAF automatic interrupt operations or the first set Type 1 of TAF automatic interrupt operations as described above in reference to . The resume limits UI portion D may be operable to generate and display various GUI windows to assist an operator in defining TAF resume limits which may be used to trigger automatic restart of TAF Z height adjustments after they are suspended.

The TAF GUI elements also include a TAF program instruction representations portion E operable to generate and display various GUI windows in connection with creation and editing of a part program. In particular the program instruction generation operations portion W and the program instruction representation operations portion X of the TAF enable disable portion J cooperate with the TAF program instruction representations portion E to generate a part program and to display part program instruction representations in a part program editing window in the GUI respectively. Operation of the TAF program instruction representations portion E will be described later in reference to .

In the part program editing window a Prologue node represents a process needed to run a part program in the run mode which is typically generated when the learn mode is entered. The Prologue node is a parent node which includes three childe nodes a Set Up for Measurement node a Turn TAF On node and an End Part Program node . The Set Up for Measurement node defines and represents setting needed to run a video tool such as light setting and workpiece stage setting including stage Z height setting. The Turn TAF On node turns on or enables the TAF portion so as to start TAF Z height adjustments. The End Part Program node concludes operation of the part program.

In the illustrated embodiment the Set Up for Measurement node is automatically inserted before the Turn TAF On node according to various embodiments of the present invention. This is because during run mode when the part program is executed it is desirable to set the Z height of the machine vision inspection system where the TAF portion is likely to find a track able workpiece surface within its focus range or focus limits. Therefore it is desirable to insert the Set Up for Measurement node that defines the workpiece stage Z height setting before the Turn TAF On node that turns on the TAF portion . Thus according to various embodiments during the learn mode of operation and when TAF is disabled if the Z height is successfully adjusted by the TAF portion at a Z height Zadj then in the part program editing window instruction representations are displayed that firstly position the machine vision inspection system at the adjusted Z height position X Y Zadj in the Set Up for Measurement node in and that secondly enables TAF operations at that position in the Turn TAF On node in . On the other hand according to various embodiments during the learn mode of operation and when TAF is disabled if the Z height is not successfully adjusted by the TAF portion then the TAF enable attempt is cancelled and a set of TAF enable instruction representations e.g. the Turn TAF On node are not displayed in the part program editing window . This may be desirable because if the Z height where the TAF portion is likely to find a track able surface within its focus range or focus limits is not achieved then it is likely that the TAF portion even if turned on will not function properly.

Then the operator has wished to add an image based autofocus video tool to achieve autofocus based on analysis of an acquired image of the workpiece. The image based autofocus video tool may be selected for example by clicking on an autofocus video tool element A in the selection bar on which an Autofocus message appears when the cursor is hovering over. The operator may wish to use an image based autofocus video tool because for example the operator can then select a broad region of interest such that focus can be achieved based on the entire broad region of interest which may overcome waviness in the workpiece surface and give the best average focus for some desired inspection purposes.

As described above however operations associated with an image based autofocus video tool are defined as user initiated operations that include changing the Z height according to various embodiments of the present invention. Thus the operator s addition of the image based autofocus video tool automatically triggers the first set Type 1 of TAF automatic interrupt operations which in various embodiments turn off TAF and terminate TAF adjustments of the Z height and thereafter the TAF portion does not automatically resume Z height adjustments without a user initiated instruction. As a result an autofocus region of interest indicator B is shown in the color red in the field of view window and also a warning window appears to notify the operator that User initiated Z motion overrides TAF control. TAF will be turned off. This message will disappear in 5 seconds. 

At this time in various embodiments of the present invention the Turn TAF Off node is automatically inserted before the Autofocus node in the part program editing window as shown in . That is during the learn mode of operation and when TAF is enabled if an operator initiates one of the operations that include changing the Z height e.g. operations to add an image based autofocus tool the part program editing window displays i an instruction representation corresponding to terminating TAF adjustments of the Z height in a manner consistent with the first set Type 1 of TAF automatic interrupt operations e.g. the Turn TAF Off node and ii an instruction representation corresponding to the user initiated one of the operations that include changing the Z height e.g. the Autofocus node . This feature may be desirable for the purpose of preemptively turning off disabling TAF before proceeding to execute user initiated operations that include changing the Z height as opposed to having the user initiated operations that include changing the Z height automatically trigger the TAF off disabled mode.

In accordance with further embodiments of the present invention a computer readable non transitory medium is provided which includes computer executable instructions configured to be loaded onto a computer to control a machine vision inspection system . The machine vision inspection system includes an imaging portion a movable stage for holding one or more workpieces in a field of view of the imaging portion and a Tracking AutoFocus TAF portion that operates to automatically adjust a focus position of the imaging portion to focus at a Z height corresponding to a current surface height of the workpiece in the field of view. The TAF portion includes a focus sensor and a motion control portion that is responsive to a focus signal derived from the focus sensor to focus the imaging portion at the Z height corresponding to the current surface height when TAF is enabled. The machine vision inspection system further includes a graphical user interface GUI . The GUI under control of the computer executable instructions operates to display instruction representations corresponding to TAF enable and disable operations in a part program editing window including part program instruction representations displayed during learn mode operations of the machine vision inspection system. The TAF disable operations include a first set of TAF automatic interrupt operations that are automatically triggered by user initiated operations that include changing the Z height.

In accordance with still further embodiments of the present invention a machine vision inspection system is provided including an imaging portion a movable stage for holding one or more workpieces in a field of view of the imaging portion a control portion and a Tracking AutoFocus TAF portion that operates to automatically adjust a focus position of the imaging portion to focus at a Z height corresponding to a current surface height of the workpiece in the field of view. The TAF portion includes a focus sensor and a motion control portion that is responsive to a focus signal derived from the focus sensor to focus the imaging portion at the Z height corresponding to the current surface height when TAF is enabled. The machine vision inspection system further includes a graphical user interface GUI . The control portion of the machine vision inspection system is configured to provide TAF enable and disable operations wherein the TAF disable operations include a first set of TAF automatic interrupt operations that are automatically triggered by user initiated operations that include changing the Z height.

The various embodiments described above can be combined to provide further embodiments. All of the U.S. patents and U.S. patent applications referred to in this specification are incorporated herein by reference in their entirety. Aspects of the embodiments can be modified if necessary to employ concepts of the various patents and applications to provide yet further embodiments.

These and other changes can be made to the embodiments in light of the above detailed description. In general in the following claims the terms used should not be construed to limit the claims to the specific embodiments disclosed in the specification and the claims but should be construed to include all possible embodiments along with the full scope of equivalents to which such claims are entitled.

