---

title: Cloud centric application trust validation
abstract: In accordance with the exemplary embodiments of the invention there is at least a method and an apparatus to perform the method of sending towards a key management device associated with an application service provider for an application, a key request for the application being booted in the cloud network; and in response to the key request, receiving an application specific key for the application, where the key is based on multiple factors associated with the application server. Further, there is at least a method and an apparatus to perform the method of receiving a key request from an application server of a cloud network for the application being booted in the cloud network; in response to the key request, authenticating the request using multiple attributes associated with the application server; and sending an application specific key for the application towards the application server.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09253185&OS=09253185&RS=09253185
owner: Nokia Technologies Oy
number: 09253185
owner_city: Espoo
owner_country: FI
publication_date: 20131210
---
This patent application claims priority under 35 U.S.C. 119 e from Provisional Patent Application No. 61 736 197 filed Dec. 12 2012 the disclosure of which is incorporated by reference herein in its entirety.

The teachings in accordance with the exemplary embodiments of this invention relate generally to cloud centric application trust validation and more specifically relate to multi factor trust validation by an application service provider to authenticate applications running in a cloud network.

This section is intended to provide a background or context to the invention that is recited in the claims. The description herein may include concepts that could be pursued but are not necessarily ones that have been previously conceived or pursued. Therefore unless otherwise indicated herein what is described in this section is not prior art to the description and claims in this application and is not admitted to be prior art by inclusion in this section.

Certain abbreviations that may be found in the description and or in the Figures are herewith defined as follows 

Cloud computing is an approach to sharing computing resources over the Internet. One area of cloud computing includes a host provider for example cloud provider providing virtual server instances on which user devices can run applications. Examples of applications available in such a cloud environment can include social media applications and applications provided by Yahoo EBay and Amazon to name only a few. As these applications are run in a cloud separate from a user device and its application service provider special attention needs to be given to application data security. In this regard at least a problem exists in that application data security may not be trusted to be provided by the cloud provider.

In an exemplary aspect of the invention there is a method comprising sending with an application server of a cloud network towards a key management device associated with an application service provider for an application a key request for the application being booted in the cloud network and in response to the key request receiving an application specific key for the application where the key is based on multiple factors associated with the application server.

In an exemplary aspect of the invention there is an apparatus comprising at least one processor and at least one memory including computer program code where the at least one memory and the computer program code are configured with the at least one processor to cause the apparatus to at least send with an application server of a cloud network towards a key management device associated with an application service provider for an application a key request for the application being booted in the cloud network and in response to the key request receive an application specific key for the application where the key is based on multiple factors associated with the application server.

In another exemplary aspect of the invention there is an apparatus comprising means for sending with an application server of a cloud network towards a key management device associated with an application service provider for an application a key request for the application being booted in the cloud network and means in response to the key request for receiving an application specific key for the application where the key is based on multiple factors associated with the application server.

In accordance with the exemplary aspect of the invention as in the paragraph above the means for sending and the means for receiving comprise an interface to a communication network and a computer readable memory including computer program code the computer program code executed by at least one processor.

In another exemplary aspect of the invention there is a method comprising receiving with a key management device associated with an application service provider for an application a key request from an application server of a cloud network for the application being booted in the cloud network in response to the key request authenticating the request using multiple attributes associated with the application server and sending an application specific key for the application towards the application server.

In still another exemplary aspect of the invention there is an apparatus comprising at least one processor and at least one memory including computer program code where the at least one memory and the computer program code are configured with the at least one processor to cause the apparatus to at least receive with a key management device associated with an application service provider for an application a key request from an application server of a cloud network for the application being booted in the cloud network in response to the key request authenticate the request using multiple attributes associated with the application server and send an application specific key for the application towards the application server.

In yet another exemplary aspect of the invention there is an apparatus comprising means for receiving with a key management device associated with an application service provider for an application a key request from an application server of a cloud network for the application being booted in the cloud network means in response to the key request for authenticating the request using multiple attributes associated with the application server and means for sending an application specific key for the application towards the application server.

In accordance with the exemplary aspect of the invention as in the paragraph above the means for receiving the means for authenticating and the means for sending comprises an interface to a communication network and a computer readable memory including computer program code the computer program code executed by at least one processor.

The exemplary embodiments of the invention provide at least a method to provide cloud centric trust validation in order to enable a trusted application to get access to encrypted content and encryption key management services.

Current state of technology depends on encryption operations and key management systems deployed within public cloud environments and or leveraging trust validation solution that exclusively or significantly depend on validation of applications from within the public cloud. Both of these factors will pose various security and compliance risks to users and other entities.

Although the invention may be described and or illustrated using references to particular entities such as Nokia and Amazon the use of these entities is non limiting and the invention can be practiced to the benefit of any entities which incorporate similar technology.

In accordance with an exemplary embodiment of the invention which will be described in more detail below there is at least a method to authenticate a trusted application running in a cloud in order to at least ensure that data such as sensitive data provided to from such a cloud centric application is secure.

Before describing in further detail the exemplary embodiments of this invention reference is made to for illustrating a simplified block diagram of various electronic devices and apparatus that are suitable for use in practicing the exemplary embodiments of this invention. In a Server Application provider device AP and a keystore device is adapted for communication over a wired and or wireless link with an apparatus such as a communication and or computing device referred to herein as a UE . This communication can occur via a network access node such as a Node B base station . In addition the UE can be a mobile device such as a smart phone or a stationary device such as a desktop computer. Further the UE can be any electronic device which is configured to run such cloud centric applications. Such UE devices can include but is not limited to a laptop personal data assistant a GPS and a mobile phone etc. The Application provider network may include a server that may include the MME SGW functionality shown in and which provides connectivity with a farther network such as a telephone network and or a data communications network e.g. the internet .

The UE includes a controller such as at least one computer or a data processor DP A at least one non transitory computer readable memory medium embodied as a memory MEM B that stores a program of computer instructions PROG C and at least one suitable radio frequency RF transmitter and receiver pair transceiver D for bidirectional wireless communications with the Server and or another device of the application provider via an antenna or antennas F and or a hardwired connection.

The server also includes a controller such as at least one computer or a data processor DP A at least one computer readable memory medium embodied as a memory MEM B that stores a program of computer instructions PROG C and at least one suitable RF transceiver D for communication with the UE via antennas B several when MIMO operation is in use . The server is coupled via a data control path F to the AP . The path F may be implemented as the S1 interface shown in . The server can also be coupled to another device such as via the data control path F to the keystore which may be implemented as the X2 interface shown in .

For the purposes of describing the exemplary embodiments of this invention the UE the server the application provider device and or the keystore device may be assumed to include an application credential module function ACMF . The ACMF G ACMF G ACMF G and or the ACMF G are assumed to be configured to operate in accordance with the non limiting examples of the embodiments of this invention as described herein.

At least one of the programs C C C and C is assumed to include program instructions that when executed by the associated data processor enable the device to operate in accordance with the exemplary embodiments of this invention as will be discussed below in greater detail. That is the exemplary embodiments of this invention may be implemented at least in part by computer software executable by the DP A DP A DP A and or DP A or by hardware or by a combination of software and hardware and or firmware . Likewise the ACMF G ACMF G ACMF G and the ACMF G may be implemented at least in part by executable computer software or by hardware or by a combination of software and hardware and firmware .

The various data processors memories programs transceivers and interfaces depicted in may all be considered to represent various means for performing operations and functions that implement the several non limiting aspects and embodiments of this invention.

In general the various embodiments of the UE may include but are not limited to cellular mobile devices personal digital assistants PDAs having wireless and or wired communication capabilities portable computers having communication capabilities GPS devices image capture devices such as digital cameras having communication capabilities gaming devices having communication capabilities music storage and playback appliances having communication capabilities Internet appliances permitting wireless Internet access and browsing as well as portable units or terminals that incorporate combinations of such functions.

The computer readable memories B B B and B may be of any type suitable to the local technical environment and may be implemented using any suitable data storage technology such as semiconductor based memory devices random access memory read only memory programmable read only memory flash memory magnetic memory devices and systems optical memory devices and systems fixed memory and removable memory. The data processors A A A and A may be of any type suitable to the local technical environment and may include one or more of general purpose computers special purpose computers microprocessors digital signal processors DSPs and processors based on multi core processor architectures as non limiting examples.

It is noted that any or all of the links F F F F and or F may comprise a hardwired connection of some kind. In addition the links L L and or L as will be described below can be accomplished using these links F F F F and or F as illustrated in .

Application data security in cloud is reliant on application credential and or key security. Sensitive data associated with an application running in a cloud provider network and or a public cloud can more easily be compromised. The exemplary embodiments of the invention include a method and apparatus to provide with an application service provider or a third party provider who is separate from the cloud provider a unique key which can be used by an application server and a user device to authenticate an application such as an application running in a public cloud. The method in accordance with the exemplary embodiments providing novel authentication means and protection against security threats when running such cloud centric applications as will be described in more detail below.

With regards to operations in accordance with the exemplary embodiments of the invention as illustrated in these Figures are described below 

For initialization of a secret at Bootstrapping time when new instance is created e.g. using Auto Scaling or EMR API there has to be some kind of token that is used together with other methods like EC2 API calls to establish the trust between the new instance and KMS. In other words a traditional way of establishing that trust manually by typing a PIN on console or using key on USB key etc. won t work in cloud where instances are created as a result of REST API calls to AWS or increasing load.

In other words the traditional way of establishing that trust manually by typing a PIN on console or using key on USB key etc. won t work in cloud where instances are created as a result of REST API calls to AWS or increasing load. An automated way of application validation at bootstrapping time is needed which would be prevention mechanism to deter internal and external attackers to make it difficult to exploit the pre bootstrapping step for the application. After the pre bootstrapping step triggered via script is completed via the S3 API call to a app specific URL a second level of authentication will be carried out by the GetKMSClientCredential REST API exposed by KeyStore server running in the public cloud environment. The successful invocation of this multi factor authenticated API call will allow the application running on that AMI to retrieve the required credentials which can be subsequently be used to retrieve app specific encryption keys. The initialization steps combined with MFA that includes an encrypted AppID will help deter attackers.

It is expected that most or all of the above pre bootstrapping and bootstrapping steps including invocation of the app specific S3 API call and invocation of KeyStore REST API from the server instance running in the public cloud will be automated. A good analogy for this process is the automatic scaling group in public cloud infrastructure that adds and removes instances based on the CPU load as an example.

Technical requirements and pre conditions include that the RSA KM client supports authentication mechanism that is mutually authenticated SSL. Each KM enabled application that is allowed to call the KM client must be given a SSL certificate. This certificate will map to an identity on the RSA KM server which has policies and access rights tied to it e.g. what keys can it access what operations can it perform etc. .

In addition a REST API interface is provided which will be used to create additional new clients that support the basic key management interfaces enabling secure authenticated access to data encryption and master keys . All SDK should be FIPS 1 compliant.

Key Management Client SDK that support client run time cryptographic processors shall always secure any data encryption keys as encrypted data encryption keys in the run time memory cache. Furthermore data encryption and master key s accessible via the client SDK run time will only be in clear text at the time of cryptographic operations needed to carry out encryption or decryption of data and encryption keys respectively

Communication between the client application for example these may or may not use the client SDK i.e. in some cases use the REST API running in the public cloud AWS and the Key Management Server deployed in Nokia Data Center needs to be over a secure and authenticated channel i.e. access to KMS will be restricted to authorized and application service provider owned applications from AWS via trust validation in the AWS public cloud.

In accordance with the exemplary embodiments of the invention access to encrypted content and data key encryption keys available in public cloud and or in an application service provider private cloud will be restricted to only authorized and trusted applications owned by the application service provider running in AWS public cloud environment. This requires multi factor authentication consisting of at least 1 or more attributes assigned to application service provider application deployed in AWS together 1 or more attributes from the AWS Cloud Instance environments. These attributes need to be validated inside AWS environment before getting access to KM Client s SSL private key which will be used to authenticate securely with the application service provider KM.

The exemplary embodiments of the invention provide at least a method using a centralized key management system that supports via HSM ability to securely store manage access data encryption keys and master keys.

As illustrated in a provider ELB is used for load balancing and failover. As illustrated at of the KeyServers are positioned behind the ELB for the load balancing and failover. Application servers will connect to KeyServers to obtain a master key. The servers use the Master Key to encrypt their own data. The service application sends a key request which includes authentication information such as Instance ID AMI ID IP etc. KeyServer uses the key ACLs in its DB to verify access. Applications on newly started Amazon instances can request the data encryption key. The KeyManager will authenticate the request using ACLs and return the key. All communication happens via SSL. Applications should receive the key during startup and can cache the received key in memory for performance. Applications like PHP should utilize a local memory cache Memcach to cache the key. Ensure strict ACLs on Memcached. Memcached should be bound only to the localhost and or the AMI instance security group should not allow ingress packages to Memcached port. TODO ISPOSSIBLE Passing keys as variables to mod php via Apache . Applications should still handle master key changes. The KeyManager supports storing multiple Master Keys generating new ones and deleting old keys. The KeyManagers do not enforce any key changes.

In accordance with these exemplary embodiments as illustrated in a method performs at Block A a step of sending with an application server of a cloud network towards a key management device associated with an application service provider for an application a key request for the application being booted in the cloud network. At Block B there is a step of in response to the key request receiving an application specific key for the application where the key is based on multiple factors associated with the application server.

The method as in where sending the key request comprises accessing an application programming interface uniform resource locator associated with the key management device.

The method as in the paragraphs above where the uniform resource locator is initiated in a start up script of the application.

The method as in the paragraphs above where the uniform resource locator is initiated without additional data.

The method as in the paragraphs above where the key request comprises a 16 kb secret key hardcoded into the boot up or the bootstrap code.

The method as in further comprising invoking a GetKMSClientCredential REST API deployed in the cloud with multi factor attributes and the key.

The method as in the paragraphs above where the multi factor attributes comprise an identification of the application and an internet protocol address of the application server.

The exemplary embodiments of this invention also provide an apparatus that comprises a processor and a memory including computer program code where the memory and computer program code are configured to with the processor cause the apparatus at least to perform sending with an application server of a cloud network towards a key management device associated with an application service provider for an application a key request for the application being booted in the cloud network. Further to cause the apparatus in response to the key request to perform receiving an application specific key for the application where the key is based on multiple factors associated with the application server.

The exemplary embodiments of this invention also provide an apparatus that comprises means for receiving a request for access at trusted software of a mobile device from an entity of the mobile device means for sending with an application server of a cloud network towards a key management device associated with an application service provider for an application a key request for the application being booted in the cloud network. Further means in response to the key request for receiving an application specific key for the application where the key is based on multiple factors associated with the application server.

In accordance with these exemplary embodiments as illustrated in a method performs at Block A a step of receiving with a key management device associated with an application service provider for an application a key request from an application server of a cloud network for the application being booted in the cloud network. At Block B there is a step of in response to the key request authenticating the request using multiple attributes associated with the application server. Then in Block C there is a step of sending an application specific key for the application towards the application server.

The method as in where the request comprises an application programming interface uniform resource locator initiated with the key management device.

The method as in the paragraphs above where the uniform resource locator is initiated in a start up script of the application.

The method as in where the key request comprises a 16 kb secret key originating from boot up or bootstrap code associated with the application.

The method as in where the multi factor attributes comprise an identification of the application and an internet protocol address of the application server.

The exemplary embodiments of this invention also provide an apparatus that comprises a processor and a memory including computer program code where the memory and computer program code are configured to with the processor cause the apparatus at least to perform receiving with a key management device associated with an application service provider for an application a key request from an application server of a cloud network for the application being booted in the cloud network. Further to cause the apparatus in response to the key request to perform authenticating the request using multiple attributes associated with the application server. In addition to cause the apparatus to perform sending an application specific key for the application towards the application server.

The exemplary embodiments of this invention also provide an apparatus that comprises means for receiving with a key management device associated with an application service provider for an application a key request from an application server of a cloud network for the application being booted in the cloud network. Further means in response to the key request for authenticating the request using multiple attributes associated with the application server. In addition means for perform sending an application specific key for the application towards the application server.

The foregoing description has provided by way of exemplary and non limiting examples a full and informative description of the best method and apparatus presently contemplated by the inventors for carrying out the invention. However various modifications and adaptations may become apparent to those skilled in the relevant arts in view of the foregoing description when read in conjunction with the accompanying drawings and the appended claims. However all such and similar modifications of the teachings of this invention will still fall within the scope of this invention.

It should be noted that the terms connected coupled or any variant thereof mean any connection or coupling either direct or indirect between two or more elements and may encompass the presence of one or more intermediate elements between two elements that are connected or coupled together. The coupling or connection between the elements can be physical logical or a combination thereof. As employed herein two elements may be considered to be connected or coupled together by the use of one or more wires cables and or printed electrical connections as well as by the use of electromagnetic energy such as electromagnetic energy having wavelengths in the radio frequency region the microwave region and the optical both visible and invisible region as several non limiting and non exhaustive examples.

Furthermore some of the features of the preferred embodiments of this invention could be used to advantage without the corresponding use of other features. As such the foregoing description should be considered as merely illustrative of the principles of the invention and not in limitation thereof.

