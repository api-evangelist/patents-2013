---

title: Method and system for mitigating interest flooding attacks in content-centric networks
abstract: One embodiment of the present invention provides a system for mitigating interest flooding attacks in content-centric networks (CCNs). During operation, the system receives, at a physical interface of a router, an interest packet; obtains current interest satisfaction statistics associated with the physical interface; and determines whether to forward or drop the interest packet based on the current interest satisfaction statistics.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09185120&OS=09185120&RS=09185120
owner: PALO ALTO RESEARCH CENTER INCORPORATED
number: 09185120
owner_city: Palo Alto
owner_country: US
publication_date: 20130820
---
This application claims the benefit of U.S. Provisional Application No. 61 826 931 entitled METHOD AND SYSTEM FOR MITIGATING INTEREST FLOODING ATTACKS IN CONTENT CENTRIC NETWORKS by inventors Priya Mahadevan et al. filed May 23 2013.

This invention was made with U.S. government support under CNS 1040822 3707 awarded by National Science Foundation. The U.S. government has certain rights in the invention.

This disclosure is generally related to content centric networks CCNs . More specifically this disclosure is related to a method and a system that can be used to mitigate Distributed Denial of Service DDoS attacks in content centric networks.

The proliferation of the Internet and e commerce continues to fuel revolutionary changes in the network industry. Today a significant number of information exchanges from online movie viewing to daily news delivery retail sales and instant messaging are conducted online. An increasing number of Internet applications are also becoming mobile. However the current Internet operates on a largely location based addressing scheme. That is a consumer of data can only receive the data by explicitly requesting the data from an address e.g. IP address closely associated with a physical object or location. This restrictive addressing scheme is becoming progressively more inadequate for meeting the ever changing network demands.

The current architecture of the Internet revolves around a conversation model which was created in the 1970s for the ARPAnet to allow geographically distributed users to use a few big immobile computers. This architecture was designed under the influence of the telephone network where a telephone number is essentially a program that configures the switches along a path from the source to the destination. Not surprisingly the designers of the ARPAnet never expected it to evolve into today subiquitous relentlessly growing Internet. People now expect a lot more from the Internet than the ARPAnet was designed to provide. Ideally an Internet user should have access to any content anywhere at any time a task that is difficult to perform with the current location device binding TCP IP transmission control protocol Internet protocol networks.

Content centric networks CCNs also referred to as content based networks bring a new approach to data transport in a network. Instead of naming and addressing end hosts in the network as in traditional networks today CCN emphasizes naming and addressing content directly. Examples of content include a picture an audio file a movie a document status update in a social network such as Facebook registered trademark of Facebook Inc. of Menlo Park Calif. etc. In CCN content is requested by name directly by the consumer. The network is responsible for routing the consumer s request to the appropriate content producer or provider and for transferring the content or data object from the content producer or provider to the consumer. In contrast to today s Internet a key goal of the CCN is security by design. In fact it guarantees the integrity and provenance of every Data packet with digital signatures and protects user privacy with no source addresses carried in packets. However current efforts in CCN architecture designs have not considered Distributed Denial of Service DDoS attacks which pose a significant threat to the existing Internet infrastructure. The CCN architecture is also not immune from DDoS attacks and strategies to mitigate such attacks are not well studied yet.

One embodiment of the present invention provides a system for mitigating interest flooding attacks in content centric networks CCNs . During operation the system receives at a physical interface of a router an interest packet obtains current interest satisfaction statistics associated with the physical interface and determines whether to forward or drop the interest packet based on the current interest satisfaction statistics.

In a variation on this embodiment the interest satisfaction statistics associated with the physical interface further include at least one of per interface based interest satisfaction statistics per name prefix per interface based interest satisfaction statistics per face based interest satisfaction statistics per name prefix per face based interest satisfaction statistics per virtual interface based interest satisfaction statistics and per name prefix per virtual interface based interest satisfaction statistics.

In a variation on this embodiment the interest satisfaction statistics indicates a ratio between satisfied interest packets and received interest packets.

In a further variation determining whether to forward or drop the interest packet is based on the interest satisfaction statistics.

In a further variation determining whether to forward or drop the interest packet involves receiving from a neighboring router an outstanding interest limit announcement indicating a maximum number of interest packets acceptable by the neighboring router and assigning an outstanding interest limit for the physical interface based on the interest satisfaction statistics and the maximum number of the outstanding interest packets acceptable by the neighboring router wherein an outstanding interest is an interest that is not satisfied and not yet expired.

In a variation on this embodiment obtaining the current interest satisfaction statistics associated with the physical interface involves determining whether an interest packet has been satisfied by a corresponding data packet and determining whether an interest packet is removed from a pending interest table due to a timeout.

In a variation on this embodiment the system updates interest satisfaction statistics subsequent to the interest packet being satisfied or expired.

The following description is presented to enable any person skilled in the art to make and use the embodiments and is provided in the context of a particular application and its requirements. Various modifications to the disclosed embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the present disclosure. Thus the present invention is not limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

Embodiments of the present invention provide a method and a system that mitigates DDoS attacks in content centric networks. To do so the system leverages two key features in CCN architecture. More specifically the system designs a solution based on the per packet state maintained at intermediate CCN routers and the guaranteed symmetric flow of Interest and Data packets. In some embodiments the system calculates an interest satisfaction ratio ISR for each interface and or each name prefix forwarded at each interface and throttles incoming interest packets based on the ISR. In some embodiments the system distributes forwarding tokens among all interfaces based on the ISR at each interface.

In this disclosure the term face refers to a connection point over which CCN nodes receive and send packets. A face can be a connection point to an application another CCN node or some other kind of communication channel. A face may have attributes that indicate expected latency and bandwidth broadcast or multicast capability or other useful features.

CCN names can include an explicitly specified number of components. In addition CCN names are persistent and content specific. That is if a user changes the content of a file or data object the modified content is effectively associated with a new name. This persistency can be achieved with an explicit versioning mechanism where for example the new content can be version 4 of a given name. The version is often a timestamp. The persistency can also be achieved implicitly. For example contents can be associated with not only their human established names but also with authentication metadata e.g. a digital signature by the publisher of the content . As a result the complete content name changes when the data associated with a given name changes.

In a content centric network CCN communication is driven by the consumers of data. In a CCN there are two packet types Interest and Data. An Interest packet also called a query is a request for some content. An Interest packet encodes a special form of query that expresses what content is desired and what content is not desired. The undesired content can be indicated using the special Exclude feature in the Interest packet. A Data packet also called a content packet is a unit of content. Data packets are self identifying by carrying within them their full name. A consumer can ask for content by broadcasting its interest for the content over all available connectivity. Any node hearing the Interest and having data that satisfies it can respond with a Data packet. Data is transmitted only in response to an Interest and consumes that Interest. Both Interest and Data identify the content being exchanged by the content name or CCN name . In one embodiment Data can satisfy an Interest if the CCN name in the Interest packet is a prefix of the CCN name in the Data packet. For example an Interest packet with CCN name parc home abcd will match content parc home abcd test.txt and parc home abcd bar.txt. An Interest may specify the exact version to retrieve or may specify any version greater than a specified version known as a get the latest version interest. 

Functionally a CCN can retain associations between various names and the content represented by those names. The names are hierarchically structured have variable length and in many situations can be understood by a user. For example abcd bob papers ccn news could be the name of an article i.e. the news article from the ccn collection of papers for a user named Bob at the organization named ABCD. In a CCN from an application s perspective there is no need for a content consumer to determine how to find the ABCD organization or to find which host there holds Bob s CCN publications. In one embodiment to request a piece of content a device in the CCN registers with the network that it is interested in that content by its name and the content if available in the local network is routed back to it. The routing infrastructure takes care of intelligently propagating the Interest to the prospective publishers and then carrying any available content back via the Data packet along the reverse of the path which the Interest traversed. Note that the CCN routers route the Interest based on the longest name prefix match which is similar to IP routing where routers perform longest prefix match of IP addresses. However unlike IP routing an Interest packet and its matching Data packet always take symmetric paths Data packets always take the reverse path traversed by Interest packets in a CCN network.

Each CCN router maintains three major data structures including a Pending Interest Table PIT a Forwarding Interest Base FIB and a Content Store CS . The PIT holds all not yet satisfied Interests that have been sent upstream toward data sources. A PIT entry for an Interest specifies the name of the Interest and one or multiple incoming and outgoing physical interfaces or CCN faces for that Interest. Multiple interfaces indicate that the same content has been requested by multiple downstream users and multiple outgoing interfaces indicate that the same Interest is forwarded along multiple paths.

An FIB maps name prefixes to one or multiple physical network interfaces or faces defining allowed multipath directions to where Interests can be forwarded. A CS temporarily buffers Data packets that pass through this node allowing efficient data retrieval by different consumers.

When a router receives an Interest packet it first checks whether there is a matching data in its CS. If a match is found the Data packet is sent back to the incoming interface of the Interest packet. If not the Interest name is checked against the entries in the PIT. If the name already exists in the PIT then it can be a duplicate Interest identified by a random number each Interest carries called Nonce that should be dropped or an Interest from another consumer asking for the same Data which requires the incoming interface of this Interest to be added to the existing PIT entry. If the name does not exist in the PIT the Interest is added into the PIT and forwarded to the interface chosen by the strategy module which uses the FIB as input for its routing decisions.

When a Data packet is received its name is used to look up the PIT. If a matching PIT entry is found the router sends the Data packet to the interface s from which the matching Interest was received caches the Data in the CS and then removes the matching PIT entry. Otherwise the Data packet is unsolicited and discarded. In addition to being removed after the Interest is satisfied a PIT entry may also be removed when a lifetime associated with the Interest expires. Although the maximum lifetime is specified by users it is ultimately a router s decision how long it is willing to keep a PIT entry.

Because Interest packets consume memory resources at intermediate routers they may become potential tools for adversaries to launch DDoS attacks in a CCN network. For example an attacker or a set of distributed attackers can inject excessive amounts of Interests in an attempt to overload the network and cause service disruptions for legitimate users.

During operation of CCN network legitimate user end node may request certain content from data producers such as data producer end node by sending an Interest packet to a coupled CCN router. In the example shown in legitimate user end node sends Interests to CCN router via physical interface . CCN router receives these Interests checks its PIT or FIB based on the names of these Interests and forwards these Interests to CCN router via physical interface . Similarly CCN router receives these Interests checks its PIT or FIB based on the names of these Interests and forwards these Interests to data producer end node . In the example shown in CCN router receives these Interests via physical interface and forwards these Interests via physical interface .

In response to receiving an Interest packet data producer end node responds with a Data packet which flows back to legitimate user end node following the path of the Interest packet.

In the meantime adversary end node attempts to launch a denial of service attack on CCN network . Since a CCN network fetches data by its name an adversary cannot target specific routers or end hosts. However an adversary can target a specific namespace. For example in if data producer end node is the exclusive owner of a namespace foo bar both CCN router and data producer end node would receive all Interests for foo bar . . . that cannot be otherwise satisfied from in network caches. A large volume of such malicious Interests can disrupt service quality in CCN network in two ways it creates network congestion and exhausts resources on the intermediate routers.

Similar to packets in traditional networks Interest packets in a CCN network consume a portion of network capacity. A large number of Interest packets might cause congestion and lead to legitimate packets being dropped. In particular a coordinated DDoS attack could target one specific namespace to concentrate attack traffic in certain segments of the network typically closest to the publisher serving that namespace.

Because CCN routers maintain per packet states for each forwarded Interest i.e. as an entry in its PIT an excessive number of malicious Interests can lead to exhaustion of a router s memory making the router unable to create new PIT entries for incoming Interests thus disrupting service for legitimate users.

Note that an effective Interest flooding attack may not be trivial to create. To target a specific namespace e.g. NewYorkTimes an adversary needs to make sure that 1 the expressed Interests are routed as close to the data producer as possible and 2 the corresponding PIT entries are stored at intermediate CCN routers for as long as possible. To avoid an Interest being served from caches of intermediate routers every single malicious Interest has to request an unpopular or non existing content e.g. content with a unique name unique junk Interests . In this disclosure we focus on this particular attack strategy because it maximizes the damage from each malicious Interest in the CCN network. However other less effective strains of Interest flooding attacks can also be mitigated by applying the same or similar countermeasures used by embodiments of the present invention.

A fundamental principle of CCN architecture the flow balance between Interest and Data packets can be exploited in mitigating Interests flooding. More specifically in CCNs the Interest packet the only communication initiator can be satisfied with at most one Data packet with intermediate routers to control the inbound data traffic by controlling the number of outstanding Interests in the network. Hence one naive approach to mitigating Interests flooding is to set uniform Interest limits called physical limits everywhere else on every physical interface or CCN face. However such an approach does not differentiate malicious interest requests from legitimate ones.

In order to distinguish between legitimate and malicious Interests in some embodiments the system leverages another unique feature of CCN architecture the guaranteed symmetric flow of Interest and Data packets. Since a Data packet takes the reverse path of the corresponding Interest packet a CCN router is able to see whether an Interest it forwarded results in a matching Data packet or the Interest results in a timeout. In addition because malicious Interests are not likely to bring data back this information can be utilized by CCN routers in differentiating between attacks and legitimate traffic.

Note that this timeout based differentiation method is reactive in nature one cannot determine in advance whether an Interest will result in a timeout or Data being retrieved. However intermediate routers can proactively maintain up to date Interest satisfaction statistics such as Interest satisfaction ratios ISRs which are the number of satisfied Interests versus the number of forwarded Interests and use these statistics to determine whether an incoming Interest should be forwarded or dropped. For example maintaining independent Interest satisfaction ratio ISR for each incoming interface can be sufficient to reasonably predict whether an Interest received from a neighbor coupled to this interface will result in a Data packet or a timeout if forwarded. Statistics can also be kept at finer granularities such as per outgoing interface per name prefix per face etc. that can further improve this estimate. In one embodiment the system computes ISR on a per name prefix basis. In CCN a physical interface or face can forward different Interest packets with different name prefixes. For example a physical interface or a face can forward Interests with name prefixes such as parc xerox parc csl foo bar etc. The system can maintain ISR for each name prefix at each physical interface or face. For example the system can accumulate statistics for name prefix foo bar at a particular interface by counting how many Interest packets forwarded at this particular interface with the name prefix foo bar have resulted in a timeout. In addition to name prefix based statistics a router may divide a physical interface into a set of virtual interfaces and associate these statistics at each virtual interface or for each name prefix at each virtual interface. Note that if an attacker tries to launch a DoS attack by requesting non existing content with a fake name prefix negative statistics for that name prefix can build up rapidly as all requests for that name prefix result in a timeout.

A router s goal should be to prioritize Interests that bring Data back while quickly penalizing those that occupy resources without generating a Data stream in return. In order to allow negative statistics to build up fast and positive statistics to deteriorate quickly in one embodiment the system calculates the ISR using the standard exponentially weighted moving average. In a further embodiment the moving average is performed once a second with a coefficient e which approximately corresponds to a 30 second averaging window. Note that the duration of the time window for performing the moving average can be dynamically adjusted. For example depending on traffic pattern the moving average may be calculated every half a second or every 10 seconds. Note that in addition to the exponentially weighted moving average other methods can also be used to calculate ISR.

During operation CCN router receives Interest packets via physical interfaces and . The received Interest packets are compared with data in CS to see whether matching data can be found. If no match is found the names of the Interest packets are checked against entries in PIT . If the names do not exist in PIT corresponding entries in PIT are generated and the Interests are forwarded based on interfaces specified in FIB which uses decisions made by routing module as input. Entries in PIT are deleted under two circumstances the Interest is satisfied or a timeout has occurred. Based on this per packet state information ISR calculator can calculate ISRs for each physical interface or face or for each name prefix at each physical interface or face . In one embodiment ISR calculator evaluates the number of unsatisfied Interests within a small time window by calculating an exponentially weighted moving average over a larger time window. The Interest satisfaction statistics which may include ISR and a ratio of the unsatisfied Interests outputted by ISR calculator can be used to penalize malicious Interests. In one embodiment the output of ISR calculator is sent to Interest acceptance determination module which uses such information to determine whether to accept forward or reject an incoming Interest.

In the pseudocode shown in one can see that the probability of an Interest from a particular interface being dropped is proportional to the ratio of the unsatisfied Interest packets to the incoming packets as indicated by lines 6 7 of the interface. In other words the probability of an Interest from a particular interface being forwarded is proportional to the ISR of that interface. Note that if the system maintains ISR on a per name prefix basis for each physical interface then probability of an Interest being forwarded is proportional to the ISR of the name prefix of the Interest at that interface. As one can see from during an Interest flooding attack the percentage of unsatisfied Interest can be very close to 100 meaning that the likelihood of an Interest being dropped can be close to 100 . Also note that parameter line 5 ensures that this probabilistic model is not enforced when the volume of Interests arriving at a particular interface is small. This step is critical to provide an opportunity for legitimate users to regain their share of resources after temporary Data delivery failures.

A drawback of this satisfaction based Interest acceptance method is that each router on the path makes an independent decision whether to forward or drop an Interest. Because of these independent decisions the probability of legitimate Interests being forwarded decreases rapidly as the number of hops between the content requester and the content producer grows. For example in CCN router may observe a 50 satisfaction rate for interface which is coupled to legitimate user end node and a 0 satisfaction rate for interface which is coupled to adversary end node . In the meantime CCN router may observe a 30 satisfaction rate for interface which is coupled to CCN router . As a result when a legitimate Interest arrives at CCN router via interface it has a 50 chance of being forwarded further if forwarded it has only a 50 30 15 probability of being forwarded further toward data producer end node . With each increasing hop in the network the probability of being forwarded to the next hop decreases significantly. The increased Interest dropping probability at upstream nodes worsens the Interest satisfaction statistics at those nodes and may result in further drops.

In some embodiments to prevent this overreaction and unfair penalization the system ensures that the decision taken at each router on whether to forward or drop an Interest is not independent of the decision made by preceding routers. In a further embodiment the system may implement an explicit notification such as a gossip protocol between neighboring CCN routers to ensure that each router makes its Interest forwarding decision based on decisions made by previous routers.

The satisfaction based Interest acceptance method effectively divides the available forwarding tokens a concept that is similar to the tokens in the well known token bucket algorithm currently widely used in the packet switched network among all interfaces proportional to their ISRs. In some embodiments instead of proportional token distribution the system enforces explicit Interest limits for each incoming interface or for each name prefix at each face where the value of the limit depends directly on the interface s ISR. This technique is also called the satisfaction based pushback. In a further embodiment CCN routers announce these limits to their downstream neighbors which in turn adjust Interest limits for their incoming physical interfaces accordingly. Various messaging mechanisms can be used by the CCN routers for announcing their Interest limits to downstream routers. For example a gossip protocol can be used by CCN routers to periodically send control messages to their neighbors to indicate the Interest limits either on a per interface basis or on a per name prefix per interface basis. Moreover such control messages can also be part of heartbeat messages that a router sends to its neighboring routers. In addition any other communication techniques between two routers either currently in use or invented in the future may be used to communicate the Interest limits between routers. Upon receiving the Interest limit of its upstream router the downstream router adjusts the Interest limits for its own incoming interfaces based on the upstream Interest limits. In one embodiment the downstream router adjusts the Interest limits for its incoming interfaces in proportion to the Interest limits of its upstream router. This ensures that any Interest forwarded from the downstream router is allowed to get through thus resulting in genuine Interest satisfaction statistics.

In the example shown in the initial Interest limit is set as L 10. CCN router observes a 50 satisfaction rate for interface which is coupled to legitimate user end node and a 0 satisfaction rate for interface which is coupled to adversary end node . In the meantime CCN router observes a 30 satisfaction rate for interface which is coupled to CCN router . Based on the corresponding ISR CCN router sets the Interest limit for its incoming interface as L 30 10 3 and announces this Interest limit to CCN router . After receiving the announcement from CCN router CCN router readjusts its incoming interface Interest limit to L 50 3 1.5 for interface and L 0 3 0 for interface . Note that these limits are then announced to both legitimate user end node and adversary end node . Both the legitimate users and adversaries may either obey or ignore the announced Interest limit which will be in any case enforced by CCN router .

The zero limit for the adversary s link in implies that CCN router is temporarily not willing to accept any Interests from interface until the statistics decay to the appropriate level as shown in where the percentage of unsatisfied Interest drops gradually after the attack period.

At the next iteration of this satisfaction based pushback algorithm legitimate user end node will be able to gradually improve the statistics on both routers and because all Interests from the user will get through and return Data eventually resulting in a full allowance L L 10 in the links between CCN routers and and legitimate user end node and CCN router .

Subsequently the intermediate router announces the readjusted Interest limits to its downstream routers operation . The router receives an Interest from a physical interface operation and determines whether the Interest exceeds the Interest limit set for that particular interface operation . If so the router drops the Interest operation otherwise the router forwards the Interest operation . Subsequent to the forwarding or dropping of the Interest the router updates its Interest satisfaction statistics operation .

Note that compared with other well known pushback mechanisms embodiments of the present invention suppress or push back unwanted requests for data not actual data itself. In addition differentiating between good and bad Interests is based on the traffic symmetry principle of CCN.

The data structures and code described in this detailed description are typically stored on a computer readable storage medium which may be any device or medium that can store code and or data for use by a computer system. The computer readable storage medium includes but is not limited to volatile memory non volatile memory magnetic and optical storage devices such as disk drives magnetic tape CDs compact discs DVDs digital versatile discs or digital video discs or other media capable of storing computer readable media now known or later developed.

The methods and processes described in the detailed description section can be embodied as code and or data which can be stored in a computer readable storage medium as described above. When a computer system reads and executes the code and or data stored on the computer readable storage medium the computer system performs the methods and processes embodied as data structures and code and stored within the computer readable storage medium.

Furthermore methods and processes described herein can be included in hardware modules or apparatus. These modules or apparatus may include but are not limited to an application specific integrated circuit ASIC chip a field programmable gate array FPGA a dedicated or shared processor that executes a particular software module or a piece of code at a particular time and or other programmable logic devices now known or later developed. When the hardware modules or apparatus are activated they perform the methods and processes included within them.

The foregoing descriptions of various embodiments have been presented only for purposes of illustration and description. They are not intended to be exhaustive or to limit the present invention to the forms disclosed. Accordingly many modifications and variations will be apparent to practitioners skilled in the art. Additionally the above disclosure is not intended to limit the present invention.

