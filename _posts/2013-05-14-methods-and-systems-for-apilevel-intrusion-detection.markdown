---

title: Methods and systems for API-level intrusion detection
abstract: This disclosure generally relates to computer security, and more particularly to methods and systems for application programming interface (API)-level intrusion detection. In some embodiments, a computer-readable medium is disclosed, storing instructions for: receiving an API call for a service at an API sandbox module; parsing the API call to extract at least one of: an API call name; and or one or more API call parameters; generating a copy of the at least one of: the API call name and or the one or more API call parameters; determining, via an intrusion detection rules execution engine, whether the API call violates one or more security rules obtained from a security rules object, using the copy of the at least one of: the API call name and or the one or more API call parameters; and providing an indication of whether the API call violates the one or more security rules.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08990942&OS=08990942&RS=08990942
owner: Wipro Limited
number: 08990942
owner_city: Bangalore
owner_country: IN
publication_date: 20130514
---
This disclosure claims priority under 35 U.S.C. 119 to India Application No. 712 CHE 2013 filed Feb. 18 2013 and entitled METHODS AND SYSTEMS FOR API LEVEL INTRUSION DETECTION. The aforementioned application is incorporated herein by reference in its entirety.

This disclosure generally relates to computer security and more particularly to methods and systems for API level intrusion detection.

Web services may be protected from intrusions e.g. denial of service attacks malware etc. using intrusion detection systems IDS . Intrusion detection systems typically operate on individual Internet Protocol IP data packets and are generally network based NIDS or host based HIDS . A NIDS scans network packets at the router level and logs information on suspicious packets into a log file. A HIDS monitors a single computer system s state memory and packets received at its network interface for violations of that host s security policies. IDS systems executions are commonly categorized as Behavior Based or Anomaly Based. IDS implementations and products may be designed anywhere from software only to completely embedded hardware appliance boxes. Recent advances in IDS have focused on Application level IDS where the IDS rules are neither at the host nor at the network instead the IDS rules are coded along with the Application. The benefits of Application level IDS includes the fact that an Application developer can usually tell what is are the right usage and likewise what is are the wrong usage of the Application and hence the latter i.e. the wrong usage are best captured at the Application programming level.

In one embodiment a non transitory computer readable medium is disclosed storing computer executable instructions for receiving an application programming interface API call for a service at an API sandbox module parsing the API call to extract at least one of an API call name and or one or more API call parameters generating a copy of the at least one of the API call name and or the one or more API call parameters providing to an intrusion detection rules execution engine the copy of the at least one of the API call name and or the one or more API call parameters determining via the intrusion detection rules execution engine whether the API call is in violation of one or more security rules obtained from a security rules object and providing an indication of whether the API call is in violation of the one or more security rules. In another embodiment a non transitory computer readable medium is disclosed storing intrusion detection rules at an SDK with the SDK capturing the API calls and executing the intrusion detection rules wherein the selection of specific APIs and selection of specific calling Applications for intrusion rules execution may be customized with a user interface and wherein the security rules for the intrusion detection may also be customized with a user interface. In another embodiment the SDK may be co located at an enterprise level software gateway tunneling all selected API calls from to within the enterprise prior to from transmittal external to the enterprise unto the Internet.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory only and are not restrictive of the invention as claimed.

Exemplary embodiments are described with reference to the accompanying drawings. Wherever convenient the same reference numbers are used throughout the drawings to refer to the same or like parts. While examples and features of disclosed principles are described herein modifications adaptations and other implementations are possible without departing from the spirit and scope of the disclosed embodiments. It is intended that the following detailed description be considered as exemplary only with the true scope and spirit being indicated by the following claims.

In some embodiments the local copy created by the API sandbox may be provided via a T Tap output see to a rules execution engine see . The T Tap and API sandbox ensure that the data and local API copy being operated on e.g. by the rules execution engine dashboard UI etc. are not accessible to modules on the other side of the API sandbox and other modules or data outside the API sandbox may not become involved in processes executed within the API sandbox. The rules execution engine may obtain data upon which to operate from a data expiry unit see . For example the data expiry unit may store the API call names and API call parameters e.g. input variables source IP address destination IP address user ID etc. up to a time period beyond which the storage is freed and new data are stored on a FIFO first in first out basis. The data expiry unit may be implemented as a relational database file e.g. CSV text file etc. object stored in memory etc. The rules execution engine may obtain security rules for processing the API call from a security rules file object or database etc. see . The security rules may be modified through a graphical user interface GUI like a security rules UI see . The results of the security rules processing of the API calls may be reported see or displayed via a graphical user interface dashboard output see .

In some embodiments implementing IP re routing the intrusion detection system architecture see may be implemented in a separate monitoring server . An API call generated by the user device may first be directed to the IP address of the monitoring server . API calls may be renamed lexically at the source to ensure that the calls first go to a security check process e.g. implemented as a dynamic link library DLL for intercept and security check prior to being forwarded to the web application server for user request processing. Upon receiving the API call from the user device the monitoring server may perform a security check for the API call determine whether the API call can be forwarded to the application server implementing the web application service and determine the IP address of such application server . Once the monitoring server determines that the API call can be forwarded the monitoring server may forward the API call see to the IP address corresponding to the application server.

In some embodiments implementing lexical re routing the user device may provide the API call directly to the application server but the API call may be intercepted by a security check process e.g. implemented as a dynamic link library DLL rather than the web application service process executing on the application server . Upon receiving the API call from the user device the security check or intrusion monitoring or intrusion detection process may perform a security check for the API call determine whether the API call can be forwarded to the web application service process and determine the API name corresponding to such application service process. Once the monitoring process determines that the API call can be forwarded the monitoring process may forward the API call see to the web application service process executing on the application server.

In some embodiments although the API call is ultimately intended to be provided to the application server the API call may be directed to a monitoring server instead see . For example in the API call above www.webservice1.com may point to monitoring server rather than application server . In alternate embodiments the API call may be addressed to the application server itself that is in the example above www.webservice1.com may point to application server itself but the application server may be configured to execute an intrusion detection module e.g. via a DLL that intercepts the API call before the API call is read by a web service application executing on the application server. For example this may be achieved by the application server parsing the API call to extract the name of the API call which in the example above may be considered n apiname and using the API call name to determine whether the API call should be passed to the intrusion detection module. In the example above the presence of the n  modifier before the rest of the API call name may be the trigger for intercepting the API call and passing it to the intrusion detection module. It is to be understood that although the disclosure hereinafter may refer to a monitoring server the monitoring server may be implemented as a standalone server or as a process or application executing on the application server or in any other configuration. In some embodiments whether the API call is directed to a monitoring server or to an intrusion detection module executing on the application server rather than directed to the application server may not be discoverable based on the API call template employed by a user user device or developer of the application executing on the user device.

In some embodiments the monitoring server may obtain the API call from the user device see . The monitoring server may generate a local copy of the API call see . For example the local copying may be non invasive in that no processing beyond temporary storage of the original version of the API call and creation of the local copy may be performed using the original version of the API call and all further processing for intrusion detection may be performed on the local copy of the API call see e.g. T Tap output . The monitoring server may parse the copy of the API call and extract the API name and API call parameters see . For example if the monitoring server utilizes PHP commands the monitoring server may utilize the standard GET request  GET param to extract the API call parameters from the API call. Using the API call name and or API call parameters as inputs to a database query e.g. using PHP SQL commands such as SELECT the monitoring server may identify and obtain the security rule s to apply to the API call for intrusion detection see . In some embodiments a user interface may be provided via which a security administrator may select options such as without limitation which API call names should be analyzed for intrusion detection which application developers develop applications whose API calls are to be analyzed for intrusion detection which security rules should apply to any particular set of API calls e.g. grouped by application developer application type application usage web application service provider client s of the monitoring server administrator etc. or the like. It is to be understood that any combinations of application develop application API call and or other parameters may be selected by the security administrator and settings rules for which API calls are to be analyzed for intrusion detection may be based on such combinations of parameters. An example of PHP SQL commands to obtain the security rules using the API call name as a lookup variable is provided below 

In some embodiments the security rules may be stored in a file e.g. a CSV text file etc. as an object in memory a hash table etc. In some embodiments the security rules may be stored in a secure database and may be accessed only by the monitoring server or the intrusion detection module executing on the application server. In particular in some embodiments the application server application developer user device and user all may not have access to the security rules. Similarly the security rules in some embodiments may only be modified by an administrator with appropriate security credentials for accessing the secure database. A security rule may define one or more tests to be performed on the API call and may provide one or more recommended actions depending on the outcome of the one or more tests. An example of a security rule is provided in pseudo code below 

In this example security rule called FrequencyTest if the number of API calls of the name stored in the variable api name received in the last hour exceeds fifty the monitoring server is to proactively place a hold on the API call and request the security administrator for authorization to allow the API call to be forwarded to the application server. Specifically the monitoring server is to create a user interface object as well as a report based on the last API call request received and place the request for administrator authorization in a queue. The security rule also calls for another security rule called DoS Attack to be run on the API calls of the name stored in the variable api name . Three additional examples of security rules implemented using Visual Basic VB code are provided below. In a first example assuming an API call is made by the user device to send an SMS message to a large number of recipients a security rule implemented in VB code may test for the presence of blacklisted keywords in the SMS message.

In a second example a security rule implemented in VB code may check a message sent via Wireless Application Protocol WAP e.g. to a mobile phone to determine whether it engages in a phishing scam e.g. whether it contains a link to a website hosting known malware .

In a third example a security rule implemented in VB code may check whether a large number of API calls are originating from a single location or if there is a high density of API calls originating from a relatively small area e.g. which may be indicative of misuse of the API call .

It is to be understood that the above rules are only examples and a wide variety of rules operating in various contexts on any combination of API call names API call parameters and other variables are contemplated.

In some embodiments the monitoring server may apply the security rules obtained from a security file object or database to the API call. For example the monitoring server may select a security rule see and parse the security rule to extract the security test to apply to the API call see . Upon identifying the requirements of the test the monitoring server may obtain the necessary information and apply the test to the information e.g. API call name API call parameters call frequency call locations etc. see . The monitoring server may determine whether the test is passed see . If the test is passed the monitoring server may check to see if additional security rules need to be applied see and may apply those additional security rules. If all the security rules have been passed the monitoring server may determine that the API call can be re routed to the application server or application process and may initiate API call re routing accordingly see .

In some embodiments if a test of a security rule is not passed see option No the monitoring server may determine the next actions to take. With reference to in some embodiments the monitoring server may determine whether the security rule requires the monitoring server to proactively block the API call see . If the monitoring server determines that the API call should be proactively blocked the monitoring server may delete the original version of the API call so that it cannot be forwarded to the application server or application process see . The monitoring server may also determine whether the API call should be brought to the attention of the security administrator see . If the monitoring server determines that the API call should be reported to the security administrator the monitoring server may generate or update if one has already been created for the API call a report and or a dashboard UI object for presentation via a graphical user interface to the security administrator see . The monitoring server may determine whether there are additional security rules to process for the API call see and process any such security rules in a manner like that described above.

In some embodiments once all required security rules have been processed if the API call has already been proactively blocked see the monitoring server may determine that no further action is required and end processing for the current API call e.g. the monitoring server may move on to processing another API call . If the monitoring server determines that the security administrator can grant authorization to re route the API call to the application server or process see the monitoring server may determine a queue priority value for the report and or dashboard UI object e.g. to determine a position within a report queue for the API call see . The monitoring server may insert the report and or dashboard UI object into the report queue according to the priority value assigned to the report and or dashboard UI object see . For example the priority value may be determined based on instructions included in the security rule and or a timestamp associated with the API call. In some embodiments the reporting to the security administrator may be necessary to authorize the re routing of the API call see . In such cases the monitoring server may wait for the security administrator to respond see . If the security administrator does not provide the authorization see option No the monitoring server may delete the original version of the API call to prevent it from being re routed to the application server or process see . In some embodiments the reporting to the security administrator may be needed only for reporting purposes and not necessary to authorize the re routing of the API call see option No . In such cases the monitoring server may initiate the API call re routing see .

With reference to in some embodiments the monitoring server may re route the API call to the application server e.g. in the case of IP re routing or the application process e.g. in the case of lexical re routing . The monitoring server may determine whether to perform IP or lexical re routing see . The monitoring server may determine this based on the format of the API call obtained from the user device. If the API call was addressed to the monitoring server then the monitoring server may determine that IP re routing is required. If the API call name includes a trigger for passing the API call to another process e.g. an application process then the monitoring server may determine that lexical re routing is required. If IP re routing is required the monitoring server may obtain the IP address from the original API call or from the local copy see . The monitoring server may determine a new IP address e.g. that of the application server for re routing the API call see . For example the monitoring server may utilize a lookup table using the IP address from the original API call as a lookup variable. The monitoring server may create a new API call using the new IP address see . An example new API call is provided below 

In this example the URL www.webservice.com may point to the new IP address e.g. of the application server and the new API call may be otherwise unchanged from the original API call. The monitoring server may provide the new API call to the application server see .

In some embodiments if lexical re routing is required the monitoring server may obtain the API call name from the original API call or from the local copy see . The monitoring server may determine a new API call name e.g. that of a service provided by the application server for re routing the API call see . For example the monitoring server may utilize a lookup table using the API call name from the original API call as a lookup variable. The monitoring server may create a new API call using the new API call name see . An example new API call is provided below 

In this example the API name apiname may point to the application service of the application server and the new API call may be otherwise unchanged from the original API call. The monitoring server may provide the new API call to the application service process of the application server see . In some embodiments both IP and lexical re routing may be simultaneously performed whereas in alternative embodiments only one or the other may be performed.

The above examples are for the purposes of illustration only and not to be construed as limiting. Overall any and all capability extension that can be supported as a middleware can be incorporated to the SDK design herein. Such middleware capabilities include the following additional technical features and solutions 1 failover and or failsafe design extensions 2 QoS accelerators 3 Monetization and revenue generators 4 Framework applications support and 5 API mashups.

As non limiting examples with reference to in some embodiments the IDS may provide a UI depicting API usage statistics see 1 Example dashboard output . The API may be identified by an API key that may be manually entered by a user or selected from a dropdown list etc. and usage statistics may be plotted for user selectable dates between a start date and end date. The user may be able to plot multiple variables simultaneously e.g. number of requests vs. date and average response time vs. date . The UI may provide curve fitting and other statistical analysis capabilities and the results may be exported into other portable formats.

As another example in some embodiments the IDS may provide a UI depicting incidences of security threats and analysis regarding their source and intended destinations see 2 Example threat incidence output . For example the UI may include one or more charts depicting such variables like the most frequent source IP addresses for the threats the most frequent source port numbers for the threats the most frequent destination IP addresses for the threats and the most frequent destination port numbers for the threats. The manner of depiction e.g. pie chart bar graph scatter plot etc. may be modified using graphical user interface GUI elements associated with a frame within which the graphics are depicted. The variables e.g. source IP address source port number destination IP address destination port number using which the analysis is performed may be varied using GUI elements associated with a frame within which the graphics are depicted. In addition in some embodiments summaries may be provided listing the most significant variables e.g. obtained using independent or principal component analysis etc. and the incidences of threat depending on the values of these variables e.g. use of an IPv6 address at the source of the threats or use of IPv4 address at the source of the threat etc. . In addition any relationship between two or more variables can be plotted in a frame within the UI e.g. the variables may be selected using a dropdown menu or by manual entry by a user .

With reference to in some embodiments the IDS may provide a UI depicting statistics or analysis related to a specific application e.g. identifying attacks attempted on mobile device users using messages sent via Wireless Application Protocol WAP . For example the user may select a type of parameter e.g. SMS MMS location etc. a type of analysis e.g. use stats analytics performance monitoring compliance audit security intrusions etc. and a type of threat e.g. denial of service malware infection profanity etc. . Based on the parameters selected the UI may provide a display specific to the selected options. In some embodiments the UI may also allow a user to drill down into a detailed view of the data e.g. zoomed 3D render etc. and delegate or escalate a view to another security administrator. The user may use graphical tools to annotate an analysis save an annotated analysis or open a previously created analysis and engage in communications with other security administrators e.g. via chat mail text etc. .

Additional illustrative embodiments are listed below. In some embodiments a non transitory computer readable medium is disclosed storing computer executable API level intrusion detection instructions for receiving an application programming interface API call for a service at an API sandbox module parsing the API call to extract at least one of an API call name and one or more API call parameters generating a copy of the at least one of the API call name and the one or more API call parameters providing to an intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters determining via the intrusion detection rules execution engine whether the API call is in violation of one or more security rules obtained from a security rules object and providing an indication of whether the API call is in violation of the one or more security rules. In some embodiments the medium may be further storing instructions for determining that the API call is not in violation of the one or more security rules generating at least one of a new API call name and a new API call address after determining that the API call is not in violation of the one or more security rules wherein the generated at least one of the new API call name and the new API call address is the indication of whether the API call is in violation of the one or more security rules generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service. In some embodiments the medium may be further storing instructions for generating at least one of a new API call name and a new API call address regardless of whether the API call is in violation of the one or more security rules generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service. In some embodiments the medium may be further storing instructions for determining that the API call is in violation of the one or more security rules and providing the indication of whether the API call is in violation of the one or more security rules via a user interface dashboard. In some embodiments the medium may be further storing instructions for determining that the API call is in violation of the one or more security rules providing the indication of whether the API call is in violation of the one or more security rules via a user interface dashboard obtaining user authorization input via the user interface dashboard if the user authorization input authorizes API call re routing generating at least one of a new API call name and a new API call address generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service and if the user authorization input does not authorize API call re routing rejecting the API call for the service. In some embodiments the service may be a web application service. In some embodiments determining whether the API call is in violation of the one or more security rules may include determining whether the copy of the at least one of the API call name and the one or more API call parameters matches a parameter in the one or more security rules. In some embodiments the new API call name may be generated by extracting a string subset of the copy of the API call name. In some embodiments an API call address for the generated new API call may be the same as an API call address for the API call for the service received at the API sandbox module. In some embodiments the new API call address may be generated by providing the copy of the API call name as input to a lookup table. In some embodiments an API call name for the generated new API call is the same as an API call name for the API call for the service received at the API sandbox module. In some embodiments the intrusion detection rules execution engine may be of one of the following types forward chained backward chained and rule priority based execution ordering. In some embodiments the security rules object may include one or more security rules configured to detect malware. In some embodiments the security rules object may include one or more security rules configured to detect application level misuse. In some embodiments the security rules object may include one or more security rules specifically applicable to the copy of the API call name. In some embodiments the security rules object may be configurable via a user interface dashboard. In some embodiments configuration of the security rules object via the user interface dashboard may be performed substantially in real time with determining whether the API call is in violation of the one or more security rules. In some embodiments the security rules object may be configured to be inaccessible to application developers end users and a provider of the service. In some embodiments the security rules object is used for all API calls for the service received at the API sandbox module. In some embodiments the medium may be further storing instructions for determining whether to provide to the intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters based on one or more user selections of application developers whose applications API calls are to be analyzed for intrusion detection. In some embodiments the medium may be further storing instructions for determining whether to provide to the intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters based on one or more user selections of API call names of API calls to be analyzed for intrusion detection. In some embodiments the API sandbox module may be co located at an enterprise software gateway and be configured for receiving API calls for all the user selected developers and user selected API name references and processing the API calls for application specific intrusion detection.

In some embodiments an API level intrusion detection method is disclosed comprising receiving an application programming interface API call for a service at an API sandbox module parsing the API call to extract at least one of an API call name and one or more API call parameters generating a copy of the at least one of the API call name and the one or more API call parameters providing to an intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters determining via the intrusion detection rules execution engine whether the API call is in violation of one or more security rules obtained from a security rules object and providing an indication of whether the API call is in violation of the one or more security rules. In some embodiments the method may further comprise determining that the API call is not in violation of the one or more security rules generating at least one of a new API call name and a new API call address after determining that the API call is not in violation of the one or more security rules wherein the generated at least one of the new API call name and the new API call address is the indication of whether the API call is in violation of the one or more security rules generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service. In some embodiments the method may further comprise generating at least one of a new API call name and a new API call address regardless of whether the API call is in violation of the one or more security rules generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service. In some embodiments the method may further comprise determining that the API call is in violation of the one or more security rules and providing the indication of whether the API call is in violation of the one or more security rules via a user interface dashboard. In some embodiments the method may further comprise determining that the API call is in violation of the one or more security rules providing the indication of whether the API call is in violation of the one or more security rules via a user interface dashboard obtaining user authorization input via the user interface dashboard if the user authorization input authorizes API call re routing generating at least one of a new API call name and a new API call address generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service and if the user authorization input does not authorize API call re routing rejecting the API call for the service. In some embodiments the service may be a web application service. In some embodiments determining whether the API call is in violation of the one or more security rules may include determining whether the copy of the at least one of the API call name and the one or more API call parameters matches a parameter in the one or more security rules. In some embodiments the new API call name may be generated by extracting a string subset of the copy of the API call name. In some embodiments an API call address for the generated new API call may be the same as an API call address for the API call for the service received at the API sandbox module. In some embodiments the new API call address may be generated by providing the copy of the API call name as input to a lookup table. In some embodiments an API call name for the generated new API call is the same as an API call name for the API call for the service received at the API sandbox module. In some embodiments the intrusion detection rules execution engine may be of one of the following types forward chained backward chained and rule priority based execution ordering. In some embodiments the security rules object may include one or more security rules configured to detect malware. In some embodiments the security rules object may include one or more security rules configured to detect application level misuse. In some embodiments the security rules object may include one or more security rules specifically applicable to the copy of the API call name. In some embodiments the security rules object may be configurable via a user interface dashboard. In some embodiments configuration of the security rules object via the user interface dashboard may be performed substantially in real time with determining whether the API call is in violation of the one or more security rules. In some embodiments the security rules object may be configured to be inaccessible to application developers end users and a provider of the service. In some embodiments the security rules object is used for all API calls for the service received at the API sandbox module. In some embodiments the method may further comprise determining whether to provide to the intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters based on one or more user selections of application developers whose applications API calls are to be analyzed for intrusion detection. In some embodiments the method may further comprise determining whether to provide to the intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters based on one or more user selections of API call names of API calls to be analyzed for intrusion detection. In some embodiments the API sandbox module may be co located at an enterprise software gateway and be configured for receiving API calls for all the user selected developers and user selected API name references and processing the API calls for application specific intrusion detection.

In some embodiments an API level intrusion detection system is disclosed comprising one or more hardware processors and one or more memory devices disposed in communication with the one or more hardware processors and storing instructions executable by the one or more hardware processors for receiving an application programming interface API call for a service at an API sandbox module parsing the API call to extract at least one of an API call name and one or more API call parameters generating a copy of the at least one of the API call name and the one or more API call parameters providing to an intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters determining via the intrusion detection rules execution engine whether the API call is in violation of one or more security rules obtained from a security rules object and providing an indication of whether the API call is in violation of the one or more security rules. In some embodiments the one or more memory devices may be further storing instructions for determining that the API call is not in violation of the one or more security rules generating at least one of a new API call name and a new API call address after determining that the API call is not in violation of the one or more security rules wherein the generated at least one of the new API call name and the new API call address is the indication of whether the API call is in violation of the one or more security rules generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service. In some embodiments the one or more memory devices may be further storing instructions for generating at least one of a new API call name and a new API call address regardless of whether the API call is in violation of the one or more security rules generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service. In some embodiments the one or more memory devices may be further storing instructions for determining that the API call is in violation of the one or more security rules and providing the indication of whether the API call is in violation of the one or more security rules via a user interface dashboard. In some embodiments the one or more memory devices may be further storing instructions for determining that the API call is in violation of the one or more security rules providing the indication of whether the API call is in violation of the one or more security rules via a user interface dashboard obtaining user authorization input via the user interface dashboard if the user authorization input authorizes API call re routing generating at least one of a new API call name and a new API call address generating a new API call for the service using the generated at least one of the new API call name and the new API call address and providing the generated new API call for the service and if the user authorization input does not authorize API call re routing rejecting the API call for the service. In some embodiments the service may be a web application service. In some embodiments determining whether the API call is in violation of the one or more security rules may include determining whether the copy of the at least one of the API call name and the one or more API call parameters matches a parameter in the one or more security rules. In some embodiments the new API call name may be generated by extracting a string subset of the copy of the API call name. In some embodiments an API call address for the generated new API call may be the same as an API call address for the API call for the service received at the API sandbox module. In some embodiments the new API call address may be generated by providing the copy of the API call name as input to a lookup table. In some embodiments an API call name for the generated new API call is the same as an API call name for the API call for the service received at the API sandbox module. In some embodiments the intrusion detection rules execution engine may be of one of the following types forward chained backward chained and rule priority based execution ordering. In some embodiments the security rules object may include one or more security rules configured to detect malware. In some embodiments the security rules object may include one or more security rules configured to detect application level misuse. In some embodiments the security rules object may include one or more security rules specifically applicable to the copy of the API call name. In some embodiments the security rules object may be configurable via a user interface dashboard. In some embodiments configuration of the security rules object via the user interface dashboard may be performed substantially in real time with determining whether the API call is in violation of the one or more security rules. In some embodiments the security rules object may be configured to be inaccessible to application developers end users and a provider of the service. In some embodiments the security rules object is used for all API calls for the service received at the API sandbox module. In some embodiments the one or more memory devices may be further storing instructions for determining whether to provide to the intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters based on one or more user selections of application developers whose applications API calls are to be analyzed for intrusion detection. In some embodiments the one or more memory devices may be further storing instructions for determining whether to provide to the intrusion detection rules execution engine the copy of the at least one of the API call name and the one or more API call parameters based on one or more user selections of API call names of API calls to be analyzed for intrusion detection. In some embodiments the API sandbox module may be co located at an enterprise software gateway and be configured for receiving API calls for all the user selected developers and user selected API name references and processing the API calls for application specific intrusion detection.

Processor may be disposed in communication with one or more input output I O devices via I O interface . The I O interface may employ communication protocols methods such as without limitation audio analog digital monoaural RCA stereo IEEE 1394 serial bus universal serial bus USB infrared PS 2 BNC coaxial component composite digital visual interface DVI high definition multimedia interface HDMI RF antennas S Video VGA IEEE 802.n b g n x Bluetooth cellular e.g. code division multiple access CDMA high speed packet access HSPA global system for mobile communications GSM long term evolution LTE WiMax or the like etc.

Using the I O interface the computer system may communicate with one or more I O devices. For example the input device may be an antenna keyboard mouse joystick infrared remote control camera card reader fax machine dongle biometric reader microphone touch screen touchpad trackball sensor e.g. accelerometer light sensor GPS gyroscope proximity sensor or the like stylus scanner storage device transceiver video device source visors etc. Output device may be a printer fax machine video display e.g. cathode ray tube CRT liquid crystal display LCD light emitting diode LED plasma or the like audio speaker etc. In some embodiments a transceiver may be disposed in connection with the processor . The transceiver may facilitate various types of wireless transmission or reception. For example the transceiver may include an antenna operatively connected to a transceiver chip e.g. Texas Instruments WiLink WL1283 Broadcom BCM4750IUB8 Infineon Technologies X Gold 618 PMB9800 or the like providing IEEE 802.11a b g n Bluetooth FM global positioning system GPS 2G 3G HSDPA HSUPA communications etc.

In some embodiments the processor may be disposed in communication with a communication network via a network interface . The network interface may communicate with the communication network . The network interface may employ connection protocols including without limitation direct connect Ethernet e.g. twisted pair 10 100 1000 Base T transmission control protocol internet protocol TCP IP token ring IEEE 802.11a b g n x etc. The communication network may include without limitation a direct interconnection local area network LAN wide area network WAN wireless network e.g. using Wireless Application Protocol the Internet etc. Using the network interface and the communication network the computer system may communicate with devices and . These devices may include without limitation personal computer s server s fax machines printers scanners various mobile devices such as cellular telephones smartphones e.g. Apple iPhone Blackberry Android based phones etc. tablet computers eBook readers Amazon Kindle Nook etc. laptop computers notebooks gaming consoles Microsoft Xbox Nintendo DS Sony PlayStation etc. or the like. In some embodiments the computer system may itself embody one or more of these devices.

In some embodiments the processor may be disposed in communication with one or more memory devices e.g. RAM ROM etc. via a storage interface . The storage interface may connect to memory devices including without limitation memory drives removable disc drives etc. employing connection protocols such as serial advanced technology attachment SATA integrated drive electronics IDE IEEE 1394 universal serial bus USB fiber channel small computer systems interface SCSI etc. The memory drives may further include a drum magnetic disc drive magneto optical drive optical drive redundant array of independent discs RAID solid state memory devices solid state drives etc.

The memory devices may store a collection of program or database components including without limitation an operating system user interface application web browser mail server mail client user application data e.g. any data variables or data records discussed in this disclosure etc. The operating system may facilitate resource management and operation of the computer system . Examples of operating systems include without limitation Apple Macintosh OS X Unix Unix like system distributions e.g. Berkeley Software Distribution BSD FreeBSD NetBSD OpenBSD etc. Linux distributions e.g. Red Hat Ubuntu Kubuntu etc. IBM OS 2 Microsoft Windows XP Vista 7 8 etc. Apple iOS Google Android Blackberry OS or the like. User interface may facilitate display execution interaction manipulation or operation of program components through textual or graphical facilities. For example user interfaces may provide computer interaction interface elements on a display system operatively connected to the computer system such as cursors icons check boxes menus scrollers windows widgets etc. Graphical user interfaces GUIs may be employed including without limitation Apple Macintosh operating systems Aqua IBM OS 2 Microsoft Windows e.g. Aero Metro etc. Unix X Windows web interface libraries e.g. ActiveX Java Javascript AJAX HTML Adobe Flash etc. or the like.

In some embodiments the computer system may implement a web browser stored program component. The web browser may be a hypertext viewing application such as Microsoft Internet Explorer Google Chrome Mozilla Firefox Apple Safari etc. Secure web browsing may be provided using HTTPS secure hypertext transport protocol secure sockets layer SSL Transport Layer Security TLS etc. Web browsers may utilize facilities such as AJAX DHTML Adobe Flash JavaScript Java application programming interfaces APIs etc. In some embodiments the computer system may implement a mail server stored program component. The mail server may be an Internet mail server such as Microsoft Exchange or the like. The mail server may utilize facilities such as ASP ActiveX ANSI C C Microsoft .NET CGI scripts Java JavaScript PERL PHP Python WebObjects etc. The mail server may utilize communication protocols such as internet message access protocol IMAP messaging application programming interface MAPI Microsoft Exchange post office protocol POP simple mail transfer protocol SMTP or the like. In some embodiments the computer system may implement a mail client stored program component. The mail client may be a mail viewing application such as Apple Mail Microsoft Entourage Microsoft Outlook Mozilla Thunderbird etc.

In some embodiments computer system may store user application data such as the data variables records etc. e.g. security rules file object DB reports dashboard UI objects report queue etc. as described in this disclosure. Such databases may be implemented as fault tolerant relational scalable secure databases such as Oracle or Sybase. Alternatively such databases may be implemented using standardized data structures such as an array hash linked list struct structured text file e.g. XML table or as object oriented databases e.g. using ObjectStore Poet Zope etc. . Such databases may be consolidated or distributed sometimes among the various computer systems discussed above in this disclosure. It is to be understood that the structure and operation of the any computer or database component may be combined consolidated or distributed in any working combination.

The specification has described methods and systems for API level intrusion detection. The illustrated steps are set out to explain the exemplary embodiments shown and it should be anticipated that ongoing technological development will change the manner in which particular functions are performed. These examples are presented herein for purposes of illustration and not limitation. Further the boundaries of the functional building blocks have been arbitrarily defined herein for the convenience of the description. Alternative boundaries can be defined so long as the specified functions and relationships thereof are appropriately performed. Alternatives including equivalents extensions variations deviations etc. of those described herein will be apparent to persons skilled in the relevant art s based on the teachings contained herein. Such alternatives fall within the scope and spirit of the disclosed embodiments.

Furthermore one or more computer readable storage mediums may be utilized in implementing embodiments consistent with the present disclosure. A computer readable storage medium refers to any type of physical memory on which information or data readable by a processor may be stored. Thus a computer readable storage medium may store instructions for execution by one or more processors including instructions for causing the processor s to perform steps or stages consistent with the embodiments described herein. The term computer readable medium should be understood to include tangible items and exclude carrier waves and transient signals i.e. be non transitory. Examples include random access memory RAM read only memory ROM volatile memory nonvolatile memory hard drives CD ROMs DVDs flash drives disks and any other known physical storage media.

It is intended that the disclosure and examples be considered as exemplary only with a true scope and spirit of disclosed embodiments being indicated by the following claims.

