---

title: System and method for non-intrusive, privacy-preserving authentication
abstract: A system, apparatus, method, and machine readable medium are described for non-intrusive privacy-preserving authentication. For example, one embodiment of a method comprises: entering into a legitimate user state on a client device for a time period following an explicit authentication by an end user; recording reference data related to user behavior while in the legitimate user state; measuring user behavior when outside of the legitimate user state and arriving at an authentication assurance level based on a distance between the measured user behavior and the recorded reference data; in response to an authentication request within the legitimate user state, providing an authentication assurance level at or above a defined threshold, the authentication assurance level being sufficient to authenticate the user to a relying party; and in response to an authentication request while outside of the legitimate user state, providing the authentication assurance level based on a distance between the measured user behavior and the recorded reference data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09396320&OS=09396320&RS=09396320
owner: NOK NOK LABS, INC.
number: 09396320
owner_city: Palo Alto
owner_country: US
publication_date: 20131231
---
This application claims the benefit of and priority to U.S. Provisional Patent Application No. 61 804 568 filed Mar. 22 2013 entitled Advanced Methods of Authentication And Its Applications . This application is related to co pending U.S. patent application Ser. No. 14 145 466 filed Dec. 30 2013 entitled System And Method For Adaptive User Authentication .

This invention relates generally to the field of data processing systems. More particularly the invention relates to a system and method for non intrusive privacy preserving authentication.

Systems have also been designed for providing secure user authentication over a network using biometric sensors. In such systems the score generated by the application and or other authentication data may be sent over a network to authenticate the user with a remote server. For example Patent Application No. 2011 0082801 801 Application describes a framework for user registration and authentication on a network which provides strong authentication e.g. protection against identity theft and phishing secure transactions e.g. protection against malware in the browser and man in the middle attacks for transactions and enrollment management of client authentication tokens e.g. fingerprint readers facial recognition devices smartcards trusted platform modules etc .

Authenticators such as those described above require some form of user interaction such as swiping the finger or entering a secret code. These normal authenticators are intended to authenticate the user at a given point in time. In addition silent authenticators may also be used which are designed to authenticate the user s device at a given point in time rather than the user . These silent authenticators may rely on information extracted from the user s device without interaction by the user e.g. sending a Machine ID .

However there are certain use cases where requiring explicit user interaction presents too much friction e.g. near field communication NFC payments frequently used apps requiring authentication without being tied to high value transactions whereas a silent authentication technique such as sending a Machine ID does not provide enough certainty that the legitimate user is still in possession of the device.

Several continuous authentication methods have been proposed by the research community such as Anthony J. Nicholson Mobile Device Security Using Transient Authentication IEEE TRANSACTIONS ON MOBILE COMPUTING VOL. 5 NO. 11 pp. 1489 1502 November 2006 currently at http www.di.ubi.pthmario paginas g2.pdf Mohammad O. Derawi Unobtrusive User Authentication on Mobile Phones using Biometric Gait Recognition 2010 currently at http www.hig.no content download 29796 358676 version 1 file iih msp.pdf and Koichiro Niinuma Anil K. Jain Continuous User Authentication Using Temporal Information currently at http www.cse.msu.edu biometrics Publications Face NiinumaJain ContinuousAuth SPIE10.pdf . Some of these methods have even been adopted by the industry such as BehavioSec Measuring FAR FRR EER in Continuous Authentication Stockholm Sweden 2009 . These methods generally provide an assurance level that the legitimate user is still in possession a device without adding friction to the authentication process but they focus on a single modality i.e. using a wearable token gait recognition face and color of clothing recognition and user s keyboard input .

One problem which exists however is that directly providing location data or other personal e.g. face image color of clothing gait or typing characteristics . . . or environmental data e.g. temperature humidity WLAN SSIDs . . . to the relying party for supplementing the risk estimation violates the user s privacy in some regions of the world. Consequently more advanced remote authentication techniques are needed which are both non intrusive and adequately protect the end user s privacy.

Described below are embodiments of an apparatus method and machine readable medium for implementing non intrusive privacy preserving authentication using adaptive modalities. Throughout the description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be apparent however to one skilled in the art that the present invention may be practiced without some of these specific details. In other instances well known structures and devices are not shown or are shown in a block diagram form to avoid obscuring the underlying principles of the present invention.

The embodiments of the invention discussed below involve client devices with authentication capabilities such as biometric devices or PIN entry. These devices are sometimes referred to herein as tokens authentication devices or authenticators. Various different biometric devices may be used including but not limited to fingerprint sensors voice recognition hardware software e.g. a microphone and associated software for recognizing a user s voice facial recognition hardware software e.g. a camera and associated software for recognizing a user s face and optical recognition capabilities e.g. an optical scanner and associated software for scanning the retina of a user . The authentication capabilities may also include non biometric devices such as trusted platform modules TPMs and smartcards.

As mentioned above in a mobile biometric implementation the biometric device may be remote from the relying party. As used herein the term remote means that the biometric sensor is not part of the security boundary of the computer it is communicatively coupled to e.g. it is not embedded into the same physical enclosure as the relying party computer . By way of example the biometric device may be coupled to the relying party via a network e.g. the Internet a wireless network link etc or via a peripheral input such as a USB port. Under these conditions there may be no way for the relying party to know if the device is one which is authorized by the relying party e.g. one which provides an acceptable level of authentication and integrity protection and or whether a hacker has compromised the biometric device. Confidence in the biometric device depends on the particular implementation of the device.

One embodiment of the invention uses normal authentication techniques e.g. swiping a finger entering a code etc in order to train the authentication system to recognize non intrusive authentication situations. In addition one embodiment returns the authentication state of the device to the relying party rather than sensitive information such as a Machine ID when authentication is required.

Some embodiments of the invention described below may work completely frictionless i.e. without requiring any explicit user authentication . Behavioral or other techniques may be used to continuously measure an assurance level which indicates the current assurance that an authorized user is in possession of the device. The assurance level may be calculated for example based on the time which has passed since the last explicit user authentication e.g. to SIM card or phone unlock with PIN or finger swipe . Assuming that amount of time which has passed is within a particular threshold e.g. 5 seconds 5 minutes 1 hour etc the device may be considered to be in a legitimate user state and the assurance level set to a maximum value e.g. 100 on a normalized scale of 100 to 100 .

Following the legitimate user state the assurance level may be measured based on a combination of the elapsed time since explicit user authentication and other variables which indicate that the authorized user is in possession of the device e.g. based on non intrusive input detected from device sensors . For example the biometric gait of the user may be measured using an accelerometer or other type of sensor in combination with software and or hardware designed to generate a gait fingerprint from the user s normal walking pattern. In addition the distance to frequently visited destinations of the legitimate user may be tracked stored and subsequently used to determine the assurance level. For example if the user is connecting to a relying party from a location known to be the user s home or office then the assurance level may be set to a relatively high value whereas if the device is connecting from an unknown or distant location then the assurance level may be adjusted to a lower level.

Various other types of non intrusive measurements may be performed to determine whether the authorized user is in possession of the device including for example the identity of networks or devices to which the client device is connected such as Bluetooth devices near field communication NFC devices Wifi devices such as routers or access points smart watches other computing devices Nymi bracelets to name a few. Wifi devices may include the visibility of Wifi networks in reach such as a personal Wifi router at home and Wifi enabled computers used by colleagues or family members. In addition certain specific characteristics of the client device such as acceleration sensor characteristics and digital camera sensor pattern noise may be used for non intrusive measurements. Touch screen gestures of normal user interaction may also be analyzed and stored as reference data as well as user typing behavior from normal user interaction. Of course the foregoing are merely examples the underlying principles of the invention are not limited to any set of non intrusive variables.

The end result is that an assurance level that the legitimate user still is in the possession of the device may be sent to the relying party in the authentication response. In one embodiment the assurance level is signed or otherwise authenticated by a key e.g. a relying party specific key established and attested in a registration phase as discussed below . In one embodiment the assurance level is normalized to a value between 100 and 100 where 100 means almost certain it is not the legitimate user 0 means don t know and 100 means almost certain that it is the legitimate user. 

In one embodiment the relying party may ask the client device for using an additional normal authenticator response if the assurance level is not acceptable for the envisioned transaction. Regardless of what level of authentication is required one embodiment does not disclose personal data to the relying party. Instead it uses a cryptographic key dedicated to one specific relying party in order to authenticate the authenticator to the relying party.

One embodiment of an architecture for providing non intrusive privacy protecting authentication is illustrated in which includes a non intrusive privacy preserving authenticator NIPPA including an assurance calculator for determining the current assurance level based on input from non intrusive authentication mechanisms e.g. location gait measurements etc and one or more explicit user authentication devices e.g. fingerprint sensors input devices for entering ID codes etc . In one embodiment the explicit user authentication devices include the same or similar architecture as shown in .

In the embodiment illustrated in the non intrusive authentication includes a location authentication module for performing location based authentication using a location sensor s and historical or user specified location data stored within a user location data storage device e.g. which may be implemented as a file system or database . By way of example and not limitation the location sensor may include a GPS device and or a module for detecting a current access point or cell tower to which the client is connected which can be used to estimate the device s current location . Any sensor capable of providing data related to a user s location may be used. The location authentication module determines the effect that the current location of the client device has on the assurance level. For example if the device is currently at a home or office location according to historical or user specified location data then the assurance level may be adjusted upwards whereas if device is currently at a distant unknown location then the assurance level may be adjusted downwards. In addition to automatically training the system during the legitimate user state as described herein in one embodiment the user is provided with the ability to manually specify certain locations as trusted and therefore having a high assurance level e.g. when the user is at home or at the office . The results of the location authentication module are provided to the assurance calculation module to that it may be factored into current assurance level calculations.

The user behavior authentication module relies on one or more user behavior sensors to determine the extent to which the current user behavior is consistent with historical user behavior stored in user location data storage . For example the user behavior sensors may provide accelerometer measurements that the user behavior authentication module may use to determine the gait of the user currently in possession of the device . It may then compare these measurements with the known gait of the user collected following prior explicit user authentications and stored in storage device to arrive at a level of confidence that the legitimate user is in possession of the device. The results are provided to the assurance calculation module to that it may be factored into current assurance level calculations.

Various other additional authentication devices may collect data from other additional sensors to perform authentication calculations the results of which are provided to the assurance calculation module to factor into current assurance level calculations.

Although illustrated as separate modules in the location authentication module the user behavior module and any other authentication modules may form part of the assurance calculation module . The underlying principles of the invention may be implemented using various different logical arrangements of modules.

As illustrated in one embodiment the assurance calculation module relies on a timer when measuring the amount of time which has passed since the last explicit user authentication. As discussed in detail below the amount of time which has passed since the last explicit user authentication may be used to determine whether the device is currently in a legitimate user state and to adjust the assurance measurement accordingly.

Once the assurance calculation module has arrived at a current assurance measurement it may communicate the measurement to a relying party a cloud service in one embodiment established via a secure communication module . For example each authenticator including the non intrusive authenticator may exchange a relying party specific and attested key in a registration operation preceding authentication . The assurance level returned in the authentication operation may be part of a message signed encrypted by the relying party specific authentication key. In addition as discussed below the message may also include nonce e.g. a random challenge generated by the relying party.

In one embodiment secure storage is a secure storage device provided for storing the authentication keys associated with each of the authenticators and used by the secure communication module to establish secure communication with the relying party.

As mentioned in one embodiment the NIPPA leverages existing explicit user authentication techniques e.g. password based system login SIM card unlock etc to maintain a legitimate user state within a defined time window after each of such successful authentication up to T1 seconds . The NIPPA may periodically measure user behavior from the various sensors and while in the legitimate user state may update its internal reference data vector according to the measurement. While not in the legitimate user state the NIPPA may compute the normalized distance to the reference data vector based on the current measurement. This distance is considered the certainty that the legitimate user is still in possession of the authenticator.

When asked to authenticate a user the NIPPA may check to determine whether it is in the legitimate user state. If so authentication is considered successful and the maximum assurance level e.g. is returned. If not in the legitimate user state the NIPPA may return an assurance level computed by the assurance calculation module based on the latest measurements. The NIPPA may then combine the assurance level with the time difference td of that measurement tm to current time tc td tc tm . In one embodiment this is done using the following logic 

 1 if assurance level 0 then resulting assurance level assurance level max T0 td 0 T0 where T0 is the maximum acceptable time difference and

The operation of one embodiment of the invention according to the above equations is illustrated in FIG. 3. At time t1 the user performs an explicit authentication e.g. swipes a finger enters a PIN in order to unlock the SIM card etc . The time window until t1 T1 is considered the Legitimate User state. As mentioned the non intrusive authenticators may be trained within the legitimate user state. For example the user s gait may be measured and or locations visited by the user may be recorded and subsequently used to perform non intrusive authentication.

At time t2 outside of the legitimate user state the assurance calculation module computes the assurance level based on the non intrusive authenticator. The result is positive indicating that it the device is likely in full control of the legitimate user. After this computation the assurance level decreases over time e.g. the legitimate user may expose the device to non legitimate people . For example at time t3 the assurance level has dropped significantly from time t2. In one embodiment the non intrusive assurance level is only computed periodically in order to avoid excessive power and CPU performance consumption.

At t5 another non intrusive assurance level computation occurs. This time the result is negative indicating a likelihood that the device is not under full control of the legitimate user. This negative assurance level does not change until another computation is performed based on the non intrusive authenticator e.g. at time t6 .

A method in accordance with one embodiment is illustrated in . The method may be implemented within the system architecture such as that shown in but is not limited to any particular system architecture.

At an explicit authentication event occurs such as a swipe on a fingerprint sensor or the entry of a PIN to unlock the device. A timer may also be started to measure the time which has elapsed from the explicit authentication event. At the legitimate user state is entered and at various aspects of user behavior may be measured and stored for later reference e.g. locations user gait etc . If an authentication request occurs during the legitimate user state determined at e.g. resulting from a transaction with a relying party then at the maximum assurance level is selected and sent to the relying party at .

At the system exits the legitimate user state e.g. because the timer indicates that a specified amount of time has elapsed . At the system periodically measures the user behavior by comparing data from sensors against internal reference data stored in operation . By way of example measurements associated with the gait of the user collected when in the legitimate user state may be compared with current gait measurements collected at and a correlation between the two may be calculated referred to as the distance to the reference data . If an authentication request is received when outside of the legitimate user state determined at then at the current assurance level is calculated based on the distance to the internal reference data and potentially the time from the explicit authentication event. The assurance level is then transmitted to the relying party at .

Turning to if the assurance level transmitted to the relying party is acceptable for the current transaction with the user determined at then the relying party may send a response to the client device indicating a successful authentication. If not then at the relying party may send a response to the client indicating that additional authentication is needed e.g. potentially explicit user authentication if non intrusive authentication is insufficient .

In an alternate embodiment the relying party may initially specify an assurance level required for a particular transaction and the system will ensure that the required assurance level is met potentially using explicit user authentication if the non intrusive authentication techniques are insufficient. The system may then send the relying party an indication of successful authentication rather than an assurance level .

As mentioned above one embodiment of the invention calculates a distance from a set of known user locations to determine the assurance level. Referring to location based measurements e.g. such as GPS may be used to calculate the distance function as follows.

In a preprocessing operation all measured locations Ln are assigned to their nearest regions. A region is defined as a circle with a radius of r e.g. 10 meters . The Regions are placed such that a minimal number of Regions covers all Ln. All regions which cover fewer than M locations are removed from the set of Regions i.e. as they are not considered frequent locations of the user .

The distance d is then determined using distance distance of the current location Lc to the nearest center of a Region Rn r where r is the radius of a region. This value is smaller or equal to 1 if Lc is inside an existing region and may get very big if Lc is outside. The assurance level is then calculated using Assurance Level Max 100 50 floor d 100 which will be in the range of 100 to 100.

In some of the embodiments above it is assumed that the legitimate user is still in possession of the client device within a specific time window following an explicit authentication or if current behavior is very similar to measured behavior. However the above embodiments only update the behavioral reference data inside a specific time window after an explicit authentication.

As illustrated in one embodiment of the invention uses an extended time window to update behavioral reference data i.e. train the system in addition to the standard time window for the legitimate user state. As a result the complete time window including the standard time window and extended time window may be defined as follows 1 if inside the legitimate user state time window following a successful explicit user authentication i.e. t1 . . . t1 T1 or 2 if the returned assurance level would be above a certain threshold T e.g. T 90 at e.g. t2 t4 etc . Setting the threshold to 0 is undesirable because it would make it very easy for an attacker to shift the behavioral reference to his favor.

In one embodiment an adaptive authentication module dynamically selects among the available non intrusive authentication techniques and explicit intrusive authentication techniques to arrive at an assurance level sufficient for a current transaction with the relying party . Alternatively or in addition an adaptive authentication module on the relying party may perform the authentication selection techniques to arrive at a sufficient assurance level. The underlying principles of the invention remain the same regardless of whether the authentication selection techniques are implemented on the client device by adaptive authentication module or the relying party by the adaptive authentication module .

Moreover the relying party illustrated in may represent a trusted third party server which may implement the authentication techniques described herein on behalf of the relying party and provide the results to the relying party. Thus while the embodiments of the invention are described in terms of a relying party the underlying principles of the invention may be implemented using servers outside of the perimeter of the network operated by the relying party.

As discussed in greater detail below in one embodiment the adaptive authentication module includes a risk engine to determine a risk level based on variables associated with the client device e.g. based on current IP address IP packet round trip delay times etc . In addition an assurance level gain analysis component may determine the amount by which a current assurance level must be increased to arrive at an acceptable assurance level. While these elements are illustrated in as components of the adaptive authentication module of the relying party they may also be implemented within the adaptive authentication module of the client while still complying with the underlying principles of the invention.

In one embodiment once a client device connects to the relying party e.g. to initiate a transaction the risk engine determines the risk or an assurance level based on all data currently available. This may include for example a geo location of the client device e.g. as derived from the IP address or provided by a mobile network operator the round trip delay times of packets transmitted between the client device and relying party the number of hops for network packets sent between the client device and relying party a specific user agent string sent by a user agent executed on the client device to name a few. In one embodiment the risk engine then evaluates this data to arrive at an implicit risk score or a preliminary assurance level inversely related to the risk score which may be used to determine the amount of additional assurance required to authenticate the user for a given transaction.

In one embodiment based on the implicit risk score the adaptive authentication module on the relying party or the client device determines a set of one or more authentication modules with the potential of increasing the overall assurance level to the required level for an intended transaction i.e. when combined with the preliminary assurance level implicit risk score . In one embodiment the assurance level gain analysis module determines the amount of gain required and the adaptive authentication module is provided with an indication of the required assurance level gain as a parameter. The adaptive authentication module then uses this gain parameter in order to determine the most convenient set of authentication techniques non intrusive and or explicit in order to achieve at least the required gain. The adaptive authentication module may include a formal description of the selected set of authentication techniques in a response to the relying party e.g. as an authenticated extension . The relying party may then verify whether the resulting overall assurance level meets the required level.

By way of example and not limitation the adaptive authentication module may combine authentication modalities such as device fingerprinting e.g. recognizing sensor flaws or camera sensor pattern noise environmental information e.g. GPS based location location derived from WIFI networks existence of wired or wireless connections to other gadgets like Nymi smart watches pebble or peripherals like headsets . . . etc. behavioral data e.g. the way the user takes the device out of a pocket typing behavior gait . . . etc the time since the device was in a trusted state and potentially the result of a new explicit authentication using one or more authentication modalities biometric or otherwise required to achieve the required remaining gain in the assurance level.

The result of the above techniques is that users may opt for the most convenient authentication method. In the case of smartphones this may simply be having access to the phone see above . Instead of asking the user to select an authentication method and subsequently requiring the user for another explicit authentication the relying party sends an indication of the required assurance level gain to the adaptive authenticator which identifies the least intrusive set of authentication techniques. The adaptive authentication module does not always require an explicit intrusive user authentication like entering a PIN or swiping a finger nor is it solely based on non intrusive modalities. Instead the authenticator chooses the appropriate combination of all available modalities on the client side such that the required assurance level gain is achieved.

As discussed in detail above the time since the device was in trusted state is important as hacking spoofing modalities may take time. For example if a user loses a phone and someone attempts to hack it it may take a day before the fingerprint can be captured from the display an appropriate rubber finger created and subsequently used to gain access. Consequently requiring a PIN entry after 24 hours or less since last trusted state would be a sufficient protection against this type of attack. The next level of attack is one in which the fingerprint is captured before having access to the device. These attacks are seen less frequently in practice. However if the relying party needs protection against such attacks the adaptive authentication module may need to factor in location data or the existence of other gadgets or peripherals in order to accept the biometric modality.

A method in accordance with one embodiment of the invention is illustrated in . As discussed above the relying party as used herein may be the actual party relying on the accurate authentication of the user or may be a third party service authenticating the user on behalf of the relying party.

At the client device connects to the relying party to perform a transaction e.g. a transaction to log in to an online account a monetary transaction etc . At the relying party analyzes any available data related to the client device to determine a risk value and the required assurance level gain needed to authenticate the user. For example the data may indicate that the user is connecting to the relying party from an unknown network location e.g. a foreign country never previously visited by the user and or that the number of network routing hops or latency between the client and relying party is above a threshold. In such a case the risk value may be set to a relatively high value or conversely the implicit assurance level may be low . However if the user has just recently explicitly authenticated to the device e.g. entering a PIN then this would tend to decrease the risk level or raise the implicit assurance level .

Based on the assurance level required to complete the transaction the assurance level gain may be determined. This may be accomplished for example using an equation such as Implicit Assurance Level Assurance Level Gain Required Assurance Level or Assurance Level Gain Required Assurance Level Implicit Assurance Level. Various other equations may be used to determine the assurance level gain while still complying with the underlying principles of the invention.

At an indication of the needed assurance level gain is received. If non intrusive authentication techniques are sufficient to meet the assurance level gain determined at then they are used at to authenticate the user. If not then at one or more explicit authentication modalities are implemented potentially in combination with one or more non intrusive authentication modalities. As mentioned the modalities may be selected so as to be the least burdensome to the end user e.g. based on user specified preferences .

In contrast at time t4 the relying party asks for authentication with an assurance level gain of al4. The non intrusive authentication modality would only deliver al5 at that time as illustrated by the graph . As a consequence in this case the adaptive authenticator module will select at least one explicit authentication modality to raise the assurance level from al5 to al4.

While the secure storage is illustrated outside of the secure perimeter of the authentication device s in one embodiment each authentication device may have its own integrated secure storage. Alternatively each authentication device may cryptographically protect the biometric reference data records e.g. wrapping them using a symmetric key to make the storage secure .

Turning first to the illustrated embodiment includes a client equipped with one or more authentication devices for enrolling and authenticating an end user. As mentioned above the authentication devices may include biometric devices such as fingerprint sensors voice recognition hardware software e.g. a microphone and associated software for recognizing a user s voice facial recognition hardware software e.g. a camera and associated software for recognizing a user s face and optical recognition capabilities e.g. an optical scanner and associated software for scanning the retina of a user and non biometric devices such as a trusted platform modules TPMs and smartcards.

The authentication devices are communicatively coupled to the client through an interface e.g. an application programming interface or API exposed by a secure transaction service . The secure transaction service is a secure application for communicating with one or more secure transaction servers over a network and for interfacing with a secure transaction plugin executed within the context of a web browser . As illustrated the Interface may also provide secure access to a secure storage device on the client which stores information related to each of the authentication devices such as a device identification code user identification code user enrollment data e.g. scanned fingerprint or other biometric data and keys used to perform the secure authentication techniques described herein. For example as discussed in detail below a unique key may be stored into each of the authentication devices and used when communicating to servers over a network such as the Internet.

As discussed below certain types of network transactions are supported by the secure transaction plugin such as HTTP or HTTPS transactions with websites or other servers. In one embodiment the secure transaction plugin is initiated in response to specific HTML tags inserted into the HTML code of a web page by the web server within the secure enterprise or Web destination sometimes simply referred to below as server . In response to detecting such a tag the secure transaction plugin may forward transactions to the secure transaction service for processing. In addition for certain types of transactions e.g. such as secure key exchange the secure transaction service may open a direct communication channel with the on premises transaction server i.e. co located with the website or with an off premises transaction server .

The secure transaction servers are coupled to a secure transaction database for storing user data authentication device data keys and other secure information needed to support the secure authentication transactions described below. It should be noted however that the underlying principles of the invention do not require the separation of logical components within the secure enterprise or web destination shown in . For example the website and the secure transaction servers may be implemented within a single physical server or separate physical servers. Moreover the website and transaction servers may be implemented within an integrated software module executed on one or more servers for performing the functions described below.

As mentioned above the underlying principles of the invention are not limited to a browser based architecture shown in . illustrates an alternate implementation in which a stand alone application utilizes the functionality provided by the secure transaction service to authenticate a user over a network. In one embodiment the application is designed to establish communication sessions with one or more network services which rely on the secure transaction servers for performing the user client authentication techniques described in detail below.

In either of the embodiments shown in the secure transaction servers may generate the keys which are then securely transmitted to the secure transaction service and stored into the authentication devices within the secure storage . Additionally the secure transaction servers manage the secure transaction database on the server side.

One embodiment of the invention employs implicit location based authentication techniques in a manner which protects the end user s privacy. As mentioned above sharing a user s current location e.g. as provided by GPS with relying parties raises significant privacy concerns. Consequently users are often reluctant to share such data.

To address these issues one embodiment of the invention uses geolocation as a factor when performing implicit user authentication but does not disclose the user s location to the relying party. This embodiment may be implemented alone or in combination with other non intrusive and or explicit authentication techniques described above e.g. as part of a larger comprehensive authentication process . Instead of transmitting the actual location from the client device only an assurance level may be transmitted which is based at least in part on the geolocation data thereby protecting the user s privacy.

One embodiment employs the following operations for user device enrollment and registration with a relying party 

1. The user picks and specifies one or more locations where he she usually performs authentication with websites. This may be a region within a predefined miles or specific locations like office home transportation route etc . These selected locations may be stored locally on the client device and will not be sent to the relying party. These operations may be performed by the location authentication module described above. 2. In one embodiment after enrollment is complete the client device shares a key with the relying party over a secure communication channel e.g. using secure communication module and other registration techniques described herein .

1. The client device determines its current location using one or more geolocation techniques e.g. retrieving the current location using a location sensor such as an embedded GPS chip .

2. The location authentication module on the client compares the current location with already enrolled locations and produces a score indicating the distance e.g. from 0 100 . The assurance calculation module may then include the score in its assurance calculations as described above . 3. the client device generates a signature signs the score assurance level and sends it to the relying party for final authentication.

Embodiments of the invention may include various steps as set forth above. The steps may be embodied in machine executable instructions which cause a general purpose or special purpose processor to perform certain steps. Alternatively these steps may be performed by specific hardware components that contain hardwired logic for performing the steps or by any combination of programmed computer components and custom hardware components.

Elements of the present invention may also be provided as a machine readable medium for storing the machine executable program code. The machine readable medium may include but is not limited to floppy diskettes optical disks CD ROMs and magneto optical disks ROMs RAMs EPROMs EEPROMs magnetic or optical cards or other type of media machine readable medium suitable for storing electronic program code.

Throughout the foregoing description for the purposes of explanation numerous specific details were set forth in order to provide a thorough understanding of the invention. It will be apparent however to one skilled in the art that the invention may be practiced without some of these specific details. For example it will be readily apparent to those of skill in the art that the functional modules and methods described herein may be implemented as software hardware or any combination thereof. Moreover although some embodiments of the invention are described herein within the context of a mobile computing environment the underlying principles of the invention are not limited to a mobile computing implementation. Virtually any type of client or peer data processing devices may be used in some embodiments including for example desktop or workstation computers. Accordingly the scope and spirit of the invention should be judged in terms of the claims which follow.

