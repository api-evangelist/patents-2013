---

title: Systems and methods for wireless load balancing and channel selection for a wireless device using WLAN modules operating simultaneously in different wireless bands
abstract: Systems and methods for enabling a WLAN client to communicate simultaneously over more than one band at a time are described, where each client has at least one radio that is operational in each supported band. Load balancing based on traffic requirements optimizes the use of the multiple bands.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09402199&OS=09402199&RS=09402199
owner: NETGEAR, INC.
number: 09402199
owner_city: San Jose
owner_country: US
publication_date: 20131217
---
This application claims the benefit of and or the right of priority to U.S. Provisional Patent Application No. 61 890 713 entitled SIMULTANEOUS USAGE OF DIFFERENT WLAN MODULES which was filed on Oct. 14 2013 the contents of which are incorporated by reference in their entirety herein.

A wireless local area network WLAN client station such as a cell phone laptop and tablet communicate on a single wireless band at a time with an access point with which the client station is associated. In some instances a laptop client may be equipped with one or more WLAN radios which are designed to communicate in one of the multiple supported bands for example in either the 2.4 GHz band or the 5 GHz band. The conventional client does not use more than one band at a time. Furthermore the conventional laptop client typically by default uses the same band when it subsequently tries to connect to the access point.

Wireless access points may be equipped with one or multiple radios and may be active simultaneously in two or more bands. For example some access points are active in both 2.4 GHz and 5 GHz bands simultaneously.

Systems and methods for a wireless device that simultaneously communicates with wireless radios in different bands or two or more wireless radios in the same band are described. When multiple channels and or bands are available for transmitting wireless traffic by the wireless device certain factors may be considered for selecting channels and bands to optimize performance of the wireless device such as the requirements of specific types of traffic to be transmitted the distance of the recipient of the traffic from the wireless device the level of interference on the supported channels the time cost of changing channels and the received signal strength over the supported channels.

Additionally there are hardware optimizations to be considered in the design of a wireless device that operates simultaneously over multiple bands or channels. Antenna design to minimize the form factor of the wireless device is important as well as filtering of operational channels and bands from each other to minimize interference and saturation of receivers.

Conventional clients in a WLAN network communicate over a single channel in a single band with an access point or a peer in the network. Examples of communication bands include but are not limited to the 2.4 GHz and 5 GHz bands used by devices operating under IEEE 802.11 and WFA Wi Fi alliance protocols. However conventional clients do not currently communicate over more than one band to one or more other wireless devices in the network.

One reason for enabling simultaneous communication over multiple bands is to provide a more robust connection between wireless devices. The reliability of communications over wireless channels depends strongly upon the physical environment in which the communication is occurring and the physical environment and thus the characteristics of wireless channels are continuously changing. Moreover there is no reservation or spectrum assignment for devices in the industrial scientific and medical ISM bands used for wireless communication transmitters are only required to follow the Federal Communications Commission s rules regarding maximum power and other emission requirements. Thus interference may arise from one or more other transmitters operating in a same band as the wireless device. For example if a client is connected to a home access point and a microwave oven in the home is turned on a connection to the access point over the 2.4 GHz band may deteriorate due to interference because the microwave oven has emissions in the 2.4 GHz band. Similarly baby monitors also operate on the 2.4 GHz band so if a baby monitor is close to a cell phone or an access point the connection is also likely to deteriorate. Bluetooth devices are another class of wireless devices that may be active in the 2.4 GHz band. Moreover undesired noise may be emitted in the ISM bands from other devices in the home.

A conventional cell phone has hardware installed that allows it to connect to an access point over the 2.4 GHz band or the 5 GHz band but not both simultaneously. Further once the conventional cell phone has made a connection on one of the bands for example the 2.4 GHz band it may not switch to the 5 GHz band because the software may not be sufficiently sophisticated to identify that there is a problem on the 2.4 GHz band and switch over to the 5 GHz band. Even if the cell phone is sufficiently intelligent to switch bands when needed there may be a transition time between the bands during which the cell phone may not be able to transmit and receive data. However if a WLAN client such as a cell phone is connected simultaneously on both the 2.4 GHz band and the 5 GHz band or other bands as described herein and interference arises from for example a baby monitor operating in the 2.4 GHz band in the vicinity of the access point the cell phone can rely upon communications over a channel in the 5 GHz band rather than maintaining a noisy connection in the 2.4 GHz band or perhaps losing the connection altogether if the connection relies solely on a 2.4 GHz channel

Additionally even if there is no interference on either the 2.4 GHz or 5 GHz bands by using two connections simultaneously rather than a single connection the data throughput increases and the round trip time RTT may decrease.

Further an improvement in the communication range of a client that operates simultaneously over different bands can be achieved. For example with a client that communicates simultaneously over the 2.4 GHz band and the 5 GHz band on the 5 GHz band there is more bandwidth available than on the 2.4 GHz band but the range of transmissions at the 5 GHz band is shorter. So if the client also transmits simultaneously using the 2.4 GHz band there is an improved range performance because of the greater range available with transmissions in the 2.4 GHz band.

Yet further communicating simultaneously over multiple bands provides more robustness to wireless communications because packets can be re transmitted on a different band when a radio operating in a first band is not capable of delivering packets to the intended recipient. For example if a cell phone has a 5 GHz connection to an access point as the user of the cell phone moves farther away from the access point the 5 GHz connection may use lower transmission rates or it may disconnect due to path loss and drop its wireless signal. But if there is a simultaneous 2.4 GHz connection the cell phone may rely on the 2.4 GHz connection which has a greater range and the user will experience any interruption in service.

While communications over the 2.4 GHz band for example using one of the IEEE 802.11 n b g protocols and communications over the 5 GHz band for example using one of the IEEE 802.11ac n a protocols have been mentioned above other bands can also be used for communication instead of or in addition to these bands. These other bands include for example the 60 GHz band that follows IEEE 802.11ad protocol television white spaces TVWS having operating frequencies in the very high frequency VHS ultra high frequency UHF bands i.e. IEEE 802.11 of or others e.g. 470 MHz 790 MHz in Europe and 54 MHz 698 MHz in the United States and the sub 1 GHz ISM bands using the IEEE 802.11ah protocol whose exact ranges may by country dependent.

In some embodiments WLAN modules may have multiple radios that are active simultaneously in a particular band and or some WLAN modules may have multiple radios active simultaneously in different bands. The WLAN module may also include a radio which can be simultaneously active in more than one channel in one band and or more than one band. Examples of clients that these WLAN modules may be used with include desktop computers laptops tablets netbooks work stations cellular devices televisions entertainment centers satellite communication devices and other forms of computing devices.

Any of the different configurations for the WLAN module such as shown in can be used as an access point.

A simultaneous client may operate in a multiple input and multiple output MIMO mode in the two or more bands over which it is communicating. For example the simultaneous client can operate in a N N MIMO mode where N is an integer and up to N independent data streams can be transmitted at the same time and up to N independent data streams can be received at the same time. Thus for an N N wireless module the module can use N or more antennas to transmit each data stream and N or more antennas to receive each data stream. If an antenna is multi band the same antenna may be used for multiple bands. If antennas are single band different antennas may be used for different bands Details pertaining to multi band antennas are discussed further below.

A simultaneous client may also use different bandwidths for the bands selected for operation such as 20 MHz 40 MHz 80 MHZ 5 MHz 10 MHz 1 MHz 2 MHz 4 MHz 6 MHz 8 MHz and 16 MHz.

In some embodiments a WLAN module can be designed as a client module soft access point repeater or to use the Wi Fi Direct standard a tunneled direct link setup TDLS or to operate in any other IEEE 802.11 or Wi Fi mode. In some embodiments the WLAN module can be used an access point.

A simultaneous client module can be used as an internal device within a client device such as a laptop or cellular phone. Alternatively the simultaneous client module can be used as an external device that is designed to attach to one of the ports of the client device such as via a USB universal serial bus dongle or an Ethernet dongle. With the example connections to the WLAN modules shown in the WLAN modules can be used as either an internal or external device.

Many laptops use a peripheral component interconnect PCI or peripheral component interconnect express PCIe local computer bus for connecting devices to the laptop host processor. is a block diagram depicting an example connection between multiple WLAN modules and the host processor of the client device via a PCIe or PCI bus . The PCI or PCIe bus is shared by other PCI PCIe devices connected to the host processor . Alternatively the bus can be any other type of bus such as USB high speed inter chip HSIC serial ATA advanced technology attachment Ethernet SPI IC serial peripheral interface inter integrated circuit and FireWire. Although not shown explicitly in the functions of a simultaneous client processor can be a dedicated processor connected to the PCI PCIe bus . In some embodiments the functions performed by the simultaneous client processor can be distributed in any fashion among a dedicated simultaneous client processor processors in the WLAN modules and the host processor .

Although the simultaneous client processor is shown as a single processor in the example of the simultaneous client processor functions can be distributed in any fashion among the various WLAN modules the simultaneous client processor and the host processor . The simultaneous client processor and WLAN modules can be situated on a printed circuit board PCB that is used in a laptop or cell phone or they could be integrated in a chipset. For the case of an external device the simultaneous client processor and WLAN modules can be placed inside a physical box that houses a USB or Ethernet dongle.

The modules of the functional processor used for operating a simultaneous client can run on one or more processors in individual WLAN modules on a dedicated simultaneous client processor or on the host processor. In some embodiments the modules of the functional processor or even sub portions of the modules of the functional processor can be distributed among the host processor a dedicated simultaneous client processor and or any of the one or more processors in individual WLAN modules.

The functional processor and all of the elements included within the functional processor are implemented by using programmable circuitry programmed by software and or firmware or by using special purpose hardwired circuitry or by using a combination of such embodiments. Additional or fewer elements can be included in the functional processor and each illustrated component. As used herein a module of the functional processor includes a general purpose dedicated or shared processor and typically firmware or software modules that are executed by the functional processor . Some parts of the functionalities may be integrated in hardware as well. Depending upon implementation specific or other considerations the module can be centralized or its functionality distributed. The module can include general or special purpose hardware firmware or software embodied in a computer readable storage medium for execution by the functional simultaneous client processor .

Some embodiments of the functional processor include the packet ordering module which reads header information in received packets and orders them appropriately. If packets are not ordered appropriately when received packets transmitted over different bands may arrive in a different order from which they were transmitted. For example if packets 1 3 and 5 are sent over band A to the simultaneous client and packets 2 and 4 are sent over band B packet 4 may arrive before packet 3 thus resulting in a mis ordered sequence of packets because transmission times for packets over different bands may not be the same. When the simultaneous client is communicating over more than one channel or band at a time with another wireless device packets can be received on any of the channels from the other device depending upon the method that the transmitter is using to send the packets.

Some embodiments of the functional processor include an interface module that determines whether a wireless device to which the simultaneous client is communicating is capable of operating as a simultaneous client. For example if the simultaneous client associates with an access point and the access point is a legacy access point the access point does not know that the simultaneous client is communicating over multiple bands and thus may not appropriately order received packets resulting in communication problems. In such scenarios the functional processor may rely on the ordering capability of a server or the functional processor may use the multiple communication links over different channels and or bands in a way that ordering is not required. For example the functional processor can use each link for a different application and the functional processor may run separate instances of TCP IP internet protocol for each radio link in some applications.

Then at decision block the interface module determines from the received information whether the other wireless device has multi band communication capabilities. If the other wireless device does support communication over multiple bands simultaneously block Yes at block the interface module provides the information to the load balancing module and the simultaneous client communicates with the other device using the supported modes data rates and bands. In some embodiments the interface module selects the bands and channels for communicating with the access point or peer. In some embodiments the interface module receives the bands and channels selected for communication by the access point or peer.

If the other wireless device does not support communication over multiple bands simultaneously block No there are two options. At block the interface module can provide the information to the load balancing module and the simultaneous client communicates over the single band supported by the other device. Alternatively or additionally the interface module can provide the information to the multipath TCP module and at block the simultaneous client can communicate over multiple bands to the other device using multipath TCP. Alternatively or in addition the multipath TCP connection may be with a server in a home or in the cloud that supports multipath TCP. For example a file may be uploaded or downloaded using a multipath TCP connection to a file server which supports multipath TCP. In some embodiments a server that supports multipath TCP may be used as an intermediate relay device which in turn transmits the ordered packets to other servers that do not support multipath TCP.

Further the interface module can manage the use of channels by the simultaneous client with respect to other wireless devices. For example if the simultaneous client is operated as a soft access point peer to peer device or WiFi direct device and a client station wants to connect or associate with the simultaneous communication supporting device the interface module can determine the communication capabilities of the client station and then send information to the client station to ensure that the client station is using the appropriate communication channel s . In one scenario if the client station is not capable of communicating as a simultaneous client the interface module should transmit information about the channel to be used. And if the quality of that channel deteriorates due to interference or other problems the interface module should inform the client station that the communications will be moved to a different channel and or a different band.

Then at decision block the interface module of the access point determines whether the client is capable of operating as a simultaneous client. If the client is able to operate as a simultaneous client block Yes at block the access point communicates using the data rates and bands supported by the client and additional information such as the type of link aggregation supported by the access point how load balancing may be performed and the type of traffic or packets that should be transmitted on each channel. If the client is not able to operate as a simultaneous client block No at block the access point transmits information to the client regarding the appropriate channel to use that is supported by the client.

At decision block the access point determines whether there is a problem with the communication channel. If there are no problems block No the process remains at decision block . If there are problems block Yes the access point attempts to transmit information to the client to move to a different channel.

Some embodiments of the functional processor include the multipath TCP module which modifies conventional TCP transmission control protocol so that a standard TCP interface is presented to applications while the data is spread across several subflows. Multipath TCP is a technique that aggregates throughput over several wireless or wired connections via TCP layer link aggregation. Advantages of using multipath TCP include decreasing download time decreasing round trip time and increasing link resilience by improving the loss rate.

Layer 2 link aggregation can also be performed to aggregate throughput over multiple wireless connections as discussed below either alternatively or in addition to multipath TCP. Upper layer link aggregation may also performed for example using BitTorrent type applications multi server HTTP hypertext transfer protocol peer to peer aggregation methods server based aggregation methods or other methods that may be used at the application layer.

Conventional multipath TCP aggregates the use of two different wireless transmission methods namely a WLAN link and a cellular link between a server and a wireless device. In contrast described herein is the use of multipath TCP over two links of the same type for example two WLAN links between two wireless devices. For example a home access point or home gateway can use multipath TCP to aggregate a link or two peer clients may use multipath TCP and communicate with each other using soft access point mode wifi direct peer to peer or other some other mode.

As a specific example shows a block diagram of multipath TCP connections created between two cellular phones. The two phones such as iPhones may communicate using an application such as FaceTime where both voice and video are transmitted between the two phones . One of the phones can identify the location of the other phone and start sending voice and video traffic directly via multipath TCP without the use of an intermediate server. However in some situations the phones may not be able to communicate directly because of the use of filters and blockers in the network. Thus in this situation to communicate with each other the phones can use a relay server . Then a first multipath TCP connection is created between the first phone and the relay server and a second multipath TCP connection is created between the relay server and the second phone . The use of multipath TCP connections between communicating wireless devices creates better quality connections between the devices .

While the example of wireless phones was used in the example of the concept is equally applicable to other wireless devices such as gaming devices that have a low latency requirement. For example if a first game console such as an Xbox streams gaming data to a second game console the game consoles can communicate directly with each other using multipath TCP or alternatively they can communicate with a relay server via multipath TCP. In this case using multipath TCP can help minimize round trip delays in transmissions between the gaming consoles.

Additionally a multipath TCP connection can be used between one wireless device and a relay server where the relay server is used to forward data to a server that does not support multipath TCP. For example as shown in the example scenario in if a wireless client wants to connect to a file server to request a file transfer and the file server is not capable of performing multipath TCP a multipath TCP connection can be created between the wireless client and a home access point or a second server that is capable of supporting multipath TCP. Then the home access point or the second server acts as a relay and orders the packets received over multipath TCP before sending the ordered packets down to the next lower layer for transmission to the file server .

When the multipath TCP module initiates a multipath TCP connection with another wireless device by sending a SYN packet a first flow is established. Each end host is then aware of the other peer s internet protocol IP address. When the simultaneous client has another interface available such as a second WLAN channel the multipath TCP module notifies the other wireless device of its additional IP address with an Add Address option over the previously established subflow and sends another SYN packet to initiate another connection along with a JOIN option to the other wireless device s known IP address. With the JOIN option with multipath TCP the second subflow will be associated with the previously established multipath TCP connection over the WLAN. Because the multipath TCP technique can leverage the TCP handshake it can bootstrap subflows rapidly faster than application layer aggregation. In addition multipath TCP works for all existing TCP applications.

Because many WLAN clients are behind Network Address Translations NATs when the simultaneous client has an additional interface it is difficult for another device to directly communicate with the simultaneous client directly as the NATs typically filter out unidentified packets. The simultaneous client can send an Add Address option on the established subflow to notify the other wireless device of its additional interface. Then as soon as the wireless device receives the Add Address option it sends out another SYN packet with JOIN option to the simultaneous client s newly notified IP address along with the exchanged hash key for the new multipath TCP connection to initiate a new subflow.

Each multipath subflow behaves like a legacy TCP flow except for the congestion control algorithms. With multipath subflow after the three way handshake is used to establish connections each subflow maintains its own congestion window and retransmission scheme during data transfer. The congestion control window begins with a slow start phase that doubles the window per round trip time before entering the congestion avoidance phase.

Some embodiments of the functional processor include the load balancing module that determines how to distribute data packets over the available bands when multiple bands are used by the simultaneous client for communication with one or more wireless devices. The load balancing module may choose which packet is transmitted on which band in a dynamic packet to a packet base static base or semi static base.

The simplest scenario is simply to use one radio operating at one channel or band and if there is interference or other problems to switch to a second radio operating at a different channel or band although this does method does not take advantage of simultaneous operation over multiple bands.

In some embodiments WLAN priority assignments can be used as a guide to selecting bands of operation. For example voice traffic is assigned the highest priority video traffic is assigned the next highest priority best effort traffic is assigned the next highest priority and background traffic is assigned the lowest priority. For the highest priority traffic the load balancing module can select the best band at the time for transmitting the traffic where the best band has the lowest amount of interference. The load balancing module can track and maintain in a memory statistics on the level of noise or interference on each channel in which a wireless module is operating.

In some instances a certain percentage of available channels and or bands can be reserved for each priority class of traffic and the channels can be ranked based upon the most recent throughput data.

In some embodiments the load balancing module can maintain dedicated channels in certain bands for certain types of traffic. Thus for example voice traffic can be assigned to a first channel and band video traffic can be assigned to a second channel and band best effort traffic can be assigned to a third channel and band and background traffic can be assigned to a fourth channel and band. However based upon operating conditions traffic can be shifted to other channels and or bands. For instance if there is no voice traffic and there is a high amount of video traffic the load balancing module can send some of the video traffic over the first channel and band previously reserved for voice traffic. Or the load balancing module can send some of the video traffic over the fourth channel and band previously reserved for background traffic and the background traffic can be delayed until a later time.

The load balancing module can base band selection on specific requirements for a certain traffic type. For example if a 10 Mbit s connection needs to be maintained for video traffic and the recipient is close to the simultaneous client a 5 GHz band may be selected. If the recipient moves farther away one solution is to move to the 2.4 GHz band because it has a larger range. Another solution is to use both bands so if the 5 GHz band can maintain a transmission throughput of 2 Mbit s then the other 8 Mbit s can be shifted to the 2.4 GHz band.

For some applications such as gaming or voice over IP internet protocol the delay and delay variation requirements are important for the load balancing module to consider. To ensure that delay is minimized the load balancing module may choose to send multiple copies of the same packet over different bands and the recipient can combine the packets from the different bands to recover the sequence of packets with a minimum of delay. That is the best and earliest packet received over the different bands for each of the packets in a sequence can be selected when ordering the sequence of packets. The load balancing module can also attempt to minimize the number of retries for transmitted packets. For each packet that is transmitted by the simultaneous client the client expects to receive an acknowledgment for that packet. However if no acknowledgment is received the packet will be re transmitted until a maximum number of retries is reached typically up to six retries are performed. But for delay sensitive applications the maximum number of retries may be limited to one or two.

Techniques such as channel coding across channels and bands may also be implemented by the load balancing module to minimize the number of retries. With channel coding data can be encoded and different portions of the encoded data can be sent over two or more channels for example a first portion of the encoded data can be sent over a first channel and another portion of the encoded data can be sent over a second channel where the first and second channels can be in the same or different bands. Then at the receiver a channel decoder is used to combine the information received over the two or more channels. By using channel coding and transmitting different portions of the encoded data via different channels there is a higher likelihood that the transmitted data can be recovered at the receiver than if the data were sent uncoded via a single channel.

In some instances because the quality of the wireless channels is continuously changing due to environmental changes even if there are initially dedicated channels assigned to certain types of traffic traffic sent over the channels may be shifted when interference arises on one or more of the channels. For example if the channel dedicated to voice traffic suddenly experiences more path loss smaller rank or more noise the best channel and band dedicated to best effort traffic may be taken over for voice traffic and the best effort traffic may be shifted to the channel and band previously reserved for the lower priority background traffic.

In some embodiments channels and bands may be selected by the load balancing module based upon rate versus range data. In some instances the load balancing module can use all or a subset of its wireless modules to achieve the best overall rate versus range. If the simultaneous client is communicating with more than one wireless device it may decide to select channels and bands for communication based on the RSSI received signal strength indicator and the matrix rank for MIMO devices of each wireless device in each band that is supported. In addition the RSSI and the quality of service QoS requirement of the packets to be transmitted can be used as criteria for selecting bands of operation.

Power consumption considerations may also be taken into account for choosing the channel or channels that are to be used for transmitting data. Power consumption in an idle state is important for battery operated devices and thus the load balancing module may apply methods to minimize the power consumption of a device which is in a low power state. For example the control packets or regular keep alive packets may be transmitted on a band that requires the least power consumption to have the minimum idle power consumption such as 2.4 GHz or sub 1 GHz bands. But when the device is not in a low power mode and is transmitting more data the load balancing module may switch the traffic to a band that has more bandwidth and provides a faster way to perform data exchange such as the 5 GHz band.

When traffic is moved from one channel to another channel there is a time cost associated with the channel change. On the recipient s side many packets may already be buffered so for example if the band is changed from the 2.4 GHz band to the 5 GHz band then the buffer may be flushed and previously transmitted and buffered data would need to be re transmitted. Thus the load balancing module should first determine that there is a minimum margin of improvement before moving from one channel or band to another.

In some embodiments the load balancing module can decide which channels and bands to use based upon the link conditions e.g. path loss for the link on which the packet is being transmitted. For example if the intended recipient of packets has a good RSSI the 5 GHz band may be more suitable than the 2.4 GHz band independent of the type of traffic. Thus if there is a concurrent or reconfigurable radio that can operate at either 5 GHz or 2.4 GHz or both the load balancing module can direct the radio to operate at a channel in the 5 GHz band.

In some embodiments the load balancing module can make a socket based band selection. A network socket is an endpoint of an inter process communication flow across a computer network and a socket address is the combination of an IP address and a port number. Socket differentiation may be performed for different types of sockets such as datagram sockets for UDP connection oriented sockets for TCP and SCTP stream control transmission protocol and raw sockets. Then for each socket that is created the load balancing module can select which channel to use and which stack to use to create that network socket. The decision as to which band is to be used for a socket may be based on the requirements for that socket. For example during a web browsing session a TCP socket may be created using HTTP Hypertext Transfer Protocol to retrieve data from a server. The web browser may then create a connection to a Google website using the TCP IP stack on the 2.4 GHz band selected by the load balancing module and then create a connection to the YouTube website to retrieve a video using a TCP IP stack on the 5 GHz band selected by the load balancing module .

Some embodiments of the load balancing module may extend to wireless network link aggregation control protocols for Ethernet as defined in IEEE 802.1ax IEEE 802.3ad or other aggregation mechanisms. For example some standard and proprietary protocols that can be extended include port trunking link bundling Ethernet bonding network bonding NIC network interface controller bonding and NIC teaming. Link aggregation techniques may be used when both wireless devices that desire to communicate support simultaneous client functionality. These protocols can also be extended to include the following scenarios when a simultaneous client can associate with another wireless device but not vice versa when a simultaneous client loses a connection in the middle of a stream of traffic when the quality of the connection is very poor on one side when a simultaneous client places packets with higher priority on the side that has a better channel condition.

If there is traffic to be distributed block Yes at block the load balancing module selects the channels bands for distribution based at least on some distribution criteria. Some of the distribution criteria that the load balancing module considers in selecting channels bands for traffic and determining whether to move traffic to a different channel band include but is not limited to the priority of the traffic the requirements of each type of traffic such as throughput delay delay variation maximum number of retries and QoS the path loss channel rank or distance of the recipient from the simultaneous client the level of interference on the channels the time cost of changing channels and the RSSI of the current channel.

Then at block the load balancing module routes the traffic to be distributed to the selected channels bands.

Then at decision block the load balancing module determines whether there is a problem with the selected channels bands. For example the wireless module may have a failure that prevents it from transmitting and or receiving packets. If there is a problem block Yes the load balancing module moves the traffic to the next best channel band.

If there are no problems block No at decision block the load balancing module determines whether the level of interference on the current channel is beyond a threshold. If the level of interference is not beyond the threshold block No the process returns to decision block .

If the level of interference is beyond the threshold block Yes at decision block the load balancing module determines whether there is a channel available with a minimum margin of improvement. If there is a channel available block Yes at block the load balancing module moves the traffic to the next best channel with the minimum margin of improvement.

If there is no channel available with the minimum margin of improvement block No at decision block the load balancing module determines whether there is a better rate versus range using another channel. If there is a better rate versus range block Yes at block the load balancing module moves the traffic to the channel that provides the better rate versus range.

If there are no channels that provide a better rate versus range block No the process returns to decision block .

Some embodiments of the functional processor include the layer 2 aggregation control module that manages functions for the multiple radios in layer 2 such as association rate control keeping track of active links etc. The layer 2 aggregation control module can perform layer 2 aggregation as well. Packet ordering may be done in layer 2 the TCP layer or the application layer and portions of layer 2 can perform part of or all of the process of ordering packets.

Some embodiments of the functional processor include the reconfiguration module that reconfigures one or more reconfigurable wireless WLAN modules to operate in a specific band and or at a specific channel of the band.

Some embodiments of the functional processor include the hardware control module that controls hardware switches that redirect signals to or from antennas for example as shown in and discussed in more detail below.

Alternatively or additionally the hardware control module can control a hardware switch for directing where a signal that may be used by a cellular radio and or a simultaneous client as shown in the example of and discussed in more detail below.

Some embodiments of the functional processor include the power control module . There is a standard IEEE 802.11ah that is being developed for low power sensors that uses the sub 1 GHz ISM bands. Low power sensors typically do not need very much bandwidth to transmit data but they run on batteries and need to conserve power. The IEEE 802.11ah standard is intended to save sensor power rather than provide high performance with high throughput of data as compared to the IEEE 802.11ac standard defined for the 5 GHz band. Further because the sub 1 GHz e.g. 900 MHz band does not have as much bandwidth as the 2.4 GHz and 5 GHz bands if a simultaneous client is not transmitting much data the power control module can direct the data to be transmitted by the WLAN module operating over the sub 1 GHz band using the IEEE 802.11ah protocol to save more power and when a lot of traffic needs to be sent it can direct the data to be sent over either the 2.4 GHz or 5 GHz band. The power control module can also use the sub 1 GHz band with the IEEE 802.11ah protocol for control data and the 2.4 GHz or 5 GHz band for transmitting the data itself.

In some embodiments one or more bands e.g. sub 1 GHz or 2.4 Hz may be used as the control channel while one or more bands may be used as the data channel e.g. 5 GHz or 60 GHz . The channels or bands with less power consumption may be more suitable for control packets.

If the transmission rate is not high block No at block the power control module directs the data to be sent over the sub 1 GHz e.g. 900 MHz band using the IEEE 802.11ah protocol. Then the process returns to decision block .

If low power support is needed block Yes at block the power control module transmits the traffic over a wireless band such as the sub 1 GHz band which support use of a power saving protocol for example IEEE 802.11ah. If low power support is not needed block No at block the power control module transmits the traffic over a different wireless band that does not necessarily use a power saving protocol.

When the above modules of the functional simultaneous client processor are properly implemented the conventional IP layer or layer 3 of the OSI does not need to be aware of the multiple simultaneous connections that take place in the layer below i.e. layer 2. There are several different implementation models that can act as an intermediate layer between layer 2 and layer 3. The intermediate layer passes received packets in the correct order up to TCP IP of layer 3 and packets received from TCP IP are sent on the appropriate bands selected by the intermediate layer to optimize traffic requirements. Any type of stacks may be used on top of the intermediate layer such as TCP IP and UDP user datagram protocol IP. In some embodiments some or all of the functions of the functional simultaneous client processor can be implemented by modifying the functions performed at layer 3.

The WLAN module that operates over band A includes software hardware module that performs the PHY layer functions software hardware module that performs the lower MAC layer functions and software hardware module that performs the upper MAC layer functions such as packet ordering load balancing etc. The WLAN module that operates over band B includes software hardware module that performs the PHY layer functions software hardware module that performs the lower MAC layer functions and software hardware module that performs the upper MAC layer functions. The WLAN module that operates over band C includes software hardware module that performs the PHY layer functions software hardware module that performs the lower MAC layer functions and software hardware module that performs the upper MAC layer functions. Thus each core or chipset implements three layers of software hardware that perform the communication functions of the PHY layer the lower MAC layer and the upper MAC layer.

In this implementation no changes are made to the functions performed by the PHY layer software hardware modules the lower MAC layer software hardware modules or the upper MAC layer software hardware modules . A software hardware module is added on top of the upper MAC layer that uses an application programming interface API to retrieve information from the upper MAC layer modules and to write information back to the upper MAC layer modules . Because no changes are made to the existing software hardware modules of the cores chipsets there is less control over these modules than with other implementation models described below.

To implement the model shown in the example of if standard chipsets are used only the functions performed by software in the upper MAC layer can be merged into the module while hardware in the chipsets still perform their upper MAC layer functions. However custom hardware chipsets can be designed such that the hardware chipsets only perform the functions of the lower MAC and PHY layers while the upper MAC layer functions performed by the hardware and software of conventional chipsets are merged into module .

To implement the model shown in the example of if standard chipsets are used only the functions performed by software in the upper MAC layer and lower MAC layer can be merged into the module while hardware in the chipsets still perform their upper MAC layer and lower MAC layer functions. However custom chipsets can be designed such that the chipsets only perform the functions of the PHY layer while the upper MAC layer and lower MAC layer functions performed by the hardware and software of conventional chipsets or cores are merged into module .

While three modules for three bands are shown as an example the implementation model can be adapted for use with any number of modules for two or more bands. All these functionalities may be combined into one chipset or the functionalities could be distributed among more than one chipset.

In some embodiments each of the above described modules can be performed by a specially designed chipset.

The host processor not shown in the host platform communicates with the processor in the simultaneous client . In the example of the simultaneous client is external to the host platform but the simultaneous client can also be implemented internally to the host platform . Each of the three WLAN modules provide an input into a triplexer that multiplexes the inputs and the output of the triplexer is sent to the antenna for transmission to the access point .

The antenna used in a simultaneous client can include one or many antennas. To reduce the total number of antennas needed for a simultaneous client and thus to reduce the form factor of the simultaneous client multiband antennas that are resonant at more than one band can be used.

For personal computers laptops tablets and cell phones examples of types of multiband antennas that can be used include PIFA antennas planar inverted F antennas meander line monopole antennas chip antennas and patch antennas. The advantages of a PIFA antenna are a small size an omni directional radiation pattern low cost and high efficiency. With a meander line monopole antenna a small form factor is an advantage. These types of antennas are presently used in personal computers as dual band antennas that can transmit at either 2.4 GHz or 5 GHz. Dual band antennas have a single feed and components that are resonant at each of the selected bands. Thus they can transmit at both bands simultaneously. These antennas can be designed to have components that resonate at more than two bands simultaneously as well.

Ultra wideband UWB antennas are antennas that resonate over a range of frequencies although the radiation pattern created by a UWB antenna changes as a function of frequency. UWB antennas have a large size so they are mostly useful for outdoor applications for simultaneous clients. Examples of UWB antennas include bowtie antennas horn antennas Vivaldi antennas and spiral antennas. Bowtie antennas have a simple structure and so are easy to manufacture and have an omni directional radiation pattern which is useful for multi point connections. While horn antennas may be more expensive and more difficult to manufacture horn antennas are directional so they can be useful for point to point applications. Vivaldi antennas also have a simple structure similar to bowtie antennas however Vivaldi antennas are directional and thus useful for point to point applications. Spiral antennas are large have circular polarization have high gain and are directional in opposing directions.

Conventional cell phones that operate over multiple cellular bands can use an active matching antenna that is adjustable to be resonant at a particular frequency and has a small form factor. As a cell phone is only used on a single cellular band at a time an active matching antenna is a good choice for cell phones. However the widely used active matching antennas may only be useful for single band usage not simultaneous multiple band usage. A block diagram of the antennas of a cell phone is shown in where both a WiFi or WLAN antenna and a 2G 3G LTE antenna are used in a cell phone but not simultaneously. The WLAN antenna operates at either the 2.4 GHz band or the 5 GHz and the 2G 3G LTE antenna operates at the 900 MHz band.

Because a simultaneous client necessarily operates at two or more bands simultaneously the active matching antenna on its own will not be sufficient for a simultaneous client. However as shown in the example block diagram of an active matching antenna can be multiplexed with a multiband antenna such as a chip antenna or meander line antenna to provide the functionality needed for a simultaneous client. In some embodiments the simultaneous client can operate simultaneously in three bands 2.4 GHz 5 GHz and sub 1 GHz. Current multiband chip antennas are available that resonate at 2.4 GHz and 5 GHz even though the chip antennas are not currently used to resonate at these bands simultaneously. Additionally a cellular antenna can be used for the sub 1 GHz e.g. 900 MHz band. The outputs of the multiband antenna and the cellular antenna can be multiplexed together by a multiplexer resulting in operation as a tri band module for the simultaneous or concurrent client .

The cellular antenna can play a dual role. In the first role the cellular antenna can be used as an antenna just for a cellular radio . In this role the switch splitter is adjusted to connect the cellular antenna to the cellular radio . A switch can be used if the cellular radio and the concurrent client do not operate at the same time. Alternatively in the second role the cellular antenna sends a signal to both the cellular radio and the simultaneous client . The switch splitter is used as a splitter can be used to divide the signal from the cellular antenna and sends part of the signal to both the cellular radio and the simultaneous client . The portion of the signal intended for the simultaneous client is first coupled to an active matching circuit that tunes the resonant frequency of the cellular antenna to the appropriate channel frequency in the sub 1 GHz e.g. 900 MHz band for use with the simultaneous client . In this way the frequency at which the simultaneous client operates can be different from the frequency at which the cellular phone operates. When the output of the actively matched antenna is multiplexed with the output of the dual band WLAN antenna a tri band antenna is available for use with the simultaneous client . While the three specific bands 5 GHz 2.4 GHz and sub 1 GHz e.g. 900 MHz were described with respect to because components operating in these bands are readily available any other bands can be used with the multiplexing technique.

As an alternative to the multiband antenna solutions discussed above one or more single band antennas can be used for each band for a simultaneous client. This solution may be preferable because the multiband antennas radiation pattern changes as a function of frequency and using single band antennas will provide a better radiation pattern with more consistency across the bands. However using single band antennas optimized for each band takes up more space and may be more expensive although this solution may be feasible for large clients.

In some embodiments a wideband amplifier can be used to amplify two or more channels in the same band or even two or more channels in multiple bands. The wideband amplifier can be used to replace two or more power amplifiers and or two or more low noise amplifiers.

One or more frequency filters may need to be used in a simultaneous client to prevent interference between modules operating in the same band and between modules operating in different bands.

Interference may arise between modules operating in different bands if a harmonic of the frequencies in one band are close to the frequencies in a second band. For example if the simultaneous client operates in the 2.4 GHz band and the 5 GHz band simultaneously the second harmonic of transmissions in the 2.4 GHz band are at 4.8 GHz which is very close to the 5 GHz band. Thus the transmissions at the 2.4 GHz band should be filtered to prevent the transmissions from saturating the receiver at the 5 GHz band. Additionally transmissions at the 5 GHz band may have unwanted noise or scattering that generates interference in the 2.4 GHz band. Consequently transmissions at the 5 GHz band should be filtered to protect communications at the 2.4 GHz band.

For a band that has a fairly large bandwidth such as the 5 GHz band modules can operate at multiple frequencies within the band if the frequencies are sufficiently far apart. For example if the bandwidth of each frequency is 80 MHz a first 80 MHz channel can be used in the low frequency range of 5 GHz and a second 80 MHz channel can be used in the high frequency range of 5 GHz. By using filtering between these two frequency bands communications at the different channels can operate without influencing each other. While a similar technique can be used with a band that is relatively narrow such as the 2.4 GHz band the filter requirements needed to prevent interference between frequencies used in the 2.4 GHz band are more stringent and thus more expensive.

Frequency filters that can be used to prevent interference between modules operating in different bands or even between modules operating in the same band can use one or more bandpass filters low pass filters and high pass filters. Examples of types of filters that can be used include but are not limited to micro strip filters ceramic filters low temperature co fired ceramic LTCC filters surface acoustic wave SAW filters bulk acoustic wave BAW filters film bulk acoustic resonator FBAR filters cavity filters and waveguide filters.

Methods and systems for simultaneously using multiple WLAN modules operating in different channels and or bands have been described. As used herein the terms connected coupled or any variant thereof means any connection or coupling either direct or indirect between two or more elements. It will be appreciated by those of ordinary skill in the art that the concepts and techniques described herein can be embodied in various specific forms without departing from the essential characteristics thereof. The presently disclosed embodiments are considered in all respects to be illustrative and not restrictive. The scope of the embodiments indicated by the appended claims rather than the foregoing description and all changes that come within the meaning and range of equivalence thereof are intended to be embraced.

