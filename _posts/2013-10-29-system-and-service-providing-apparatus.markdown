---

title: System and service providing apparatus
abstract: A disclosed system having a first service providing system providing a service to an apparatus and a second service providing system having an authentication infrastructure different from that of the first service providing system includes a connection destination changing unit receiving a permission request, from an apparatus operated by a first user, of requesting that a second user uses the second service providing system, changes a connection destination of the apparatus to the second service providing system, and causes the second service providing system to perform a permission process; an authority information acquiring unit receiving permission information indicating that the permission request is admitted from the apparatus and acquires post-permission authority information by using the permission information; and an authority information providing unit providing the post-permission authority information associated with the second user based on a request for a process received from another apparatus operated by the second user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09288213&OS=09288213&RS=09288213
owner: RICOH COMPANY, LTD.
number: 09288213
owner_city: Tokyo
owner_country: JP
publication_date: 20131029
---
An exemplary access authority management system performs a central management for access management or authority delegation in a case where an apparatus accesses another apparatus by proxy using authority delegated from a user to the apparatus for the purpose of decreasing information exchanged between the apparatuses. The access authority management system is described in for example International Publication Pamphlet No. 2009 084601.

The exemplary access authority management system includes authentication device managing conditions for delegating authority a service providing apparatus for providing a service in response to a service request and a service delegate access apparatus accessing the service providing apparatus by proxy.

In recent years attention has been given to a usage mode of providing functions of a web application or of an application on a server side as a service. Typically this service is known as a cloud computing service . In this usage mode authentication is necessary to enjoy a service in response to the authority of a user.

Further a usage mode of associating a plurality of services is known to be watched. This usage mode is typically mashup . In this usage mode permission is necessary in order to be provided with another service in response to authority by which one service is delegated from a user.

In the usage mode where a plurality of services are associated the user is required to follow a permission procedure for each of other services when the user is provided with the other services in response to authority of one service delegated by the user.

Accordingly embodiments of the present invention provide a novel and useful system and a service providing apparatus solving one or more of the problems discussed above.

More specifically the embodiment of the present invention is provided in view of the above. The object of the present invention is to provide a system and a service providing apparatus by which the number of permission procedures performed by a user in order to use a service can be reduced.

One aspect of the embodiments of the present invention may be to provide a system having a first service providing system that provides a service to an apparatus and a second service providing system that has an authentication infrastructure different from that of the first service providing system including a connection destination changing unit that receives a permission request from an apparatus operated by a first user of requesting that a second user uses the second service providing system changes a connection destination of the apparatus to the second service providing system and causes the second service providing system to perform a permission process an authority information acquiring unit that receives permission information indicating that the permission request is admitted from the apparatus and acquires post permission authority information for using the second service providing system by using the permission information from the second service providing system and an authority information providing unit that provides the post permission authority information associated with the second user based on a request for a process using the second service providing system the request is received from another apparatus operated by the second user.

Additional objects and advantages of the embodiments will be set forth in part in the description which follows and in part will be clear from the description or may be learned by practice of the invention. Objects and advantages of the invention will be realized and attained by means of the elements and combinations particularly pointed out in the appended claims.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory only and are not restrictive of the invention as claimed.

A description is given below with reference to through of embodiments of the present invention. Where the same reference symbols are attached to the same parts repeated description of the parts is omitted.

The network N is a private network inside the firewall FW. The firewall FW is installed at a node between the network N and the network N. The firewall FW detects and blocks an unauthorized access. A client terminal a mobile terminal an image forming apparatus such as a multifunction peripheral a projector and an extra apparatus such as an electronic copyboard.

The client terminal is an example of a terminal device. The client terminal is substantialized by an information processing apparatus a computer system in which an ordinary OS or the like is installed. The client terminal includes a wired or wireless communication means. The client terminal is a terminal which can be operated by the user such as a tablet PC or a notebook PC.

The mobile terminal is an example of the terminal device. The mobile terminal includes a wired or wireless communication means. The mobile terminal such as a smartphone a portable phone a tablet PC a notebook PC or the like can be brought by the user.

The image forming apparatus is an apparatus having an image forming function such as a multifunction peripheral. The image forming apparatus has a wireless or wired communication means. The image forming apparatus is an apparatus of performing processes related to image formation such as a copier a scanner a printer or a laser printer. The projector is an apparatus projecting an image. The projector includes a wired or wireless communication means.

Referring to for example the number of the client terminal the number of the mobile terminal the number of an image forming apparatus the number of the projector and the number of extra apparatus are single. However these numbers may be plural.

The network N is connected to the network N such as the Internet by an access controlling apparatus . Security of the network N is protected by the access controlling apparatus . A print service providing apparatus a scan service providing apparatus a management setup service providing apparatus and extra service providing apparatus are connected with the network N. In the system illustrated in the access controlling apparatus the print service providing apparatus the scan service providing apparatus the management setup service providing apparatus and the extra service providing apparatus substantializes the service providing system.

The access controlling apparatus controls login to various services such as the print service provided by the print service providing apparatus the scan service provided by the scan service providing apparatus the management setup service provided by the management setup service providing apparatus or the like.

The access controlling apparatus the print service providing apparatus the scan service providing apparatus the management setup service providing apparatus and the extra service providing apparatus are substantialized by one or more information processing apparatuses a computer system .

The print service providing apparatus the scan service providing apparatus the management setup service providing apparatus and the extra service providing apparatus may be substantialized by integrating into one computer or by distributing into a plurality of computers.

The network N is connected to the network N such as the Internet by an access controlling apparatus . Security of the network N is protected by the access controlling apparatus . One or more external service providing apparatuses are connected to the network N. In the system of the external service system is substantialized by the access controlling apparatus and the external service providing apparatus .

The access controlling apparatus controls login to the external service provided by the external service providing apparatus . The access controlling apparatus and the external service providing apparatus are substantialized by one or more information processing apparatuses computer systems . In the system of the external service providing apparatus may be substantialized by integrating into one computer or by distributing into a plurality of computers.

A part of the service on the side of the network N may exist outside the network N. The mobile terminal may exist in a network such as an inter office network outside the network N. In the system of the mobile terminal exists in the network N and the network N such as the Internet. In the system of the number of the external service system is one. However the number of the external service system may be plural.

In the system of a standard technique called OAuth approved by API is used. The service providing system corresponds to a Consumer of OAuth. The external service system corresponds to a Service Provider SP of OAuth.

The external service system publishes Web Application Programming Interface API . The user can access a resource stored in the external service system and a service handling the resource within a range of authority of the user himself or herself through WebAPI.

Further the print service providing apparatus or the like of the service providing system can access a resource stored in the external service system or a service handling the resource within a range of the authority delegated from the user by using a permission token based on the authority delegated from the user.

The client terminal the mobile terminal the access managementling apparatus the print service providing apparatus the scan service providing apparatus the management setup service providing apparatus and the extra service providing apparatus are substantialized by for example a computer system having a hardware structure illustrated in . Further the access controlling apparatus and the external service providing apparatus are substantialized by for example the computer system having the hardware structure illustrated in .

The input device includes a keyboard a mouse a touch panel and or the likes by which the user inputs various operation signals. The display device includes a display or the like to display a processing result obtained by the computer system .

The communication I F is an interface provided to connect the computer system to the networks N to N. Thus the computer system can perform data communications with another device and or another apparatus through the communication I F .

The HDD is a non volatile memory device storing programs and or data. The program and or data to be stored is an operating system OS which is basic software controlling the entire computer system application software providing various functions in the OS and so on. Further the HDD manages the stored program and the stored data using a predetermined file system and or a predetermined data base DB .

The external I F is an interface with an external apparatus. The external apparatus is a recording medium or the like. With this the computer system can read information from the recording medium and or write information to the recording medium through the external I F . The recording medium includes a flexible disk a compact disk CD a digital versatile disk DVD an SD memory card a universal serial bus USB memory or the like.

The ROM is a non volatile semiconductor memory memory device which can hold program and or data even when a power source to the ROM is powered off. The ROM stores programs and data used for a basic input output system BIOS OS setup network setup or the like which are executed at a time of booting up the computer system . The RAM is a volatile semiconductor memory memory device temporarily storing programs and or data.

The CPU reads the program and or data onto the RAM from the memory device such as the ROM the HDD or the like. The read program or data perform the process to thereby entirely substantialize controls or functions of the computer system .

The client terminal the mobile terminal the access controlling apparatus the print service providing apparatus the scan service providing apparatus the management setup service providing apparatus and the extra service providing apparatus substantializes various processes described below by the hardware structure of the computer system . Further the access controlling apparatus and the external service providing apparatus can substantialize various processes described below using the hardware structure of the computer system .

The service providing system of the embodiment is substantialized by for example a processing block illustrated in . is an exemplary processing block chart of the service providing system of the embodiment. The service providing system substantializes a service application a platform a management data memory unit and a platform application programming interface API by executing the program.

The service application illustrated in includes for example a print service application a scan service apparatus a management setup service application and an extra service application whose number is one or more. The print service application is an application providing a print service. The scan service apparatus is an application for providing a scan service. The management setup service application is an application for providing management setup service. Further the extra service application is an application for providing any kind of service.

The platform API is an interface used when the service application such as the print service application the scan service apparatus the management setup service application the extra service application or the like uses the platform . The platform API is an interface previously defined so that the platform receives a request from the service application . The platform API is structured by for example a function a class or the like. In a case where the service providing system is structured by a plurality of distributed information processing apparatuses the platform API can use for example a Web API which is used through the network.

The platform illustrated in includes for example an authentication processing unit an device communication unit a session management unit and a data processing unit . The authentication processing unit performs authentication based on a login request received from office equipping device such as the client terminal the image forming apparatus or the like. The office equipping device is a collective term of the client terminal the mobile terminal the image forming apparatus the projector and the extra apparatus . The device communication unit communicates with the office equipping device or the external service system. The session management unit manages a session with the office equipping device or the external service system. The data processing unit performs data processing based on a request from the service application .

The management data memory unit includes an organization management information memory unit a user management information memory unit an apparatus management information memory unit a permission setup information memory unit an external service information memory unit a permission token information memory unit a data management information memory unit and a data storage as an example.

The organization management information memory unit stores organization management information described below. The user management information memory unit stores the user management information described below. The apparatus management information memory unit stores apparatus management information described below. The permission setup information memory unit stores permission setup information described below. The external service information memory unit external service information described below. The permission token information memory unit stores permission token information described below. The data management information memory unit stores data management information. The data storage stores other data or the like.

The service providing system functions as a cloud infrastructure having functions such as authentication or an asynchronous transformation a group of services providing a service such as a print service using the functions of the cloud infrastructure and a management setup service for performing a management setup of the services.

The cloud infrastructure is formed by for example the platform the management data memory unit and the platform API . The group of services is formed by for example the service application . The management setup service is formed by for example the management setup service application .

The function of the authentication in the cloud infrastructure of the service providing system is formed by for example the authentication processing unit and a database for the authentication.

The database for the authentication is formed by an organization management information memory unit a user management information memory unit an apparatus management information memory unit a permission setup information memory unit an external service information memory unit a permission token information memory unit and or the like.

Further the function of the asynchronous transformation in the cloud infrastructure of the service providing system is formed by for example the data processing unit a data management information memory unit and a data storage .

The group of services such as the service application provide the service by using the authentication included in the cloud infrastructure of the service providing system and the function of the asynchronous transformation. In a case where the group of services provides the service in association with the function of the external service system the group of the services acquires a permission token for accessing the external service system through the function of the authority included in the cloud infrastructure.

The management setup service application performs a management setup for a permission process. The management setup service application includes a UI for the permission procedure. The management setup service application registers permission setup information described below in association with the authentication processing unit .

The external service system is a system other than the service providing system . The external service system provides a service such as a cloud computing service. Within the embodiment the service the function provided by the external service system is called the external service. The external service includes an online storage service a storage and management service for a scanned document or the like.

The external service system has a function as a permission server which issues a permission token in response to a request from the authentication processing unit of the service providing system . A WebAPI is provided to the external service system. The WebAPI of the external service system receives a processing request using the permission token. The WebAPI is used to provide the service to the service application of the service providing system .

Referring to the authentication processing unit has a function as a permission client in the service providing system . Therefore organization management information user management information apparatus management information permission setup information external service information and permission token information which are commonly used by a plurality of service applications can be uniformly managed to thereby improve a security and reduce a management cost.

Further the service providing system uniformly manages a management process for managing the permission information such as the permission setup information the external service information and the permission token and the permission process into the authentication processing unit . Therefore various mashup services of associating a plurality of services can be provided without the service application by the permission procedure performed by the user only one time.

The service providing system illustrated in stores the organization management information the user management information the apparatus management information the permission setup information the external service information or the like which are information required to be perpetually stored in for example an HDD . The service providing system illustrated in may store information such as the permission token information whose expiration date is determined and whose life cycle is shorter than other information such as the organization management information the user management information the apparatus management information the permission setup information the external service information or the like which are information required to be perpetually stored in for example an HDD in for example a RAM an online memory in place of the HDD . By storing the above information in the on memory the permission token information can be read and written at a high speed. Thus a response becomes high.

The management setup service application is substantialized by a processing block illustrated in for example . is a processing block chart in the management setup service application of the embodiment. The management setup service application causes the computer system to function as a screen processing unit and an information registration requesting unit .

The screen processing unit performs processes related to the screen such as generation of the setup screen through which an administrator sets the management setup information. The information registration requesting unit requests the authentication processing unit to register information input into the screen such as the setup screen generated by the screen processing unit .

The authentication processing unit is substantialized by the processing block illustrated in for example . is an exemplary processing block chart in the authentication processing unit of the embodiment. The authentication processing unit includes an authentication unit an information registering unit a redirect requesting unit a permission token acquiring unit a permission token storing unit and a permission token providing unit .

The authentication unit receives a request for authentication and issues an authentication ticket. The information registering unit receives a request for registration of information and registers the information. The redirect requesting unit request the office equipping device such as the client terminal operated by the administrator to redirect to a predetermine screen. The permission token acquiring unit uses the permission setup information and the external service information which are stored in the permission setup information memory unit to acquire the permission token from the external service system. The permission token storing unit stores the permission token acquired from the external service system in the permission token information memory unit .

The permission token providing unit receives the request for acquisition of the permission token and provides if there is the permission token which can be provided to the permission token information memory unit the permission token. If there is not the permission token which can be provided to the permission token information memory unit the permission token providing unit requests the permission token acquiring unit to acquire the permission token and provides the acquired permission token.

The service application is substantialized by a processing block illustrated in for example . is a processing block chart in the service application of the embodiment. The service application causes the computer system to function as an authentication requesting unit a screen processing unit a permission token acquisition requesting unit and a processing requesting unit .

The authentication requesting unit requests authentication from the authentication processing unit . The screen processing unit performs processes related to the screen such as generation of the login screen. The permission token acquisition requesting unit requests the authentication processing unit to acquire the permission token necessary for using the WebAPI of the external service system. The processing requesting unit uses the permission token and requests the WebAPI of the external service to process. The processing requesting unit may request the data processing unit to process an asynchronous process such as asynchronous transformation or the like.

The data processing unit is substantialized by a processing block illustrated in for example . is an exemplary processing block chart of the data processing unit of the embodiment. The data processing unit includes an asynchronous front unit and an asynchronous worker unit .

The asynchronous front unit receives a request for an asynchronous process as a job from the service application and stores the request for the asynchronous process as a job in the data management information memory unit . The data management information memory unit functions as a message queue.

The asynchronous worker unit sequentially acquires jobs from the data management information memory unit and performs the asynchronous process. In a case where the external service system is used the asynchronous worker unit requests the authentication processing unit to send the permission token for the external service and acquires the permission token.

Further the identification number of an electronic medium for example an IC card owned by the user or the like may be used as the user ID. Although the user ID and the password which are associated with the organization ID are uniquely determined if the organization IDs are different the user ID and the password may be redundantly determined.

The permission setup information ID is information uniquely specifying the record of the permission setup information. The external service ID is information uniquely specifying the external service. The scope specifies a service range of the external service system. The client ID is information specifying a group of services in the service providing system . The client ID is issued by the external service system in advance. The refresh token is required to reissue the permission token.

The client secret is secret information like a password for ensuring identity of the client ID to a person authentically corresponding to the client ID. The product name is information specifying the service application registered in association with the client ID. The permission server URL is a URL at the destination of the redirection before the administrator determines the permission a URL concerning a function as the permission server of the external service system . The redirection destination URL is a URL at the destination of the redirection after the administrator determines the permission a URL concerning a function as the permission client of the authentication processing unit .

When the authentication processing unit receives the request for the authentication using the account information such as the organization ID the user ID the password or the like from the office equipping device the authentication processing unit refers to the user management information stored in the user management information memory unit and authenticates the account information. When the authentication of the account information is successful the authentication processing unit generates an authentication ticket of the administrator an administrator ticket .

In step S the authentication processing unit returns the administrator ticket to the office equipping device from which the login is requested. Thereafter the office equipping device can use the functions of the service providing system by using the authentication ticket. The authentication processing unit manages the administrator ticket and the account information by associating these.

In step S the management setup service application receives a display request to display the setup screen using the administrator ticket which is received from the office equipping device operated by the administrator. The management setup service application identifies that the source of the display request for the setup screen is the administrator by referring to the administrator ticket. In step S the management setup service application causes the setup screen for the administrator to be displayed on the office equipping device operated by the administrator. Then the permission setup information which can be registered is displayed on the setup screen for the administrator.

In step S the administrator operates the office equipping device and selects the user ID to be applied with the permission setup the external service ID of and the scope of the external service to be used. In step S the management setup service application requests the authentication processing unit to register the permission setup information selected by the administrator as a registration request.

In step S the authentication processing unit numbers the permission setup information subject to the registration request with the permission setup information ID and registers the permission setup information into the permission setup information memory unit . In steps S and S the permission setup information ID is returned to the office equipping device operated by the administrator as a return. The management setup service application may inquire the authentication processing unit so that the permission setup information ID is acquired and the permission setup information ID is provided to the office equipping device.

In step S the administrator operates the office equipping device to request the authentication processing unit to perform the permission procedure using the administrator ticket the user ID of the user whose permission is required and the permission setup information ID.

In step S the authentication processing unit acquires at least a part of the parameter required for the permission from the permission setup information stored in the permission setup information memory unit and from the external service information stored in the service information memory unit using the user ID and the permission setup information ID which are included in the request for the permission procedure as keys.

The parameter required for the permission is the external service ID the scope the client ID uniquely identifying the service application the redirection destination URL at the destination of the redirection after the administrator determines the permission and an arbitrary session key for maintaining a session. In step S the authentication processing unit acquires the permission server URL from the external service information stored in the external service information memory unit and causes the parameters required for the permission to be redirected to the permission server URL as a query of GET request.

Here the arbitrary session key for maintaining the session is necessary because of the following reasons. The permission screen through which the administrator permits is displayed by an external service system. Since the redirection of the parameter to the permission server is performed by the authentication processing unit after the administrator determines the permission the session in an HTTP level of the authentication processing unit breaks. Because the authentication processing unit performs a series of flows for acquiring a permission code within a single session an arbitrary session key can be used.

The OAuth is a protocol having a structure where an arbitrary session key can be designated. In the system of the embodiment by designating the permission setup information ID as the session key the permission setup information ID is handed at the time of the redirection. Therefore the user permitted by the administrator and the content of the permission can be known.

As described above the permission server URL is a URL at the destination of the redirection before the administrator determines the permission the URL concerning the function as the permission server of the external service system . The external service system to which the redirection is performed checks the administrator ticket using information of cookies in order to verify that the administrator on the source of the request is a registered user. For example if the administrator has already logged in the external service system the administrator ticket is cached by a browser. Therefore the administrator ticket exists. On the other hand if the administrator has not logged in the external service system there is no administration ticket in the external service system. In this case the external service system displays a login screen illustrated in on the office equipping device operated by the administrator in order to prompt the login.

After the login button is pushed the office equipping device requests the external service system to log in using the user ID of and the password of the external service in step S. Then when the login is successful the external service system displays a permission screen illustrated in on the office equipping device operated by the administrator who already login in order to prompt the permission concerning a use of the external service in step S. The process of step S is omitted in a case where the administrator has already logged in.

The administrator checks the object of the permission from a product name and the scope which are registered in advance as the permission setup information or the part of the external service information in association with the client ID and determines the permission. In a case where the use of the external service is permitted the administrator pushes the permission button down on the permission screen .

When the permission button is pushed down the office equipping device operated by the administrator reports the determination of the permission to the external service system using the client ID the scope the redirection destination URL the user ID and the permission setup information ID in step S. After the determination of the permission is reported the external service system redirects a query which is attached with the permission code indicative of the permission and the permission setup information ID as an example of the session key to the redirection destination URL in step S.

In step S the office equipping device operated by the administrator sends the administration ticket the permission code and the permission setup information ID to the redirection destination URL being the destination of the redirection after determining the permission. illustrates an example in which the redirection destination URL is the authentication processing unit .

In step S the authentication processing unit acquires at least a part of the parameter required for acquiring the permission token an access token illustrated in from the permission setup information stored in the permission setup information memory unit and from the external service information stored in the service information memory unit using the permission setup information ID as a key. For example in step S the authentication processing unit acquires the user ID the external service ID the client ID and the client secret. The parameter required to acquire the permission token is for example the client ID the client secret the permission code or the like.

In step S the authentication processing unit sends the client ID the client secret and the permission code added as the query to the external system as request information in order to acquire the permission token required to access the WebAPI of the external service system from the external service system. In step S the external service system verifies the permission code and issues the permission token the refresh token and the expiration date to the authentication processing unit to thereby provide these to the authentication processing unit .

The permission token is required to access the WebAPI. The expiration date is ordinarily set to the permission token. When the expiration date of the permission token expires the permission token cannot access the WebAPI. The refresh token is required to reissue the permission token.

In step S the authentication processing unit stores the permission token and the expiration date which are provided by the external service system in association with the user information the organization ID and the user ID and the external service ID as permission token information into the permission token information memory unit .

Further the authentication processing unit stores the refresh token into the permission setup information stored in the information memory unit in association with the user information and the external service. In step S the authentication processing unit causes the URL of the management setup service application to redirect the user ID and a value indicative of the permission result as a query.

In step S the office equipping device operated by the administrator sends the administrator ticket a company ID a user ID and a value indicative of a permission result to the URL of the management setup service application and requests to display a screen showing the permission result. In step S the management setup service application causes the office equipping device to display the screen showing the permission result.

The service application receives a login request using account information such as the organization ID the user ID the password or the like from the office equipping device such as the client terminal operated by the user. In step S the service application requests the authentication processing unit to authenticate using the organization ID the user ID and the password which are included in the login request received by the service application .

When the authentication processing unit receives the request for the authentication using the account information such as the organization ID the user ID the password or the like from the authentication processing unit the authentication processing unit refers to the user management information stored in the user management information memory unit and authenticates the account information. When the authentication of the account information is successful the authentication processing unit generates an authentication ticket of the user. In step S the authentication processing unit sends the authentication ticket to the service application . The service application sends the authentication ticket to the office equipping device on the source of the login request.

Thereafter the office equipping device can use the functions of the service providing system by using the authentication ticket. The authentication processing unit manages the authentication ticket and the user information by associating these.

In step S the service application receives a cooperation request for cooperation between the office equipping device operated by the user and the external service from the office equipping device. In step S the service application generates an external service cooperation requesting screen illustrated in for example and causes the office equipping device operated by the user to display the external service cooperation requesting screen.

On the external service cooperation requesting screen an example of selecting the external service to cooperate with the office equipping device operated by the user. When the upload button is pushed the service application starts the processes on and after step S in . In step S the service application requests the authentication processing unit to acquire the permission token using the external service ID selected in the external service cooperation requesting screen and the authentication ticket acquired in step S.

In step S the authentication processing unit acquires the user information associated with the authentication ticket using the authentication ticket included in the request for the acquisition of the permission token. In step S the authentication processing unit requests the permission token information memory unit to acquire the permission token associated with the user information which is associated with the authentication ticket and with the external service ID of the external service which is selected by the user through the external service cooperation requesting screen .

If the permission token associated with the user information and the external service ID is stored in the permission token information memory unit in step S the authentication processing unit acquires the permission token and its expiration date from the permission token information memory unit .

If the permission token associated with the user information and the external service ID is not stored in the permission token information memory unit in step S the authentication processing unit receives a message false indicating that the corresponding permission token does not exist from the permission token information memory unit .

When the authentication processing unit acquires the permission token within the expiration date from the permission token information memory unit the authentication processing unit provides the permission token to the service application which has requested the acquisition of the permission token in step S.

Meanwhile if the authentication processing unit cannot acquire the permission token within the expiration date from the permission token information memory unit in step S the authentication processing unit requests the permission token acquiring unit to acquire the permission token.

In step S the permission token acquiring unit acquires a refresh token which is associated with the user information and the external service ID from the permission setup information memory unit . The permission token acquiring unit requests the permission token to the external service system using the refresh token.

In step S the permission token acquiring unit acquires the permission token and its expiration date from the external service system. In step S the permission token acquiring unit provides the permission token and its expiration date which are acquired from the external service system to the authentication processing unit .

In step S the authentication processing unit stores the permission token and its expiration date which are provided from the permission token acquiring unit in the permission token information memory unit in association with the user information and the external service ID. Thereafter in step S the authentication processing unit provides the permission token to the service application from which the permission token has been requested to acquire. In or after step S the service application can request the WebAPI of the external service system to perform processes using the permission token which is provided.

Because the permission token associated with the single user information and the single external service can be shared between or among different service applications session information between the service applications and the external service system can be reduced to thereby reduce a load given to the external service system.

In a case where the external service system is used after the OCR converting process as the exemplary asynchronous process is performed as illustrated in the asynchronous work unit undertakes communications with the external service system. Ordinarily in a case where the permission token for the external service is acquired by the service application from the authentication processing unit the authentication ticket from the authentication processing unit is necessary.

However in a case where the asynchronous process is performed when the asynchronous worker unit requests the authentication processing unit to acquire the permission token of the external service using the authentication ticket there is a possibility that the authentication ticket is expired. Therefore the service providing system trusts the asynchronous worker unit . Thus the authentication ticket used in requesting to acquire the permission token for the external service is not required.

For example by arranging the authentication processing unit and the asynchronous worker unit in a single network the asynchronous worker unit is trusted. It can be determined whether the asynchronous worker unit is arranged in the single network by referring to for example the IP address of the asynchronous worker unit . In order to build a trust relationship between the authentication processing unit and the asynchronous worker unit it is possible to introduce an authentication function such as a basic authentication instead of the above control in the network.

For example if the process of uploading the external service system after the OCR converting process is requested by the user in step S the service application requests the asynchronous front unit to upload the external service system using the user information the external service ID and the job information after the OCR converting process.

In step S the asynchronous front unit registers the process of uploading the external system as a job in the data management information memory unit after the OCR converting process requested by the service application .

The asynchronous worker unit performing an asynchronous process sequentially acquires the jobs registered in the data management information memory unit and performs the asynchronous process. In step S the asynchronous worker unit acquires the job of the process of uploading the external service system after the OCR converting process registered in the data management information memory unit .

In step S the asynchronous worker unit reads the data designated by the job information out of the data storage and performs an OCR converting process. In step S the asynchronous worker unit requests the authentication processing unit to acquire the permission token using the user information and the external service ID.

In step S the authentication processing unit requests the permission token information memory unit to acquire the permission token associated with the user information and the external service ID. In step S the authentication processing unit acquires the permission token associated with the user information and the external service ID. In step S the authentication processing unit provides the permission token associated with the user information and the external service ID to the asynchronous worker unit .

In step S the asynchronous worker unit can upload the data after the OCR converting process to the external service system using the permission token provided from the authentication processing unit .

As the first problem in a case where an external service system displays the permission screen each of the service applications with UI frequently has a client function for the OAuth authentication. In this case it is necessary that each of the service applications performs the OAuth authentication. Therefore the service applications individually manage the security data.

Accordingly in this case security data are dispersed by an increase of the service applications to cause a problem in that security is lowered. Further in this case the service applications are required to individually ensure the security. Therefore there is a problem in that a management cost increases.

In the system of the embodiment client functions for OAuth authentication can be concentrated in one position to thereby enable a uniform management. Therefore not only the security is improved but also the management cost can be reduced.

As a second problem in a case where the scopes are different for each of the service applications the permission process of the OAuth authentication is required to be performed for each of the service applications . In this case the usability is lowered.

The system of the embodiment can use various mashup services regardless of the types of the service applications with a one time permission procedure performed by the administrator of uniformly managing the management process for managing the permission information such as the permission setup information the external service information the permission token or the like and the permission process in the authentication processing unit .

As a third problem there is a case where a permission process is not performed by an office equipping device which cannot display a UI of HTML in a protocol of OAuth authentication.

In the system of the embodiment the permission process and the process of using the external service are separated. Therefore the mashup service can be used by a device without a UI of HTML.

As a fourth problem there is a case where a user of a company accesses a shared resource in an external service system designated by an administrator of the company after the user himself or herself has an account of the designated external service system and follows a permission procedure.

In the system of the embodiment since the administrator can act for the user to follow the permission procedure for the user it is possible to manage such that an access is allowed only to the designated external service system. For example in the system of the embodiment it is possible to cause the user to use the permission token in conformity with a management policy.

As described in the system of the embodiment the client functions of OAuth authentication are concentrated for a multi tenant type application. Thus complexity of the system is reduced and the management cost can be prevented from increasing. Further in the system of the embodiment the security data can be uniformly managed and the security can be improved.

Further in the system of the embodiment usability can be improved by reducing the number of times of the permission procedures by the user. Further in the system of the embodiment the mashup service can be easily used by a device without an UI. Further in the system of the embodiment since the administrator can act for the user to follow the permission procedure for the user it is possible to manage such that an access is allowed only to the designated external service system.

A first service providing system in the claims corresponds to for example the service providing system . A second service providing system in the claims corresponds to for example the external service system. A service providing apparatus in the claims corresponds to for example the service providing system . Post permission authority information in the claims corresponds to for example the permission token. Information required to reissue the post permission authority information in the claims corresponds to for example the refresh token.

A connection destination changing unit in the claims corresponds to for example the redirect requesting unit .

The authority information acquiring unit in the claims corresponds to for example the permission token acquiring unit .

An authority information providing unit in the claims corresponds to for example the permission token providing unit .

An authority information storing unit in the claims corresponds to for example the permission token storing unit .

A first memory unit in the claims corresponds to for example the permission setup information memory unit the external service information memory unit and the permission token information memory unit .

An authority information acquisition requesting unit in the claims corresponds to for example the permission token acquisition requesting unit .

The processing requesting unit in the claims corresponds to for example the processing requesting unit . A cooperation process receiving unit in the claims corresponds to for example the asynchronous front unit . A cooperation process performing unit in the claims corresponds to for example the asynchronous worker unit .

All examples and conditional language recited herein are intended for pedagogical purposes to aid the reader in understanding the principles of the invention and the concepts contributed by the inventor to furthering the art and are to be construed as being without limitation to such specifically recited examples and conditions nor does the organization of such examples in the specification relate to a showing of the superiority or inferiority of the invention. Although the system has been described in detail it should be understood that various changes substitutions and alterations could be made thereto without departing from the spirit and scope of the invention.

This application is based upon and claims the benefit of priority of the prior Japanese Patent Application No. 2012 241368 filed on Oct. 31 2012 the entire contents of which are incorporated herein by reference.

