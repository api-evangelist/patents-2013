---

title: Memory module having multiple memory banks selectively connectable to a local memory controller and an external memory controller
abstract: A memory module includes memory banks, a local memory controller to access data in the memory banks, and an interface to an external memory controller that is configured to access the memory module. Multiplexing circuitry selectively connects the memory banks to the local memory controller and to the interface to the external memory controller.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09064562&OS=09064562&RS=09064562
owner: Hewlett-Packard Development Company, L.P.
number: 09064562
owner_city: Houston
owner_country: US
publication_date: 20130403
---
A system can include various types of storage devices including a persistent secondary storage e.g. disk based storage or solid state storage and an intermediate storage. The intermediate storage can be implemented with a higher speed storage device than used with the persistent secondary storage. Examples of storage devices that can be used in the intermediate storage include dynamic random access memories DRAMs static random access memories SRAMs flash memories and so forth.

A system e.g. a desktop computer a notebook computer a tablet computer a personal digital assistant a smartphone etc. can include a memory module that has both volatile memory and non volatile memory. Volatile memory includes memory that loses its data content in case power is removed from the volatile memory. A non volatile memory on the other hand maintains its data content even if power is removed from the non volatile memory.

The volatile memory can be implemented with dynamic random access memory DRAM devices static random access memory SRAM devices or other types of devices. The non volatile memory can be implemented with flash memory devices phase change memory devices memristor memory devices or other types of devices.

An example of a memory module that includes both volatile storage and non volatile storage is a non volatile dual in line memory module NV DIMM . An NV DIMM can include one or multiple DRAM devices and one or multiple flash memory devices as examples. Although reference is made to an NV DIMM it is noted that in other examples other types of memory modules that include volatile storage and non volatile storage can be used.

The memory module can also include a local memory controller that is able to access data stored in the volatile memory or non volatile memory of the memory module. In addition the memory module can be accessed by an external memory controller that is part of the host system. For example the external memory controller may be able to access data in the volatile memory of the memory module.

While the local memory controller is accessing the memory module it may be possible that the external memory controller may attempt to access the memory module at that time. If the memory module does not respond to the memory request from the external memory controller within a specified time interval and with the expected signal timings which can be defined by a standard governing the operation of a memory bus between the memory controller and a memory device then that can result in a failure condition that can cause the host system to behave in an unexpected way. A standard that governs operations on a memory bus can be defined by the Joint Electronic Devices Engineering Council JEDEC in some examples.

In some examples failure to respond to a memory request from the external memory controller within a specified time interval and with the expected signal timings can be considered a hardware failure which can cause the host system to crash or to behave in an expected way.

In accordance with some implementations as shown in a memory module includes multiple memory banks and . Although just two memory banks are depicted in the memory module can include a greater number of memory banks in other examples. A memory bank can refer to a segment of memory where a memory bank can include one or multiple memory devices. Alternatively a memory bank can include a portion of a memory device or a portion of multiple memory devices. In some examples the memory banks and can each include volatile memory.

The memory module also includes a local memory controller which is able to access data in the memory banks and . The memory module additionally includes an external interface which is connected to an external memory controller over a memory bus .

The memory module also includes multiplexing circuitry to selectively connect the memory banks and to the local memory controller and to the external interface which is connected to the external memory controller . The multiplexing circuitry can selectively connect both the memory banks to the local memory controller or to connect both the memory banks to the external interface . Alternatively the multiplexing circuitry can selectively connect a first one of the memory banks to the local memory controller and selectively connect a second one of the memory banks to the external interface .

When a given memory bank is connected by the multiplexing circuitry to the local memory controller the given memory bank is isolated from the external interface such that the external memory controller would not be able to access the given memory bank. More specifically if the memory bank is connected by the multiplexing circuitry to the local memory controller then the memory bank is isolated from the external interface by the multiplexing circuitry . The local memory controller is able to access the memory bank but the external memory controller is not able to access the memory bank .

Similarly when a given memory bank is connected by the multiplexing circuitry to the external interface the given memory bank is isolated from the local memory controller such that the local memory controller would not be able to access the given memory bank.

During run time of a host system that includes the external memory controller and the memory module at least one of the memory banks and is connected by the multiplexing circuitry to the external interface if the host system determines the host system is in a mode where the external memory controller may attempt to access the memory module . In this manner when the external memory controller issues a memory request over the memory bus to the memory module for data stored by the memory module the memory bank that is connected by the multiplexing circuitry to the external interface is able to respond to the memory request. The response includes signals that are driven within a specified time interval and according to timings specified by a standard governing operation over the memory bus . In this way some response conforming to the memory bus standard is provided to the external memory controller in response to the memory request which avoids the condition where no response is provided by the memory module to the external memory controller which can lead to an indeterminate reaction by the system.

In some cases the responding memory bank may not actually be the memory bank that is the subject of the memory request from the external memory controller . As a result data provided by the responding memory bank may be incorrect data in other words data that is not data that is sought by the memory request . However the provision of the incorrect data can be handled by the host system such as by machine readable instructions executing in the host system. In some examples a data error may be indicated which can trigger a retry of the memory request to the memory module .

In other implementations data in one memory bank is shadowed copied in the other memory bank such that duplicate copies of data can be stored in the memory banks and . In the shadow mode a write to the memory module causes the same data to be written to both memory banks . In this manner a memory request submitted by the external memory controller for a first memory bank can be correctly satisfied from the duplicate copy of data in the second memory bank.

The local memory controller is selectively connected to the volatile memory banks and by the multiplexer demultiplexer and the multiplexer demultiplexer . The multiplexer demultiplexer can select one of the local memory controller and external interface to connect to the volatile memory bank . Similarly the multiplexer demultiplexer can select one of the local memory controller and the external interface to connect to the volatile memory bank .

In some examples the local memory controller is also able to access the data in the non volatile memory . In other examples a separate memory controller can be included in the memory module A for managing access of data in the non volatile memory . In some implementations the non volatile memory is used as a backup storage device to back up data in the volatile memory bank and or volatile memory bank . Performing a backup of data from a volatile memory bank to the non volatile memory can include copying the data to the non volatile memory such that the data resides in both the non volatile memory and the volatile memory bank. Alternatively backing up data from a volatile memory bank to the non volatile memory can involve moving the data to the non volatile memory such that the data no longer resides at the volatile memory bank.

In other examples instead of or in addition to the non volatile memory the memory module A can include a communications interface to allow the memory module A to connect to another processor or computer such as over a bus or a network. The local memory controller or another controller in the memory module A can communicate with the other processor or computer through the communications interface.

The memory module A further includes control logic which can be implemented with a processing circuit such as a microcontroller microprocessor application programming interface circuit ASIC programmable gate array PGA and so forth.

The control logic outputs MUX select signals to control the multiplexers demultiplexers and . Based on the states of the MUX select signals the multiplexers demultiplexers and can selectively connect the local memory controller and external interface to the volatile memory banks and .

The control logic is coupled to the external interface . The control logic can be provided with command information to cause the control logic to control the multiplexer demultiplexers and to selectively connect the local memory controller and the external interface to the volatile memory banks and . In some examples the command information can be provided by machine readable instructions executing on a processor of the system. The processor can be connected to the external memory controller .

The memory module A further includes switch logic which outputs bank select signals and to the volatile memory banks and . A bank select signal if asserted to an active state causes activation of the respective volatile memory bank. For example if the bank select signal is activated then the volatile memory bank is selected.

The local memory controller outputs a first bank select signal LBS and a second bank select signal LSB which are connected to inputs of the switch logic . Similarly the external memory controller outputs a first bank select signal HBS and a second bank select signal HSB that are provided through the external interface to inputs of the switch logic . The switch logic is controlled by control signals from the control logic which control which of LBS LBS HBS and HBS are connected to the bank select signals and .

In some examples the table below shows how the bank select signals from the local memory controller and the external memory controller are connected in different modes. In the table below NC stands for no connection which means that the respective bank select signal from the local or external memory controller is not connected to either or .

The table above shows a Default mode of operation which can be the mode normally used during run time of the host system. In the Default mode both volatile memory banks and are to be connected to the external memory controller which means that the local memory controller is isolated from the volatile memory banks and . In the Default mode the bank select signals HSB and HSB from the external memory controller are connected by the switch logic to respective ones of the bank select signals and . The bank select signals LSB and LSB from the local memory controller are not connected to either of the bank select signals and .

Similarly if both volatile memory banks and are to be connected to the local memory controller which means that the volatile memory banks and are isolated from the external memory controller then the bank select signals LSB and LSB from the local memory controller would be connected by the switch logic to the respective bank select signals and . This can occur in a Backup mode as depicted in the table above. In the Backup mode data from both volatile memory banks and are being backed up to the local memory controller . The host system can enter the Backup mode by sending the corresponding control information to the control logic when the host system has taken steps to ensure that the external memory controller is quiesced such that it would not access the memory bus .

The table above also lists a Local to Bank mode in which the volatile memory bank is connected to the local memory controller and the volatile memory bank is connected to the external interface . In this mode the bank select signal LBS from the local memory controller is connected to the bank select signal while the bank select signal LBS from the local memory controller is not connected. However in this mode both bank select signals HBS and HBS from the external memory controller are connected to the bank select signal to the volatile memory bank . This ensures that a memory request from the external memory controller to either the volatile memory bank or the volatile memory bank would be responded to by the volatile memory bank .

Another mode depicted in the table above is a Local to Bank mode in which a volatile memory bank is connected to the local memory controller and the volatile memory bank is connected to the external interface . In this mode the bank select signal LBS from the local memory controller is not connected and the bank select signal LBS from the local memory controller is connected by the switch logic to the volatile memory bank . However both bank select signals HBS and HBS from the external memory controller are connected by the switch logic to the bank select signal which ensures that any memory request from the external memory controller for either the volatile memory bank or the volatile memory bank would be responded to by the volatile memory bank .

Another mode listed in the table above is a Shadow mode where a write of data to the memory module A results in the same data being written to both volatile memory banks and . While in Shadow mode care should be taken to not read from the memory module A as both volatile memory banks will try to respond.

The different modes can be specified by provision of control information to the control logic in the memory module A. For example machine readable instructions executing on the processor can program the control logic to the selected mode.

In some implementations when the host system initially starts up the control logic can be configured by the host system to cause both the volatile memory banks and to be connected to the external interface which corresponds to the Default mode in the table above. After initialization of the memory module A the control logic can be configured to allow one of the volatile memory banks and to be connected to the local memory controller while the other one of the volatile memory banks and is connected to the external interface . On the next idle phase of the memory bus the control logic can switch the multiplexer demultiplexers and to connect one of the volatile memory banks and to the local memory controller . In one example the external memory controller continues to have access to the other volatile memory bank. This configuration corresponds to either the Local to Bank or Local to Bank mode in the table above.

While the local memory controller is connected to one of the volatile memory banks the local memory controller can perform a backup operation to back up data from the connected volatile memory bank to the non volatile memory according to some implementations.

Whenever a volatile memory bank is switched to connect to the local memory controller the local memory controller can configure the connected volatile memory bank to operate at a configuration supported by the local memory controller . The configuration can include an operating speed and or other configuration associated with the local memory controller . Also in examples where the volatile memory banks include DRAMs the local memory controller can generate refresh cycles at the rate specified for the connected volatile memory bank to ensure that the DRAM remains refreshed. A DRAM stores data in capacitive memory cells that can lose their charge over time. Refreshing the DRAM results in restoring the stored capacitive charge of the memory cells.

When the control logic next switches connection of a volatile memory bank back from the local memory controller to the external interface which can be indicated by the control logic to the local memory controller the local memory controller can change the configuration of the volatile memory bank back to the configuration e.g. operating speed and or other configuration supported by the external memory controller . Also prior to switching back the connection to the external memory controller the local memory controller can perform a sufficient number of refresh cycles to ensure that the external memory controller has an adequate amount of time to take over control of the volatile memory bank that is being switched from the local memory controller to the external memory controller .

In one example priority can be given to the external memory controller in decisions regarding whether to connect a volatile memory bank to the local memory controller or the external interface . A detection mechanism can be provided to determine whether the memory bus is idle before the control logic is allowed to switch the connection of a volatile memory bank to the local memory controller . This detection mechanism can be included in the external interface for example.

In response to a memory request from the external memory controller specifying data in the first memory bank response data is provided at from a second of the multiple memory banks to the external memory controller .

Various tasks described above can be performed by hardware circuitry. Alternatively some tasks can be performed by machine readable instructions executable on a processing circuit.

Data and instructions are stored in respective storage devices which are implemented as one or multiple computer readable or machine readable storage media. The storage media include different forms of memory including semiconductor memory devices such as dynamic or static random access memories DRAMs or SRAMs erasable and programmable read only memories EPROMs electrically erasable and programmable read only memories EEPROMs and flash memories magnetic disks such as fixed floppy and removable disks other magnetic media including tape optical media such as compact disks CDs or digital video disks DVDs or other types of storage devices. Note that the instructions discussed above can be provided on one computer readable or machine readable storage medium or alternatively can be provided on multiple computer readable or machine readable storage media distributed in a large system having possibly plural nodes. Such computer readable or machine readable storage medium or media is are considered to be part of an article or article of manufacture . An article or article of manufacture can refer to any manufactured single component or multiple components. The storage medium or media can be located either in the machine running the machine readable instructions or located at a remote site from which machine readable instructions can be downloaded over a network for execution.

In the foregoing description numerous details are set forth to provide an understanding of the subject disclosed herein. However implementations may be practiced without some or all of these details. Other implementations may include modifications and variations from the details discussed above. It is intended that the appended claims cover such modifications and variations.

