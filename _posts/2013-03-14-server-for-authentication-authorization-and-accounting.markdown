---

title: Server for authentication, authorization, and accounting
abstract: In some implementations, a client device includes a client identifier embedded into a firmware of the client device. A server may register a service with a global authentication, authorization, and account (AAA) server. The client device may request permission to access the service. The request may be signed using a client signature that is based on the identifier. The global AAA server may send the request to the server and the server may determine whether to grant the client device permission. If the global AAA server determines that the server has granted the client device permission, the global AAA server may provide server credentials to the client device and client credentials to the server. The client device may sign a request to connect to the service using the client signature. The server may grant the request in response to authenticating the request using the client signature.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09521032&OS=09521032&RS=09521032
owner: Amazon Technologies, Inc.
number: 09521032
owner_city: Reno
owner_country: US
publication_date: 20130314
---
Organizations may have multiple computing devices connected via one or more networks. Such an organization may enable computing devices not associated with the organization to access the organization s network. For example an organization may enable computing devices of clients and or suppliers to access portions of the organization s network. In addition some of the computing devices associated with the organization may have access to networks other than the organization s networks such as the networks of clients or suppliers.

Some of the challenges faced by organizations include controlling which computing devices are allowed access to which services and how much of the services the computing devices use. For example the organization may desire to determine whether a client device is communicating with an appropriate e.g. authorized server whether the client device is authorized to communicate with the server and the like.

In a conventional system each service provider may maintain lists identifying which client devices are authorized to access services offered by the service provider e.g. whitelist and or which client devices are not authorized e.g. blacklist . However having each service provider maintain their own whitelists and or blacklists may result in redundancy and duplicated effort.

This disclosure describes systems devices and techniques that may be used to control operations between client devices and service providers. For example an authentication authorization and accounting AAA server may maintain whitelists and blacklists associated with client devices may access which services. The AAA server may enable client devices to establish and maintain ongoing relationships with services. For example the AAA server may perform various functions including verifying e.g. authenticating an identity of each client device and each service provider registering services provided by service providers to offer a central location for client devices to request permission to access services providing client devices permission to perform a limited number of actions e.g. authorizing and monitoring and analyzing e.g. accounting ongoing communications between the client devices and services.

The AAA server may be used to control the services offered by service providers and which client devices are permitted to access the services. For example a service provider e.g. a server offering a service to client devices may send a request to the AAA server to register the service. The AAA server may authenticate an identity of the service provider. For example a firmware of a component of the service provider e.g. server device may include a unique identifier. The unique identifier may protect against a spoof attack. The unique identifier may uniquely identify the service provider from other computing devices. If the AAA server successfully authenticates the service provider using the unique identifier the AAA server may register the service. If the AAA server is unsuccessful in authenticating the service provider the AAA server may perform one or more protective actions such as blacklisting the service provider. The term blacklist refers to a list that includes the identities of devices that are unauthorized to access a specified service. The term whitelist refers to a list that includes the identities of devices that are authorized to access a specified service.

When a client device desires to access the service the client device may send a request to the AAA server requesting permission to access the service. The AAA server may authenticate an identity of the client device. For example a firmware of a component of the client device may include a unique identifier that cannot be spoofed and that uniquely identifies the client device from other computing devices. If the AAA server is unsuccessful in authenticating the client device the AAA server may decline the access request and perform one or more protective actions e.g. blacklisting the client device etc. . If the AAA server successfully authenticates the client device in some implementations the AAA server may automatically e.g. without human interaction whitelist the client device for the service. In other implementations after successfully authenticating the client device the AAA server may send a notification to the service provider indicating that the client device is requesting access to the service and the service provider may determine whether to allow the client device to access the service and instruct the AAA server accordingly. For example if the service provider instructs the AAA server to enable the client device to access the service the AAA server may whitelist the client device for the service. If the service provider instructs the AAA server to deny the client device access to the service the AAA server may blacklist the client device for the service.

After a client device is whitelisted to access a service when the client device desires to access the service the client device may request access to the service by sending a request to the AAA server. For example the AAA server may provide credentials to the client device for the client device to use when signing requests to the service. The AAA server may monitor when the client device accesses the service and may log information associated with the access. For example the AAA server may log information such as when the client device accesses the service how often the client device access the service how long the client device connects to the service etc. The logs may be used to optimize the allocation of resources such as services and service providers detect client devices that are abusing or misusing access by hogging resources and the like.

Each computing device e.g. client devices and servers may include identity information that is stored at a very low level e.g. in firmware of the computing device. For example the identity information may be stored in the firmware of the computing device when the computing device is initially provisioned. Such a protection scheme may not be easily circumvented because the credentials to enable access to the secured data are not stored on the computing device or in a memory of a user. In addition the server may be notified if a computing device is lost or stolen and the server may not provide credentials to computing devices that have been identified as lost or stolen. The identifier may be used as a key e.g. credential or a part of a key or other credential.

In some implementations described herein the firmware of a computing device or a component of the computing device may be customized to contact an authorization server periodically e.g. each time the computer device boots up to enable the authorization server to authenticate an identity of the computing device and or to obtain authorization for continued operations of the computer device. For example a firmware of a network interface controller NIC of the computing device may include a unique identifier. In addition the NIC may monitor all incoming and outgoing communications between the computing device and external devices and or systems. The authorization server may maintain a database e.g. a central registry of authorized computers and may limit authorization to computing devices that are included in the registry based on an identity of each computing device. If a computing device is lost or stolen the identity of the computing device may be removed from the central registry so that the computing device is unable to obtain authorization or credentials from the authorization server.

Upon failure to authenticate with and or obtain authorization from the authorization server the firmware may be configured to implement security measures within the computing device or with respect to individual peripherals of the computing device. Such security measures may include refusing to boot the computing device refusing access to certain peripherals erasing or destroying a storage device of the computing device and so forth. The security measures may also include initiating remote reporting procedures to report computer related information to the authorization server or some other entity. For example a keystroke logging program might be initiated to report keystrokes made on the computing device. As another example a camera associated with or built in to the computing device may be used to capture and transmit a picture or a video of a person operating the computing device. Depending on the capabilities of the computing device it may be possible also to report a location of the computing device accounts accessed by the computing device network addresses accessed by the computing device and so forth. Such reporting may allow investigators to locate and recover the computing device or to identify the parties who are using the computing device.

Access to credentials to access services may be centralized in a cloud computing environment e.g. on an AAA server or a set of AAA servers that is accessible using a network. Access to the credentials may be quickly and easily revoked either automatically or based on user input if a computing device used to access the credentials falls into the wrong hands.

The client device may include one or more processor s one or more computer readable media and firmware . The computer readable media may include volatile storage e.g. random access memory and or non volatile memory e.g. a hard disk or another type of non volatile memory . The computer readable media may be used to store software instructions such as device drivers an operating system software applications that are executable by the processors to perform various functions. The computer readable media may include an agent . The firmware may be stored in a type of read only memory ROM such as electrically erasable programmable ROM EEPROM flash memory an integrated circuit etc. The firmware may include an identifier . The identifier may be a unique identifier that identifies the client device from among other devices. The identifier may be embedded into the firmware when the client device is initially provisioned. The firmware may include logic to that renders the client device inoperable if an attempt to modify the identifier is detected. For example if the logic detects an attempt to modify the firmware the logic may prevent the client device from booting erase the contents of a storage device associated with the client device or perform another action to render the client device inoperable. In some cases the identifier may be used as at least a portion of a key e.g. credentials when accessing a service. The firmware refers to the firmware of the client device and or the firmware of a component of the client device . The components of the client device may include a network interface component NIC to communicate with external devices using the network the computer readable media a basic input output system BIOS of the client device etc. For client devices that have not been configured with the identifier or the logic in the firmware the agent may perform the functions of the identifier and or the logic in the firmware . For example the agent may be configured to be tamper proof e.g. attempting to tamper with the agent may cause the client device to be rendered inoperable and may sign at least some communications originating from the client device by appending encrypted data that identifies the sender of the data as the client device . For example the agent may be implemented using a baseboard management controller BMC from an intelligent platform management interface IPMI architecture or a similar or equivalent controller to the BMC. The BMC may comprise a specialized microcontroller embedded on a motherboard of a computer e.g. the client device and or the server . The BMC may manage the interface between system management software and platform hardware for the client device and or the server . The agent may execute on the BMC or similar controller card to enable the agent to be relatively tamper proof.

The server may include one or more processor s one or more computer readable media and firmware . The computer readable media may include volatile storage e.g. random access memory and or non volatile memory e.g. a hard disk or another type of non volatile memory . The computer readable media may be used to store software instructions such as device drivers an operating system software applications that are executable by the processors to perform various functions such as providing one or more services . For example the services may include credit debit card authorization services fulfillment services making sensitive information e.g. addresses of clients anonymous a networking device inventory service etc. The firmware may include an identifier . The identifier may be a unique identifier that identifies the server from among other devices. The identifier may be embedded into the firmware when the server is initially provisioned. The firmware may include logic to prevent the identifier from being modified or that renders the server inoperable if the identifier is modified. The firmware may comprise the firmware of a component of the server such as a NIC the computer readable media a basic input output system BIOS of the server etc.

The AAA server may include one or more processors and one or more computer readable media . The computer readable media may include instructions a software library logs any number of N sets of credentials N 0 including a first set of credentials to an Nth set of credentials and authorizations . The instructions may be executable by the processors to perform various functions provided by the AAA server including authentication authorization and accounting. While the AAA server is depicted as a single server in the various functions of the AAA server may in some implementations be distributed among multiple hardware servers.

The software library may be provided to a service provider when the service provider registers a service with the server to enable the service provider to securely communicate with client devices that are accessing the service. The software library may be used by client devices and or service providers that use the services of the AAA server . The software library may include modules that perform authentication and or authorization tasks. For example the software library may perform functions such as retrieving a secure key from the AAA server periodically synchronizing policy information with the AAA server encrypting requests and signing the requests with a valid key decrypting and authenticating responses decrypting the requests authenticating and authorizing the requests updating the logs etc. The software library may be accessed using a set of application programming interfaces API that are included with the software library . Thus the AAA server may manage various aspects of relationships between client devices and services such as maintaining information associated with client devices services and the relationships between client devices and services providing functionality for creating and modifying information generating updated security policies and providing the updated securities policies to client devices and service providers generating keys for each service e.g. a unique key for each application environment and delivering the keys and applying a set of rules that enable services to resolve security discrepancies and failures.

When a client device is communicating with a service the AAA server may monitor the communications and create the logs . For example the logs may include various statistics associated with the communication between the client device and the service such as when the communication was initiated how long the communication occurred when the communication was terminated an amount of traffic that occurred during the communication other information associated with the communication or any combination thereof.

One or more of the N sets of credentials to may be provided to a client device to enable the client device to communicate with a service such as one of the services provided by the server . Each of the set of credentials to may include material which refers to a smallest unit of a sensitive piece of data such as an encryption key a private key a password etc. Each material has an associated start date and end date validity period and a serial number version and belongs to a set of credentials. A set of credentials may have a globally unique name e.g. part of a reserved namespace and a type e.g. symmetric key credential pair certificate etc. and may include zero or more materials. Materials in a set may be identified by a serial number which may be used as a version number. For example a database password may be defined as 

In the above example the materials in the set may include versions of a password as it changes over time. As another example a key may be defined as 

The authorizations may include information associated with which services have registered with the AAA server which clients have been approved to access which services and other authorization related information. For example when the client device is authorized to access one of the services the authorizations may include information indicating that the client device is authorized to access one of the services .

To enable client devices to access one or more of the services the server may register one or more of the services with the AAA server . For example the server may send a registration request to the AAA server . The registration request may include the unique identifier embedded in the firmware of the server . The identifier may be a unique identifier that enables the AAA server to determine whether the server is a trusted device whose service may be registered. For example in response to receiving the registration request the AAA server may look up the identifier in a database to determine whether the server is a trusted device. If the AAA server determines that the server is a trusted device the AAA server may register the service and send a registration response indicating that the service has been registered at the AAA server . If the AAA server determines that the server is not a trusted device the AAA server may send the registration response indicating that the request to register the service was denied.

If the AAA server determines that the server is a trusted device the AAA server may enable the server to download the software library . For example the registration response may include the software library or the registration response may include information e.g. a download link to enable the server to download the software library . The server may install the software library such that the software library may be used when communicating with client devices that have registered to use one or more of the services .

The AAA server may maintain a set of mappings that map embedded identifiers e.g. the identifier of service providers with logical identities of the service providers and embedded identifiers e.g. the identifier of clients with logical identities of the clients. The logical identities of the service providers and the clients maintained in the mappings may be used as an index to the authorizations to identify one or more authorizations associated with a specific service provider or client. In some cases a client fleet identifier may be associated with a client fleet where the client fleet includes a set of one or more client devices and a server fleet identifier may be associated with a server fleet where the server fleet includes a set of one or more servers. From a client management perspective the AAA server may provide a client that is identified using a client fleet identifier e.g. the client fleet identifier with a pool of credentials e.g. from the N credentials to for use by the client fleet . Thus the pool of credentials may be mapped to a single client fleet identifier e.g. the client fleet identifier and the client fleet identifier may be provided access to different services by the AAA server . After a client identifier is permitted access to one or more services the mappings may be used to identify client devices e.g. from the client fleet associated with the client identifier when determining whether to permit or deny access to a service. The mappings enable a client to add a client device to the client fleet to access a service without having to separately request permission for that specific client device because the client device s permission is provided based on the client fleet identifier . Thus permissions e.g. credentials may be based on a client identifier e.g. the client fleet identifier that is associated with multiple client devices e.g. the client fleet and the mappings may map each of the multiple client devices to the client identifier. A particular service provider with an associated service provider identifier may have multiple servers e.g. the server fleet where each of the multiple servers is capable of providing the same or equivalent service. The mappings may map the server devices from the server fleet to the associated service fleet identifier . For example a service provider may have ten servers in the server fleet and then scale up to twenty servers to meet the demand for a particular service without the clients being aware because the clients access the particular service using the server fleet identifier associated with the particular service. A client device may access a service using a service fleet identifier and the service may be provided by one of multiple servers from the fleet of servers associated with the service fleet identifier. Which particular server from the multiple servers provides the service may be transparent to the client device. The mappings may thus map multiple servers to a service fleet identifier.

Thus an authorization authentication and accounting server e.g. the AAA server may enable secure communications between client devices e.g. the client device and service providers e.g. the server . The client devices and the service providers may include firmware in which a unique identifier e.g. the identifiers or is embedded. In some cases the unique identifier may comprise a private key.

To offer a service to client devices the service provider may register the service with the AAA server . To register the service with the AAA server the service provider e.g. the server may send a registration request to the server . The registration request may include the service provider s unique identifier to enable the AAA server to determine whether the service provider is a trusted device. If the AAA server determines that the service provider is a trusted device the AAA server may register the service and enable the service provider to download and install a software library to enable the service provider to communicate securely with the client devices when providing the service.

The client device may request permission from the AAA server to access one of the services . For example the client device may send a service request to the AAA server requesting access to a particular service e.g. one of the services being offered by the server . The service request may include the identifier . For example the identifier may include a unique private key or other type of credential . In response to receiving the service request the AAA server may validate a private key included in the identifier . In some cases the AAA server may determine a type and or level of privileges of the client device based on the identifier .

In some cases in response to receiving the service request the AAA server may send an access request to the server . The access request may provide the server with information as to which client device is requesting access to which service that the server is providing. The server may determine whether to approve or deny the service request from the client device and send a service response to the server indicating whether the service request was approved or denied. For example if the service request includes the identifier of the requesting client device the server may determine whether to approve or deny the service request at least partly based on the identifier . Based on the service response the server may send a service access response to the client device . The service access response may indicate whether the service request was approved or denied. If the service response indicates that the server approved the service request the AAA server may distribute e.g. send credentials to the client device and credentials to the server to enable the client device and the server to securely communicate with each other. The client device may store the credentials on the computer readable media and the server may store the credentials on the computer readable media . The AAA server may select the credentials and from the N set of credentials to . The credentials and may include public credentials such as a public key. Thus the credentials may provide the client device a public key of the server and the credentials may provide the server a public key of the client device . The client device may encrypt communications sent from the client device using a private key e.g. the identifier and the server may decrypt communications received from the client device using the public key of the client device provided by the credentials . The server may encrypt communications sent to the client device using a private key e.g. the identifier and the client device may decrypt communications received from the server using the public key of the server provided by the credentials . When the AAA server is available the client device may use the AAA server to access a service offered by the service provider . However if the AAA server is unavailable the client device and the service provider may communicate directly using the credentials and or .

If the service response indicates that the server approved the service request the AAA server may note in the authorizations that the client device is approved to access one or more of the services . For example the AAA server may note e.g. in the authorizations that the client device with the identifier was approved to access one or more of the services . The AAA server may send the service access response indicating that the service request was approved. The AAA server may provide credentials such as one of the N set of credentials to to both the client device and the server . For example the credentials may be provided in the service access response . The client device may sign requests to connect to a service e.g. one of the services using the credentials. When the server receives a connection request from a client device e.g. the client device the server may compare the credentials provided by the client device with the credentials provided by the AAA server to determine whether to permit the client device to connect to the service.

If the service response indicates that the server denied the service request the AAA server may note in the authorizations that the client device is not approved to access one or more of the services . For example the AAA server may note that the client device with the identifier is not approved to access one or more of the services . The AAA server may send the service access response indicating that the service request was denied.

In some cases the AAA server rather than the server may determine whether to allow or deny the service request from the client device e.g. the AAA server may determine whether to allow or deny the service request without sending the access request to the server . For example the AAA server may determine whether to allow or deny the service request from the client device based on the identifier of the client device . To illustrate the client device may have been blacklisted because the client device had been reported as lost stolen or otherwise compromised. In such cases e.g. the client device is blacklisted the AAA server may automatically determine to deny the service request without sending the access request to the server . As another illustration the client device may send the service request and the server may send the service response denying the request. The AAA server may note the denial of the service request . At a subsequent point in time the client device may again send the service request . In such situations the AAA server may determine that the server had previously denied the service request from the client device and send the service access response denying the service request without sending the access request to the server . Of course there may be other situations in which the AAA server sends the service access response e.g. either allowing or denying the service request e.g. without sending the access request to the server and without receiving the service response from the server .

Thus a client device such as the client device may send a request to the AAA server requesting permission to access one or more of the services provided by the server e.g. the service provider . The request may include a unique identifier that is embedded in a firmware of the client device. In some cases the AAA server may determine whether to allow or deny the request while in other cases the AAA server may provide information associated with the request e.g. an identity of the client device which service is being requested why the service is being requested etc. to the server and the server may determine whether to allow or deny the request. If the request is allowed e.g. granted then the AAA server may note e.g. in the authorizations that the client device is authorized to access the services . If the request is denied then the AAA server may note e.g. in the authorizations that the client device is not authorized to access the services .

In some implementations in response to receiving the connection request the AAA server may send a client request to the server . The client request may indicate that the client device is requesting to connect to one or more of the services . The server may send a response to client to the AAA server . The response to client may indicate whether the server is able to accommodate the connection request . The AAA server may send a connection response to the client device based on the response to client indicating whether or not the server has granted permission for the client device to connect to one or more of the services . For example in response to receiving the client request the server may determine that the client device may connect to one or more of the services and may send information in the response to client to enable the client device to connect to one or more of the services . For example the information may include a location e.g. a port number an internet protocol address a uniform resource locator or the like to access the services a credential e.g. a private key or a public key or other information that enables a client device to connect to one or more of the services . The AAA server may send the information to the client device in the connection response .

In other implementations the AAA server may provide the connection response without sending the client requests to the server . For example the AAA server may have noted in the authorizations that the client device as permission to connect to the server . In this example the AAA server may determine that the client device is authorized to connect to the one or more services and send the connection response to the client device . The connection response may include the information to enable a client device to connect to one or more of the services .

As mentioned above in when the service request is approved the AAA server may provide credentials such as one of the N set of credentials to to both the client device and the server . The client device may sign requests to connect to a service such as the connection request using the credentials. When the server receives the client request the server may compare the credentials provided by the client device with the credentials provided by the AAA server to determine whether to permit or deny the connection request .

Each time the client device sends the connection request the AAA server may generate a log e.g. client device XYZ requested a connection to service ABC at and store the log in the logs . Each time the server receives a request from a client e.g. the client request the server may generate an entry to logs stored in the computer readable media . The AAA server may request logs such as the logs from the server and compare the logs from the server with the logs . For example the AAA server may compare the log with the logs to determine whether the client device is abusing one or more of the services provided by the server . For example comparing the log with the logs may indicate that the client device connected to one of the services directly bypassing the AAA server . In response to detecting inappropriate use of the services based on analyzing logs e.g. the logs and the AAA server may revoke one or more of the credentials e.g. the credentials provided to a client device such as the client device .

Because connections between client devices and services are established via the AAA server the server may monitor and analyze the connections to generate the logs . The logs may include information associated with the usage of services by client devices such as which client devices use which services how much of each service is used by each client device a length of each connection between a client device and a service an amount of bandwidth used by each connection between a client device and a service etc. The logs may be used to modify services such as changing which services are offered changing which clients are permitted to access which services and other modifications to improve service utilization. For example the AAA server may collect and analyze the logs to determine information such as why a client device is connecting to a service whether the client device is using the service correctly and efficiently how the client device may be contacted whether the client device is accessing sensitive e.g. critical or confidential data what tier of service a client device belongs to whether access to a service can be throttled to a client device in emergency situations whether a client device s access to a service may be removed if they no longer access the service a history of a relationship between a client device and a service and how the relationship has changed over time etc.

The AAA security model described herein is based on a relationship between a client device and a service. Service providers register services with the AAA server . To access a service that is registered with the AAA server client devices request permission to access the service. In some cases client access requests may be granted or denied by the service provider. For example if the service provider approves the request to permit access to the service a relationship is established between the client device and the service provider. The AAA server keeps a record of the client service relationship tracks changes to the relationship over time and deploys credentials e.g. set of credentials . Once a relationship is established AAA adds authentication data to each of the logs including client device identifiers service provider identifiers and a success or failure of authentication and or authorization.

The AAA server may develop a policy for each of the services that are registered with the AAA server . For each service the policy may include a whitelist of clients authorized to make requests and a scope of the requests e.g. which actions a client device can perform with a particular service . The policies may be maintained by the AAA server in the authorizations . The AAA server may provide the policies to client devices and to service providers on a regular basis e.g. at regular intervals and or in response to specific events . When a client device accesses a service the policies of the client device may be compared with the policies of the service. If the policies match the service may respond to the client device. If the policies do not match the AAA server may follow rules provided by the service owner to determine whether to allow or block the request from the client device to access the service.

The AAA server may thus act as a secure intermediary between service providers such as the server and client devices such as the client device . The AAA server maintains the credentials e.g. keys set of credentials or the like rather than the service providers or the client devices. For example if the connection request is approved the AAA server may provide the Nth set of credentials to both the client device and the server . The client device may sign the connection request e.g. requesting a connection to the services with the Nth set of credentials . When the server receives the client request the client request may include the Nth set of credentials . The server may validate the client request based on the Nth set of credentials .

In contrast to conventional authorization schemes that focus solely on granting access to a resource the AAA server enables client devices and service providers to establish and maintain an ongoing relationship. This relationship encompasses several goals including verifying an identity of the client device Authentication providing the client permission for a limited scope of actions Authorization and monitoring and analyzing ongoing communication between client devices and services Accounting . The AAA server may be used whenever sensitive data is involved. One advantage of using the AAA server is that the AAA server handles whitelisting and blacklisting tasks such that service owners may no longer maintain an individual client list and perform additional tasks when adding a new client. The AAA server is designed to handle the dirty work of maintaining relationships from creating and maintaining client whitelists to managing permissions on a fine grained level. The AAA server may block intrusions and protect from inadvertent leaks and provide the logs to enable resource e.g. services allocation and efficient usage of resources because the AAA server tracks detailed information about client devices and services and monitors client service relationships over time.

Thus after a service provider has registered a service and after a client device has received permission to access the service the client device may request to connect to the service as needed. Either the AAA server or the server may determine whether to grant the connection request. If the connection request is granted the response to the connection request may include information such as a location e.g. a port number an internet protocol address a uniform resource locator or the like credentials or other information that enables the client device to connect to the service.

The computing device may include one or more processors one or more computer readable media a network interface card NIC a basic input output system BIOS and a controller . The computer readable media may include various types of memory including volatile e.g. disk based storage devices and non volatile e.g. random access memory RAM storage devices. The computer readable media may include one or more instructions that are executable by the processors to perform various functions. The NIC may enable the computing device to communicate with other computing devices using a network such as the network of . The NIC may include firmware that includes instructions to enable the NIC to perform various communication functions. The controller may be used to control a storage device such as a hard disk or solid state drive. The controller may include firmware that includes instructions to enable the controller to perform various storage related functions such as writing data to a storage device and reading the data from the storage device. The BIOS the firmware the firmware or any combination thereof may be stored in a read only memory ROM such as electrically erasable programmable ROM EEPROM . The EEPROM may enable authorization logic to be embedded into the client device when the computing device is initially provisioned.

The system BIOS may comprise non volatile memory including instructions that the processors execute upon startup. The instructions in the BIOS may initialize various subsystems such as networking systems storage systems and so forth. The BIOS may also contain instructions and functionality that are used during normal non startup operations of the computing device .

Various computer peripherals may also have firmware. Note that such firmware may include instructions that are executed for normal operations of the peripherals as well as boot firmware that is executed upon startup of the peripherals. For example the firmware may be executed upon startup of the computing device to initialize the NIC . Likewise the firmware may be executable to initialize storage capabilities of the computing device . The instructions stored by the firmware and or may be executed upon startup by the processor s or by processors associated with the NIC and controller . Certain portions of the firmware of the various computer peripherals may also be invoked during normal post startup operations of the computing device .

One or more of the subcomponents of the computing device may be configured as boot devices or components. Thus the system BIOS may be configured to perform low level initializations and to then look to a peripheral device or subcomponent for higher level instructions. A boot device may contain or provide access to operating software for a computer such as an operating system. A boot device may also contain or provide access to instructions for provisioning a computer.

The computing device may be configured through its BIOS to initially use the computer readable media as a boot device. The NIC may be configured by way of its firmware to contact an authorization server e.g. the AAA server of through the network for authorization credentials provisioning information software other data or any combination thereof. The authorization server may be maintained by a business entity to automatically provision its own computers or may be maintained by a service provider for use by multiple customers of the service provider.

The authorization server may be identified and accessed by a specific network address. In the Internet environment the authorization server may be identified by a unique IP address or Universal Resource Locator URL . Other forms of global identification may also be used to uniquely identify the provisioning service among different network entities that are accessible through the network .

The authorization logic may be embedded within firmware such as in one or more of the BIOS the firmware of the NIC the firmware of the controller the firmware of other components associated with the computing device or any combination thereof. As illustrated in authorization logic may embedded in the firmware and may be configured to be executed upon computer startup. In addition the authorization logic may configured to repeatedly contact the authorization server to obtain authorization for continuing operations of the computing device and to at least partially disable the computing device upon failure to obtain such authorization. In some implementations the authorization logic may be implemented using a field programmable gate array FPGA or similar technology.

In some embodiments the authorization logic may include an authentication server identifier SID identifying an authorization server e.g. the AAA server from which the computing device is to obtain credentials. The authentication server identifier may be an IP address a URL or some other type of location identifier allowing the computing device to identify and access the authorization server via a network.

The authorization logic may include a device identifier . The device identifier may enable the computing device to verify the identity of the authorization server and may enable the authorization server to authenticate the computing device . Using the device identifier the computing device may determine whether it is communicating with the intended authorization server. Similarly the authorization server may whether it is communicating with authorized devices. The device identifier may also enable the authorization server to reliably identify the computing device and to provide customized provisioning information and software for different computing devices. For example the device identifier may uniquely identify the client device from among other computing devices. The authorization server may be able to quickly and easily identify a particular computing device from multiple computing devices based on the unique identifier included in the authentication information . The device identifier may include a key e.g. credentials or may be include as part of a key.

In some implementations the NIC may include a chipset that is capable of performing encryption and or decryption functions while in other implementations the firmware may include instructions for performing encryption and or decryption functions. Locating the encryption and or decryption functions at a low level of the NIC may enable relatively fast tamper resistant operations.

The authorization logic may be configured in such a way that it is tamper proof tamper resistant and or tamper evident so that it is impractical for someone in possession of the computer to alter the computer hardware. Furthermore the authorization logic may be physically integrated with the encryption decryption capabilities of a storage device so that it becomes impractical to bypass the security related functionality described above without destroying or breaking the encryption decryption capabilities of the storage device.

The device identifier may include private credentials such as a private key . The computer readable media may be used to store public credentials such as public keys that are received from the AAA server . The authorization logic may sign at least some communications sent from the computing device using the private key . For example the authorization logic may append or prepend encrypted data identifying that the communications were sent by the computing device . When the computing device receives a communication that includes encrypted data a software component of the computing device such as an operating system may decrypt e.g. authenticate the communication using the credentials . The private key may be accessible to the authorization logic but not to other components e.g. an operating system or software applications of the computing device .

Thus the computing device may be used to various devices discussed herein such as the client device or the server of or . For example the components and of the computing device may correspond to the components and of the client device and or the components and of the server . Similarly the firmware of the client device and or the firmware of the server may include one or more of the firmware the firmware or the BIOS .

In the flow diagrams of each block represents one or more operations that can be implemented in hardware software or a combination thereof. In the context of software the blocks represent computer executable instructions that when executed by one or more processors cause the processors to perform the recited operations. Generally computer executable instructions include routines programs objects modules components data structures and the like that perform particular functions or implement particular abstract data types. The order in which the blocks are described is not intended to be construed as a limitation and any number of the described operations can be combined in any order and or in parallel to implement the processes. For discussion purposes the processes and are described with reference to the architectures and as described above although other models frameworks systems and environments may implement these processes.

At a registration request to register a service may be received from a service provider. For example in the AAA server may receive the registration request from the server e.g. the service provider to register one or more of the services . The registration request may include the identifier that is embedded in the firmware . In some cases the identifier may comprise a private key.

At a registration response is sent to the service provider. For example in in response to receiving the registration request the AAA server may determine whether the server e.g. the service provider is a trusted device based on the identifier . If the AAA server determines that the server is a trusted device the AAA server may register one or more of the services and send the registration response to indicate that one or more of the services was registered. If the AAA server determines that the server is not a trusted device e.g. the identifier is unrecognized or the identifier is associated with a device that was reported lost or stolen the AAA server may send the registration response indicating that the registration request was denied and none of the services were registered.

At the service provider may be enabled to download a software library to enable secure communications. For example in the AAA server may include information e.g. a download link in the registration response to enable the sever e.g. the service provider to download and install the software library . The software library may enable the services to be securely provided to client devices.

Thus a service provider may send a request to an AAA server to register a service. The request may include a device identifier associated with a computing device e.g. server that hosts the service. The AAA server may determine whether the server is a trusted device based on the device identifier. If the AAA server determines that the server is a trusted device the AAA server may register the service. In addition the AAA service may enable the service provider to download a software library that includes modules to securely communicate with client devices. If the AAA server determines that the server is not a trusted device the AAA server may not register the service and may take protective actions such as blacklisting the service provider.

At a service request may be received from a client device. The service request may request permission to access a service provided by a service provider. For example in the client device may send the service request requesting permission to access one or more of the services .

At an access request may be sent to the service provider. The access request may indicate that the client device is requesting permission to access the service provided by the service provider. For example in in response to receiving the service request the AAA server may send the access request to the server . The access request may include information associated with the service request such as the identifier of the requesting device e.g. the client device which of the services are being requested reason s why the requesting device is requesting access and or other information associated with the service request .

At a service response is received from the service provider. For example in in response to receiving the access request the server may determine whether to allow or deny the request from the client device to access one or more of the services and send the service response to the AAA server .

At a determination may be made whether the access request was granted. If a determination is made that the access request is granted at then the client device may be enabled to access the service at . If a determination is made that the access request is not granted at then the client device may be denied access to the service at . For example in the AAA server may determine based on the service response whether or not to grant the client device access to one or more of the services . If the service response indicates that the service request was approved by the service provider e.g. the server the AAA server may note in the authorizations that the client device is authorized to access one or more of the services and send the service access response indicating that the client device has permission to access one or more of the services . If the service response indicates that the service request was denied by the service provider the AAA server may note in the authorizations that the client device is not authorized to access one or more of the services and send the service access response indicating that permission to access one or more of the services was denied.

In some cases and may not be performed. For example the AAA server may determine based on the service request whether to grant the client device permission to access the services . For example the AAA server may determine based on the identifier included in the service request that the client device was reported lost or stolen and deny the service request without sending the access request .

Thus when a client device requests permission to access a service in some cases the AAA server may ask the service provider to determine whether to enable the client device to access one or more service provided by the service provider. In other cases the AAA server may determine whether to enable the client device to access one or more service provided by the service provider.

At a connection request may be received from a client device to access a service provided by a service provider. At a determination may be made whether to approve access to the service. If a determination is made to approve access to the service at then credentials to enable the client device to access the service may be provided at . If a determination is made to deny access to the service at then the client device may be denied access to the service at .

For example in the AAA server may receive the connection request from the client device . The connection request may request permission to connect to one or more of the services that the client device was previously approved to access. In response to the connection request the AAA server may grant or deny the connection request or the AA server may send the client request to the server to enable the server to grant or deny the connection request . If the connection request is approved e.g. either by the AAA server or by the server then the connection response may indicate that the connection request was approved and include information to enable the client device to connect to one or more of the services . For example the information in the connection response may include credentials e.g. a public key or a private key a location e.g. a port number or other information that enables the client device to connect to and use the services .

After providing the credentials to enable the client device to access the service at a determination may be made that the client device has established a connection to the service at . At data may be collected by monitoring the connection e.g. between the client device and the service . At one or more logs may be generated based on the collected data.

For example in after sending the connection response to the client device the AAA server may determine that the client device has established a connection to one of the services . The AAA server may monitor the connection and collect data associated with the connection such as how long the client device was connected how much data was exchanged what type of transactions occurred etc. The AAA server may generate one or more of the logs based on the collected data. For example the AAA server may analyze the collected data and determine that the client device is using the service more than other client devices and generate a log indicating that the client device is using the service more than other client devices.

At a registration request may be received from a service provider to register a service. At the service may be registered. For example in the AAA server may receive the registration request from a service provider e.g. the server to register one or more of the services that are hosted by the server . The AAA server may determine whether or not to register the services based at least partly on an identity of the service provider e.g. based on the identifier . If the AAA server determines that the service provider is a trusted service provider the AAA server may register one or more of the services .

At an access request from a client device may be received. The access request may request permission to access the service. At the service provider may be asked to approve or deny the access request. At a determination may be made whether the access request was approved. For example in the client device may send the service request to the AAA server requesting permission to access one or more of the services . In response the AAA server may send the access request to the server . The access request may provide information associated with the service request such as an identity e.g. the identifier of the client device why the client device is requesting access and the like. The server may determine whether to grant the service request based on the information and send the service response to the AAA server . The AAA server may determine based on the service response whether the server approved or denied the service request .

If a determination is made that the access request is approved at the client device may provided credentials to enable the client device to sign requests e.g. connection requests to the service provider at . For example the client device may be provided a key or other type of credential to enable the client device to sign requests to connect to the service.

At the credentials may be provided to the service provider to enable the service provider to validate requests e.g. from client devices to access the service. For example the service provider may be provided the key or other type of credential that was provided to the client device to enable the service provider to validate requests to connect to e.g. utilize the service provided by the service provider.

If a determination is made that the access request is not approved at the access request may be denied at . For example if a determination is made that the client device was reported lost stolen or otherwise compromised the access request may be denied and protective actions e.g. blacklisting the client device may be performed.

The various techniques described above are assumed in the given examples to be implemented in the general context of computer executable instructions or software such as program modules that are stored in computer readable storage and executed by the processor s of one or more computers or other devices such as those illustrated in the figures. Generally program modules include routines programs objects components data structures etc. and define operating logic for performing particular tasks or implement particular abstract data types.

Other architectures may be used to implement the described functionality and are intended to be within the scope of this disclosure. Furthermore although specific distributions of responsibilities are defined above for purposes of discussion the various functions and responsibilities might be distributed and divided in different ways depending on particular circumstances.

Similarly software may be stored and distributed in various ways and using different means and the particular software storage and execution configurations described above may be varied in many different ways. Thus software implementing the techniques described above may be distributed on various types of computer readable media not limited to the forms of memory that are specifically described.

Furthermore although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described. Rather the specific features and acts are disclosed as exemplary forms of implementing the claims.

