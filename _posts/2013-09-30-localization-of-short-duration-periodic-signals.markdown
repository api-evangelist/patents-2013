---

title: Localization of short duration periodic signals
abstract: A method for localizing signals of interest includes initializing characteristics of the signals. Signals are acquired from a sensor array having at least three acoustic sensors. After digitization and conditioning, the signals associated with each sensor are validated by comparison with initialized characteristics. The signals are correlated across sensor groups to obtain time differences of arrival (TDOA). These TDOA are validated and associated with other TDOA from different times. TDOA from different sensor pairs are associated when they share a common sensor. A hyperbola of possible locations is created for each validated TDOA. Summation of the hyperbolas gives an intensity function. The location is identified as the most intense point in the intensity function. The source can be tracked across time as a computer output.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09470775&OS=09470775&RS=09470775
owner: The United States of America as represented by the Secretary of the Navy
number: 09470775
owner_city: Washington
owner_country: US
publication_date: 20130930
---
The invention described herein may be manufactured and used by or for the Government of the United States of America for governmental purposes without the payment of any royalties thereon or therefor.

The present invention relates to locating and tracking the source of short duration periodic signals. More particularly it relates to locating and tracking these sources utilizing time difference of arrival TDOA validation and association measures.

In passive sonar as shown in it is well known to deploy an array of acoustic sensors from a vessel in a body of water . Each acoustic sensor or hydrophone on array is positioned a known distance from another hydrophone along the array line or other such structure. Hydrophones are capable of receiving acoustic signals from sources such as . Array is typically joined to a signal processor on board vessel . Once such a signal has been received at several hydrophones signal processor utilizes the time the signal arrives at each hydrophone to calculate a time difference of arrival TDOA between several pairs of hydrophones. The signal processor has a sound velocity profile from either calculation a database or a determination giving the speed of sound in the body of water and separation between the hydrophones is also known. Using the known distances the sound velocity profile and the TDOAs from the array the signal processor can utilize hyperbolic calculations to determine the location of source .

Source can be a variety of sources such as vessels pingers marine mammals or the like. Marine mammals and other biological sources often make short duration periodic signals such as clicks. It is common to locate whales by measuring the time difference for the same click arriving at two spaced hydrophones.

There are several deficiencies with the current state of the art. First many false TDOA measurements are created with TDOA estimates that are found using correlation. When data from two hydrophones are correlated the noise that is independently received at each sensor does not correlate well and produces very little or no output. However when a common signal is present at the two hydrophones it will cause a correlation peak at the TDOA estimate. When the signal is weak it is difficult to separate the valid TDOA measurements from fluctuations caused by noise or false peaks spaced from the true peak by the period of the repeating click sequence.

Another issue with the current state of the art arises when more than one source is present with each source having a similar signal. This can occur when the sources are whales in a pod. In this case a set of hyperbolic solutions will be created for each source and many false intersections are created when the hyperbolic solutions of one source intersects the solutions of another source. It is impossible to know that these intersections are false unless additional information is made available. One way to resolve these ambiguities is to only accept intersections of hyperbolic solutions from hydrophone pairs that share one hydrophone referred to as hydrophone triples . This results in a fixed relationship between the TDOA measurements that can be checked for consistency.

The problem with the hydrophone triple method is that it does not lend itself well to soft decisions in other words whether the TDOAs are related or not related. Granted it could be adapted to a soft measure simply by measuring how well the fixed relationship holds. However to get a meaningful measure of association it is necessary to compare the full set of click arrivals that went into making the TDOA estimate.

As can be seen there is a need for improved methods for detection TDOA determination and TDOA association for localization of sources such as marine mammals and other short duration periodic signal sources.

Accordingly it is an object of the present invention to provide a method for locating short duration periodic signal sources.

Accordingly there is provided a method for localizing and tracking a short duration periodic signal source utilizing a computer. The method includes initializing signal characteristics of signals of interest and acquiring signals from a sensor array having at least three acoustic sensors. The signals are digitized and conditioned based on initialized signal characteristics. The conditioned signals are validated for each sensor by comparison with initialized signal characteristics. The validated conditioned signal associated with one sensor are correlated with the validated conditioned signal associated with another sensor for each sensor pair in the sensor array to obtain time differences of arrival for each sensor pair. These time differences of arrival are validated for each sensor pair. Time differences of arrival from different times from the same sensor pairs are associated with each other and time differences of arrival from different sensor pairs are associated with each other when the time differences of arrival share a common sensor. Hyperbolas of possible source locations are created for each validated time difference of arrival. These hyperbolas are summed to obtain an intensity function. The location of the signal of interest can be found at a time as the position in the intensity function having the greatest intensity. A source can be tracked across time by utilizing the identified location and associated validated time differences of arrival from different times. The identified location and track can be provided as computer output.

Referring now to there is shown a flowchart giving an overview of the current procedure. Details of each step in the method will be provided following this overview. In step the method is initialized by developing known information for use in the method. This includes a generic replica of the signal of interest a range of frequencies for the signal of interest and a threshold time used to distinguish reflected signals from source signals. The method also uses a computer model trained from experimental and known data to identify valid data and invalid data. This computer model is developed before using the current method to localize signal sources.

In step signals are acquired from an array of hydrophones having at least three hydrophones as described with reference to . The signals are digitized and processed separately. A typical input signal in the time domain is given in . Each signal is correlated in step with the replica developed in step . This correlation reduces signals from sources other than the source of interest and is known in the prior art. Each correlated signal is transformed into a frequency domain signal utilizing a Fourier transform in step . In step peaks are found in the time domain. Peaks not meeting previously developed parameters concerning frequency and timing are eliminated in step . A first order smoothed click map SCM is developed for each signal in step . This SCM is time windowed in step to create a windowed first order smoothed click map WSCM . In step the SCM from one hydrophone is correlated with the WSCM from a second hydrophone. An initial time difference of arrival TDOA can be given by a peak from this correlation.

In step the initial TDOAs are examined to determine if these initial TDOAs are valid. This is performed by calculating a second order smoothed click map SCM and determining if the clicks occur with an expected inter click interval established in step . Another validation test is performed by analyzing the autocorrelation function of the SCM. The trained computer model from step can be used to establish this validity from these measures as described below. On completion of this step invalid TDOAs are removed from processing. In step TDOAs from different time segments are associated with each other for tracking a source across time segments. TDOAs from different sensor pairs incorporating one common sensor can be associated with one another in step . This step produces an association measure that can be used to further modify the analysis. The associated TDOAs are used to create hyperbolas indicating the source location in step . Different sensor pairs give different hyperbolas. These created hyperbolas are modified by an association measure calculated in step and summed in step to get an intensity function. The location of the source is identified as the location with the highest intensity value in step .

This process is further described as follows. Data was acquired as in step at a sample rate of 96 kHz. After replica correlation the instantaneous power is shown . The base level signal is indicated at . Higher level signals are given at . These periodic signals of interest could be whale calls and the current example was captured from calls from Blainville s beaked whale. The overall signal is processed in step by developing a matched filter derived from calls from Blainville s beaked whale using distributed bottom mounted hydrophones. A replica waveform was obtained by starting with a single high signal to noise ratio SNR whale click then determining the peak time of the correlator output response for a training set of several hundred clicks. Each click was time delayed to align to a data window so that the clicks from all training samples were time aligned. These were then averaged to obtain the new reference click. After three repetitions it was found that the replica didn t change significantly.

Utilizing the prior art technique of correlation with the replica was conducted utilizing the following equation 

After replica correlation the Fourier transform of step was calculated. In this step the time series was processed by a Hanning weighted seventy five percent overlapped short time Fourier transform spectrogram with a transform size of 24. This produced a 0.0625 millisecond msec time resolution. Each Fourier transform bin was normalized separately by a time domain median based background power estimator. To obtain total power a frequency weighted power summing across frequency was performed selecting only the frequency bands in which the beaked whale energy lies 14 40 kHz . These frequency bands were selected for experimental data in the initialization step step . This produced a power time series with 0.0625 msec resolution that was searched for local maxima above a threshold to identify candidate clicks. A fine click time location was then found by parabolic interpolation of the power time series. This is step of .

In order to remove clicks outside known parameters step a click center frequency was obtained by finding the power weighted mean frequency of the click energy from the spectrograph at the detected time 

After elimination of spurious clicks the method proceeds to step . Traditionally TDOA is determined by producing an amplitude versus time description amplitude time series of each hydrophone then correlating the amplitude time series from two nearby hydrophones. If the clicks from a given whale are present in each amplitude series then there will be a correlation peak at the corresponding time delay. It is useful to correlate in such a way that the value of the correlator peak is an indication of the number of clicks that associate or correlate and not a function of click amplitude. To do this amplitude information is eliminated by forming a synthetic time series of impulses at the times of the detected clicks. This is called a click map . This method further processes the click map by implementing time domain smoothing in order to allow time uncertainty to be incorporated into the correlation process. The resulting click map is referenced as a first order smoothed click map SCM since it is derived from the detections of a single hydrophone.

A first order smoothed click map SCM of length T was created from click time locations tand amplitudes a. The time window T was 12 seconds. A synthetic sample rate of f 3 kHz was chosen producing a synthetic time series of N 36 000 samples. The ideal synthetic time series was constructed in the frequency domain as

Time windowing is also needed prior to cross correlation to limit wrap around circular correlation effects. To prevent correlation loss however a time windowed SCM from one hydrophone is correlated with a non time windowed SCM from the other hydrophone. The time windowed SCM is given in the frequency domain by

The correlation of step in the frequency domain is performed by using the time windowed SCM WSCM of one hydrophone tilde over X from equation 5 and the non windowed SCM of the other hydrophone Xfrom equation 3 . For hydrophones a and b 

The data from the correlation result often contains a great number of peaks but only a very small number are valid. Validity can be shown with reference to . The upper portion shows the SCM of a first hydrophone and the lower portion shows the SCM of a second hydrophone. A delay has been applied to the second hydrophone equal to the largest correlation peak from . The first SCM has been artificially raised to a resting value of 0.4 for clarity. For many of the peaks in the lower SCM there is a corresponding peak in the upper one. shows a multiplication of the two SCMs together which is an estimate of the whale source time series based on two hydrophones. This is the second order smoothed click map SCM . The SCM is always time referenced to the first hydrophone the one with no delay applied . The number of clicks roughly corresponds with the correlator output magnitude. shows one measure of validity because it has an inter click interval ICI of 0.33 seconds. The ICI of the regular foraging clicks of the Blaineville s beaked whale are known in the prior art to be 0.37 seconds on average with 0.1 sec standard deviation.

In order to objectify the validity analysis the method utilizes initial parameters to identify a set of features of the SCM. These features are obtained from the auto correlation function ACF and power spectrum PS of the source time series estimate. Date form the smoothed ACF has a ripple at the 0.33 second inter click interval rate and the power spectrum has a peak near 3 Hz. A change in the ICI can cause the power spectrum to have multiple peaks. Thus experimentally derived characteristics of a valid SCM are that the smoothed auto correlation function ACF r normalized for r 0 1 exhibits ripple at time lag equivalent to the ICI denoted by T. The peaks in the ACF slowly drop in amplitude as increases. Also the power spectrum i.e. the Fourier transform of the autocorrelation function exhibits a large peak at the frequency 1 T.

These characteristics can be established by calculating the moments of the ACF and saving the value of the power spectrum at 1 T. The p th moment of the ACF is given by 

In step of TDOAs can be associated across different time periods. In the prior art this was done by correlating the output of two sensors over time to give a graph such as that shown in . In higher intensity tracks are generally interpreted to be the same correlated signals over time. For measurements at sequential times on a given single hydrophone pair the time windows used in the correlation will be highly overlapped. In a test of beaked whale data a 12 second window with 2 second update period was used resulting in 10 seconds of overlap. If the TDOA measurements made at consecutive times are from the same whale the TDOA values will be nearly the same but will differ slightly due to the movement of the whale and the fact that new source clicks have moved into the processing window. But if there is a high degree of overlap between the processing windows many of the same clicks will be present in both time updates. So if the source time series is estimated click times can be directly compared after taking into account the shift in the processing window.

To obtain a measure of click matching peaks shown in the SCM were used to locate source clicks then the times of the source clicks from sequential time windows were compared. Let nand nbe the number of source clicks detected at time windows p and q. Let

Only sequential measurements with above a threshold are assumed to associate. It has been determined empirically that good thresholds are that should be greater than 7 and the TDOA difference should be less than 3 ms at 2 second update . Only those TDOA measurements with at least one sequential association were accepted. This means that to accept a TDOA measurement it must be detected in at least two consecutive time updates.

According to step of TDOAs obtained from different pairs of hydrophones must be analyzed to determine if they are related. This is accomplished by click matching in essentially the same way that consecutive TDOA measurements were associated in step . The second order smoothed click map SCM is obtained for two TDOA measurements made using two different hydrophone pairs but with a shared hydrophone. If times are referenced to the common hydrophone the click times should match.

Thus the system has acquired data from at least three hydrophones. All of the hydrophone pairs at approximately the same time have been correlated to obtain a collection of TDOA measurements. Using this data is calculated as an association measure that relates TDOA measurements l and m. If TDOA measurements l and m do not share exactly one hydrophone then 0. Otherwise 

Localization of the signals is carried out in steps and utilizing hyperbolic positioning with an intensity function. Hyperbolic positioning is a well known technique for localizing a signal emitter having an unknown position. If the depth z is assumed known the locus of points representing the possible locations of the source are given by a hyperbola in the x y plane. Let i m and j m be the two hydrophone indexes used to measure TDOA m. Let T m x y z be the model propagation time from position x y z to hydrophone i m . Then the model propagation time difference dis 14 The TDOA measurement should ideally be equal to d x y z . The solution of the equation 15 is a surface of points that intersects a constant depth plane on a hyperbola. Thus for every TDOA measurement that has been suitably vetted the corresponding hyperbola is drawn on the x y plane using an assumed depth z. This is given as step of . Rather than drawing hyperbolas as thin lines these hyperbolas can be modified to allow for time delay error by assigning a likelihood or probability to a position on a grid based on the difference between the model time delay assuming that position and the measured time delay for the given hyperbolas . This is known in the art. For an assumed depth z and a particular TDOA measurement m an intensity is assigned to each point x y according to a Gaussian function

The current invention teaches improving on the localization given by and equation 17 by using the TDOA association measure . In order to improve the localization the current method sums all pairs of TDOA measurements adding up the product of the spatially smoothed hyperbolas weighted by the soft association measure . This gives

The result of this procedure is shown in for the same data as . Only one point in the plane can be seen. This is the localized point given by equation 18 . This can be provided to a user or another automated system in order to guide the user toward or away from the source. If this process is repeated stepping forward by 2 seconds at a time a sense of the movement of the source is developed.

In step of a depth for the source can be established. A three dimensional volume can be obtained by repeating the procedure at a set of depths. In order to maximize this process a three dimensional peak peaking algorithm can be used however this results in many local maxima. These can be used as candidate position solutions that can be associated utilizing the TDOA association measure . One way of performing this association is by utilizing the technique taught in Baggenstoss P. M. An algorithm for the localization of multiple interfering sperm whales using multi sensor time difference of arrival 130 Journal of the Acoustical Society of America 2011 hereinafter Baggenstoss 2011 which is incorporated by reference herein. In this technique candidate solutions compete for the TDOA measurements. Weights w are established that relate the TDOA to the solution by approximating the probability that measurement m belongs to solution k. These weights are iteratively updated as the position estimates are refined.

In order to incorporate the inter TDOA association measure the following steps are utilized. M is the number of TDOA measurements and K is the number of candidate solutions. The association weights are initialized to the flat condition 

In the current method the TDOA weights w are augmented by another weighting. First a weighting is defined that depends only on the time delay error as follows 

It will be understood that many additional changes in the details materials steps and arrangement of parts which have been herein described and illustrated in order to explain the nature of the invention may be made by those skilled in the art within the principle and scope of the invention as expressed in the appended claims.

The foregoing description of the preferred embodiments of the invention has been presented for purposes of illustration and description only. It is not intended to be exhaustive nor to limit the invention to the precise form disclosed and obviously many modifications and variations are possible in light of the above teaching. Such modifications and variations that may be apparent to a person skilled in the art are intended to be included within the scope of this invention as defined by the accompanying claims.

