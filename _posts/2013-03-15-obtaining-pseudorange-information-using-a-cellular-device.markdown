---

title: Obtaining pseudorange information using a cellular device
abstract: The cellular device accesses a GPS/GNSS chipset embedded within the cellular device. The GPS/GNSS chipset calculates pseudorange information for use by the GPS/GNSS chipset. The cellular device extracts the pseudorange information from the GPS/GNSS chipset for use elsewhere in the cellular device outside of the GPS/GNSS chipset.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09429640&OS=09429640&RS=09429640
owner: Trimble Navigation Limited
number: 09429640
owner_city: Sunnyvale
owner_country: US
publication_date: 20130315
---
This application claims priority to and benefit of U.S. Patent Application No. 61 746 916 filed on Dec. 28 2012 entitled IMPROVED GPS GNSS ACCURACY FOR A CELL PHONE by Rudow et al and assigned to the assignee of the present application.

The Global Positioning System GPS and its extensions in the Global Navigation Satellite Systems GNSS have become thoroughly pervasive in all parts of human society worldwide. GPS and GNSS receivers in the form of chipsets have become widely incorporated into cell phones and other types of cellular devices with cellular based communications equipment.

Typically cellular devices include highly integrated GPS GNSS chipsets that are designed to work with the E 911 service primarily and are not designed to provide anywhere near a full range of features and outputs. They do provide a position fix but are not designed to make available very many other parameters of interest. All GPS GNSS receivers must acquire track and decode a data message that conveys information about the location of the satellites in space and time information. The principal additional parameter obtained is the pseudorange. However this set of data is not available as an output from the cell phone GPS chipsets for use by the cellular device itself. In circumstances where it is available it is under access control by the vendor.

Reference will now be made in detail to various embodiments of the subject matter examples of which are illustrated in the accompanying drawings. While various embodiments are discussed herein it will be understood that they are not intended to limit to these embodiments. On the contrary the presented embodiments are intended to cover alternatives modifications and equivalents which may be included within the spirit and scope the various embodiments as defined by the appended claims. Furthermore in the following Description of Embodiments numerous specific details are set forth in order to provide a thorough understanding of embodiments of the present subject matter. However embodiments may be practiced without these specific details. In other instances well known methods procedures components and circuits have not been described in detail as not to unnecessarily obscure aspects of the described embodiments.

Unless specifically stated otherwise as apparent from the following discussions it is appreciated that throughout the description of embodiments discussions utilizing terms such as accessing extracting bridging determining displaying performing providing obtaining calculating receiving storing notifying matching creating generating communicating transmitting using requesting providing activating deactivating initiating terminating causing transforming data modifying data to transform the state of a computer system or the like refer to the actions and processes of a computer system data storage system storage system controller microcontroller processor or similar electronic computing device or combination of such electronic computing devices. The computer system or similar electronic computing device manipulates and transforms data represented as physical electronic quantities within the computer system s device s registers and memories into other data similarly represented as physical quantities within the computer system s device s memories or registers or other such information storage transmission or display devices.

Cellular devices such as cell phones and non voice enabled cellular devices can provide pseudorange information that can be used in surveying. However the pseudorange information from cellular device chipsets are only available under a limited set of conditions usually only when performing a E 911 service call and then only for use by the Assisted GPS service located in conjunction with the E 911 service facility. Therefore according to one embodiment a GPS GNSS chipset which calculates pseudorange information for use by the GPS GNSS chipset embedded within a cellular device is accessed. The pseudorange information from the GPS GNSS chipset is extracted for use elsewhere in the cellular device outside of the GPS GNSS chipset.

As depicted in the cellular device includes a GPS GNSS chipset a GPS GNSS receiver a processor that is part of the GPS GNSS receiver a chipset accessor a pseudorange information extractor an improved accuracy SUPL client a pseudorange information bridger a pseudorange information processing component an operating system a location manager a location displayer and a processor that is outside of the GPS GNSS receiver . According to one embodiment the chipset accessor the pseudorange information extractor the pseudorange information processing component and the pseudorange information bridger are a part of the improved accuracy SUPL client . According to one embodiment the pseudorange information processing component includes a pseudorange corrector carrier phase smoothing and an augmented position determiner .

According to one embodiment the processor and the GPS GNSS receiver are a part of the GPS GNSS chipset . According to one embodiment the chipset accessor pseudorange information extractor the pseudorange information bridger the improved accuracy SUPL client the operating system and the processor are located in a portion of the cellular device that is outside of the GPS GNSS chipset . The location manager can be a part of the operating system and external to the GPS GNSS chipset . According to one embodiment the location displayer is a part of the location manager . According to one embodiment the chipset accessor pseudorange information extractor the pseudorange processing component pseudorange corrector carrier phase smoothing augmented position determiner pseudorange information bridger and improved accuracy SUPL client are application programming interfaces API function applications that reside in memory of the cellular device and are executed by a processor of the cellular device .

The GPS GNSS receiver can perform GPS measurements to derive raw measurement data for a position of the cellular device . The raw measurement data can provide an instant location of the cellular device . According to one embodiment the raw measurement data is the pseudorange information that is extracted also referred to as extracted pseudorange information . The extracted pseudorange information may be referred to as uncorrected pseudorange information observed pseudorange information or unsmoothed pseudorange information. Conventionally the raw measurement data is only for use by the GPS GNSS chipset and the GPS GNSS chipset calculates pseudorange information that is only for use by the GPS GNSS chipset . Examples of pseudorange information are uncorrected pseudorange information differential GNSS corrections high precision GNSS satellite orbital data GNSS satellite broadcast ephermis data and ionosopheric projections.

The chipset accessor is configured for accessing the GPS GNSS chipset . The pseudorange information extractor is configured to extract the pseudorange information that is accessed. The extracted pseudorange information can be received and stored continuously. The pseudorange information bridger is configured for bridging the pseudorange information from the GPS GNSS chipset to the location manager that resides in the operating system of the cellular device .

According to one embodiment the chipset accessor the pseudorange information extractor the pseudorange information processing component and pseudorange information bridger are a part of an improved accuracy SUPL client . For example The SUPL client can interface between the GPS GNSS chipset and the location manager which resides in the operating system . The pseudorange information can be obtained from the processor of the GPS GNSS receiver using a command via a high precision Secure User Platform Location SUPL .

According to one embodiment the GPS GNSS chipset is accessed using an operation that is a session started with a message that is an improved accuracy Secure User Platform Location SUPL start message or a high precision SUPL INIT message. According to one embodiment the message is a custom command that is specific to the GPS GNSS chipset also referred to as a GPS GNSS chipset custom command and the improved accuracy SUPL client can have access to the raw measurements of the GPS GNSS chipset .

A worker thread associated with the SUPL client can monitor the raw measurements delivered by the GPS GNSS chipset into the GPS GNSS chipset s memory buffers cache the raw measurements and use the raw measurements to determine a position fix. The pseudorange information extractor and the pseudorange information processing component can be associated with the worker thread. For example the pseudorange information extractor can cache the raw measurements and the pseudorange information processing component can determine the location.

According to one embodiment the cellular device can improve the accuracy of the extracted pseudorange information. For example the extracted pseudorange information can be improved by applying pseudorange corrections to the extracted pseudorange information. Examples of an improvement source that provides pseudorange corrections are corrections feeds correction service FM radio distribution or satellite radio distributor or a combination thereof as will become more evident. According to one embodiment an improvement source is located outside of the cellular device . A pseudorange corrector can be notified that the pseudorange information is being stored. The pseudorange corrector can improve the accuracy of the pseudorange information by applying pseudorange corrections to the extracted pseudorange information. More specifically the pseudorange corrections can be received for example directly from an improvement source that is located outside of the cellular device . A pseudorange correction fetch can be notified to determine if pseudorange corrections are in memory already. If the pseudorange corrections are not already in memory the pseudorange correction fetch can be notified that pseudorange corrections need to be fetched from an improvement source. The pseudorange corrector can create corrected pseudoranges by applying pseudorange corrections to the extracted pseudorange information. The corrected pseudoranges can be received by the augmented position determiner which can perform a least squared function on the corrected pseudoranges.

In another example the extracted pseudorange information can be improved by applying carrier phase information to the extracted pseudorange information. More specifically the extracted pseudorange information can be improved by applying carrier phase information such as carrier phase and pseudorange signals that is obtained from one or more satellites that are in view of the GPS GNSS receiver to the extracted pseudorange information. A carrier phase smoothing can create smoothed pseudorange information by applying the carrier phase information to the extracted pseudorange information. The smoothed pseudorange information can be received by the augmented position determiner which can perform a least squared function on the smoothed pseudoranges.

In yet another example the extracted pseudorange information can be improved by applying additional information that is obtained for example from one or more of a compass gyroscope accelerometer and a source accessed via a Wifi or via a short range wireless communication protocol operating in the range of frequencies between 2402 2480 MHz such as Bluetooth Low Energy BLE . The additional information applicator can obtain and create corrected data by apply the additional information to the extracted pseudorange information. The corrected data can be received by the augmented position determiner which performs a least squared function on the corrected data.

Applying pseudorange corrections carrier wave information or additional information to extracted pseudorange information are examples of improving the accuracy of the pseudorange information. In still another example the extracted pseudorange information is received by the augmented position determiner which performs a least squared function on the extracted pseudorange information without further improvements to the extracted pseudorange information.

The output of the augmented position determiner can be used for determining the location of the cellular device . For example a latitude longitude and altitude can be determined based on the output of the augmented position determiner which can be displayed by the location displayer . When the location has been determined based on an improvement that results from applying pseudorange corrections carrier wave information or additional information to the extracted pseudorange information the location according to one embodiment is a position fix of the cellular device .

According to one embodiment a requested mode can be used as a part of determining whether or not to apply any improvements such as pseudorange corrections carrier wave information or additional information to the extracted pseudorange information. For example if the requested mode requests a location without improvements the location can be determined without improvements even if improvements are available or can be obtained. If the requested mode requests a position fix then the location can be determined with improvements if improvements are available.

The characteristics of the GPS GNSS chipset can be used to determine whether to apply pseudorange corrections carrier phase information or additional information. For example the characteristics of the GPS GNSS chipset can be used to determine whether the pseudorange corrections or carrier phase information provided by the chipset provides higher accuracy. For example the pseudorange corrections from some GPS GNSS chipsets provide higher accuracy than the carrier wave information from those GPS GNSS chipsets. However the carrier wave information for other GPS GNSS chipsets may provide higher accuracy than the pseudorange corrections from the other GPS GNSS chipsets.

According to one embodiment a quality of position QOP position metric is used to determine whether to improve pseudorange information by applying pseudorange corrections. For example a QOP position metric can be determined from data obtained from the GPS GNSS receiver . If the QOP position metric is less than a pre determined QOP pseudorange corrections are requested from an improvement source. Examples of requested pseudorange corrections are satellite orbital data high precision ephemeris data and DGPS DGNSS corrections.

According to one embodiment the extracted pseudorange information is observed and uncorrected. Time tags can be used for matching calculated pseudorange correction information obtained from reference stations with observed pseudorange information.

According to one embodiment the pseudorange information bridger communicates the output of the augmented position determiner to the location manager in the operating system . According to one embodiment the output of the augmented position determiner is a location that is defined in terms of latitude longitude and altitude. The location displayer can display the location with respect to a map.

Conventionally the GPS GNSS chipsets on cellular device have been designed to deliver pseudorange information to an emergency service when an E 911 call that is made on the same cellular device . Therefore according to one embodiment the emergency service is an example of an originally intended recipient of the pseudorange information. However according to various embodiments the pseudorange information is delivered to a recipient that it was not originally intended for also referred to as originally unintended recipient . For example the pseudorange information can be delivered to a portion of the cellular device outside of the GPS GNSS chipset . More specifically a GPS GNSS chip custom command can be used to access and extract the pseudorange information as discussed herein. In another example an E 911 operation can be initiated on the cellular device the pseudorange information can be accessed and redirected to a portion of the cellular device outside of the GPS GNSS chipset and the E 911 operation can be terminated prior to the emergency service being notified and prior to the pseudorange information being transmitted from the GPS GNSS chipset to the emergency service. According to one embodiment the pseudorange information is accessed at the originally unintended recipient using the extracted pseudorange information.

The cellular device is directly or indirectly in communication with communication satellites global navigation satellites terrestrial radio broadcast GPS GNSS reference stations correction services distribution service FM radio distributor satellite radio distributor over various communications links such as communications link cellular network Internet and local Wi Fi .

A global navigation satellite system GNSS provides a GNSS receiver with the capability to determine its location based on positioning signals transmitted from the GNSS satellites of the GNSS satellite system in terms of longitude latitude and altitude to within a few meters or even centimeters. GNSS based positioning has a wide range of applications including navigation and tracking and automatic positioning.

Generally for determining its position a GNSS receiver first determines distances to a plurality of GNSS satellites. Each individual distance measurement made by the receiver to a satellite located in a known orbit position traces the GNSS receiver on the surface of a spherical shell at the measured distance from the satellite. By taking several such measurements and determining an intersecting point of the spherical shells a position fix can be generated. The distance measurements to the satellites are based on a time of flight measurement of positioning signals transmitted by the satellites to the receiver and thus the measurements depend on an exact timing. Normally three distance measurements to three known satellite positions are sufficient to resolve a receiver position in space however with the receiver clock offset from satellite clock time being the fourth unknown in the equations measurements on four satellites are needed to determine the position of the receiver.

The orbit position of the satellite may be determined based on a data message superimposed on a code that serves as a timing reference. The GNSS receiver can compare the time of broadcast at the satellite encoded in the transmission with the time of reception measured by an internal clock at the receiver thereby measuring the time of flight to the satellite. GNSS systems provide satellite data messages that transmit a code with a timing reference enabling a GPS GNSS receiver to compare a successively delayed internal replica of this code with the received code from the satellite. By progressively delaying the local copy the two signals become aligned in time. That delay is the time needed for the signal to reach the GPS GNSS receiver and from this the distance from the satellite can be calculated.

The Real Time Kinematic RTK method was developed to provide greatly improved accuracy in position determination with a level of precision suitable for use in surveying. RTK positioning performs measurements of the carrier phase of the satellite signals and makes estimates of the exact number of carrier frequency wavelengths 19.6 cm to each satellite. The method is well known in the GPS GNSS positioning arts. To improve the accuracy of the estimation the RTK method provides reference data on the same set of satellite observables from another source. These reference station observables are often relayed to the rover via ground based radio transmission in order to enable the receiver to perform the double differencing process that removes error contributions.

The Cellular device is configured with a satellite radio receiver coupled with a communication bus for receiving signals from communication satellites a GPS GNSS receiver coupled with bus for receiving radio navigation signals from global navigation satellites and for deriving a position of cellular device based thereon. Cellular device further comprises an FM radio receiver coupled with bus for receiving broadcast signals from terrestrial radio broadcast . Other components of cellular device comprise a processor coupled with bus for processing information and instructions a memory coupled with bus for storing information and instructions for processor . It is noted that memory can comprise both volatile memory and non volatile memory as well as removable data storage media in accordance with various embodiments.

Cellular device further comprises a cellular transceiver coupled with bus for communicating via cellular network . Examples of cellular networks used by cellular device include but are not limited to GSM cellular networks GPRS cellular networks GDMA cellular networks and EDGE cellular networks. Cellular device further comprises a display coupled with bus . Examples of devices which can be used as display include but are not limited to liquid crystal displays LED based displays and the like. It is noted that display can be configured as a touch screen device e.g. a capacitive touch screen display for receiving inputs from a user as well as displaying data. Cellular device further comprises an audio output coupled with bus for conveying audio information to a user. Cellular device further comprises a Wi Fi transceiver and an inertial measurement unit IMU coupled with bus . Wi Fi transceiver may be configured to operate on any suitable wireless communication protocol including but not limited to WiFi WiMAX implementations of the IEEE 802.11 specification implementations of the IEEE 802.15.4 specification for personal area networks and a short range wireless connection operating in the Instrument Scientific and Medical ISM band of the radio frequency spectrum in the 2400 2484 MHz range e.g. implementations of the Bluetooth standard .

Improvements in GNSS GPS positioning may be obtained by using reference stations with a fixed receiver system to calculate corrections to the measured pseudoranges in a given geographical region. Since the reference station is located in a fixed environment and its location can be determined very precisely via ordinary survey methods a processor associated with the Reference Station GNSS GPS receivers can determine more precisely what the true pseudoranges should be to each satellite in view based on geometrical considerations. Knowing the orbital positions via the GPS almanac as a function of time enables this process first proposed in 1983 and widely adopted ever since. The difference between the observed pseudorange and the calculated pseudorange for a given reference station is called the pseudorange correction. A set of corrections for all the global navigation satellites in view is created second by second and stored and made available as a service utilizing GPS GNSS reference stations and correction services . The pseudoranges at both the cellular device GPS receiver and those at the reference stations are time tagged so the corrections for each and every pseudorange measurement can be matched to the local cellular device pseudoranges. The overall service is often referred to as Differential GPS or DGPS.

Without any corrections GNSS GPS receivers produce position fixes with absolute errors in position on the order of 4.5 to 5.5 m per the GPS SPS Performance Standard 4Ed. 2008. depicts correction services conveying these corrections via a cellular network or the Internet . Internet is in turn coupled with a local Wi Fi network which can convey the corrections to cellular device via Wi Fi transceiver . Alternatively cellular network can convey the corrections to cellular device via cellular transceiver . In some embodiments correction services are also coupled with a distribution service which conveys the corrections to an FM radio distributor . FM radio distributor can broadcast corrections as a terrestrial radio broadcast . It should be appreciated that an FM signal is being described as a subset of possible terrestrial radio broadcasts which may be in a variety of bands and modulated in a variety of manners.

In some embodiments cellular device includes one or more integral terrestrial radio antennas associated with integrated terrestrial receivers FM radio receiver is one example of such a terrestrial receiver which would employ an integrated antenna designed to operate in the correct frequency band for receiving a terrestrial radio broadcast . In this manner in some embodiments cellular device can receive the corrections via FM radio receiver or other applicable type of integrated terrestrial radio receiver . In some embodiments correction services are also coupled with a distribution service which conveys the corrections to a satellite radio distributor . Satellite radio distributor can broadcast corrections as a broadcast from one or more communications satellites . In some embodiments the cellular device includes one or more integral satellite radio antennas associated with integrated satellite radio receivers . Satellite radio receiver is one example of such a satellite receiver which would employ an integrated antenna designed to operate in the correct frequency band for receiving a corrections or other information broadcast from communication satellites . In this manner in some embodiments a cellular device can receive the corrections via satellite radio receiver .

Many more sophisticated GNSS GPS receivers have been designed to accept and implement DGPS corrections. However many of the chipsets embedded in millions of existing cellular devices are not configured to support this correction method. In fact they are not configured to even make pseudorange measurement data available to the cellular device internally. Conventionally pseudorange data from these cellular device chipsets are only available under a limited set of conditions usually only when performing a 911 service call and then only for use by the Assisted GPS service located in conjunction with the E 911 service facility. Newer generations of chipsets may be configured to make use of differential corrections available from the Satellite Based Augmentation Service or SBAS. Various embodiments of the present technology describe ways to operate with these newer chipsets and will be discussed subsequently. The limitation of unavailability of pseudoranges from embedded GNSS GPS chipset technology in conventional cellular telephones or other handheld devices may be overcome as described herein. The protocol defined by the Open Mobile Alliance for use in mobile phones for determining location based on an internal GPS chipset and other resources is called the Secure User Plane Location abbreviated SUPL. New software elements including algorithms for use in this kind of protocol are described herein.

According to various embodiments the system depicted in provides components for implementing improved GPS GNSS accuracy for a cellular device. It is noted that while the following discussion is directed to cellular devices specifically embodiments are not limited to this use alone and can be implemented upon other mobile devices including but not limited to laptop computers tablet computers personal digital assistants PDAs handheld electronic devices mobile navigation systems and the like. For the purpose of brevity like components described above with reference to will not be described again in the present discussion. In accordance with various embodiments a cellular device is provided with a plurality of Application Programming Interface API function applications stored in cellular device memory and each are configured to be operated by processor upon activation by the user or automatically.

In the cellular device is configured with a pseudorange fetch component a pseudorange correction fetch component a pseudorange corrector an augmented position determiner a carrier phase fetch component and a carrier phase smoothing component . In pseudorange fetch is configured to request a current set of pseudoranges from the GNSS GPS receiver generated by and resident in the cellular device . According to various embodiments there are two methods for performing this request. In one embodiment a 911 call function is activated which causes the GNSS GPS receiver to respond and put the current pseudoranges on the cellular device bus . These local pseudoranges are stored in memory and made available to components of the cellular device such as the pseudorange corrector . Another embodiment can employ a fetch routine sanctioned and adopted by the SUPL Committee on cellular operations. Chipsets in the future will have built in capability to respond to requests and output pseudoranges with time tags as is available in more expensive chipsets used in non cellular device products.

According to one embodiment pseudorange fetch notifies the pseudorange corrector that the pseudorange information is being stored. According to one embodiment the cellular device receive pseudorange corrections directly from an improvement service such as a correction feed correction service correction service FM radio distribution or satellite radio distributor or a combination thereof that is located outside of the cellular device for example without those pseudorange corrections being transmitted to the cellular device through the GPS GNSS chipset or receiver .

In one embodiment in response to a positioning activity with cellular device communication system notifies the pseudorange correction fetch to test to see if pseudorange corrections are in memory already and if not notifies the pseudorange correction fetch that pseudorange corrections need to be fetched from an improvement source such as a correction feed correction service correction service FM radio distribution or satellite radio distributor or a combination thereof.

According to one embodiment depicts a cellular telephone that includes memory coupled with a bus a Global Positioning System Global Navigation Satellite System GPS GNSS embedded receiver coupled with the bus a communications system coupled with the bus and a processor coupled with the bus wherein the processor is configured to obtain pseudoranges indirectly from the GPS GNSS embedded receiver and to receive differential corrections via the communications system and provide a position fix of the cellular telephone based on processing of pseudoranges and the differential corrections.

According to one embodiment the pseudoranges from the GPS GNSS embedded receiver are obtained by a command from the processor to the GPS GNSS embedded receiver via a thin Secure User Platform Location SUPL . According to one embodiment the pseudoranges are obtained via a command emulating an initiated 911 call and activating an E 911 transmission in order to activate and receive pseudorange delivery from a GNSS GPS chipset that is part of the cellular telephone and deactivating the E 911 transmission before the pseudoranges are transmitted to an emergency service. According to one embodiment the pseudoranges are obtained by a command supported by a Secure User Platform Location SUPL . According to one embodiment the communications system is a part of the cellular phone and therefore is a cellular telephone system.

The blocks that represent features in can be arranged differently than as illustrated and can implement additional or fewer features than what are described herein. Further the features represented by the blocks in can be combined in various ways. The cellular device or can be implemented using hardware hardware and software hardware and firmware or a combination thereof.

At the cellular device accesses the GPS GNSS chipset that is embedded within the cellular device . The GPS GNSS chipset calculates pseudorange information for use by the GPS GNSS chipset . For example the GPS GNSS receiver can perform GPS measurements to derive raw measurement data for a position of the cellular device . The raw measurement data provides an instant location of the cellular device . The GPS GNSS chipset calculates pseudorange information that is for use by the GPS GNSS chipset . According to one embodiment the raw measurement data is the pseudorange information that will be extracted. Examples of pseudorange information are uncorrected pseudorange information differential GNSS corrections high precision GNSS satellite orbital data GNSS satellite broadcast ephermis data and ionosopheric projections.

A chipset accessor according to one embodiment is configured for accessing the GPS GNSS chipset . According to one embodiment the chipset accessor is a part of an SUPL client . For example the SUPL client can interface between the GPS GNSS chipset and the location manager which resides in the operating system . The pseudorange information can be obtained from the processor of the GPS GNSS receiver using a command via a high precision Secure User Platform Location SUPL . According to one embodiment the GPS GNSS chipset is accessed using an operation that is a session started with a message that is an improved accuracy Secure User Platform Location SUPL start message or a high precision SUPL INIT message. According to one embodiment the message is a custom command that is specific to the GPS GNSS chipset and the improved accuracy SUPL client can have access to the raw measurements of the GPS GNSS chipset .

At the cellular device extracts the pseudorange information from the GPS GNSS chipset for use elsewhere in the cellular device outside of the GPS GNSS chipset . For example a pseudorange information extractor may be associated with a worker thread of the SUPL client . The worker thread can watch over the raw measurements delivered by the GPS GNSS chipset into the GPS GNSS chipset s memory buffers and cache the raw measurements.

According to one embodiment the raw measurement data is the pseudorange information that is extracted. According to one embodiment the raw measurement data is pseudorange information that is calculated by the GPS GNSS chipset and is only for use by the GPS GNSS chipset .

The extracted pseudorange information without further improvements can be used to provide an instant location. The extracted pseudorange information can be improved by applying pseudorange corrections carrier wave information or additional information as described herein. The instant location or the improved location can be communicated to a location manager as discussed herein that displays the instant location or the improved location with respect to a map.

At if requested mode specifies determining the location without applying improvements or if the cellular device is not capable of applying improvements then at the extracted pseudorange information is provided to the augmented position determiner at which performs a least squared function on the extracted pseudorange information. Otherwise processing proceeds to .

At if the requested mode specifies determining an improved location by applying improvements then at the characteristics of the GPS GNSS chipset are determined. For example a determination can be made as to which of the pseudorange corrections or carrier phase information provided by the chipset would provide the higher accuracy based on the GPS GNSS chipset s characteristics. Otherwise processing proceeds to .

If at it is determined that the GPS GNSS chipset s characteristics indicate that the pseudorange corrections would provide the higher accuracy then at a quality of position QOP position metric is used to determine whether to improve pseudorange information by applying pseudorange corrections. Otherwise processing proceeds to . For example a QOP position metric can be determined from data obtained from the GPS GNSS receiver . If the QOP position metric is less than a pre determined QOP then at pseudorange corrections are requested from an improvement source and the extracted pseudorange information is provided to the pseudorange corrector which will apply pseudorange corrections to the extracted pseudorange information. Processing proceeds to operation where a least squared function is performed on the corrected pseudoranges.

If at it is determined that the GPS GNSS chipset s characteristics indicate that the carrier wave information would provide the higher accuracy then at the extracted pseudorange information is provided to the carrier phase smoothing which applies the carrier wave information to the extracted pseudorange information resulting in smoothed pseudoranges. Processing proceeds to where the augmented position determiner performs a least squared function on the smoothed pseudoranges.

At the extracted pseudorange information from the corrected pseudoranges from the pseudorange corrector from or the smoothed pseudoranges from the carrier phase smoothing are provided at to the augmented position determiner which performs a least squared function on the received input.

According to one embodiment the additional information applicator can apply additional information to extracted pseudorange information which are uncorrected and unimproved corrected pseudoranges or smoothed pseudoranges for example prior to being communicated to the augmented position determiner .

The pseudorange information bridger can provide the output of the augmented position determiner to the location manager that resides in the operating system . The location displayer of the location manager can display the location with respect to a map.

In various embodiments pseudorange fetch is the starting point for entering the augmented accuracy mode of operation and implements the operations of method described below in the context of flowchart . In one embodiment there is a program listing available for the augmented accuracy mode of operation as any ordinary application is made available to a user of a cell phone such as an Android iPhone or similar cell phone configured to utilize applications. Upon selecting this function and pressing a Start button the following operations are performed.

In operation of a message is sent to the GPS GNSS receiver to initiate an E911 activity. As described above pseudorange measurement data is typically not available internally to a cellular device but can be made available when performing a 911 service call for use by the Assisted GPS service located in conjunction with the E911 facility. In operation initiating an E911 activity enables placement of pseudorange measurement data onto the signal bus of cellular device for access by other components.

In operation of pseudorange data is received from the GPS GNSS receiver and stored on a continuous basis until terminated. In one embodiment the pseudorange data is continuously received and stored e.g. in memory while the E911 activity is active. This makes the pseudorange data available for an extended period to components of cellular device . In one embodiment pseudorange fetch can retrieve the pseudorange data from memory .

In operation of a pseudorange corrector is notified that pseudoranges are being stored. In one embodiment pseudorange corrector receives a message from pseudorange fetch that pseudorange data is available for processing.

In operation of pseudorange correction fetch is notified to determine if pseudorange corrections are in memory already or need to be fetched from an improvement service. As will be discussed in greater detail pseudorange correction fetch is configured to download pseudorange corrections from any of a variety of improvement source via any of several communications paths available to cellular device . In one embodiment pseudorange fetch generates a message to pseudorange correction fetch to determine whether pseudorange corrections are already stored in memory or need to be downloaded from an improvement source.

In operation of an E911 activity cancellation is initiated. In one embodiment once pseudorange correction fetch is notified to search for pseudorange corrections the E911 activity is cancelled. According to one embodiment this prevents actually completing a 911 call from cellular device and inadvertently initiating an emergency response.

As described above various embodiments are directed to improving the accuracy of position determination in cellular devices. In various embodiments a number of data elements from onboard GPS GNSS receiver as well as other sensors are used to provide data to a positioning engine. In accordance with various embodiments the Secure User Platform Location protocol SUPL is used as the positioning protocol as well as the way to provide assistance and corrections to GPS GNSS receiver and for transferring the measurements being made to a cellular device to the positioning engine. SUPL is a protocol defined by the Open Mobile Alliance for use in cellular devices for determining the position of the cellular devices. In global navigation satellites are used to provide navigation signals as described above. Location based applications refers to applications resident upon a cellular device which is configured as a SUPL enabled terminal in accordance with various embodiments. While shown as resident upon cellular device location based applications may reside elsewhere upon a network and may interact with cellular device remotely.

In one embodiment a SUPL Location Platform SLP provides the back end infrastructure needed to implement SUPL. Typically SLP is hosted by a network operator e.g. the operator of cellular network and handles the SUPL transaction with cellular device to provide services such as E911 notifications and verification. Corrections feeds such as Real Time Kinematic RTK feeds and or Differential GPS DGPS feeds comprises a service e.g. correction services which can provide data for improving the precision in determining the position of cellular device . This data may include but is not limited to high precision orbital data rather than or in addition to broadcast ephemeris data DGPS corrections improved ionospheric projections rather than a standard Kloubuchar model accurate clock data and other Real Time Kinematics data that helps in precisely determining the position of cellular device .

In improved accuracy SUPL client comprises a positioning engine profiler connections manager and configuration manager . It is noted that improved accuracy SUPL client is shown as resident in memory of cellular device in accordance with various embodiments. Positioning engine determines the position of cellular device using raw GPS GNSS measurements and cues from various sensors in cellular device . In accordance with one embodiment positioning engine is implemented as augmented position determiner . In accordance with various embodiments positioning engine can use data provided by for example corrections feeds . In accordance with various embodiments positioning engine can utilize algorithms to cancel multi path signals ground reflections and other echo capacitance of the bearer and boost faint or broken signals. Positioning engine can also query map engine to obtain data about the surroundings. For example positioning engine can perform a first coarse positioning of cellular device and then query map engine about the area around the current position of cellular device . A rough description of the area around a cellular device e.g. how far away are walls surrounding the cellular device can help determine the degree of signal processing that needs to be performed upon signals received from global navigation satellites . In accordance with one embodiment positioning engine can apply this algorithm iteratively until a desired quality of precision QOP is achieved. Profiler is a component used by SUPL client to understand the characteristics of the GPS GNSS silicon and the other sensors present in the system. This process includes calibration and detection of feature set and capabilities of these components. This process could be initiated at the time of installation into cellular device when first started or after a software firmware or hardware upgrade to cellular device or when the stored data is lost. This process could be triggered selectively or as a whole. It could also be triggered when new capabilities are expected by the SUPL Client . In addition to characterization of the device this process also helps in identification of the command and data set of the GPS GNSS receiver and usage of the appropriate APIs. In one embodiment the connections manager is used by SUPL Client to manage the connections with the components available on the network for example the secure location platform corrections feeds and other data feeds. In one embodiment configuration manager stores the current operational parameters of SUPL Client as mandated by the specification and other means. The configuration manager also determines the degree of operation of the Positioning Engine .

Also shown in are devices and data sources which provide data to position engine in determining the position of cellular device . These include but are not limited to cellular transceiver Wi Fi transceiver GPS GNSS receiver accelerometer compass gyroscope a Bluetooth Low Energy BLE component and map engine . It is noted that accelerometer and gyroscope may be integrated as IMU .

BLE component refers to a low energy wireless radio technology which is intended for use in mobile devices such as cellular telephones. BLE component is an example a short range low energy wireless personal area networking component which typically operates and exchanges data wirelessly over short distances using short wavelength radio transmissions in the ISM band from 2400 2480 MHz from fixed and or mobile devices.

At a Secure User Platform Location SUPL operation is initiated using a custom command that is specific to the GPS GNSS chipset. The pseudorange information is accessed by a chipset accessor and extracted by a pseudorange information extractor using a custom command that is specific to the GPS GNSS chipset according to one embodiment.

At a determination is made as to whether the GPS GNSS receiver needs assistance in determining a position of the cellular device or to achieve a desired level of Quality of Position QOP .

At if the GPS GNSS receiver needs assistance then additional data is received from satellites currently in view of the GPS GNSS receive . Examples of addition data are acquisition assistance data high precision ephemeris data and DGPS DGNSS corrections .

At the DGPS corrections are provided to the GPS GNSS receiver . For example the DGPS corrections data e.g. as well as the other data received in operation are provided to the GPS GNSS receiver .

At GPS measurements are performed at the GPS GNSS receiver to derive raw measurement data of a position of the cellular device or . For example GPS GNSS receiver performs GPS measurements to derive raw measurement data of the position of cellular device or .

At carrier phase and pseudorange signals are measured from one or more satellites that are in view of the GPS GNSS embedded receiver . For example an operation in which carrier phase and pseudorange measurements of signals from each satellite in view of GPS GNSS receiver is performed.

At additional information is obtained from one or more of a compass gyroscope accelerometer and a source accessed via a wireless communication protocol operating in the range of frequencies between 2402 2480 MHz such as such as Bluetooth Low Energy BLE . For example data from compass gyroscope accelerometer and or BLE is obtained. In one embodiment improved accuracy SUPL client obtains accumulated data from various sensors that may be resident upon cellular device or such as gyroscope accelerometer e.g. IMU compass etc. for the past n seconds. In accordance with one embodiment if indoor positioning is enabled improved accuracy SUPL client obtains readings from BLE radios that may be present in the area.

At the data from the compass gyroscope accelerometer and the BLE are sent. For example the data from compass gyroscope accelerometer and or BLE is sent by improved accuracy SUPL client .

At a more precise location of the cellular device or is generated based on the corrected data. For example positioning engine processes the data received in operation . In one embodiment positioning engine uses the positioning cues provided from these inputs e.g. compass gyroscope accelerometer and or BLE to generate a precise position of cellular device or . In one embodiment operations are repeated until a desired Quality of Positioning QOP level is achieved in determining the position of cellular device or .

If an E 911 call is used to initiate the operation then at the pseudorange information is prevented from being delivered to the originally intended recipient such as an emergency service according to one embodiment by terminating the SUPL operation before the pseudorange information is delivered to the originally intended recipient. For example the SUPL session using improved accuracy SUPL client is terminated at .

If a GPS GNSS chip custom command is used to initiate the operation then at the pseudorange information is accessed by the chipset accessor and extracted by the pseudorange information extractor as discussed herein.

In one embodiment one the position of cellular device or is determined within the desired QOP parameters the position of cellular device or is delivered to the application which generated a request of the position of cellular device or .

According to one embodiment an E 911 call is used to obtain pseudorange information from a GPS GNSS chipset. The following is a description of flowchart in the event that E 911 call is used.

At a Secure User Platform Location SUPL operation is initiated that is intended for delivering the pseudorange information from the GPS GNSS receiver of the cellular device to a recipient originally intended by the operation. According to one embodiment operation further comprises operation . Examples of pseudorange information are uncorrected pseudorange information pseudorange corrections from correction feeds high precision orbital data broadcast ephemeris data Differential GPS DGPS corrections and improved ionosphere projections. According to one embodiment the operation is a session that is started with a message selected from a group consisting of a Secure User Platform Location SUPL start message and an SUPL INIT message. The pseudorange information is accessed and redirected to the different recipient that was not originally intended by the operation.

At the pseudorange information is prevented from being delivered to the originally intended recipient by terminating the SUPL operation before the pseudorange information is delivered to the originally intended recipient. For example the SUPL session using improved accuracy SUPL client is ended.

Although specific operations are disclosed in flowcharts and such operations are exemplary. That is embodiments of the present invention are well suited to performing various other operations or variations of the operations recited in flowcharts and . It is appreciated that the operations in flowcharts and may be performed in an order different than presented and that not all of the operations in flowcharts and may be performed.

Any one or more of the embodiments described herein can be implemented using non transitory computer readable storage medium and computer executable instructions which reside for example in computer readable storage medium of a computer system or like device. The non transitory computer readable storage medium can be any kind of memory that instructions can be stored on. Examples of the non transitory computer readable storage medium include but are not limited to a disk a compact disk CD a digital versatile device DVD read only memory ROM flash and so on. As described above certain processes and operations of various embodiments of the present invention are realized in one embodiment as a series of instructions e.g. software program that reside within non transitory computer readable storage memory of a computer system and are executed by the computer processor of the computer system. When executed the instructions cause the computer system to implement the functionality of various embodiments of the present invention. According to one embodiment the non transitory computer readable storage medium is tangible.

The following description of a non transitory computer readable storage medium according to various embodiments refers to . According to one embodiment a non transitory computer readable storage medium is provided that comprises instructions which when executed causes a processor of a cellular device which is not a part of an embedded Global Positioning System Global Navigation Satellite System GPS GNSS receiver of the cellular device to perform a method for obtaining pseudorange information using a cellular device . The method comprises accessing performed by the cellular device a GPS GNSS chipset embedded within the cellular device wherein the GPS GNSS calculates pseudorange information for use by the GPS GNSS chipset and extracting performed by the cellular device the pseudorange information from the GPS GNSS chipset for use elsewhere in the cellular device outside of the GPS GNSS chipset . A location of the cellular device can be determined based on the pseudorange information. A pseudorange correction fetch is notified to test to see if pseudorange corrections are in memory already. The pseudorange corrections are received directly from an improvement source that is located outside of the cellular device . The pseudorange information is processed in a portion of the cellular device that is outside of the GPS GNSS chipset to determine a position fix of the cellular device . The pseudorange information is processed using one or more Application Programming Interface API function applications that reside in memory of the cellular device and are executed by the processor of the cellular device . Additional information is obtained from one or more of a compass gyroscope accelerometer and a source accessed via a WiFi or via a short range wireless communication protocol operating in the range of frequencies between 2402 2480 MHZ. Corrected data is created based on the obtained additional information and a location of the cellular device is generated based on the corrected data. The pseudorange information extractor extracts at least four pseudorange measurements as a part of extracting the pseudorange information from the GPS GNSS chipset . A quality of position QOP position metric is determined from data obtained from a GPS GNSS receiver associated with the GPS GNSS chipset . If the QOP position metric is less than a pre determined QOP then pseudorange corrections are requested from an improvement source.

Example embodiments of the subject matter are thus described. Although the subject matter has been described in a language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

Various embodiments have been described in various combinations and illustrations. However any two or more embodiments or features may be combined. Further any embodiment or feature may be used separately from any other embodiment or feature. Phrases such as an embodiment one embodiment among others used herein are not necessarily referring to the same embodiment. Features structures or characteristics of any embodiment may be combined in any suitable manner with one or more other features structures or characteristics.

