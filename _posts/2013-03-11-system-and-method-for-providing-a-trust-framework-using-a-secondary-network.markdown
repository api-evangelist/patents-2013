---

title: System and method for providing a trust framework using a secondary network
abstract: A system for providing security services to a mobile device where the mobile device is in communication with a public network through a first network path that is subject to interference by a third party. The system includes a security server and a private network. The security server is operative to communicate with the mobile device through the private network. The security server is also operative to communicate with the public network through a second network path that is less susceptible to the interference by the third party than is the first network path. The security server communicates with the public network through the second network path to provide security services to the mobile device that are delivered over the private network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09473309&OS=09473309&RS=09473309
owner: Certicom Corp.
number: 09473309
owner_city: Mississauga, Ontario
owner_country: CA
publication_date: 20130311
---
The present disclosure relates generally to the field of cryptographic signatures and more particularly to a system and method for providing a certificate based trust framework using a secondary network.

Public key cryptographic systems are designed to provide secure communication over insecure networks including between parties that may not have had any previous communication. Such systems typically rely upon a public key infrastructure PKI comprising software hardware communication protocols and related policies and procedures one such example being the X.509 standard published by the International Telecommunication Union.

There are two common trust models used as part of a PKI. A web of trust model is based on a decentralized network and is used as part of systems such as Pretty Good Privacy PGP . In contrast a hierarchical model relies upon certain entities in the trust framework being commonly trusted by multiple parties such mutual trust in such entities underpinning the system. Regardless of which trust model is used when two parties interact for the first time by means of a PKI each party uses the trust framework of a PKI in order to decide whether or not to trust the other party as being who they claim to be. This is commonly used for example in the context of web browsers accessing web servers over the Internet.

A common aspect of a typical PKI comprises digital certificates that use cryptographic protocols to reliably link certain information with an identity. For example the X.509 standard defines public key certificates as comprising among other things a serial number the identity of the issuer of the certificate the subject i.e. the entity identified by the certificate the digital signature of the issuer and a public key of the subject.

In a hierarchical PKI certificates are divided into three types end certificates intermediate certificates and root certificates. Root certificates and intermediate certificates are used to identify certificate authorities CAs that is an entity in a PKI that issues digital certificates to third parties. Root certificates are self signed that is the identity of the issuer of the certificate is the same as the subject of the certificate in this case a root CA. These certificates must either be axiomatically trusted or not trusted by a given third party. Intermediate certificates are certificates issued to an intermediate CA by a root CA. End certificates are issued by certificate authorities to end users such as a website host. In such a hierarchical PKI whether a given end certificate is trusted by a particular individual is based on whether that particular individual trusts the issuer of the certificate or any other issuer further up the certificate chain . In this way individuals upon receiving a certificate purporting to be of an arbitrary third party i.e. an end certificate may traverse the certificate chain starting from the end certificate through one or more intermediate certificates and terminating at a root certificate. If at any point an intermediate certificate or the root certificate is trusted then the end certificate is similarly trusted. Such analysis of a certificate and its corresponding certificate chain together with further security protocols as described herein is commonly known to those skilled in the relevant art as validating a certificate.

Prior art PKIs may include mechanisms to provide additional security. Certificate revocation lists CRLs are lists published by certificate authorities to give public notice of certain certificates that they issued that are no longer valid i.e. should no longer be trusted by third parties . Typically in the context of the Internet a digital certificate will include an Uniform Resource Locator URL to download a corresponding CRL the assumption being that a given third party upon receiving the certificate and deciding whether to trust it by traversing the certificate chain as part of the validation process will also access the CRL through the provided URL to determine whether or not the certificate has been revoked.

Another illustrative protocol the Online Certificate Status Protocol OCSP operates by means of a query response mechanism to similarly provide the status of a particular certificate. A corresponding OCSP responder may be specified by a digital certificate the assumption again being that a given third party upon receiving the certificate and deciding whether to trust it by traversing the certificate chain as part of the validation process will also query the OCSP responder through the provided URL to determine whether or not the certificate has been revoked. Still another well known protocol for validating and reviewing the status of a given certificate is delegated path validation DPV .

A common limitation to these existing mechanisms in the context of the Internet is that they depend upon the correct operation of underlying Internet services particularly that of the Domain Name System DNS and network traffic routing more generally. For example if a third party such as a nation state has the capability to return an incorrect Internet Protocol IP address to a given individual in response to a DNS query e.g. in the course of attempting to access a specified URL to download a particular CRL such third party could prevent the individual from learning that a given certificate has been revoked. A similar consequence would arise if a third party has the capability of interfering with the routing of network traffic between the given individual and for example an OCSP responder.

In a first broad aspect of the present disclosure there is provided a system for providing security services to a mobile device the mobile device being in communication with a public network through a first network path that is subject to interference by a third party the system comprising a security server and a private network the security server being operative to communicate with the mobile device through the private network and to communicate with the public network through a second network path that is less susceptible to the interference by the third party than is the first network path wherein the security server communicates with the public network through the second network path to provide security services to the mobile device that are delivered over the private network.

In an alternative embodiment the third party is capable of interfering with the routing of network traffic transiting the first network path.

In an alternative embodiment the third party is capable of interfering with the operation of the DNS system of the Internet for devices communicating through the first network path.

In an alternative embodiment the security server communicates with the public network through the second network path to resolve domain names.

In an alternative embodiment the security services are associated with a certificate based trust framework.

In an alternative embodiment the security server communicates with the public network through the second network path to validate certificates.

In an alternative embodiment the security services comprise adding trusted certificates to a certificate store of the mobile device.

In an alternative embodiment the security services comprise removing trusted certificates from a certificate store of the mobile device.

In an alternative embodiment the system further comprises a module in the mobile device for interfacing between the mobile device and the security server.

In an alternative embodiment the security services comprise managing applications installed on the mobile device.

In an alternative embodiment the mobile device primarily communicates with the public network through the first network path.

In a second broad aspect of the present disclosure there is provided a method of initiating secure communication between a device and a first server that is located in a public network the method comprising receiving a certificate at the device from the first server through a first network path connecting to the public network the first network path being subject to interference by a third party from the device querying through a private network a second server to validate the certificate wherein the second server validates the certificate by communicating through a second network path with a third server that is located in the public network the second network path being less susceptible to the interference by the third party than is the first network path receiving a response at the device from the second server through the private network the response being indicative of a validity of the certificate and based on the response determining whether to engage the device in secure communications with the first server through the first network path.

In an alternative embodiment the third party is capable of interfering with the routing of network traffic transiting the first network path.

In an alternative embodiment the third party is capable of interfering with the operation of the DNS system of the Internet for devices communicating through the first network path.

In an alternative embodiment the method further comprises performing local validation at the device of the certificate using a local certificate store and wherein determining whether to engage the device in secure communications with the first server is further based on the local validation.

In an alternative embodiment the method further comprises from the device querying through the private network the second server for permission to trust an issuer certificate corresponding to the certificate.

In an alternative embodiment the second server uses at least one of the OCSP CRL and DPV protocols to validate the certificate.

In an alternative embodiment the device primarily communicates with the public network through the first network path.

Additional aspects and advantages of the present disclosure will be apparent in view of the description which follows. It should be understood however that the detailed description while indicating specific embodiments are given by way of illustration only since various changes and modifications within the spirit and scope of the disclosure will become apparent to those skilled in the art from this detailed description.

In the following description details are set forth to provide an understanding of illustrative embodiments of the disclosure. In some instances certain steps signals protocols software hardware networking infrastructure circuits structures and techniques have not been described or shown in detail in order not to obscure the disclosure. Those of skill in the art will understand that the following description of illustrative embodiments of the disclosure does not limit the implementation of embodiments of the disclosure to any particular computer programming language. Embodiments of the disclosure may be implemented in any computer programming language provided that the operating system O S provides the facilities that may support the present disclosure. For instance an embodiment of the present disclosure may be implemented in part in the JAVA computer programming language or other computer programming languages such as C or C . Those skilled in the art will also appreciate that any limitations presented by such an embodiment would be a result of a particular type of operating system or computer programming language and would not be a limitation of the present disclosure. Alternative embodiments of the present disclosure may also be implemented in hardware or in a combination of hardware and software.

The wireless device may be a two way communication device having voice and or data communication capabilities including the capability to communicate with other devices. Depending on the functionality provided by the wireless device it may be referred to as a data messaging device a two way pager a cellular telephone with data messaging capabilities a wireless Internet appliance a data communication device with or without telephony capabilities a Wi Fi device a WLAN device a dual mode i.e. Wi Fi and cellular device a portable audio or video device a tablet computer or a smart phone. More generally aspects of the present disclosure may be applied to other electronic devices such as laptop and desktop computers and handheld computers whether or not wired or wireless.

The wireless device has a communication subsystem which includes a RF receiver a RF transmitter and associated components. As will be apparent to those skilled in the relevant art the particular design of the communication subsystem depends on the wireless network in which the wireless device is intended to operate.

The wireless device may be capable of cellular network access and hence the wireless device may have a subscriber identity module or SIM card for inserting into a SIM interface IF in order to operate on the cellular network e.g. a global system for mobile communication GSM network .

The wireless device may be a battery powered device and so it may also include a battery IF for receiving one or more rechargeable batteries . The battery or batteries provides electrical power to most if not all electrical circuitry in the wireless device and the battery IF provides for a mechanical and electrical connection for it.

The wireless device includes a microprocessor which controls overall operation of the wireless device . The microprocessor interacts with device subsystems such as a flash memory or other persistent store a random access memory RAM auxiliary input output I O subsystems a serial port e.g. a universal serial bus USB port the trackpad a speaker a microphone a short range communications subsystem and other device subsystems . The microprocessor in addition to performing operating system functions preferably enables execution of software applications on the wireless device .

The wireless device may also have a touchscreen comprising a touch sensor positioned overtop a display screen or integrated therewith. The touchscreen may further comprise a transparent cover positioned over the touch sensor and display screen or integrated therewith. The wireless device may comprise further circuitry controllers and or processors associated with touchscreen to determine in the event a user touches the touchscreen where on the touchscreen such touch was made and to report said position to for example an operating system executing on microprocessor . Wireless device may be configured to accept such input as part of a graphical user input GUI . More generally touchscreen may be adapted to receive input from a finger or for example a stylus whether or not there is physical contact with touchscreen .

The wireless device may include computer executable programmed instructions for directing the wireless device to operate in a pre determined manner. The programmed instructions may be embodied in one or more software or hardware modules which may be resident in the memory of the wireless device . Alternatively the programmed instructions may be embodied on a computer readable medium such as a CD disk or floppy disk which may be used for transporting the programmed instructions to the memory of the wireless device . Alternatively the programmed instructions may be embedded in a computer readable signal or signal bearing medium that may be uploaded to a network by a vendor or supplier of the programmed instructions and this signal or signal bearing medium may be downloaded through an interface to the memory of the wireless device from the network by end users or potential buyers.

O S software module used by the microprocessor may be stored in a persistent store such as the flash memory which may alternatively be a read only memory ROM or similar storage element not shown . Those skilled in the relevant art will appreciate that the operating system specific device applications or parts thereof may be temporarily loaded into a volatile store such as RAM in the course of normal operation of wireless device .

To provide a user friendly environment to control the operation of the wireless device O S software module resident on the wireless device if executed by the wireless device provides a basic set of operations for supporting various applications typically operable through a GUI. For example the O S software module may enable basic input output system features to obtain input from the auxiliary I O subsystems trackpad and the like for facilitating output to the user through touchscreen speaker and the like and for providing network and Internet connectivity via communication subsystem .

A user may interact with the wireless device and software modules using a GUI presented to a user through execution of O S software module by wireless device . In general a GUI is used to convey and receive information to and from users and can include a variety of GUI objects or controls including text labels windows icons toolbars drop down menus dialog boxes fields buttons and the like all well known to those skilled in the relevant art. GUIs are supported by common operating systems and more particularly may enable a user to input data choose commands execute application programs manage computer files and perform other functions through use of an input or pointing device such as a trackpad or touching the touchscreen . A GUI may include a cursor and various selectable objects and icons. For example a user may interact with a GUI presented on the touchscreen by touching or more generally contacting or nearly contacting an object e.g. an icon on the touchscreen with his or her finger or stylus causing a click to register.

Memory may further comprise a global certificate store for storing digital certificates used as part of a PKI. In particular as described herein root intermediate and end certificates that are trusted by the user of wireless device may be stored in global certificate store for use in for example validating a new end certificate received by wireless device . Global certificate store may be accessible only by O S software module or in other illustrative embodiments it may also be accessible by other software modules executing on wireless device . For greater certainty a skilled person in the relevant art will appreciate that storing a certificate in global certificate store is a logical relationship between components in memory and may not correspond to a particular physical relationship within wireless device .

Memory may further comprise application software modules . Application software module may be a web browser such as the BlackBerry Browser web browser. Application software module may be another network enabled application such as the BBM instant messaging program. A user of wireless device may cause application software modules to execute through a GUI presented on wireless device such as by tapping on a representative icon.

Application software modules may each also maintain certificate stores respectively for a similar purpose to global certificate store . These application specific certificate stores may be primarily used by their respective application software modules and access by external software modules e.g. O S software module or in respect of certificate store application software module may or may not be permitted. A skilled person in the relevant art will appreciate that while two application software modules are illustratively depicted wireless device may be configured to have more or less of such modules.

In the illustrative embodiment one or more applications may maintain their own certificate stores e.g. certificate stores in addition to a global certificate store e.g. global certificate store . In other illustrative embodiments no application specific certificate stores may be used. In still other illustrative embodiments multiple global certificate stores may be used. A skilled person in the art will appreciate that various certificates stores variously configured may be used to provide desired functionality in wireless device .

A skilled person in the art will further appreciate that certificate stores may be updated. Users of wireless device may update for example global certificate store through update functionality provided through O S software module e.g. certificate import functionality . Alternatively the developer of O S software module may provide manual or automatic software updates that include among other things updates to the global certificate store . The same options may be available to update application specific certificate stores . For example where application software module is a web browser updates to certificate store may be provided through software updates to application software module although certificate update functionality may also be separately provided through an interface provided by application software module .

In the illustrative embodiment memory further comprises trust and security management TSM module . TSM module may be incorporated into O S software module or may be a separate module installed therein. TSM module may be capable of interfacing with global certificate store and application software modules including certificates stores therein. A skilled person in the relevant art will appreciate that such interface is a logical connection representative of communication links between software modules during execution and may not correspond to a physical connection within wireless device . For example in an illustrative embodiment of the present embodiment TSM module may comprise software capable of accessing an application programming interface API provided by application software module . TSM module may further operate to provide wireless device with the capability of interfacing with a certificate based trust framework using a secondary network as illustratively described herein.

System may further comprise wireless network connected to the Internet via connection . Again a skilled person in the relevant art will readily appreciate that wireless network may comprise for example a general packet radio service GPRS network that provides among other things wireless device with connectivity to Internet through one or more GPRS support nodes and related network infrastructure. Internet may further comprise other components including the exemplary web server certificate authority CA server OCSP server and DNS server . More generally a skilled person in the relevant art will appreciate that while the term the Internet generally refers to a particular globally accessible network of interconnected computers embodiments of the present disclosure may similarly be applied to other computer networks both public and private and that the term the Internet should be understood to refer to such networks generally.

In illustrative embodiments system may further comprise a private network connected to wireless network by means of connection and further connected to the Internet by means of connection . In this illustrative embodiment private network comprises a secondary network in view of primary connection between wireless network and the Internet . Private network may be connected to other wireless networks not shown that themselves may be connected to other wireless devices not shown . Private network may also comprise TSM server operating as described herein. A skilled person in the relevant art will further appreciate that TSM server may also be configured to reside elsewhere such as in wireless network .

In one embodiment private network may be the BlackBerry Relay private network that is owned and operated by Research in Motion and used to support and enable a variety of telecommunication services for wireless devices. In this illustrative embodiment the BlackBerry Relay private network is operatively connected to wireless networks operated by wireless telecom providers worldwide each such wireless network itself having wireless devices operatively connected thereto.

More generally a skilled person in the relevant art will appreciate that private network may be substantially similar in construction to public networks such as the Internet but may be configured to limit public or third party access thereto. For example the BlackBerry Relay private network may be configured and strictly controlled to permit only access and use by certain parties such as specific telecom providers and indirectly their customers. In other illustrative embodiments private network may permit public access.

A skilled person in the relevant art will also appreciate that computer servers such as TSM server web server CA server OCSP server and DNS server while depicted in as single discrete logical components may each comprise and share one or more physical computing devices and related infrastructure. For example DNS server may comprise a plurality of individual computer servers as well as related components such as load balancers and backups for providing redundancy. In other illustrative embodiments CA server and OCSP server may reside on the same physical machine. Similarly a skilled person in the relevant art will appreciate that the depicted components of Internet comprise only a small fraction of the whole of the Internet and that various components are omitted for the purpose of not obscuring the present disclosure.

A skilled person in the relevant art will further appreciate that a network such as wireless network and private network may comprise one or more computing devices along with related infrastructure such as switches routers and gateways such components potentially in internal and external communication through both wired and wireless links. For example private network may comprise a servers located in physical proximity to components of wireless network e.g. collocated in the same data center and connected therewith over high bandwidth local area connections b separately located servers for providing services over private network as well as c leased lines that connect such servers in a private and secure manner.

At step a self issued root certificate issued by CA server is provided to wireless device and installed thereon. This process may be mediated by for example software or hardware manufacturers that may include this root certificate as a trusted root certificate in software to be installed on wireless device . In other illustrative embodiments a user of wireless device may manually install root certificates on wireless device through suitable certificate installation functionality. Typically installation of a root certificate comprises adding a root certificate to a certificate store of wireless device e.g. global certificate store .

At step a certificate is issued by CA server and installed on a particular web server . This is typically not an automated process but rather such step is mediated by the individuals in control of web server .

At step root certificates and applications are updated on wireless device . Such updating may comprise manual importing or removal of trusted root certificates or manual or automatic software updates. For example web browser applications e.g. application software module installed on wireless device may be configured to periodically query a third party server to determine if an update to application software module is available and if so may download and install such update which may include updates to the trusted root certificates . In other illustrative embodiments a user may manually add or remove root certificates from the certificate store e.g. certificate store of a specific application e.g. application software module .

At step wireless device communicates with web server and initiates a handshaking protocol therewith. For example application software module may be a web browser executing on wireless device and attempting to access an online banking website using TLS.

At step web server returns to wireless device its digital certificate in accordance with the handshaking protocol. For example web server may return a X.509 compliant digital certificate to wireless device and more specifically application software module executing on wireless device . Once wireless device receives the certificate it may commence validating the certificate to determine whether it should trust such certificate and by implication web server in accordance with prior art methods. For example wireless device may a review the certificate of the issuer of the server certificate and b determine whether it trusts the issuer of the certificate based on the trusted CAs in a certificate store of wireless device e.g. certificate store .

Assuming wireless device trusts the certificate based on its certificate chain and further is configured to perform OCSP validation at step wireless device may query a DNS server such as DNS server to determine the IP address of the OCSP server for the certificate received from web server based on a URL provided within the certificate. A skilled person in the relevant art will appreciate that this process may be known as resolving a domain name.

At step DNS server may return a result comprising among other things the IP address corresponding to a particular domain name i.e. of the appropriate OCSP server such as OCSP Server . This response may comprise a standard DNS response.

At step wireless device may using the received IP address of OCSP Server query such server in accordance with the OCSP in order to determine whether the previously received certificate remains valid e.g. has not been revoked .

At step OCSP Server may return a result to wireless device indicating the status of the certificate e.g. good revoked or unknown .

Assuming the certificate has not been revoked wireless device has thus validated the certificate and at step wireless device and web server complete the handshaking protocol and are able to commence secure communications at step .

In alternative prior art methods instead of seeking to contact and query an OCSP server at steps to wireless device may illustratively seek to access a CRL published by the issuer of the digital certificate received from web server . For example based on an URL included in the received certificate wireless device may retrieve a CRL from CA server and if the received certificate is not on the retrieved CRL proceed to trust web server as described herein.

The methods illustratively described in relation to also help highlight various vectors of attack that may be employed by a malicious third party such as a nation state in order to undermine the aforedescribed trust framework and corresponding security protocols. For example at step an application software module may be designed to contact a specific server at a specific URL or IP address in order to obtain software updates that include for example updates to trusted root certificates. In the event a third party can disrupt the ability for wireless device to contact such server and in turn learn of and obtain appropriate software updates wireless device may be at greater risk due to its inability to have its trusted root certificates automatically updated. In other illustrative embodiments such disruption may prevent wireless device from being notified that it is executing out of date software that may for example have unpatched security vulnerabilities. A skilled person in the relevant art will appreciate that there are numerous means by which a third party may disrupt the ability of wireless device to contact such server such as affecting the network routing between wireless device and such server.

Similarly at step resolving the domain name of OCSP server may be disrupted by for example a malicious third party intercepting such query by wireless device and returning an incorrect IP address and at step querying OCSP server for the status of a certificate may be disrupted by affecting the ability of wireless device to contact OCSP server . In illustrative prior art embodiments while failures in contacting DNS server or OCSP server may be anticipated such implementations may for example resolve such failures by asking the user of wireless device to decide whether to ignore such failure and nevertheless trust web server notwithstanding the inability to fully validate the received certificate. In practice not all users may be proficient in assessing the cause of such failure and determining whether or not to ignore the failure in the certificate validation process.

At step wireless device illustratively comprising among other things TSM module and TSM server communicate so as to install one or more root certificates corresponding to one or more CAs on wireless device as trusted CAs. In some embodiments TSM server and wireless device may be configured to autonomously determine what root certificates to install on wireless device without requiring confirmation from a user of wireless device .

Illustratively the operation of wireless device may be controlled in the above respect and in respect of the methods described herein by TSM module . For example O S software module and TSM module may be mutually designed and configured so that TSM module is capable of communicating with TSM server and effecting certain instructions and other directions issued by TSM server .

At step a certificate is issued by CA server and installed on a particular web server . This is typically not an automated process but rather such step is mediated by the individuals in control of web server .

At step wireless device and TSM server periodically communicate so as to update the root certificates and applications on wireless device . As described herein in the prior art such updating may comprise manual importing or removal of trusted root certificates or manual or automatic software updates. In the illustrative embodiment TSM server TSM module and wireless device more generally may be mutually designed and configured to permit TSM server to remotely manage the root certificates and applications installed on wireless device . For example TSM server may install root certificates determined by the operator of TSM server e.g. the manufacturer of wireless device to be appropriate for wireless device to trust effect the update of out of date applications installed on wireless device remove root certificates determined by a business network administrator that is responsible for wireless device to be no longer trustworthy or otherwise compromised or prevent the continued use of out of date applications installed on wireless device .

At step wireless device attempts to access web server and initiates a handshaking protocol therewith. For example application software module may be a web browser attempting to access an online banking website using TLS.

At step web server returns to wireless device its digital certificate in accordance with the handshaking protocol. For example web server may return a X.509 compliant digital certificate to wireless device and more specifically application software module executing on wireless device . Once wireless device receives the certificate it may commence validating the certificate to determine whether it should trust such certificate and by implication web server in accordance with prior art methods. For example wireless device may a review the certificate of the issuer of the server certificate and b determine whether it trusts the issuer of the certificate based on the trusted CAs in a certificate store of wireless device e.g. certificate store .

Assuming wireless device trusts the certificate based on its certificate chain at step wireless device contacts TSM server to request further validation of the certificate. For example application software module illustratively in conjunction with TSM module may be configured to cause wireless device to transmit a copy of the certificate to TSM server along with related information in accordance with a predetermined protocol.

At steps TSM server may in an illustrative embodiment employ prior art methods including for example prior art OCSP validation to further validate the certificate e.g. assess the current status of the certificate . For example as previously described in relation to wireless device in respect of at step TSM server may similarly query a DNS server to resolve the IP address of OCSP server based on a URL provided in the certificate at step TSM server may similarly receive such IP address from DNS server at step TSM server may query OCSP server at the received IP address with regard to the status of the certificate in question e.g. has not been revoked and at step TSM server may receive a response from OCSP server comprising an indication of the status of the certificate e.g. good revoked or unknown .

Upon receiving the status of the server certificate from OCSP server TSM server may at step further transmit the status of the certificate to wireless device in response to the query identified as step . Again such communication between wireless device and TSM server may be by means of a predetermined protocol not necessarily related to the known OCSP protocol.

Assuming TSM server advises wireless device that the certificate is valid wireless device may be configured to trust the determination of TSM server and therefore consider the certificate validated illustratively in conjunction with previous certificate analysis done by itself . Accordingly at step web server and wireless device complete the handshaking protocol and are able to commence secure communications at step .

In the illustrative embodiment described above TSM server is configured to use only a single method i.e. OCSP validation to assess the validity of a particular digital certificate. In other embodiments TSM server may be configured to use alternative methods including for example other prior art methods such as CRLs and DPV. Security server may further be configured to use other proprietary methods such as for example private certificate revocation lists maintained by the operator of TSM server . A skilled person in the relevant art will appreciate that TSM server may employ one or more methods to validate a particular digital certificate in conjunction or separately.

In further illustrative embodiments TSM server may be configured to use caching to store locally the status of a certificate certificates for a given period of time. For example TSM server may temporarily cache the status of certificates corresponding to popular websites e.g. search engines and popular web applications and respond to a query from wireless device e.g. step on the basis of the cached status instead of repeating steps in response to each query.

In further illustrative embodiments wireless device may also be configured to validate the status of the application seeking to access web server . For example where application software module is a web browser attempting to access an online banking website using TLS TSM module may as part of the aforedescribed method also confirm that application software module is not a version of such web browser that has been revoked due to security concerns. Such confirmation may be conducted by comparing the version of such web browser with a list of revoked versions maintained on wireless device and updated periodically by TSM server alternatively such confirmation may be conducted by wireless device querying TSM server in a manner analogous to wireless device querying TSM server to validate the received server certificate. Wireless device and TSM module may thus for example be configured to permit communication between application software module and web server only if application software module is up to date.

In further illustrative embodiments TSM server as a component of private network may be configured so that its primary connection e.g. connection to the Internet and servers therein such as DNS server and OCSP server is different as described herein from the primary connection e.g. connection between wireless network and the Internet and servers therein such as DNS server and OCSP server such connection between wireless network and the Internet also the primary network path for wireless device to connect to the Internet .

In an illustrative embodiment wireless network may be physically located in a given jurisdiction and connected to the Internet through connection subject to the control of the given jurisdiction. For example connection may comprise traversing a firewall under governmental control and designed to filter or otherwise affect certain traffic. Illustratively such firewall may be designed to selectively limit access to OCSP Server or to modify responses from DNS Server . More generally connection may be subject to third party interference or control or may transit a particular jurisdiction.

In the illustrative embodiment connection differs from connection in respect of at least some of the aforementioned characteristics such as being subject to the control of the jurisdiction or jurisdictions that connection is subject to control by although connection may for example be subject to the control of one or more other jurisdictions . For example connection may not comprise traversing the aforementioned firewall under governmental control. In other circumstances connection may be configured to avoid selective filtering or censorship that connection is subject to such as access to OCSP Server or receiving correct response from DNS Server . More generally connection may not be subject to the same third party interference or control that connection is subject to or may be configured to not transit a particular jurisdiction that connection may transit.

Another illustrative embodiment is wherein private network is the BlackBerry Relay private network that is operatively connected to numerous wireless telecom providers worldwide each wireless telecom provider operating a wireless network e.g. wireless network that is connected to the BlackBerry Relay private network via a connection e.g. connection . In such embodiment each provider s wireless network may be operatively connected to the Internet through different network paths routers servers and firewalls e.g. connection and subject to different third party control e.g. by governmental bodies for example by virtue of whether or not such Internet connections transit a given jurisdiction. Similarly the BlackBerry Relay private network i.e. private network may also be operatively connected to the Internet through one or more connections collectively connection such connections operatively connected to the Internet through different at least in part network paths routers servers and firewalls and subject to different third party control e.g. by governmental bodies for example by virtue of whether or not such connections transit a given jurisdiction.

Illustratively TSM server in the embodiments described herein relies upon connection when contacting servers e.g. OCSP server located in the Internet in contrast wireless device in the prior art embodiments described herein relies upon connection when contacting servers e.g. DNS server located in the Internet . Accordingly in embodiments of the present disclosure involving TSM server while a malicious third party may have the capability to undermine prior art trust frameworks and corresponding security protocols by virtue of its control over connection the use of connection that may have different characteristics in respect of the control that the third party may exert on such connection may affect the extent to which the third party can undermine the trust frameworks and corresponding security protocols disclosed herein or more specifically affect the ability for TSM server to validate a received digital certificate.

At step wireless device attempts to access web server and initiates a handshaking protocol therewith. For example application software module may be a smartphone application attempting to contact an application server using TLS.

At step web server returns to wireless device its digital certificate in accordance with the handshaking protocol. For example web server may return a X.509 compliant digital certificate to wireless device . Once wireless device receives the certificate it may commence validating the certificate to determine whether it should trust such certificate and by implication web server in accordance with prior art methods. For example wireless device may a review the certificate of the issuer of the server certificate and b determine whether it trusts the issuer of the certificate based on the trusted CAs in a certificate store of wireless device e.g. certificate store .

Assuming wireless device determines that it is not currently configured to trust the received server certificate on the basis of its certificate chain e.g. wireless device is not configured to trust the issuer of the received certificate at step wireless device contacts TSM server to request to trust the CA that issued the received server certificate i.e. request that the certificate of such CA be added to an appropriate certificate store of wireless device .

TSM server may be configured to receive such request and to assess whether to authorize such request i.e. to cause wireless device in conjunction with TSM module to add the certificate of such CA to an appropriate certificate store of wireless device . TSM server may for example maintain a list of certificate authorities that may be trusted such list customized for individual wireless devices or for groups of wireless devices e.g. all wireless devices associated with a given enterprise user .

Assuming TSM server determines that it should authorize such request TSM server transmits its approval to wireless device and wireless device proceeds to add the relevant CA as a trusted CA i.e. adds the certificate of such CA into an appropriate certificate store on wireless device . In an illustrative embodiment TSM module on wireless device is in operative communication with TSM server and upon receiving a positive reply from TSM server TSM module may cause the certificate of the relevant CA to be added to application specific certificate store for use by application software module .

At step wireless device further contacts TSM server to request further validation of the certificate. For example application software module illustratively in conjunction with TSM module may be configured to cause wireless device to transmit a copy of the certificate received from web server to TSM server along with related information in accordance with a predetermined protocol. A skilled person in the art will appreciate that this step of further validating the server certificate may also be simultaneously requested together with the aforementioned step of wireless device requesting to trust the CA that issued the received server certificate.

At steps TSM server may in an illustrative embodiment employ prior art methods including for example prior art OCSP validation to further validate the certificate e.g. assess the current status of the certificate . For example as previously described in respect of at step TSM server may similarly query a DNS server to resolve the IP address of OCSP server based on a URL provided in the certificate at step TSM server may similarly receive such IP address from DNS server at step TSM server may query OCSP server at the received IP address with regard to the status of the certificate in question e.g. has not been revoked and at step TSM server may receive a response from OCSP server comprising an indication of the status of the certificate e.g. good revoked or unknown .

Upon receiving the status of the server certificate from OCSP server TSM server may at step further transmit the status of the certificate to wireless device in response to the query identified as step . Again such communication between wireless device and TSM server may be by means of a predetermined protocol not necessarily related to the known OCSP protocol.

Assuming TSM server advises wireless device that the certificate is valid wireless device may be configured to trust the determination of TSM server and therefore consider the certificate validated illustratively in conjunction with previous certificate analysis done by itself . Accordingly at step web server and wireless device complete the handshaking protocol and are able to commence secure communications at step .

Additionally the above alternative embodiments described with reference to similarly apply to this further embodiment described with reference to . For example TSM server may be similarly configured to use CRLs DPV or OCSP to validate the certificate chain caching may be employed by TSM server applications may also be validated by wireless device and TSM server may be configured so that its connection i.e. connection to the Internet is different from the primary connection between wireless network and the Internet i.e. connection as described herein.

Still further in respect of the methods depicted by a skilled person in the art will appreciate that such methods may also address circumstances wherein the received service certificate is not validated or where the overall security protocol does not successfully complete. Such circumstances may include for example situations wherein a wireless device explicitly does not trust the issuer of the received certificate b a certificate is marked as revoked by its inclusion on a CRL c a OCSP responder indicates that a certificate has been revoked d the application executing on wireless device is obsolete and e certain Internet servers e.g. DNS server cannot be accessed e.g. by wireless device or TSM server . A skilled person will appreciate that wireless device TSM module and TSM server may be configured to take various actions in such circumstances and embodiments. For example in some embodiments the user of wireless device may be advised of the failure and provided the opportunity to continue regardless. In other embodiments in circumstances of failure communication e.g. between wireless device and web server may be prevented altogether.

At step wireless device receives instructions to use a TSM framework comprising methods and systems illustratively described herein. For example if wireless device is an unmanaged consumer device wireless device may be configured to present a user with a notification window when first accessing the device. This notification window may include an opt in option and if selected by the user constitutes wireless device receiving instructions to enable and use the TSM framework. In other illustrative embodiments wireless device may be configured to present in a configuration or setup menu an equivalent option to a user. If wireless device is a managed enterprise device wireless device may instead receive instructions to enable and use the TSM framework from an enterprise network administrator instead of the direct user of wireless device .

At step on the basis of the instructions received at step TSM module is enabled on wireless device and registers wireless device with TSM server so as to avail itself of the TSM framework. In illustrative embodiments such registration may entail among other things wireless device transmitting to TSM server a device code identifying wireless device the current status of the certificate stores of wireless device e.g. what certificates are currently trusted and a list of applications and their versions installed on wireless device . Although not depicted in TSM server upon receiving a registration request from wireless device may store details of such registration request and be further configured to thereafter provide security services to wireless device pursuant to the TSM framework as described herein. For example such security services may comprise certificate store and application updates as well as certificate validation services all as illustratively described herein.

Following initial registration at step wireless device and more specifically TSM module executing therein may be configured to listen for instructions from TSM server and if instructions are received from TSM server to parse and interpret such instructions so as to continue with the operation depicted by .

Illustratively at step wireless device receives instructions from TSM server to update a particular certificate store on wireless device e.g. one of certificate stores . These instructions may comprise removing a previously trusted root certificate such as if such certificate has been comprised or should otherwise not be trusted. These instructions may also comprise adding a new root certificate.

At step such instructions are carried out by TSM module executing on wireless device namely the specified certificate store is updated by removing or adding a certificate. As described herein such actions may be facilitated by the interface between TSM module and other logical components such as global certificate store and application software modules including certificates stores therein.

Alternatively at step wireless device receives instructions comprising an updated application status of an application installed on wireless device such as application software module . Wireless device may at corresponding step update a list of application statuses stored on wireless device for the purpose of future validation such as if application software module seeks to contact web server as described above. In such embodiments the received application status update may comprise a list of one or more versions of software that are revoked due to security concerns.

In other illustrative embodiments wireless device may at corresponding step cause certain applications to be updated. Such update may be initiated by TSM module and may occur silently i.e. transparent to the user or upon seeking and or receiving confirmation from the user of wireless device .

Finally steps are repeated so long wireless device and more specifically TSM module executing thereon remains configured to listen for instructions from TSM server pursuant to the TSM framework described herein. Although not depicted in illustratively the user of wireless device may manually disable use of the TSM framework or the network administrator of wireless device may do so.

In the illustrative embodiment described above the communication protocol between TSM module and TSM server in furtherance of the operation depicted by is a push protocol wherein TSM server periodically sends instructions to wireless device and more specifically TSM module . In other illustrative embodiments TSM module and TSM server may communicate through a pull protocol wherein TSM module periodically queries TSM server for instructions. More generally including in respect of the methods described in relation to messages from TSM server and in some embodiments wireless device may be digitally signed to ensure the integrity of the requests responses messages and instructions made or sent between wireless device and TSM server . This may include for example causing wireless device to by default trust the certificate of TSM server .

At step wireless device receives a digital certificate. For example application software module executing on wireless device may receive a certificate from web server and may need to determine whether or not to trust such certificate for the purpose of entering secure communications therewith.

At step such application e.g. application software module determines whether such certificate is in its corresponding or global certificate store as a trusted certificate. If so it is at step determined to be a trusted certificate and the certificate is validated. In other illustrative embodiments not depicted even if such certificate is in a corresponding certificate store the operation may proceed to step as described herein to further validate the certificate.

If such application e.g. application software module determines that such certificate is not in its corresponding or global certificate store as a trusted certificate at step the certificate chain of the certificate is validated e.g. by using a local certificate store such as one of certificate stores to determine whether wireless device should trust such certificate and by implication web server . For example wireless device may to determine whether it trusts the issuer of the certificate a look up the certificate of the issuer of the received certificate and b validate the certificate of the issuer against the trusted CAs in a local certificate store.

If the issuer of the end certificate is not a trusted CA wireless device may proceed at step to query TSM server for approval to add the certificate of the issuer to an appropriate certificate store i.e. to trust the issuer . If wireless device receives at step the approval of TSM server wireless device proceeds accordingly i.e. adds the certificate to one of its certificate stores .

Regardless of whether step and step are performed wireless device may further perform step by contacting TSM server to request further validation of the received end certificate. For example TSM module executing on wireless device in combination with application software module may be configured to transmit a copy of the end certificate to TSM server along with related information in accordance with a predetermined protocol. If wireless device receives at step the approval of TSM server i.e. an indication that the end certificate has not been revoked wireless device at step determines the end certificate to be a trusted certificate and the certificate is validated.

In contrast if TSM server does not approve the requests of step or step wireless device at step determines that the end certificate is not a trusted certificate the validation process has failed and wireless device may proceed to for example request further user confirmation or prevent further communication with the remote server e.g. web server .

All publications and patent applications mentioned in this specification are herein incorporated by reference to the same extent as if each individual publication or patent application was specifically and individually incorporated by reference.

While the foregoing disclosure has been described in some detail for purposes of clarity and understanding it will be appreciated by one skilled in the art from a reading of the disclosure that various changes in form and detail can be made without departing from the true scope of the disclosure.

