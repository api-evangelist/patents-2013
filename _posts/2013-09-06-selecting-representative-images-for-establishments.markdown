---

title: Selecting representative images for establishments
abstract: Establishments are identified in geo-tagged images. According to one aspect, text regions are located in a geo-tagged image and text strings in the text regions are recognized using Optical Character Recognition (OCR) techniques. Text phrases are extracted from information associated with establishments known to be near the geographic location specified in the geo-tag of the image. The text strings recognized in the image are compared with the phrases for the establishments for approximate matches, and an establishment is selected as the establishment in the image based on the approximate matches. According to another aspect, text strings recognized in a collection of geo-tagged images are compared with phrases for establishments in the geographic area identified by the geo-tags to generate scores for image-establishment pairs. Establishments in each of the large collection of images as well as representative images showing each establishment are identified using the scores.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08811656&OS=08811656&RS=08811656
owner: Google Inc.
number: 08811656
owner_city: Mountain View
owner_country: US
publication_date: 20130906
---
This application is a continuation of application Ser. No. 13 246 809 filed Sep. 27 2011 which is a continuation of application Ser. No. 13 105 842 filed May 11 2011 now U.S. Pat. No. 8 385 593 which claims the benefit of U.S. Provisional Patent Application No. 61 356 342 entitled Identifying Establishments in Images filed on Jun. 18 2010 each of which are hereby incorporated by reference in its entirety. This application is related to U.S. Utility patent application Ser. No. 13 105 853 filed May 11 2011 now U.S. Pat. No. 8 379 912 and is also related to U.S. Utility patent application Ser. No. 13 246 812 filed Sep. 27 2011 now U.S. Pat. No. 8 265 400 each of which are hereby incorporated by reference in its entirety.

Due to the popularity of digital cameras and positioning devices there are lots of geo tagged images in the world today. Many of the geo tagged images show or reference one or more establishments e.g. a storefront a corporate sign . Currently there is no effective technique for a computer to identify which establishments are shown or referenced in a geo tagged image.

Embodiments of the present disclosure include a method and corresponding computer system and non transitory computer readable storage medium for identifying a representative geo tagged image for an establishment. One aspect of the present disclosure is a computer implemented method comprising recognizing text strings in a plurality of geo tagged images and identifying an establishment near geographic locations specified by geo tags of the plurality of geo tagged images. The method further comprises extracting a phrase from information associated with the establishment and comparing text strings recognized in the plurality of geo tagged images with the extracted phrase to derive one or more matches between the text strings and the phrase. The method additionally comprises scoring a plurality of image establishment pairs responsive to the comparisons. An image establishment pair pairs a geo tagged image having a recognized text string that matches the phrase with the establishment. The method also comprises selecting a representative geo tagged image for the establishment from among the plurality of image establishment pairs responsive to the scores.

Embodiments of the present disclosure also include a method and corresponding computer system and non transitory computer readable storage medium for identifying a representative geo tagged image for an establishment comprising recognizing text strings in a plurality of geo tagged images and identifying an establishment near geographic locations specified by geo tags of the plurality of geo tagged images. The method further comprises extracting an n gram from information associated with the establishment and comparing text strings recognized in the plurality of geo tagged images with the extracted n gram to derive one or more matches between the text strings and the n gram. The method additionally comprises scoring a plurality of image establishment pairs responsive to the comparisons. An image establishment pair pairs a geo tagged image having a recognized text string that matches the n gram with the establishment. The scoring assigns a score to the image establishment pair based on one or more of the following factors an information field from which the n gram is extracted a confidence measuring an accuracy of the recognized text string a prevalence of the n gram in a language associated with the n gram a prevalence of the n gram in a geographic area specified by a geo tag of the geo tagged image and a distance between a geographic location specified by the geo tag of the geo tagged image and a location of the establishment. The method also comprises selecting a representative geo tagged image for the establishment from among the plurality of image establishment pairs responsive to the scores.

The features and advantages described in the specification are not all inclusive and in particular many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings specification and claims. Moreover it should be noted that the language used in the specification has been principally selected for readability and instructional purposes and may not have been selected to delineate or circumscribe the disclosed subject matter.

The Figures FIGS. and the following description describe certain embodiments by way of illustration only. One skilled in the art will readily recognize from the following description that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles described herein. Reference will now be made in detail to several embodiments examples of which are illustrated in the accompanying figures. It is noted that wherever practicable similar or like reference numbers may be used in the figures and may indicate similar or like functionality.

As shown the computing environment includes a client and an image server connected through a network . Only one of each entity is illustrated in order to simplify and clarify the present description. There can be other entities in the computing environment as well.

The client is an electronic device that hosts and provides geo tagged images to the image server through the network . In one embodiment the client is a mobile telephone executing for example a Google Android operating system OS . In another embodiment the client is a conventional computer system executing for example a Microsoft Windows compatible OS Apple OS X and or a Linux distribution. In yet another embodiment the client is another device having computer functionality such as a personal digital assistant PDA video game system etc. In still another embodiment the client is a complex system configured to capture large quantities of pictures of subjects such as urban surroundings such as an automobile equipped with cameras taking pictures of surroundings also called a camera car .

The geo tagged images may be generated by the client . For example the images may be captured using an on device camera e.g. the camera equipped on a smartphone or a digital camera connected to the client . Additionally or alternatively the images may be geo tagged by the client . For example an on device positioning device e.g. a Global Positioning System GPS receiver determines the device location for the client when an image is captured by the client . Additionally or alternatively the client can determine the device location using other geo spatial techniques such as cell tower triangulation. The client augments the image with geographical information about the device location e.g. latitude and longitude coordinates as metadata. The client may provide the geo tagged image to the image server for reasons such as performing a visual search for information about establishments appearing or referenced in the geo tagged image.

The image server is a hardware device and or software program configured to retrieve the geo tagged images from the client . When provided with individual geo tagged images also called the individual image scenario the image server identifies establishments shown or referenced in the geo tagged images and optionally provides the client with information about the identified establishments. When provided with a large collection of images showing establishments in a general area also called the image corpus scenario such as pictures taken by a camera car while touring around an area e.g. a town a city a village in addition to or instead of identifying any establishments shown or referenced in each image the image server selects best images for showing each of the establishments if available . As shown the image server includes an image establishment detection module .

The image establishment detection module is configured to detect known establishments appearing or referenced in geo tagged images. The image establishment detection module detects potential text regions in an image and recognizes text strings in the detected regions using optical character recognition OCR technology. Separately the image establishment detection module detects known establishments near the image location of the image and extracts phrases from information related to the nearby establishments e.g. name category phone number and other information that are expected to be found on places such as store fronts and signs . The image establishment detection module compares the text strings recognized in the image with the phrases extracted from nearby establishments for matches and selects an establishment for the image as the establishment shown or referenced in that image based on the matching results. In addition in the image corpus scenario for each local establishment the image establishment detection module identifies all images that show or reference the establishment and selects one such image as the representative image for that establishment.

The network is a system of interconnected computer networks that use standard communications technologies and or protocols to facilitate data transmission among the computer networks. Thus the network can include links using technologies such as Ethernet 802.11 worldwide interoperability for microwave access WiMAX G digital subscriber line DSL asynchronous transfer mode ATM InfiniBand PCI Express Advanced Switching etc. Similarly the networking protocols used on the network can include multiprotocol label switching MPLS the transmission control protocol Internet protocol TCP IP the User Datagram Protocol UDP the hypertext transport protocol HTTP the simple mail transfer protocol SMTP the file transfer protocol FTP etc. The data exchanged over the network can be represented using technologies and or formats including the hypertext markup language HTML the extensible markup language XML JavaScript VBScript Flash PDF PostScript etc. In addition all or some of links can be encrypted using conventional encryption technologies such as secure sockets layer SSL transport layer security TLS virtual private networks VPNs Internet Protocol security IPsec etc. In another embodiment the entities can use custom and or dedicated data communications technologies instead of or in addition to the ones described above.

The entities shown in are implemented using one or more computers. is a high level block diagram illustrating an example computer . The computer includes at least one processor coupled to a chipset . The chipset includes a memory controller hub and an input output I O controller hub . A memory and a graphics adapter are coupled to the memory controller hub and a display is coupled to the graphics adapter . A storage device keyboard pointing device and network adapter are coupled to the I O controller hub . Other embodiments of the computer have different architectures.

The storage device is a non transitory computer readable storage medium such as a hard drive compact disk read only memory CD ROM DVD or a solid state memory device. The memory holds instructions and data used by the processor . The pointing device is a mouse track ball or other type of pointing device and is used in combination with the keyboard to input data into the computer . The graphics adapter displays images and other information on the display . The network adapter couples the computer to one or more computer networks.

The computer is adapted to execute computer program modules for providing functionality described herein. As used herein the term module refers to computer program logic used to provide the specified functionality. Thus a module can be implemented in hardware firmware and or software. In one embodiment program modules are stored on the storage device loaded into the memory and executed by the processor .

The types of computers used by the entities of can vary depending upon the embodiment and the processing power required by the entity. For example the image server might comprise multiple blade servers working together to provide the functionality described herein. As another example the client might comprise a smartphone with limited processing power. The computers can lack some of the components described above such as keyboards graphics adapters and displays . In addition the image server can run in a single computer or multiple computers communicating with each other through a network such as a server farm.

The image processing module processes received geo tagged images to detect text strings presented in the images. The text strings recognized in an image are used by the image establishment detection module to identify establishments in that image. Thus if more text strings are recognized in the image then there will be more matching results for the establishment identification to be based on. In addition because of factors such as lighting angle shading and font text strings in images often are hard to locate and or recognize. Accordingly in one embodiment in order to achieve more informed establishment identification and accommodate factors affecting text recognition the image processing module adopts an over inclusive approach to recognize more text strings in the image even at the cost of a potential higher error rate. As shown the image processing module includes a text region detection module and an OCR module .

The text region detection module analyzes an image to detect the presence of a text string and identify a portion of the image e.g. a rectangular shaped bounding box that includes the text string. The identified portion of the image is called a text region. In one embodiment in order to be overly inclusive and detect more text strings in an image the text region detection module applies a variety of distinctive text character detection algorithms known in the related fields to identify text regions in the image. For example the text region detection module may consider visual features such as Histogram of oriented gradients edge contrast features transition run length densities geometrical properties and connected component based features in detecting text regions in the image.

The OCR module converts or translates text strings inside the detected text regions into editable text hereinafter called OCR ed text strings . The OCR module processes the text regions using computer algorithms and generates corresponding OCR ed text strings. In addition the OCR module calculates a confidence score that measures a quality of the OCR ed text strings. In one embodiment to be overly inclusive the OCR module applies a variety of OCR engines or algorithms and generates multiple alternative OCR ed text strings along with their corresponding confidence scores for a same text region. Examples of the OCR engines include Abbyy FineReader Nuance OmniPage and Open Source Tesseract. The resulting OCR ed text strings are collectively called a pool of texts. The pool of texts may include OCR ed text strings recognized in an individual image e.g. for the individual image scenario or multiple images e.g. for the image corpus scenario .

The establishment processing module generates a collection of phrases also called a pool of phrases for each known establishment near the geographical location indicated by the geo tag associated with an image also called the image location . By limiting the source of the pool of phrases to establishments that are near the image location the establishment processing module effectively excludes irrelevant establishments and thereby enhances computational efficiency and result quality. As shown the establishment processing module includes a nearby establishment identification module and a phrase generation module .

The nearby establishment identification module extracts the latitude and longitude coordinates of the image location from the geo tag and identifies establishments located near the image location. For example the nearby establishment identification module searches for establishments located within a radius around the image location in an establishment database and identifies the nearby establishments in the search results. The radius may be defined by the accuracy of the image geo tag or predetermined e.g. 1 000 feet . In one embodiment the establishment database is a relational database and includes some or all of the following information for known establishments in a geographic region 1 geographic locations e.g. latitude and longitude coordinates 2 names 3 category ies e.g. RESTAURANT PIZZA BANK INSURANCE and 4 phone number s . The establishment database may include a mechanism for rapidly retrieving establishments based on geographical information e.g. within a radius of a geographical location defined by latitude and longitude coordinates . The nearby establishment identification module retrieves information related to the nearby establishments e.g. name category phone number from the establishment database.

The phrase generation module extracts or generates a set of n grams from the retrieved establishment information associated with the nearby establishments. An n gram also called a phrase is a subsequence of n items e.g. characters words from a given sequence. The n grams extracted by the phrase generation module can be at the character level e.g. n consecutive characters in the text or at the word level e.g. n consecutive words in the text and can overlap in the original text. The phrase generation module adds all n grams generated for all nearby establishments identified by the nearby establishment identification module into the pool of phrases. In one example the phrase generation module extracts word level n grams for the value of n ranges from 1 to 5. As a result the pool of phrases includes any stretch of full words within the retrieved establishment information up to five words long. Factors affecting the selection of the value of n include the computing resources e.g. memory and CPU central processing unit time required to generate and match against the n grams and the likelihood of a long phrase being split into several sections e.g. multiple lines .

The image establishment detection engine compares the OCR ed text strings in the pool of texts with the n grams in the pool of phrases for matches and identifies establishments in the images based on the matching results. As described earlier in one embodiment the image processing module adopts an over inclusive approach to recognizing text strings in an image. To accommodate the potential high OCR error rate the image establishment detection engine performs the comparison in a manner that allows errors in the OCR ed text strings. As shown the image establishment detection engine includes an approximate matching module and a scoring and establishment selection module .

The approximate matching module compares all n grams in the pool of phrases with all OCR ed text strings in the pool of texts to find any appearance of an n gram as a substring of any of the OCR ed text strings. In one embodiment in order to further enhance efficiency instead of comparing all n grams in the pool of phrases with all OCR ed text strings in the pool of texts the approximate matching module utilizes hashing and or filtering methods to limit the number of comparisons. In one embodiment to account for errors in the OCR ed text strings the approximate matching module allows some edit distances e.g. Levenshtein distance between the text strings and the n grams being compared and still considers them matching. For example a 75 or higher matching rate e.g. no more than 1 mismatching character in every four characters may be considered a match. A match between an OCR ed text string and an n gram is considered a piece of evidence towards the establishment associated with the n gram appearing or referenced in the image associated with the matching OCR ed text string.

The scoring and establishment selection module calculates scores for establishments by combining evidence indicating that the establishment is found in an image. In one embodiment each match detected by the approximate matching module is assigned a weight based on factors such as the text field or type from which the matching n gram is extracted e.g. establishment name category phone number the length of the matching n gram i.e. the value of n the OCR confidence score associated with the matching OCR ed text string recognized in the image the edit distance of the match and the prevalence of the words terms in the matching n gram within the language e.g. RESTAURANT is weaker evidence than PARADISE or the local area e.g. NEW YORK is weaker evidence in the New York City area than Chrysler Building . For example a match for an n gram extracted from the establishment name may be giving a higher weight than a match for an n gram extracted from the category of the establishment. The score is generated based on factors such as the number of matches the weight of each match and the distance between the image location and the location of the establishment. The algorithm to calculate the weight for each match and or the score for each establishment can be generated using heuristics and or machine learning techniques. Some example heuristics include adjusting the confidence scores for the OCR ed text to be values between 0 and 1 with 1 indicating a high confidence in the accuracy of the OCR ed text and 0 indicating a low confidence and assigning higher weights for matches occurring in the establishment names than matches in the establishment categories.

For the individual image scenario the scoring and establishment selection module generates one score for each establishment near a target image and selects an establishment for the image based on the scores e.g. the establishment associated with the highest score as the establishment in the image. For the image corpus scenario the scoring and establishment selection module creates image establishment pairs by pairing each image in the image corpus with each establishment near the image location of that image and generates one score for each image establishment pair. The scoring and establishment selection module selects an image for each establishment based on the scores e.g. the image of the image establishment pair with the highest score for that establishment as the representative image for that establishment.

The data store stores data used by the image establishment detection module . Examples of such data include the establishment database the pool of texts the pool of phrases and the image corpus. The data store may be a relational database or any other type of database or an in memory data structure.

Initially the image server receives a geo tagged image from the client . The image server detects potential text regions in the image by applying a variety of distinct text detection algorithms and recognizes text strings in the detected regions using OCR technology. Separately the image server detects nearby establishments by searching in the establishment database for known establishments located within a radius around the image location specified in the associated geo tag. The image server extracts phrases from the nearby establishments by generating overlapping n grams from the information associated with the nearby establishments. When repeated queries e.g. visual search queries are expected from the same or a nearby location the search results and or extracted phrases may be cached between the queries to further enhance efficiency.

The image server compares the text strings recognized in the image with the n grams generated for the nearby establishments for approximate matches and generates a score for each nearby establishment based on the matching n grams associated with that establishment and factors such as the distance between the image location and the location of the establishment. The image server selects an establishment e.g. the establishment with the highest score as the known establishment appearing or referenced in the geo tagged image.

Initially the image server receives a large collection of geo tagged images from the client . Examples of the collection of images are pictures taken by a camera car the client while touring around a city. The image server detects potential text regions in the geo tagged images by applying one or more of a variety of distinct text detection algorithms and recognizes text strings in the detected regions using OCR technology. Separately the image server detects establishments approximate to the image location of each geo tagged image in the collection by searching in the establishment database for known establishments located within a radius around the image location specified in the associated geo tag and extracts phrases from the nearby establishments by generating overlapping n grams from the information associated with the nearby establishments. Because the geo tagged images in the collection are likely taken in nearby locations the image server may temporarily store all or a portion of the phrases extracted for one image and reuse such phrases for other images to further enhance efficiency.

The image server compares the text strings recognized in images with the n grams generated for establishments near the image locations for approximate matches and creates image establishment pairs for any matches by pairing the images with the establishments. The image server generates a score for the image establishment pair based on the matching n grams associated with that establishment and factors such as the distance between the image location and the location of the establishment. For each establishment the image server selects an image as the representative image for that establishment based on the scores e.g. the image of the image establishment pair with the highest score for that establishment .

In one embodiment the image server or a group of servers collaborating together can process a large collection of images in a batch process e.g. for the image corpus scenario . For example the image server can recognize OCR ed texts in the images generate the n grams for all establishments in the general area of the collection of images and then analyze the images in a sequence based on their image locations such that the applicable pool of phrases are relatively stable between the adjacent images since the image locations are relatively close .

In one embodiment the image server can identify establishments in video streams or video frames and or identify multiple establishments in the image video.

In one embodiment in order to identify known establishments in an image in addition to matching OCR ed text recognized in the image the image server also matches graphical components in the image e.g. logos to a database of known graphical marks associated with establishments using image matching techniques matches the image against a database of real estate listings matches house numbers identified in the image to addresses of the establishments and or takes into consideration manual establishment identification.

The image server and or the client can use the outcomes generated by the embodiments described herein to 1 improve or correct known geo positioning of the identified establishment based on the image location and or optionally angular orientation information determined based on the camera orientation bounding box in the image depth information from camera and or separate sensor 2 annotate images e.g. the best image for an establishment establishments with the associated establishments images 3 present a visual signal on or beside the image to indicate the identified establishment 4 provide landmark based navigation using the prominent visible establishments as landmarks 5 improve geo coding by adding the identified establishment into the geo tag 6 improve accuracy of a geo coding system e.g. a system which converts addresses to latitude and longitude coordinates by recording that the establishment with known address is visible at the image location 7 provide visual search that identifies establishments in images 8 provide users with a link from a plain image to structured data about the establishment in the image and or 9 find images which give a visual presentation of a known establishment.

Some portions of above description describe the embodiments in terms of algorithmic processes or operations. These algorithmic descriptions and representations are commonly used by those skilled in the data processing arts to convey the substance of their work effectively to others skilled in the art. These operations while described functionally computationally or logically are understood to be implemented by computer programs comprising instructions for execution by a processor or equivalent electrical circuits microcode or the like. Furthermore it has also proven convenient at times to refer to these arrangements of functional operations as modules without loss of generality. The described operations and their associated modules may be embodied in software firmware hardware or any combinations thereof.

As used herein any reference to one embodiment or an embodiment means that a particular element feature structure or characteristic described in connection with the embodiment is included in at least one embodiment. The appearances of the phrase in one embodiment in various places in the specification are not necessarily all referring to the same embodiment.

Some embodiments may be described using the expression coupled and connected along with their derivatives. It should be understood that these terms are not intended as synonyms for each other. For example some embodiments may be described using the term connected to indicate that two or more elements are in direct physical or electrical contact with each other. In another example some embodiments may be described using the term coupled to indicate that two or more elements are in direct physical or electrical contact. The term coupled however may also mean that two or more elements are not in direct contact with each other but yet still co operate or interact with each other. The embodiments are not limited in this context.

As used herein the terms comprises comprising includes including has having or any other variation thereof are intended to cover a non exclusive inclusion. For example a process method article or apparatus that comprises a list of elements is not necessarily limited to only those elements but may include other elements not expressly listed or inherent to such process method article or apparatus. Further unless expressly stated to the contrary or refers to an inclusive or and not to an exclusive or. For example a condition A or B is satisfied by any one of the following A is true or present and B is false or not present A is false or not present and B is true or present and both A and B are true or present .

In addition use of the a or an are employed to describe elements and components of the embodiments herein. This is done merely for convenience and to give a general sense of the disclosure. This description should be read to include one or at least one and the singular also includes the plural unless it is obvious that it is meant otherwise.

Upon reading this disclosure those of skill in the art will appreciate still additional alternative structural and functional designs for a system and a process for identifying known establishments in images. Thus while particular embodiments and applications have been illustrated and described it is to be understood that the described subject matter is not limited to the precise construction and components disclosed herein and that various modifications changes and variations which will be apparent to those skilled in the art may be made in the arrangement operation and details of the method and apparatus disclosed herein.

