---

title: Method and system for cooperative congestion detection in cellular networks
abstract: Congestion information is determined based on a file segment transferred to one of user terminals. The congestion information is available to a server or controller communicatively linked with a plurality of user terminals. The congestion information is shared with other user terminals that share a bottleneck link.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09172643&OS=09172643&RS=09172643
owner: Opanga Networks, Inc.
number: 09172643
owner_city: Seattle
owner_country: US
publication_date: 20130315
---
This application claims the benefit of U.S. Provisional Patent Application No. 61 718 526 filed on Oct. 25 2012 which is incorporated herein by reference.

Embodiments relate to the field of computer networks and communications over computer networks including communications over wireless networks.

Many computer networks in existence today communicate through the transfer of data. Some examples include networks that can function independently e.g. as Local Area Networks or LANs or collectively as part of a group of interconnected networks e.g. Wide Area Networks or WANs such as the World Wide Web. Some of these networks include technologies that facilitate relatively fast high data rate transmissions e.g. wired fiber optic cable and Digital Subscriber Line networks . Others facilitate slower data rate transmissions e.g. 3G cellular networks .

Mobile broadband services are becoming very popular in modern society. These services can provide a way for individuals having wireless communications devices e.g. a cellular phone or tablet to stay connected to the Internet while operating within and roaming between various wireless coverage areas. A concurrent trend is the huge increase in applications and media content distribution services that can facilitate the delivery of large burdensome media content files to or from user equipment. Large media content file transfers have the signature feature of consuming significant amounts of network resources e.g. channel bandwidth over extended periods of time. Methods of enabling and making this particular data type delivery more efficient are important to end users and service providers alike. The processes facilitating more efficient media content delivery are particularly relevant for wireless networks that have limited bandwidth resources.

Most wireless networks operate using shared communications channels where concurrent competing requests for channel access is commonplace. In these networks data transfers can be slowed or degraded during periods of network channel congestion. Congestion can occur if the demand for a shared channel s bandwidth resources nears or exceeds the channel s capacity. Under these circumstances the active users of the shared channel may come into conflict as each user attempts to complete individual data throughputs. To solve this problem users can revise their requests so that the shared network channel can successfully deliver all requests in a timely manner For example in a well known strategy users reduce their individual traffic using a fair share policy. Many other prioritization schemes exist but in existing methods the users of the congested shared network resource must first become aware that congestion is present before users can take corrective action to mitigate the congestion.

Congestion awareness by a user of a shared channel or link may be achieved in a variety of ways. In an example end user terminals could individually operate packet data protocols with a congestion detection mechanism and develop congestion metrics. For instance one transport layer packet data protocol is the transport control protocol TCP . TCP is also known by names of its many implementation variants such as TCP Reno TCP Vegas and CUBIC. Other packet data protocols with congestion detection capability exist such as SCTP. In using TCP or other similar protocols sending and receiving terminals interconnected by a network typically conduct periodic measurements of the network by transporting data over the network and measuring delivery performance of the data. Thus the periodic measurements taken in accordance to these protocols also present a traffic load to a network. Accordingly if many end user terminals attempt to detect congestion in this manner the aggregate burden to the network traffic exacerbates any congestion that may already be present. Sending and receiving terminal pairs do not share congestion state information with other terminals of the shared channel or link or even with separate transport layer data sessions operating using the same sending and receiving terminals.

Furthermore congestion detection and control is often assigned to lower protocol layers such as TCP while upper application protocol layers and application programming interfaces typically do not have access to the congestion status of the network. Without access to congestion information upper application layers and application programming have difficulty reacting to or mitigating the congestion.

Embodiments relate to the field of computer networks and communications over computer networks including communications over wireless networks. In an embodiment congestion information is determined based on a file segment transferred to one of user terminals. The congestion information is available to a server or controller communicatively linked with a plurality of user terminals. The congestion information is shared with other user terminals that share a bottleneck link.

According to an embodiment of the present invention a networked system comprises a sending system having a processor and a memory first and second receiving systems each system having a processor and a memory a communication network having a plurality of network resources that couples the sending system the first and second receiving systems in the communication network and a non transitory computer readable medium with stored computer executable instructions. When the instructions are executed by the processor they perform a method including sending a file segment to the first receiving system from the sending system the file segment being a portion of a data file being transmitted to the first receiving system determining congestion information of the communication network based on a transfer of the file segment and communicating the congestion information to the second receiving system. In some embodiments the first and second receiving systems may be wireless devices that are communicatively lined with the wireless network and the non transitory computer readable medium may be located in the sending or receiving systems.

In an embodiment congestion information is measured by a resource that is associated with a lower communications layer.

In an embodiment congestion information is communicated to the second receiving system by providing the congestion information in an application layer of a packet transmitted to the second receiving system.

In an embodiment the congestion information includes congestion status or congestion metrics or both. In another embodiment the congestion status information is measured by the first receiving system or the sending system. In yet another embodiment when the instructions are executed by the processor the method may additionally include calculating the congestion metrics using the congestion status and communicating the metrics to the second receiving system by providing the congestion information in an application layer of a packet transmitted to the second receiving system.

In an embodiment when the instructions are executed by the processor the method may additionally include determining a bottleneck link in the communication network based on the congestion information the bottleneck link being associated with one of the network resources in the end to end communication network links between the sender and the receiving systems identifying receiving systems sharing the bottleneck link and communicating the congestion information to the receiving systems sharing the bottleneck link the second receiving system being one of the systems identified as sharing the bottleneck link. In another embodiment the sending system identifies the receiving systems sharing the bottleneck link and communicates the congestion information to the systems sharing the bottleneck link.

In an embodiment when the instructions are executed by the processor the method may additionally include communicating the congestion information to a congestion management system of the network system where the congestion management system communicates the congestion information to the second receiving system.

According to an embodiment of the present invention a cooperative congestion detection method in a networked system having a sending system and first and second receiving systems comprises sending a file segment to the first receiving system from the sending system the file segment being a portion of a data file being transmitted to the first receiving system determining congestion information of the network system based on a transfer of the file segment and communicating the congestion information to the second receiving system.

In an embodiment of a cooperative congestion detection method the network system includes a wireless network and the first and second receiving systems may be wireless devices communicatively linked with the wireless network. In another embodiment congestion information can be measured by a resource that is associated with a lower communications layer. In a further embodiment the congestion information is communicated to the second receiving system by providing the congestion information in an application layer of a packet transmitted to the second receiving system.

In an embodiment of a cooperative congestion detection method congestion information includes congestion status or congestion metrics or both. In another embodiment congestion status information is measured by the first receiving system or the sending system. In a further embodiment the method further comprises calculating the congestion metrics using the congestion status. The congestion information is communicated to the second receiving system by providing the congestion information in an application layer of a packet transmitted to the second receiving system.

In an embodiment of a cooperative congestion detection method the method further comprises determining a bottleneck link in the end to end network system links between the sender and the receiving systems based on the congestion information identifying receiving systems sharing the bottleneck link and communicating the congestion information to the systems sharing the bottleneck link the second receiving system being one of the systems identified as sharing the bottleneck link. In another embodiment the sending system identifies the receiving systems sharing the bottleneck link and communicates the congestion information to the systems sharing the bottleneck link.

In an embodiment of a cooperative congestion detection method the method further comprises communicating the congestion information to a congestion management system of the network system. The congestion management system may communicate the congestion information to the second receiving system.

In an embodiment the networked computing system includes a group of service provider devices a data communications network a variety of remote user equipment one or more devices to facilitate data communications and one or more local user equipment. In addition to the components described above the networked computing system may include other types of network components according to various implementations.

A group of service provider devices and SPDs may include server computers e.g. network controller devices or any other common network device such as routers gateways or switch devices which can support network resource allocation and or digital data communications services to various user equipment e.g. any of terminal devices and within the networked computing system . A data communications network includes Wide Area Network WAN Local Area Networks LANs and portions thereof.

A variety of remote user equipment may include cellular phone or mobile devices along with any other variety of portable wireless computing device well known in the art e.g. cellular phones smartphones tablets computers netbooks electronic book devices handheld gaming units personal music players video recorders WI FI devices etc. . The remote user equipment may be connected to the data communications network utilizing one or more wireless base stations or any other common wireless or wireline network communications technology.

One or more network gateways routers or switch devices facilitate data communications processes within the LANs and between the LANs and the WAN of the data communications network .

One or more user equipment and can be wirelessly connected to one or more local or remote network base stations and or optionally directly or indirectly connected to a backhaul portion of the network e.g. to data communications network via any common wireline or wireless communications technology. The user equipment includes laptop computers and wireless mobile devices or phones electronic book devices handheld gaming units personal music players video recorders Wi Fi devices or the like.

In an embodiment any of the SPDs and including any of the network base stations and the router gateway or switch device s or any of the remote or local user equipment and may be configured to run any known operating system including but not limited to MICROSOFT WINDOWS MAC OS LINUX UNIX GOOGLE CHROME or any common mobile operating system including APPLE IOS WINDOWS MOBILE MOBILE LINUX GOOGLE ANDROID etc.

In an embodiment any of the SPDs and may employ any number of common server desktop laptop and personal computing devices. In an embodiment the user equipment and may include any combination of common mobile computing devices e.g. laptop computers netbook computers cellular phones PDAs handheld gaming units electronic book devices personal music players video recorders etc. having wireless communications capabilities employing any common wireless data commutations technology including but not limited to WI FI WIMAX GSM UMTS LTE LTE Advanced etc.

In an embodiment the LANs or the WAN portions of the data communications network may employ any of the following common communications technologies optical fiber coaxial cable twisted pair cable Ethernet cable and powerline cable along with any wireless communication technology known in the art. In an embodiment any of the SPDs and including any of the network base stations and the router gateway switch device s or any of the remote or local user equipment and may include any standard computing software and hardware necessary for processing storing and communicating data amongst each other within the networked computing system . The computing hardware realized in any of the data networked computing system computing devices and may include one or more processors volatile and non volatile memories user interfaces transcoders and wireline and or wireless communications transceivers etc.

In an embodiment any of the SPDs and including any of the network base stations and the router gateway switch device s or any of the remote or local user equipment and may be configured to include one or more computer readable media e.g. any common volatile or non volatile memory type encoded with a set of computer readable instructions which when executed performs a portion of one or more of the network traffic and radio communications quality monitoring or data content transfer optimization processes associated with various embodiments described herein.

The SPD may also include an optional user interface that allows a service provider administrator to interact with the device s software and hardware resources a software database repository a transceiver for transmitting and receiving network data communications amongst various network user equipment e.g. any of devices and and SPDs e.g. any of SPDs and utilizing the data communication network of the networked computing system a transcoder for formatting data communications prior to transfer and a system bus that facilitates data communications amongst all the hardware resources of the SPD .

The software database repository of SPD can include a data transfer agent also referred to herein as an adaptive throttling agent or ATA that may facilitate real time adjustment of data transfer rates based on comparisons of maximum link throughput to actual link throughput received from one or more user equipment as a feedback or from a local or external link capacity monitor. Software database repository of SPD can also include a link profiler that is capable of determining a current throughput capacity for a series of network links between a sender and a receiver and a subscriber device profiles database that is able to store user equipment profile and resident exhaustible resource information information pertaining to battery power processor usage available memory etc. . Furthermore software database repository of SPD can include an optional network link monitor that may be capable of monitoring actual link throughput for particular network links of interest also referred to herein as a link capacity sensing agent or LCSA .

In accordance with an embodiment of the present invention the SPD data transfer agent may be logically linked to the link profiler and the optional network link monitor or alternately to an external network link monitor component of user equipment such that the data transfers between a sender and receiver device e.g. between a SPD or a media content provider and a user equipment may be optimally managed e.g. by throttling a data transfer rate or selecting preferred periods for data content delivery based on real time evaluations of network traffic for communications links that are part of the communications path between and optionally including the sending and receiving devices.

The user equipment may also include but is not limited to a user interface that allows a user to interact with its software and hardware resources a software database repository a transcoder for formatting data communications prior to transfer a transceiver for transmitting and receiving network communications amongst other network user equipment e.g. any of user equipment and media content providers and SPDs e.g. any of SPDs and utilizing the data communication network of the networked computing system and a system bus that facilitates data communications amongst all the hardware resources of the user equipment .

Software database repository can include a data transfer manager that facilitates communications amongst the user equipment various SPDs e.g. any of SPDs and network service providers e.g. media content providers as well as other user equipment e.g. any of user equipment and utilizing the data communication network of the networked computing system a network link monitor that may be capable of monitoring actual link throughput for particular network links of interest also referred to herein as a link capacity sensing agent or LCSA a device resource monitor that may be capable of monitoring resident device resources e.g. such as power supply processing memory and communications resources and a local applications repository for storing various end user applications that can allow the user equipment to perform various user preferred processes utilizing resident hardware and software resources.

In accordance with an embodiment of the present invention the data transfer manager may be logically linked to the network link monitor or alternately to an external network link monitor and the device resource monitor such that the user equipment can monitor external network link capacities as well as its resident exhaustible resources in order to affect data transfers between itself and an external computing device e.g. a SPD a media content provider or another user equipment . In an embodiment in response to analyzing data obtained from the user equipment s network link monitor and or device resource monitor a data delivery to the user equipment may be optimally managed e.g. by throttling a data transfer rate or selecting preferred periods for data content delivery . This management may be based on real time evaluations of network traffic for communications links that are part of the communications path between and optionally including sending and receiving e.g. the user equipment devices. Examples of management and network traffic evaluations can be found in U.S. Pat. No. 7 500 010 ADAPTIVE FILE DELIVERY SYSTEM AND METHOD Harrang et al. issued on Mar. 3 2009 U.S. Pat. No. 8 019 886 SYSTEMS AND METHODS FOR ENHANCED DATA DELIVERY BASED ON REAL TIME ANALYSIS OF NETWORK COMMUNICATIONS QUALITY AND TRAFFIC Harrang et al. issued on Sep. 13 2011 and U.S. patent application Ser. No. 12 395 485 ADAPTIVE FILE DELIVERY SYSTEM AND METHOD Harrang et al. filed Feb. 27 2009 all of which are incorporated herein by reference.

In an embodiment user equipment may request a delivery from a media content provider a sender device for a large media content file e.g. a media content relating to music a movie a TV show a software application an e book a podcast etc. to their wireless device using a specific wireless communications protocol using lower protocol layers. One or more network devices e.g. user equipment or SPDs employing the communications protocol may sense a state of network channel congestion e.g. using a network link monitor . The congestion state may be determined for example by monitoring the performance of the media content file delivery over one or more network specific segments e.g. by measuring analyzing one or more network communications metrics in the end to end link measuring a peak or best achievable end to end link throughput performance for the combined network segments e.g. with a receiver device such as user equipment and then comparing individual segment throughput with peak end to end link throughput. In this manner network congestion can be detected via the comparison and the network segment s that may be the source of a congestion bottleneck can also be identified. Although in this disclosure many embodiments are described as using a wireless network in a networked computer system embodiments need not be limited to wireless networks. Embodiments may also be practiced in networked computer systems using a wired networks or a combination of wired and wireless networks and in other types of networks and links between endpoints e.g. wired or fiber backhaul and coaxial cable .

At the first user equipment exchanges traffic with an SPD and obtains network congestion information from lower layer communications protocols. Congestion information may include congestion status and congestion metrics. Congestion status can include for example throughput data delivery measurements over one or more specific network segments and end to end link throughput performance measurements for combined network segments. In some embodiments congestion status can include end to end data delivery performance accounting for resends of missing or lost data i.e. goodput . In other embodiments congestion status can include end to end data delivery latency. Congestion status information may be used to calculate congestion metrics. Congestion metrics can include for example throughput rates for multiple delivered file segments that can be weighted according to the time of measurement and throughput file delivery rates scaled according to end to end peak link capacities. In some embodiments congestion metrics can further include maximum permitted average delivery rate based on reported congestion status and combinations of derived congestion metrics. In some embodiments the file segments consist of multiple data packets sent end to end and spanning sufficient time and data volume to obtain an estimate of the sustained performance of the end to end network. In some networks an example of a file segment size is approximately 16 kiloBytes kBytes .

At the first user equipment passes congestion information that may be passed to the upper application layers of other user equipment or servers. First user equipment also provides the congestion information to a server on the network. As an alternative the peak link capacity and network congestion information can be determined by a server on the networked computer system based on congestion metrics passed to it by the user equipment.

At the server forwards the network congestion information to the upper application layers of devices connected via the network and sharing a bottleneck link with the first user equipment. The devices can include one or more user equipment devices servers networked to these devices and additional service provider devices. At the devices receiving the network congestion information uses the information to manage its data transfers. For example the devices may throttle a data transfer rate or select preferred periods for data content delivery. In an embodiment described in U.S. Pat. No. 7 500 010 ADAPTIVE FILE DELIVERY SYSTEM AND METHOD Harrang et al. issued on Mar. 3 2009 and incorporated herein by reference data transfer agent is an adaptive throttling agent that can determine the maximum average throughput rate of the sender to receiver data flow Rmax which can then be enforced by either a sender or receiver to pace the rate of requests from a receiver for subsequent portions of the data file being transferred.

Each of receiving systems and could be collocated with a DVR PC network storage unit client work station television set top box modem gateway or other such devices such as a tablet portable audio video player mobile communication device such as a cell phone or in a dedicated hardware unit. The receiving systems and could be connected via fiber wireline wireless means to the network . In some embodiments receiving systems and each may be user equipment as described herein.

The network could include one or more network components from the Internet or other networks such as WANs including but not limited to wired DSL cable powerline fiber wireless satellite and cellular type networks. The network could include other such network components such as but not limited to modems routers bridges gateways network interfaces cabled transmissions wireless transmissions local area networks LANs access networks provider networks and peer to peer arrangements.

The sending system includes an interface to access the network a processor and storage containing a file to be transmitted over the network to the receiving system . Sending system may include one or more modules with instructions to implement adaptive file delivery methods.

The receiving system includes an interface to access the network a processor and storage to store copies of portions of the file received from the sending system and to store one or more modules to implement instructions regarding adaptive file delivery methods. It is understood that the receiving system could be located at an end user s location or be located at some intermediary network location e.g. to serve as a caching node for distributing content geographically closer to a plurality of end users.

The receiving system includes an interface to access the network a processor and storage to store update received from the sending system . It is understood that the receiving system could be located at an end user s location or be located at some intermediary network location e.g. to serve as a caching node for distributing content geographically closer to a plurality of end users.

Sending system and receiving systems and may include data stored on a non transitory computer readable medium in a memory within or separate from storage and respectively. The data may include computer executable instructions which when executed by processors and respectively perform one or more processes associated with embodiments of the present invention. Thus sending system and receiving systems and may perform the measurements and calculations disclosed herein. Receiving systems and share at least one bottleneck link in network . In an embodiment the bottleneck link is a base station . In another embodiment the bottleneck is a network link segment or a switch or a router or a node in the Internet.

A bottleneck link is that portion of a shared communications channel that limits the throughput capacity of the channel. Regardless of the type of network employed a bottleneck link may exist whether wireless wired or fiber in nature between the server and one or more user terminals. The bottleneck link is shared in terms of the traffic capacity of the link. For example in consumer access networks the last mile of the communication channel is typically a shared resource e.g. wireless cell base station backhaul or coaxial cable network and in many cases for cost reasons the last mile is the limiting capacity resource or the bottleneck link.

Referring to methods for determining which receiving systems share a bottleneck link in the network path to a common sending system depend on the type of network connecting the endpoints. In some embodiments the network includes a wireless network and the bottleneck link is the last mile wireless link. In this example receivers may be associated by examining the serving cell equipment identifier reported to a server by the terminals e.g. receiving systems and or sending system . In certain embodiments the network includes a coaxial cable as the last mile access and the bottleneck link is the shared cable plant connecting the cable modem termination system CMTS to a group of terminals e.g. receiving systems and or sending system . In these cases receivers may be associated by the CMTS identifier of the terminals e.g. receiving systems and or sending system . In another embodiment the bottleneck link in network may be identified using known techniques for determining the address identifier of the bottleneck link and terminals e.g. receiving systems and or sending system sharing the bottleneck link are grouped by the server. In yet another embodiment terminals e.g. receiving systems and or sending system sharing the bottleneck link may be determined by network construction and manually configured to the server.

In an embodiment the sending system in sends one or more file segments over the network to the receiving system . Receiving system measures the delivery performance of file segments and collects congestion status measurements. Receiving system may calculate metrics and provide congestion information to sending system for example in a control message which is not shown in . Sending system sends update message to receiving system . Receiving system receives the updated network congestion information.

In another embodiment the sending system in sends one or more file segments over the network to the receiving system . Sending system measures the delivery of file segments and collects congestion status measurements. Sending system may calculate metrics and provide congestion information in update message to receiving system . Receiving system receives the updated network congestion information. Sending system may also send an update to receiving system or provide information through a control message which are not shown in . It can be understood that in some embodiments more than one sending system may send file segments to a plurality of receiving systems.

In an embodiment file segment is a copy of a portion of the file . File may be divided into multiple file segments for data transmission with each file segment sent at a different time. In some embodiments that employ a wireless network the size of the file segment may be designed to connect with the wireless network and to engage the wireless channel at a higher speed in cases where lower layer communication protocols segregate access to differentiated speed channels by file transfer size. In such instances the initial portion of a larger data burst may see transfer of smaller packets in a slower shared multiple access channel followed by an abrupt increase in rate as the data burst transfers to a higher speed dedicated channel. This may affect the congestion status measurements and decrease the accuracy of the throughput rate calculations. A larger file segment size may improve throughput rate calculations by moving quickly through this start up effect. Thus in certain embodiments the file segment size is sixteen kBytes. In some embodiments the file segment size is more than or less than sixteen kBytes.

In some embodiments and as generally provided above network congestion status can include measurements of the amount of data transferred between a sender i.e. sending system and a receiver i.e. a receiving system together with the time for delivery of that data. Congestion metrics such as for example the rate of data transfer or data download can then be calculated. In an example the sender may be end user equipment and the receiver a server connected to the end user equipment through a network. In another example the receiver may be end user equipment and the sender a server connected to the end user equipment through a network. Thus the roles of sender and receiver may be assigned according to the direction of data transfer over the network with either sender or receiver measuring congestion status and calculating congestion metrics. Each direction of data transfer over the network may have its own separate network congestion information. Embodiments of the disclosure can therefore be applied in a bi directional manner.

File segment can be used to measure the congestion status of the network having a bottleneck link. The file segment may be delivered under conditions derived from previously obtained congestion information or delivered under conditions derived from default network condition settings e.g. default transfer rate . In some cases more than one file segment may be transmitted so that the congestion status of the network can averaged over multiple measurements. In certain instances the file segment may be of sufficient size under network conditions such that the sustained end to end data throughput through the bottleneck link may be determined. In some cases the file segment is sixteen kBytes in size. Methods of determining the sustained congestion status of the network are disclosed in U.S. Pat. No. 7 500 010 ADAPTIVE FILE DELIVERY SYSTEM AND METHOD Harrang et al. issued on Mar. 3 2009 U.S. Pat. No. 8 019 886 SYSTEMS AND METHODS FOR ENHANCED DATA DELIVERY BASED ON REAL TIME ANALYSIS OF NETWORK COMMUNICATIONS QUALITY AND TRAFFIC Harrang et al. issued on Sep. 13 2011 and U.S. patent application Ser. No. 12 395 485 ADAPTIVE FILE DELIVERY SYSTEM AND METHOD Harrang et al. filed Feb. 27 2009 all of which are incorporated herein by reference.

In some embodiments terminal receives file segment and measures the network congestion status in step . The network congestion status is then communicated to server in step . In an alternative server determines the network congestion status in step based on the delivery acknowledgment from terminal where the delivery acknowledgment also includes file segment delivery performance sufficient to determine the current congestion status. Server may send the network congestion status to terminal in step . In another alternative both terminal and server determine network congestion status at steps and respectively.

In certain other embodiments terminal sends file segment and determines the network congestion status in step based on a delivery acknowledgment from server . The network congestion status is then communicated to server in step . In an alternative server measures the network congestion status in step . Server may send the network congestion status to terminal in step . In another alternative both terminal and server determine network congestion status at steps and respectively.

In certain embodiments at step server determines the receivers i.e. terminals or end users to receive network congestion status . Examples of factors that may be relevant in this determination include which terminals that share a bottleneck link with terminal are currently active in using the network which application the terminal s may be operating which Quality of Service configuration or mechanisms are currently employed in the network and which protocols or procedures addressing network congestion are currently in force. In some cases the determination may be based on a policy stored on the server that may be configured to take into account one or more of the above factors. In certain cases all receivers i.e. terminals or end users sharing the bottleneck link are selected for update one by one with unicast messages and in other cases with a multicast or broadcast message. While illustrates a single second terminal some embodiments contemplate a plurality of receivers that may receive the congestion status update. It may also be appreciated that in cases where zero second terminals are selected for update that server performs no updates.

In some embodiments the terminal or the server can calculate congestion metrics based on the congestion status at steps and respectively. In some embodiments the terminal can calculate congestion metrics at step based on the congestion status received from the server as further described below. Congestion status can include for example throughput data delivery measurements over one or more specific network segments and end to end link throughput performance measurements for combined network segments. Congestion status information may be used to calculate congestion metrics. Congestion metrics can include for example throughput rates for multiple delivered file segments that can be weighted according to the time of measurement and throughput file delivery rates scaled according to end to end peak link capacities. In some cases congestion status values are weighted according to their age which is in turn based on the time of the measurement of file delivery segments. In other examples averaging strategies can be employed to weight the most recent congestion status values or to reduce rapid congestion status measurement variation.

In an embodiment an exemplary weighting calculation assumes a set of N available congestion estimates of rate R that represent a measured data throughput rate of a delivered file segment . Each estimate is weighted as follows 1

where m 1 t. tis a set cutoff time where t t and tis the time corresponding to the sample time of R i 1 N integer.

In many embodiments some or all of the receivers may have different file delivery capacities. Therefore in these cases the congestion metrics for the receivers are scaled accordingly to take capacities into account SUM 

where the SUM runs i 1 N integer and RP is the peak or maximum throughput measurement for the receiver over the link determined by channel profiling measurement or established by historical measurements or by configuration.

The ensemble average ratio R RP e may be used to determine the throughput constraint for file segment delivery under the measured network conditions 

where g is a backoff function for which its definition is related to the policy for congestion flow control. In some embodiments congestion metric Ris the maximum average throughput rate of the sender to receiver data flow which can be enforced by upper layer control protocols to pace the rate of requests from a receiver for subsequent portions of the data file being transferred.

In embodiments after the congestion metrics are calculated the metrics can be communicated to server by terminal or communicated to terminal from server . In cases in which server determines in step that a plurality of receivers i.e. terminals or end users should receive a network congestion update server may communicate congestion status or congestion metrics to receivers such as terminal in step . In those instances in which terminal receives congestion status terminal can calculate its congestion metrics in step .

In some embodiments terminal is active within the network and may provide congestion status to the server. In an embodiment in step file segment is transmitted between terminal and server . In some cases the file segment is transmitted from the terminal to the server. In other cases the file segment is transmitted from the server to terminal. Thus in practice a server and a terminal may play the role of a sending system or receiving system.

File segment can be used to determine the congestion status of the network having a bottleneck link. In some embodiments terminal receives file segment and measures the network congestion status in step . The network congestion status is then communicated to server in step . In an alternative server determines the network congestion status in step based on the delivery acknowledgment from terminal where the delivery acknowledgment also includes file segment delivery performance sufficient to determine the current congestion status. Server may send the network congestion status to terminal in step . In another alternative both terminal and server determine network congestion status at steps and respectively.

In certain other embodiments terminal sends file segment and determines the network congestion status in step based on a delivery acknowledgment from server . The network congestion status is then communicated to server in step . In an alternative server measures the network congestion status in step based on file segment delivery measurements. Server may send the network congestion status to terminal in step . In another alternative both terminal and server determine network congestion status at steps and respectively.

In certain embodiments at step server determines the receivers i.e. terminals or end users to receive network congestion status . Examples of factors that may be relevant in this determination include which terminals that share a bottleneck link with terminal are currently active in using the network which application the terminal s may be operating which Quality of Service configuration or mechanisms are currently employed in the network and which protocols or procedures addressing network congestion are currently in force. In some cases the determination may be based on a policy stored on the server that may be configured to take into account one or more of the above factors. In certain cases all receivers i.e. terminals or end users sharing the bottleneck link are selected for update one by one with unicast messages and in other cases with a multicast or broadcast message. While illustrates a single second terminal some embodiments contemplate a plurality of receivers that may receive the congestion status update. It may also be appreciated that in cases where zero second terminals are selected for update that server performs no updates.

In some embodiments the terminal or the server can calculate congestion metrics based on the congestion status at steps and respectively. Exemplary calculations for congestion metrics such as for example R are previously discussed herein.

In embodiments after the congestion metrics are calculated the metrics can be communicated to server by terminal or communicated to terminal from server . In cases in which server determines in step that a plurality of receivers i.e. terminals or end users should receive a network congestion update server may communicate congestion status or congestion metrics to receivers such as terminal in step . In those instances in which terminal receives congestion status terminal can calculate its congestion metrics in step .

Referring to in an embodiment server is a base station and terminals and are mobile devices or phones that are within a coverage area of the base station and are joined to the base station. The base station may be a macro base station pico base station femto base station or the like. In an implementation if the base station or a base station controller receives a congestion status from one of the mobile devices the base station or controller determines other mobile devices that are joined to the base station by accessing stored status records of the unique identifiers of currently attached joined mobile devices e.g. attachment status known via mobility protocol exchanges between mobile devices and serving base station and broadcasts congestion information to these other mobile devices. These other mobile devices then reduce their bandwidth requests to the base station. In another implementation upon receiving a congestion status from one of the mobile devices that is joined to the base station the base station sends congestion information to selected mobiles devices based on the current bandwidth being used or expected bandwidth usage of the these other mobile devices. The selected mobile devices adjust their bandwidth requests to the base station upon receiving the congestion information from the base station. These selected mobile devices are part of the mobile devices that within the coverage area and are joined to the base station.

Each of receiving systems and could be collocated with a DVR PC network storage unit client work station television set top box modem gateway or other such devices such as a tablet portable audio video player cellular communication device such as a cell phone or in a dedicated hardware unit. The receiving systems and could be connected via fiber wireline wireless means to the network .

The network could include one or more network components from the Internet or other networks such as WANs including but not limited to wired DSL cable powerline fiber wireless satellite and cellular type networks. The network could include other such network components such as but not limited to modems routers bridges gateways network interfaces cabled transmissions wireless transmissions local area networks LANs access networks provider networks and peer to peer arrangements.

The sending system includes an interface to access the network a processor and storage containing a file to be transmitted over the network to the receiving system . The congestion manager includes an interface to access the network a processor and storage . Congestion manager may include one or more modules with instructions to implement adaptive file delivery methods to be transmitted over the network to receiving systems and .

The receiving system includes an interface to access the network a processor and storage to store copies of portions of the file received from the sending system and to store one or more modules to implement instructions regarding adaptive file delivery methods. It is understood that the receiving system could be located at an end user s location or be located at some intermediary network location e.g. to serve as a caching node for distributing content geographically closer to a plurality of end users.

The receiving system includes an interface to access the network a processor and storage to store update received from the congestion manager . It is understood that the receiving system could be located at an end user s location or be located at some intermediary network location e.g. to serve as a caching node for distributing content geographically closer to a plurality of end users.

Sending system receiving systems and and congestion manager may include data stored on a non transitory computer readable medium in a memory within or separate from storage and respectively. The data may include computer executable instructions which when executed by processors and respectively perform one or more processes associated with embodiments of the present invention. Thus sending system receiving systems and and congestion manager may perform the measurements and calculations disclosed herein. Receiving systems and share at least one bottleneck link in network .

A bottleneck link is that portion of a shared communications channel that limits the throughput capacity of the channel. Regardless of the type of network employed a bottleneck link may exist whether wireless wired or fiber in nature between the server and one or more user terminals. The bottleneck link is shared in terms of the traffic capacity of the link. For example in consumer access networks the last mile of the communication channel is typically a shared resource e.g. wireless cell base station backhaul or coaxial cable network and in many cases for cost reasons the last mile is the limiting capacity resource or the bottleneck link.

Referring to methods for determining which receiving systems share a bottleneck link in the network path to a common sending system depend on the type of network connecting the endpoints. In some embodiments the network is connected via a wireless network and the bottleneck link is the last mile wireless link. In this example receivers may be associated by examining the serving cell equipment identifier reported to a congestion manager by the terminals e.g. receiving systems and or sending system . In certain embodiments the network includes a coaxial cable as the last mile access and the bottleneck link is the shared cable plant connecting the cable modem termination system CMTS to a group of terminals e.g. receiving systems and or sending system . In these cases receivers may be associated by the CMTS identifier of the terminals e.g. receiving systems and or sending system . In another embodiment the bottleneck link in network may be identified using known techniques for determining the address identifier of the bottleneck link and terminals e.g. receiving systems and or sending system sharing the bottleneck link are grouped by the congestion manager . In yet another embodiment terminals e.g. receiving systems and or sending system sharing the bottleneck link may be determined by network construction and manually configured to the congestion manager .

In an embodiment the sending system in sends one or more file segments over the network to the receiving system . Receiving system measures the delivery performance of file segments and collects congestion status measurements. Receiving system may calculate metrics and provide congestion information to congestion manager for example in a control message which is not shown in . In some embodiments the sending system may deliver content without participating in the congestion management process. In such cases other methods may be used by receiving system to detect congestion including without limitation monitoring the average end to end delivery throughput rates the file segment end to end delivery throughput rates monitoring dropped data packet rates monitoring data packet latency and monitoring data packet header congestion marking. Congestion manager sends update message to receiving system . Receiving system receives the updated network congestion information.

In another embodiment the sending system in sends one or more file segments over the network to the receiving system . Congestion manager determines the time for delivery of file segments and collects congestion status measurements. Congestion manager may in some embodiments calculate congestion metrics. Congestion manager sends update message to receiving system . Receiving system receives the updated network congestion status. Congestion manager may also send an update to receiving system or provide information through a control message which are not shown in .

Congestion manager may be located anywhere in the network. As an example in a central location with network connectivity to user terminals. In another example congestion manager may be located at the aggregation point for user terminal traffic such as in a wireless base station or base station controller. Congestion manager may use any methods for detecting congestion including without limitation measuring the delivery rates for transferred file segments over one or more network specific segments such as the bottleneck link measuring and end to end link throughput performance for the combined network segments and comparing individual segment throughput with peak or best achievable end to end link throughput monitoring the average throughput rates monitoring dropped data packet rates monitoring data packet latency and monitoring data packet header congestion marking.

In an embodiment file segment is a copy of a portion of the file . File may be divided into multiple file segment for data transmission with each file segment sent at a different time. In some embodiments that employ a wireless network the size of the file segment may be designed to connect with the wireless network and to engage the wireless channel at a higher speed in cases where lower layer communication protocols segregate access to differentiated speed channels by file transfer size. In such instances the initial portion of a larger data burst may see transfer of smaller packets in a slower shared multiple access channel followed by an abrupt increase in rate as the data burst transfers to a higher speed dedicated channel. This may affect the congestion status measurements and decrease the accuracy of the throughput rate calculations. A larger file segment size may improve throughput rate calculations by moving quickly through this start up effect. Thus in certain embodiments the file segment size is sixteen kBytes. In some embodiments the file segment size is more than or less than sixteen kBytes.

In some embodiments and as generally provided above network congestion status can include measurements of the amount of data transferred between a sender i.e. sending system and a receiver i.e. a receiving system together with the time for delivery of that data. Congestion metrics such as for example the rate of data transfer or data download can then be calculated. In an example the sender may be end user equipment and the receiver a server connected to the end user equipment through a network. In another example the receiver may be end user equipment and the sender a server connected to the end user equipment through a network. Thus the roles of sender and receiver may be assigned according to the direction of data transfer over the network with either sender or receiver measuring congestion status and calculating congestion metrics. Each direction of data transfer over the network may have its own separate network congestion information. Embodiments of the disclosure can therefore be applied in a bi directional manner.

File segment can be used to measure the congestion status of the network having a bottleneck link. The file segment may be delivered under conditions derived from previously obtained congestion information or delivered under conditions derived from default network condition settings e.g. default transfer rate . In some cases more than one file segment may be transmitted so that the congestion status of the network can averaged over multiple measurements. In certain instances the file segment may be of sufficient size under network conditions such that the sustained end to end data throughput through the bottleneck link may be determined. In some cases the file segment is sixteen kiloBytes in size.

In some embodiments terminal receives file segment and measures the network congestion status in step . The network congestion status is then communicated to congestion manager in step .

In certain embodiments at step congestion manager determines the receivers i.e. terminals or end users to receive network congestion status . Examples of factors that may be relevant in this determination include which terminals that share a bottleneck link with terminal are currently active in using the network which application the terminal s may be operating which Quality of Service configuration or mechanisms are currently employed in the network and which protocols or procedures addressing network congestion are currently in force. In some cases the determination may be based on a policy stored on congestion manager that may be configured to take into account one or more of the above factors. In certain cases all receivers i.e. terminals or end users sharing the bottleneck link are selected for update one by one with unicast messages and in other cases with a multicast or broadcast message. While illustrates a single second terminal some embodiments contemplate a plurality of receivers that may receive the congestion status update. It may also be appreciated that in cases where zero second terminals are selected for update that server performs no updates.

In some embodiments the terminal or the congestion manager can calculate congestion metrics based on the congestion status at steps and respectively. In some cases congestion status values are weighted according to their age which is in turn based on the time of the measurement. In other examples averaging strategies can be employed to weight the most recent congestion status values or to reduce congestion status measurement noise. Exemplary calculations for congestion metrics such as for example R are previously discussed herein.

In embodiments after the congestion metrics are calculated the metrics can be communicated to congestion manager by terminal or communicated to terminal from congestion manager . In cases in which congestion manager determines in step that a plurality of receivers i.e. terminals or end users should receive a network congestion update congestion manager may communicate congestion status or congestion metrics to receivers such as terminal in step . In those instances in which terminal receives congestion status terminal can calculate its congestion metrics in step .

In some embodiments terminal may provide congestion status or congestion metrics updates to congestion manager . In an example in step file segment is delivered to terminal . File segment can be used to measure the congestion status of the network having a bottleneck link. In some embodiments terminal receives file segment and determines the network congestion status in step . The network congestion status is then communicated to congestion manager in step . At step congestion manager determines the receivers i.e. terminals or end users to receive network congestion status as previously disclosed.

In some embodiments the terminal or congestion manager can calculate congestion metrics based on the congestion status at steps and respectively. In some cases congestion status values are weighted according to their age which is in turn based on the time of the measurement. In other examples averaging strategies can be employed to weight the most recent congestion status values or to reduce congestion status measurement noise. An example of a weighting calculation and exemplary calculations for congestion metrics such as for example Ris previously disclosed herein.

In embodiments after the congestion metrics are calculated the metrics can be communicated to congestion manager by terminal or communicated to terminal from congestion manager . In cases in which congestion manager determines in step that a plurality of receivers i.e. terminals or end users should receive a network congestion update congestion manager may communicate congestion status or congestion metrics to receivers such as terminal in step . In those instances in which terminal receives congestion status terminal can calculate its congestion metrics in step .

Referring to in an embodiment congestion manager is a base station and terminals and are mobile devices or phones that are within a coverage area of the base station and are joined to the base station. The base station may be a macro base station pico base station femto base station or the like. In an implementation if the base station or a base station controller receives a congestion status from one of the mobile devices the base station determines other mobile devices that are joined to the base station by accessing stored status records of the unique identifiers of currently attached joined mobile devices e.g. attachment status known via mobility protocol exchanges between mobile devices and serving base station and broadcasts congestion information to these other mobile devices. These other mobile devices then reduce their bandwidth requests to the base station. In another implementation upon receiving a congestion status from one of the mobile devices that is joined to the base station the base station sends congestion information to selected mobiles devices based on the current bandwidth being used or expected bandwidth usage of the these other mobile devices. The selected mobile devices adjust their bandwidth requests to the base station after the congestion information from the base station. These selected mobile devices are part of the mobile devices that within the coverage area and are joined to the base station.

While several embodiments of the present invention have been illustrated and described herein many changes can be made without departing from the spirit and scope of the invention. For example it can be appreciated that the disclosure may be used in wireless networks wired networks fiber networks and coaxial networks alone or in combination. Accordingly the scope of the invention is not limited by any disclosed embodiment. Instead the scope of the invention should be determined from the appended claims that follow.

