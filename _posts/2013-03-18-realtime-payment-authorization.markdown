---

title: Real-time payment authorization
abstract: Novel features to be used in a proxy card payment system include a real-time request to override a declined transaction or to select a different financial account and the insertion of user identification information into the transaction approval message sent to the merchant. A payment request is forwarded to the payment system, which maintains the proxy card account and determines whether the transaction violates a user-defined rule. If the transaction is declined by the issuer that maintains the financial account, or the payment system for violation of a user-defined rule, the payment system sends a real-time message to the user. The user is prompted to override the rule causing the transaction to be declined or to select a new account to process the transaction. Once the payment system receives authorization for the transaction, it inserts the user identification information in an approval message before transmitting the approval to the merchant.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08626592&OS=08626592&RS=08626592
owner: Google Inc.
number: 08626592
owner_city: Mountain View
owner_country: US
publication_date: 20130318
---
This application is a continuation of U.S. patent application Ser. No. 13 475 112 filed May 18 2012 and entitled Real time Payment Authorization which claims priority to U.S. Provisional Patent Application No. 61 559 136 filed Nov. 13 2011 and entitled Virtual Payment Path. The entire contents of the above identified priority applications are hereby fully incorporated herein by reference.

The present disclosure relates generally to proxy cards and more particularly to novel features to be used in proxy card payment systems.

In a conventional merchant consumer financial transaction the merchant s point of sale terminal or online payment process engine submits a payment request to the acquirer for example Chase PaymentTech or other third party payment processing companies for payment for the transaction. The acquirer then submits the request to authorize the transaction to the issuer for example Citibank CapitalOne Bank of America and other financial institutions to authorize payment through the card network for example VISA MasterCard American Express Discover or other card processing networks . If funds are available the issuer sends an authorization code to the acquirer through the card network and the acquirer notifies the merchant of the approval for the payment transaction. The payment process involves a single payment request generated and submitted by the merchant. The request contains generalized information such as the total payment amount and consumer account identifying information encoded on the card s magnetic stripe but the request does not contain item specific information such as the stock keeping unit SKU number or user identification information such as an electronic mail address.

Conventional merchant consumer financial transactions also have involved payment via a consumer s financial account such as a debit card credit card or stored value card. The consumer card typically accesses only one type of account which is maintained by only one issuer. For instance an issuer1 credit card accesses only the consumer s financial account from issuer1 and payment is approved denied by a single issuer issuer1 . Approval or denial of the transaction is dependent upon rules set by the particular issuer for example credit limits and geographical limitations. Notification of a violation of these rules results in a declined transaction and the consumer must contact the issuer to alter the rules or to address a declined transaction.

More recently proxy card payment systems enable users to utilize a single card to access multiple financial accounts maintained by multiple issuers. The user receives a proxy card from the payment system and either creates a new payment system account or associates the proxy card with the user s digital wallet account already maintained by the payment system. The user then associates one or more financial card accounts with the proxy account. For example the user can associate with the user s proxy card account multiple debit credit cards maintained by multiple issuers including the payment system operating as an issuer stored value cards for example gift cards prepaid cards re loadable transaction cards exchange cards and other forms of non credit based value cards loyalty cards or store rewards cards value added service accounts for example coupons vouchers for prepaid offers redemption offers and other forms of offers and or other forms of financial card accounts. The user applies the proxy card to a transaction with the merchant in a manner similar to the application of any financial card to a transaction. The merchant forwards the payment request to the acquirer which forwards the payment request to the card network. The card network forwards the proxy card payment request to the payment system which functions as the issuer for the payment request. The payment system can read proxy card account information from the payment request and can access the user s account associated with the proxy card. If the payment system is the issuer of the financial account the payment system will approve or decline the transaction. If another issuer maintains the financial account the payment system will generate and send a new payment request to the issuer via the card network. The payment system will receive the authorization message from the issuer via the card network if the transaction is approved. The payment system forwards an authorization to the acquirer through the card network which forwards the authorization to the merchant. The merchant then approves the transaction.

In certain exemplary aspects novel features to be used in a proxy card payment system include a real time request to override a declined transaction or a real time request to select a different financial account to proceed with the transaction and the insertion of user identification information into the transaction approval message sent to the merchant. A payment system includes specified information for multiple financial accounts including but not limited to debit cards credit cards stored value cards loyalty rewards cards and coupons including purchased offers and other offers each accessible by the proxy account. The user sets rules specifying which financial account will be accessed when the proxy card is used and specifying limits or circumstances during which the proxy card will be declined. A payment request is forwarded to the payment system which maintains the proxy card account. The payment system reads the user account information before using the rules to determine the order in which the financial accounts are to be applied and whether the transaction violates a user defined rule. If the payment system does not maintain the financial account the payment system sends a new payment request to the issuer of the referenced account. If the transaction is to be declined by the issuer or the payment system the payment system can send a real time message to the user via the user s mobile device. The user may be prompted to override a rule causing the transaction to be declined or to select a new account to process the transaction. Once the payment system receives authorization for the transaction it can insert user identification information in an approval message before transmitting the approval to the merchant through the card network and acquirer. User identification information also can be provided in the proxy card account information stored on the magnetic stripe of the proxy card or otherwise associated with the proxy card account identifier.

These and other aspects objects features and advantages of the exemplary embodiments will become apparent to those having ordinary skill in the art upon consideration of the following detailed description of illustrated exemplary embodiments which include the best mode of carrying out the invention as presently presented.

A payment system includes specified information for multiple financial accounts including but not limited to debit cards credit cards stored value cards loyalty rewards cards and coupons including purchased offers and other offers each accessible by the proxy account. The user sets rules specifying which financial account will be accessed when the proxy card is used and specifying limits or circumstances during which the proxy card will be declined. The user can then add delete or change the default payment rules associated with the proxy card. The user can change these default static rules create new rules or delete a rule. In an exemplary embodiment the user can access the payment system account and modify the rules at any time including a time immediately before a payment transaction is initiated using the proxy card. In an exemplary embodiment the user can access the payment system account using a mobile device application.

If the user has defined static payment rules or added deleted modified the rules prior to the transaction the payment system applies the user defined rules to the transaction first. Otherwise the payment system applies the default static payment rules to the transaction. If the transaction is to be declined the payment system notifies the user of the declined transaction via a message communicated to the user s mobile device. If the violation of a rule caused the transaction to be declined the user may be prompted to override the rule. If the financial account has insufficient funds the user may be prompted to select a new financial account. Instead of declining the payment request the payment system can authorize and or process the payment request based on the user s response to the message. Alternatively the payment system can decline the original payment request communicate the notice message to the user receive the user s response and revise the stored rules for payment. Then the user may immediately initiate a new payment transaction with the merchant using the proxy card. The payment system will then approve the payment transaction after receipt of a new payment request.

The payment system generates a new payment request if the financial account is maintained by a non payment system issuer or authorizes the original payment request if the payment system maintains the financial account. In either case the payment system can add user identification information to the authorization message received from the issuer or generated by the payment system acting as issuer for the financial account. The payment system also can forward offers to the user or inject offers directly into the payment transaction based on the product identification information received in the payment message and or the merchant identification information.

Users may be allowed to limit or otherwise affect the operation of the features disclosed herein. For example users may be given opportunities to opt in or opt out of the collection or use of certain data or the activation of certain features. In addition users may be given the opportunity to change the manner in which the features are employed including for situations in which users may have concerns regarding privacy. Instructions also may be provided to users to notify them regarding policies about the use of information including personally identifiable information and manners in which each user may affect such use of information. Thus information can be used to benefit a user if desired through receipt of relevant advertisements or other information without risking disclosure of personal information or the user s identity.

The functionality of the exemplary embodiments will be explained in more detail in the following description read in conjunction with the figures illustrating the program flow.

Turning now to the drawings in which like numerals indicate like but not necessarily identical elements throughout the figures and exemplary embodiments are described in detail.

Each communication network includes a wired or wireless telecommunication means by which network devices including devices and can exchange data. For example each network can include a local area network LAN a wide area network WAN an intranet an Internet a mobile telephone network a card network or any combination thereof. Throughout this specification it should be understood that the terms data and information are used interchangeably herein to refer to text images audio video or any other form of information that can exist in a computer based environment.

The secure communication channel includes a telecommunication means by which network devices including devices and can exchange data. For example each connection can include a local area network LAN a wide area network WAN an intranet an Internet a mobile telephone network a personal area network PAN or any combination thereof. In exemplary embodiments the secure communication channel comprises a proximity communication connection such as Bluetooth. Bluetooth can enable the exchange of data over short distances through the creation of PANs with high levels of security. Wi Fi is yet another proximity communication type wherein contactless devices can communicate via a wireless ad hoc network. In an alternative exemplary embodiment the secure communication channel comprises a near field communication NFC communication method.

The point of sale POS terminal system includes a terminal reader that is capable of reading the proxy card and communicating with the mobile device system and the merchant POS terminal via an application .

In an exemplary embodiment the terminal reader comprises a magnetic stripe reader which reads a magnetic stripe on the proxy card when the proxy card is swiped in the reader. In other exemplary embodiments the terminal reader comprises a bar code QR code or other machine readable scanner that captures information from the proxy card.

In another exemplary embodiment the terminal reader comprises a communication component that communicates with the mobile device using a Bluetooth communication method. In an alternative exemplary embodiment the terminal reader communicates with the mobile device using a Wi Fi communication method. In yet another exemplary embodiment the terminal reader communicates with the mobile device using a NFC communication method. While the terminal reader is depicted as standalone hardware device the terminal reader also may be an integrated part of the POS terminal in accordance with alternative exemplary embodiments.

In an exemplary embodiment the mobile device system can refer to a smart device that can communicate via an electronic magnetic or radio frequency field between the device and another device such as a terminal reader . In an exemplary embodiment the mobile device has processing capabilities such as storage capacity memory and one or more application that can perform a particular function. In an exemplary embodiment the mobile device contains an operating system not illustrated and user interface . Exemplary mobile devices include smart phones mobile phones PDAs mobile computing devices such as netbooks and iPads other electronically enabled key fobs electronically enabled credit card type cards and other devices in each case having processing and user interface functionality. Certain mobile devices can be used for multiple purposes including financial transactions coupons ticketing secure authentication and other related applications.

The secure element can exist within a removable smart chip or a secure digital SD card or can be embedded within a fixed chip on the mobile device . In certain exemplary embodiments Subscribed Identity Module SIM cards may be capable of hosting a secure element for example an NFC SIM Card. The secure element allows a wallet software application or other application or resident on the device and accessible by the user to interact securely with certain functions within the secure element while protecting information stored within the secure element. The secure element comprises applications running thereon that perform the functionality described herein.

The secure element includes components typical of a smart card such as crypto processors and random generators. In an exemplary embodiment the secure element comprises a Smart MX type NFC controller in a highly secure system on a chip controlled by a smart card operating system such as a JavaCard Open Platform JCOP operating system. In another exemplary embodiment the secure element is configured to include a non EMV type contactless smart card such as an optional implementation.

The secure element communicates with the controller and the application in the mobile device . In an exemplary embodiment the secure element is capable of storing encrypted user information and only allowing trusted applications to access the stored information. The controller interacts with a secure key encrypted application for decryption and installation in the secure element . In an exemplary embodiment the controller is a Bluetooth link controller. The Bluetooth link controller may be capable of sending and receiving data identifying the terminal reader performing authentication and ciphering functions and directing how the mobile device will listen for transmissions from the terminal reader or configure the mobile device into various power save modes according to the Bluetooth specified procedures. In another exemplary embodiment the controller is a Wi Fi controller or an NFC controller capable of performing similar functions.

The application is a program function routine applet or similar entity that exists on and performs its operations on a mobile device . For example the application may be one or more of a digital wallet application a coupon application a loyalty card application another value added application a user interface application or other suitable application operating on the mobile device . Additionally the secure element also may comprise secure contactless software applications such as payment applications secure forms of the applications authentication applications payment provisioning applications or other suitable application using the secure functionality of the secure element.

An exemplary digital wallet application enables storage of one or more financial card accounts registered by user . In an exemplary embodiment the registered accounts can be maintained by the user s digital wallet application and stored in the data storage unit . In yet another embodiment the registered accounts can be maintained by the payment system s processing module and stored in the data storage unit .

The mobile device communicates with the terminal reader via an antenna . In an exemplary embodiment once the mobile device application has been activated and prioritized the controller is notified of the state of readiness of the mobile device for a transaction. The controller outputs through the antenna a radio signal or listens for radio signals from the device reader . On establishing a secure communication channel between the mobile device and the terminal reader the terminal reader requests the list of available applications from the secure element . A directory is first displayed after which based on the set priority or the type of device reader an application is chosen and initiated for the transaction.

In certain exemplary embodiments the network devices including devices and include an HTML5 compliant or other web server. HTML5 compliant web servers include a cross document messaging application programming interface API and a local storage API that previous HTML versions did not have. The cross document messaging API of HTML5 compliant web servers enable documents such as websites to communicate with each other. For example a first document can send a message to a second document requesting information. In response the second document can send a message including the requested information to the first document. The local storage API of HTML5 compliant web browsers enables the web browser to store information on a client device upon which the web browser is installed or is executing. Websites can employ the local storage API to store information on a client device. Other web browsers have cross document messaging and or local storage capabilities also may be used in certain exemplary embodiments.

In an exemplary embodiment the proxy card looks and or functions in the same manner as a standard credit or debit card. For example the proxy card may have the user s name and or account number listed on the front of the card . An exemplary proxy card can include a magnetic stripe encoding the user s payment system account information. In an exemplary embodiment the account information encoded in the magnetic stripe routes payment requests to the payment system for processing.

In an alternative exemplary embodiment the proxy card is not a physical card. Instead the proxy card is an account accessible by a wireless tap of a mobile device an account identification number a bar code or QR code a token or other form of account identification or access which may be entered manually into the term POS terminal or terminal reader or which may be captured by the terminal reader . The proxy card as discussed throughout the specification refers to a physical card as well as the proxy account.

The user may use the mobile device or other network device to register the proxy card and or access the user s payment system account. The mobile device may comprise appropriate technology that includes or is coupled to a web server for example Google Chrome Microsoft Internet Explorer Netscape Safari Firefox or other suitable application for interacting with web page files .

The payment system includes a data storage unit accessible by the processing module . The exemplary data storage unit can include one or more tangible computer readable storage devices.

The user can use the web server to view register download upload or otherwise access the payment system via a website not illustrated and a communication network not illustrated . The user associates one or more registered financial card accounts including bank account debit cards credit cards gift cards loyalty cards coupons offers prepaid offers store rewards cards or other type of financial account that can be used to make a purchase or redeem value added services with the proxy card . The registered financial card accounts may have multiple issuers that maintain each financial account. The payment system also may function as the issuer for the associated financial account. The user s registration information is saved in the payment system s data storage unit and is accessible the by the processing module . The registration of a user proxy card is discussed in more detail hereinafter with reference to the methods described in .

The user also may use the web server to define proxy card payment rules. The creation of proxy card payment rules is discussed in more detail hereinafter with reference to the methods described in .

The merchant may use a web server not illustrated to view download upload create offers or otherwise access the payment system via a website not illustrated and a communication network not illustrated .

The user may request a purchase from the merchant . In an exemplary embodiment the purchase is initiated by swiping the proxy card at the POS terminal . In an alternative exemplary embodiment the purchase is initiated by a wireless tap of the mobile device with the terminal reader . In an alternative exemplary embodiment the purchase is initiated when the user enters an account identification number at the POS terminal or in the mobile device . The account identification number may be the proxy card account number or a different number that links the payment transaction to the proxy card account. In yet another alternative exemplary embodiment the purchase is initiated by use of a permanent temporary virtual physical token QR code bar code or other suitable machine readable medium captured by the terminal reader . The merchant s POS terminal interacts with the acquirer for example Chase PaymentTech or other third party payment processing companies the card network for example VISA MasterCard American Express Discover or other card processing networks the payment system and the issuer for example Citibank CapitalOne Bank of America and other financial institutions to authorize payment . The processing of proxy card payments is discussed in more detail hereinafter with reference to the methods described in .

In block the payment system issues a proxy card to the user . In an exemplary embodiment the user creates requests a proxy card using a web server and the proxy card is mailed to the user . The user may be issued an account number to be used for transactions via the Internet before a physical card is received. In an alternative exemplary embodiment the payment system mails an inactivated proxy card to the user . The proxy card is then activated by the user before use. In an alternative exemplary embodiment a physical proxy card is not issued. The proxy card account information is stored in the mobile device and is used to make a payment via a NFC Bluetooth Wi Fi or other form of wireless tap of the mobile device with the terminal reader . In an alternative exemplary embodiment the purchase is initiated when the user enters an account identification number at the POS terminal or in the mobile device . The account identification number may be the proxy card account number or a different number that links the payment transaction to the proxy card account. In yet another alternative exemplary embodiment the purchase is initiated by use of a permanent temporary virtual physical token QR code bar code or other suitable machine readable medium that is read by the POS terminal . In these cases the POS terminal may comprise a scanner camera or other reading device that captures the proxy account information such as a bar code or QR reader or other suitable reading device. The proxy account information may be printed in paper or other form.

In block the user creates a new payment system account or links the proxy card to an existing payment system account. The payment system also may create or update a digital wallet application account on the mobile device .

In block the user activates the proxy card and associates one or more financial card accounts for example debit cards credit cards gift cards stored value cards loyalty cards reward cards coupons prepaid or other offers and other accounts used to make a purchase or redeem value added services with the proxy card account. In an exemplary embodiment the user associates multiple financial card accounts with the proxy card account. The user may perform this block by inputting identifying information for each financial card account.

In an exemplary embodiment one or more financial card account s are maintained by the payment system and other issuers . In an alternative exemplary embodiment the payment system maintains one or more of the financial card accounts and acts as the issuer for that financial card account. In another exemplary embodiment the financial card accounts are maintained by more than one issuer including the payment system .

The user may define payment rules to be followed when processing a payment using the proxy card in block . The method for defining the proxy card rules is described in more detail hereinafter with reference to the methods described in .

In block the payment system sets forth the default payment rules associated with the proxy card account. Blocks through describe the exemplary default payment rules. In an alternative exemplary embodiment the exemplary default rules may appear in any order. In another exemplary embodiment one or more of the exemplary default rules may not be used if additional funds are not required. For example if after the application of a stored value account further funds are not required to complete the purchase the payment transaction will be fully authorized without following further rules.

Blocks depict an exemplary rule flow. In an exemplary embodiment offers and value added services are applied first. In block the payment system will determine if the user has any coupons vouchers prepaid or other redemption offers or other forms of value added services associated with the proxy card first.

If the payment system determines that the user has a value added service available it will apply those financial accounts first in block . In an exemplary embodiment the payment system will have a pre defined order in which it looks for and applies the various forms of value added services. For example the payment system may apply vouchers first then coupons then redemption offers and finally any other form of registered value added service.

If the payment system determines that the user does not have a value added service available it will proceed to block .

In an exemplary embodiment loyalty cards are applied second. In block the payment system will determine if the user has a loyalty card reward card or other form of store value card associated with the proxy card . In an alternative exemplary embodiment the payment system may apply loyalty cards before other forms of value added services.

If the payment system determines that the user has a loyalty card available it will apply that financial account. In an exemplary embodiment the payment system will determine if multiple loyalty cards are available and apply each financial account.

If the payment system determines that the user does not have a loyalty card available it will proceed to block .

In an exemplary embodiment stored value accounts are applied third. In block the payment system will determine if the user has a stored value account including gift cards prepaid cards re loadable transaction cards exchange cards and other forms of non credit based value cards associated with the proxy card .

If the payment system determines that the user has a stored value card available it will apply that financial account. In an exemplary embodiment the payment system will determine if multiple stored value accounts are available and apply each financial account.

If the payment system determines that the user does not have a stored value card available it will proceed to block .

In an exemplary embodiment debit and credit cards are applied last. In block the payment system will determine if the user has a debit card credit card or other form of credit based account associated with the proxy card .

If the payment system determines that the user has a debit credit card available it will apply that financial account.

If the payment system determines that the user does not have a debit credit card available the transaction will end.

In an exemplary embodiment the default static payment rules may be presented in any order. In an alternative exemplary embodiment the payment system may add delete or otherwise change any of the default static payment rules.

The user also may configure payment rules. In block the user may add delete or otherwise change any of the default static payment rules. In an exemplary embodiment the user also may change the order of the rules.

In an exemplary embodiment the user may define or select additional static payment rules. The user may define payment rules based on the type of or name of the merchant for example if the merchant is a restaurant use the A credit cards first or use the frequent flyer credit card if the merchant is an airline the time of day or day of the week for example use the restaurant loyalty card first for lunches over 5 or use the business credit card for weekday expenses between the hours of 9 am and 5 pm or the location or currency used by the merchant for example use credit card X for all European transactions or use credit card Z for all online transactions . The user may define conditional rules. For example if the transaction is under 5 at B coffee shop use the Y gift card.

In addition to the rules discussed with reference to the payment system also can learn rules for application of a financial account. For example if the user applies a particular financial account to a particular merchant or type of merchant and the user repeats that process for a predetermined number of times or time period then the payment system can create a rule to apply that particular financial account whenever the proxy card is used at the particular merchant or type of merchant. The payment system can log the user s past use of particular financial accounts with regard to particular merchants or types of merchants. Then when such logging determines that the user consistently applies the same financial account with the same merchant or type of merchant the payment system establishes a new rule for such use. In an exemplary embodiment the payment system can identify the user s past application of a particular financial account based on the user s rule setting in the payment system within a predetermined time of application of the user s proxy card at the particular merchant or type of merchant. The payment system may insert the learned rules into the appropriate order of payment rules. For example if the learned payment rule applies to a credit or debit card then the learned payment rule is inserted prior to the standard rule for applying credit or debit cards. A similar insertion process applies to offers loyalty cards and stored value cards.

In an exemplary embodiment the user can access the payment system account via the mobile device and can add delete or modify the static rules at any time. In an exemplary embodiment the user can access the payment system account and override the static rules on a one time or multiple time basis without permanently changing the static rules. In an alternative exemplary embodiment the user can use a mobile device application to add delete or modify the static rules using the user interface at the time payment is made.

Returning to in block the payment system sends the user proxy card account identification information to the network .

In block the network stores the proxy card account identification information. In an alternative exemplary embodiment the account number identifies the payment system as the issuer and payments are automatically routed from the network to the payment system for approval.

In block the user optionally modifies the static rules defined in block . In an exemplary embodiment the mobile device is used to temporarily add modify delete one or more static rules before a purchase is made using the proxy card . In an alternative exemplary embodiment the terminal reader and or POS terminal is used to temporarily add modify delete one or more static rules before a purchase is made using the proxy card .

The user applies the proxy card to a transaction with the merchant in block . In an exemplary embodiment the user swipes the proxy card at the POS terminal to pay for a transaction with the merchant . Alternatively the user may present a printed bar code QR code or other machine readable indicia of the proxy card information for capture by the terminal reader .

In an alternative exemplary embodiment the user using the mobile device to initiate a contactless tap with the terminal reader . In operation of an NFC transaction a user taps a mobile device such as an NFC enabled mobile phone to a terminal reader of a point of sale system. The terminal reader recognizes the NFC enabled device when the device is moved within range of the reader establishes a secure communication channel with the device and initiates a payment transaction between the reader and the device .

In alternative exemplary embodiment the user completes an online purchase via the Internet. The user can browse the merchant s website for products using a web server and indicate a desire to purchase one or more products. After the user has indicated a desire to purchase the product s for example by actuating a checkout link the merchant s website can present a user interface in the form of a webpage to receive payment information from the user . The user enters the proxy card information to complete the purchase upon checkout.

In another alternative exemplary embodiment the digital wallet application can interact with a website of the merchant and with the user . The merchant s website can detect whether the mobile device includes a digital wallet application and attach to user s digital wallet. Once attached the merchant s website can send a purchase request message to the digital wallet application requesting payment information. In response to receiving a purchase request message from the merchant s website the digital wallet application can present the user with a user interface for the user to confirm the purchase using proxy card information saved in the digital wallet application .

In block the POS terminal generates a payment request message to request payment using the proxy account and the merchant system optionally adds product identification information to the payment request message generated by application of the proxy card to the transaction. In an exemplary embodiment the product identification information comprises the SKU number s of the products sought in the user merchant transaction. In alternative exemplary embodiments the product identification information can comprise any suitable information that uniquely identifies a product. For example the product identification information can include Global Trade Item Numbers GTINs such as International Standard Book Numbers ISBNs Universal Product Codes UPCs European Article Numbers EANs Japanese Article Numbers JANs brand name and model number combinations and other standard identifiers. In an alternative exemplary embodiment the product identification information includes a broad grouping of product service identification for example the category of goods services sought .

In an exemplary embodiment the product identification information is inserted in an empty track of the magnetic stripe information obtained from the proxy card . Traditionally at least one track on the magnetic stripe of a financial card remains unused. Since the payment system functions as the issuer of the proxy card the magnetic stripe can be formatted to contain variable information in addition to the account information traditionally stored on tracks 1 and 2 of the magnetic stripe. The proxy card may be formatted to have one or more additional tracks wherein information can be transmitted between the merchant and the payment system . In an exemplary embodiment the merchant adds product identification information to an empty track in the payment request message to enable the application of product specific value added services to the current transaction such as coupons prepaid and other offers and loyalty rewards programs. In an alternative exemplary embodiment the product level identification information can be used to provide the user with product specific coupons and offers to be used in a later transaction.

In block the merchant submits the payment request to the acquirer . In an exemplary embodiment the merchant s POS terminal submits the request to the acquirer via a network not illustrated . In an alternative exemplary embodiment the merchant s website submits a request to the acquirer .

In block the card network determines whether the account number used to pay for the transaction is a classic card number. In an exemplary embodiment the card network automatically makes this determination using a series of numbers or routing information in the proxy card account information. In an alternative exemplary embodiment the card network reviews a list of saved account identification information provided to the card network by the payment system above.

If the card number is a classic card number the payment is processed according to traditional payment processing methods in block .

If the card number is not a classic card number the issuer is the payment system for example if the proxy card was used for the transaction . The card network then forwards the payment request to the payment system in block .

In an alternative exemplary embodiment the card number can comprise an identifier that corresponds to the list of saved account identification information such as a block of numbers or other indicia which identifies the issuer or the payment system. Based on this identifier the payment is processed according to traditional payment processing methods in block if the identifier corresponds to a conventional issuer or the payment is forwarded to the payment system in block if the identifier corresponds to the payment system .

In block the payment system optionally reads the product identification inserted into the payment request. In an exemplary embodiment the product identification information was inserted by the merchant above. In an exemplary embodiment the product identification information is used to determine which value added services can be applied to the current transaction. In an alternative exemplary embodiment the product identification information is used to determine which offers can be provided to the user for future transactions.

In block the payment system accesses the user s proxy card account. The method for accessing a user s proxy card account is described in more detail hereinafter with reference to the methods described in .

The payment system identifies the user account associated with the proxy card in block . In an exemplary embodiment the user s account contains the static rules defined by the user or the default rules if the user has not modified the default rules any modifications made to the static rules prior to the transaction and the associated financial accounts. In an exemplary embodiment the payment system uses the account information to determine how to proceed with the transaction.

In block the payment system determines if the user has defined payment rules. In an exemplary embodiment the user has defined static rules and or modified the rules prior to the transaction.

If the user has defined payment rules the payment system applies the user defined rules first to determine the order to apply the financial accounts to the transaction in block . In an exemplary embodiment the payment system applies the rules modified by the user prior to the transaction first and the user defined static rules second. In an alternative exemplary embodiment the user did not modify the rules prior to the transaction. In this embodiment the payment system applies the user defined static rules first.

In block the payment system determines whether the transaction will be declined based on a user defined rule. For example if the user defined a rule wherein no more than five transactions may occur in a single day and this is the user s six transaction the payment system will determine that the transaction will be declined. If the transaction will be declined the method continues to block . Other rules that can cause a request to be declined include fraud protection rules. For example the payment system may decline a payment request if the transaction occurs outside of the user s typical geographic area or if activity on the user s account has exceeded a payment system defined amount or number of transactions. Such fraud protection rules can be included in the default static rules or the user defined rules or a combination thereof.

If the user has not defined payment rules the payment system proceeds to block . In block the payment system applies the default static payment rules to the transaction.

In block the payment system determines whether the transaction will be declined based on a default static rule. For example if the user registered only gift cards with the payment system and additional funds are required the payment system will determine that the transaction will be declined. If the transaction will be declined the method continues to block .

Returning to in block the payment system determines if the user has any coupons vouchers prepaid offers redemption offers loyalty rewards cards or other forms of value added services associated with the proxy card .

If the payment system determines that the user has a value added service available it will apply those financial accounts first in block . In an exemplary embodiment the payment system will have a pre defined order in which it looks for and applies the various forms of value added services. For example the payment system may apply vouchers first then coupons then redemption offers and finally any other form of registered value added service. The method for processing value added services is described in more detail hereinafter with reference to the methods described in .

In block the user associates value added service accounts with the proxy card . In an exemplary embodiment this step is completed during the registration process described in . In an alternative exemplary embodiment the user adds value added service accounts including coupons loyalty cards reward cards offers including prepaid offers discounts and other forms of value added services to the proxy card account at any time before the transaction.

The merchant optionally submits value added service discounts to the payment system in block . In an exemplary embodiment the merchant Alternatively or additionally manufacturers can notify the payment system of discounts coupons and other forms of value added services for particular products prior to the payment request. The payment system can search the data storage unit for stored or received merchant and or manufacturer value added services in connection with block discussed hereinafter.

In block the payment system reads the user identification information form the payment request. In an exemplary embodiment the user identification information is contained in or encoded by the proxy card account identifier.

The payment system reads the merchant identification information from the payment request in block . In an exemplary embodiment the merchant identification information is contained in or encoded by the payment request.

In block the payment system reads the product identification information from the payment request. In an exemplary embodiment the product identification information is the SKU information inserted into the payment request by the merchant . In an alternative exemplary embodiment the product identification information is a description of the type of goods services sought.

The payment system accesses the user s value added services associated with the proxy card in block .

In block the payment system determines which value added services to apply and or the order to apply the value added services. In an exemplary embodiment the order is defined by the user defined static rules the user defined modified rules or the default static rules. In an alternative exemplary embodiment the user can define rules to be applied to specific value added services. For example the user can specify when to use a coupon or redeem an offer. These rule include but are not limited to a purchase threshold for example receive 10 off a single purchase of more than 50 from merchant an aggregate purchase threshold for example receive 10 off next purchase from merchant after the accumulated purchase at merchant has reached 1000 a minimum number of purchases from the merchant for example receive 10 off your tenth purchase from the merchant a time restriction for example receive 10 off a lunch time purchase and or a location restriction for example receive 10 off a purchase at a specified merchant location.

In block the payment system determines whether the user has a saved offer for the transaction. In an exemplary embodiment a saved offer can include but is not limited to a coupon a voucher a store reward a redemption or other form of saved offer.

If the user has a saved offer for the transaction that meets the rules specified by the user and rules specified for the offer the payment system applies the offer in block . In an exemplary embodiment the payment system functions as the issuer for the offer and can adjust the purchase price of the transaction after the offer s is applied.

In an exemplary embodiment blocks and also comprise searching for value added services provided by the merchant or a manufacturer that can be applied to the purchase transaction based on the identity of the merchant or specific products in the purchase transaction.

If the user has a loyalty card for the transaction the payment system applies the loyalty card in block . In an exemplary embodiment the payment system functions as the issuer for the loyalty card and can adjust the purchase price of the transaction after the loyalty card is applied. In an alternative exemplary embodiment the loyalty card is applied before the offer s is applied.

Returning to in block the payment system will determine if the user has a stored value account including gift cards prepaid cards re loadable transaction cards exchange cards and other forms of non credit based value cards associated with the proxy card .

If the payment system determines in block that the user does not have a value added service available the method will proceed directly to block .

If the payment system determines that the user has a stored value card available it will apply that financial account in block . In an exemplary embodiment the payment system will determine if multiple stored value accounts are available and apply each financial account. In an exemplary embodiment the payment system functions as the issuer for the stored value account and can adjust the purchase price of the transaction after the stored value account is applied. In an alternative exemplary embodiment the payment system will forward a new payment request to the issuer that maintains the stored value account and receive the authorization from the issuer if the transaction is approved.

In block the payment system will determine if additional funds are required for the transaction. In an exemplary embodiment the payment system will adjust the purchase price of the transaction after the value added services and stored value accounts are applied to determine if additional funds are required. In an alternative exemplary embodiment the payment system will determine if additional funds are required after applying only the value added services or stored value account as defined by the rules. In another alternative exemplary embodiment value added services and stored value accounts are not applied to the transaction and the payment system will automatically proceed to block .

If the payment system determines in block that the user does not have a stored value card available the method will proceed to block .

If additional funds are not required in block for the transaction the payment system will authorize the transaction in block . The method will then proceed to block .

If additional funds are required in block for the transaction the payment system will determine in block the issuer of the account s to be used to finance the remainder of the transaction. In an exemplary embodiment the payment system will determine if the user has a debit card credit card or other form of credit based account associated with the proxy card in block . The payment system will apply the rules to select one or more credit debit card to the transaction. In an exemplary embodiment the payment system will determine a single account to be used for the remainder of the transaction. In an alternative exemplary embodiment the payment system will determine that multiple accounts will be used for the remainder of the transaction.

If the payment system is the issuer of the account in block the payment system will approve or deny the account transaction. In an exemplary embodiment the payment system will determine whether sufficient funds are available and or whether the transaction meets the rules for the financial account s used to complete the transaction.

If the payment system is not the issuer of the financial account s the payment system sends a new payment request to each issuer etc. via the card network in block . In an exemplary embodiment the new payment request is for the remaining transaction balance after applying the value added services stored value account and or any other financial account maintained by a different issuer .

If the payment system is not the issuer that maintains the financial account see block FIG. the issuer notifies the payment system of the declined transaction via the card network in block .

In block the payment system receives the notification of the declined transaction from the issuer via the card network .

The payment system determines the reason the transaction was declined in block . If the payment system is the issuer that maintains the financial account see block or blocks and the transaction was declined the payment system determines the reason the transaction was declined.

In block the payment system determines whether the transaction was declined because the transaction did not meet one or more user defined or other user overrideable rules.

If the transaction does not meet the user defined rules the payment system communicates a real time override request to the user in block . In an exemplary embodiment the override request is communicated to the user s mobile device . In an exemplary embodiment the user is prompted to override the user defined rule using the user interface of the mobile device .

In block the user responds to the override request using the user interface of the mobile device . In an exemplary embodiment the mobile device communicates the override request and initiates an interaction with the user to present options available for selection. In an exemplary embodiment the application is engaged and processes the override request received from the payment system to present the information via the user interface . The application may create a list of options available to the user based on the information received from the payment system and the information stored in the application . In another exemplary embodiment the application creates a series of prompts requesting user choices for the available options. In an exemplary embodiment a user response is optional.

If the user does not authorize an override of the rules in block the transaction is declined and ends.

If the user authorizes the override the mobile device communicates the override authorization to the payment system in block .

If the payment system is the issuer of the financial account the payment system authorizes the transaction in block . The method then proceeds to block .

If the payment system is not the issuer of the financial account the payment system sends a new payment request to the issuer s via the card network in block . The method then proceeds to block .

If the transaction is declined but meets the user defined rules see block FIG. the methods proceeds to block .

If the transaction was terminated for insufficient funds the payment system communicates a request to the user to override the rules and select a different financial account in block . In an exemplary embodiment the request is communicated to the user s mobile device . In an exemplary embodiment the user is prompted to select a new account using the user interface of the mobile device .

In block the user responds to the request using the user interface of the mobile device . In an exemplary embodiment the mobile device communicates the request and initiates an interaction with the user to present options available for selection. In an exemplary embodiment the application is engaged and processes the request received from the payment system to present the information via the user interface . The application may create a list of options available to the user based on the information received from the payment system and the information stored in the application . In another exemplary embodiment the application creates a series of prompts requesting user choices for the available options. In an exemplary embodiment a user response is optional.

If the user does not select a different financial account in block the transaction is declined and ends.

If the user selects a different financial account the mobile device communicates the selection to the payment system in block .

If the payment system is the issuer of the financial account the payment system authorizes the transaction in block . The method then proceeds to block .

If the payment system is not the issuer of the financial account the payment system sends a new payment request to the issuer s via the card network in block . The method then proceeds to block .

In exemplary embodiments the real time authorization provided by the method can be performed in conjunction with or instead of declining the payment request. For example if the payment system determines to decline a payment request or receives a payment request denial from an issuer the payment system communicate a notice of declination to the merchant system . After the user submits an authorization to override a rule a confirmation that the user is making the purchase even though fraud protection rules identified the transaction as possible fraud or a selection of a different financial account the user may immediately reinitiate the payment transaction with the merchant by using the proxy card again. This time upon receipt of the payment request the payment system will approve the payment request or process the payment request using the specified financial account . Alternatively the payment system can communicate the notice message to the user wait for a response and authorize or further process the payment request after receiving the user s response without issuing a notice of declination to the merchant system .

Referring back to if the transaction is approved the issuer sends an authorization message to the payment system via the card network in block . If the payment system is the issuer of the financial account see block the payment system notes the authorization of the transaction.

In block the payment system generated an authorization message and optionally adds user identification information to the authorization message. In an exemplary embodiment the user identification information may include an e mail address physical address phone number name store loyalty number or other form of identifying information. In an exemplary embodiment the user s identifying information may be used by the merchant to send offers coupons vouchers advertisements or other forms redemption offers to the user .

In block the payment system sends offers to the user to be used on a future transaction. The method sending offers is described in more detail hereinafter with reference to the methods described in .

In block the merchant submits offers to the payment system . In an exemplary embodiment the merchant submits offers designed to promote return customers. For example the merchant may submit an offer for a percentage off the user s next transaction. In an alternative exemplary embodiment the merchant submits offers based on the products services purchased in the transaction. For example the merchant may submit an offer for a reduced price on the same or related product to be redeemed on the next visit. In an exemplary embodiment the offers are submitted in advance of the transaction and stored by the payment system in the data storage unit .

The payment system reads the product identification information inserted by the merchant in the payment request in block . In an exemplary embodiment the product identification information is the product service SKU number.

In block the payment system matches the merchant identification information and the product identification information to determine whether one or more offer can be sent to the user . In an exemplary embodiment the offers were submitted by the merchant in block . In an alternative exemplary embodiment the offers are generalized offers based on the product identification information for example manufacturer s coupons .

The payment system sends the user one or more offers in block . In an exemplary embodiment the offers are saved in the user s payment system account and are associated with the proxy card . In an exemplary embodiment the notification of the offers is communicated to the user via the mobile device e mail SMS text message or other form of communication methods designated by the user . In an alternative exemplary embodiment the offers are sent via a communication method designated by the user .

Returning to in block the payment system forwards a transaction authorization message to the card network .

In block the merchant system optionally reads the user identification information inserted in the payment authorization message by the payment system . In an exemplary embodiment the merchant POS terminal is able to extract the user information from the authorization message and store the information for later use. For example the merchant may use the identification information to contact the user for survey information to forward loyalty card information or to forward other offers to the user . In an alternative exemplary embodiment the user identification information can be provided in the proxy card account information stored on the magnetic stripe of the proxy card or otherwise associated with the proxy card account identifier. In this case the terminal reader reads the user information when collecting the initial information from the proxy card .

After use of each financial account for a particular payment request the payment system updates the used financial account for the user s proxy card in the data storage unit . For example if a single use coupon prepaid or other offer or loyalty card is applied the account is updated to note use of the item and that further use is not allowed. If a stored value card is used the account is updated to note the amount used and any remaining amount that is available. If a debit or credit card is used the account is updated to show the amount available and the remaining amount that is available. The payment system also can increment or decrement loyalty cards or reward cards provided by the merchant allowing the loyalty or other rewards to accumulate for future use.

Users may be allowed to limit or otherwise affect the operation of the features disclosed herein. For example users may be given opportunities to opt in or opt out of the collection or use of certain data or the activation of certain features. In addition users may be given the opportunity to change the manner in which the features are employed including for situations in which users may have concerns regarding privacy. Instructions also may be provided to users to notify them regarding policies about the use of information including personally identifiable information and manners in which each user may affect such use of information. Thus information can be used to benefit a user if desired through receipt of relevant advertisements offers or other information without risking disclosure of personal information or the user s identity.

One or more aspects of the exemplary embodiments may include a computer program that embodies the functions described and illustrated herein wherein the computer program is implemented in a computer system that comprises instructions stored in a machine readable medium and a processor that executes the instructions. However it should be apparent that there could be many different ways of implementing the exemplary embodiments in computer programming and the exemplary embodiments should not be construed as limited to any one set of computer program instructions. Further a skilled programmer would be able to write such a computer program to implement an embodiment based on the appended flow charts and associated description in the application text. Therefore disclosure of a particular set of program code instructions is not considered necessary for an adequate understanding of how to make and use the exemplary embodiments. Moreover any reference to an act being performed by a computer should not be construed as being performed by a single computer as more than one computer may perform the act.

The exemplary systems methods and blocks described in the embodiments presented previously are illustrative and in alternative embodiments certain blocks can be performed in a different order in parallel with one another omitted entirely and or combined between different exemplary methods and or certain additional blocks can be performed without departing from the scope and spirit of the invention. Accordingly such alternative embodiments are included in the invention described herein.

The invention can be used with computer hardware and software that performs the methods and processing functions described above. As will be appreciated by those having ordinary skill in the art the systems methods and procedures described herein can be embodied in a programmable computer computer executable software or digital circuitry. The software can be stored on computer readable media. For example computer readable media can include a floppy disk RAM ROM hard disk removable media flash memory memory stick optical media magneto optical media CD ROM etc. Digital circuitry can include integrated circuits gate arrays building block logic field programmable gate arrays FPGA etc.

Although specific embodiments of the invention have been described above in detail the description is merely for purposes of illustration. Various modifications of and equivalent blocks and components corresponding to the disclosed aspects of the exemplary embodiments in addition to those described above can be made by those having ordinary skill in the art without departing from the spirit and scope of the invention defined in the following claims the scope of which is to be accorded the broadest interpretation so as to encompass such modifications and equivalent structures.

