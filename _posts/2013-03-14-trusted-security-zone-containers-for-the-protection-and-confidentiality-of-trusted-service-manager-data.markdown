---

title: Trusted security zone containers for the protection and confidentiality of trusted service manager data
abstract: Embodiments relate generally to systems and methods for providing access to a trusted security zone container within a trusted security zone of a mobile device. An application may receive trusted service manager validation data from a trusted service manager. The application may also receive a trusted security zone master key, wherein the trusted security zone master key provides access to a plurality of trusted security zone containers within the trusted security zone. The application may hash the trusted service manager validation data with the trusted security zone master key. The application may generate the trusted security zone sub key based on hashing to access one or more containers. One or more signal may be transmitted to provision the set of one or more trusted security zone containers with the trusted security zone sub key. The application may provide the sub key to the trusted service manager to access a container.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09049013&OS=09049013&RS=09049013
owner: Sprint Communications Company L.P.
number: 09049013
owner_city: Overland Park
owner_country: US
publication_date: 20130314
---
Electronic communications may carry a wide variety of content for example media files electronic mail medical records financial transactions and other confidential information. The electronic communications may travel for some of the communication end to end path over unsecured communication links where the content may be subject to tampering or intrusion. A variety of security measures have been applied to provide increased security and to raise the level of difficulty for nefarious actors attempting to access the confidential information.

A method for providing access to a trusted security zone container within a trusted security zone is disclosed. The method comprises receiving by an application trusted service manager validation data from a trusted service manager wherein the trusted service manager validation data is associated with the trusted service manager. The method further comprises receiving by the application a trusted security zone master key wherein the trusted security zone master key provides access to a plurality of trusted security zone containers within the trusted security zone. The method also comprises hashing by the application the trusted service manager validation data with the trusted security zone master key to generate a trusted security zone sub key configured to provide access to a set of one or more trusted security zone containers of the plurality of trusted security zone containers wherein the hashing is completed using a one way secure hash function. The method comprises generating by the application the trusted security zone sub key based on hashing to access the set of one or more trusted security zone containers. The method further comprise transmitting one or more signals to provision the set of one or more trusted security zone containers with the trusted security zone sub key. The method also comprises providing by the application the trusted security zone sub key to the trusted service manager so that the trusted service manager may access the set of one or more trusted security zone containers.

A method for generating a trusted security zone sub key dedicated to a specific set of one or more trusted security zone containers within a trusted security zone is disclosed. The method comprises receiving by an application trusted service manager validation data from a trusted service manager wherein the trusted service manager validation data is generated by a master trusted service manager and associated with the trusted service manager. The method further comprises receiving by the application a trusted security zone master key wherein the trusted security zone master key provides access to a plurality of trusted security zone containers within the trusted security zone. The method also comprises generating by the application the trusted security zone sub key by hashing the trusted service manager validation data with the trusted security zone master key wherein the trusted service manager validation data directs the application to generate a trusted security zone sub key dedicated to the set of one or more trusted security zone containers of the plurality of trusted security zone containers and wherein the hashing is completed using a one way secure hash function.

A method for protecting data of two or more different trusted service managers stored in a trusted security zone is disclosed. The method comprises validating a first trusted service manager wherein validating the first trusted service manager comprises obtaining one or more service manager server credentials. The method further comprises providing a trusted security zone key to the first trusted service manager in response to validating the first trusted service manager wherein the first trusted service manager uses the trusted security zone key to access a first set of one or more trusted security zone containers. The method also comprises receiving by an application a second trusted service manager validation data associated with a second trusted service manager. The method comprises receiving by the application the trusted security zone master key wherein the trusted security zone master key provides access to a plurality of trusted security zone containers within the trusted security zone. The method further comprises hashing by the application the second trusted service manager validation data with the trusted security zone master key to generate a trusted security zone sub key configured to provide access to a second and different set of one or more trusted security zone containers of the plurality of trusted security zone containers wherein the hashing is completed using a one way secure hash function. The method also comprises generating by the application the trusted security zone sub key based on hashing to provide to the second trusted service manager access to the second set of one or more trusted security zone containers. The method comprises transmitting one or more signals to provision the second set of one or more trusted security zone containers with only the trusted security zone sub key so that first trusted service manager may not access the second set of one or more containers with the trusted security zone master key. The method further comprises providing by the application the trusted security zone sub key to the second trusted service manager so that the second trusted service manager may access the second set of one or more trusted security zone containers.

These and other features will be more clearly understood from the following detailed description taken in conjunction with the accompanying drawings and claims.

It should be understood at the outset that although illustrative implementations of one or more embodiments are illustrated below the disclosed systems and methods may be implemented using any number of techniques whether currently known or not yet in existence. The disclosure should in no way be limited to the illustrative implementations drawings and techniques illustrated below but may be modified within the scope of the appended claims along with their full scope of equivalents.

The use of trusted security zones gives a carrier e.g. master trusted service manager the opportunity to invite a trusted service manager e.g. a third party to store confidential information for example in a hand set serviced by the carrier. However when multiple trusted service managers desire to use the trust security zone to store and protect confidential information from entities operating externally to the trusted security zone the multiple trusted service managers may protect confidential information from entities operating externally to the trusted security zone. However the trusted service managers storing and protecting confidential information on the trusted security zone may expose their confidential information to each other. The present disclosure provides systems and methods which may allow multiple trusted service managers to store and protect confidential information from entities operating externally to the trusted security zone as well as other trusted service managers storing and protect confidential information within the trusted security zone. This may be accomplished by dividing the trusted security zone into containers which may be accessed only by the master trusted service manager e.g. Sprint and a specific trusted service manager e.g. a bank so that other trusted service managers e.g. a mortgage lender utilizing the trusted security zone may not view and or access the confidential information of the specific trusted service manager. Additionally the other trusted service managers may also prevent the specific trusted service manager from viewing and or accessing their confidential information as well.

The present disclosure provides systems and methods for providing access for multiple trusted service managers to a single trusted security zone on for example a mobile device. Multiple trusted service managers e.g. trusted server manager servers may be given access to a set of one or more containers within the trusted security zone. This may allow the trusted service managers to store data packages on the trusted security zone concealing and protecting the data packages from outside entities. Additionally this may allow the trusted service managers to conceal and or protect the data packages from other trusted service managers also storing data packages in the same trusted security zone but for example in different containers.

This may be accomplished by generating trusted service manager validation data from a master trusted service manager e.g. Sprint and presenting the validation data for example in the form of a token to a sub key generator application. A master trusted service manager may use one or more credentials from a service manager in order to validate the service manager as a trusted service manager before generating the token to be presented to the sub key generator application. A master key which provides access to every container within the trusted security zone may also be presented to the sub key generator application. Upon receiving both the token and the master key the sub key generator may hash both the token and master key to generate a trusted security zone sub key which may be used to provide access by a particular trusted service manager to a particular set of one or more unoccupied containers in the trusted security zone. For example the master key may be hashed with trusted service manager validation data for example user specific information or user input information to generate a sub key. The hashing may be completed using a one way secure cryptographic hash function for instance one of MD5 SHA 0 SHA 1 SHA 2 SHA 3 or other well known one way secure cryptographic hash functions. Hereinafter a one way secure cryptographic hash function may be referred to more concisely as a hash function or a hashing function. The use of a one way secure hash function may prevent the determination of the master key and or the sub key by outside entities and or other entities sharing the trusted security zone at large. The sub key may not be determined from the master key by a deterministic algorithm because of the hashing operation that employs not only the master key but also some information contributed by the user or specific to the user. Likewise the master key may not be determined from a sub key by a deterministic algorithm. Additionally a first sub key generated based on the master key may not be determined from a second sub key generated from the same master key by a deterministic algorithm.

The use of the sub key generator application may prevent the determination of a sub key intended for a second trusted service manager by a first trusted service manager who may be holding and issuing the master key to the sub key generator application because the first trusted service manager would never see the sub key. Additionally the use of the sub key generator application may prevent a second trusted service manager from determining the master key held and issued by for example a first trusted service manager because the master key is not shared with the second trusted service manager. Furthermore a master trusted service manager retains a master trusted service manager master key so that the master trusted service manager retains access to all containers within a trusted security zone both occupied and unoccupied.

The sub key generator application may be located on the mobile device or on a network server in communication with the mobile device. The sub key may be associated with one or more containers of a trusted security zone. The containers may be configured so that only a specific sub key may be used to access a set of one or more containers.

Throughout the lifespan of a mobile device it may be refurbished or reused and may be passed from one user to the next. For example a first user may wish to change devices such as for an upgrade and may surrender the first device back to the provider of the device. The provider may then refurbish the device so that it may be resold or reissued to a second user. The refurbish process may include returning the device to factory settings. In the case where the mobile device comprises a trusted security zone a second user may not be able to access the trusted security zone or applications executed in the trusted security zone because it would have already been personalized by the first user. The personalization process may include associating the trust zone master key with the first user of the device. Therefore it may be desired to alter the personalization process of the trusted security zone such that multiple users may be able to access and execute in the trusted security zone of a mobile device.

This may be accomplished by generating multiple user specific trust zone keys which may be used in place of the trust zone master key. For example the trust zone master key may be hashed with user specific information or user input information to generate a new user specific trust zone key. For example the trust zone master key and the user information may be used as seeds or other inputs to the execution of a hashing function or algorithm to generate the new user specific trust zone key. The hashing may be completed using a one way secure cryptographic hash function for instance one of MD5 SHA 0 SHA 1 SHA 2 SHA 3 or other well known one way secure cryptographic hash functions. Hereinafter a one way secure cryptographic hash function may be referred to more concisely as a hash function or a hashing function. The use of a one way secure hash function may prevent the determination of the trust zone master key and or the user specific key by outside entities. The user specific key may not be determined from the master key by a deterministic algorithm because of the hashing operation that employs not only the master key but also some information contributed by the user or specific to the user. Likewise the master key may not be determined from a user specific key by a deterministic algorithm. Additionally a first user specific key generated based on the master key may not be determined from a second user specific key generated from the same master key by a deterministic algorithm.

The user specific keys may be generated by an application on the mobile device or an application on a network server in communication with the mobile device. The user specific key may be associated with a user of the mobile device and may be used to verify the identity of the user and or mobile device when executing secure applications in the trusted security zone. Then if the device is returned to factory settings the personalization process may be repeated and a second user specific trust zone key may be generated and used by a second user of the mobile device.

A trusted security zone provides chipsets with a hardware root of trust a secure execution environment for applications and secure access to peripherals. A hardware root of trust means the chipset should only execute programs intended by the device manufacturer or vendor and resists software and physical attacks and therefore remains trusted to provide the intended level of security. The chipset architecture is designed to promote a programmable environment that allows the confidentiality and integrity of assets to be protected from specific attacks. Trusted security zone capabilities are becoming features in both wireless and fixed hardware architecture designs. Providing the trusted security zone in the main mobile device chipset and protecting the hardware root of trust removes the need for separate secure hardware to authenticate the device or user. To ensure the integrity of the applications requiring trusted data such as a mobile financial services application the trusted security zone also provides the secure execution environment where only trusted applications can operate safe from attacks. Security is further promoted by restricting access of non trusted applications to peripherals such as data inputs and data outputs while a trusted application is running in the secure execution environment. In an embodiment the trusted security zone may be conceptualized as hardware assisted security.

A complete trusted execution environment TEE may be implemented through the use of the trusted security zone hardware and software architecture. The trusted execution environment is an execution environment that is parallel to the execution environment of the main mobile device operating system. The trusted execution environment and or the trusted security zone may provide a base layer of functionality and or utilities for use of applications that may execute in the trusted security zone. For example in an embodiment trust tokens may be generated by the base layer of functionality and or utilities of the trusted execution environment and or trusted security zone for use in trusted end to end communication links to document a continuity of trust of the communications. Through standardization of application programming interfaces APIs the trusted execution environment becomes a place to which scalable deployment of secure services can be targeted. A device which has a chipset that has a trusted execution environment on it may exist in a trusted services environment where devices in the trusted services environment are trusted and protected against attacks. The trusted execution environment can be implemented on mobile phones and tablets as well as extending to other trusted devices such as personal computers servers sensors medical devices point of sale terminals industrial automation handheld terminals automotive etc.

The trusted security zone is implemented by partitioning all of the hardware and software resources of the mobile device into two partitions a secure partition and a normal partition. The secure partition may be implemented by a first physical processor and the normal partition may be implemented by a second physical processor. Alternatively the secure partition may be implemented by a first virtual processor and the normal partition may be implemented by a second virtual processor. Placing sensitive resources in the secure partition can protect against possible attacks on those resources. For example resources such as trusted software applications may run in the secure partition and have access to hardware peripherals such as a touchscreen or a secure location in memory. Less secure peripherals such as wireless radios may be disabled completely while the secure partition is being accessed while other peripherals may only be accessed from the secure partition. While the secure partition is being accessed through the trusted execution environment the main mobile operating system in the normal partition is suspended and applications in the normal partition are prevented from accessing the secure peripherals and data. This prevents corrupted applications or malware applications from breaking the trust of the device.

The trusted security zone is implemented by partitioning the hardware and software resources to exist in a secure subsystem which is not accessible to components outside the secure subsystem. The trusted security zone is built into the processor architecture at the time of manufacture through hardware logic present in the trusted security zone which enables a perimeter boundary between the secure partition and the normal partition. The trusted security zone may only be manipulated by those with the proper credential and in an embodiment may not be added to the chip after it is manufactured. Software architecture to support the secure partition may be provided through a dedicated secure kernel running trusted applications. Trusted applications are independent secure applications which can be accessed by normal applications through an application programming interface in the trusted execution environment on a chipset that utilizes the trusted security zone.

Turning now to a communication system is described. The system comprises a mobile communication device base transceiver stations BTS a network a master trusted service manager server a trusted security zone server and a plurality of trusted service manager servers . It is understood that the system may comprise any number of mobile devices any number of base transceiver stations and any number of trusted service manager servers . The network may comprise one or more public networks one or more private networks or a combination thereof.

The mobile device may comprise a radio transceiver a user interface a memory and a trusted security zone . The mobile device may be a mobile phone a personal digital assistant PDA a media player or other communication enabled mobile communication device. In an embodiment the mobile device may be implemented as a handset. Details of handsets are discussed further hereinafter.

The radio transceiver is configured to establish a wireless communication link with the BTS . The BTS may communicatively couple the radio transceiver and or the mobile device to the network and to devices that are connected to the network for example the trusted security zone server . In an embodiment the radio transceiver and the BTS establish a wireless communication link according to one of a code division multiple access CDMA wireless protocol a global system for mobile communication GSM wireless protocol a long term evolution LTE wireless protocol a worldwide interoperability for microwave access WiMAX wireless protocol or another wireless communication protocol.

The user interface of the mobile device may in some embodiments comprise a display an input system a speaker system and or a microphone. In some embodiments the display may comprise a screen and the input system may comprise a keypad and or a touch screen for example. The speaker system may communicate audio such as media messages or phone call audio to a user of the mobile device . The microphone may receive voice and or audio from a user and or communicate audio to a user. In an embodiment a user may utilize the user interface to communicate with the mobile device for example to initiate the execution of a device application and or a secure application. Additionally a user may receive communication from the mobile device via the user interface such as messages emails contact information caller identification call history internet access etc. A user may additionally employ the user interface for viewing and or listening to media such as music movies shows videos photos games etc.

The trusted security zone may store one or more data packages e.g. data logic instruction and or the like associated with at least one of the plurality of trusted service manager servers . In an embodiment the trusted security zone may be physical and or virtual partitioned sections of the memory . Additionally the trusted security zone may be a completely separate memory of the mobile device from memory . The trusted security zone may store a variety of applications that process and or transmit confidential information. The confidential information may comprise sensitive business documents such as electronic mail marketing literature business plans client lists addresses employee data intellectual property documents and the like. The confidential information may comprise personal medical records or medical data that are subject to privacy requirements enforced by government regulatory bodies or commercial standards. The confidential information may comprise financial information such as account numbers authentication identities account balance information and the like. The confidential information may comprise confidential secret and or top secret defense and or law enforcement information.

In an embodiment the trusted security zone may be provided in a secure area of a processor and or memory chip shared with a permissive sector such as memory or in a separate processor and or memory chip. The trusted security zone may be provided as what may be conceptualized as invisible space. In an embodiment at least some of the memory addresses occupied by the trusted security zone may be inaccessible to device applications executing out of the permissive sector. This demarcation of accessible memory addresses versus inaccessible memory addresses may be provided by the operating system of the mobile device . In an embodiment the trusted security zone may encapsulate a trusted execution environment TEE for example conforming at least partially to the Global Platform 2.0 or later revision trusted execution environment standard. It is understood however that the trusted security zone is contemplated to provide further functionality than that envisioned by the trusted execution environment standards.

The trusted security zone may comprise a plurality of trusted security zone containers hereinafter containers . The container may be a sectioned off space and or partition of the trusted security zone that isolates shields and or conceals one or more data packages stored in the container . A plurality of trusted service manager servers may store and or desire to store one or more data packages in a container on the trusted security zone . For example a first trusted service manager server may be currently storing one or more confidential data packages on the trusted security zone . Additionally a second trusted service manager server may desire storing one or more confidential data packages in the trusted security zone of the mobile device . Because the trusted security zone comprises a plurality of containers the first trusted service manager server can store one or more data packages in a first container of the trusted security zone while the second trusted service manager server can store one or more data packages in a second container of the trusted security zone . Furthermore because the first and second trusted service manager servers are storing data in different containers the first trusted service manager server may shield and or conceal its package s from the second trusted service manager server and conversely the second trusted service manager server may shield and or conceal its package s from the first trusted service manager server . The shielding and or concealing may be accomplished due to the characteristics of the trusted security zone and the individual containers of the trusted security zone . Thus both the first trusted service manager server and the second trusted service manager server may store confidential data packages in a trusted security zone of a mobile device and shield and or conceal the confidential data packages from entities for example nefarious entities outside the trusted security zone as well as each other. Additionally although the embodiment of depicts sixteen containers in the trusted security zone the trusted security zone may be sectioned into two or more containers .

As will be discussed further herein a master key may provide access to the trusted security zone so that a first trusted service manager may access all containers occupied by the first trusted service manager as well as all unoccupied containers in the trusted security zone . Additionally a sub key may provide access to the trusted security zone so that a second trusted service manager may access one or more containers assigned to the second trusted service manager . For purposes of this disclosure the terms occupied and unoccupied may indicate whether a trusted service manager server has stored one or more data packages in a container of the trusted security zone and or whether a trusted service manager server has been given access or permission to store one or more data packages in a particular container of the trusted security zone .

The system also comprises a master trusted service manager server . The master trusted service manager server has control and or access to each and every container of the trusted security zone . The master trusted security zone server may provide a master key to a first trusted service manager server and may also provide trusted service manager server validation data for example in the form of token validating one or more trusted service manager servers for access to a set of one or more containers in the trusted service zone . In an embodiment the master trusted service manager server may also retain its own master key for example a master trusted service manager master key which may provide access to all containers in a trusted security zone both occupied and unoccupied. For example even if the first trusted service manager server and the second trusted service manager server have confidential data packages stored in different containers of the trusted security zone concealing and or protecting the packages from each other and outside entities the master trusted manager server may access view and or remove e.g. delete any or all data packages stored in any one container using the master trusted service manager master key. Additionally the master trusted manager server may validate that a service manager server is a trusted service manager server . For example by examining one or more applications for incompatibility spy ware and or any other nefarious activities the master trusted service manager server may validate entire trusted service manager servers such that all application stored on the trusted security zone from a particular trusted service manager server are validated. The master trusted service manager server may also validate individual applications from trusted service manager servers for enhanced trust and or reassurance that all applications to be stored on the trusted security zone from a particular trusted service manager server are trusted. It should be understood that a multitude of service manager servers may be connected to a network such as network . A service manager server may not be permitted to store data packages in the trusted security zone without first being validated by the master trusted service manager server .

The master trusted service manager server may examine a series of credentials associated with a service manager server and issue trusted service manager validation data e.g. a token to the service manager server so that the service manager server is a trusted service manager server . The credentials may comprise trusted service manager server and or application compatibility one or more trusted service manager server identification codes a certification that the trusted service manager server produces data packages free from spy ware mal ware and or the like and the amount of memory space that trusted service manager server requires. Therefore in the event that a service manager server which is not trusted and or is trusted but does not receive a token from the master trusted service manager server validating that the trusted service manager server is a trusted service manager server then the trusted service manager server will be rejected and or denied a sub key and thus denied access to the trusted security zone if service manager server attempts to access the trusted security zone as will be discussed further herein. Additionally the master trusted service manager server may put a time limit or a limited number of attempts on the token so that if the token is used after a predetermined amount of time or predetermined number of attempts the holder of the token may not be able to obtain a sub key and or gain access to the trusted security zone . For example a master trusted service manager server may provide a token to a trusted service manager server . The token may be configured so that it expires after the first attempted access to obtain a sub key as well as after one day from receiving the token. Thus if a nefarious server and or application obtains the token the nefarious server and or application may be limited as to how and or when the token is used. In this embodiment the trusted service manager server may have to obtain a new token and thus a new sub key each time the trusted service manager server desires to access a set of one or more containers in the trusted security zone .

The trusted security zone server may comprise a processor a memory and a sub key generator application stored in the memory . The trusted security zone server may also comprise a plurality of processors located in a plurality of computers. Computers are discussed in more detail hereinafter. In an embodiment the master trusted service manager server may comprise the trusted security zone server such that the sub key generator application is stored on the master trusted service manager server . The sub key generator application may be configured to generate a sub key providing access such that a trusted service manager server may store one or more data packages in a particular set of one or more containers on the trusted security zone . For example the master trusted service manager server may provide a token to a first trusted service manager server validating the first trusted service manager server . The token may identify that the first trusted service manager server has been validated by the master trusted service manager server . The first trusted service manager server may present the token to the sub key generator showing the sub key generator that the first trusted service manager server has been validated. Upon receiving the token the sub key generator may generate a sub key providing access to a particular set of one or more containers in the trusted security zone . Generally the sub key generator may generate a sub key providing access to one or more unoccupied containers so that the first trusted service manager server does not expose data packages to other trusted service manager servers storing data packages in other containers on the trusted security zone . In an embodiment a trusted service manager server such as the first trusted service manager server may choose any unoccupied containers of the trusted security zone to store one or more data packages.

In an embodiment the sub key generator may generate a sub key after receiving both a token from a validated trusted service manager server and the master key. For example the master trusted service manager server may have previously provided the master key to a first trusted service manager server along with a set of one or more containers in the trusted security zone . Subsequently the master trusted service manager server may provide a token to a second trusted service manager server validating the second trusted service manager server . The token may identify that the second trusted service manager server has been validated by the master trusted service manager server . The second trusted service manager server may present the token to the sub key generator showing the sub key generator that the second trusted service manager server has been validated. Additionally the first trusted service manager server may present the master key to the sub key generator for example in response to the master trusted service manager server sending a signal to the first trusted service manager server that a token has been issued to the second trusted service manager server and or that the second trusted service manager server has presented a token to the sub key generator . In an embodiment the sub key generator may send a signal to the first trusted service manager server requesting the master key in response to receiving the token from the second trusted service manager server .

Upon receiving the token and the master key the sub key generator may hash the master key with the token for example user specific information or user input information to generate a sub key. For example the master key and the token may be used as seeds or inputs to a hashing function or algorithm to generate the sub key. The hashing may be completed using a one way secure cryptographic hash function for instance one of MD5 SHA 0 SHA 1 SHA 2 SHA 3 or other well known one way secure cryptographic hash functions. Hereinafter a one way secure cryptographic hash function may be referred to more concisely as a hash function or a hashing function. The use of a one way secure hash function may prevent the determination of the master key and or the sub key by outside entities. The sub key may not be determined from the master key by a deterministic algorithm because of the hashing operation that employs not only the master key but also some information contributed by the user or specific to the user. Likewise the master key may not be determined from a sub key by a deterministic algorithm. Additionally a first sub key generated based on the master key may not be determined from a second sub key generated from the same master key by a deterministic algorithm.

In an embodiment the sub key generator may also determine which trusted service manager servers occupy particular containers and assign unoccupied containers to a new trusted service manager server or a trusted service manager server which needs an additional set of one or more containers . Thus when the trusted service manager server presents a token to the sub key generator the sub key generator will make an inventory of which trusted service manager server are currently occupying which containers and determine which containers are unoccupied in order to generate a sub key configured to provide access to a particular set of one or more unoccupied containers for the trusted service manager server presenting the token. Alternatively the master trusted service manager server may determine which trusted service manager server occupy particular containers and assign unoccupied containers to a new trusted service manager server or a trusted service manager server which needs an additional set of one or more containers . For example when a trusted service manager server receives a token from the master trusted service manager server the master trusted service manager server may have previously performed an inventory of which trusted service manager server are currently occupying which containers and determines which containers are unoccupied so that token given to the trusted service manager server also contains information indicating that the sub key to be generated by the sub key generator will be configured specifically for a particular set of one or more containers . Thus when the trusted service manager server presents the token to the sub key generator the sub key generator may generate a sub key which provides access for the trusted service manager server only to the particular set of one or more containers .

In an embodiment the sub key generator and or the trusted security zone server may send one or more signals to the trusted security zone in order to configure and or provision the set of one or more containers assigned to the sub key of a trusted service manager server . For example upon receiving the token from a second trusted service manager server and the master key from a first trusted service manager server the sub key generator may transmit a signal to the set of one or more containers in the trusted security zone assigned to the second trusted service manager server . The signal may configure the set of one or more containers so that the sub key may allow the second trusted service manager server to access those containers . In an embodiment because the sub key may access the particular set of one or more containers assigned to the second trusted service manager server the master key held by the first trusted service manager server may no longer provide access to the container assigned to the second trusted service manager server .

Alternatively the master trusted service manager server may send one or more signals to the trusted security zone in order to configure and or provision the set of one or more containers assigned to the sub key of a trusted service manager server . For example the master trusted service manager server may determine which container s are to be assigned to a particular trusted service manager server such as the second trusted service manager server . Upon providing a token to the second trusted service manager server the master trusted service manager server may send one or more signals to the trusted security zone in order to configure and or provision the set of one or more containers assigned to the second trusted service manager server .

In addition to configuring and or provisioning the set of one or more containers to a sub key for a trusted service manager server the one or more signals may also provide a time limit or a limit on the number of attempts by which a trusted service manager server may access the set of one or more containers with the given sub key. For example master trusted service manager server may determine that a second trusted service manager server may access a set of one or more containers on the trusted security zone for exactly one year after obtaining a sub key. The master trusted service manager server server may send a signal provisioning the set of one or more containers designated for the second trusted service manager server which makes the containers compatible with a sub key for exactly one year. Once the time limit expires the master trusted service manager server and or the first trusted service manager server e.g. the trusted service manager server with the master key may reclaim the set of one or more containers and may delete access and or view for example all the data packages stored in that set of one or more containers. Additionally if the second trusted service manager server desires to extend the time limit past the year the second trusted service manager server may obtain another token from the master trusted service manager server server in order to obtain another sub key from the sub key generator . The same example may apply to limiting the number of access attempts.

The combination of the sub key generator and the plurality of containers in the trusted security zone allows a trusted service manager server to store and secure confidential data packages in a trusted security zone not only from outside entities but from other trusted service manager server also storing data packages the same trusted security zone . This is accomplished because a first trusted service manager server holding the master key never sees the sub key generated by the sub key generator . Thus the first trusted service manager server never knows how to access the set of one or more containers assigned to the second trusted service manager server . Additionally the second trusted service manager server holding the token at one time and the sub key at a different time never sees the master key given to the sub key generator from the first trusted service manager server . Thus the second trusted service manager server never knows how to access the set of one or more containers assigned to the first trusted service manager server or unoccupied by a trusted service manager server .

Then at block the method comprises that an application may receive a trusted security zone master key wherein the trusted security zone master key provides access to a plurality of trusted security zone containers within the trusted security zone . The trusted security zone master key may be given to the application from a first trusted service manager server or the master trusted service manager server . In an embodiment the plurality of trusted security zone containers may comprise all of the trusted security zone containers within the trusted security zone .

At block the method comprises that the application hashes the trusted service manager validation data with the trusted security zone master key to generate a trusted security zone sub key configured to provide access to a set of one or more trusted security zone containers of the plurality of trusted security zone containers wherein hashing is completed using a one way secure hash function. The hashing may generate a trusted security zone sub key specific to a particular set of one or more containers . At block the application may generate a trusted security zone sub key based on the hashing for example for the trusted service manager server to access the set of one or more trusted security zone containers .

At block one or more signals may be transmitted to the trusted security zone and or the set of one or more trusted security zone containers which are to be utilized by the trusted service manager server to provision and or configure the set of one or more containers with the trusted security zone sub key. In an embodiment the method may comprise transmitting one or more signals putting a time limit and or a limit on the number of attempts in order to limit access to the set of one or more trusted security zone containers using the sub key. Thus after a predetermined amount of time and or a predetermined number of attempts the trusted security zone sub key may no longer provide access to the set of one or more trusted security zone containers . At block the method may comprise that the applications provides the trusted security zone sub key to the trusted service manager server so that trusted service manager server may access the set of one or more trusted security zone containers . In an embodiment the method may further comprise that the trusted service manager server stores one or more confidential data packages in the one or more containers of the trusted security zone isolating shielding and or concealing the one or more confidential data package from applications outside the trusted security zone or other applications or trusted service manager server with access to the trusted security zone .

At block the method comprises receiving by the application a trusted security zone master key wherein the trusted security zone master key provides access to a plurality of trusted security zone containers within the trusted security zone . In an embodiment the trusted security zone master key may be held by a trusted service manager server which already has access to a set of one or more containers in the trusted security zone . Alternatively the master trusted service manager server may hold the trusted security zone master key such that when the trusted service manager server presents the validation data the application may receive the trusted security zone master key from the master trusted service manager server .

Then at block the method comprises generating by the application the trusted security zone sub key by hashing the trusted service manager validation data with the trusted security zone master key wherein the trusted service manager validation data directs the application to generate a trusted security zone sub key dedicated to the set of one or more trusted security zone containers of the plurality of trusted security zone containers and wherein the hashing is completed using a one way secure hash function.

At block the method comprises providing a trusted security zone key to the first trusted service manager server in response to validating the first trusted service manager server wherein the first trusted service manager server uses the trusted security zone key to access a first set of one or more trusted security zone containers . For example the master trusted service manager server may validate the first trusted service manager server after examining one or more credentials and in response to validating the first trusted service manager server the master trusted service manager server may provide a trusted security zone sub key generated by a sub key generator application stored on the master trusted service manager server to the first trusted service manager server . The master trusted service manager server may also send a signal to the trusted security zone configuring and or provisioning a first set of one or more containers with the trusted security zone sub key provided to the first trusted service manager server . In an embodiment the master trusted service manager server may provide a trusted security zone master key to the first trusted service manager server in response to validating the first trusted service manager server . Upon providing the trusted security zone master key to the first trusted service manager server the master trusted service manager server may send a signal to the trusted security zone to configure and or provision a first set of one or more containers for the first trusted service manager server .

In an embodiment an application stored in the trusted security zone server may provide the trusted security zone master key to the first trusted service manager server in response to the first trusted service manager server presenting validation data to the application. Initially the trusted security zone master key may be stored and protected in the sub key generator application associated with a particular trusted security zone . The master trusted service manager server may transmit a signal for example within the validation data instructing the sub key generator application to provide the trusted security zone master key to the first trusted service manager server when the first trusted service manager server presents the validation data to the sub key generator application . The master trusted service manager server may also send a configuration and or provisioning signal to the trusted security zone when the first trusted service manager server is validated or the sub key generator application may send a configuration and or provisioning signal to the trusted security zone when the sub key generator application provides the trusted security zone master key to the first trusted service manager server . Signals from the sub key generator application and or the master trusted service manager server may configure and or provision a first set of one or more containers with the first trusted service manager server .

In an embodiment an application stored in the trusted security zone server may provide a trusted security zone sub key to the first trusted service manager server in response to the first trusted service manager server presenting validation data to the sub key generator application . The trusted security zone master key may be stored and protected with the master trusted service manager server . When the first trusted service manager server or a subsequent trusted service manager server such as second trusted service manager server presents validation data to a sub key generator application the master trusted service manager server may receive a signal from the sub key generator application to present the trusted security zone master key to the sub key generator application . Upon receiving the signal the master trusted service manager server may also send a configuration and or provisioning signal to the trusted security zone when the first trusted service manager server is validated or the sub key generator application may send a configuration and or provisioning signal to the trusted security zone when the sub key generator application provides the trusted security zone sub key to the first trusted service manager server . Signals from the sub key generator application and or the master trusted service manager server may configure and or provision a first set of one or more containers with the first trusted service manager server . Signals from the sub key generator application and or the master trusted service manager server may configure and or provision subsequent sets of one or more containers with subsequent trusted service manager server .

At block the method comprises receiving by an application a second trusted service manager validation data associated with a second trusted service manager server . At block the method comprises receiving by the sub key generator application the trusted security zone master key wherein the trusted security zone master key provides access to a plurality of trusted security zone containers within the trusted security zone . In an embodiment as previously disclosed the application may receive the trusted security zone master key from the first trusted service manager server or the master trusted service manager server . At block the method comprises hashing by the application the second trusted service manager validation data with the trusted security zone master key to generate a trusted security zone sub key configured to provide access to a second and different set of one or more trusted security zone containers of the plurality of trusted security zone containers wherein the hashing is completed using a one way secure hash function.

In an embodiment the second trusted service manager server may unilaterally select which containers within the trusted security zone it wants to occupy. Alternatively the master trusted service manager server and or the sub key generator application may select which containers within the trusted security zone will be designated for the second trusted service manager server . It should be understood that the first trusted service manager server and the sub key generator application may only designate unoccupied containers within the trusted security zone for assignment to subsequent trusted service manager server . Conversely a master trusted service manager server may designate occupied containers i.e. containers previously assigned to a trusted service manager server for subsequent trusted service manager server . However the master trusted service manager server may remove e.g. delete the one or more data packages occupying the occupied container s and or request permission from the trusted service manager server previously assigned to occupy the container s to share the container s before designating the occupied container s to a subsequent trusted service manager server .

At block the method comprises generating by the sub key generator application the trusted security zone sub key based on hashing to provide to the second trusted service manager server access to the second set of one or more trusted security zone containers . At block the method comprises transmitting one or more signals to provision the second set of one or more trusted security zone containers with only the trusted security zone sub key so that first trusted service manager server may not access the second set of one or more containers with the trusted security zone master key. The signal may be transmitted from the sub key generator application in response to generating the trusted security zone sub key for the second trusted service manager server or the signal may be transmitted from the master trusted service manager server in response to validating the second trusted service manager server . In an embodiment the signal may be sent by the entity taking inventory over which servers occupy which containers of the trusted security zone . At block the method comprises providing by the sub key generator application the trusted security zone sub key to the second trusted service manager server so that the second trusted service manager server may access the second set of one or more trusted security zone containers .

The DSP or some other form of controller or central processing unit operates to control the various components of the mobile device in accordance with embedded software or firmware stored in memory or stored in memory contained within the DSP itself. In addition to the embedded software or firmware the DSP may execute other applications stored in the memory or made available via information carrier media such as portable data storage media like the removable memory card or via wired or wireless network communications. The application software may comprise a compiled set of machine readable instructions that configure the DSP to provide the desired functionality or the application software may be high level software instructions to be processed by an interpreter or compiler to indirectly configure the DSP .

The DSP may communicate with a wireless network via the analog baseband processing unit . In some embodiments the communication may provide Internet connectivity enabling a user to gain access to content on the Internet and to send and receive e mail or text messages. The input output interface interconnects the DSP and various memories and interfaces. The memory and the removable memory card may provide software and data to configure the operation of the DSP . Among the interfaces may be the USB port and the infrared port . The USB port may enable the mobile device to function as a peripheral device to exchange information with a personal computer or other computer system. The infrared port and other optional ports such as a Bluetooth interface or an IEEE 802.11 compliant wireless interface may enable the mobile device to communicate wirelessly with other nearby handsets and or wireless base stations.

The keypad couples to the DSP via the interface to provide one mechanism for the user to make selections enter information and otherwise provide input to the mobile device . Another input mechanism may be the touch screen LCD which may also display text and or graphics to the user. The touch screen LCD controller couples the DSP to the touch screen LCD . The GPS receiver is coupled to the DSP to decode global positioning system signals thereby enabling the mobile device to determine its position.

It is understood that by programming and or loading executable instructions onto the computer system at least one of the CPU the RAM and the ROM are changed transforming the computer system in part into a particular machine or apparatus having the novel functionality taught by the present disclosure. It is fundamental to the electrical engineering and software engineering arts that functionality that can be implemented by loading executable software into a computer can be converted to a hardware implementation by well known design rules. Decisions between implementing a concept in software versus hardware typically hinge on considerations of stability of the design and numbers of units to be produced rather than any issues involved in translating from the software domain to the hardware domain. Generally a design that is still subject to frequent change may be preferred to be implemented in software because re spinning a hardware implementation is more expensive than re spinning a software design. Generally a design that is stable that will be produced in large volume may be preferred to be implemented in hardware for example in an application specific integrated circuit ASIC because for large production runs the hardware implementation may be less expensive than the software implementation. Often a design may be developed and tested in a software form and later transformed by well known design rules to an equivalent hardware implementation in an application specific integrated circuit that hardwires the instructions of the software. In the same manner as a machine controlled by a new ASIC is a particular machine or apparatus likewise a computer that has been programmed and or loaded with executable instructions may be viewed as a particular machine or apparatus.

The secondary storage is typically comprised of one or more disk drives or tape drives and is used for non volatile storage of data and as an over flow data storage device if RAM is not large enough to hold all working data. Secondary storage may be used to store programs which are loaded into RAM when such programs are selected for execution. The ROM is used to store instructions and perhaps data which are read during program execution. ROM is a non volatile memory device which typically has a small memory capacity relative to the larger memory capacity of secondary storage . The RAM is used to store volatile data and perhaps to store instructions. Access to both ROM and RAM is typically faster than to secondary storage . The secondary storage the RAM and or the ROM may be referred to in some contexts as computer readable storage media and or non transitory computer readable media.

I O devices may include printers video monitors liquid crystal displays LCDs touch screen displays keyboards keypads switches dials mice track balls voice recognizers card readers paper tape readers or other well known input devices.

The network connectivity devices may take the form of modems modem banks Ethernet cards universal serial bus USB interface cards serial interfaces token ring cards fiber distributed data interface FDDI cards wireless local area network WLAN cards radio transceiver cards such as code division multiple access CDMA global system for mobile communications GSM long term evolution LTE worldwide interoperability for microwave access WiMAX 4generation 5generation and or other air interface protocol radio transceiver cards and other well known network devices. These network connectivity devices may enable the processor to communicate with the Internet or one or more intranets. With such a network connection it is contemplated that the processor might receive information from the network or might output information to the network in the course of performing the above described method steps. Such information which is often represented as a sequence of instructions to be executed using processor may be received from and outputted to the network for example in the form of a computer data signal embodied in a carrier wave.

Such information which may include data or instructions to be executed using processor for example may be received from and outputted to the network for example in the form of a computer data baseband signal or signal embodied in a carrier wave. The baseband signal or signal embedded in the carrier wave or other types of signals currently used or hereafter developed may be generated according to several methods well known to one skilled in the art. The baseband signal and or signal embedded in the carrier wave may be referred to in some contexts as a transitory signal.

The processor executes instructions codes computer programs scripts which it accesses from hard disk floppy disk optical disk these various disk based systems may all be considered secondary storage ROM RAM or the network connectivity devices . While only one processor is shown multiple processors may be present. Thus while instructions may be discussed as executed by a processor the instructions may be executed simultaneously serially or otherwise executed by one or multiple processors. Instructions codes computer programs scripts and or data that may be accessed from the secondary storage for example hard drives floppy disks optical disks and or other device the ROM and or the RAM may be referred to in some contexts as non transitory instructions and or non transitory information.

In an embodiment the computer system may comprise two or more computers in communication with each other that collaborate to perform a task. For example but not by way of limitation an application may be partitioned in such a way as to permit concurrent and or parallel processing of the instructions of the application. Alternatively the data processed by the application may be partitioned in such a way as to permit concurrent and or parallel processing of different portions of a data set by the two or more computers. In an embodiment virtualization software may be employed by the computer system to provide the functionality of a number of servers that is not directly bound to the number of computers in the computer system . For example virtualization software may provide twenty virtual servers on four physical computers. In an embodiment the functionality disclosed above may be provided by executing the application and or applications in a cloud computing environment. Cloud computing may comprise providing computing services via a network connection using dynamically scalable computing resources. Cloud computing may be supported at least in part by virtualization software. A cloud computing environment may be established by an enterprise and or may be hired on an as needed basis from a third party provider. Some cloud computing environments may comprise cloud computing resources owned and operated by the enterprise as well as cloud computing resources hired and or leased from a third party provider.

In an embodiment some or all of the functionality disclosed above may be provided as a computer program product. The computer program product may comprise one or more computer readable storage medium having computer usable program code embodied therein to implement the functionality disclosed above. The computer program product may comprise data structures executable instructions and other computer usable program code. The computer program product may be embodied in removable computer storage media and or non removable computer storage media. The removable computer readable storage medium may comprise without limitation a paper tape a magnetic tape magnetic disk an optical disk a solid state memory chip for example analog magnetic tape compact disk read only memory CD ROM disks floppy disks jump drives digital cards multimedia cards and others. The computer program product may be suitable for loading by the computer system at least portions of the contents of the computer program product to the secondary storage to the ROM to the RAM and or to other non volatile memory and volatile memory of the computer system . The processor may process the executable instructions and or data structures in part by directly accessing the computer program product for example by reading from a CD ROM disk inserted into a disk drive peripheral of the computer system . Alternatively the processor may process the executable instructions and or data structures by remotely accessing the computer program product for example by downloading the executable instructions and or data structures from a remote server through the network connectivity devices . The computer program product may comprise instructions that promote the loading and or copying of data data structures files and or executable instructions to the secondary storage to the ROM to the RAM and or to other non volatile memory and volatile memory of the computer system .

In some contexts the secondary storage the ROM and the RAM may be referred to as a non transitory computer readable medium or a computer readable storage media. A dynamic RAM embodiment of the RAM likewise may be referred to as a non transitory computer readable medium in that while the dynamic RAM receives electrical power and is operated in accordance with its design for example during a period of time during which the computer is turned on and operational the dynamic RAM stores information that is written to it. Similarly the processor may comprise an internal RAM an internal ROM a cache memory and or other internal non transitory storage blocks sections or components that may be referred to in some contexts as non transitory computer readable media or computer readable storage media.

While several embodiments have been provided in the present disclosure it should be understood that the disclosed systems and methods may be embodied in many other specific forms without departing from the spirit or scope of the present disclosure. The present examples are to be considered as illustrative and not restrictive and the intention is not to be limited to the details given herein. For example the various elements or components may be combined or integrated in another system or certain features may be omitted or not implemented.

Also techniques systems subsystems and methods described and illustrated in the various embodiments as discrete or separate may be combined or integrated with other systems modules techniques or methods without departing from the scope of the present disclosure. Other items shown or discussed as directly coupled or communicating with each other may be indirectly coupled or communicating through some interface device or intermediate component whether electrically mechanically or otherwise. Other examples of changes substitutions and alterations are ascertainable by one skilled in the art and could be made without departing from the spirit and scope disclosed herein.

