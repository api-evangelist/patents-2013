---

title: Application server billing
abstract: An Application Server entity in an IP Multimedia Subsystem (IMS) network comprises an interface for interfacing with an application and control logic which is arranged to inspect signaling information received from the application via the interface in the form of Extensible Markup Language (XML). The received signaling information is compared with stored rule data which specifies a relationship between an element in the signaling information and an action that should be taken and output data is generated based on the comparison. The Application Server can output operational measurements and/or charging information which more accurately reflect usage made of the Application Server resources. The need for a separate OSA/Parlay-X gateway can be avoided.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09015307&OS=09015307&RS=09015307
owner: RPX Clearinghouse LLC
number: 09015307
owner_city: San Francisco
owner_country: US
publication_date: 20130703
---
This invention relates to an IP Multimedia Subsystem IMS communications network and to implementing applications within such a network.

The IP Multimedia Subsystem IMS is a Next Generation Networking NGN architecture for telecom operators standardised by the Third Generation Partnership Project 3GPP which can provide multimedia services to mobile and fixed terminals. IMS uses SIP Session Initiation Protocol based signaling and Internet Protocol IP connectivity.

A number of CSCF Call Session Control Function entities are used to establish a session within the IMS network and process SIP signaling packets. The CSCF entities are the Proxy CSCF P CSCF Interrogating CSCF I CSCF and Serving CSCF S CSCF . shows part of an IMS network which includes the S CSCF. The S CSCF is responsible for handling registration processes making routing decisions and maintaining session states.

Application servers AS within an IMS network can host and execute applications which provide services. An Application Server interfaces with the S CSCF via an IMS Service Control ISC interface which uses SIP signaling. Services can include call related services such as Call waiting Call holding Call forwarding Call transfer Call blocking services. Applications can also provide services such as notifying a user of particular information such as stock prices or football results. Applications can be provided by the operator of the IMS network with the application being hosted and executed by a SIP Application Server within the IMS network.

Alternatively an application can be provided by a third party service provider external to the IMS network as shown in . An Application Server within the IMS network called an Open Service Architecture Service Capability Server OSA SCS can provide IMS network resources to implement the external service. The S CSCF communicates with the OSA SCS over an IMS Service Control ISM SIP based signaling interface . An OSA gateway acts as an intermediary between the OSA SCS and an Application in the IT environment . An Application can interface directly with the OSA Gateway via an OSA Application Programming Interface OSA API which typically uses Parlay over CORBA. Application interfaces with OSA Gateway in this manner. For Applications which use XML a Parlay X interface is used and a Parlay X gateway is required. Application uses a Parlay X interface to communicate with the Parlay X gateway . The Parlay X gateway uses a Parlay interface to communicate with the OSA gateway . IT based applications or web based services typically exchange data in an XML format and so the arrangement of gateways is usually required. It can be seen that with the current architecture two gateway elements are required whenever an application which uses an XML messaging format is connected to the IMS network. This considerably increases the complexity of implementing services provided by third parties.

An Application Server may be dedicated to a single service or it may be shared by several services as shown by Application A and Application B in . Multiple Application Servers can participate in a single session. For example a particular call between two users may involve a call transfer service and a music on hold service.

Currently Application Server billing triggers are all related to SIP and ISUP protocols and are resident at the CSCF Call Session Control Function plane. A disadvantage with this approach is that it is not possible to properly track the IMS network resources used by an IT based service external to the IMS network. This problem can arise for example where an Application Server is used by multiple third parties. While conventional mechanisms can monitor use of the Application Server resources as a whole they cannot monitor use by particular external applications.

A first aspect of the present invention provides an Application Server entity for use in an IP Multimedia Subsystem IMS network the Application Server comprising 

Web services exchange XML information streams to co ordinate and action services. By providing an interface and control logic at the Application Server which can inspect XML flows it is now possible to more accurately monitor usage of the Application Server resources by other entities especially external applications. Preferably the control logic outputs operational measurements and or charging information. A further advantage of providing functionality at the Application Server which can inspect XML data is that the need for a separate OSA Parlay X gateway can be avoided.

The incoming XML streams are inspected by the Application Server for key information elements. Comparing the information elements with the stored rules allows the application server to generate a trigger to begin the billing and charging capture process. The capture process acquires the relevant information for use in charging a subscriber for the service. Inspecting XML streams at this point in the network can also ensure that the external applications adhere to limits imposed by the operator of the network.

Preferably the charging information output by the Application Server is in a form which is compatible with a charging or billing entity in the IMS network. The charging information is preferably compliant with the 3GPP Rf standard as defined in 3GPP TS 32.260. For an offline charging scheme the charging information can take the form of an Accounting Request for sending to a Charging Data Function CDF entity. For an online charging scheme the charging information can take the form of a Credit Control Request CCR for sending to an Online Charging System OCS .

As the control logic compares received XML data with stored rules it can generate separate output messages such as individual Accounting Request messages. Alternatively the control logic can collate information during the process of comparing the received signaling information with stored rule data and can output a collated batch of information.

The stored rule data can represent rules for multiple parties such as rules of the network operator rules for a subscriber and rules for governance of the application.

The Application Server can be an Open Service Architecture Service Capability Server OSA SCS which interfaces to an external third party application.

A further aspect of the present invention provides a method of generating charging information in an IP Multimedia Subsystem IMS network the method comprising at an Application Server 

comparing the received signaling information with stored rule data which specifies a relationship between an element in the signaling information and an action that should be taken and 

The functionality described here can be implemented in software hardware or a combination of these. The invention can be implemented by means of hardware comprising several distinct elements and by means of a suitably programmed computer. Accordingly another aspect of the invention provides software for implementing the method. The software may be stored on an electronic memory device hard disk optical disk or other machine readable storage medium. The software may be delivered as a computer program product on a machine readable carrier or it may be downloaded to the Application Server via a network connection.

In accordance with this invention the interface between the Application Server and the external Applications Servers in the IT environment hosting applications uses signaling messages in the Extensible Markup Language XML format. The XML data can be carried as for example XML over SOAP.

An Application Server incorporates control logic which inspects the incoming XML data stream received over the interface and compares information elements in the received XML data with stored data. The stored data can take the form of rules which specify an action that should be taken in response to a particular information element being received in the received XML data. Stated another way the control logic performs a filtering action on the received data.

A rule can instruct the control logic to look for a particular information element in the received data and to compare the value with a condition such as a limit or a range which is specified in the rule. As an example a rule can specify a number of messages that a user is allowed to send at a particular tariff and a tariff for the message e.g. first ten messages per day free of charge next ten messages per day at a price of X per message . The inspection process can use rules which include multiple inspection criteria. Alternatively or additionally the inspection process can use multiple rules. The control logic can use sets of rules which relate to different parties such as the operator of the network the subscriber UE and the provider of the external applications . The rules can be stored at the Application Server at a centralised database in the IMS network or at individual databases . Where rules are stored at a database externally of the Application Server the Application Server can perform a query to the database in real time. The set or multiple sets of stored rules can be configured and updated as necessary.

One function which the control logic can perform is a Charge Triggering Function CTF . The control logic compares information elements in the received data with stored data billing triggers which are indicative of charging events where charging information should be generated. The inspection process uses a set of rules. When received data matches one or more of the stored billing triggers e.g. a condition specified in a rule the control logic creates an information flow that captures any relevant information and creates an Accounting Request. The Charge Data Function CDF will act on this request to generate a charging record which is typically known as a Charging Data Record CDR . An output function of the Application Server packages the charging information into the required output format. Preferably the Accounting Request issued by the Application Server is compliant to the 3GPP Rf interface standard as defined in 3GPP TS 32.260 3rd Generation Partnership Project Technical Specification Group Service and System Aspects Telecommunication management Charging management IP Multimedia Subsystem IMS charging . 3GPP TS 32.260 also defines how each Accounting Request is acknowledged by an Accounting Answer ACA . It can be seen that because the CTF control logic at the Application Server is now inspecting XML flows it is now possible to more accurately monitor usage of the AS resources by external applications.

One example of a rule is a simple instruction for the control logic to look for a particular information element in the received data such as a particular subscriber identity e.g. john nortel.com a called party a calling party or any other information carried in an XML signaling message carried across the interface and to create an Accounting Request.

The Accounting Requests are sent to a Charging Data Function CDF over an interface . The Charging Data Function is a part of the IMS architecture which collates the accounting requests received from the AS and the accounting requests received from other entities such as accounting requests received from the S CSCF . The CDF creates a Charging Data Record CDR and sends it to a Charging Gateway Function CGF . The CGF subsequently issues billing information via an interface to a billing system . The billing system will add a charge to a subscriber s account.

In cases where the comparison process compares the XML data with multiple rules a separate Accounting Request can be generated on each occasion where a rule instructs the control logic to generate charging information. schematically illustrates an alternative scheme performed by the control logic at an Application Server in which the comparison process compares all of the XML data in a particular signaling flow against a set of rules and issues a single Accounting Request which collates all of the charging information which results from the comparison. This can reduce network signaling overheads and the burden of subsequently processing the multiple accounting requests. Application XML data is received by the Rule check function . The rule check function checks the XML data against a set of rules Rule 1 Rule 2 . . . Rule N stored in rules database . On the first occasion when a comparison of a rule with the XML data results in a match a create billing record function is invoked. As an example a rule may state 

At the end of the rule checking process the Accounting Request is closed by a close Accounting Request function and the combined Accounting Request is sent from the Application Server via an output .

Charging in an IMS network can be offline or online . The present invention can be applied to either offline or online charging schemes. In an offline charging scheme charging information is collected as a service is provided for the purpose of later charging a user for the use of that service e.g. a charge is added to a monthly bill . Offline charging is implemented as described above with an AS inspecting incoming XML data comparing elements in the XML data with rules and issuing Accounting Requests which are sent to a CDF.

In an online charging scheme a user has an account which defines an amount of credit and a check is made in real time whether the user has sufficient credit before granting or denying access to a service. In an online charging implementation of the present invention the Application Server inspects incoming XML data and compares elements in the XML data with rules using the control logic and then generates a Credit Control Request CCR to an Online Charging System OCS . The CCR is preferably sent via the Ro interface as defined in 3GPP 32.360. The OCS will compare the request with the subscriber s available credit and will reply with a Credit Control Authorisation CCA if sufficient credit exists. As the authorised credit is used up or as stored rules are triggered at the control logic further credit control requests may be sent from the control logic to the OCS . At the end of the session the control logic will inform the OCS to allow it to release any unused credit. The OCS is responsible for keeping the Billing System informed of the usage of credit to allow billing records to be generated.

At stage a Home Subscriber Server HSS is consulted. This invokes a set of rules which are particular to the subscriber such as a list of applications that the subscriber wishes to receive messages from. The HSS can provide transparent data that is relevant to the specific application and which would only be valid in the scope of the application. Data captured at this stage could be used for charging or operational reasons. If an online charging scheme is used at stage a credit check can be performed by issuing a Credit Control Authorisation CCA message to the Online Charging System .

At stage a governance rules database is consulted. This invokes a set of rules which govern the use that Application can make of the IMS network such as a maximum number of messages that the IMS network will deliver in response to instructions from that Application. The IT application rules can be used to handle and capture data that is related to the governance of the application within the overall network. A particular application may be limited to sending a certain number of messages per day and this needs to be captured to guarantee the governance. Information captured at this stage can be sent to any interested parties.

Each of the stages described above can be used to capture and output operational data or charging information. At each of the stages data can be generated as a result of comparing the received XML data with the rules. The data can be sent after that stage has been completed or the data can be collated as described above. If generated data is destined for different entities e.g. charging information destined for a charging entity operational measurements destined for a network management entity then the generated data can be collated based on the entity to which that data is destined. Charging information can be based upon the capture of operational data. As an example if a session lasts for 3 minutes then this is in effect an operational data capture which can be used to calculate the charging information. The operational data required for charging can be collected by the Application Server.

Although the above description has shown a wireless subscriber the invention is not limited to providing services to wireless subscribers. Any form of access network can be used to connect a user equipment to the IMS network.

The invention is not limited to the embodiments described herein which may be modified or varied without departing from the scope of the invention.

