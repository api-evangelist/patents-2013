---

title: Conversion of mobile device to LAN-only telephony functions
abstract: A system and method implemented at a communication device for providing access to telephony services over one or more of a number of communication networks, including cellular networks and IP-based fixed and wireless networks. A mobile device may be configurable for voice communication over both a cellular network and a LAN (e.g. a wireless LAN), and may be adapted to place and receive calls via a PBX over one of the cellular network and the LAN. When it is determined that the mobile device is configured for voice communication using one or both of the cellular network connection and the LAN connection, the mobile device may automatically adapt its user interface to reflect the availability of voice communication only over those connections that are available.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09386628&OS=09386628&RS=09386628
owner: BlackBerry Limited
number: 09386628
owner_city: Waterloo
owner_country: CA
publication_date: 20130718
---
This application is a continuation of U.S. application Ser. No. 12 843 525 filed Jul. 26 2010 now issued as U.S. Pat. No. 8 509 186 which claims priority from U.S. Provisional Application No. 61 328 097 filed Apr. 26 2010 the entireties of which are incorporated by reference.

Mobile communication devices such as smartphones may be used to extend the flexibility of fixed telephone networks within an enterprise. For example dual mode smartphones capable of operating over both cellular and IP based networks may be deployed in an enterprise communication network equipped with a private branch exchange PBX . The network may then route incoming telephone calls to the smartphone and outbound calls from the smartphone may appear to the recipient to originate from the user s desk telephone connected to the PBX. The fixed mobile convergence realized by integrating mobile devices into the enterprise s PBX provides for an improved user experience both for the mobile device users and callers since the system may extend desk phone functionality such as conference calling to the mobile device and also because the mobile device user may appear to be available and in the office even when travelling.

Although voice calls made using dual mode smartphones are typically connected over a cellular network voice calls may also be completed using Voice over IP VoIP protocols over an IP based network. Thus for example if a wireless LAN LAN connection is available to the smartphone telephone calls may be routed over the LAN.

The embodiments described herein provide a system method and a mobile device for providing for a convergence of fixed and mobile voice communications in an enterprise environment while providing a dynamically adjusting user interface responsive to network conditions at the mobile device. There is provided a mobile device configurable for communication over at least one cellular network and over at least on local area network LAN the mobile device being adapted for voice communication using at least one mobile telecommunications standard and at least one IP based network capable of implementing a method of determining whether the mobile device is configured for communication over a cellular network connection determining whether the mobile device is configured for communication over a LAN and in some embodiments a wireless LAN and adapting a user interface at the mobile device to reflect voice communication availability only over those connections for which the mobile device is determined to be configured. In some aspects determining whether the mobile device is configured for communication over the cellular network connection may comprise at least one of determining whether a SIM or RUIM card is present in the mobile device determining whether the mobile device is an activated CDMA device or determining whether cellular connectivity has been inactivated at the mobile device. Determining whether the mobile device is configured for LAN or wireless LAN communication may comprise determining whether there is an appropriate communications subsystem on board.

Thus the user interface may therefore be adapted to reflect voice communication availability only over the LAN connection when the mobile device is determined not to be configured for communication over the cellular network but configured for LAN connectivity voice communication availability only over the cellular network connection when the mobile device is determined to be configured for such communication but not for communication over the LAN or if both forms of connectivity are available the user interface may reflect the availability of voice communication over both.

In these embodiments availability of voice communication over one or the other path may be indicated by displaying service entry points in the user interface for those available connections or by displaying a telephone number only for those connections for which the mobile device is configured. In a further aspect of these embodiments the mobile device may be initially configured for voice communication over the cellular network connection and the LAN connection but upon detection of a loss of cellular network connectivity the mobile device may adapt the user interface to reflect voice communication availability only over the LAN connection. In still a further aspect the mobile device may be adapted to use one set of codecs for voice communication over the cellular network and may then select a second set of codecs for voice communication over the LAN connection upon detecting the loss of cellular network connectivity. In yet a further aspect the mobile device may be configured to place and receive voice calls via a PBX over either the cellular network the LAN connection or both.

These embodiments will be described primarily in relation to a mobile wireless communication device such as a smartphone hereafter referred to as a mobile device. It will be appreciated by those skilled in the art however that this description is not intended to limit the scope of the described embodiments to smartphones. The methods and systems described herein may be applied to any appropriate communication or data processing device whether portable or not including without limitation cellular phones smartphones organizers personal digital assistants desktop computers terminals laptops tablets notebook computers and the like.

The embodiments described herein may be implemented on a communication device such as that illustrated in . The communication device may communicate with other devices over a wireless communication system or enterprise system as illustrated in . The communication device may be a mobile device with two way communication and advanced data communication capabilities including the capability to communicate with other mobile devices or computer systems through a network of transceiver stations. The communication device can also have voice communication capabilities.

The communication subsystem receives messages from and sends messages to a wireless network . In this exemplary embodiment of the communication device the communication subsystem is configured in accordance with one or more of Global System for Mobile Communication GSM General Packet Radio Services GPRS standards Enhanced Data GSM Environment EDGE and Universal Mobile Telecommunications Service UMTS . New standards are still being defined but it is believed that they will have similarities to the network behavior described herein and it will also be understood by persons skilled in the art that the embodiments described herein are intended to use any other suitable standards that are developed in the future. The wireless link connecting the communication subsystem with the wireless network represents one or more different Radio Frequency RF channels operating according to defined protocols specified for GSM GPRS EDGE or UMTS and optionally other network communications. With newer network protocols these channels are capable of supporting both circuit switched voice communications and packet switched data communications.

Other wireless networks can also be associated with the communication device in variant implementations. The different types of wireless networks that can be employed include for example data centric wireless networks voice centric wireless networks and dual mode networks that can support both voice and data communications over the same physical base stations. Combined dual mode networks include but are not limited to Code Division Multiple Access CDMA or CDMA2000 networks GSM GPRS networks third generation 3G networks like EDGE HSPA HSPA EVDO and UMTS or fourth generation 4G networks such as LTE and LTE Advanced. Some other examples of data centric networks include WiFi 802.11 Mobitex and DataTAC network communication systems. Examples of other voice centric data networks include Personal Communication Systems PCS networks like GSM and Time Division Multiple Access TDMA systems. The mobile device may be provided with additional communication subsystems such as the wireless LAN WLAN communication subsystem also shown in . The WLAN communication subsystem may operate in accordance with a known network protocol such as one or more of the 802.11 family of standards developed by IEEE. The communication subsystem may be separate from or integrated with the communication subsystem or with the short range communications module . The main processor also interacts with additional subsystems such as a Random Access Memory RAM a flash memory a display an auxiliary input output I O subsystem a data port a keyboard a speaker a microphone the short range communications and other device subsystems .

Some of the subsystems of the communication device perform communication related functions whereas other subsystems can provide resident or on device functions. By way of example the display and the keyboard can be used for both communication related functions such as entering a text message for transmission over the network and device resident functions such as a calculator or task list.

A rendering circuit is included in the device . When a user specifies that a data file is to be viewed on the display the rendering circuit analyzes and processes the data file for visualization on the display . Rendering circuit may be implemented as hardware software or as a combination of both hardware and software.

The communication device can send and receive communication signals over the wireless network after required network registration or activation procedures have been completed. Network access is associated with a subscriber or user of the communication device . To identify a subscriber the communication device requires a SIM RUIM card i.e. Subscriber Identity Module or a Removable User Identity Module to be inserted into a SIM RUIM interface in order to communicate with a network. The SIM RUIM card is one type of a conventional smart card that can be used to identify a subscriber of the communication device and to personalize the communication device among other things. Without the SIM RUIM card the communication device is not fully operational for communication with the wireless network . By inserting the SIM RUIM card into the SIM RUIM interface a subscriber can access all subscribed services. Services can include web browsing and messaging such as e mail voice mail Short Message Service SMS and Multimedia Messaging Services MMS . More advanced services can include point of sale field service and sales force automation. The SIM RUIM card includes a processor and memory for storing information. Once the SIM RUIM card is inserted into the SIM RUIM interface it is coupled to the main processor . In order to identify the subscriber the SIM RUIM card can include some user parameters such as an International Mobile Subscriber Identity IMSI . An advantage of using the SIM RUIM card is that a subscriber is not necessarily bound by any single physical mobile device. The SIM RUIM card can store additional subscriber information for a mobile device as well including datebook or calendar information and recent call information. Alternatively user identification information can also be programmed into the flash memory .

The communication device may be a battery powered device including a battery interface for receiving one or more rechargeable batteries . In at least some embodiments the battery can be a smart battery with an embedded microprocessor. The battery interface is coupled to a regulator not shown which assists the battery in providing power V to the communication device . Although current technology makes use of a battery future technologies such as micro fuel cells can provide the power to the communication device .

The communication device also includes an operating system and software components to which are described in more detail below. The operating system and the software components to that are executed by the main processor are typically stored in a persistent store such as the flash memory which can alternatively be a read only memory ROM or similar storage element not shown . Those skilled in the art will appreciate that portions of the operating system and the software components to such as specific device applications or parts thereof can be temporarily loaded into a volatile store such as the RAM . Other software components can also be included as is well known to those skilled in the art.

The subset of software applications that control basic device operations including data and voice communication applications will normally be installed on the communication device during its manufacture. Other software applications include a message application that can be any suitable software program that allows a user of the communication device to send and receive electronic messages. Various alternatives exist for the message application as is well known to those skilled in the art. Messages that have been sent or received by the user are typically stored in the flash memory of the communication device or some other suitable storage element in the communication device . In at least some embodiments some of the sent and received messages can be stored remotely from the device such as in a data store of an associated host system that the communication device communicates with.

The software applications can further include a device state module a Personal Information Manager PIM and other suitable modules not shown . The device state module provides persistence i.e. the device state module ensures that important device data is stored in persistent memory such as the flash memory so that the data is not lost when the communication device is turned off or loses power.

The PIM includes functionality for organizing and managing data items of interest to the user such as but not limited to e mail contacts calendar events voice mails appointments and task items. A PIM application has the ability to send and receive data items via the wireless network . PIM data items can be seamlessly integrated synchronized and updated via the wireless network with the mobile device subscriber s corresponding data items stored and or associated with a host computer system. This functionality creates a mirrored host computer on the communication device with respect to such items. This can be particularly advantageous when the host computer system is the mobile device subscriber s office computer system.

The communication device also includes a connect module and an information technology IT policy module . The connect module implements the communication protocols that are required for the communication device to communicate with the wireless infrastructure and any host system such as an enterprise system that the communication device is authorized to interface with. Examples of a wireless infrastructure and an enterprise system are given in which are described in more detail below.

The connect module includes a set of Application Programming Interfaces APIs that can be integrated with the communication device to allow the communication device to use any number of services associated with the enterprise system. The connect module allows the communication device to establish an end to end secure authenticated communication pipe with the host system. A subset of applications for which access is provided by the connect module can be used to pass IT policy commands from the host system to the communication device . This can be done in a wireless or wired manner. These instructions can then be passed to the IT policy module to modify the configuration of the device . Alternatively in some cases the IT policy update can also be done over a wired connection.

Other types of software applications can also be installed on the communication device . These software applications can be third party applications which are added after the manufacture of the communication device . Examples of third party applications include games calculators utilities etc.

The additional applications can be loaded onto the communication device through at least one of the wireless network the auxiliary I O subsystem the data port the short range communications subsystem or any other suitable device subsystem . This flexibility in application installation increases the functionality of the communication device and can provide enhanced on device functions communication related functions or both. For example secure communication applications can enable electronic commerce functions and other such financial transactions to be performed using the communication device .

The data port enables a subscriber to set preferences through an external device or software application and extends the capabilities of the communication device by providing for information or software downloads to the communication device other than through a wireless communication network. The alternate download path can for example be used to load an encryption key onto the communication device through a direct and thus reliable and trusted connection to provide secure device communication. The data port can be any suitable port that enables data communication between the communication device and another computing device. The data port can be a serial or a parallel port. In some instances the data port can be a USB port that includes data lines for data transfer and a supply line that can provide a charging current to charge the battery of the communication device .

The short range communications subsystem provides for communication between the communication device and different systems or devices without the use of the wireless network . For example the subsystem can include an infrared device and associated circuits and components for short range communication. Examples of short range communication standards include standards developed by the Infrared Data Association IrDA Bluetooth and the 802.11 family of standards.

In use a received signal such as a text message an e mail message or web page download will be processed by the communication subsystem and input to the main processor . The main processor will then process the received signal for output to the display or alternatively to the auxiliary I O subsystem . A subscriber can also compose data items such as e mail messages for example using the keyboard in conjunction with the display and possibly the auxiliary I O subsystem . The auxiliary subsystem can include devices such as a touchscreen mouse track ball infrared fingerprint detector or a roller wheel with dynamic button pressing capability. The keyboard may be an alphanumeric keyboard and or telephone type keypad. However other types of keyboards can also be used. A composed item can be transmitted over the wireless network through the communication subsystem . It will be appreciated that if the display comprises a touchscreen then the auxiliary subsystem may still comprise one or more of the devices identified above.

For voice communications the overall operation of the communication device is substantially similar except that the received signals are output to the speaker and signals for transmission are generated by the microphone . Alternative voice or audio I O subsystems such as a voice message recording subsystem can also be implemented on the communication device . Although voice or audio signal output is accomplished primarily through the speaker the display can also be used to provide additional information such as the identity of a calling party duration of a voice call or other voice call related information.

Signals received by the antenna through the wireless network are input to the receiver which can perform such common receiver functions as signal amplification frequency down conversion filtering channel selection and analog to digital A D conversion. A D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in the DSP . In a similar manner signals to be transmitted are processed including modulation and encoding by the DSP . These DSP processed signals are input to the transmitter for digital to analog D A conversion frequency up conversion filtering amplification and transmission over the wireless network via the antenna . The DSP not only processes communication signals but also provides for receiver and transmitter control. For example the gains applied to communication signals in the receiver and the transmitter can be adaptively controlled through automatic gain control algorithms implemented in the DSP .

The wireless link between the communication device and the wireless network can contain one or more different channels typically different RF channels and associated protocols used between the communication device and the wireless network . An RF channel is a limited resource that should be conserved typically due to limits in overall bandwidth and limited battery power of the communication device . When the communication device is fully operational the transmitter is typically keyed or turned on only when it is transmitting to the wireless network and is otherwise turned off to conserve resources. Similarly the receiver is periodically turned off to conserve power until it is needed to receive signals or information if at all during designated time periods. Other communication subsystems such as the WLAN communication subsystem shown in may be provided with similar components as those described above configured for communication over the appropriate frequencies and using the appropriate protocols.

In a GSM network the MSC is coupled to the BSC and to a landline network such as a Public Switched Telephone Network PSTN to satisfy circuit switched requirements. The connection through the PCU the SGSN and the GGSN to a public or private network Internet also referred to herein generally as a shared network infrastructure represents the data path for GPRS capable mobile devices. In a GSM network extended with GPRS capabilities the BSC also contains the Packet Control Unit PCU that connects to the SGSN to control segmentation radio channel allocation and to satisfy packet switched requirements. To track the location of the communication device and availability for both circuit switched and packet switched management the HLR is shared between the MSC and the SGSN . Access to the VLR is controlled by the MSC .

The station is a fixed transceiver station and together with the BSC form fixed transceiver equipment. The fixed transceiver equipment provides wireless network coverage for a particular coverage area commonly referred to as a cell . The fixed transceiver equipment transmits communication signals to and receives communication signals from mobile devices within its cell via the station . The fixed transceiver equipment normally performs such functions as modulation and possibly encoding and or encryption of signals to be transmitted to the communication device in accordance with particular usually predetermined communication protocols and parameters under control of its controller. The fixed transceiver equipment similarly demodulates and possibly decodes and decrypts if necessary any communication signals received from the communication device within its cell. Communication protocols and parameters can vary between different nodes. For example one node can employ a different modulation scheme and operate at different frequencies than other nodes.

For all communication devices registered with a specific network permanent configuration data such as a user profile is stored in the HLR . The HLR also contains location information for each registered mobile device and can be queried to determine the current location of a mobile device. The MSC is responsible for a group of location areas and stores the data of the mobile devices currently in its area of responsibility in the VLR . Further the VLR also contains information on mobile devices that are visiting other networks. The information in the VLR includes part of the permanent mobile device data transmitted from the HLR to the VLR for faster access. By moving additional information from a remote HLR node to the VLR the amount of traffic between these nodes can be reduced so that voice and data services can be provided with faster response times and at the same time requiring less use of computing resources.

The SGSN and the GGSN are elements added for GPRS support namely packet switched data support within GSM. The SGSN and the MSC have similar responsibilities within the wireless network by keeping track of the location of each communication device . The SGSN also performs security functions and access control for data traffic on the wireless network . The GGSN provides internetworking connections with external packet switched networks and connects to one or more SGSNs via an Internet Protocol IP backbone network operated within the network . During normal operations a given communication device must perform a GPRS Attach to acquire an IP address and to access data services. This requirement is not present in circuit switched voice channels as Integrated Services Digital Network ISDN addresses are used for routing incoming and outgoing calls. Currently all GPRS capable networks use private dynamically assigned IP addresses thus requiring the DHCP server connected to the GGSN . There are many mechanisms for dynamic IP assignment including using a combination of a Remote Authentication Dial In User Service RADIUS server and a DHCP server. Once the GPRS Attach is complete a logical connection is established from a communication device through the PCU and the SGSN to an Access Point Node APN within the GGSN . The APN represents a logical end of an IP tunnel that can either access direct Internet compatible services or private network connections. The APN also represents a security mechanism for the network insofar as each communication device must be assigned to one or more APNs and communication devices cannot exchange data without first performing a GPRS Attach to an APN that it has been authorized to use. The APN can be considered to be similar to an Internet domain name such as myconnection.wireless.com .

Once the GPRS Attach operation is complete a tunnel is created and all traffic is exchanged within standard IP packets using any protocol that can be supported in IP packets. This includes tunneling methods such as IP over IP as in the case with some IPSecurity Ipsec connections used with Virtual Private Networks VPN . These tunnels are also referred to as Packet Data Protocol PDP Contexts and there are a limited number of these available in the network . To maximize use of the PDP Contexts the network will run an idle timer for each PDP Context to determine if there is a lack of activity. When a communication device is not using its PDP Context the PDP Context can be de allocated and the IP address returned to the IP address pool managed by the DHCP server .

The host system comprises a number of network components connected to each other by a network . For instance a user s desktop computer with an accompanying cradle for the user s communication device is situated on a LAN connection. The cradle for the communication device can be coupled to the computer by a serial or a Universal Serial Bus USB connection for example. Other user computers are also situated on the network and each can be equipped with an accompanying cradle . The cradle facilitates the loading of information e.g. PIM data private symmetric encryption keys to facilitate secure communications from the user computer to the communication device and can be particularly useful for bulk information updates often performed in initializing the communication device for use. The information downloaded to the communication device can include certificates used in the exchange of messages.

It will be understood by persons skilled in the art that the user computers are typically also connected to other peripheral devices such as printers etc. which are not explicitly shown in . Furthermore only a subset of network components of the host system are shown in for ease of exposition and it will be understood by persons skilled in the art that the host system will comprise additional components that are not explicitly shown in for this exemplary configuration. More generally the host system can represent a smaller part of a larger network not shown of the organization and can comprise different components and or be arranged in different topologies than that shown in the exemplary embodiment of .

To facilitate the operation of the communication device and the wireless communication of messages and message related data between the communication device and components of the host system a number of wireless communication support components can be provided. In some implementations the wireless communication support components can include a message management server a mobile data server a web server such as Hypertext Transfer Protocol HTTP server a contact server and a device manager module . HTTP servers can also be located outside the enterprise system as indicated by the HTTP server attached to the network . The device manager module includes an IT Policy editor and an IT user property editor as well as other software components for allowing an IT administrator to configure the communication devices . In an alternative embodiment there can be one editor that provides the functionality of both the IT policy editor and the IT user property editor . The support components also include a data store and an IT policy server . The IT policy server includes a processor a network interface and a memory unit . The processor controls the operation of the IT policy server and executes functions related to the standardized IT policy as described below. The network interface allows the IT policy server to communicate with the various components of the host system and the communication devices . The memory unit can store functions used in implementing the IT policy as well as related data. Those skilled in the art know how to implement these various components. Other components can also be included as is well known to those skilled in the art. Further in some implementations the data store can be part of any one of the servers.

In this exemplary embodiment the communication device communicates with the host system through node of the wireless network and a shared network infrastructure such as a service provider network or the public Internet. Access to the host system can be provided through one or more routers not shown and computing devices of the host system can operate from behind a firewall or proxy server . The proxy server provides a secure node and a wireless internet gateway for the host system . The proxy server intelligently routes data to the correct destination server within the host system .

In some implementations the host system can include a wireless VPN router not shown to facilitate data exchange between the host system and the communication device . The wireless VPN router allows a VPN connection to be established directly through a specific wireless network to the communication device . The wireless VPN router can be used with the Internet Protocol IP Version 6 IPV6 and IP based wireless networks. This protocol can provide enough IP addresses so that each mobile device has a dedicated IP address making it possible to push information to a mobile device at any time. An advantage of using a wireless VPN router is that it can be an off the shelf VPN component and does not require a separate wireless gateway and separate wireless infrastructure. A VPN connection may be a Transmission Control Protocol TCP IP or User Datagram Protocol UDP IP connection for delivering the messages directly to the communication device in this alternative implementation.

Messages intended for a user of the communication device are initially received by a message server of the host system . Such messages can originate from any number of sources. For instance a message can have been sent by a sender from the computer within the host system from a different mobile device not shown connected to the wireless network or a different wireless network or from a different computing device or other device capable of sending messages via the shared network infrastructure possibly through an application service provider ASP or Internet service provider ISP for example.

The message server typically acts as the primary interface for the exchange of messages particularly e mail messages within the organization and over the shared network infrastructure . Each user in the organization that has been set up to send and receive messages is typically associated with a user account managed by the message server . Some exemplary implementations of the message server include a Microsoft Exchange server a Lotus Domino server a Novell Groupwise server or another suitable mail server installed in a corporate environment. In some implementations the host system can comprise multiple message servers . The message server can also be adapted to provide additional functions beyond message management including the management of data associated with calendars and task lists for example.

When messages are received by the message server they are typically stored in a data store associated with the message server . In at least some embodiments the data store can be a separate hardware unit such as data store with which the message server communicates. Messages can be subsequently retrieved and delivered to users by accessing the message server . For instance an e mail client application operating on a user s computer can request the e mail messages associated with that user s account stored on the data store associated with the message server . These messages are then retrieved from the data store and stored locally on the computer . The data store associated with the message server can store copies of each message that is locally stored on the communication device . Alternatively the data store associated with the message server can store all of the messages for the user of the communication device and only a smaller number of messages can be stored on the communication device to conserve memory. For instance the most recent messages i.e. those received in the past two to three months for example can be stored on the communication device .

When operating the communication device the user may wish to have e mail messages retrieved for delivery to the communication device . The message application operating on the communication device can also request messages associated with the user s account from the message server . The message application can be configured either by the user or by an administrator possibly in accordance with an organization s IT policy to make this request at the direction of the user at some pre defined time interval or upon the occurrence of some pre defined event. In some implementations the communication device is assigned its own e mail address and messages addressed specifically to the communication device are automatically redirected to the communication device as they are received by the message server .

The message management server can be used to specifically provide support for the management of messages such as e mail messages that are to be handled by mobile devices. Generally while messages are still stored on the message server the message management server can be used to control when if and how messages are sent to the communication device . The message management server also facilitates the handling of messages composed on the communication device which are sent to the message server for subsequent delivery.

For example the message management server can monitor the user s mailbox e.g. the message store associated with the user s account on the message server for new e mail messages and apply user definable filters to new messages to determine if and how the messages are relayed to the user s communication device . The message management server can also through an encoder not shown associated therewith compress message data using any suitable compression decompression technology e.g. YK compression JPEG MPEG x H.26x and other known techniques and encrypt messages e.g. using an encryption technique such as Data Encryption Standard DES Triple DES or Advanced Encryption Standard AES and push them to the communication device via the shared network infrastructure and the wireless network . The message management server can also receive messages composed on the communication device e.g. encrypted using Triple DES decrypt and decompress the composed messages re format the composed messages if desired so that they will appear to have originated from the user s computer and re route the composed messages to the message server for delivery.

Certain properties or restrictions associated with messages that are to be sent from and or received by the communication device can be defined e.g. by an administrator in accordance with IT policy and enforced by the message management server . These may include whether the communication device can receive encrypted and or signed messages minimum encryption key sizes whether outgoing messages must be encrypted and or signed and whether copies of all secure messages sent from the communication device are to be sent to a pre defined copy address for example.

The message management server can also be adapted to provide other control functions such as only pushing certain message information or pre defined portions e.g. blocks of a message stored on the message server to the communication device . For example in some cases when a message is initially retrieved by the communication device from the message server the message management server can push only the first part of a message to the communication device with the part being of a pre defined size e.g. 2 KB . The user can then request that more of the message be delivered in similar sized blocks by the message management server to the communication device possibly up to a maximum pre defined message size. Accordingly the message management server facilitates better control over the type of data and the amount of data that is communicated to the communication device and can help to minimize potential waste of bandwidth or other resources.

The mobile data server encompasses any other server that stores information that is relevant to the corporation. The mobile data server can include but is not limited to databases online data document repositories customer relationship management CRM systems or enterprise resource planning ERP applications. The mobile data server can also connect to the Internet or other public network through HTTP server or other suitable web server such as an File Transfer Protocol FTP server to retrieve HTTP webpages and other data. Requests for webpages are typically routed through mobile data server and then to HTTP server through suitable firewalls and other protective mechanisms. The web server then retrieves the webpage over the Internet and returns it to mobile data server . As described above in relation to message management server mobile data server is typically provided or associated with an encoder that permits retrieved data such as retrieved webpages to be decompressed and compressed using any suitable compression technology e.g. YK compression JPEG MPEG x H.26x and other known techniques and encrypted e.g. using an encryption technique such as DES Triple DES or AES and then pushed to the communication device via the shared network infrastructure and the wireless network . While encoder is only shown for mobile data server it will be appreciated that each of message server message management server and HTTP servers and can also have an encoder associated therewith.

The contact server can provide information for a list of contacts for the user in a similar fashion as the address book on the communication device . Accordingly for a given contact the contact server can include the name phone number work address and e mail address of the contact among other information. The contact server can also provide a global address list that contains the contact information for all of the contacts associated with the host system .

It will be understood by persons skilled in the art that the message management server the mobile data server the HTTP server the contact server the device manager module the data store and the IT policy server do not need to be implemented on separate physical servers within the host system . For example some or all of the functions associated with the message management server can be integrated with the message server or some other server in the host system . Alternatively the host system can comprise multiple message management servers particularly in variant implementations where a large number of mobile devices need to be supported.

The device manager module provides an IT administrator with a graphical user interface with which the IT administrator interacts to configure various settings for the communication devices . As mentioned the IT administrator can use IT policy rules to define behaviors of certain applications on the communication device that are permitted such as phone web browser or Instant Messenger use. The IT policy rules can also be used to set specific values for configuration settings that an organization requires on the communication devices such as auto signature text WLAN VoIP VPN configuration security requirements e.g. encryption algorithms password rules etc. specifying themes or applications that are allowed to run on the communication device and the like.

Rendering data files originally optimized or prepared for visualization on large screen displays on a portable electronic device display often requires additional processing prior to visualization on the small screen portable electronic device displays. According to an embodiment this additional processing is accomplished by the rendering engine shown in . As will be appreciated by those of skill in the art the rendering engine can be implemented in hardware software or a combination thereof and can comprise a dedicated image processor and associated circuitry or can be implemented within main processor .

As noted above the mobile device may be a dual mode or multiple mode device that is configured to operate in not only voice centric but also data centric networks. For example the mobile device may be configured to communicate over a dual mode network such as those identified above including but not limited to CDMA CDMA2000 GSM GPRS EDGE EVDO HSPA HSPA UMTS and LTE and may also be configured to communicate over wireless networks that are typically IP based such as wireless LANs implementing the Wi Fi protocol one or more of the IEEE 802.11 suite of protocols personal area networks implementing other protocols such as Bluetooth other wireless networks implementing wireless broadband standards such as WiMAX one or more of the IEEE 802.16 suite of protocols and the like. The mobile device may also be configured to operate over a fixed connection to an IP based network for example via a USB or Ethernet connection. For ease of reference these two modes are respectively referred to generally as cellular and LAN modes or networks where LAN includes both wireless and wired LANs. Although the description herein is generally directed to an implementation on a mobile communication device typically communicating over networks over a wireless link it will be understood by those skilled in the art that the description is not intended to be so limiting and includes wired connections. The mobile device may therefore be equipped with multiple interfaces and transceivers for communicating over different fixed and wireless networks and may be configured to communicate over more than one network at a given time.

Further the mobile device may capable of operating in a single line mode and in a multi line mode. Thus inbound calls to a plurality of telephone numbers associated with the device may be received at the device when in multi line mode and when the device is in the multi line mode outbound calls may be placed at the device using a selected one of the telephone numbers associated with the device so that caller identification delivered to the recipient of the outbound call will identify the call as being placed using that selected telephone number.

Some inbound and outbound calls may be handled through a private branch exchange PBX in the same enterprise network environment as the mobile device for example a PBX associated with the host system . If the mobile device is configured to communicate with the host system over at least a LAN the PBX may be configured to connect calls from the mobile device and route calls directed to the device over the LAN. Calls may also be routed through a remotely hosted PBX service assigned to the enterprise but not necessarily forming a physical part of the enterprise s network. The enterprise s systems may be distributed over significant geographic distances. Hosted telephony services may be used to provide an integrated PBX environment for all users within the enterprise.

The host system in this embodiment comprises or is associated with the PBX through a server or gateway . The server and the PBX may communicate over an IP data channel for example implementing a SIP session initiation protocol circuit. If the PBX is a TDM PBX then the communication channel may be an ISDN PRI connection and the server may convert TDM data received from the PBX to IP data. After receiving voice call data from the PBX the server provides the data in a VoIP compliant format to other components of the host system for re routing to the mobile device over the data communication channel . Thus calls to or from the mobile device may be routed over an IP network to the PBX allowing the host system to handle authentication of the mobile device and other administrative functions relating to the voice call.

The mobile device s access to IP networks and to the public switched telephone network is provided through the wireless network which as described above may comprise one or more nodes configured for communication in accordance a suitable mobile telephony standard. In turn the wireless network provides the mobile device with connectivity to the Internet or other public wide area network and thence to the host system . At the same time if the mobile device is a multiple mode device it may also communicate with the host system over an enterprise LAN represented by the access point . The mobile device may therefore be able to handle calls routed through the PBX not only over the wireless network but also through the LAN . This network configuration thus provides the user with a communication service handling both fixed and wireless voice calls. It will also be appreciated by those skilled in the art that access to the host system need not be limited to access via the enterprise LAN network whether wireless or not . Instead the mobile device may access the host system over a network such as the wide area IP network via an access point which may be located at the mobile device user s home or at a public or private Wi Fi hotspot.

For some wireless networks or LANs the mobile device may be registered or activated with the respective network. A process for identifying a subscriber to a cellular network using a SIM card is described above. Other methods of registering or identifying the mobile device to various networks will be known to those of ordinary skill in the art. However registration or activation may not be required for all wireless networks LANs or other access units as some networks may allow access without prior registration or activation. The mobile device may also be provisioned or configured to access the wireless network or LAN or other access point . Methods of provisioning services on a mobile device will be generally known to those skilled in the art but as a non limiting example a request for registration may be sent from the mobile device to a registration server of a service not shown . If the request is approved the registration server may transmit to the mobile device a service book containing data and instructions to enable the mobile device to provision the service. The service book when received at the mobile device may be self executing and permits the user to enter account information relevant to the associated service. This information is then transmitted from the mobile device to a provisioning server of the service provider not shown which may then create a service account associated with the mobile device . Provisioning may also be carried out in compliance with the OMA DM Open Mobile Alliance Device Management specification version 1.2 or its predecessor or successor versions published by the Open Mobile Alliance Ltd.

In addition to the provisioning with the service book additional settings may be established at the device or pushed to the device concerning its access to the wireless network LAN or access point . For example configuration settings may be established disabling one or more modes of communication. If the configuration settings are set to disable cellular communications the mobile device may be restricted to communication over the LAN only. Such a setting may be desirable in an enterprise environment where security or accounting concerns require that calls be routed through the host system for its authentication and record keeping functions or where it is desirable to control costs by disabling cellular communication. The mobile device may be restricted to permit communication over the access point as well in this instance. These additional settings may be stored in a branding or configuration file stored in the memory of the mobile device . When the mobile device is initialized the settings which may have been established during the provisioning described above are checked to determine whether the mobile device is permitted to communicate using each provisioned service.

When the mobile device is configured to handle both fixed and mobile voice communications as described above the device may consequently be converted from a single line device a device associated with a single telephone number to a multiple line device. The mobile device may be registered with a cellular network service but at the same time it may be associated with a DID through the PBX . Therefore the device will be reachable through two distinct telephone numbers and each telephone number will be routed to a different path. In other embodiments it may be possible to provision the device with more than two telephone numbers.

Accordingly the mobile device may be configured with a user interface providing the user of the mobile device with access to all lines. Referring to a first example of a graphical user interface is shown displayed in the display of a mobile device configured for multiple line and dual mode service. The graphical user interface may comprise a banner display typically positioned across the top of the display . This banner display may be used to display current time and date information. In addition the banner display may feature information about the currently joined network and signal strength . In the example of the currently joined network is indicated to be an EDGE network.

The particular graphical user interface shown in is an options screen for managing the connections of the mobile device . The graphical user interface features options for turning on or off individual network connections here indicated as Mobile Network representing the cellular network Bluetooth and Wi Fi . In this example both the mobile and Wi Fi networks are indicated as being on. The graphical user interface also provides menu items to select further options screens for the mobile network Bluetooth and Wi Fi .

Turning to a further graphical user interface is shown displaying the status of services available at the mobile device . The graphical user interface lists Integrated Mobile Voice representing the fixed mobile convergence feature of receiving and placing calls via the PBX from the mobile device as being available and connected through the Mobile Network meaning that this voice service is provided via the data communication path through the wireless network shown in . Similarly the Mobile i.e. cellular service and the Enterprise Server service are indicated as being connected through the Mobile Network as well. In this example however Internet Service is indicated as being connected through the Wi Fi Network . This setting may have been established using a configuration setting or in response to an express user instruction to use the Wi Fi network for Internet service. The graphical user interface also shows current status information regarding the mobile network type and provider and some detail concerning the LAN in this example the Wi Fi network .

However the configuration of the graphical user interface through is generally selected at the time of the original provisioning of the fixed and mobile voice service on the device or alternatively when the mobile device is originally provisioned. Yet network conditions at the mobile device may vary at least for the reason that the user of the mobile device may on occasion leave the coverage area of one or more of the networks. Thus while the mobile device may have been originally provisioned as a dual mode device it may subsequently lose connectivity to either the LAN access point or the wireless network . Or the mobile device may have been originally provisioned with both cellular and LAN connectivity but enterprise policy may have changed to forbid use of the mobile device for calls routed outside the host system or the SIM card may have been removed from the mobile device . If a loss of connectivity to the wireless network occurs or if removal of the SIM card or a new configuration setting prevents use of the wireless network the telephone number associated with the cellular service will be invalid calls can neither be made from for received at that number. However the graphical user interface will not have changed and the invalid number will still be displayed to the user in the graphical user interface

Accordingly a method is provided for reconfiguring the user interface of the mobile device each time an integrated fixed and mobile voice communication system is initiated at the mobile device . Referring to at the system is initialized. At a determination is made whether the SIM or RUIM card is present in the mobile device . If it is not present then control passes to where it is determined whether the mobile device is an activated CDMA device. This may be determined by a review of the configuration settings stored at the device . If the device is not an activated CDMA device then it is determined at whether the device is provided with a LAN connectivity module such as a Wi Fi transceiver or a wired connection to a LAN.

If the device is so provided then at the user interface is adapted for one line mode as shown in . illustrates a graphical user interface similar to the graphical user interface of . However in this embodiment certain entries are removed from the user interface as they relate to cellular wireless service which is not available. Thus the graphical user interface lists only Bluetooth and Wi Fi as available network connections and provides menu options for these connections only. In addition the network connectivity information displayed in the banner of the graphical user interface indicates that the current service is Wi Fi. In the services status lists Integrated Mobile Voice as being available over a Wi Fi network rather than over a wireless cellular network. The other services Internet Service and Enterprise Server are listed as being available over the Wi Fi network only. In this example the status of the Mobile service shown in is not indicated at all in the graphical user interface as cellular service is not currently available in this example. In another embodiment the graphical user interface may indicate that the Mobile service is unavailable . Thus the current status information in reflects the only available network the Wi Fi network . In the mobile network options shown in the graphical user interface are limited only to the selection mode option since the unavailability of cellular service to the mobile device renders the option to choose a network provider moot.

Finally illustrates the adapted graphical user interface in the phone application for placing a call. The telephone number relating to the cellular network service since it is now invalid is removed from the user interface leaving the user with sole option of selecting the remaining DID number .

Thus following the branch of the process of described above results in an adaptation of the user interface to reflect the connectivity available to the mobile device . Also following the device may in some circumstances remain configured with its original graphical user interface. Returning to if it is determined that there is a SIM or RUIM present in the mobile device then it is determined at whether LAN connectivity in this example Wi Fi although the system may instead determine whether there is LAN connectivity through a different wireless connection or a fixed connection is provided on board the device . If it is not then the mobile device user interface is adapted to reflect that only the cellular service and the cellular telephone number is available to be used at . In some embodiments the mobile device may still be configured for a two line mode since the PBX may be configured to provide connections for both lines to the mobile device over the cellular network. If a LAN connection e.g. Wi Fi is available then at the mobile device s user interface may be adapted to reflect that there remain at least two possible lines to the mobile device so the user interface need not be adapted. Similarly if at it is determined that there is no SIM RUIM present but at it is determined that the mobile device is an activated CDMA device which does not require a SIM card at it is then determined whether the device is equipped with LAN connectivity. If it is not then again the mobile device s user interface is adapted to reflect that only cellular service is available. If LAN connectivity is available then the user interface may be adapted to reflect that there remain at least two possible lines to the mobile device . Thus if cellular service is not available to the mobile device then the mobile device s user interface may be adapted so that it appears that the device is a single line device but conversely if cellular service is available to the mobile device in this embodiment the device will be configured for cellular service regardless of the presence or absence of Wi Fi at the mobile device .

When the user interface is adjusted as described above further interface elements may be adapted as well. As shown in some icons displayed in the ribbon or the home screen of the mobile device may represent service entry points for services that require a cellular network connection another icon may represent another telephony service that is implemented through a LAN connection. Those icons representing services requiring the cellular network connection may be removed as a result of the user interface adjustment described above as shown in the user interface of which illustrates that of icons and only the icon relating to the service implemented through the LAN connection remains.

In the foregoing example the determination of the mobile device s availability for CDMA may be determined from the current IT settings or provisioning of the mobile device . Further in the method illustrated in the determination whether the mobile device user interface was to be adapted for single line mode was premised not only on the current IT settings or provisioning of the mobile device but also on whether the device was provided with a SIM RUIM . However the user of the mobile device may provide their own SIM RUIM although use of the phone on the cellular network may be prohibited by the enterprise s internal policies. Therefore as shown in in a further embodiment after initialization of the integrated fixed and mobile voice communication feature on the mobile device any relevant IT policy at the device is reviewed at . If as a result of the IT policy it is determined at that cellular service is to be inactivated then at the user interface of the mobile device is adapted to provide options for a single line the DID line available through the LAN only. If it is determined that cellular service is not to be inactivated then at the user interface is adapted for two line communication.

In a further embodiment referring to the mobile device may have been provisioned for Wi Fi or LAN connectivity only at and cellular network connectivity may have been disabled. This configuration may have been fixed at the time the mobile device was deployed in the enterprise network. In this embodiment the mobile device will enjoy LAN connectivity to the host system only so long as it is within the coverage area of the enterprise s LAN and similarly if the device is provisioned or configured for access to the home system via the access point it will enjoy connectivity to the host system provided it is in the coverage area of the access point . However if the user moves out of range or there is otherwise a loss of connectivity detected at the user interface automatically deactivates the menu options associated with the device . In this embodiment the user interface items may be merely greyed out or may be removed altogether similar to . When the mobile device regains the LAN signal at it may reconnect with the host system and advise of its return to the network and then reinitialize its integrated fixed and mobile voice communication system and attempt to re provision itself downloading any new IT policies or other settings at .

In still a further embodiment the mobile device may have been provisioned for dual mode communications as shown at of but may have been lacking the SIM or other registration information to be able to communicate over the cellular network. Accordingly a first user interface displayed by the mobile device may not include an option to select calling functions using the cellular network. As a next step any SIM RUIM in the device is detected at . Next it is determined at whether the device is provisioned with cellular functionality as well. If it is then the user interface is adapted by the mobile device for a multi line telephone mode including cellular communications at if the device is not so provisioned then the first user interface is retained at . In a further embodiment the mobile device may be configured to receive a second SIM card in addition to the first so if the new SIM card is detected at and the mobile device is provisioned for cellular communication at the user interface may be adapted for multi line telephone mode including communication over the cellular network using the additional SIM card.

Finally with respect to after the mobile device has been provisioned for both cellular and LAN communication at a loss of cellular connectivity may be detected at . At the mobile device may adapt the user interface to display only Wi Fi or LAN related options as described above. In addition at the device alters its default codec settings stored in its memory. It will be appreciated by those skilled in the art that when a connection is made between the mobile device and another device in the enterprise network the device and the other device negotiate the selection of the voice codec to be used for the particular network type and quality of the connection. The mobile device may store a list of available codecs with which it can negotiate. However the set of suitable codecs for use over the cellular network may be different from those that are suitable for use with another network such as a Wi Fi network. Therefore in this embodiment a first set of codecs may be identified in a first profile setting for use with a first cellular network however once it is detected that cellular connectivity has been lost it is presumed that future voice communication will be routed through the LAN so at the mobile device may retrieve a further set of codecs identified in a second profile setting for use with the LAN. This further set of codecs may then be used to negotiate a new voice connection with the other device.

The systems and methods disclosed herein are presented only by way of example and are not meant to limit the scope of the subject matter described herein. Other variations of the systems and methods described above will be apparent to those in the art and as such are considered to be within the scope of the subject matter described herein. For example it should be understood that steps and the order of the steps in the processing described herein may be altered modified and or augmented and still achieve the desired outcome.

The systems and methods data may be stored in one or more data stores. The data stores can be of many different types of storage devices and programming constructs such as RAM ROM flash memory programming data structures programming variables etc. It is noted that data structures describe formats for use in organizing and storing data in databases programs memory or other computer readable media for use by a computer program.

Code adapted to provide the systems and methods described above may be provided on many different types of computer readable media including computer storage mechanisms e.g. CD ROM diskette RAM flash memory computer s hard drive etc. that contain instructions for use in execution by a processor to perform the methods operations and implement the systems described herein.

The computer components software modules functions and data structures described herein may be connected directly or indirectly to each other in order to allow the flow of data needed for their operations. It is also noted that a module or processor includes but is not limited to a unit of code that performs a software operation and can be implemented for example as a subroutine unit of code or as a software function unit of code or as an object as in an object oriented paradigm or as an applet or in a computer script language or as another type of computer code.

A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by any one of the patent document or patent disclosure as it appears in the Patent and Trademark Office patent file or records but otherwise reserves all copyrights whatsoever.

