---

title: Residential gateway based policy
abstract: Various exemplary embodiments relate to a method performed by a policy server in a communication network. The method includes receiving an access request message including a residential gateway identifier and a subscriber identifier; evaluating a policy rule based on the residential gateway identifier, the policy rule including a condition referencing the residential gateway identifier; and responding to the access request message based on evaluation of the policy rule and the subscriber identifier. The method may further include: receiving an IP address of the residential gateway; storing the IP address in association with the residential gateway identifier; receiving, from a service portal, a request for identification of a residential gateway associated with an IP address; sending the stored residential gateway identifier to the portal; receiving new subscriber information; and changing the authorization of the residential gateway based on the new subscriber information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09473478&OS=09473478&RS=09473478
owner: Alcatel Lucent
number: 09473478
owner_city: Boulogne-Billancourt
owner_country: FR
publication_date: 20130924
---
This application is related to the following co pending application which is hereby incorporated by reference for all purposes as if fully set forth herein application Ser. No. 14 034 924 filed on Sep. 24 2013 SERVICE PROVIDER CERTIFIED DEVICE POLICY MANAGEMENT. 

Communications network operators often provide various service types to a customer. For example it is common for service providers to offer various combinations of voice video and high speed data service.

Service providers may provide customer equipment for accessing the various services. For example service providers may provide set top boxes and residential gateways. Customers may also connect their own equipment including residential gateways and set top boxes as wells as phones televisions and computers to the service provider s network.

The number of possible devices that a customer may connect to a service provider s network raise compatibility issues.

In view of the foregoing it would be desirable to allow service providers additional control over their networks. In particular it would be desirable to allow service providers to make policy decisions based on the type of residential gateway used by a customer. It would also be desirable to allow customers to select appropriate service plans based on their equipment.

In light of the present need for service provider control a brief summary of various exemplary embodiments is presented. Some simplifications and omissions may be made in the following summary which is intended to highlight and introduce some aspects of the various exemplary embodiments but not to limit the scope of the invention. Detailed descriptions of a preferred exemplary embodiment adequate to allow those of ordinary skill in the art to make and use the inventive concepts will follow in later sections.

Various exemplary embodiments relate to a method performed by a policy server in a communication network. The method includes receiving an access request message including an residential gateway identifier and a subscriber identifier evaluating a policy rule based on the residential gateway identifier the policy rule including a condition referencing the residential gateway identifier and responding to the access request message based on evaluation of the policy rule and the subscriber identifier.

In various embodiments the identifier is a dynamic host configuration protocol DHCP option vendor class identifier. The method may further include comparing the vendor class identifier to predefined identifiers and determining a type of the residential gateway.

In various embodiments the identifier is a MAC address. The method may further include comparing the MAC address to an address prefix.

In various embodiments the step of responding to the access request message based on evaluation of the policy rule and the subscriber identifier includes determining that the subscriber identifier is not associated with a valid service plan authorizing a default session allowing the residential gateway to communicate with a service portal and storing the residential gateway identifier and subscriber identifier in association with the default session.

In various embodiments the method further includes receiving an IP address of the residential gateway in an accounting start message storing the IP address in association with the residential gateway identifier receiving from a service portal a request for identification of a residential gateway associated with an IP address sending the stored residential gateway identifier to the portal receiving new subscriber information and changing the authorization of the residential gateway based on the new subscriber information. The method may further include determining residential gateway capabilities based on the residential gateway identifier and sending the residential gateway capabilities to the portal.

Various exemplary embodiments relate to a policy server. The policy server includes a network interface configured to receive an access request message initiated by a residential gateway attaching to a network the access request message including a residential gateway identifier and subscriber identifier and a rules engine processor configured to evaluate conditions of policy rules and execute actions corresponding to true conditions at least one policy rule including a condition based on the residential gateway identifier.

In various embodiments the condition of the at least one rule includes a certified residential gateway identifier and the action of the at least one rule instructs the rules engine to allow a session providing service to the residential gateway. The policy server may further include a session information storage configured to store information regarding the session including the residential gateway identifier and an application programming interface configured to provide an external service portal access to the session information and configured to receive subscriber information from the service portal.

In various embodiments the policy server further includes a device mapper configured to determine residential gateway characteristics based on the residential gateway identifier. The policy server may further include a session information storage configured to store the residential gateway characteristics determined by the device mapper and an application programming interface configured to provide an external service portal access to the residential gateway characteristics and configured to receive subscriber information from the service portal.

It should be apparent that in this manner various exemplary embodiments enable policy decisions based on a residential gateway. In particular a policy server may allow a network operator to identify a residential gateway used by a subscriber and make policy decisions based on characteristics of the residential gateway.

Referring now to the drawings in which like numerals refer to like components or steps there are disclosed broad aspects of various exemplary embodiments.

Telephone may be any telephone capable of providing digital voice over IP VoIP communication. Telephone may be a device supplied by a subscriber. Telephone may be a land line telephone meaning the telephone call is carried over a wired network rather than a radio access network. Telephone may establish a voice session with subscriber network . As will be discussed in further detail below a mobile device such as a smart phone may establish a data session rather than a voice session.

Set top box may be a device that provides video service to a subscriber s television. Set top box may be provided by a service provider as part of a subscriber s service package. In various embodiments set top box may also include various devices provided by a subscriber. For example set top box may be a cable card integrated into a television. As another example set top box may be a third party set top box purchased by the subscriber.

Computer may be any device that establishes a data session with network . Computer may include desktop computers laptop computers tablets smart phones and any other device that establishes a data session.

Residential gateway may be a device that connects one or more subscriber devices to network . In various embodiments residential gateway may be a wireless router providing a data connection using a wireless protocol such as any of the 802.11 wireless protocols. Residential gateway may also provide for wired Ethernet connections. In various embodiments residential gateway may include a DSL modem cable modem or optical network terminal ONT . When connected residential gateway may initiate a network connection using DHCP. An initial DHCP discover request may include a residential gateway identifier. A residential gateway identifier may include any identifier that uniquely identifies the residential gateway or a non unique identifier that identifies properties of the residential gateway . In various embodiments the residential gateway identifier may be in the form of a MAC address DHCP option vendor class identifier or a combination of both.

DSLAM may be a device controlled by a service provider. The DSLAM may include a plurality of ports for connecting to residential gateway subscriber premises equipment or customer premises equipment CPE . Accordingly DSLAM may aggregate the connections of a plurality of subscribers. DLAM may send and receive traffic from a backbone connection to service router . In various embodiments DSLAM may be connected to a fiber optic backbone and function as an optical line terminator OLT . DSLAM may add physical connection information such as a circuit ID to a service request.

Service router may be a router configured to process data traffic for a subscriber. Service router may receive packets and forward them toward their destinations. Service router may also be involved in subscriber access and authentication. Service router may receive an access request or a DHCP discover request originating from any device and generate a RADIUS access request to policy server . Service router may also forward the DCHP discover request toward a DHCP server . Service router may include any known subscriber and device information in the service request.

Network may be a communications network for transmitting information. In various embodiments the network may be an internet protocol IP core network of a network operator. The network may interconnect various network nodes of the network operator such service router DHCP server policy server and service portal . The network may be further connected to other networks forming part of the Internet. The network may include a plurality of intermediate network nodes such as routers and switches which are not shown.

DHCP server may be a server configured to implement the dynamic host configuration protocol. DHCP server may be integrated with another network server such as for example service router or policy server . DHCP server may assign an internet protocol IP address to a residential gateway in response to a DCHP request.

Policy server may be a server controlled by a service provider for managing a subscriber network. Policy server may be a RADIUS server communicating with one or more RADIUS clients such as for example service router . Policy server may be responsible for managing subscriber account information and making policy decisions regarding subscriber sessions. As will be described in further detail below policy server may be configured to make policy decisions based on a residential gateway identifier. Accordingly policy server may control which residential gateways are allowed access to the network . Policy server may also be responsible for enforcing service level agreements and processing billing information for subscribers. Policy server may further communicate with a service portal to allow a subscriber to access service plan information and change service plans.

Service portal may be a server controlled by a network operator. Service portal may allow subscribers to view subscription and usage information to change subscriptions to make payments to order customer equipment or perform other tasks related to a subscription. Service portal may be a web server configured to interact with subscribers of the network operator using standard web protocols such as HTTP. Service portal may interact with a policy server using an application programming interface which will be described in further detail below.

Network interface may include hardware and or instructions encoded on a machine readable storage medium executed by a processor to send and receive data. In various embodiments network interface may be configured to communicate using the RADIUS protocol. Network interface may be configured to receive RADIUS messages and extract information in the form of attribute value pairs. Network interface may also be configured to generate and transmit RADIUS messages to various RADIUS clients such as a service router .

Policy engine may include hardware and or instructions encoded on a machine readable storage medium executed by a processor to make policy decisions. Policy engine may evaluate policy rules to make policy decisions. Policy engine may apply the policy rules to information received via network interface as well as information in subscriber information storage and any other available information. Policy engine may include various rule sets that may be evaluated based on a particular event or context. For example policy engine may evaluate an attachment rule set whenever policy server receives a message indicating a new device is attaching to the network . An attachment rule set will be further described with respect to . Generally a policy rule may include a condition and an action. Policy engine may evaluate the condition and execute the action if the condition is true.

Device mapper may include hardware or executable instructions encoded on a machine readable storage medium configured to determine a model of user equipment. In particular device mapper may determine information regarding a residential gateway based on a residential gateway identifier included in an access request message. Device mapper may use a MAC address as a residential gateway identifier. Device mapper may determine a type of the residential gateway based on a prefix of the MAC address or a range of MAC addresses. The type may include a model name a classification or other grouping of similar devices. Device mapper may also use a DHCP option vendor class identifier as a residential gateway identifier. Device mapper may compare all or part of the vendor class identifier to known vendor class identifiers to determine whether a received vendor class identifier is known. Device mapper may also be configured with information regarding the capabilities of known residential gateways. For example device mapper may store protocol version information and bandwidth limits for each known residential gateway type.

Session information storage may be a non transitory machine readable storage medium configured to store session information for sessions managed by policy server . Session information storage may store any information received in a request in association with session identifiers used by policy server . In particular information for a session authorized by policy server may include a session identifier residential gateway information including a residential gateway identifier and an IP address assigned to the residential gateway for the session.

Subscriber information storage may be a machine readable storage medium configured to store subscriber information. Subscriber information may include a service plan selected by the subscriber. A service plan may include session limits such as bandwidth limits and allowed services. Policy server may consider subscriber information when authorizing a session for a subscriber.

Application programming interface API may include hardware or executable instructions encoded on a machine readable storage medium configured to communicate with an external device such as a service portal . API may provide authorization features to ensure that the external device is allowed to communicate with policy server . API may make various features of policy server available to an external device. For example API may provide access to information stored in device mapper session information storage or subscriber information storage . Accordingly API may be able to provide an external device with session information including subscriber information and residential gateway information. API may also allow service portal to update subscriber information storage with updated subscriber information.

Name field may indicate a name of the rule. The name of the rule may be selected by the network operator to identify the rule. Name field may also include a unique identifier.

Condition field may include one or more logical statements that may be evaluated by policy engine . Condition field may reference information received in a message or stored at the policy server . For example in various embodiments the MAC address received in an access request message may be referenced as NASREQ Message.ALUTIMETRA.ALC Client Hardware Addr. A condition field may reference a plurality of pieces of information. A condition field may also access information provided by device mapper such as a residential gateway characteristics including for example a type model protocol or capability.

Action field may indicate one or more actions for policy server to execute if the condition is true. For example action field may indicate how policy server should respond to a request. Accordingly rules table may be used to make policy decisions to select actions in response to requests.

Rules may be rules configured by a network operator. For example rule may be named Certified Devices and determine whether a device attempting to attach to the network is on a list of certified devices. For example rule may allow access if the prefix of the MAC address matches either 00 22 68 or 00 18 3f. Rule may include a plurality of MAC addresses. Alternatively rule may define allowed devices using other residential gateway information such as the vendor class identifier or residential gateway characteristics provided by device mapper . As another example rule may be named Blocked Devices and determine whether a device attempting to attach to the network is on a list of banned devices. If the device is on the banned list policy server may deny the request to attach to the network. As another example rule may be named Certified Device Unknown Subscriber. Rule may determine that the device is a certified device and the subscriber is unknown and provide default services to the device. Default services may be for example access to only service portal which may be used to sign up for full services.

In step the policy server may receive an access request message requesting authorization of services for a residential gateway . The access request message may include information regarding the residential gateway including a MAC address DHCP option vendor class identifier and a subscriber identifier as well as other network information such as a network access server address circuit ID port type and port ID. In various embodiments the residential gateway may receive an IP address only after authorization by the policy server .

In step the policy server may analyze the MAC address of the residential gateway using the device mapper . For example the policy server may analyze a prefix or an organizationally unique identifier OUI contained in the first three octets of the MAC address to determine a vendor or manufacturer of the residential gateway. The device mapper may further analyze the MAC address based on a range of addresses or manufacturer specification to determine further device details. In various embodiments a MAC address prefix or range of MAC addresses may be directly included in a policy rule condition.

In step the policy server may analyze a DHCP option Vendor Class Identifier. The DHCP option Vendor Class Identifier VCI may be included by the residential gateway in a DHCP discover message and included in the access request message by a network access server such as service router . The device mapper may analyze the VCI by comparing the contents to known strings using partial matching. For example device mapper may determine whether the VCI includes a name or abbreviation of a known vendor. Device mapper may perform more specific analysis for vendors that use well defined VCIs. In various embodiments the VCI comparison may be directly included in a policy rule condition.

In step policy server may determine whether the residential gateway is a certified device or a banned device. In various embodiments only those residential gateways matching established criteria may be considered certified devices. Similarly in various embodiments only those residential gateways matching established criteria may be considered banned devices. It may be impossible to match some devices such as for example devices from new manufactures new models and devices having poorly defined vendor class identifiers or MAC address ranges. Policy server may be configured to allow or deny access where it is impossible to determine a match based on operator preferences. For example a policy rule may be written to exclude any device that does not match the certified devices or a policy rule may be written to allow any device that does not match the banned devices. If the residential gateway is a certified device the method may proceed to step . If the residential gateway is a banned device the method may proceed to step .

In step the policy server may deny the access request. The policy server may transmit a rejection message to service router . Service router may then end the connection. The residential gateway may not receive an IP address. Accordingly the denial of the access request by the policy server may prevent the residential gateway from obtaining access to the network. The method may then proceed to step where the method ends.

In step the policy server may determine whether a subscriber identifier included in the access request message matches a known subscriber. Policy server may query subscriber information storage with the subscriber identifier to retrieve a subscriber profile. If the subscriber is known the method may proceed to step . If the subscriber is unknown the method may proceed to step .

In step the policy server may send a default profile for the unknown subscriber in an access accept message to the service router . The default profile may be used by the service router to provide only limited service to the residential gateway . As will be described in further detail regarding the default profile may enable the residential gateway to communicate with a service portal for establishing a subscriber profile. The method may then proceed to step .

In step the policy server may send a service profile in an access accept message based on the subscriber profile. The service profile may include subscriber quality of service QoS settings such as bandwidth limits and charging information. In various embodiments the service profile may also be based on residential gateway information. For example the policy server may limit the QoS settings based on the capabilities of the residential gateway. Policy server may store information regarding the session of the residential gateway in the session information storage . In particular session information storage may store a session identifier in association with the subscriber identifier and residential gateway information. The method may then proceed to step .

In step the policy server may receive and store an IP address associated with an established session. The IP address may arrive in for example an accounting start message for the session. The policy server may add the IP address to the session information storage in association with the session identifier subscriber identifier and residential gateway information. The method may then proceed to step where the method ends.

In step the residential gateway may initiate attachment to the network . The residential gateway may transmit a DHCP discover request toward service router . In step service router may generate an access request message to send to policy server . The access request message may be a RADIUS message. The access request message may correspond to the access request message described above regarding step .

In step policy server may evaluate policy rules based on information received in the access request message. Accordingly step may include steps and described above. In particular the policy server may determine that the residential gateway is a certified or otherwise allowed device but the subscriber is unknown. In step the policy server may send an access accept message including the default profile for the unknown subscriber. The default profile may include instructions to redirect all HTTP requests from residential gateway to service portal .

In step the service router may forward the DHCP discover request on toward DHCP server . In step the DHCP server and residential gateway may communicate using DHCP to establish a connection and an IP address for residential gateway . Service router may pass messages between DHCP server and residential gateway and extract any information necessary for configuring service router to establish the connection. In step service router may send an accounting start message to policy server indicating that the connection has been established. The accounting start message may include the IP address assigned to residential gateway . As discussed above regarding step the policy server may store the IP address in association with a session identifier subscriber identifier and residential gateway information.

In step the residential gateway or a user device behind residential gateway may send an HTTP GET request. For example the residential gateway may request a website. In step the service router may redirect the HTTP request to the service portal based on the default profile. In step the residential gateway may send an HTTP request to the service portal . The HTTP request may identify the residential gateway using the IP address of residential gateway . In various embodiments a known user may directly send an HTTP request to the service portal in order to access or update subscription information.

In step the service portal may contact the policy server using the API . In particular the service portal may invoke a function to request session information matching an IP address from policy server . Policy server may query the session information storage using the IP address determine the session information. In step the policy server may send the session information to the service portal. In various embodiments the policy server may provide only raw information such as the contents of the access request message including a MAC address or DHCP option vendor class identifier. If the subscriber is a known subscriber the policy server may also send current subscriber information. The policy server may also send any additional information generated by the device mapper . For example the policy server may send a vendor name type model or capabilities of the residential gateway . Alternatively the service portal may include a device mapper and generate such information from the raw information.

In step the service portal may generate a list of customized service plans based on the residential gateway . The customized plans may be selected according to the capabilities of the residential gateway . For example the customized plans may include QoS limits that the residential gateway is capable of providing. Therefore a customer may be prevented from selecting a plan that the residential gateway is incapable of providing. The customized plans may include plans specifically designed to use the maximum capabilities of the residential gateway .

In step the service portal may send an HTTP webpage including the customized plans to the subscriber. In step the subscriber may select a plan agree to terms of service and provide payment or billing information. In step the service portal may use the API to send updated plan information to the policy server . The updated plan information may include service and billing information for the subscriber.

In step policy server may evaluate policy rules based on the new subscriber information. In particular policy server may determine that a previously unknown subscriber is now known. Policy server may determine new authorization for the known subscriber based on the selected plan. If the subscriber has updated an existing service plan the policy server may also update the authorization to reflect any changes made by the subscriber. In step the policy server may send a RADIUS change of authorization CoA message to the service router with a new profile for the residential gateway . In step the service router may acknowledge the CoA message indicating that the new profile has been implemented. The method may then end.

According to the foregoing various exemplary embodiments provide for policy decisions based on a residential gateway. In particular a policy server may allow a network operator to identify a residential gateway used by a subscriber and make policy decisions based on characteristics of the residential gateway.

It should be apparent from the foregoing description that various exemplary embodiments of the invention may be implemented in hardware and or software executed by a processor. Furthermore various exemplary embodiments may be implemented as instructions stored on a machine readable storage medium which may be read and executed by at least one processor to perform the operations described in detail herein. A machine readable storage medium may include any mechanism for storing information in a form readable by a machine such as a personal or laptop computer a server or other computing device. Thus a machine readable storage medium may include read only memory ROM random access memory RAM magnetic disk storage media optical storage media flash memory devices and similar storage media.

It should be appreciated by those skilled in the art that any block diagrams herein represent conceptual views of illustrative circuitry embodying the principals of the invention. Similarly it will be appreciated that any flow charts flow diagrams state transition diagrams pseudo code and the like represent various processes which may be substantially represented in machine readable media and so executed by a computer or processor whether or not such computer or processor is explicitly shown.

Although the various exemplary embodiments have been described in detail with particular reference to certain exemplary aspects thereof it should be understood that the invention is capable of other embodiments and its details are capable of modifications in various obvious respects. As is readily apparent to those skilled in the art variations and modifications can be affected while remaining within the spirit and scope of the invention. Accordingly the foregoing disclosure description and figures are for illustrative purposes only and do not in any way limit the invention which is defined only by the claims.

