---

title: Certification of virtual machine images in cloud computing environments
abstract: Virtual machine images in a cloud computing environment may be certified using a validator machine image. The validator machine image is configured to boot a validator virtual machine, which boots a virtual machine off a virtual machine image from among virtual machine images available in the catalog of the cloud computing environment. The validator virtual machine may scan the virtual machine for malware, including computer viruses. A virtual machine image from among the virtual machine images may be packaged to include a certifier agent that verifies the virtual machine image upon execution. Reputation of virtual machine images may be stored in a virtual machine image reputation database and made available by way of a portal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08893279&OS=08893279&RS=08893279
owner: Trend Micro Incorporated
number: 08893279
owner_city: Tokyo
owner_country: JP
publication_date: 20131031
---
This application is a continuation of U.S. application Ser. No. 13 087 186 filed on Apr. 14 2011 which is incorporated herein by reference in its entirety.

The present invention relates generally to computer security and more particularly but not exclusively to security of cloud computing environments.

Virtual machines in general are well known in the art of computer science. Generally speaking a virtual machine is a software implementation of a machine i.e. a computer that executes programs like a physical machine. Multiple virtual machines may run on a single computer hardware platform which is also referred to as host machine. Although the virtual machines run in the same host machine each virtual machine has its own operating system and application programs and functions as a computing environment separate from the host machine and the other virtual machines.

Cloud computing refers to services storage processing and other computing tasks performed over a computer network using distant server computers. Cloud computing provides computational resources to an end user without the end user setting up his own computing infrastructure. Examples of public cloud service providers include Amazon Web Services Rackspace and GoGrid . OpenStack is an example open software initiative for building public and private cloud computing environments.

Public cloud computing allows for utility model pricing. That is the user typically pays only for what he uses. To facilitate setup and use of a cloud computing service cloud service providers either offer pre built virtual machine images themselves or offer a marketplace where a third party can sell or give pre built virtual machine images to users. A virtual machine image comprises a data file that stores all information including operating system application programs etc. required to startup one or more simultaneous and active virtual machines. The licensing aspects of using virtual machine images e.g. those with Microsoft Windows software may be built into the pricing of the virtual machine images and some cloud service providers have worked out agreements with some software vendors.

A virtual machine image which also referred to simply as machine image may include an operating system and other software for providing services in the cloud computing environment. A problem for customers when taking advantage of pre built virtual machine images has to do with trust. That is the customer does not know whether or not the virtual machine images are free of malware such as computer viruses Trojans spyware and other malicious codes. To make matters worse malware writers may perform actions to artificially increase the reputation of a virus infected virtual machine image to make the machine image more attractive to end users.

In one embodiment a method of certifying a virtual machine image in a cloud computing environment includes installing an anti malware in a virtual machine. The anti malware is used to scan the virtual machine for presence of malware. In response to finding that the virtual machine image is free of malware the anti malware is removed from the virtual machine and an original fingerprint is generated and stored in the virtual machine. The virtual machine is saved as a virtual machine image after removing the anti malware from the virtual machine and storing the original fingerprint in the virtual machine. The virtual machine image is listed in a catalog of a public cloud computing environment.

In another embodiment a method of certifying a virtual machine image in a cloud computing environment includes booting a validator virtual machine from a validator virtual machine image. The validator virtual machine boots a target virtual machine from a target virtual machine image. The validator virtual machine injects a security module into the target virtual machine. The security module scans the target virtual machine for malware. The security module is removed from the target virtual machine after scanning the target virtual machine for malware.

In another embodiment a computer system comprises a plurality of virtual machine images available for public access from a catalog of a public cloud computing environment. A validator virtual machine image is available for public access from the catalog. The validator virtual machine image is configured to be executed to boot a validator virtual machine which is configured to boot a virtual machine from a virtual machine image in the plurality of virtual machine images and to scan the virtual machine for malware.

These and other features of the present invention will be readily apparent to persons of ordinary skill in the art upon reading the entirety of this disclosure which includes the accompanying drawings and claims.

In the present disclosure numerous specific details are provided such as examples of apparatus components and methods to provide a thorough understanding of embodiments of the invention. Persons of ordinary skill in the art will recognize however that the invention can be practiced without one or more of the specific details. In other instances well known details are not shown or described to avoid obscuring aspects of the invention.

The computer system is a particular machine as programmed with software modules . The software modules comprise computer readable program code stored non transitory in the main memory for execution by a processor . The software modules may be loaded from the data storage device to the main memory . The software modules may also be made available in other computer readable medium including optical disk flash drive and other memory device.

In one embodiment the computer system is configured as a host machine for a plurality of virtual machines in a cloud computing environment. An end user referred to herein as a customer may use a client computer to connect to the computer system over the Internet to access and use a virtual machine.

In the example of the computer system provides a hardware computing platform for a cloud computing environment . The computer system and the cloud computing environment form a cloud computing infrastructure and may be maintained and operated by a public cloud service provider. As a particular example embodiments of the present invention may be implemented on cloud computing platforms provided by the Amazon Web Services .

The cloud computing environment may provide service to many different unrelated customers. The cloud computing environment may provide ready built virtual machine images i.e. . . . . A virtual machine image may comprise a data file that stores all information including operating system application programs etc. required to boot i.e. startup one or more simultaneous and active virtual machines. A virtual machine image may correspond to an Amazon Machine Image AMI offered to customers of the Amazon Web Services for example.

A customer may use a ready build virtual machine image from a catalog of virtual machine images offered on the cloud computing environment . A virtual machine image may offered for free lease or purchase for example. A virtual machine image listed in the catalog may be from the cloud service provider or from a third party such as another customer. When a customer selects to use a virtual machine image from the catalog that virtual machine image becomes available in the customer s console. A console may comprise a shell or other interface to allow a customer to select and execute a virtual machine image to boot an instance i.e. startup a virtual machine based on the virtual machine image. As can be appreciated the virtual machine has the operating system application programs etc. of its corresponding virtual machine image. The virtual machine image selected from the catalog may appear as is in the customer s console. The customer may also choose to install his own software as needed and re package the virtual machine image as his own modified virtual machine image.

The catalog may also list a virtual machine image . As will be more apparent below the virtual machine image is a validator virtual machine image in that it may be executed to boot a validator virtual machine for validating a virtual machine image .

In the example of the customer purchased the virtual machine image from the catalog of virtual machine images available in the cloud computing environment. This results in the virtual machine image being made available in the customer s console. The customer may select to execute the virtual machine image to boot virtual machines . A virtual machine may run an email server database server or other service or application. Generally speaking a virtual machine image is in storage state while an instance of the virtual machine image i.e. its corresponding virtual machine is in running state.

A virtual machine image may contain malware. For example a virtual machine image listed in the catalog may be infected with computer virus. In the case of a third party virtual machine image such as machine image the safety of the virtual machine image may be validated by provenance. That is the safety of the virtual machine image may be validated by verifying the integrity of the build chain from the base machine image to the current machine image. As a particular example the safety of the virtual machine image may be validated by ensuring that it was created from the machine image which is from the cloud service provider. The provenance approach necessarily assumes that the cloud service provider is trustworthy and that the third party selling the virtual machine image is itself trustworthy. However meta data provided at the virtual machine image level may be insufficient to verify the integrity of the build chain. Validating a virtual machine image by provenance is also hampered by the difficulty in mounting and reading a virtual machine image without instantiating a virtual machine off it.

A virtual machine image from the cloud service provider itself may also be deemed safe by provenance. For example the virtual machine image may be validated by ensuring that it came from the cloud service provider. However the same difficulties associated with relying on provenance remains including insufficient meta data information and limited inspection of a virtual machine image. In addition the customer may install additional applications in a virtual machine and save the virtual machine as a virtual machine image. The newly saved virtual machine image may no longer be safe because of the added applications.

The validator machine image may comprise computer readable program code for validating a virtual machine image . In one embodiment the validator machine image is configured to be executed from a customer console to boot a validator virtual machine . The validator virtual machine may be configured to validate a target virtual machine image by booting a target virtual machine off the target virtual machine image examining the target virtual machine for presence of malware and validating the target virtual machine image based on the results of the examination. Unlike traditional security solutions that continuously run in the virtual machine the validator virtual machine image may be executed on an as needed basis. For example the customer may execute the validator virtual machine image only when a new virtual machine image is received and after the virtual machine image is modified e.g. by adding applications . This saves on processing costs which in a cloud computing environment can add up because cloud service providers typically charge by CPU and storage usage.

In the example of the customer purchased a machine image from the catalog of the cloud computing environment arrow . The machine image may be from the customer service provider or a third party. To validate the machine image the customer also selected the validator machine image from the catalog of the cloud computing environment arrow on a pay per use basis or outright purchase for example. The customer selects the validator machine image from the customer s console for execution creating an instance of a validator virtual machine in the customer s user space which in this example includes virtual machine images accessible from the customer s console. The validator virtual machine may include a user interface for receiving instructions from the customer including a way of indicating which of the customer s machine images is to be validated. In the example of the customer s machine image has been selected for validation to determine whether or not the machine image is safe to use. The validator virtual machine boots one or more virtual machines from the customer machine image . Thereafter the validator virtual machine validates the customer s virtual machine image by examining at least one virtual machine for malware including computer viruses and other potential threats arrow . The validator virtual machine may provide a report of the validation indicating whether the customer s machine image is safe bad or in an unknown state based on the result of examining the virtual machine . The report may be presented on a display monitor in a log as an email alert or in other ways of presenting or sending a report.

In the example of the validator machine image is made available in the catalog of the cloud computing environment step . For example the validator machine image may be made available to customers by listing it along with other virtual machine images in the catalog. The validator machine image is made accessible from the console of a customer who decided to use the validator machine image . The customer may lease pay per use rent or purchase the validator machine image for example. The validator machine image may be moved to the customer console by providing a pointer to or a copy of the validator machine image for example.

The customer selects the validator machine image from the console for execution. This results in the booting of a validator virtual machine off the validator virtual machine image step . The validator virtual machine boots a virtual machine step which is the target virtual machine in this example off the virtual machine image . The validator virtual machine injects the security module into the virtual machine step . The security module examines the virtual machine for malware e.g. by scanning the virtual machine for computer viruses step . The security module sends its output which in this case is the results of the examination to the validator virtual machine step . The validator virtual machine may generate a report of the results. The report may indicate that the virtual machine image is safe bad or in an unknown state depending on the results of the examination of the virtual machine . For example the virtual machine image may be reported as bad when the virtual machine is found infected with malware. As another example the virtual machine image may be reported as safe when the virtual machine is found to be clean and safe to use. The virtual machine image may be reported as in an unknown state when the security module cannot complete its evaluation of the virtual machine . The security module is removed from the virtual machine upon completion of the evaluation step .

A typical process of creating a virtual machine image involves preparing the base image with the operating system installing the requisite applications in the virtual machine image packaging the virtual machine image and submitting and registering the virtual machine image for public use. A customer that uses the virtual machine image creates an instance of a virtual machine from the virtual machine image. However as previously mentioned the customer typically has no way of verifying that that the virtual machine image and hence its virtual machines is safe. In another aspect of the present disclosure a virtual machine image is certified by incorporating the certification process in the preparation of the virtual machine image for public offering. This aspect of the present disclosure is now explained beginning with .

In the example of a virtual machine image is prepared with its operating system step . A bare bones or base virtual machine image with an operating system may be made available by the cloud service provider or vendor of the cloud computing platform. The virtual machine image is executed to boot a corresponding virtual machine. Requisite software such as applications servers and the like are installed in the virtual machine step . A certifier agent and an anti malware are also installed in the virtual machine step . The just described steps are also illustrated in where applications an anti malware and a certifier agent are installed in a virtual machine with operating system see A .

The anti malware may comprise computer readable program code for examining a virtual machine image for malware. The anti malware may employ suitable anti malware algorithms such as pattern matching without detracting from the merits of the present invention. In one embodiment the anti malware is configured to scan the components of a virtual machine for malware including computer viruses. The anti malware may include a pattern file comprising patterns of known malware. To detect malware the anti malware may compare contents of files and other components of the virtual machine to patterns in the pattern file.

The certifier agent may comprise computer readable program code for certifying a virtual machine image. In one embodiment the certifier agent is configured to generate a fingerprint of a virtual machine that is deemed free of malware. The fingerprint may be based on scan time pattern file used to scan the virtual machine for malware other potentially unique aspects of the virtual machine. The certifier agent may encrypt the fingerprint and store the fingerprint in a predetermined location in the virtual machine.

The anti malware is executed to scan the virtual machine for malware step . When the virtual machine is found to be safe e.g. free of malware the certifier agent generates a fingerprint of the virtual machine step . These steps are also illustrated in where the certifier agent generates a fingerprint of the virtual machine see B found to be free of malware. The certifier agent may encrypt the fingerprint and store it in a predetermined location in the virtual machine . This fingerprint also referred to as original fingerprint may be compared to a new recomputed fingerprint to detect modification or tampering of the virtual machine and hence its corresponding virtual machine image.

The anti malware is uninstalled from the virtual machine after scanning the virtual machine for malware step . This is shown in where the anti malware is removed from the virtual machine see C . The virtual machine is then saved as a virtual machine image in a process also referred to as packaging. The packaging of the virtual machine image is illustrated in where the virtual machine is saved as a certified virtual machine see arrow . The virtual machine image may then be registered and submitted to be included in the catalog of the cloud computing environment. The virtual machine image may be published in the catalog as being certified to make the virtual machine image more desirable to potential customers. For example the virtual machine image may be published as Trend Certified to indicate that the virtual machine image has been certified by Trend Micro Inc. to be free of malware.

When the virtual machine is booted off the virtual machine image from a customer console the certifier agent automatically runs and verifies that the virtual machine image has not been modified or tampered with step . For example the certifier agent may verify that the virtual machine booted off the virtual machine image is in the same condition as when the virtual machine was scanned for malware found to be free of malware and then fingerprinted. To verify the virtual machine image the certifier agent may re compute the fingerprint of the virtual machine to generate a recomputed fingerprint retrieve and decrypt the original fingerprint and compare the recomputed fingerprint to the original fingerprint to verify that that the virtual machine image is in its certified condition. If the recomputed fingerprint is not the same as the original fingerprint the virtual machine image has somehow been modified since it was packaged by its source. As can be appreciated the just described certification process gives customers a measure of confidence when getting a virtual machine image from a public source such as a catalog of a public cloud computing environment shared by many different entities.

In another aspect of the present disclosure reputation of virtual machine images may be stored and maintained in a reputation database and offered to customers by way of a portal. As a particular example a reputable computer security vendor may evaluate popular virtual machine images for safety e.g. by scanning for malware. The result of the evaluation such as whether a virtual machine image is safe bad or in an unknown state may be stored in a virtual machine image reputation database see . A hash or other unique identifier of a virtual machine image may be generated and stored along with the virtual machine image s reputation to uniquely identify the virtual machine image. A customer client computer may connect to the computer system which serves as the portal to get a reputation of a virtual machine image.

While specific embodiments of the present invention have been provided it is to be understood that these embodiments are for illustration purposes and not limiting. Many additional embodiments will be apparent to persons of ordinary skill in the art reading this disclosure.

