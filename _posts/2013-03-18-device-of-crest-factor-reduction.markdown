---

title: Device of crest factor reduction
abstract: The present disclosure provides a device () of crest factor reduction for a multi-carrier signal. The device () includes: a peak detector () adapted to receive a sampled representation of the multi-carrier signal, detect a peak from the sampled representation and obtain a value and a time domain location of a cancellation peak for cancelling the peak; a plurality of peak cancellation signal generators () each corresponding to a carrier of the multi-carrier signal and adapted to generate a peak cancellation signal within a frequency band of its corresponding carrier based on the value and time domain location of the cancellation peak; and a subtractor () adapted to subtract the peak cancellation signals from the sampled representation after being delayed. The present disclosure also provides another device of crest factor reduction, a multi-stage crest factor reduction circuit and a peak detector.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09521024&OS=09521024&RS=09521024
owner: Telefonaktiebolaget LM Ericsson (publ)
number: 09521024
owner_city: Stockholm
owner_country: SE
publication_date: 20130318
---
This nonprovisional application is a U.S. National Stage Filing under 35 U.S.C. 371 of International Patent Application Serial No. PCT CN2013 072820 filed Mar. 18 2013 and entitled DEVICE OF CREST FACTOR REDUCTION. 

The present invention relates to signal processing technology and more particularly to a device of Crest Factor Reduction CFR .

Peak to Average Power Ratio PAPR is one of the most critical problems in an Orthogonal Frequency Division Multiplexing OFDM system. In a radio front end a high PAPR may lead to serious back off and thus a low efficiency of a power amplifier PA . To reduce the PAPR of an OFDM signal a number of Crest Factor Reduction CFR techniques have been proposed. They can be classified into two categories coding based CFR and clipping based CFR. The coding based CFR techniques cause no signal distortion but have high computational complexity and low spectrum efficiency. When one Remote Radio Unit RRU is connected to multiple Digital Units DUs the coding based CFR techniques are not applicable and therefore only the clipping based techniques can be considered. The clipping based CFR techniques solve a problem that can be represented as given an input signal how to obtain an output signal with the lowest PAPR while satisfying requirements of Error Vector Magnitude EVM and Adjacent Channel Leakage Ratio ACLR .

Noise Shaping NS CFR see X. Li L. J. Cimini Jr Effects of Clipping and Filtering on the Performance of OFDM in Proc. of Vehicular Technology Conference IEEE pp. 1634 1997 is one of the most popular clipping based CFR algorithms. As shown in a NS CFR device extracts from an input signal a signal sample which exceeds a certain threshold and shapes it using a noise shaping filtering to obtain a shaped noise signal. Then the shaped noise signal is subtracted from the original input signal.

For a better PAPR performance a cascaded clipping scheme can be applied. Normally four to six CFR stages are needed. The complexity of a NS CFR device is mainly caused by the noise shaping filter. To reduce the complexity a carrier de combiner including carrier transposing and down sampling functions can be provided following the NS CFR device. An up sampler may also be needed see H. Chen and A. M. Haimovich Iterative estimation and cancellation of clipping noise for OFDM signals IEEE Commun. Lett. vol. 7 no. 7 pp. 305 307 July 2003 .

Most samples of the noise signal in the NS CFR algorithm are zeros. To improve the efficiency a Peak Cancellation PC CFR see E. Hemphill S. Summerfield G. Wang and D. Hawke Peak Cancellation Crest Factor Reduction Reference Design XAPP1033 V1.0 Xilinx Nov. 18 2007 algorithm has been proposed. shows a structure of a typical PC CFR device. When a peak is detected from an input signal by a peak detector the PC CFR device allocates the peak to a peak generation unit PGU which then generates a pre shaped and scaled cancellation peak to be subtracted from the input signal after being subjected to a matched delay. Since peaks are sparse in time a small number of PGUs are generally sufficient to fulfill the clipping task. However since the number of PGUs is limited it is always possible that when all PGUs are occupied a new coming peak will be missed. This will lead to a problem of peak leakage and create a high risk for a PA. This problem can be mitigated by a cascaded clipping scheme. A typical implementation of PC CFR has two to four clipping stages.

Compared with the PC CFR algorithm the complexity of the NS CFR algorithm is higher while the required PAPR is not very low. However the NS CFR can guarantee that all peaks are eliminated. On the other hand the PC CFR is efficient in canceling high peaks with low EVM and ACLR costs but its peak leakage is a fatal problem. That is both algorithms have their own advantages and disadvantages. Thus there is need for a CFR structure that can utilize the advantages of both CFR algorithms to obtain an improved performance in terms of PAPR EVM and ACLR.

In Long Term Evolution LTE systems the CFR techniques face a new challenge from increased information bandwidth and increased number of carriers. For a multi carrier signal such as an OFDM signal its PAPR increases with the increase of its bandwidth. The performance of the CFR algorithm highly depends on the sampling rate of the input signal. The sampling rate and thus the complexity will increase with the increase of the signal bandwidth. For example if the signal bandwidth doubles the complexity of the CFR algorithm increases by at least a factor of 2. The complexity of the CFR algorithm also increases with the increase of the number of carriers of the signal. Thus a CFR algorithm or structure with low complexity is highly desired especially for a multi carrier signal.

Additionally as noted above the peak leakage is a serious defect of the PC CFR algorithm especially for high peaks. If a high peak is leaked the PAPR performance will be severely degraded. Therefore it is desired that if the peak leakage is inevitable due to limited number of PGUs in a PC CFR device the probability of high peak leakage can be minimized.

It is an object of the present invention to solve at least one of the above problems in the prior art.

According to a first aspect of the present invention a device of crest factor reduction for a multi carrier signal is provided. The device includes a peak detector adapted to receive a sampled representation of the multi carrier signal detect a peak from the sampled representation and obtain a value and a time domain location of a cancellation peak for cancelling the peak a plurality of peak cancellation signal generators each corresponding to a carrier of the multi carrier signal and adapted to generate a peak cancellation signal within a frequency band of its corresponding carrier based on the value and time domain location of the cancellation peak and a subtractor adapted to subtract the peak cancellation signals from the sampled representation after being delayed.

With the first aspect of the present invention a plurality of peak cancellation signal generators are provided. Each of the peak cancellation signal generators corresponds to a carrier of the multi carrier signal and generates a peak cancellation signal within a frequency band of its corresponding carrier. In this way a CFR device for a multi carrier signal can be implemented at a low complexity.

According to a second aspect of the present invention a device of crest factor reduction is provided. The device includes a peak detector adapted to receive a sampled representation of a signal detect a peak from the sampled representation and obtain a value and a time domain location of a cancellation peak for cancelling the peak an allocator adapted to allocate the cancellation peak to a peak generation unit a plurality of peak generation units each adapted to if allocated with the cancellation peak adjust the phase of the cancellation peak to obtain the phase adjusted value of the cancellation peak and generate an intermediary signal based on the phase adjusted value and the time domain location of the cancellation peak an adder adapted to sum up intermediary signals generated by the plurality of peak generation units to obtain a sum signal a mixer adapted to up convert the sum signal to a carrier frequency of the signal to generate a peak cancellation signal and a subtractor adapted to subtract the peak cancellation signal from the sampled representation after being delayed. The sampled representation here is obtained by sampling the signal at a sampling frequency and over sampling the sampled signal at an over sampling frequency. The phase of the cancellation peak is adjusted to compensate for a phase offset introduced by the mixer.

With the second aspect of the present invention a peak is detected from the over sampled signal and thus the detected location of the peak can be more accurate. That is the accuracy of peak detection can be improved.

According to a third aspect of the present invention a multi stage crest factor reduction circuit is provided. The multi stage crest factor reduction circuit includes at least a first crest factor reduction stage with a first filter length a second crest factor reduction stage with a second filter length shorter than the first filter length and a third crest factor reduction stage with a third filter length shorter than the second filter length. Here at least one of the first second and third crest factor reduction stages is formed by the device according to any one of the above first and second aspects.

With the third aspect of the present invention each stage has a different filter length and has a different role from the other stages. Thus it is possible to combine the advantages of the NS CFR and PC CFR algorithms with high efficiency and low complexity.

According to a fourth aspect of the present invention a peak detector is provided. The peak detector detects one or more peaks to be canceled by a plurality of peak generation units. The peak detector includes a resource calculation unit adapted to calculate a resource occupation state of each of the plurality of peak generation units a peak detection unit adapted to detect from a sampled representation of a signal samples each having a magnitude larger than a first threshold as a set of candidate peaks a high peak extraction unit adapted to extract from the set of candidate peaks a high peak having a magnitude larger than a second threshold the second threshold being larger than the first threshold and determine the high peak as a peak to be canceled if the resource occupation state of at least one of the plurality of peak generation units indicates that the at least one peak generation unit is currently idle a delay unit adapted to delay the high peak determined as a peak to be canceled by a time length required for processing a peak a peak modification and delay unit adapted to remove the high peak determined as a peak to be canceled from the set of candidate peaks to obtain a set of low peaks and delay the set of low peaks by the time length and a low peak extraction unit adapted to extract a low peak from the set of low peaks in a temporal order determine the low peak as a peak to be canceled if the resource occupation state of at least one of the plurality of peak generation units indicates that the at least one peak generation unit has been idle for at least the time length and output the value and the time domain location of each peak determined as a peak to be canceled by both the high and low peak extraction units.

With the third aspect of the present invention a high peak is determined as a peak to be canceled if at least one peak generation unit is currently idle whereas a low peak is determined as a peak to be canceled if at least one peak generation unit has been idle for at least the time length required for processing a peak. Thus the probability of high peak leakage can be minimized even if the peak leakage is inevitable due to limited number of PGUs in a PC CFR device.

The embodiments of the present invention will be detailed below with reference to the drawings. It should be noted that the following embodiments are illustrative only rather than limiting the scope of the present invention.

As shown in the CFR device includes a peak detector . The peak detector receives a sampled representation of the multi carrier signal detects a peak from the sampled representation and obtains a value V and a time domain location Tof a cancellation peak for cancelling the peak. Here the sampled representation can be obtained by sampling the multi carrier signal at a sampling frequency F i.e. the sampling period T 1 F . . The system clock frequency can also be F which is the unique system clock used in the CFR device. In the input signal S is a signal obtained by sampling the multi carrier signal at the sampling frequency F.

Optionally the CFR device includes an interpolation unit for interpolating i.e. over sampling the input signal S at an over sampling frequency 2F where K is a positive integer. In this case the sampled representation input to the peak detector is the over sampled signal and the time domain location obtained by the peak detector has a resolution of 1 2F . Thus the detected location of the peak can be more accurate. More generally K being zero implies the omission of the optional over sampling process.

The CFR device also includes a plurality of peak cancellation signal generators PCSGs each corresponding to a carrier of the multi carrier signal and adapted to generate a peak cancellation signal within a frequency band of its corresponding carrier based on the value and time domain location of the cancellation peak. In the example shown in there are three PCSGs and which can be collectively referred to as PCSGs as appropriate each corresponding to one of the three carriers. Further details of the PCSGs will be given later.

The CFR device further includes a subtractor adapted to subtract the peak cancellation signals from the sampled representation after being delayed by the delay unit . Optionally an adder can be provided to sum up the peak cancellation signals generated by the PCSGs and output the sum of the peak cancellation signals to the subtractor .

As shown in a PCSG includes an allocator and a plurality of peak generation units PGUs . . . which can be collectively referred to as PGUs as appropriate . The allocator receives the value V and time domain location Tof the cancellation peak obtained by the peak detector see and allocates the cancellation peak to one of the PGUs . The PGU allocated with the cancellation peak adjusts the phase of the cancellation peak to obtain the phase adjusted value of the cancellation peak and generates an intermediary signal based on the phase adjusted value and the time domain location of the cancellation peak.

The PCSG also includes an adder adapted to sum up intermediary signals generated by the plurality of PGUs to obtain a sum signal and a mixer adapted to up convert the sum signal to the carrier corresponding to the PCSG to generate the peak cancellation signal. In the PGU the phase of the cancellation peak is adjusted to compensate for a phase offset introduced by the mixer.

In an embodiment each of the PGUs operates at a frequency of F M where M is positive integer dependent on the bandwidth of the carrier corresponding to the PCSG. As an example for a carrier with a smaller bandwidth a larger value of M can be used.

In an embodiment the PCSG further includes an up sampler adapted to up sample the sum signal to Fs. In this case the mixer is adapted to up convert the up sampled sum signal to the carrier corresponding to the PCSG to generate the peak cancellation signal.

Mathematically the operation of the i th i 1 . . . R PCSG corresponding to the i th carrier of the multi carrier signal can be described as follows.

It is assumed that there are QPGUs each operating at the frequency of F M which means only one sample is generated every Mclock cycles. Preferably Mis a non negative integer power of 2 and is configurable. Therefore the resources can be shared and then only Q MPGUs need to be implemented physically. Each PGU contains two complex multipliers and two complex adders.

The allocator allocates a cancellation peak represented by Tand V to one of the PGUs . It can be ensured that there is at least one idle PGU while a cancellation peak is allocated to the PCSG. It is assumed that the cancellation peak is allocated to the j th PGU then the input to the PGU can be represented as D V and B T 2Fmod 2Mwhich represents the fractional time location of the cancellation peak in the sampling period T.

If D 0 the PGU enters a operating state and operates as follows. First the phase adjusted value of Dis calculated as D De where Tis system parameter representing a time distance between Tand the time location of the corresponding cancellation peak. Then an elementary signal h t is read from a pre stored table and multiplied by D to obtain an intermediary signal tilde over G T T t D h t at the frequency of F M where h t m 1 2 . . . Mis a set of Finite Impulse Response FIR filter coefficients with limited bandwidth 

Then the intermediary signals tilde over G j 1 . . . Qgenerated by all of the PGUs are then added up sampled to Fand up converted to the i th carrier to finally obtain the peak cancellation signal G.

In the mixer includes an oscillator NCO2 for generating a complex signal eat the frequency of Fto up convert the up sampled signal to the i th carrier where wis the center frequency of the i th carrier. Each PGU includes an oscillator NCO1 for generating a complex signal eat the frequency of 2Fto compensate the phase offset introduced by the NCO2.

According to the above embodiment a CFR device for a multi carrier signal can be implemented at a low complexity. Further with the above CFR device peaks can be detected at a high sampling rate and cancelled at a low sampling rate. In this way the peak detection accuracy can be improved and the resources required for achieving an equivalent performance can be reduced.

The above principle of the present invention is not limited to a multi carrier signal but also applicable for a single carrier signal. is a block diagram of a CFR device according to another embodiment of the present invention. The structure shown in is substantially the same as that of except that there is only one PCSG for only one carrier . The functions of the units and shown in are substantially the same as those of the units and shown in respectively.

As shown in the CFR device includes a peak detector adapted to receive a sampled representation of a signal detect a peak from the sampled representation and obtain a value and a time domain location of a cancellation peak for cancelling the peak an allocator is adapted to allocate the cancellation peak to a peak generation unit a plurality of peak generation units each adapted to if allocated with the cancellation peak adjust the phase of the cancellation peak to obtain the phase adjusted value of the cancellation peak and generate an intermediary signal based on the phase adjusted value and the time domain location of the cancellation peak an adder adapted to sum up intermediary signals generated by the plurality of peak generation units to obtain a sum signal a mixer adapted to up convert the sum signal to a carrier frequency of the signal to generate a peak cancellation signal and a subtractor adapted to subtract the peak cancellation signal from the sampled representation after being delayed by the delay unit . Here the sampled representation is obtained by sampling the signal at a sampling frequency and over sampling by the interpolation unit the sampled signal at an over sampling frequency. The phase of the cancellation peak is adjusted to compensate for a phase offset introduced by the mixer .

Alternatively the sampling frequency is Fand each of the plurality of peak generation units operates at a frequency of F M where M is positive integer dependent on the bandwidth of the signal.

In an embodiment the CFR device further includes an up sampler adapted to up sample the sum signal to Fs. In this case the mixer is adapted to up convert the up sampled sum signal to generate the peak cancellation signal.

Preferably the peak detector is adapted to detect as the peak any sample from the sampled representation which has a magnitude larger than a first threshold while giving priority to any sample having a magnitude larger than a second threshold the second threshold being larger than the first threshold.

In particular referring to which is a block diagram of a peak detector according to an embodiment of the present invention the peak detector includes a resource calculation unit a peak detection unit a high peak extraction unit a delay unit a peak modification and delay unit and a low peak extraction unit .

The resource calculation unit calculates a resource occupation state of each of the plurality of peak generation units see .

The peak detection unit detects from the sampled representation samples each having a magnitude larger than the first threshold as a set of candidate peaks.

The high peak extraction unit extracts from the set of candidate peaks a high peak having a magnitude larger than the second threshold and determines the high peak as a peak to be canceled if the resource occupation state of at least one of the plurality of peak generation units indicates that the at least one peak generation unit is currently idle.

The delay unit delays the high peak determined as a peak to be canceled by a time length required for processing a peak.

The peak modification and delay unit removes the high peak determined as a peak to be canceled from the set of candidate peaks to obtain a set of low peaks and delay the set of low peaks by the time length.

The low peak extraction unit extracts a low peak from the set of low peaks in a temporal order determines the low peak as a peak to be canceled if the resource occupation state of at least one of the plurality of peak generation units indicates that the at least one peak generation unit has been idle for at least the time length and outputs a value and a time domain location of each peak determined as a peak to be canceled by both the high and low peak extraction units.

Due to the processing capacity limit N it is possible that some peak satisfying the above conditions 1 and 2 cannot be processed. To reduce the possibility of leaking a high peak any high peak satisfying S T This given higher priority than any peak satisfying Th S T Th where This the second threshold as described above.

The resource calculation unit contains N counters CRL CRL . . . CRL corresponding to the N PGUs respectively. Each counter is initialized to be a minimal value RC MIN which is smaller than T. The value of each counter is reduced by Tevery T until it reaches the minimal value RC MIN.

The high peak extraction unit extracts a high peak Psatisfying P Thand the above conditions satisfying 2 and 3 .

If the value of the counter CRL u 1 . . . N is currently equal to or smaller than 0 which indicates that the corresponding u th PGU is currently idle the high peak extraction unit determines the high peak as a peak to be canceled by the u th PGU and set the value of the counter CRLto T. It is assumed here that the u th PGU is currently idle and the high peak Pis determined as a peak to be canceled.

The peak modification and delay unit removes the high peak Pfrom P to obtain a set of low peaks P and delays P by Tto obtain P .

The low peak extraction unit extracts a low peak Pfrom P in a temporal order. If the value of the counter CRL v 1 . . . N is currently equal to or smaller than T which indicates that the corresponding v th PGU has been idle for at least T the low peak extraction unit determines the low peak Pas a peak to be canceled by the v th PGU and set the value of the counter CRLto 0.

The low peak extraction unit then combines the peaks determined as peaks to be canceled by both the high and low peak extraction units and outputs them to the PGUs.

In this way a low peak can be cancelled only if its cancellation will not affect the cancellation of any potential high peak. Thus the probability of high peak leakage can be minimized.

In a non limiting example in a three stage CFR circuit the first CFR stage is a PC CFR stage with a long filter length. Its processing ability is relatively low but causes very low ACLR. It can reduce high peaks to a small value. The majority of the power of the peaks is cancelled at this stage. The second CFR stage is a PC CFR stage with a shorter filter length but more PGUs than the first CFR stage. It reduces most of peaks to a small value. Most of the power of the peaks is cancelled at this stage. After two stages the power of the peaks is very low and most of the peaks have very small values. The third CFR stage is an NS CFR stage with even shorter filter length and it will cancel all the remaining peaks.

With the above multi stage CFR circuit each stage has a different filter length and has a different role from the other stages. The advantages of the NS CFR and PC CFR algorithms can be combined with high efficiency and low complexity.

The present invention has been described above with reference to the preferred embodiments thereof. It should be understood that various modifications alternations and additions can be made by those skilled in the art without departing from the spirits and scope of the present invention. Therefore the scope of the present invention is not limited to the above particular embodiments but only defined by the claims as attached.

