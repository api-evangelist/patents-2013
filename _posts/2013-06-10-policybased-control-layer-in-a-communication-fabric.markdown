---

title: Policy-based control layer in a communication fabric
abstract: Presented herein are techniques for adding a secure control layer to a distributed communication fabric that supports publish-subscribe (pub-sub) and direct query (synchronization) communication. The secure control layer is configured to perform policy-based authentication techniques to securely manage the exchange of data/information within the communication fabric and enable registration/discovery of new capabilities.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09208295&OS=09208295&RS=09208295
owner: Cisco Technology, Inc.
number: 09208295
owner_city: San Jose
owner_country: US
publication_date: 20130610
---
This application claims priority to U.S. Provisional Patent Application No. 61 714 333 filed Oct. 16 2012 entitled SECURE CONTROL LAYER IN A DISTRIBUTED COMMUNICATION SYSTEM. The content of this application is hereby incorporated by reference herein.

There are many different devices applications services servers etc. collectively referred to herein as computing components available from different vendors that perform various operations within a computing network and or provide information to the network. In order for these various computing components to perform their operations the components often obtain information data from one or more other sources e.g. other devices applications services servers mobile devices etc. .

Different types of information may be produced or used by different computing components. In one example this information includes security information. Security information may include but is not limited to raw security events network flow information identity information security configuration information security intelligence information reputation information correlated security analysis and security reports. Security information may also include indexes of information policy configuration settings topology physical layer 2 and or layer 3 network flow information deep packet inspection of data and control plane traffic control plane events content security events policy e.g. network control endpoint posture assessment information compliance rules and assessment profiling assessment information statistical counts and analysis of the statistics on traffic patterns etc.

Presented herein are techniques for adding a secure control layer to a distributed communication fabric that supports publish subscribe pub sub and direct query synchronization communication. The secure control layer is configured to perform policy based authentication and authorization techniques to securely manage the exchange of data information within the communication fabric and to enable registration of new capabilities within the communication fabric. The techniques presented herein may be implemented with any communication protocol that supports pub sub and or direct query patterns between a source of information publisher and a destination of the information consumer where the protocol exchanges between source and destination are controlled by a separate control plane entity referred to herein as a grid controller.

Software defined networking SDN is an approach to networking that separates the control plane from the data plane. Using SDN the control plane is implemented in software in a system e.g. networking device server etc. that is physically separate from the data plane. The evolution of SDNs coupled with the wide variety of devices available for use has increased the need to establish appropriate secure relationships and authorizations between the network infrastructure components to ensure that the information and programming of the network is executed with trusted and authorized parties. Although different application programming interfaces APIs have been developed to facilitate the programmability at different levels of the Open Systems Interconnection OSI stack no such APIs are focused on contextual information that can be leveraged for security network health network management etc. particularly in networks that include public hybrid clouds and that span multiple domains. Presented herein are techniques to define the conditions by which these APIs can be executed in a secure manner so as not to affect network operation or present new threat vectors e.g. means by which security breaches can be enabled . In cases where the control plane is acquiring information for example for cybersecurity manageability or to continue to update control the network the techniques ensure that the obtained data is trustworthy i.e. the data is both protected and has originated from an authorized source .

Computing components may be configured to generate data information that is useable by other computing components i.e. the computing components may operate as publishers of data . In such circumstances a computing component may be referred to herein as a publisher. Additionally or alternatively computing components may be configured to use consume data information generated by other computing components. In such circumstances a computing component may be referred to herein as a consumer. 

The communication fabric enables publishers to share data with the consumers. The communication fabric which is sometimes referred to herein as a grid infrastructure or simply grid is a logical arrangement of hardware software elements implemented in one or more interconnected computing devices e.g. servers controllers switches routers firewalls access points etc. that collectively function as a logical communication bus linking the discrete computing components . The ability to provide data to or consume data from the grid is sometimes referred to herein as a capability or service. As such different capabilities or services refer to different types of data made available to or consumed from the grid.

It is to be appreciated that computing components may be any element that can connected to the grid including but not limited to services archives network security devices e.g. compliance check service firewalls etc. wireless local area network WLAN controllers access points policy enforcement services network management software servers virtual private network VPN termination servers video servers etc. clients laptops mobile devices e.g. smartphones data centers etc. In the specific example of computing component is an Identity Services Engine ISE computing component is a switch computing component is a Web Security System WSA computing component is Security Information and Event Management device SIEM and computing component is a firewall.

As noted above the computing components may publish data to and or consume data from the grid . In the example of ISE is configured to publish identity context data to the grid switch is configured to publish flow data e.g. Netflow information to the grid and WSA is configured to publish reputation data to the grid . As such ISE switch and WSA operate in this example as publishers. Additionally SIEM is configured to publish threat data to the grid and is configured to consume identity context data published by the ISE . SIEM may consume this identity context data via a pub sub mechanism i.e. through a subscription to identity context information generated at ISE or via a query mechanism i.e. through a query request to ISE . As such SIEM operates both as a publisher and as a consumer. Finally firewall is configured to consume threat data published by the SIEM and identity context data published by the ISE . The firewall may consume the threat data via a pub sub mechanism and may consume the identity context data via a pub sub mechanism or via a query mechanism.

Certain computing components connected to grid may advertise capabilities that the components make available to the grid. In the example of the ISE advertises the ability to provide identity context data. Additionally certain network elements connected to a communication fabric may perform capability discover i.e. discover capabilities available to the grid . In the example of the SIEM is configured to perform such capability discovery.

As noted above there will be entities e.g. computing components that connect to grid to 1 publish data 2 subscribe to data 3 query data 4 register new capabilities and or 5 discover new capabilities. The computing components may perform one or a combination of these operations. The computing components and the allowed operations are each authorized through a policy mechanism executed at a grid controller .

The grid controller is a control plane entity that is abstractly connected to all of the hardware software elements in the grid as well as the computing components . The grid controller may comprise a software application executed by one or more servers e.g. Xen Cloud Platform XCP servers . In general the grid controller and more particularly a policy engine is configured to provide policy based authentication and authorization of computing components to the grid . Furthermore the grid controller i.e. policy engine is configured to enable the exchange of information between publishers and consumers and allow certain components to register new capabilities. The information exchanges may include multicast e.g. pub sub and unicast query i.e. peer to peer information exchanges across the grid .

In accordance with examples presented herein the policy engine performs an authentication process to authenticate a computing component when the computing component initiates connection to the grid . The policy engine also performs an authorization process to authorize the computing component. These authentication and authorization processes determine whether or not the computing component is allowed to participate in the grid. The policy engine is also configured to perform additional authorization processes when new operations e.g. publish subscribe query register new capabilities and or discover new capabilities are requested by the computing component. Furthermore a policy may dictate that the policy engine periodically or continuously checks for compliance of policy so revocation of the authorizations can also ensue e.g. an authorization for the computing component may be revoked if it is detected that the component is no longer in compliance .

The authentication and authorization processes may be performed using policies stored in a policy database . The policies may include for example compliance checking type of component location role etc. and enable dynamic authentication authorization of the entities and associated operations. The policies may define which capabilities services exist and the rules by which new additional capabilities services may be registered which capabilities services the computing components are allowed to publish on the communication fabric which capabilities services the computing components are allowed to consume etc. As such beyond the existence of the capabilities there may also be policies that define how each of the capabilities may function e.g. the types of entities that can publish or subscribe. The grid controller may also provide a mechanism by which computing components can for example discover the control plane advertise its capabilities and establish a secure connection to affect its APIs in the control plane. The grid controller also maintains a service directory of all authenticated and authorized services connected to the fabric that sit on top of the message infrastructure.

Conventional messaging systems identify a computing component type and simply infer based on a predefined static rule or simple authentication validation that the computing component should be allowed to perform certain operations. For example if a computing component joins a communication fabric and identifies itself as an ISE a conventional system may determine that since the computing component identified itself as an ISE it should be automatically be allowed to perform certain operations i.e. share identity context . Such authentication techniques based on predefined rules may be problematic and do not account for the dynamic nature of computing networks.

In accordance with examples presented herein policy based authentication authorization of a computing component and or requested operation s within a messaging system is provided. The policy based authentication authorization control techniques presented herein are dynamic and based on the different attributes that make up a policy. Attributes that can enable or limit authorization include but are not limited to device type e.g. distinguishers of whether a computing component is a physical or virtual device device location e.g. geographic or network topological location of a computing component device service s e.g. whether the box is configured to run as a switch router ISE etc. device compliance e.g. checks against system configuration such as running software hardware configuration etc. device reputation e.g. known or determined reliability of the device and or data produced by a device data reputation e.g. known or determined reliability of published data application role etc. There may also be various exceptions and further includes e.g. Time of day .

Table 1 below illustrates example attribute evaluations that may be performed at policy engine in accordance with policy based authorization techniques presented herein.

In one specific example time flow of ISE authenticates to grid at time t0. At time t1 the monitoring MnT function of ISE registers to publish identity context data. The grid controller policy engine then determines the location of ISE and based on its configuration i.e. is MnT persona determines that as a MnT node it can authorize the registration request. At time t2 the MnT function of ISE registers to publish flow information e.g. Netflow information . The grid controller policy engine determines that the MnT function of ISE is not authorized allowed to publish the flow information into the grid thus the request is denied.

The ISE continues to publish the identity context data as noted but at time tN the ISE becomes infected with malware. The grid controller policy engine performs continuous periodic authorization checks on compliance and reputation such that at tN it detects the break in compliance. As such at that time the policy engine revokes the previously granted authorization such that the ISE is not longer allowed to publish or the policy may direct some other operation based on this result . Similar time flows may be enacted by other computing components connected to grid .

In certain examples presented herein the grid controller provides for dynamic registration of new services capabilities. In general the grid controller creates a service directory of available services. A joining computing component is provided with the ability to create a new service that is to be registered with the grid controller e.g. added to the service directory and or discover what services are available through the grid .

If the timer has expired the method ends at . However if it is determined that the timer has not expired then at the next authorization criterion is obtained and the method returns to . The method continues until 1 a criterion fails to match 2 the authorization criteria are exhausted or 3 the authorization timer expires.

The ISE first initiates connection to i.e. attempts to join the grid and the grid controller i.e. policy engine of the grid controller authenticates and authorizes the ISE . That is using policy based authentication authorization techniques described herein the grid controller determines if the ISE is allowed to join the grid . The authentication authorization exchange between the ISE and grid controller is represented in by arrows and . However it is to be appreciated that this authentication authorization exchange may be initiated by either entity and may include the exchange of multiple messages.

Additionally in the example of the SIEM initiates connection to the grid and the grid controller authenticates and authorizes the SIEM . That is using policy based authentication authorization techniques described herein the grid controller determines if the SIEM is allowed to join the grid . The authentication authorization exchange between the SIEM and grid controller is represented in by arrows and . However it is to be appreciated that this authentication authorization exchange may be initiated by either entity and may include the exchange of multiple messages.

After authentication and authorization to the grid the ISE issues a publish request message to grid controller . The publish request message represented in by arrow indicates that the ISE has data for publication on the grid . Following receipt of the publish request message at the grid controller authorizes based on one or more polices the ISE to publish data onto the grid. More specifically the grid controller executes a policy based authorization process as described elsewhere herein to determine if the ISE is allowed to publish data onto the grid . In this case the ISE is allowed to publish data and the grid controller transmits a publish success message to ISE . The publish success message is represented in by arrow and subsequently the ISE may publish data periodically or continuously to the grid .

After authentication to the grid the SIEM issues a subscribe request message to grid controller . The subscribe request message represented in by arrow indicates that the SIEM is requesting to subscribe to data provided to the grid . The subscribe request may include an indication of a subscription entity e.g. identifying the specific entity the type of entity etc. to which the SIEM is attempting to subscribe or may include an indication of subscription data e.g. identifying the specific data the type of data etc. to which the SIEM is attempting to subscribe . Following receipt of the subscribe request message at the grid controller authorizes based on one or more polices the SIEM to subscribe to data from the grid . More specifically the grid controller executes a policy based authorization process as described elsewhere herein to determine if the ISE is allowed to subscribe to data on the grid . In this case the SIEM is allowed to subscribe to data from ISE and the grid controller transmits a subscribe success message to SIEM . The subscribe success message is represented in by arrow .

In operation the ISE may issue subscription updates onto the grid . As shown by arrow in the data provided to the grid by these subscription updates is forwarded through the grid to SIEM . In addition or alternatively in certain examples the STEM may also be authorized to query data from ISE . In such examples the STEM may transmit a query request to ISE which is represented in by arrow . The ISE may then respond with a query response that is in essence a bulk transfer of data to the SIEM . The query response is represented in by arrow .

Memory may comprise read only memory ROM random access memory RAM magnetic disk storage media devices optical storage media devices flash memory devices electrical optical or other physical tangible memory storage devices. The processor is for example a microprocessor or microcontroller that executes instructions for the grid controller logic . Thus in general the memory may comprise one or more tangible i.e. non transitory computer readable storage media e.g. a memory device encoded with software comprising computer executable instructions and when the software is executed by the processor it is operable to perform the operations described herein in connection with grid controller logic i.e. the functionality described above for grid controller including the policy engine .

The techniques presented herein provide a software defined control plane that uses a communication fabric e.g. an XMPP infrastructure for secure bi directional transport. The techniques presented also provide a binding of policy computing components i.e. any component that can connect to a network and their services connected to the communication fabric such that all communication by those computing components are authenticated and authorized. Additionally the techniques presented herein provide a service directory construct that is maintained by the controller such that systems connecting to the communication fabric can discover what services are available and authorized for use. The techniques presented herein also enable directed peer to peer communication where appropriate while using the controller control plane over the communication fabric to maintain authentication authorization. Finally the techniques presented herein achieve better information delivery resiliency and load balance. The control plane performs matchmaking of communicating ends for directed communication takes place and should a peer become unavailable the controller will perform alternate matchmaking that could handle the publication or information query. This alleviates the situation in a peer to peer network where peers are on their own to discover alternatives.

