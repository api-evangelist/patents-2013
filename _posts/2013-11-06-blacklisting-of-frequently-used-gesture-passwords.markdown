---

title: Blacklisting of frequently used gesture passwords
abstract: A method of maintaining a blacklist for gesture-based passwords is provided. A data store of vectors corresponding to gestures is maintained on a blacklist server. Upon receiving a new gesture based password, an electronic device converts the password to a vector and forwards that vector to the blacklist server. The blacklist server assigns the vector to one of a cluster of vectors each having low distance from one another. If the increase in the occurrences of the number of vectors in the cluster results in a blacklist threshold being exceeded, the cluster of vectors is inputted to the blacklist. A notification can be sent back to the electronic device if the forwarded vector is on the blacklist or is inputted to the blacklist.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09450953&OS=09450953&RS=09450953
owner: BlackBerry Limited
number: 09450953
owner_city: Waterloo
owner_country: CA
publication_date: 20131106
---
Touch screen devices are proliferating in the mobile space. Via a virtual keyboard it is possible to enter characters or other symbols but typically a physical keyboard is better suited and faster for text input.

Passwords may be used in many situations where a user needs to be authenticated. Situations requiring authentication may include the ability to access or use a computer mobile phone PDA or any other device they may also enable access to a physical location or allow use of a credit debit card or similar instrument. Passwords are typically alpha numeric strings or sequences entered on a keyboard.

In some cases a blacklist of alpha numeric strings that can not be used as passwords is maintained to prevent users from choosing passwords that are common or easy for a third party to determine.

One concept of authentication on a device with a touch screen uses a touch gesture as a replacement for a character password. As with character passwords password gestures should fulfill standard security criteria such as but not limited to having a measurable password security to guarantee that only the proper users gain access. Furthermore a password gesture must be remembered by the user.

Abstracting the gesture concept from a touch screen implementation can lead to a generalized trajectory description which is characterized as a sequence of 3D points or n dimensional features in time. This could exemplarily be implemented by using accelerometer gyroscope sensors or time of flight cameras. A user could for example draw a gesture in the air with his accelerometer equipped mobile device. The sequence of acceleration values in the different spatial dimensions as a function of time would then constitute the trajectory information. In this example the spatial trajectory would be replaced by a pattern of accelerations along the trajectory. This disclosure will only refer to gestures regardless of which technology is used to sense the gestures and which dimensionality the gestures have.

There is a trade off between high password security calling for complex gestures and easy memorability of the gesture implying simple gestures . One potential solution to this dilemma is the use of known symbols like characters and other simple graphical sketches. The user can easily remember the shape of the gesture since symbols have a quite strictly defined outline. But there is also the danger that intruders simply enter gestures derived from known symbols because they are more probable than any other free form gesture. For character passwords the equivalent security threat is the use of dictionary words as passwords.

In some embodiments of different pattern recognition tasks inputs which should be rejected are modeled by providing examples for a blacklist. Input patterns are often high dimensional signals and it is not feasible to provide a complete list of inputs to reject due to the enormous amount of data. Therefore blacklisting examples are provided and similar inputs are discarded as well.

The security of a password gesture is inversely proportional to the probability that it is produced by the users. In other words The more unlikely a gesture is the better it qualifies as a character password replacement. In the case of character passwords an unlikely password contains a large number of characters in a simplistic concept. But users can also remember long passwords if they have a well known meaning such as being words from a dictionary. Therefore character passwords from a dictionary are strongly discouraged. To adopt this idea for gesture passwords commonly known gestures e.g. representing letters digits or other symbols have to be identified. These gestures might be complex but are more likely to appear since they are known to users. Common gestures can be simple trajectories which can be rejected based on some rules such as but not limited to too short duration length or not enough curvature. Complex common gestures e.g. sketches of known symbols can be pre registered in a blacklist. But there will also be unexpected common gestures with higher occurrence rate. These gestures can be learned by accumulating user statistics.

In an embodiment statistics of common gestures are collected at a central place. However a direct representation of a gesture password should not leave the user s device to avoid an interferer reading the password information. One solution to this problem is to use a non invertible mapping function to transform the gesture representation into a description which in some embodiments is shorter than the direct representation. This can for example be an index value with similarity preserving properties. Two similar gestures are mapped to two index values with low distance to each other. The mapping function is designed to minimize the number of conflicts where two completely different gestures are mapped to the same index value.

A directory of index values can be maintained centrally without compromising the gesture password security. In some embodiments index values with high occurrence rates are reported back to the respective users. Those index values indicate related gesture passwords which are often used and thus should be avoided. By accumulating statistics of index values from many users a blacklist is learned over time. In addition the index can be initialized by feeding in already known symbols.

Thus in a first aspect there is provided a method for blacklisting gesture based passwords the method for implementation on a blacklist server and comprising receiving an index value representing a gesture based password from an electronic device increasing an occurrence of the received index value by one in a data store of index values determining if increasing the occurrence of the received index value in the data store results in a blacklist threshold being exceeded and if the blacklist threshold is exceeded updating a blacklist stored on the blacklist server to include the received index value.

In a second aspect there is provided a method for implementation on an electronic device for updating a blacklist stored on a blacklist server receiving a gesture based password via an input interface converting the gesture based password into a non invertible similarity preserving index value and transmitting the index value to a blacklist server.

In a third aspect there is provided one or more computer readable media having computer readable instructions stored thereon that when executed by a processor implement any one of the methods described herein.

In a fourth aspect there is provided an electronic device comprising a processor a memory having computer readable instructions stored thereon that when executed by the processor implement any one of the methods described herein for implementation on an electronic device an input interface for receiving the gesture based password.

In a fifth aspect there is provided a blacklist server comprising a processor a memory having computer readable instructions stored thereon that when executed by the processor implement any one of the methods described herein for implementation on a server and a receiver for receiving the index value.

In a further embodiment there is provided a method for blacklisting gesture based passwords the method for implementation on a blacklist server and comprising receiving a vector from an electronic device the vector representing a gesture based password the vector being a similarity preserving vector such that similar gesture based passwords are mapped to vectors having a low distance between each other associating the received vector with one of a plurality of clusters of vectors determining if the association of the received vector with one of the plurality of clusters of vectors causes the number of vectors in the cluster to exceed a threshold value and if the number of vectors in the cluster exceeds a threshold value updating a blacklist stored on the blacklist server to include the vectors within the cluster.

In a further embodiment there is provided a method for implementation on an electronic device for updating a blacklist stored on a blacklist server the method comprising receiving a gesture based password via an input interface on the electronic device generating at least one vector representing the gesture based password the at least one vector being a similarity preserving vector such that similar gesture based passwords are mapped to vectors having a low distance between each other and transmitting the at least one vector without the gesture based password on which the at least one vector is based from the electronic device to the blacklist server.

Embodiments of the present application are not limited to any particular operating system mobile device architecture server architecture or computer programming language.

Reference is first made to which shows in block diagram form a communication system in which example embodiments of the present disclosure can be applied. The communication system comprises a number of mobile communication devices mobile devices which may be connected to the remainder of system in any of several different ways. Accordingly several instances of mobile communication devices are depicted in employing different example ways of connecting to system . Mobile communication devices are connected to a wireless communication network which may comprise one or more of a Wireless Wide Area Network WWAN and a Wireless Local Area Network WLAN or other suitable network arrangements. In some embodiments the mobile communication devices are configured to communicate over both the WWAN and WLAN and to roam between these networks. In some embodiments the wireless network may comprise multiple WWANs and WLANs .

The WWAN may be implemented as any suitable wireless access network technology. By way of example but not limitation the WWAN may be implemented as a wireless network that includes a number of transceiver base stations one of which is shown in where each of the base stations provides wireless Radio Frequency RF coverage to a corresponding area or cell. The WWAN is typically operated by a mobile network service provider that provides subscription packages to users of the mobile communication devices . In some embodiments the WWAN conforms to one or more of the following wireless network types Mobitex Radio Network DataTAC GSM Global System for Mobile Communication GPRS General Packet Radio System TDMA Time Division Multiple Access CDMA Code Division Multiple Access CDPD Cellular Digital Packet Data iDEN integrated Digital Enhanced Network EvDO Evolution Data Optimized CDMA2000 EDGE Enhanced Data rates for GSM Evolution UMTS Universal Mobile Telecommunication Systems HSDPA High Speed Downlink Packet Access IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or various other networks. Although WWAN is described as a Wide Area network that term is intended herein also to incorporate wireless Metropolitan Area Networks WMAN and other similar technologies for providing coordinated service wirelessly over an area larger than that covered by typical WLANs.

The WWAN may further comprise a wireless network gateway which connects the mobile communication devices to transport facilities and through the transport facilities to a wireless connector system . Transport facilities may include one or more private networks or lines the public internet a virtual private network or any other suitable network. The wireless connector system may be operated for example by an organization or enterprise such as a corporation university or governmental department which allows access to a network such as an internal or enterprise network and its resources or the wireless connector system may be operated by a mobile network provider. In some embodiments the network may be realised using the internet rather than an internal or enterprise network.

The wireless network gateway provides an interface between the wireless connector system and the WWAN which facilitates communication between the mobile communication devices and other devices not shown connected directly or indirectly to the WWAN . Accordingly communications sent via the mobile communication devices are transported via the WWAN and the wireless network gateway through transport facilities to the wireless connector system . Communications sent from the wireless connector system are received by the wireless network gateway and transported via the WWAN to the mobile communication devices .

The WLAN comprises a wireless network which in some embodiments conforms to IEEE 802.11x standards sometimes referred to as Wi Fi such as for example the IEEE 802.11a 802.11b and or 802.11g standard. Other communication protocols may be used for the WLAN in other embodiments such as for example IEEE 802.11n IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or IEEE 802.20 also referred to as Mobile Wireless Broadband Access . The WLAN includes one or more wireless RF Access Points AP one of which is shown in that collectively provide a WLAN coverage area.

The WLAN may be a personal network of the user an enterprise network or a hotspot offered by an internet service provider ISP a mobile network provider or a property owner in a public or semi public area for example. The access points are connected to an access point AP interface which may connect to the wireless connector system directly for example if the access point is part of an enterprise WLAN in which the wireless connector system resides or indirectly via the transport facilities if the access point is a personal Wi Fi network or Wi Fi hotspot in which case a mechanism for securely connecting to the wireless connector system such as a virtual private network VPN may be appropriate . The AP interface provides translation and routing services between the access points and the wireless connector system to facilitate communication directly or indirectly with the wireless connector system .

The wireless connector system may be implemented as one or more servers and is typically located behind a firewall . The wireless connector system manages communications including email messages to and from a set of managed mobile communication devices . The wireless connector system also provides administrative control and management capabilities over users and mobile communication devices which may connect to the wireless connector system .

The wireless connector system allows the mobile communication devices to access the network and connected resources and services such as a messaging server for example a Microsoft Exchange IBM Lotus Domino or Novell GroupWise email messaging server having a global address book and optionally other servers . The other servers may comprise a content server for providing content such as internet content or content from an organization s internal servers to the mobile communication devices in the wireless network and an application server for implementing server based applications. A directory of index values corresponding to gesture based passwords can be maintained on any of the servers described herein such as but not limited to the application server .

The global address book comprises electronic contact records generated and maintained by an IT information technology administrator of the network . Typically the global address book is maintained exclusively by the messaging server and there is no local copy on the mobile device . In addition the global address book typically comprises contact records for all users of the respective network e.g. enterprise . The contact records in the global address book may be one or more of individual contact records or user records or a group address or distribution list which lists multiple individual users .

The wireless connector system typically provides a secure exchange of data e.g. email messages personal information manager PIM data and IM data with the mobile communication devices . In some embodiments communications between the wireless connector system and the mobile communication devices are encrypted. In some embodiments communications are encrypted using a symmetric encryption key implemented using Advanced Encryption Standard AES or Triple Data Encryption Standard Triple DES encryption. Private encryption keys are generated in a secure two way authenticated environment and are used for both encryption and decryption of data.

The wireless network gateway is adapted to send data packets received from the mobile device over the WWAN to the wireless connector system . The wireless connector system then sends the data packets to the appropriate connection point such as the messaging server content server other servers or application servers . Conversely the wireless connector system sends data packets received for example from the messaging server or other server to the wireless network gateway which then transmit the data packets to the destination mobile device . The AP interfaces of the WLAN provide similar sending functions between the mobile device the wireless connector system and network connection point such as the messaging server content server and application server .

The network may comprise a private local area network metropolitan area network wide area network the public internet or combinations thereof and may include virtual networks constructed using any of these alone or in combination. Computers may be connected to the network directly or indirectly via an intermediate communication network such as the Internet . When computers connect to the network indirectly e.g. via the Internet a VPN or other mechanism for securely connecting to the network may be appropriate. Computers may be of any suitable construction and include at least a processor and a display screen one or more user input devices and a memory each connected to the processor as is known in the art. The computers could be desktop computers laptop notebook netbook computers or combinations thereof and may have wired or wireless communication subsystems for connecting to the network .

A mobile device may alternatively connect to the wireless connector system using a computer via the network . In at least some embodiments for security purposes the computers with which the mobile devices can connect to the wireless connector system are limited to computers which are directly connected to the network . A link may be provided for exchanging information between the mobile device and computer connected to the wireless connector system . The link may comprise one or both of a physical interface and short range wireless communication interface. The physical interface may comprise one or combinations of an Ethernet connection Universal Serial Bus USB connection Firewire also known as an IEEE 1394 interface connection or other serial data connection via respective ports or interfaces of the mobile device and computer . The short range wireless communication interface may be a personal area network PAN interface. A personal area network is a wireless point to point connection meaning no physical cables are required to connect the two end points.

It will be appreciated that the above described communication system is provided for the purpose of illustration only and that the above described communication system comprises one possible communication network configuration of a multitude of possible configurations for use with the mobile communication devices . The teachings of the present disclosure may be employed in connection with any other type of network and associated devices that are effective in implementing or facilitating wireless communication. Suitable variations of the communication system will be understood to a person of skill in the art and are intended to fall within the scope of the present disclosure.

Reference is now made to which illustrates an exemplary embodiment of the mobile device in which example embodiments described in the present disclosure can be applied. The mobile device is a two way communication device having data and voice communication capabilities and the capability to communicate with other computer systems for example via the Internet. Depending on the functionality provided by the mobile device in various embodiments the device may be a multiple mode communication device configured for both data and voice communication a smartphone a mobile telephone or a PDA personal digital assistant enabled for wireless communication or a computer system with a wireless modem.

The mobile device includes a rigid case not shown housing the components of the device . The internal components of the device are constructed on a printed circuit board PCB . The mobile device includes a controller comprising at least one processor such as a microprocessor which controls the overall operation of the device . The processor interacts with device subsystems such as a wireless communication subsystem sometimes referred to as a radio layer for exchanging radio frequency signals with the wireless network to perform communication functions. The processor interacts with additional device subsystems including a display screen such as a liquid crystal display LCD screen input devices such as a keyboard and control buttons flash memory random access memory RAM read only memory ROM auxiliary input output I O subsystems data port such as serial data port such as a Universal Serial Bus USB data port speaker microphone short range communication subsystem and other device subsystems generally designated as . Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions.

The device may comprise a touch screen display in some embodiments. The touch screen display may be constructed using a touch sensitive input surface connected to an electronic controller and which overlays the display screen . The touch sensitive overlay and the electronic controller provide a touch sensitive input device and the processor interacts with the touch sensitive overlay via the electronic controller. In some embodiments a touch screen is integrated directly with the display. In still other embodiments a touch screen is placed behind the display.

The communication subsystem includes a receiver a transmitter and associated components such as one or more antenna elements and local oscillators LOs and a processing module such as a digital signal processor DSP . The antenna elements and may be embedded or internal to the mobile device and a single antenna may be shared by both receiver and transmitter as is known in the art. As will be apparent to those skilled in the field of communication the particular design of the wireless communication subsystem depends on the wireless network in which mobile device is intended to operate.

The mobile device may communicate with any one of a plurality of fixed transceiver base stations of the wireless network within its geographic coverage area. The mobile device may send and receive communication signals over the wireless network after the required network registration or activation procedures have been completed. Signals received by the antenna through the wireless network are input to the receiver which may perform such common receiver functions as signal amplification frequency down conversion filtering channel selection etc. as well as analog to digital A D conversion. A D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in the DSP . In a similar manner signals to be transmitted are processed including modulation and encoding for example by the DSP . These DSP processed signals are output to the transmitter for digital to analog D A conversion frequency up conversion filtering amplification and transmission to the wireless network via the antenna . The DSP not only processes communication signals but may also provide for receiver and transmitter control. For example the gains applied to communication signals in the receiver and the transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP .

The processor operates under stored program control and executes software modules stored in memory such as persistent memory for example in the flash memory . As illustrated in the software modules comprise operating system software software applications comprising an email messaging application also referred to as an email client a personal address book a calendar application a phone application and gesture transform module . Example embodiments of the gesture transform module will be discussed in detail later herein. It is recognized that the gesture transform module and its various components as described herein can form a discrete module running on the device or the functions of the gesture transform module can be distributed on the device as separate modules or integrated within other existing modules as desired. Such discrete or distributed implementations all fall within the embodiments of the gesture transform module as described herein.

The software applications also may include a range of applications including for example a notepad application Internet browser application voice communication i.e. telephony application mapping application or a media player application or any combination thereof. Each of the software applications may include layout information defining the placement of particular fields and graphic elements e.g. text fields input fields icons etc. in the user interface i.e. the display screen according to the application.

Those skilled in the art will appreciate that the software modules or parts thereof may be temporarily loaded into volatile memory such as the RAM . The RAM is used for storing runtime data variables and other types of data or information as will be apparent to those skilled in the art. Although specific functions are described for various types of memory this is merely one example and those skilled in the art will appreciate that a different assignment of functions to types of memory could also be used.

In some embodiments the auxiliary I O subsystems may comprise an external communication link or interface for example an Ethernet connection. The mobile device may comprise other wireless communication interfaces for communicating with other types of wireless networks for example a wireless network such as an orthogonal frequency division multiplexed OFDM network or a GPS Global Positioning System subsystem comprising a GPS receiver or transceiver for communicating with a GPS satellite network not shown . The auxiliary I O subsystems may comprise a pointing or navigational input device such as a touchpad a clickable trackball or scroll wheel or thumbwheel or a vibrator for providing vibratory notifications in response to various events on the device such as receipt of an electronic message or incoming phone call or for other purposes such as haptic feedback touch feedback .

In some embodiments the mobile device also includes a removable memory card or module typically comprising flash memory and a memory card interface . Network access is typically associated with a subscriber or user of the mobile device via the memory card which may be a Subscriber Identity Module SIM card for use in a GSM network or other type of memory card for use in the relevant wireless network type. The memory card is inserted in or connected to the memory card interface of the mobile device in order to operate in conjunction with the wireless network .

The mobile device also stores other data in an erasable persistent memory which in one example embodiment is the flash memory . In various embodiments the data includes service data comprising information required by the mobile device to establish and maintain communication with the wireless network . The data may also include user application data such as email messages address book and contact information calendar and schedule information notepad documents image files and other commonly stored user information stored on the mobile device by its user and other data. The data stored in the persistent memory e.g. flash memory of the mobile device may be organized at least partially into a number of databases each containing data items of the same data type or associated with the same application. For example email messages contact records and task items may be stored in individual databases within the device memory.

The mobile device also includes a battery as a power source which is typically one or more rechargeable batteries that may be charged for example through charging circuitry coupled to a battery interface such as the serial data port . The battery provides electrical power to at least some of the electrical circuitry in the mobile device and the battery interface provides a mechanical and electrical connection for the battery . The battery interface is coupled to a regulator not shown which provides power V to the circuitry of the mobile device .

The short range communication subsystem is an additional optional component which provides for communication between the mobile device and different systems or devices which need not necessarily be similar devices. For example the subsystem may include an infrared device and associated circuits and components or a wireless bus protocol compliant communication mechanism such as a Bluetooth communication module to provide for communication with similarly enabled systems and devices.

A predetermined set of applications that control basic device operations including data and voice communication applications will normally be installed on the mobile device during or after manufacture. Additional applications and or upgrades to the operating system or software applications may also be loaded onto the mobile device through the wireless network the auxiliary I O subsystem the serial port the short range communication subsystem or other suitable subsystem . The downloaded programs or code modules may be permanently installed for example written into the program memory i.e. the flash memory or written into and executed from the RAM for execution by the processor at runtime. Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

The mobile device may provide two principal modes of communication a data communication mode and a voice communication mode. In the data communication mode a received data signal such as a text message an email message or Web page download will be processed by the communication subsystem and input to the processor for further processing. For example a downloaded Web page may be further processed by a browser application or an email message may be processed by the email messaging application and output to the display . A user of the mobile device may also compose data items such as email messages for example using the input devices in conjunction with the display screen . These composed items may be transmitted through the communication subsystem over the wireless network .

In the voice communication mode the mobile device provides telephony functions and operates as a typical cellular phone. The overall operation is similar except that the received signals are output to the speaker and signals for transmission are generated by a transducer such as the microphone . The telephony functions are provided by a combination of software firmware i.e. the phone application and hardware i.e. the microphone the speaker and input devices . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile device . Although voice or audio signal output is typically accomplished primarily through the speaker the display screen may also be used to provide an indication of the identity of a calling party duration of a voice call or other voice call related information.

The phone application can be split into multiple applications or sub modules for example one or more user phone modules and a call control module. The user phone modules provide a variety of telephony features through a user interface while the call control module provides access to common telephony functions desired by the user phone modules such that telephony requests from phone modules can be coordinated and so that the user phone modules do not need to each provide instructions understood by the wireless communications subsystem . The call control function typically makes telephony features available to user phone modules through an application programming interface API . It is to be recognized that all or part of the phone application features or functions could be provided through the operating system or otherwise distributed in the device while continuing to fall within the term phone application .

In order to compare gestures for example for blacklisting a common form of representing the gestures is beneficial. One option is to represent the gesture as a trajectory in 2D or 3D space and possibly ignoring the time stamps of all points to allow for variability. Transforming gestures also makes the gestures better comparable. Non limiting examples of transforming include translation rotation and scaling operations. Thus in some embodiments gestures are made invariant against changes in position rotation angle or size and are represented as the same gesture. Additionally gestures are difficult to reproduce exactly by the users. Therefore in some embodiments each point on a trajectory in a gesture has a variability which can be modeled by a deviation such as but not limited to a standard deviation from the ideal position.

In some embodiments the mathematical representation of the gesture is a sequence of points and timestamps x t with i 1 N . All gestures are brought to the same position rotation angle and scale by invariance operations. In addition in some embodiments the gestures are interpolated to yield the same number of points for each gesture. This makes the comparison of gestures much easier.

Three examples for common symbols drawn multiple times on a touch screen can be seen in . Three symbols W 8 and a down arrow are shown. This trajectory representation should not leave the user terminal unless encrypted or in a format that cannot be deciphered as doing so would allow an intruder to replicate the gesture directly.

A blacklisting server is proposed for the collection of user gesture statistics to identify frequently entered similar gestures without being able to reconstruct individual gestures. The blacklist can be used to warn the user if s he enters a common gesture as a password. Thus in some embodiments a transformed gesture representation deliberately reduces the information content to prevent the gesture reconstruction. At the same time the transformation in some embodiments maps similar gestures to similar representations thus allowing a similarity comparison and the accumulation of gesture occurrence frequencies from multiple users.

In summary in some embodiments each gesture input as a password is normalized to the same number of points size and or orientation. This makes comparison of the gestures less complicated. After normalization the gesture is converted to a vector or index value. Normalization also decreases the size of the vector or index value and thus the amount of data that is required to be sent to a blacklist server for example. Because of the normalization similar gestures may result in the same vector or index value and inverting the vector or index to the exact gesture is difficult. The vector or index value can be input into a data store such as but not limited to a database and a determination can be made as to whether the addition of the vector or index value results in a threshold for a number of incidences of similar vectors or of similar or identical index values in the data store being exceeded. If the threshold is exceeded the vector or index value can be added to a blacklist.

In some embodiments a self organizing map SOM is used. As each normalized gesture vector is transferred to the SOM a neuron corresponding to the vector is fired. The number of times a neuron is fired is tracked and if that number exceeds a threshold value an index value of the neuron can be added to a blacklist. In some embodiments the threshold value can be determined by a number of times a group of neighbouring neurons are fired.

One example method to achieve a similarity preserving mapping is the self organizing map SOM originally developed by Kohonen see for example T. Kohonen Self Organizing Maps Springer Verlag 3edition 2001 . In general a high dimensional input vector v is mapped onto a grid of neurons. In some embodiments the grid of neurons is a 2D map or another lower dimensionality grid compared to the input vector. The SOM concept consists of the training phase and the actual mapping phase both of which are described in the following paragraphs.

Each neuron i in the grid has a receptive field with a weight vector wwhich has the same dimensionality as the input vector. The weight vectors are initialized e.g. with random values. One stroke of a gesture input sequence of points is interpolated by a fixed number of points N. The input vector v x x . . . x does not include the time stamps of the individual points so that only the shape of the gesture but not its timing is captured.

The weights wof neuron ithat are closest to the input vector i.e. have the smallest Euclidian distance are adapted in the direction of the input vector v. Also the weights of the surrounding neurons in the grid are adapted in the same direction but to a lesser extent. Over time the adaptation rate t and the spatial extent of the adaptation zone i i t around iare reduced to freeze the trained input weights. In a non limiting example the plasticity i.e. how strongly weights are adapted is reduced by a pre defined mathematic function. If time progresses the weight changes go down to zero. Mathematically speaking the weight adaptation is implemented as w w t i i t v w with i arg min v w . The function t could for example be a decaying exponential t cewith c 0 c 0 and i i t a Gaussian centered around i.

An example how a SOM adapts to the input statistics is shown in . For illustration purposes the input is a two dimensional shaded cloud and the neurons are at the intersection of the grid lines . The clear circle represents one input vector and one can see that the input weights of the closest grid neuron and its neighbours are adapted towards the clear circle .

Once the training is finished by presenting a large number of typical input vectors the weight vectors remain constant. New input vectors are presented to the SOM network and for each input the most responsive neuron i arg min v w is returned.

In an example embodiment the SOM concept is applied to server based blacklisting by performing the SOM training with input vectors consisting of a large number of gesture strokes. In some embodiments this training takes place on a server which resides in the network and can be reached by all users using gestures anonymously entered by users. During SOM training the different gestures are each entered with the same frequency so that the emerging self organizing map is not reflecting different gesture occurrence rates which would distort the map.

In some embodiments the resulting weight vectors wfor each neuron are transferred to end user electronic devices. When a user selects a new gesture stroke the user trains the gesture stroke. The trained gesture stroke is mapped locally in the electronic device to the most responding or closest neuron. The index of this most responding neuron is transmitted to the server which collects user statistics and increments the occurrence count of the respective neuron. After collecting the mapped neuron indices of many users some neurons will dominate the occurrence probability distribution. Users sending these neuron indices are informed that their underlying password gesture might be insecure since similar ones are used by many users. This embodiment does not produce a one to one mapping so the server will likely issue false alarms to be on the safe side. The larger the neuron grid is the more specific mappings can be created during the training phase. In some embodiments the map has a toroid structure i.e. a wrap around in order to avoid boundary problems. A boundary problem emerges when a map does not extend indefinitely or in other words is not a complete plane. In such circumstances many inputs are mapped to the boundary of the map despite being very different. However it is not feasible to have an indefinitely large map as the number of neurons becomes unmanageably large. Therefore a solution to avoid boundaries is a wrap around map i.e. a toroid.

A password gesture can consist of multiple strokes where one stroke starts when the finger touches the screen and ends when it is lifted. In an example embodiment every stroke of a password gesture is mapped individually to a neuron index and the sequence of indices is sent to the server. In some embodiments the user is requested to train a new password only if a percentage of the indices are frequently occurring. In another example embodiment the strokes of a gesture password are concatenated increasing the input dimensionality and the entire password is mapped to one neuron. Mapping of individual strokes to neurons provides more statistical input and lower input dimensionality.

Another example method to achieve a similarity preserving mapping is by encrypting a vector representing the gesture password with a certain set of slowly varying basic functions which are similar to the Fourier transformation. This kind of mapping reduces the dimensionality of the gesture stroke or strokes in such a way that it will be difficult to invert a mapped stroke to its original form and similar gesture shapes keep the similarity property in a new representation. In the example illustrated below a stroke N is normalized to 64 2 dimensional points. The stroke N therefore has 128 elements. A reduction ratio of 16 is taken and thus the dimensionality of a mapped stroke s is equal to 8.

In one embodiment a stroke of a gesture password can be mapped as follows. The points of the stroke N are written as a set of complex numbers where each point of N can be written as . . . 

Thereby b i denotes the i th column vector of the matrix B d is the number of dimensions d is an even number of the resulting mapped stroke and n is the point number of the stroke N. The matrix B is transformed into a d 2 n matrix Bwhere each element is presented as a complex number and can be expressed as follows 1 . . . 2 1 . . . 

To compute an encrypted stroke s each row of the matrix Bis multiplied with the corresponding point of the complex stroke z and the result is added to a new vector z. The vector zand stroke s can be written as follows 

The complex representation of the stroke allows a coupling of the x and y coordinates of points such that all features of the mapped stroke s depend on the whole stroke N.

Slowly varying functions are used to define the matrix B so the significant deviations in similar gesture shapes will not be amplified too much. Thus each row element i of the matrix B can be computed using the function fdefined on the interval 0 d 1 in the range of 0 1 . In cases where the dimensionality of a stroke s is equal to 8 eight basic functions one for each feature of s are used.

In example embodiments in which similarity preserving and non invertible representations of passwords are generated by way of encryption using slowly varying basic functions encrypted vectors are placed into one of a plurality of clusters based on their Euclidean distance from the core points of the clusters. That is similar vectors that have a low Euclidean distance from each other are clustered together. The number of encrypted vectors in each cluster is tracked. When the number of vectors in a particular cluster exceeds a threshold value indicating that many users have selected the same or similar gesture password the cluster of vectors is added to a blacklist. Thereafter the gesture password associated with any encrypted vector that is included in a blacklisted cluster is itself blacklisted.

Many algorithms for arranging values or vectors into clusters are known in the art. In one embodiment a density based clustering algorithm may be used. A density based clustering algorithm is an algorithm that defines clusters as dense areas of values or vectors separated by less dense areas such as the Density Based Spatial Clustering of Applications with Noise DBSCAN algorithm. The core of the DBSCAN algorithm consists of two concepts density reachability and density connectivity. These two concepts depend on two input parameters. The first parameter is which is the Euclidean distance around an object that defines its neighbourhood . The second parameter is the minimum number of points .

The algorithm defines an object q as a core point if there are points in the neighbourhood of the object q. The core points form the centres around which other objects are clustered. A point p is considered to be directly density reachable from a core point q if the point p lies within the neighbourhood of the core point q. A point p is considered to be density reachable from a core point q if there are a chain of points such that each point in the chain is in the neighbourhood of the adjacent point in the chain and one point of the chain is directly density reachable from a core point q. A point p is density connected to a core point q if there is another point o such that both p and q are density reachable from o.

In embodiments utilizing clustering of encrypted vectors an initial stage similar to the training of the self organizing map is implemented. In some embodiments this initial stage takes place on a server that can be reached by all users using gestures anonymously entered by users. During this initial stage a plurality of encrypted vectors are received and are analyzed using the DBSCAN algorithm to establish clusters.

An arbitrary vector that is marked unclassified is taken marked as classified and is checked to determine whether other vectors are in its neighbourhood. If not the vector is marked as noise and this step is repeated for all other vectors until no vectors are marked as unclassified .

If there are other vectors are in the neighbourhood of the arbitrarily selected vector the vector is considered a core point provided with a cluster label C and all other vectors lying in the neighbourhood of the vector are written into a separate set D .

A vector from the set D is then arbitrarily selected and assigned to cluster C. If the selected vector has at least vectors in its neighbourhood such vectors that are labelled as unclassified and noise are assigned to cluster C. Additionally the vectors that are marked as unclassified are added to the set D .

The arbitrarily selected vector from D is marked as classified and is removed from D . If D becomes empty the algorithm returns to the earlier step described above in which algorithm defines an object q as a core point if there are points in the neighbourhood of the object q Otherwise the algorithm returns to the earlier step described above in which clusters are established by first marking all received vectors as unclassified .

After the initial vectors are organized into clusters the numbers of vectors assigned to each cluster Care evaluated. If the number of vectors assigned to any individual cluster exceeds a threshold value the relevant cluster and all vectors associated therewith are added to the blacklist.

Once the initial vectors are organized into clusters the server is ready to receive encrypted vectors representing gesture passwords proposed by users. In one embodiment using the DBSCAN algorithm described above new encrypted vectors are either added to a pre existing cluster added to a new cluster that can be defined as a result of the addition of the new encrypted vector or marked as noise. Then the numbers of encrypted vectors assigned to each cluster Care evaluated. If as a result of the addition of a new encrypted vector the number of vectors assigned to any established cluster exceeds a threshold value the cluster and all vectors assigned to it are added to the blacklist. As well if the new encrypted vector is assigned to a cluster that already is on the blacklist the new encrypted vector is also added to the blacklist.

It will be appreciated that the performance of the DBSCAN algorithm that is the effectiveness of the algorithm in accurately assigning vectors to appropriate clusters will depend on the parameters and that are used. Simulations using a population of approximately 3000 vectors have been performed and the performance of the DBSCAN algorithm using several different combinations of the parameters and has been assessed. The vectors used during the simulations comprise mapped strokes selected from the data set of the Touch Word multi touch gesture security application used on many smartphones and tablet computers produced by BlackBerry. The performance of the algorithm is assessed using its overall accuracy which is equal to the number of true positives defined as the number of vectors that are correctly classified over the sum of the number of true positives and false positives defined as the number of vectors that are incorrectly classified . Assessing the overall accuracy of the DBSCAN algorithm using the above metric it has been found that the accuracy of the DBSCAN algorithm is optimized when 3 and 0.3. However it will be appreciated that the results of the optimization process will depend on the number of sample vectors used during optimization the dimensionality of the vectors used and the particular clusters arising from the set of vectors used.

Using the gesture representations on the user s device and on a central server as described above an example embodiment of a method implementing a gesture blacklisting concept will now be described with reference to .

At action the user enters one or several instances of a password gesture on his her local device. At action the trajectory representation is stored locally. At action a similarity preserving mapping is applied to the trajectory representation to create a non invertible vector or index value. It will be understood that the similarity preserving mapping can be achieved using either the self organizing map method resulting in the generation of a non invertible index value or the slowly varying basic functions method resulting in the generation of a non invertible vector.

At action the index value or vector is transferred to the blacklisting server and added to the statistics of all users. Depending on whether an index value or vector is received this can be accomplished by increasing the occurrence rate of the received index value or by associating the received vector with an appropriate cluster of vectors. At action whenever the occurrence rate of the index value or the number of vectors associated with a cluster exceeds a threshold the user is notified that the corresponding gesture password is insecure and that s he should train a new gesture password.

In some embodiments the user ID is not stored on the server when the user sends the index value or vector for the newly trained password gesture only the number of users is registered. This would be sufficient for the blacklisting concept.

In some embodiments the gesture index value or vector is saved together with the user ID thus enabling a central authentication. In addition in some embodiments the system could store the dates when the password has been changed in the past and request to train a new gesture password when the validity time interval expires or the training example is too similar to an already used password gesture.

Referring now to an embodiment of a method for blacklisting gesture based passwords to be implemented on a blacklist server will be described. At action an index value representing a gesture based password is received from an electronic device. At action an occurrence of the index value is increased in a data store of index values. At action the server determines if increasing the occurrence of the received index value in the data store results in a blacklist threshold being exceeded. At action if the blacklist threshold is exceeded updating a blacklist stored on the blacklist server to include the received index value. In some embodiments the index value is a similarity preserving index value. In some embodiments the index value is non invertible. In some embodiments the index value is a non invertible similarity preserving index value.

In some embodiments updating the blacklist comprises only inputting the received index value to the blacklist if the received index value is missing from the blacklist.

In some embodiments the method further comprises receiving a plurality of index values from an input interface to populate the data store and inputting the plurality of index values to the data store. The method can additionally comprise for each index value inputted to the data store determining if a number of the index values in the data store having a value within a threshold range of the inputted index value exceeds a blacklist threshold and if the number exceeds the blacklist threshold inputting the inputted index value to a blacklist stored on the blacklist server.

In some embodiments determining if increasing the occurrence of the received index value results in exceeding the blacklist threshold comprises determining if a number of the index values in the data store having a value within a threshold range of the received index value exceeds the blacklist threshold.

In some embodiments determining if increasing an occurrence of the received index value results in a blacklist threshold being exceeded comprises determining if inputting the received index value results in a weight of a corresponding neuron in a self organizing map exceeding a weight threshold.

In some embodiments the method further comprises creating a self organising map of neurons the neurons representing input vectors corresponding to gestures. Creating the self organising map in some embodiments comprises receiving a plurality of gestures each gesture being received multiple times at the same frequency as the other gestures converting each of the plurality of gestures into an input vector for each input vector adapting a weight of a closest neuron in a direction of the input vector. In some embodiments the method further comprising assigning a non invertible similarity preserving index value to each neuron.

In some embodiments if the blacklist threshold is exceeded a notification is transmitted to the electronic device indicating that the gesture based password is blacklisted.

In some embodiments the method further comprises receiving a user identifier associated with the received index value and storing the user identifier in the data store in association with the received index value.

In some embodiments the method further comprises storing a received time in association with the received index in the data store. The method can further comprise monitoring the received time and when a difference between the received time and a present time exceeds a time threshold transmitting an expiry notification to the electronic device indicating that the password has expired.

Referring now to another embodiment of a method for blacklisting gesture based passwords to be implemented on a blacklist server will be described. At action a vector is received from an electronic device the vector representing a gesture based password. In one embodiment the vector is a similarity preserving vector such that similar gesture based passwords are mapped to vectors having a low distance between each other. At action the received vector is associated with one of a plurality of clusters of vectors. At action the blacklist server determines if the association of the received vector with one of the plurality of clusters of vectors causes the number of vectors in the cluster to exceed a threshold value. At action if the number of vectors in the cluster exceeds a threshold value a blacklist stored on the blacklist server is updated to include vectors within the cluster.

Referring now to a method for implementation on an electronic device for updating a blacklist stored on a blacklist server will now be described. At action a gesture based password is received via an input interface. At action the gesture based password is converted into an index value. At action the index value is transmitted to a blacklist server. In some embodiments the index value is a similarity preserving index value. In some embodiments the index value is non invertible. In some embodiments the index value is a non invertible similarity preserving index value.

In some embodiments the method further comprises receiving an indication from the blacklist server of whether or not the index value corresponds to a blacklisted gesture.

In some embodiments the method further comprises receiving a self organising map SOM from the blacklist server the SOM including neurons the neurons representing input vectors corresponding to gestures converting at least one gesture of the password into an input vector and mapping the input vector to the SOM. Converting the gesture based password into the index value comprises assigning an index value corresponding to a neuron of the SOM closest to the input vector.

In some embodiments the electronic device outputs a notice to a user interface indicating that a new password must be selected if the index value corresponds to a blacklisted gesture.

Referring now to an alternative method for implementation on an electronic device for updating a blacklist stored on a blacklist server will now be described. At action a gesture based password is received via an input interface on the electronic device. At action the electronic device generates at least one vector representing the gesture based password the at least one vector being a similarity preserving vector such that similar gesture based passwords are mapped to vectors having a low distance between each other. At action the electronic device transmits the at least one vector without the gesture based password on which the at least one vector is based to the blacklist server.

Referring now to an electronic device in accordance with an example embodiment will be described. The electronic device comprises a processor a memory and an input interface . The memory has computer readable instructions stored thereon that when executed by the processor implement any of the methods described herein for implementation on an electronic device. The input interface is for receiving the gesture based password.

Non limiting examples of the input interface are a touch screen an accelerometer sensor a gyroscope sensor and a camera.

Referring now to an example embodiment of a blacklist server will be described. The blacklist server comprises a processor a memory and a receiver . The memory has computer readable instructions stored thereon that when executed by the processor implement any of the methods disclosed herein for implementation on a server. The receiver is for receiving the non invertible similarity preserving index value.

A non limiting example of the blacklist server is an authentication server. Alternatively a generic server located in the internet could be used. In some embodiments the sole purpose of the server is to check if gestures are blacklisted.

Embodiments of the blacklisting concepts described herein for gesture based passwords increase the security level for authentication purposes by avoiding common gesture inputs. Even blacklists with larger numbers of gestures can be verified since the check is only needed at the beginning during the training phase i.e. it is not time critical. The implementation of the gesture blacklisting based on index values does not require significant processing and even large index tables can be checked efficiently. The storage of gesture index values on the server does not compromise password security on the user s terminal.

The check for passwords needs to cope with imperfect user gesture input. Thus a perfect match of training and test gesture is almost impossible. This needs to be taken into account in the design of the similarity preserving mapping between gesture and index value.

While the present disclosure is sometimes described in terms of methods a person of ordinary skill in the art will understand that the present disclosure is also directed to various apparatus including components for performing at least some of the aspects and features of the described methods be it by way of hardware components software or any combination of the two or in any other manner. Moreover an article of manufacture for use with the apparatus such as a pre recorded storage device or other similar computer readable medium including program instructions recorded thereon may direct an apparatus to facilitate the practice of the described methods. It is understood that such apparatus and articles of manufacture also come within the scope of the present disclosure.

The various embodiments presented above are merely examples and are in no way meant to limit the scope of this disclosure. Variations of the innovations described herein will be apparent to persons of ordinary skill in the art such variations being within the intended scope of the present application. In particular features from one or more of the above described embodiments may be selected to generate alternative embodiments comprised of a sub combination of features which may not be explicitly described above. In addition features from one or more of the above described embodiments may be selected and combined to generate alternative embodiments comprised of a combination of features which may not be explicitly described above. Features suitable for such combinations and sub combinations would be readily apparent to persons skilled in the art upon review of the present application as a whole. The subject matter described herein and in the recited claims intends to cover and embrace all suitable changes in technology.

