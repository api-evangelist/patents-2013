---

title: Atrial fibrillation classification using power measurement
abstract: An atrial fibrillation classification system collects celectrocardiogram signals and converts them to a frequency, time, or phase domain representation for analysis. An evaluation stage extracts energy density profile over a range of frequencies, time intervals, or phases, which is then summed and normalized to form dispersion metrics. The system then analyzes the dispersion metrics, in their respective domains, to determine whether a patient is experiencing an arrhythmia and then to classify the type of arrhythmia being experienced.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09037223&OS=09037223&RS=09037223
owner: THE REGENTS OF THE UNIVERSITY OF MICHIGAN
number: 09037223
owner_city: Ann Arbor
owner_country: US
publication_date: 20130110
---
This application claims priority to U.S. Provisional Application No. 61 584 954 entitled Atrial Fibrillation Classification Using Power Measurement filed Jan. 10 2012 which is hereby incorporated herein in their entirety.

The present disclosure relates generally to identifying heart rhythm state and more particularly to determining whether the heart rhythm is in a cardiac arrhythmia state such as atrial fibrillation using a measured power value.

This invention was made with government support under HL039707 awarded by the National Institutes of Health. The Government has certain rights in the invention.

The background description provided herein is for the purpose of generally presenting the context of the disclosure. Work of the presently named inventors to the extent it is described in this background section as well as aspects of the description that may not otherwise qualify as prior art at the time of filing are neither expressly nor impliedly admitted as prior art against the present disclosure.

Atrial fibrillation is a form of cardiac arrhythmia where there is disorganized electrical conduction in the atria causing rapid uncoordinated depolarizations that result in ineffective pumping of blood into the ventricle and a lack of synchrony. During atrial fibrillation the atrioventricular node receives electrical impulses from numerous locations throughout the atria instead of only from the sinus node. This overwhelms the atrioventricular node into producing an irregular and often rapid heartbeat. Due to the lack of organized contraction of the atria blood may pool in the atria increasing the risk for blood clot formation. The major risk factors for atrial fibrillation include age rheumatic heart disease valvular heart disease hypertension diabetes coronary artery disease and thyrotoxicosis. Atrial fibrillation affects about 7 of the population over age 65. At present there are over 6 million patients affected with atrial fibrillation AF only in the US. It is estimated that by 2025 over 10 million patients will have atrial fibrillation. AF is the leading cause of strokes and is the most common arrhythmia leading to hospital admissions.

AF may be intermittent paroxysmal or persistent. It may be acute and terminate within a relatively short period of time or it may be chronic and persist for years. AF may develop in patients with structurally normal hearts as well as in patients with associated comorbidities including structural heart disease. Based on the presence of clinical characteristics and comorbid conditions patients with AF are at variable risk for stroke and other thromboembolic events. Therefore based on the degree of risk of stroke patients are treated either with antiplatelet or anticoagulant agents to reduce the risk of stroke. However these agents on the other hand do increase the risk of bleeding complications including intracranial risk. Therefore in patients with AF risk of thromboembolic events particularly stroke compete against the risk of bleeding complications due to antiplatelet anticoagulant agents. To optimize these competing risks it is desirable to accurately identify when patients with a history of AF go into AF and how long they stay in AF.

AF treatment options are still evolving. In most patients restoring and maintaining sinus rhythm is preferred as sinus rhythm is often associated with an improvement in quality of life improvement in atrial and ventricular remodeling with an improvement in ejection fraction possibly a reduction in the risk of thromboembolic events and elimination of the need for anticoagulant therapy in most patients. Cardioversion attempts to restore sinus rhythm yet even if successful acutely AF may still recur as cardioversion does not eliminate the underlying mechanisms of AF. In addition if there is a blood clot in the atria cardioversion may cause the clot to leave the heart and travel to the brain leading to stroke or to some other part of the body.

One of the more recent procedures for treating cardiac arrhythmias is catheter ablation therapy. Physicians make use of specialized ablation catheters to gain access to interior regions of the body. Catheters with tip electrodes or other ablating devices are used to create ablation lesions that physiologically alter the ablated tissue without removal thereof and thereby disrupt and or block electrical pathways through the targeted tissue. In the treatment of cardiac arrhythmias a specific area of cardiac tissue having aberrant electrically conductive pathways such as atrial rotors emitting or conducting erratic electrical impulses is initially localized. A user e.g. a physician directs a catheter through a main vein or artery into the interior region of the heart that is to be treated. The ablating element or elements are next placed near the targeted cardiac tissue that is to be ablated such as a pulmonary vein ostium or atrum.

While the available treatment methods provide various degrees of success it is nonetheless difficult at times to determine the effectiveness of the treatment. Part of the difficulty arises because care professionals will typically rely even partially on the patient s perceived state of health to gauge effectiveness. Patients naturally have varying levels of perception and moreover a patient may experience atrial fibrillation and not know it. This problem is in fact heightened after a medical procedure when the patient has returned to normal life and may begin experiencing atrial fibrillation while feeling as those their heart function is normal. Up to one third of patients with AF do not appreciate or know that they are experiencing AF and therefore they do not know they are at heightened risk for stroke. It is therefore desirable to have an effective mechanism to measure atrial fibrillation that is cost effective and consistent in operation.

In an embodiment an apparatus for detecting arrhythmias within a body the apparatus includes an input stage to receive an electrocardiogram signal from a body connected thereto through a detection electrode input wherein the input stage is a real time dynamically adjustable signal transformation stage configured to condition the electrocardiogram signal an analysis stage coupled to the input stage to receive the conditioned electrocardiogram signal from the input stage wherein the analysis stage comprises a transformation stage wherein a frequency and or phase domain representation of the conditioned electrocardiogram signal is formed from the conditioned time domain electrocardiogram signal and an evaluation stage wherein time frequency and or phase domain features related to the arrhythmias are extracted from the time frequency and or phase domain representation. Wherein one possible instantiation of the evaluation stage comprises a Spectral Dispersion Metric SDM evaluation stage configured to determine for example the dispersion of frequency energy over a predetermined range of frequencies relative to the frequency with the highest energy Spectral Frequency Dispersion Metric SFDM and or Spectral Time Domain Dispersion metric STDM and or Spectral Phase Domain Dispersion Metric SPDM representations and configured to normalize the energy to form a dispersion metric over the predetermined range of frequencies time intervals and or phases and a classification stage coupled to the evaluation stage to receive the total normalized power and determine whether the body is experiencing the arrhythmias.

In accordance with another example an apparatus for detecting arrhythmias within a body the apparatus includes an input stage to receive an electrocardiogram signal from a body connected thereto through a detection electrode input wherein the input stage is a real time dynamically adjustable signal transformation stage configured to condition the electrocardiogram signal an analysis stage coupled to the input stage to receive the conditioned electrocardiogram signal from the input stage wherein the analysis stage comprises a transformation stage wherein a frequency time or phase domain representation of the conditioned electrocardiogram signal is formed from the conditioned electrocardiogram signal being in a time domain signal and an evaluation stage wherein frequency time or phase domain features related to the arrhythmias are extracted from the frequency time or phase domain representation wherein the evaluation stage is configured to determine a summed energy over a predetermined range of frequencies time intervals or phases for the frequency time or phase domain representation and configured to normalize the summed energy to form a spectral frequency dispersion metric SFDM spectral time domain dispersion metric STDM and or spectral phase domain dispersion metric SPDM over the predetermined range of frequencies time intervals or phases and a classification stage coupled to the evaluation stage to receive the SFDM STDM and or SPDM and to determine whether the body is experiencing the arrhythmias.

In accordance with another example an apparatus for detecting arrhythmias within a body the apparatus includes an input stage to receive an electrocardiogram signal from a body connected thereto through a detection electrode input wherein the input stage is a real time dynamically adjustable signal transformation stage configured to condition the electrocardiogram signal an analysis stage coupled to the input stage to receive the conditioned electrocardiogram signal from the input stage wherein the analysis stage comprises a transformation stage wherein a time domain profile of the conditioned electrocardiogram signal is formed and an evaluation stage configured to determine over the time domain profile at a plurality of predetermined time intervals and to determine the number of times a spectral time domain dispersion metric STDM is in one or more count ranges over the plurality of predetermined time intervals and a classification stage coupled to the evaluation stage to receive the STDM and determine whether the body is experiencing the arrhythmias.

In accordance with another embodiment a method of analyzing patient data the patient data including electrocardiogram data the method comprises receiving at an analysis machine the electrocardiogram data from a database identifying at the analysis machine target patient data from the database processing at the analysis machine the target patient data and the electrocardiogram data identifying at the analysis machine from the processed target patient data and the electrocardiogram data diagnostic features using an adapting algorithm wherein the diagnostic features represent correlations or patterns within the processed target patient data and the electrocardiogram data and wherein the diagnostic features correspond to a diagnosable condition of a patient and assessing at the analysis machine the diagnostic features to determine the presence of the diagnosable condition for the patient.

Generally techniques herein describe methods and devices for the automated classification of a heart rhythm across a spectrum from normal rhythm called sinus rhythm to cardiac arrhythmia such as atrial fibrillation AF . The techniques encompass measuring a metric of heart performance that is chosen to assess heart rhythm performance over a functional operation range. That metric is correlated to heart rhythm conditions in that different values are predetermined to indicate different rhythm conditions from sinus rhythm to AF. More specifically in various embodiments discussed below the techniques involve determining a metric called the Spectral Frequency Dispersion Metric SFDM which is the sum of the spectrally distributed energy relative to the maximal energy over a set of specified frequencies and bands obtained from electrical recordings from the heart. The SFDM is therefore a metric related to the distribution of a heart performance metric in this case a measured energy across a specified functional operation range in this case discrete or continuous frequency bands .

The performance metric s once determined i.e. SFDM is correlated to heart rhythm state for use in diagnostic classification. For example a baselining procedure is performed to determine the optimal segmentation of clusters generated by the SFDM or transformations of the SFDM i.e. mean standard deviations etc each corresponding to a different heart rhythm state. In an example implementation SFDM values within a first region are correlated as identifying sinus rhythm. SFDM values in a second region exceeding predetermined critical values i.e. the energy is widely distributed are correlated to AF. While SFDM values in a third region between the two are correlated to an atrial flutter AFL condition. Multiple additional SFDM value ranges may be used to further parse the heart rhythm spectrum to identify cardiac arrhythmia states.

At the point of care or wherever patient assessment may be desired the techniques may be implemented in a device having a form factor that is simple enough for patient use allowing for user friendly operation within or outside of a care facility. The techniques may be implemented in a single device or across multiple devices in a distributed fashion and either way performing both SFDM measurement and heart rhythm classification for easy identification by a patient or heath care professional. In some implementations the device is a portable stand alone device that records electrical activity from the heart and then determines the presence of AF in patients such as those that have already been diagnosed as being at a risk of developing intermittent episodes of arrhythmia. The device may be compact in size e.g. hand held and with easy to apply electrodes to establish contact with the patient. Through these electrodes electrical activity and its vector may be recorded from the patient filtered amplified and processed using unique embedded algorithms to detect the rhythm status.

The device may be designed to display both the measured electrical activity in real time similar to an ECG monitor and the rhythm status either to a separate monitor or to a display on the device itself. The simplest realization of the device may only employ indicator lights or an audio vibratory alert. The rhythm status may be displayable in both a common language manner e.g. using phrases like NORMAL ALARM ABNORMAL ATRIAL FIBRILLATION AF color coded to alert the patient of the rhythm status or with the use of intuitive icons or a combination thereof. In some examples the techniques are implemented in a networked environment by which data measured from the device whether displayed at the device or not may be displayed at a remote system such as at a healthcare facility hospital nurses station doctors terminal prescription system hospital administration system . The device receiving real time data may store that data in a structured indexed database for later retrieval by the device and for transmission to a central monitoring facility or other station as mentioned herein for example through a remote wireless network connection. The device may further include voice sound feedback and or tactile vibratory feedback.

The present techniques may also allow for controlling operation of AF determination and assessment. For example the device or other computer device networked therewith may provide a medical practitioner with an user input interface through which the practitioner may adjust operation of the device including the sensitivity and specificity of AF assessments. In yet other examples the present techniques may be used to store historic patient AF assessment data e.g. ECG data and perform data mining on that data e.g. in an informatics based manner to identify hard to notice hidden correlations of different time frequency of phase patterns for AF assessment and treatment protocol determination.

The techniques are able to offer numerous advantages and may be vitally important to determine the rhythm status in patients diagnosed with AF. The techniques will allow patients to know if they are in a normal sinus rhythm condition or in AF condition particularly during or after specific therapy applications which may include pharmacological therapy with drugs or catheter or surgical based ablation therapies. During some therapy applications patients are most at risk for stroke when they are experiencing AF. In such examples an anticoagulant may be greatly helpful in reducing the risk of strokes due to blood clots. However in other conditions anticoagulants may increase the risk of bleeding particularly intracranial bleeding which can cause serious consequences. Therefore the present techniques provide a measured way for a patient to know if they are experiencing sinus rhythm or AF so that the patient can know on their own whether or not to take an anticoagulant. Even outside of the therapeutic context and more generally patients may be experiencing AF and not be aware of it. If AF is untreated and is associated with rapid heart rates this subsequently may impair the contractile function of the heart and may lead to a cardiomyopathy. With the present techniques patients have a simplified method of identifying an AF condition.

The electrode assembly is coupled directly to the electrodes in the illustrated embodiment and may include a signal amplifier low pass filter buffer and or other front end circuitry. In a wireless communication mode the electrode assembly further includes an antenna and wireless transceiver stage coupled thereto. In an example that wireless transceiver may be a Bluetooth transceiver stage for wireless communication with a handheld atrial fibrillation classification unit also having an antenna and a Bluetooth transceiver stage. In some examples the electrode assembly is connected to the atrial fibrillation classification unit through a direct wired connection.

The atrial fibrillation classification unit discussed further and illustrated in an example in receive electrical signals from the unit and performs an analysis on those electrical singles including determining a spectral frequency dispersion metric SFDM value over a predetermined range of frequencies and then performing a heart rhythm classification based on that total normalized power values. The classification data may be stored at the unit and or transmitted to a remote computer through a wired or wireless connection WLAN . Examples of wired interfaces include serial universal serial bus USB or Ethernet. A WLAN compatible transceiver stage not shown within the device may be a transceiver compliant with any one of the various IEEE 802.xx wireless standards such as 802.15 Bluetooth or 802.11a b g and or n wireless LAN standards. Additionally longer range wireless communications such as cellular modems WiMAX 802.16 or Mobile Broadband Wireless Access 802.20 may be used for longer ranges or direct communication with the hospital or any monitoring station service.

The remote computer may be any of a hospital nurse s station doctor s terminal prescription system or hospital administration system. And while a single such remote computer is shown a plurality of remote computes may be connected to the device. The remote computer is coupled to medical records database for storing historical atrial classification data for the patient and or other atrial classification data such as baseline data used for baselining. A display is coupled to the remote computer as well as output device such as a peripheral printer such as a bar code printer line printer image printer etc. Other output devices may include an external database or other computer.

The microcontroller is coupled to patient electrodes through an interface which is a wired interface in the illustrated example. In the illustrated example therefore no separate electrode assembly is used. Instead electrodes are coupled directly to the atrial fibrillation classification device . In a configuration like that of no wired interface would be used but instead the wireless interface would be used to receive electrical signals from the patient electrodes via a wireless electrode assembly.

Received signals from the interface are coupled to signal conditioning circuit with integrated switch capacitor network. Example conditioning circuits include ECG signal conditioning circuits although any conditioning circuit may be used to amplify the received electrical signal pass the signal through a low pass filter for noise reduction and perform any shaping on the signal to reduce flutter jitter and or other noise. The conditioned electrocardiogram signal from the interface is coupled to a 12 bit analog to digital converter coupled to the microcontroller .

In this configuration the blocks and form an input stage receiving an electrocardiogram signal from patient electrodes. This input stage is coupled to the microcontroller through a dynamic reconfiguration interface to allow dynamic adjustment of the signal processing in the input stage. This dynamic adjustment includes signal amplification DC offset removal bandwidth adjustment of notch and bandpass filters to optimize the acquired signal.

The microcontroller includes an analysis stage that receives the amplified electrocardiogram signal from the input stage and performs various functions such as buffering the received data performing a Fourier transform on the received data to convert the data into a Fourier domain signal. The microcontroller then determines a SFDM for the Fourier domain signal where the energy is determined over a predetermined set of frequencies and is divided by the maximum energy level. The set of frequencies may be contiguous but need not be. Specifically selected frequencies may be used in some examples. The device used sufficient samples to perform an n point FFT after which the additional data could be used to calculate other statistical metrics such as means and standard deviations. From the SFDM the microcontroller performs a heart rhythm classification identifying whether the SFDM indicates that the patient is experiencing sinus rhythm atrial fibrillation atrial flutter or ventricular fibrillation which indication may be stored on the storage displayed at the display and transmitted continuously periodically or in response to poling to a remote system through either the interface or .

The Fourier domain signal is a frequency domain signal. In other examples the microcontroller operates in the time domain or phase domain from which STDM and SPDM values are determined.

The received signal is passed to a 60 Hz finite impulse response FIR filter having a 6 Hz bandwidth that is part of an analysis stage of the controller . A buffering stage includes an averaging filter that down samples the input signal to 200 Hz. The ADC stage may sample at about 10 kHz which is then averaged over 50 samples to reduce noise resulting in a 200 Hz down sampled signal. A functional block removes a DC offset value from the averaged signal before the signal is passed through a windowing function which applies a symmetrical function increasing from zero to a peak and decaying back to zero to optimize the spectral estimate of the signal. In the illustrated example a Blackman Harris window is used but any number of window functions may be used.

A domain transform is performed on the averaged signal in the illustrated example by a fast Fourier transform FFT function in this case a 1024 point FFT as part of a transformation stage. The frequency set used for analysis is selected through a logical conjunction of the frequency domain signal and frequency bin selector mask function . For example the selector function may identify a frequency range of between 0 100 Hz and more particularly between 0 40 Hz and even more particularly between 3 20 Hz. The bin selector is coupled to a spectrum summation function that determines energy values across the frequency domain signal and sums the energy values to produce a total energy value. The frequency bin selector may focus on a weighted group of frequencies in the frequency domain weighted group of phase delays in the phase domain or weighted group of times in the time domain. The frequency bin selector or any of the blocks of the evaluation stage may employ a search algorithm to automatically determine from the electrocardiogram signal optimal sets of frequencies to use in distinguishing between sinus rhythm atrial fibrillation atrial flutter and or ventricular fibrillation. The frequency bin selector function is also coupled to a max spectrum determination function that determines the maximum energy across the frequency domain signal. The SFDM or STDM or SPDM is determined at a block in the illustrated example by dividing the summed energy from the block by the maximum energy from the block . The blocks and therefore may form part of an evaluation stage along with blocks and discussed below in the illustrated example. It will be appreciated that these stage indicators are provided by way of example and that any number of the blocks may be combined in different combinations into different stages and that the descriptions herein are for convenience and explanation purposes only.

In some examples the SFDM from the block is coupled directly to a classification stage while in other examples the SFDM from the block is coupled to an averaging stage that determines the mean SFDM over a number of measurement cycles. The classification stage may include a predetermined set of ranges for SFDM values corresponding to normal sinus rhythm atrial flutter atrial fibrillation and ventricular fibrillation. For example ventricular fibrillation may be characterized by a very sharp decrease in power at around 1 2 Hz relative to sinus rhythm. Atrial fibrillation and atrial flutter may be characterized by different alterations in the mean standard deviation skewness and or kurtosis of the energy profile power spectrum of each cycle relative to sinus rhythm. The classification stage thus compares the received TNP value to these ranges and creates a heart rhythm classification which signal may be displayed on the display stored on the memory and or transmitted to a remote station through interfaces and or . The classification block may deploy any suitable algorithm of which a genetic algorithm is an example. This classification occurs automatically as described and may be part of a learning system in which classification assessment is optimizable either manually through operator adjustment in a semi automated manner or a fully automated manner.

In some examples additional analysis of the SFDM data is used to strengthen the classification determination in particular where more than three different classifications are used. For example additional statistical metrics may be used to extract time domain statistics of the SFDM metric. The data can be used to provide a more robust prediction by improving accuracy though the evaluation of other features of the signal. For example the SFDM data from block may be provided to a SFDM standard deviation function which provides the SFDM data to the classification stage . In another example the SFDM block is coupled to another statistical metric block that performs a skew kurtosis or other statistical operation on the data designed to further reduce extraneous signal components before the SFDM data are sent to the classification stage. While the illustrated example uses a FFT other implementations may be achieved. For example one could use an field programmable gate array FPGA with a parallel arrangement of digital band pass filters to allow real time parallel computation of the classification result. Another example would be to design an integrated circuit with a parallel array of analog band pass filters feeding into an analog summing stage and comparator to provide a completely analog implementation thereof.

These are examples of how multiple feature extractions may be performed over time to produce statistics metrics for the SFDM STDM and or SPDM prior to classification at a classification stage. In some examples those multiple feature extractions may be performed on frequency time or phase domain representations i.e. on converted spectral dispersion of the frequency time or phase respectively to produce statistics metrics prior to determination of the SFDM STDM and or SPDM and thus prior to classification at the classification stage.

In some examples the classification stage receives a single feature or vector such as the SFDM. In the case of a single feature e.g. SFDM the classification may be achieved by a threshold function. However in other examples more features may be supplied to the classification stage . In such examples the received vector may be applied to a system of equations implemented using a suitable means i.e. regression neural network linguistic expression etc. to produce either or both a binary classification output and continuous measure of the severity or probability the patient is in AF. An example of this may be if both the SFDM and the kurtosis of the SFDM over time are used as inputs to the classification stage . If these features were not combined i.e. using a regression function into a single metric again a 2D classification surface would result. If SFDM values for distinct cardiac states were displayed as a scatter plot ideally discrete clusters would be seen. A classification function i.e. linear spline circle etc. could be used to describe these regions allowing the device to report the current cardiac state a patient was in given their ECG. Therefore the classification stage may comprise an additional 2 sub stages 1 additional transformation for example through a regression function and 2 multi dimensional segmentation of the clusters describing various cardiac states.

Other example transformations include the continuous wavelet transform which is able to construct a time frequency representation of a signal with improvements in time and frequency localization compared to standard FFTs. Another technique is time frequency reassignment which can be used to overcome the tradeoff between the time and frequency resolution associated with the short time FFT. This technique refocuses the time frequency data by mapping the data to time frequency coordinates that are nearer to the true region of support of the analyzed signal.

In the illustrated example the spectral conversion domain signals are passed to a block which determines the bandwidth of the domain signals and whether a desired sub band range exists. The block for example may be executed by the frequency bin selector containing a predetermined frequency range over which power values are to be totaled.

At a block the device e.g. the elements and determines the power spectrum over the domain signals and more specifically summed energy across the predetermined domain range. This range may be normalized by the highest energy level for example as discussed above in regards to element or classification may be performed over un normalized data. It has been determined by the present inventors that summed energy over a particular range of frequency components correlates with different states of heart rhythm in particular with different cardiac arrhythmia conditions. Instead of conventional techniques that determine a dominant frequency among the domain signals the present technique may avoid determining dominant frequencies and instead determine total energy over a range of frequencies. That summed energy may be absolute summed energy. While in other examples the domain signals are passed through a threshold process e.g. at block that identifies only those frequencies having a summed energy above a threshold which are then summed to determine total energy.

Because summed energy is used problems with low signal to noise in conventional systems are avoided allowing for more accurate determinations of atrial fibrillation. Issues with the drive circuitry pulsing altering sensed electrocardiogram signals is reduced or eliminated as is operator subjectivity which can affect measurements in conventional systems. Also because energy power is determined over a minimal set of data e.g. 0 20 Hz the ultimate classification is more robust because it focuses on a known previously analyzed classification spectrum region. The summed energy technique also does not require altering the electrocardiogram signals by the subtraction of the ventricular activity i.e. the QRS and T complexes of the ECG although such subtraction may still be performed. Further still the sampling of summed energy is typically performed at a lower sampling interval e.g. every 3 5 seconds reducing the computational demand compared to more real time systems. This also allows for the implementation entirely in hardware and or software. Furthermore the present techniques have low latency times between summed energy measurements. Latency times below 1 s have been shown in some examples. Furthermore electrical lead placement is not critical for the summed energy determination as electrocardiogram signals may be recorded by any lead configuration whether leads are placed precordially or on the limbs.

Optionally a block may buffer summed energy data over a period of time and perform additional analysis on that data including determining standard deviation of the summed energy values with or without normalization and then performing skew or kurtosis shaping to isolate the buffered data further.

At a block the SFDM data is analyzed to determine which classification of heart rhythm the data corresponds thereby indicating whether the patient is experiencing sinus rhythm atrial flutter atrial fibrillation and ventricular fibrillation.

The SFDM may be determined from electrocardiogram signals collected from a single location as discussed above or from multiple locations. For example the multiple electrode pairs may be placed simultaneously in the precordial region and on one or more limbs from which a classification device is able to determine SFDM over a range of regions. In such examples scaling of summed energy values in different regions may be used to account for inherently different energy levels. Determinations based on STDM and SPDM would follow accordingly.

In other examples classification devices are able to isolate summed energy measurements at different locations that are each individually calibrated to heart rhythm classification. In such examples certain summed energy values measured at the precordial regions may indicate a first heart rhythm condition while those same normative summed energy values at a limb may not indicate the first heart rhythm condition but another.

The display presents the data to the user who is able to respond by manually optimizing operation of the AF engine through a user input . For example the display may present the user with the AF data and an interface in response to which the user at the block determines a suggested change in the specificity and or sensitivity of the AF engine . If the user determines that a change in specificity and or sensitivity is desired then a control signal is sent to a sensitivity and specificity engine that sends a control signal to the AF engine modifying operation thereof.

In this way the system may analyze the characteristics of diagnostic metrics utilized to discriminate the arrhythmias for each patient. Based on the distribution of measured metrics from the ECG for example the thresholds or other metric criteria used to classify different rhythms as normal sinus rhythm atrial fibrillation ventricular fibrillation flutter may be adjusted to optimize the diagnostic accuracy of the system for each patient individually. This may be accomplished with a user input interface e.g. where the display provides an operator physician a scattergram of the distribution of the metrics from the engine .

In manual operation the operator physician may manually adjust thresholds or other metric criteria based on the scattergram data. In a semi automated manner the sensitivity and specificity engine may determine from the AF data of AF engine a suggested threshold or other metric criteria that matches an initial desired sensitivity and specificity range. This suggested value or suggested operating range is then provided back to the AF engine and overlayed or otherwise displayed to the user along with the AF data on the display . The user may then at block accept the suggested value s thresholds or other metric criteria or make manual adjustments thereto to thereby alter the sensitivity specificity of the AF engine . In a fully automated operation the engine may not only automatically determine the suggested threshold or other metric criteria for making the AF assessments but then automatically adjust the AF engine to operate in accordance with those conditions i.e. without user input. Applying these techniques to that of for example the engine may adjust any of the metrics used by blocks to optimize or otherwise customize operation of the classification at block . For the semi automated or fully automated modes a learning engine is provided to receive the output AF data from the engine and any other patient related dated whether real time data historical data or otherwise. That learning engine may automatically provide control signals for adjusting the sensitivity and specificity at the engine or it may do so under control of the user via input .

Thus the system is able to optimize sensitivity and specificity of the determination of any rhythm to account for possible false positives and false negative results according to the clinical condition and requirement set forth by a clinician s discretion. For example when a patient has a stroke risk higher than bleeding risk then the detection of AF and use of anti coagulants could be determined with a higher priority on sensitivity over specificity 100 sensitivity guaranteed . If on the other hand a patient s highest risk is of bleeding then the priority is specificity over sensitivity 100 specificity guaranteed . Such adjustments can be made through manually semi automated or fully automated adjustments.

The ECG data and AF data collected for patients may be used for individualized patient or group data mining. Patient data whether collected from an handheld AF classification device electrocardiographic recording system or otherwise is stored in a database. A data mining engine may analyze the database e.g. in an ECG informatics manner deploying a genetic algorithm to identify hard to notice hidden correlations of temporal spectral and phase patterns within the patient data. This data mining could include identifying metrics calculated in those domains such as total energy over specified domain ranges. The patient data would be collected across episodes of cardiac electrical activity of various rhythms and properties. Those episodes could be episodes belonging to the same patient at different times frequencies and or phases or those belonging to different patients as part of a population study. In some examples the data mining engine may search for patterns across ECG data to identify hidden occurrences e.g. in the converted frequency time or phase domain of that ECG data that correlate to different AF classifications. Such occurrences thus may determine indicators that are more nuanced or more complex than the threshold and other metrics discussed herein or that are more multivariate than would be the case for initial AF classification algorithms. Such data mining thereby may be used along with the adapting algorithms described herein e.g. the genetic algorithms that may be implemented by the AF classification block to provide historical data based optimization and customization of AF assessment. One of the advantages of using historical data in this manner is that additional patient data including data external to the AF classification systems described herein and otherwise believed irrelevant to AF classification may also be provided and considered by the system. Examples of such data include patient demographic data e.g. age gender ethnicity etc. physiological data e.g. weight heart size blood pressure etc. and time course of cardiac function e.g. ECG time series ECG intervals heart rate incidences of extrasystoles AF heart rate variability HRV parameters heart rate turbulence etc. .

A block receives initial patient data such as raw data like a target ECG data stored in a database and or other patient data as described herein. A block identifies target patient data within the broad data from block . For example the block may include instructions to target a specific patient or patient group based on any number of desired patient traits including demographic traits physiological data historical data or otherwise. The block would in some examples include predetermined instructions for identifying a target group while in other examples the block may require input from a physician or other healthcare professional to provide characteristics of target patient data to be examined. A block may perform processing on the targeted ECG data corresponding to the target patient data producing processed ECG data

At a block desired diagnostic features in the processed target ECG data are identified and stored in a diagnostic features data set . The block may execute adapting algorithms to mine the ECG data and other patient data for features corresponding to a potential diagnosis. Features for diagnosing arrhythmias are described hereinabove but the block is not limited to diagnosing arrhythmias. Instead the block may identify any number of features corresponding to any number of diagnosable conditions. Preferably the diagnostic features may be frequency time or phase domain features summed energy values determined over range of frequencies time intervals or phases for these domain features SFDM STDM and or SPDM for example. The identified diagnostic features set may be multi variant meaning that the features may include a plurality of features. For example the block may identify a feature in the target ECG data for certain patients that corresponds to a physiological feature of those same patients like weight heart size blood pressure ECG time series ECG intervals heart rate incidences of extrasystoles AF heart rate variability HRV parameters heart rate turbulence etc. The block may execute an adapting algorithm that recursively mines through the data provided thereto for correlations in the patient patterns as shown as in the patient data that are then stored as the diagnostic features data set.

At a block a diagnostic assessment is made from the diagnostic features data set from block . When mined for assessing arrhythmia the block may identify an arrhythmia classification from the data mining thereby offering the potential to classify arrhythmias based on heretofore un known patterns across patient data ECG data physiological data demographic data etc. . The block also capable of executing an adapting algorithm may thus provide hard to notice hidden correlations of temporal spectral and phase patterns including metrics calculated in those domains between episodes of cardiac electrical activity of various rhythms and properties. Such diagnoses can be stored as a derived data set constructed from targeted ECG data and other patient data. As a data mining system whether adaptive or not the blocks may be executed by the computer system in a recursive manner as indicated by the dashed lines allowing for iterative based identification and diagnoses.

The present techniques may be used in standalone classification devices as described as well as in integrated atrial fibrillation mapping systems. Conventional mapping systems determine dominant frequencies and locations of dominant frequencies for mapping the heart tissue to identify arrhythmia source sites. The dominant frequency data in such systems is used as domain data from which separately frequency selection is performed to identify frequency ranges of interest and then summed energy values are determined. These configurations include catheter based mapping systems as well as 3 dimensional electrode arrays which may be used endocardially or epicardially. The present techniques may also be used with atrial fibrillation treatment assemblies such as ablation devices serving as a real time assessment of treatment effectiveness by measuring electrocardiogram signals and determining summed energy and classifications during or after treatment. The techniques may be used before treatment as well of course.

The techniques may be implemented in devices external to the patient using externally mounted ECG leads. While in other examples the devices may be implantable for example adjacent the heart. The devices may be included in an implantable cardiac defibrillator device for example for detection of AF conditions e.g. ventricular fibrillation and used in the controlled delivery of fibrillation therapy. The devices may be contained within an automated internal or external defibrillator for detection of AF conditions e.g. ventricular fibrillation and to control delivery of fibrillation therapy.

The various blocks operations and techniques described above may be implemented in hardware firmware software or any combination of hardware firmware and or software. When implemented in hardware some or all of the blocks operations techniques etc. may be implemented in for example a custom integrated circuit IC an application specific integrated circuit ASIC a field programmable logic array FPGA a programmable logic array PLA etc.

When implemented in software the software may be stored in any computer readable memory such as on a magnetic disk an optical disk or other storage medium in a RAM or ROM or flash memory of a computer processor hard disk drive optical disk drive tape drive etc. Likewise the software may be delivered to a user or a system via any known or desired delivery method including for example on a computer readable disk or other transportable computer storage mechanism or via communication media. Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic radio frequency infrared and other wireless media. Thus the software may be delivered to a user or a system via a communication channel such as a telephone line a DSL line a cable television line a wireless communication channel the Internet etc. which are viewed as being the same as or interchangeable with providing such software via a transportable storage medium .

Moreover while the present invention has been described with reference to specific examples which are intended to be illustrative only and not to be limiting of the invention it will be apparent to those of ordinary skill in the art that changes additions and or deletions may be made to the disclosed embodiments without departing from the spirit and scope of the invention.

