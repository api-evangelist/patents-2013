---

title: Smoothed activity signals for suggestion ranking
abstract: Relevant geospatial data is provided to a portable device. In particular, several activity detection results collected over a period of time, spanning several time intervals, are received, where each activity detection result provides an estimate of the portable device activity, and where the activity detection results indicate at least two different activities. A single predominant activity of the portable device is determined using the activity detection results. Based on the predominant activity, geospatial data is selected and then provided to the portable device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09532176&OS=09532176&RS=09532176
owner: GOOGLE INC.
number: 09532176
owner_city: Mountain View
owner_country: US
publication_date: 20131126
---
The present disclosure relates to digital maps and more particularly to providing automatic suggestions or categorical search results to a user on a portable device based on an activity of the portable device.

The background description provided herein is for the purpose of generally presenting the context of the disclosure. Work of the presently named inventors to the extent it is described in this background section as well as aspects of the description that may not otherwise qualify as prior art at the time of filing are neither expressly nor impliedly admitted as prior art against the present disclosure.

Today many portable devices support software applications that display interactive digital maps. Some of these software applications are developed primarily for providing interactive digital maps. Other software applications such as web browsers may display interactive digital maps along with other content. In either case these applications generally provide multiple functions for interacting with the digital map such as changing the zoom level repositioning the viewport etc. Moreover these applications often provide additional information related to the map such as a listing of businesses located in the area visible in the viewport.

Furthermore some portable devices are equipped with sensors that can detect various characteristics of the device such as the speed at which the portable device is moving the orientation of the portable device the direction in which the portable device is headed etc. For example a portable device can use sensor data to ascertain with a certain level of confidence whether the user of the portable device is walking at this instant.

To provide better suggestions or search results to the user of a portable device a software system that implements an online mapping service determines the predominant activity of the device during a certain period of time. The determined predominant activity can be driving for example even though the period of time includes intervals during which the device is carried at a walking speed or resting in one place. In an example implementation the software system receives data points collected at the portable device over a period of time where each data point indicates estimated activity of the portable device during a different interval within the period of time. As a more particular example 20 data points can correspond to twenty respective contiguous 15 second intervals that together make up a five minute time period. Each data point also can include a metric of confidence in determining an activity of the device during the corresponding time interval. Thus one data point can indicate that during a certain 15 second interval the device was being carried by a pedestrian with 85 certainty and another data point can indicate that during the next 15 second interval the device was being carried by a driver with 95 certainty. The software system analyzes the received data to determine which activity was the predominant activity during the time period. In various implementations and scenarios the software system uses the determined predominant device activity to provide relevant suggestions or search results to the portable device.

In particular an example embodiment of the techniques of the present disclosure is a method in a computing device for providing relevant geospatial data to a portable device. The method includes receiving by one or more processors a plurality of activity detection results collected over a period of time wherein the period of time spans a plurality of intervals wherein each of the activity detection results provides an estimate of an activity of the portable device during a respective one of the plurality of intervals and wherein at least two of the plurality of activity detection results indicate different activities. The method also includes determining by the one or more processors a single predominant activity of the portable device during the period of time using the plurality of activity detection results causing by the one or more processors geospatial data to be selected in accordance with the predominant activity of the portable device and causing by the one or more processors the geospatial data to be provided to the portable device.

Another example embodiment of the techniques of the present disclosure is a portable device configured to operate in a communication network. The portable device includes one or more sensors configured to determine characteristics of motion and orientation of the portable device one or more processors and a non transitory computer readable medium storing thereon instructions which when executed by the one or more processors cause the portable device to determine at multiple instances within a time period of a certain length current mode of transport of the portable device to generate detection results such that at least two of the detection results indicate different modes of transport. The instructions further cause the portable device to assign respective confidence scores to the detection results determine a single predominant mode of transport based on the detection results and the confidence scores and receive geospatial data selected according to the predominant mode of transport.

Still another example embodiment of the techniques of the present disclosure is a portable device configured to operate in a communication network. The portable device includes one or more sensors configured to determine characteristics of motion and orientation of the portable device one or more processors and a non transitory computer readable medium storing thereon instructions configured to execute on the one or more processors to i obtain using the one or more sensors indications of motion of the portable device a plurality of times within a time period longer than a minute to generate a plurality of motion detection results ii determine respective confidence scores for the plurality of motion detection results iii provide the motion detection results and the confidence scores to a network service via the communication network to determine a predominant type of motion of the portable device during the time period and iv receive via the communication network content selected according to the predominant type of motion of the portable device during the time period.

Yet another example embodiment is a portable device configured to operate in a communication network. The portable device includes a user interface one or more processors and a non transitory computer readable medium storing a instructions. When executed by the one or more processors the instructions cause the portable device to determine a single predominant mode of transport of the portable device during a time period of a certain length where the time period includes a first time when the characteristics of motion and orientation of the portable device are consistent with a first mode of transport and a second time when the characteristics of motion and orientation of the portable device are consistent with a second mode of transport. The instructions also cause the portable device to provide via the user interface geospatial data selected according to the single predominant mode of transport.

In embodiments described below a software application on a portable device provides relevant information to the user based on the activity in which the portable device is predominantly engaged during a period of time also referred to in this disclosure as the predominant activity. As discussed in more detail with reference to a software system implemented in the portable device and or one or more network servers determines the predominant activity of the portable device based on the detected activities of the portable device at several contiguous time intervals that make up a relatively long period of time e.g. one minute five minutes ten minutes .

One example of an activity that can be detected using these techniques is the mode of transport of the portable device. In one implementation the modes of transport include walking driving bicycling riding in a public transit vehicle remaining stationary etc. More generally however the techniques of this disclosure can be applied to any type of an activity. For convenience the examples below illustrate the techniques of this disclosure specifically in application to modes of transport.

Once the software system determines the predominant activity of the portable device one or more network servers referred to collectively as the autosuggest server can automatically generate suggestions in view of the predominant activity. For example when the predominant activity is walking a suggestion can include a point of interest POI accessible primarily to pedestrians such as a food stand in the middle of a park. As another example the response to a geospatial query can be tailored to the predominant activity.

In an example implementation the client device is a portable device that includes a memory one or more processors CPUs a graphics processing unit GPU an I O module and one or several sensors . The memory can be a non transitory memory and can include on or several suitable memory modules such as random access memory RAM read only memory ROM flash memory other types of persistent memory etc. The I O module may be a touch screen for example. More generally the techniques of this disclosure can be implemented in other types of devices such as laptop or desktop computers etc.

Depending on the implementation the one or more sensors can include a global positioning system GPS module to detect the position of the device a compass to determine the direction of the client device a gyroscope to determine the rotation and tilt a thermometer to determine temperature a light sensor a barometer to detect air pressure etc.

The memory stores an operating system OS which can be any type of suitable mobile or general purpose operating system. The OS can include application programming interface API functions that allow applications such as the mapping application to retrieve sensor readings. For example a software application configured to execute on the client device can include instructions that invoke an OS API for retrieving an estimated mode of transport of the client device at that instant. The API can also return a quantitative indication of how certain the API is of the estimate e.g. as a percentage .

The memory also stores the mapping application which is configured to generate interactive digital maps. The mapping application can receive map data in a raster e.g. bitmap or non raster e.g. vector graphics format from the map data server . In some cases the map data can be organized into layers such as a basic layer depicting roads streets natural formations etc. a traffic layer depicting current traffic conditions a weather layer depicting current weather conditions etc. The mapping application also can receive geographic search queries and provide search results on the digital map or in conjunction with the digital map automatically provide suggestions e.g. highlight POIs in which the user may be interested display driving walking or transit directions and in general provide functions related to geography geolocation navigation etc.

It is noted that although illustrates the mapping application as a standalone application the functionality of the mapping application also can be provided in the form of an online service accessible via a web browser executing on the client device as a plug in or extension for another software application executing on the client device etc.

In some implementations the autosuggest server includes one or more processors and a memory . The memory may be tangible non transitory memory and may include any types of suitable memory modules including random access memory RAM read only memory ROM flash memory other types of persistent memory etc. The memory stores instructions executable on the processors that make up an extended activity based suggestion generator which can automatically generate suggestions for the mapping application based on data from the sensors . The memory or the memory in another server similarly can store instructions that implement geospatial search result generator that provides search results according to an extended set of data from which the predominant activity of the client device is derived.

For simplicity illustrates the autosuggest server as only one instance of a server. However the autosuggest server according to some implementations includes a group of one or more autosuggest servers each equipped with one or more processors and capable of operating independently of the other autosuggest servers. Autosuggest servers operating in such a group can process requests from the client device individually e.g. based on availability in a distributed manner where one operation associated with processing a request is performed on one autosuggest server while another operation associated with processing the same request is performed on another autosuggest server or according to any other suitable technique. For the purposes of this discussion the term autosuggest server may refer to an individual autosuggest server or to a group of two or more autosuggest servers.

In operation the mapping application operating in the client device sends data from the sensors to the autosuggest server . Thus in one example the autosuggest server can receive N indications of activity along with the corresponding indications of confidence for N contiguous intervals in a certain period time with some of these indications identifying different activities. Examples of such data are further discussed with reference to . In response the autosuggest server determines the predominant mode of transport of the client device and generates suggestions corresponding to the determined predominant mode of transport. The autosuggest server then sends the suggestions back to the client device .

The autosuggest server can determine the predominant activity of the portable device using several configurable parameters in one implementation. For example one parameter can specify the duration of the period of time for reliably detecting the predominant activity. Another parameter can define the number of time intervals into which the period of time is divided where the client device reports a respective indication of device activity for each interval. Further a set of parameters can define weights that are applied to the individual indications of device activity when determining the predominant activity.

In another implementation an autosuggest module can be implemented in the mapping application to determine the predominant activity of the client device . It is noted that the autosuggest module or a similar module can determine the predominant activity for any suitable purpose including generating automatic suggestions adjusting search results adjusting driving directions etc. In yet another implementation the autosuggest module can co operate with the activity based suggestion generator .

As a more specific example a software module operating in the client device can determine the predominant mode of transport or other activity for a certain period of time and when the mapping application receives geospatial data from the server the mapping application can select a subset of this geospatial data that best corresponds to the determined predominant mode of transport. To this end the software module processes multiple indications of activity and the corresponding indications of confidence. According to one such embodiment the server may provide geospatial data that is not selected in view of the mode of transport of the client device in other words the server may not use the mode of transport of the client device as one of the signals in selecting geospatial data . In another embodiment the server uses the mode of transport as one of the signals but receives different indications of the mode of transport of the client device during the relevant period of time. In either case the server can provide geospatial data for multiple modes of transport and the mapping application can choose what portions of this data to provide to the user depending on the predominant mode of transport determined at the client device .

For further clarity schematically illustrates the technique for determining the predominant activity of a portable device. More specifically illustrates an example application of these techniques to determining the predominant mode of transport for the purpose of automatically generating suggestions.

With reference to the communication system depicted in the extended activity based suggestion generator receives data from the sensors of the client device corresponding to modes of transport at several time intervals over a selected window of time . In one embodiment the extended activity based suggestion generator selects the time at which suggestions are requested as the leading edge for the time window . The extended activity based suggestion generator also selects a period of time to receive data from the sensors . The trailing edge for the time window can be found by subtracting the selected period of time from the time at which suggestions are requested . In one embodiment the parameters of the time window may be stored in a computer readable medium at the autosuggest server or the client device .

The extended activity based suggestion generator then receives data from the sensors within the boundaries of the time window also referred to as activity detection results. In one embodiment the selected period of time is four minutes but it can be longer or shorter in other embodiments. In the illustrated scenario at time t 4.5 minutes the extended activity based suggestion generator receives discrete time samples from the sensors of the client device which detect driving at t 0.5 minutes driving at t 1.5 minutes driving at t 2.5 minutes walking at t 3.5 minutes and standing at t 4.5 minutes. In one implementation the sensor data includes discrete time samples. In other implementations the sensor data can be continuous. The data from the sensors as well as the selected time window is stored in a computer readable medium such as the autosuggest server or the client device .

The extended activity based suggestion generator then analyzes the activity detection results collected in the time window to determine the predominant mode of transport of the client device . The extended activity based suggestion generator then provides an indication of the predominant activity to the contextual suggestion generation module which can be a software component that can be implemented in the same server as the activity based suggestion generator in a different one or more servers or in any other suitable one or several device. In one implementation the extended activity based suggestion generator executes a weight based selection algorithm to analyze the activity detection results.

The extended activity based suggestion generator can analyze the activity detection results using several methods to determine the predominant mode of transport. Each individual method can be combined with other methods in any order to determine the predominant mode of transport. As one example the extended activity based suggestion generator can apply a thresholding function to the time window to eliminate noise in the activity detection results. For example a thresholding function can be applied to eliminate or filter out outliers. If for example the sensors detected walking and driving 20 times and bicycling two times within the time window the thresholding function would eliminate bicycling from consideration as the predominant mode of transport of the client device .

Moreover each mode of transport can be assigned a ranking in order of occurrences within the time window . Certain samples can also be prioritized based on when the corresponding activity occurred. For example the more recent samples may be more relevant to the predominant mode of transport than older samples. Also samples can be weighted according to the current activity. For example driving may be weighted more heavily than walking since it is likely that walking for a few minutes after a long drive is just a short break or stop at a gas station.

The extended activity based suggestion generator can also receive confidence values for each mode of transport at every time interval and determine the predominant activity based on the average confidence scores. For example at each time interval the sensors may not determine with complete certainty the mode of transport of the client device . Instead the sensors may determine at a particular time interval that there is a 60 chance the mode of transport is walking and a 40 chance the mode of transport is bicycling. The extended activity based suggestion generator may receive confidence scores for each mode of transport at each time interval. In this example the extended activity based suggestion generator may receive a score of 6 for walking and a score of 4 for bicycling. The extended activity based suggestion generator can average the confidence scores for each mode of transport over the time window and determine the predominant activity based on the average confidence scores.

Additional sensor information may also be used to determine the predominant activity. For example if driving and walking are both samples within the time window but the GPS of the client device indicates the device is in the middle of a hiking trail or campsite it becomes unlikely the predominant mode of transport is driving. In some embodiments the client device uses the GPS data to determine the predominant activity only if the user selects a certain setting. Some or all of these techniques may be used individually or in combination in any order to analyze activity detection results.

In some implementations once the extended activity based suggestion generator determines the predominant activity of the client device suggestions containing mapping information are generated based on the predominant mode of transport such as suggestions for driving . For example if the predominant mode of transport is driving the extended activity based suggestion generator may suggest nearby gas stations or fast food restaurants right off the highway. The extended activity based suggestion generator may also suggest a POI within driving distance but too far for walking. On the other hand if the predominant mode of transport is walking the extended activity based suggestion generator may suggest POIs within the building the device is currently located if the user chooses a setting allowing the client device to use GPS data. If the predominant mode of transport is biking the extended activity based suggestion generator may suggest POIs located right next to a bike trail which would be too inconvenient for a driver to get to and too far for a walker.

At step sensor data indicative of the device activity during a certain interval is collected. To this end an API provided by the OS of the client device can be used. Then at step the method determines whether the sampling period has expired. The sampling period can be set at for example one minute five minutes ten minutes etc. If the sampling period has not expired the flow reverts back to step to collect more sensor data. On the other hand if the sampling period has expired the activity detection results are reported to the autosuggest server at step . At step suggestions based on predominant activity of the device are received from the autosuggest server .

In this scenario a client device collects and interprets sensor data for a given interval within a certain time period. In other implementations however the client device can provide raw sensor data to a network device e.g. autosuggest server where multiple interval specific samples are analyzed to determine the predominant activity.

The activity detection results can be analyzed using one or several techniques to determine the predominant device activity. For example a thresholding function can be applied to eliminate the outliers the samples can be weighed and the samples can be prioritized . Some or all of these techniques may be used individually or in combination in any order to analyze the activity detection results.

At step the predominant activity is identified based on the analyzed activity detection results for the selected period of time. At step suggestions and or search results that are based at least in part on the predominant device activity can be generated and provided to the client device . In another implementation the predominant device activity can be analyzed and determined at the client device via the autosuggest generator . In yet another implementation the predominant device activity can be analyzed and determined in an exchange between the autosuggest server and the client device .

The following additional considerations apply to the foregoing discussion. Throughout this specification plural instances may implement components operations or structures described as a single instance. Although individual operations of one or more methods are illustrated and described as separate operations one or more of the individual operations may be performed concurrently and nothing requires that the operations be performed in the order illustrated. Structures and functionality presented as separate components in example configurations may be implemented as a combined structure or component. Similarly structures and functionality presented as a single component may be implemented as separate components. These and other variations modifications additions and improvements fall within the scope of the subject matter of the present disclosure.

Additionally certain embodiments are described herein as including logic or a number of components modules or mechanisms. Modules may constitute either software modules e.g. code stored on a machine readable medium or hardware modules. A hardware module is tangible unit capable of performing certain operations and may be configured or arranged in a certain manner. In example embodiments one or more computer systems e.g. a standalone client or server computer system or one or more hardware modules of a computer system e.g. a processor or a group of processors may be configured by software e.g. an application or application portion as a hardware module that operates to perform certain operations as described herein.

In various embodiments a hardware module may be implemented mechanically or electronically. For example a hardware module may comprise dedicated circuitry or logic that is permanently configured e.g. as a special purpose processor such as a field programmable gate array FPGA or an application specific integrated circuit ASIC to perform certain operations. A hardware module may also comprise programmable logic or circuitry e.g. as encompassed within a general purpose processor or other programmable processor that is temporarily configured by software to perform certain operations. It will be appreciated that the decision to implement a hardware module mechanically in dedicated and permanently configured circuitry or in temporarily configured circuitry e.g. configured by software may be driven by cost and time considerations.

Accordingly the term hardware should be understood to encompass a tangible entity be that an entity that is physically constructed permanently configured e.g. hardwired or temporarily configured e.g. programmed to operate in a certain manner or to perform certain operations described herein. Considering embodiments in which hardware modules are temporarily configured e.g. programmed each of the hardware modules need not be configured or instantiated at any one instance in time. For example where the hardware modules comprise a general purpose processor configured using software the general purpose processor may be configured as respective different hardware modules at different times. Software may accordingly configure a processor for example to constitute a particular hardware module at one instance of time and to constitute a different hardware module at a different instance of time.

Hardware and software modules can provide information to and receive information from other hardware and or software modules. Accordingly the described hardware modules may be regarded as being communicatively coupled. Where multiple of such hardware or software modules exist contemporaneously communications may be achieved through signal transmission e.g. over appropriate circuits and buses that connect the hardware or software modules. In embodiments in which multiple hardware modules or software are configured or instantiated at different times communications between such hardware or software modules may be achieved for example through the storage and retrieval of information in memory structures to which the multiple hardware or software modules have access. For example one hardware or software module may perform an operation and store the output of that operation in a memory device to which it is communicatively coupled. A further hardware or software module may then at a later time access the memory device to retrieve and process the stored output. Hardware and software modules may also initiate communications with input or output devices and can operate on a resource e.g. a collection of information .

The various operations of example methods described herein may be performed at least partially by one or more processors that are temporarily configured e.g. by software or permanently configured to perform the relevant operations. Whether temporarily or permanently configured such processors may constitute processor implemented modules that operate to perform one or more operations or functions. The modules referred to herein may in some example embodiments comprise processor implemented modules.

Similarly the methods or routines described herein may be at least partially processor implemented. For example at least some of the operations of a method may be performed by one or processors or processor implemented hardware modules. The performance of certain of the operations may be distributed among the one or more processors not only residing within a single machine but deployed across a number of machines. In some example embodiments the processor or processors may be located in a single location e.g. within a home environment an office environment or as a server farm while in other embodiments the processors may be distributed across a number of locations.

The one or more processors may also operate to support performance of the relevant operations in a cloud computing environment or as an SaaS. For example as indicated above at least some of the operations may be performed by a group of computers as examples of machines including processors these operations being accessible via a network e.g. the Internet and via one or more appropriate interfaces e.g. APIs .

The performance of certain of the operations may be distributed among the one or more processors not only residing within a single machine but deployed across a number of machines. In some example embodiments the one or more processors or processor implemented modules may be located in a single geographic location e.g. within a home environment an office environment or a server farm . In other example embodiments the one or more processors or processor implemented modules may be distributed across a number of geographic locations.

Some portions of this specification are presented in terms of algorithms or symbolic representations of operations on data stored as bits or binary digital signals within a machine memory e.g. a computer memory . These algorithms or symbolic representations are examples of techniques used by those of ordinary skill in the data processing arts to convey the substance of their work to others skilled in the art. As used herein an algorithm or a routine is a self consistent sequence of operations or similar processing leading to a desired result. In this context algorithms routines and operations involve physical manipulation of physical quantities. Typically but not necessarily such quantities may take the form of electrical magnetic or optical signals capable of being stored accessed transferred combined compared or otherwise manipulated by a machine. It is convenient at times principally for reasons of common usage to refer to such signals using words such as data content bits values elements symbols characters terms numbers numerals or the like. These words however are merely convenient labels and are to be associated with appropriate physical quantities.

Unless specifically stated otherwise discussions herein using words such as processing computing calculating determining presenting displaying or the like may refer to actions or processes of a machine e.g. a computer that manipulates or transforms data represented as physical e.g. electronic magnetic or optical quantities within one or more memories e.g. volatile memory non volatile memory or a combination thereof registers or other machine components that receive store transmit or display information.

As used herein any reference to one embodiment or an embodiment means that a particular element feature structure or characteristic described in connection with the embodiment is included in at least one embodiment. The appearances of the phrase in one embodiment in various places in the specification are not necessarily all referring to the same embodiment.

Some embodiments may be described using the expression coupled and connected along with their derivatives. For example some embodiments may be described using the term coupled to indicate that two or more elements are in direct physical or electrical contact. The term coupled however may also mean that two or more elements are not in direct contact with each other but yet still co operate or interact with each other. The embodiments are not limited in this context.

As used herein the terms comprises comprising includes including has having or any other variation thereof are intended to cover a non exclusive inclusion. For example a process method article or apparatus that comprises a list of elements is not necessarily limited to only those elements but may include other elements not expressly listed or inherent to such process method article or apparatus. Further unless expressly stated to the contrary or refers to an inclusive or and not to an exclusive or. For example a condition A or B is satisfied by any one of the following A is true or present and B is false or not present A is false or not present and B is true or present and both A and B are true or present .

In addition use of the a or an are employed to describe elements and components of the embodiments herein. This is done merely for convenience and to give a general sense of the description. This description should be read to include one or at least one and the singular also includes the plural unless it is obvious that it is meant otherwise.

Upon reading this disclosure those of skill in the art will appreciate still additional alternative structural and functional designs for providing data to a client according to a predominant device activity through the disclosed principles herein. Thus while particular embodiments and applications have been illustrated and described it is to be understood that the disclosed embodiments are not limited to the precise construction and components disclosed herein. Various modifications changes and variations which will be apparent to those skilled in the art may be made in the arrangement operation and details of the method and apparatus disclosed herein without departing from the spirit and scope defined in the appended claims.

