---

title: Dynamic mode switching for fast touch response
abstract: A method of operating a touch-sensing surface may include performing a first scan of a first set of electrodes of a touch-sensing surface, determining a presence of at least one conductive object proximate to the touch-sensing surface, in response to determining the presence of the at least one conductive object, performing a second scan of a second set of electrodes of the touch-sensing surface, and repeating the performing the second scan until the at least one conductive object is no longer proximate to the touch-sensing surface.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09007342&OS=09007342&RS=09007342
owner: Cypress Semiconductor Corporation
number: 09007342
owner_city: San Jose
owner_country: US
publication_date: 20130725
---
This application is a continuation of U.S. application Ser. No. 12 844 798 filed Jul. 27 2010 which claims the benefit of U.S. Provisional Application No. 61 229 236 filed on Jul. 28 2009 the entire contents of both are incorporated by reference herein.

This disclosure relates to the field of touchscreen controllers and in particular to decreasing response time by using different sensing modes of a touchscreen controller.

Computing devices such as notebook computers personal data assistants PDAs kiosks and mobile handsets have user interface devices which are also known as human interface devices HID . One user interface device that has become more common is a touch sensor pad also commonly referred to as a touchpad . A basic notebook computer touch sensor pad emulates the function of a personal computer PC mouse. A touch sensor pad is typically embedded into a PC notebook for built in portability. A touch sensor pad replicates mouse X Y movement by using two defined axes which contain a collection of sensor elements that detect the position of one or more conductive objects such as a finger. Mouse right left button clicks can be replicated by two mechanical buttons located in the vicinity of the touchpad or by tapping commands on the touch sensor pad itself. The touch sensor pad provides a user interface device for performing such functions as positioning a pointer or selecting an item on a display. These touch sensor pads may include multi dimensional sensor arrays for detecting movement in multiple axes. The sensor array may include a one dimensional sensor array detecting movement in one axis. The sensor array may also be two dimensional detecting movements in two axes.

Another user interface device that has become more common is a touch screen. Touch screens also known as touchscreens touch windows touch panels or touchscreen panels are transparent display overlays which are typically either pressure sensitive resistive or piezoelectric electrically sensitive capacitive acoustically sensitive surface acoustic wave SAW or photo sensitive infra red . The effect of such overlays allows a display to be used as an input device removing the keyboard and or the mouse as the primary input device for interacting with the display s content. Such displays can be attached to computers or as terminals to networks. Touch screens have become familiar in retail settings on point of sale systems on ATMs on mobile handsets on kiosks on game consoles and on PDAs where a stylus is sometimes used to manipulate the graphical user interface GUI and to enter data. A user can touch a touch screen or a touch sensor pad to manipulate data. For example a user can apply a single touch by using a finger to touch the surface of a touchscreen to select an item from a menu.

The following description sets forth numerous specific details such as examples of specific systems components methods and so forth in order to provide a good understanding of several embodiments of the present invention. It will be apparent to one skilled in the art however that at least some embodiments of the present invention may be practiced without these specific details. In other instances well known components or methods are not described in detail or are presented in a simple block diagram format in order to avoid unnecessarily obscuring the present invention. Thus the specific details set forth are merely exemplary. Particular implementations may vary from these exemplary details and still be contemplated to be within the spirit and scope of the present invention.

Described herein is a method and apparatus for determining a presence and location of one or more conductive objects in contact with or proximate to a touch sensing surface. As described herein a contact may be detected when a conductive object e.g. a finger physically touches the touch sensing surface or may be caused by a conductive object in proximity to the touch sensing surface.

One method for scanning a touch sensing surface such as a touchpad or touchscreen involves scanning or measuring changes in self capacitance associated with each row or column sensor element in the touch sensing surface. Thus performing a scan of the entire touch sensing surface may include taking a number of measurements equal to the sum of the number of row elements plus the number of column elements.

All points sensing of the touch sensing surface in which the locations of multiple contacts at the touch sensing surface are determined may be performed using mutual capacitance measurements. Since mutual capacitance measurements are taken between a pair of sensor elements such as a row sensor element and a column sensor element the number of measurements for scanning the entire touch sensing surface may be equal to the number of row elements multiplied by the number of column elements. As compared to the method for determining a contact location using self capacitance measurements the mutual capacitance method for all points detection uses more measurements and may have slower touch response. Since fewer measurements are performed when using self capacitance to determine a touch presence it may also consume less power than using only mutual capacitance measurements and thus provide benefits in hand held or similar devices operating from battery powered supplies.

One key measure or benchmark for user experience is the first touch response time. The first touch response time is the time between when a user initiates a contact with the touch sensing surface for example by placing a finger or other object on the surface and the time when a resolved location of the contact is reported to the system. For a touch sensing surface using all point scanning the first touch response time can extend to as much as twice the duration of time for performing a full scan of the touch sensing surface. The reason for this extended delay is that a contact occurring just after the full panel scan has started may be missed by the measurements taken during the remaining portion of that first scan period. Such a contact would not be reported following the first scan but would be detected by a second scan of the entire touch sensing surface and reported to the system following the second scan.

One embodiment of a touch sensing system can reduce this first touch response time to the duration of a full scan and processing of the touch sensing surface plus some small additional duration. In one embodiment the touch sensing surface may operate in two different modes a search mode and a tracking mode. When operating in the search mode the presence of at least one contact at the touch sensing surface may be detected. In response to detecting the presence of the at least one contact the mode of operation switches to the tracking mode where the presence and location of the at least one contact as well as the presences and locations of any other contacts at the touch sensing surface may be detected and reported to the system. In one embodiment the system may perform self capacitance measurements while in search mode and mutual capacitance measurements while in tracking mode.

In one embodiment the sensor array includes sensor elements N where N is a positive integer that are disposed as a two dimensional matrix also referred to as an XY matrix . The sensor array is coupled to pins N of the processing device via one or more analog buses transporting multiple signals. In this embodiment each sensor element N is represented as a capacitor. The self capacitance of each sensor in the sensor array is measured by a capacitance sensor in the processing device .

In one embodiment the capacitance sensor may include a relaxation oscillator or other means to convert a capacitance into a measured value. The capacitance sensor may also include a counter or timer to measure the oscillator output. The capacitance sensor may further include software components to convert the count value e.g. capacitance value into a sensor element detection decision also referred to as switch detection decision or relative magnitude. It should be noted that there are various known methods for measuring capacitance such as current versus voltage phase shift measurement resistor capacitor charge timing capacitive bridge divider charge transfer successive approximation sigma delta modulators charge accumulation circuits field effect mutual capacitance frequency shift or other capacitance measurement algorithms. It should be noted however instead of evaluating the raw counts relative to a threshold the capacitance sensor may be evaluating other measurements to determine the user interaction. For example in the capacitance sensor having a sigma delta modulator the capacitance sensor is evaluating the ratio of pulse widths of the output instead of the raw counts being over or under a certain threshold.

In one embodiment the processing device further includes processing logic . Operations of the processing logic may be implemented in firmware alternatively it may be implemented in hardware or software. The processing logic may receive signals from the capacitance sensor and determine the state of the sensor array such as whether an object e.g. a finger is detected on or in proximity to the sensor array e.g. determining the presence of the object where the object is detected on the sensor array e.g. determining the location of the object tracking the motion of the object or other information related to an object detected at the touch sensor.

In another embodiment instead of performing the operations of the processing logic in the processing device the processing device may send the raw data or partially processed data to the host . The host as illustrated in may include decision logic that performs some or all of the operations of the processing logic . Operations of the decision logic may be implemented in firmware hardware software or a combination thereof. The host may include a high level Application Programming Interface API in applications that perform routines on the received data such as compensating for sensitivity differences other compensation algorithms baseline update routines start up and or initialization routines interpolation operations or scaling operations. The operations described with respect to the processing logic may be implemented in the decision logic the applications or in other hardware software and or firmware external to the processing device . In some other embodiments the processing device is the host .

In another embodiment the processing device may also include a non sensing actions block . This block may be used to process and or receive transmit data to and from the host . For example additional components may be implemented to operate with the processing device along with the sensor array e.g. keyboard keypad mouse trackball LEDs displays or other peripheral devices .

The processing device may reside on a common carrier substrate such as for example an integrated circuit IC die substrate or a multi chip module substrate. Alternatively the components of the processing device may be one or more separate integrated circuits and or discrete components. In one embodiment the processing device may be the Programmable System on the Chip PSoC processing device developed by Cypress Semiconductor Corporation San Jose Calif. Alternatively the processing device may be one or more other processing devices known by those of ordinary skill in the art such as a microprocessor or central processing unit a controller special purpose processor digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable device. In an alternative embodiment for example the processing device may be a network processor having multiple processors including a core unit and multiple micro engines. Additionally the processing device may include any combination of general purpose processing device s and special purpose processing device s .

In one embodiment the electronic system is implemented in a device that includes the touch sensing surface as the user interface such as handheld electronics portable telephones cellular telephones notebook computers personal computers personal data assistants PDAs kiosks keyboards televisions remote controls monitors handheld multi media devices handheld video players gaming devices control panels of a household or industrial appliances or other computer peripheral or input devices. Alternatively the electronic system may be used in other types of devices. It should be noted that the components of electronic system may include all the components described above. Alternatively electronic system may include only some of the components described above or include additional components not listed herein.

Capacitance sensor includes multiplexer control demultiplexer multiplexer clock generator signal generator demodulation circuit and analog to digital converter ADC . ADC is further coupled with touch coordinate converter . Touch coordinate converter outputs a signal that may be received by processing logic such as processing logic .

Signal generator is further coupled to multiplexers and . Multiplexer is configured to selectively connect signal generator with. either Vor V while multiplexer is configured to connect signal generator with either ground or V. Demodulator circuit includes current conveyor CCII whose voltage control node Yv is coupled to multiplexer . Multiplexer may be configured to selectively connect CCII with either a reference voltage V 2 or node that can be switched between Vand V. CCII current control node Xis further coupled to multiplexer through RX signal . The output of CCII is further coupled through demodulation switches and to integration capacitors CiNT and Ow . These integration capacitors may be further connected through switches and to either a reference voltage V 2 where they may be preset or to differential inputs of ADC for measurement.

In one embodiment when the capacitance sensor is configured to operate using a self capacitance sensing method then multiplexer connects CCII to node multiplexer connects signal generator to V and multiplexer connects signal generator to V. The signal output from signal generator may thus be created to duplicate that generated by the CCII in demodulator block . Such signal when applied to non measured electrodes in matrix may serve as a shield signal and prevent asymmetric coupling of the measured electrode s relative to the adjacent non measured electrodes.

In this configuration the capacitance sensor can perform a self capacitance measurement on the sensor elements such as electrodes or in the sensor array . Performing a self capacitance measurement of a sensor element may include switching node alternately between Vand Vand applying the signal at node to CCII through multiplexer . This signal alternating between Vand Vis applied to a voltage control node Yv of CCII . In one embodiment the CCII is an amplifier with a feedback loop that drives its output so that the voltage present on its current control node matches that on its voltage control node. The current control node is connected through multiplexers and to a sensor element being sensed.

In one embodiment multiplexers and may be connected by a signal path so that the current control node Xof CCII can be connected to any of the row or column sensor elements of sensor array . Specifically CCII can be connected to measure the self capacitance of any row sensor element through multiplexer or any column sensor element through multiplexer signal path and multiplexer . In another embodiment multiplexers and may also be connected by a signal path so that the shield drive output of signal generator can be connected to any of the row or column sensor elements of sensor array .

With a sensor element connected to the current control node of CCII the CCII drives the sensor element to match the signal at the voltage control node of the CCII . The self capacitance of the sensor element is thus charged and discharged by the CCII which drives the sensor element to match the signal generated at node which switches between Vand V. As a result of the charge and discharge cycle of the self capacitance of the sensor element charge may be presented at one or more outputs of CCII and integrated on integration capacitors and . In one embodiment the capacitors and are alternately connected in a non overlapping manner to the output of CCII such that only one of the capacitors or is connected to CCI at any given time. In one embodiment the capacitor is connected to CCI during a negative portion of the cycle when node is connected to V and capacitor is connected to CCI during a positive portion of the cycle when node is connected to V . The charge integration thus causes differing voltages at capacitors and . Following the integration of charge from one or more cycles switches and may be changed to connect the integration capacitors to the differential inputs of ADC . When so closed the voltage present on capacitors and may be presented to ADC through switches and respectively and the voltage difference may be measured at a pair of differential inputs of ADC . Following a measurement switches and may connect the integration capacitors and to a reference voltage for example V 2 to initialize them prior to the next integration operation. In an alternate embodiment the initialize voltage may be other than V 2. In an alternate embodiment the initialization voltage may be different for each of the integration capacitors and .

When a conductive object is in proximity to the sensor element for which self capacitance is being measured the rate of charge integration at capacitors and changes because the self capacitance of the sensor element changes. With the duration over which the integration takes place held constant a potential difference between the capacitors and can be measured by ADC and correlated to the location of the sensor element to determine the approximate location of the conductive object. According to this technique the potential difference measured by ADC changes depending on whether or not a conductive object is near the sensor element being sensed.

In one embodiment noise coupling into the sensor element being measured as well as asymmetries in measured signal due to adjacent non measured sensors may be reduced by using signal generator . When configured to perform self capacitance measurements the multiplexer connects signal generator to Vwhile multiplexer connects signal generator to V. Signal generator switches between Vand Vin parallel with the switching of node between Vand V. Thus the signal is replicated and is applied to the sensor elements in sensor array that are not being sensed by CCII . The signal from signal generator may be applied to the sensor elements through demultiplexer and or signal path and multiplexer .

When capacitance sensor is configured to perform mutual capacitance measurements of the sensor elements in sensor array the multiplexer connects the voltage control node of CCII to a reference voltage with a value of V 2. Multiplexers and may connect signal generator to a voltage Vand ground respectively. For a mutual capacitance measurement the signal generator applies a TX signal to one or more of the sensor elements and the demodulator measures an RX signal resulting from capacitive coupling between the sensor element to which the TX signal is applied and the sensor element at which the RX signal is measured as selected by multiplexer .

The transmit and receive electrodes in the electrode matrix may be arranged so that each of the transmit electrodes overlap and cross each of the receive electrodes such as to form an intersection while maintaining galvanic isolation from each other. Thus each transmit electrode may be capacitively coupled with each of the receive electrodes. For example transmit electrode is capacitively coupled with receive electrode at the point where transmit electrode and receive electrode intersect.

Clock generator supplies a clock signal to signal generator which produces a TX signal to be supplied to the one or more enabled transmit electrodes of touch sensor . In one embodiment the signal generator includes a set of switches that operate according to the clock signal from clock generator . The switches may generate a TX signal by periodically connecting the output of signal generator to Vand ground through multiplexers and respectively. In alternative embodiments rx and ground may be replaced by other voltage values.

The output of signal generator is connected with demultiplexer which allows the TX signal to be applied to any of the M transmit electrodes of touch sensor . In one embodiment multiplexer control controls demultiplexer so that the TX signal is applied to each transmit electrode in a controlled sequence. Demultiplexer may also be used to ground float or connect an alternate signal to the other transmit electrodes to which the TX signal is not currently being applied.

Because of the capacitive coupling between the transmit and receive electrodes the TX signal applied to each transmit electrode induces a current within each of the receive electrodes. For instance when the TX signal is applied to transmit electrode through demultiplexer the TX signal induces an RX signal on the receive electrodes in matrix . The RX signal on each of the receive electrodes can then be measured in sequence by using multiplexer to connect each of the N receive electrodes to demodulation circuit in sequence.

The capacitance associated with each intersection between a TX electrode and an RX electrode can be sensed by selecting every available combination of TX electrode and an RX electrode using demultiplexer and multiplexer . To improve performance multiplexer may also be segmented to allow more than one of the receive electrodes in matrix to be routed to additional demodulation circuits . In an optimized configuration wherein there is a 1 to 1 correspondence of instances of demodulation circuit with receive electrodes multiplexer may not be present in the system.

When an object such as a finger approaches the electrode matrix the object causes a decrease in the mutual capacitance between only some of the electrodes. For example if a finger is placed near the intersection of transmit electrode and receive electrode the presence of the finger will decrease the mutual capacitance between the two electrodes and . Thus the location of the finger on the touchpad may be determined by identifying the one or more receive electrodes having a decreased mutual capacitance in addition to identifying the transmit electrode to which the TX signal was applied at the time the decreased mutual capacitance was measured on the one or more receive electrodes.

By determining the mutual capacitances associated with each intersection of electrodes in the matrix the locations of one or more contacts may be determined. The determination may be sequential in parallel or may occur more frequently at commonly used electrodes.

In alternative embodiments other methods for detecting the presence of a finger or conductive object may be used where the finger or conductive object causes an increase in capacitance at one or more electrodes which may be arranged in a grid or other pattern. For example a finger placed near an electrode of a capacitive sensor may introduce an additional capacitance to ground that increases the total capacitance between the electrode and ground. The location of the finger can be determined from the locations of one or more electrodes at which an increased capacitance is detected.

With regard to capacitance sensor measuring the mutual capacitance at an intersection includes converting the induced current waveform to a potential difference using demodulation circuit . When configured to perform mutual capacitance measurements the voltage control node of CCII may be connected through multiplexer to reference voltage V 2. In one embodiment the CCI is an amplifier with a feedback loop that drives its output so that the voltage present on its current control node matches that on its voltage control node. CCII thus outputs a current to maintain its current control node near V 2. Thus based on the TX signal current alternately flows into and out of the current control node of CCII . The output of CCII is connected to integration capacitors and through switches and respectively. In one embodiment switches and operate in non overlapping fashion so that capacitor is connected when the output of signal generator is at ground and capacitor is connected when the output of signal generator is at V. The charge integration thus results in different voltages at capacitors and and the voltage difference between capacitors and may be measured at the differential inputs of ADC and converted to a digital code.

The digital code may be converted to touch coordinates indicating a position of an input on touch sensor array by touch coordinate converter .

In one embodiment the controller is capable of measuring both self capacitances of sensor elements between the sensor element and a reference node such as ground and mutual capacitances between sensor elements. Thus the controller may be used in a self capacitance mode to determine a presence but not necessarily a location of a contact or a conductive object in proximity to the touch sensing surface having a sensor array . The controller may further be configured to in response to detecting a presence of a contact using a self capacitance sense method in a search mode switch to a mutual capacitance sense method to perform a scan in tracking mode of all or a portion of the intersections of sensor elements in the sensor array to resolve the actual location of one or more contacts.

The sensor array illustrated in has 10 row sensor elements and 8 column sensor elements . In mutual capacitance mode the controller may scan each intersection of a row sensor element and a column sensor element. The controller thus performs 80 sense operations 10 row elements 8 column elements to scan the entire panel. Assuming that each sense operation takes 200 1 1S a scan of the entire sensor array in mutual capacitance mode would take at least 16 ms.

In one embodiment the controller initially operates in self capacitance mode. Scanning of the entire sensor array in a self capacitance mode can be accomplished with 18 sense operations 10 rows 8 columns . Assuming a similar time 200 As per sense operation a scan of the entire sensor array would take 3.6 ms. This time can be further reduced if the purpose of the scan is to determine the presence of a contact without regard to the location of the contact. To determine the presence of a touch without regard to location a set of sensor elements may be scanned such as a subset including only the row elements or only the column elements. Alternatively the scanned subset may include only alternate row or column elements or may include only enough sensor elements such that a contact may be detected reliably. The scan of this set of sensor elements may be performed using a single sense channel. In one embodiment a sense channel includes hardware capable of performing a single capacitance measurement at a given time. Assuming a similar time per sense operation of 200 s the duration of such a scan could be reduced to as little as 1.6 ms when the sensors of only the vertical axis are measured individually.

In one embodiment the controller in self capacitance mode determines that a contact is present at the touch sensing surface if the measured self capacitance of any of the scanned sensor elements exceeds a threshold.

In one embodiment the self capacitance scan time can be decreased even more through the use of parallel sensing. For example a controller may include eight capacitive sensing channels operating in parallel such as those found in the CY8CTMA300E manufactured by Cypress Semiconductor Corporation of San Jose Calif. With parallel sensing capacitance sensing of the entire panel may be accomplished using 10 sense operations since the column elements may be sensed simultaneously. This reduces the scanning overhead time and allows more time for computation intensive functions such as touch location resolution and finger tracking and for sleep operations to conserve power.

In a search mode the controller scans the sensor array by performing self capacitance measurements on sensor elements of the sensor array . In one embodiment the controller scans a set of sensor elements such as all of the sensor elements or a subset of all the sensor elements in the sensor array . For example the controller operating in self capacitance mode may scan the row sensor elements without scanning the column sensor elements . Alternatively the controller may scan the column sensor elements without scanning the row sensor elements . Still alternatively the controller may alternately scan the column sensor elements and the row sensor elements .

In one embodiment the self capacitance scan may be run repeatedly in a loop much faster than scanning the entire panel. Assuming similar measurement times for a single self capacitance measurement as for a mutual capacitance measurement and that the computation time for the threshold analysis is simpler than the calculation of contact locations the maximum first touch delay may be significantly reduced. In one embodiment the maximum first touch response delay is changed from approximately twice the duration of a full mutual capacitance scan to the duration of a full scan plus the duration of one self capacitance measurement. In one embodiment when a contact is detected at the touch sensing surface the controller switches to operation in tracking mode scanning the sensor elements of sensor array using the mutual capacitance method to resolve the locations of the contacts.

In one embodiment one or more contacts at the touch sensing surface may be located during a tracking mode resolve scan using a combination of data provided by a preceding self capacitance scan. For example determining the locations of the one or more contacts while in tracking mode may include using information from a search scan performed using a self capacitance sense method to identify possible contact locations then performing a resolve scan while in tracking mode to identify which of the possible contact locations may be actual contact locations. In one embodiment the resolve scan includes a mutual capacitance scan of each of the possible contact locations.

With regard to a complete scan of the sensor array using a self capacitance method would include N M self capacitance measurements for a matrix of N rows M columns of sensor elements. For the case where C contacts are being applied to the touch sensing surface a maximum of Cpossible contact locations may be detected using a self capacitance scan. The possible contact locations can be resolved to the C actual contact locations using a resolve scan. In one embodiment the resolve scan includes a mutual capacitance measurement of each pair of sensor elements having intersections at all of the possible contact locations .

In one embodiment performing the tracking mode scans according to this method can significantly reduce the mutual capacitance scan times. For example for a sensor array having 100 row sensor elements and 100 column sensor elements five simultaneous contacts can be resolved using a maximum of 225 capacitance measurements rather than the 10 000 capacitance measurements that may be used if every row and column intersection is measured using a mutual capacitance method.

Sensor array illustrated in includes horizontal sensing elements and vertical sensing elements . In one embodiment the touch sensing system performs an initial search scan of the sensor array in self capacitance mode by taking measurements of each sensing element in a sequence. For example the search scan may measure the capacitance at each of the sensing elements in a sequence and then measure the capacitance at each of the sensing elements in a sequence. Alternatively using additional sense channels the search scan may measure two or more of the sensing elements in parallel. In one embodiment the result of such a scan may be a histogram for the horizontal X axis and a similar histogram for the vertical Y axis.

The X axis histogram represents the capacitances measured at the vertical sensor elements . Since contacts at the touch sensing surface affect these measured capacitances the locations of such contacts along the X axis may be represented as peaks in the X axis histogram. For example if two contacts and are applied to the touch sensing surface the locations along the X axis of contact and contact are represented as peaks and respectively in histogram . Similarly the Y axis histogram represents the capacitances measured at the horizontal sensor elements . Thus the locations of contacts and along the Y axis are represented as peaks and respectively in the Y axis histogram .

In one embodiment when only a single contact is applied to the touch sensing surface the system may determine the location of the single contact based on the X and Y search scan histograms since the peak of each histogram indicates the row and column locations of the finger contact. However when multiple contacts are present the histograms may indicate a number of possible contact locations. For example when the actual contacts and are applied to the touch sensing surface the resulting peaks and indicate additional possible touch locations and .

For example whether the two contacts are at locations and or whether the two contacts are at locations and identical histograms may result. When additional actual contacts are added the number of possible contact locations also increases. For N actual contacts the resulting histograms may indicate up to Npossible contact locations.

In order to determine that the contacts and are the actual contact locations from among the possible contact locations and the system may change to mutual capacitance sensing and perform an additional resolve scan. In one embodiment the system may perform a resolve scan of the intersections of horizontal and vertical sensor elements corresponding to one or more of the peaks such as peaks or detected during the initial scan.

In one embodiment of an electronic system that performs a resolve scan for detecting multiple touches the system begins by performing a search mode scan of all row and column sensing elements sequentially or in parallel using a self capacitance measurement technique. The system then performs a resolve scan measuring mutual capacitances when possible contact locations are detected. In one embodiment if multiple peaks such as peaks and are detected in the X axis histogram and multiple peaks such as peaks and are detected in the Y axis histogram the system performs the resolve scan.

In one embodiment performing the resolve scan may include performing a mutual capacitance measurement of all intersections of X and Y sensor elements where a possible touch may exist as indicated by the histogram peaks acquired from a search scan. Note that it is necessary to scan all such possible locations because the histograms and could be generated by touch location combinations of a and b and c and d and e and f and and and .

The system thus conducts a first mutual capacitance measurement of the intersection between sensor elements and a second mutual capacitance measurement of the intersection between sensor elements and a third mutual scan measurement of the intersection between sensor elements and and a fourth mutual scan measurement of the intersection between sensor elements and . In one embodiment an ADC value measured from the first mutual capacitance measurement of an identified intersection e.g. and when compared to a baseline value for that same intersection will be lower than a baseline value for that intersection. Relative to the exemplary touch locations and as indicated in because the contacts are applied near the intersection of sensor elements and and near the intersection of elements and the mutual capacitances between these sensor elements and and and are reduced while the corresponding mutual capacitances between the sensor elements and and and are not reduced. The system can then deduce that the actual contacts are located at locations and rather than at and .

In one embodiment the ADC values measured from each of the resolve scans may be compared to each other to determine the location of the actual contact. Alternatively the resolve scan ADC values may be compared with the ADC values measured from a baseline measurement of an intersection taken when no contact is present at the intersection. The system can then determine the actual contact locations based on this comparison.

In one embodiment the sensor array may be a capacitive sensor having enhanced sensitivity to changes in mutual capacitance between sensor elements rather than to changes in self capacitance of each sensor element.

One embodiment of an electronic system such as system may include a touch sensor array having N rows and M columns. Such an electronic system may include processing logic such as processing logic that is configured to detect multiple contacts at a touch sensing surface.

For example a user may place two fingers of the same hand to the touch sensing surface and the system may detect the locations of the two fingers. With reference to the fingers may contact the sensing surface at locations and resulting in peaks and in the X axis histogram and peaks and in the Y axis histogram .

In one embodiment prior to performing the resolve scan the system may assess the data from the histograms to eliminate special cases where the resolve scan may not be needed. For example if two contacts exist that are aligned in the X or Y directions the resolve scan may not be performed. In this case the two contacts result in only two possible contact locations because one of the histograms detects only one peak for both contacts. In response to detecting this case the system may determine both of the possible contact locations to be actual contact locations.

Thus a controller can determine the possible locations of one or more contacts at the touch sensing surface when operating in the tracking mode. When a tracking mode scan subsequently determines that contacts are no longer present at the touch sensing surface the controller may be reconfigured to revert to a search mode where it may look for the presence of contacts using a self capacitance mode.

In one embodiment the delay between detecting that no contacts are present at the touch sensing surface and switching to self capacitance search mode may be configurable. In one embodiment the switch from mutual capacitance tracking mode to self capacitance search mode occurs immediately following a complete tracking mode scan of the sensor array during which no contacts are detected.

In one embodiment the axis with fewer sensor elements is scanned during a search scan using the self capacitance method to reduce the time for completing the scan. For example controller may scan the eight column sensor elements rather than the ten row sensor elements . In one embodiment where the controller includes multiple parallel sense channels the self capacitance measurements for each of the sensor elements being scanned may be taken simultaneously.

In one embodiment when performing self capacitance measurements for detection of presence of contact sensor elements in the sensor array may be grouped together to reduce power consumption. For example in sensor array the column sensor elements may be connected together and sensed using a single sense channel. By connecting a group of sensor elements together such as column elements power consumption during a search scan may be reduced to that of a single sense channel. This method may be used to reduce overall power consumption when determining the presence of a contact at the touch sensing surface in the search mode.

In an alternative embodiment when sensing the column elements for self capacitance the row elements may be driven with a common shield drive signal. In this case the signal to noise ratio may be improved because the charge may not be coupled through all the intersections in each column to rows that each column intersects. Thus the change in coupled charge attributable to a contact at the touch sensing surface may be increased.

In one embodiment the sensor elements and of the sensor array may be divided into a number of zones. For example the sensor array may be divided into two zones each including a subset of five row sensor elements. The presence of a contact at the touch sensing surface can then be determined by a pair of sense operations with one sense operation for each zone. In this case if a contact is detected at either of the two zones during a search scan the controller can be reconfigured to tracking mode to scan either the entire sensor array to determine the locations of any contacts at the touch sensing surface or just that zone wherein a one or more contacts was detected.

In one embodiment the zones may be interleaved so that the sensor elements of one zone are interleaved with the sensor elements of another zone. For example a first zone may include the odd numbered rows and of sensor array while a second zone may include the even numbered rows and . In one embodiment where the rows are spaced sufficiently close together a high probability exists that a finger or other object contacting the touch sensing surface can be detected by a search scan of at least one of the zones.

In one embodiment the search scan may be performed repeatedly on a single zone or alternatively may alternate between two or more zones. In one embodiment the sensor array matrix may be reversed. For example row elements that were previously driven with a shield signal can be configured to measure for self capacitance while the column elements previously configured to measure self capacitance are driven with a shield signal.

In one embodiment the controller performs a search scan to identify an initial location of the contact identifies a subset of active sensor elements based on the initial location of the contact then enters a tracking mode where the controller scans the subset of active sensor elements using a mutual capacitance measurement method to track the movement of contact . As illustrated in the controller may measure intersections associated with a subset of active sensor elements including row sensor elements and and column sensor elements and .

For example a controller may detect the presence of the contact using a self capacitance measurement method while in a search mode as previously described. In response to determining the presence of the contact the controller may transition to a tracking mode. The controller may then identify a subset of sensor intersections wherein mutual capacitance should be measured based on the initial location of the contact . In one embodiment the initial row or column location of the contact may be determined from a self capacitance scan performed while in search mode.

In one embodiment the controller may identify an active subset of sensor elements where each of the sensor elements in the subset is adjacent to a sensor element over which the initial location of contact lies. For example each of the sensor elements and in the subset of sensor elements illustrated in lies under contact or is adjacent to a sensor element lying under contact . In an alternative embodiment the active subset of sensor elements may be chosen such that each sensor element in the active subset intersects another sensor element within a threshold radius of a centroid location calculated for the initial location of contact . In one embodiment the active subset is determined according to some other criteria indicating that certain sensor elements are likely to be affected by future movement of the contact . In one embodiment the controller reduces the scan time for determining locations of contacts at the touch sensing surface by performing mutual capacitance measurements of intersections between the active sensor elements in the active subset while refraining from measuring intersections between inactive sensor elements. For example a tracking scan may be performed using a mutual capacitance method that measures each of the intersections between row and column sensor elements in the active subset.

In an embodiment that does not refrain from scanning inactive sensor elements measurements are taken at all intersections of sensor elements in sensor array and used as a basis for calculating a centroid location of the contact . For example sensor array includes 18 sensor elements ten row sensor elements and eight column sensor elements . Thus a mutual capacitance scan of every intersection of sensor elements in the sensor array would include 8 10 or 80 mutual capacitance measurements.

However assuming that the controller performs mutual capacitance measurements at the intersections of six of the sensors to track the contact the speed of the resolve scan can be increased by avoiding the measurement of intersections of the twelve inactive sensor elements. This can also reduce power consumption by the scanning operation. Assuming that six of the sensor elements and of sensor array are in the active subset the mutual capacitance scan includes 9 intersections. This takes significantly less time than the full scan of all 80 intersections of the sensor elements.

The contact detection and location process begins at block . At block the controller performs a search scan of a first set of sensor elements of a touch sensing surface to determine a presence of at least one contact that the touch sensing surface. In one embodiment the scan of block is performed while the controller is operating in a search mode. For example the controller may perform a search scan of sensor array as illustrated in . The search scan may include self capacitance measurements of a set of sensor elements which may include all or a subset of the sensor elements of sensor array . In one embodiment each of the sensor elements in a scanned subset may be a row sensor element . Alternatively each of the sensor elements in the scanned subset may be a column sensor element . From block the process continues at block .

At block the controller determines whether a contact at the touch sensing surface was detected by the scan performed at block . If no contact was detected by the scan of block the process continues back to block where the search scan is repeated. Thus blocks and may be repeated while the controller is operating in search mode until a contact is detected. If at least one contact is detected by the scan of block the process continues at block .

At block the controller performs a tracking scan of a second set of sensor elements of the touch sensing surface. In one embodiment the controller performs the tracking scan while operating in a tracking mode. In one embodiment the tracking scan may include a mutual capacitance scan for each intersection of a row element and a column element of sensor array . In an alternative embodiment the tracking scan includes identifying and scanning a subset of active sensor elements based on a last known location of the contact. For example a subset of six active sensor elements and may be included in an active subset for a contact at location . In one embodiment the tracking scan may include a mutual capacitance resolve scan of all intersections of the sensor elements in the active subset to identify the actual contact locations from among a set of possible contact locations determined from the search scan. From block the process continues at block .

At block the controller determines whether the contact is no longer present from the touch sensing surface. If the contact is still present at the touch sensing surface and has not been lost the process continues back to block where the tracking scan is repeated. Thus the tracking scan may be repeated to continuously track the location of the one or more contacts until the contact is lost. If at block the contact is lost the process continues back to block where the controller transitions back to search mode.

The contact detection and location process begins at block . At block the controller performs a search scan of a zone of a touch sensing surface to determine a presence of at least one contact that the touch sensing surface. In one embodiment the scan of block is performed while the controller is operating in a search mode. From block the process continues at block .

At block the controller determines whether a contact at the touch sensing surface was detected by the scan performed at block . If no contact was detected by the scan of block the process continues back to block where the search scan is repeated on the next zone. Thus blocks and may be repeated to scan each zone in sequence while the controller is operating in search mode until a contact is detected. For example if the sensor array is divided into two zones the controller may alternately scan the first zone and the second zone. In one embodiment the each zone includes sensor elements that are contiguous. Alternatively each zone may include sensor elements that are interleaved with sensor elements of one or more other zones. If at least one contact is detected by the scan of block the process continues at block .

At block the controller performs a tracking scan of a second subset of sensor elements of the touch sensing surface. In one embodiment the controller performs the tracking scan while operating in a tracking mode. In one embodiment the tracking scan according to block may be similar to the tracking scan according to block . From block the process continues at block .

At block the controller determines whether a contact is present on the touch sensing surface. If a contact is still present at the touch sensing surface and has not been lost the process continues back to block where the tracking scan is repeated. Thus the tracking scan may be repeated to continuously track the location of the one or more contacts until contact is lost. If at block contact is lost the process continues back to block where the controller transitions back to search mode.

Contact detection and location process begins at block where the controller operates in search mode performing a search scan of alternate rows to determine a presence of at least one contact at the touch sensing surface. In an alternative embodiment the search scan is performed by scanning all the rows all the columns alternating columns or another subset of the sensor elements in the sensor array . In one embodiment the controller scans a minimum number of sensor elements for a contact to be reliably detected. From block the process continues at block .

At block the controller determines whether at least one contact is detected at the touch sensing surface. If at block at least one contact is not present at the touch sensing surface the process continues back to block where the search scan is repeated. In one embodiment if block is entered from block the operation in block may also be modified to sense elements other than those measured in the previous pass through block . Thus the search scan may be repeated until a contact is detected. If at block the contact is detected at the touch sensing surface the process continues at block

At block the controller performs a scan of alternate columns to identify an active column element. In an alternative embodiment the scan is performed by scanning a different subset of sensor elements such as all the rows alternating rows or all the columns. In one embodiment the sensor elements scanned at block may be orthogonal or complementary to the subset of sensor elements scanned at block . For example if column elements are scanned at block then row elements may be scanned at block . From block the process continues at block .

At block the controller identifies an active subset of row sensor elements based on the row at which the contact was last detected. For example the row at which the contact was last detected may have been scanned in accordance with block or . Based on the last known row location of the contact the controller may determine a subset of active sensor elements. In one embodiment sensor elements adjacent to the row at which the contact was last detected are selected as active sensor elements. Alternatively the active sensor elements may be sensor elements that intersect other sensor elements within a threshold distance from the last known contact location. In yet another embodiment the active sensor elements are the sensor elements most likely to be affected by future movement of the contact. From block the process continues at block .

At block the controller identifies an active subset of column sensor elements based on the column at which the contact was last detected. In one embodiment sensor elements adjacent to the column at which the contact was last detected are selected as active sensor elements. Alternatively the active sensor elements may be sensor elements that intersect other sensor elements within a threshold distance from the last known contact location. In yet another embodiment the active sensor elements are the sensor elements most likely to be affected by future movement of the contact. From block the process continues at block .

At block the controller scans the subset of active sensor elements to determine an updated location of the contact. In one embodiment the scan is a mutual capacitance scan of each intersection between sensor elements in the active subset of sensor elements. From block the process continues at block .

At block the controller determines whether a contact is still present at the touch sensing surface. If a contact is still present at the touch sensing surface the process continues back to block such that the controller remains in tracking mode. If at block contact is lost the process continues back to block such that the controller transitions back to search mode.

For a system capable of detecting locating and tracking multiple contacts each of a number of contacts at the touch sensing surface may be associated with an active subset of row and column elements which may be scanned to track the location of the contact.

Embodiments of the present invention described herein include various operations. These operations may be performed by hardware components software firmware or a combination thereof. As used herein the term coupled to may mean coupled directly or indirectly through one or more intervening components. Any of the signals provided over various buses described herein may be time multiplexed with other signals and provided over one or more common buses. Additionally the interconnection between circuit components or blocks may be shown as buses or as single signal lines. Each of the buses may alternatively be one or more single signal lines and each of the single signal lines may alternatively be buses.

Certain embodiments may be implemented as a computer program product that may include instructions stored on a computer readable medium. These instructions may be used to program a general purpose or special purpose processor to perform the described operations. A computer readable medium includes any mechanism for storing or transmitting information in a form e.g. software processing application readable by a machine e.g. a computer . The computer readable storage medium may include but is not limited to magnetic storage medium e.g. floppy diskette optical storage medium e.g. CD ROM magneto optical storage medium read only memory ROM random access memory RAM erasable programmable memory e.g. EPROM and EEPROM flash memory or another type of medium suitable for storing electronic instructions.

Additionally some embodiments may be practiced in distributed computing environments where the computer readable medium is stored on and or executed by more than one computer system. In addition the information transferred between computer systems may either be pulled or pushed across the transmission medium connecting the computer systems.

Although the operations of the method s herein are shown and described in a particular order the order of the operations of each method may be altered so that certain operations may be performed in an inverse order or so that certain operation may be performed at least in part concurrently with other operations. In another embodiment instructions or sub operations of distinct operations may be in an intermittent and or alternating manner.

In the foregoing specification the invention has been described with reference to specific exemplary embodiments thereof. It will however be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention as set forth in the appended claims. The specification and drawings are accordingly to be regarded in an illustrative sense rather than a restrictive sense.

