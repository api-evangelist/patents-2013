---

title: Personalizing a web page outside of a social networking system with content from the social networking system
abstract: A user device requests a web page from a web server of a third-party website, which is separate from a social networking system. The web server from the third-party website sends a markup language document for the requested web page to the user device which includes an instruction for a browser application running on the user device to incorporate information obtained from the social networking system within the web page. Based on the instruction in the received markup language document, the user device requests personalized content from the social networking system, which generates the requested personalized content based on social information about the user. The user device then renders the web page with the personalized content contained in a frame and displays the rendered web page and the frame to the user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09065798&OS=09065798&RS=09065798
owner: Facebook, Inc.
number: 09065798
owner_city: Menlo Park
owner_country: US
publication_date: 20130912
---
This application is a divisional application of U.S. application Ser. No. 13 549 485 filed on Jul. 15 2012 which is a continuation of U.S. application Ser. No. 12 764 928 filed on Apr. 21 2010 both of which are hereby incorporated by reference in their entirety.

This invention relates generally to social networking and more particularly to extending social content outside of a social networking system by personalizing a third party website with content from the social networking system.

In a typical social networking system such as a social networking website users set up their user profiles and then establish connections with other users of the social networking system. The users often provide information about themselves expressly to the social networking system such as demographic information and or a list of the users interests. Users may also provide information about themselves implicitly to the social networking system through their actions on the system and interactions with other users. In this way a social networking system can obtain a rich set of social information about its users which may be used in a great many ways to enhance a user s experience online.

However most websites that a user visits online do not have access to this rich set of social information and in fact most do not even know the identity of their users. Assembling enough information about a user s social connections for these purposes typically requires a system to interact with a large number of users over an extended period of time and most websites do not have the resources expertise or user base required to build and maintain this social information. Accordingly these systems will offer an inferior experience since any customization or personalization provided by these sites is unlikely to reflect information about the user s social connections and their actions.

For example a news website may provide a number of web pages that each contain a story about a particular event. Users of a social networking system may comment about the story even specifically referring to that web page offered by the news website. However without having access to this social information about the users the news website cannot leverage on these useful interactions to enhance the experience of other users who visit the news website. Accordingly it would be beneficial to offer a mechanism to third party websites which are in a domain that is different from a domain of a social networking system to provide personalized content for their users based on social information about those users that is maintained by or otherwise accessible to the social networking system.

To allow third party websites to leverage social information maintained in a social networking system embodiments of the invention enable a third party website to incorporate personalized content for a user in a web page provided by the third party website. The personalized content is provided by the social networking system which maintains social information about the user. The personalized content may be presented in a frame or window of a web page when it is rendered and displayed on a user device.

In one embodiment a user device requests a web page from a web server of a third party website which is separate from a web server of a social networking system. The web server from the third party website sends a markup language document for the requested web page to the user device. The markup language document includes an instruction for a browser application running on the user device to incorporate within the web page information obtained from the social networking system. In one embodiment the instruction creates a frame within the web page that contains content pulled directly from the social networking system e.g. an iframe . Based on the instruction in the received markup language document the user device requests personalized content from the social networking system which determines the requested personalized content based on social information about the user. Thereafter the user device renders the web page with the personalized content contained within the frame and displays the rendered web page to the user. In this way the third party website has a simple mechanism for incorporating personalized content for the user based on social information without requiring the third party website itself to maintain or even have access to the user s social information.

Embodiments of the invention enable various types of personalized content to be provided on the third party website. In one example the personalized content may comprise a recent activity window which contains a selection of actions performed by the user s connections and related to a particular web page or collection of web pages. The actions may include various actions tracked or otherwise collected by the social networking system that a user may perform in relation to a particular web page such becoming a fan of or liking or otherwise expressing interest in the web page posting a link to the web page or posting a comment that includes a URL associated with the web page. For example a high level web page of a news website may contain a window that lists a user s friends posts about stories on the website where each story is associated with a web page. In another example a retail website may provide web pages associated with various products where each product web page includes a frame that contains reviews of or links thereto recommendations for or expressions of interest in the associated product by the user s friends by all users of the social networking system or by users of the social networking system filtered in some other manner e.g. by location age group etc. .

In another example the personalized content may comprise a recommendations window which comprises a set of recommended web pages for a user based on social information about the user. The web pages may be associated with a particular domain such that the window provides the user with a short listing of web pages within a particular website that the user is likely to find interesting. In one embodiment the recommended web pages are selected based on the number of times that the user s friends or connections in the social networking system have interacted with the web pages. For example a landing page of a news website may recommend web pages within the website that contain stories that the user s friends have commented on or shared frequently within the social networking system.

The personalized content provided by the social networking system may be filtered and or ranked based on a number of criteria including without limitation the user s interests demographic information the affinity for other objects in the social networking system location information geo location information keywords or tags either dictated by the third party website and or by the user and a decay factor. The criteria may be dictated by the third party website for example by passing the criteria as a parameter in a URL for drawing the frame as specified in the markup language document. For example a news website may not care about the user s location whereas a restaurant review website would care. In such a case the third party website may pass a parameter that comprises a flag indicating to the social networking system whether the personalized content should be filtered to exclude content that does not match the user s location. It is noted that the third party website need not know the user s location as the filtering may be done entirely by the social networking system. In another embodiment the filtering and or ranking need not be specified by the third party website and can instead be perform by the social networking system. For example the social networking system may personalize content for a user by applying an affinity function for the user to each content item thereby providing the user with the content that is most likely to be relevant to the user. A great number of variations and applications are possible as will be appreciated.

The figures depict various embodiments of the present invention for purposes of illustration only. One skilled in the art will readily recognize from the following discussion that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles of the invention described herein.

The user device comprises one or more computing devices that can receive input from a user and can transmit and receive data via the network . For example the user device may be a desktop computer a laptop computer a smart phone a personal digital assistant PDAs or any other device including computing functionality and data communication capabilities. The user device is configured to communicate with the third party website and the social networking system via the network which may comprise any combination of local area and or wide area networks using both wired and wireless communication systems.

In one embodiment the user device displays content from the third party website or from the social networking system by processing a markup language document received from the third party website or from the social networking system using a browser application . The markup language document identifies content and one or more instructions describing formatting or presentation of the content. By executing the instructions included in the markup language document the browser application displays the identified content using the format or presentation described by the markup language document . For example the markup language document includes instructions for generating and displaying a web page having multiple frames that include text and or image data retrieved from the third party website and or the social networking system . In various embodiments the markup language document comprises a data file including extensible markup language XML data extensible hypertext markup language XHTML data or other markup language data.

In one embodiment the user device also includes a cookie including data indicating whether a user of the user device is logged into the social networking system . The cookie indicates whether the user of the computing device is involved in an active session where the user device exchanges data with the social networking system allowing modification of the data communicated from the social networking system to the user device . Use of the cookie in exchanging data between the user device the social networking system and or the third party website is further described below in conjunction with .

The third party website comprises one or more web servers including one or more web pages which are communicated to the user device using the network . The third party website is separate from the social networking system . For example the third party website is associated with a first domain while the social networking website is associated with a separate social networking domain. A web page included in the third party website comprises a markup language document identifying content and including instructions specifying formatting or presentation of the identified content as described above. In one embodiment a web page includes a widget comprising instructions that when executed by a browser application of a user device retrieve data from the social networking system and display the information retrieved from the social networking system . For example the widget comprises an instruction associated with the social networking system that generates a frame within the web page that includes information from the social networking system . Hence the widget allows a web page from the third party website to provide personalized content using information from the social networking website when the web page is rendered and displayed by a browser application of a user device .

The social networking system comprises one or more computing devices storing a social network or mapping of a social graph comprising a plurality of users and providing users of the social network with the ability to communicate and interact with other users of the social network. The social networking system is further described below in conjunction with . In use users of the social networking system add connections to a number of other users of the social networking system to whom they desire to be connected. As used herein the term friend or the term a connection refers to any other user of the social networking system to whom a user has formed a connection association or relationship via the social networking system .

Connections may be added explicitly by a user or may be automatically created by the social networking systems based on common characteristics of the users e.g. users who are alumni of the same educational institution . For example a first user specifically selects a particular other user to be a friend. Connections in the social networking system are usually in both directions but need not be so the terms user friend and connection depend on the frame of reference. Connections between users of the social networking system are usually bilateral or mutual but connections may also be unilateral or one way. For example if Bob and Joe are both users of the social networking system and connected to each other Bob and Joe are each other s connections. If on the other hand Bob wishes to connect to Joe to view data communicated to the social networking system by Joe but Joe does not wish to form a mutual connection a unilateral connection may be established. The connection between users may be a direct connection however some embodiments of a social networking system allow the connection to be indirect via one or more levels of connections or degrees or separation.

In addition to establishing and maintaining connections between users and allowing interactions between users the social networking system provides users with the ability to take actions on various types of items supported by the social networking system . These items may include groups or networks where networks here refer not to physical communication networks but rather social networks of people entities and concepts to which users of the social networking system may belong events or calendar entries in which a user might be interested computer based applications that a user may use via the social networking system transactions that allow users to buy or sell items via the service and interactions with advertisements that a user may perform on or off the social networking system. These are just a few examples of the items upon which a user may act on a social networking system and many others are possible. A user may interact with anything that is capable of being represented in the social networking system or in a third party website separate from the social networking system coupled to the social networking system via a network .

The social networking system is also capable of connecting a variety of entities. For example the social networking system enables users to interact with each other as well as third party websites or other entities through an API or other communication channels.

The social networking system also includes user generated content which enhances a user s interactions with the social networking system . User generated content may include anything a user can add upload send or post to the social networking system . For example a user communicates posts to the social networking system from a user device . Posts may include data such as status updates or other textual data location information photos videos links music or other similar data content and or media. Content may also be added to the social networking system by a third party through a communication channel such as a newsfeed or stream. Content items represent single pieces of content that are represented as objects in the social networking system . In this way users of the social networking system are encouraged to communicate with each other by posting text and content items of various types of media through various communication channels increasing the interaction of users with each other and increasing the frequency with which users interact within the social networking system .

As described above in conjunction with the social networking system comprises a computing system that allows users to communicate or otherwise interact with each other and access content as described herein. The social networking system stores user profiles describing the users of a social network. The user profiles include biographic demographic and other types of descriptive information such as work experience educational history hobbies or preferences interests location and the like. The social networking system further stores data describing one or more connections between different users in the connection store . The connection information may indicate users who have similar or common work experience group memberships hobbies educational history or are in any way related or share common attributes. Additionally the social networking system includes user defined connections between different users allowing users to specify their relationships with other users. For example user defined connections allow users to generate relationships with other users that parallel the users real life relationships such as friends co workers partners and so forth. Users may select from predefined types of connections or define their own connection types as needed.

The web server links the social networking system to one or more user device and or one or more third party websites via the network . The web server serves web pages as well as other web related content such as Java Flash XML and so forth. The web server may include a mail server or other messaging functionality for receiving and routing messages between the social networking system and one or more user devices . The messages can be instant messages queued messages e.g. email text and SMS messages or any other suitable messaging format.

The Application Programming Interface API request server allows one or more third party websites to access information from the social networking system by calling one or more APIs. The API request server may also allow third party websites to send information to social networking website by calling APIs. For example a third party website sends an API request to the social networking system via the network and the API request server receives the API request. The API request server processes the request by calling an API associated with the API request to generate an appropriate response which the API request server communicates to the third party website via the network . For example responsive to an API request the API request server collects data associated with a user and communicates the collected data to the third party website .

The action logger is capable of receiving communications from the web server about user actions on and or off the social networking system . The action logger populates the action log with information about user actions allowing the social networking system to track various actions taken by its users within the social networking system and outside of the social networking system . Any action that a particular user takes with respect to another user is associated with each user s profile through information maintained in the action log or in a similar database or other data repository. Examples of actions taken by a user within the social network that are identified and stored may include for example adding a connection to another user sending a message to another user reading a message from another user viewing content associated with another user attending an event posted by another user or other actions interacting with another user. When a user takes an action within the social networking system the action is recorded in an action log . In one embodiment the social networking system maintains the action log as a database of entries. When an action is taken within the social networking system an entry for the action is added to the action log .

Additionally user actions may be associated with an entity outside of the core social networking system such as a third party website that is separate from the social networking system website . For example the action logger receives data describing a user s interaction with a third party website from the web server . Examples of actions where a user interacts with a third party website includes a user expressing an interest in a third party website or another entity a user posting a comment to the social networking system that discusses a third party website or a web page within the third party website a user posting to the social networking system a Uniform Resource Locator URL or other identifier associated with a third party website a user attending an event associated with a third party website or any other action by a user that is related to a third party website . Thus the action log may include actions describing interactions between a social networking system user and a third party website that is separate from the social networking system .

The authorization server enforces one or more privacy settings of the users of the social networking system . A privacy setting of a user determines how particular information associated with a user can be shared. The privacy setting comprises the specification of particular information associated with a user and the specification of the entity or entities with whom the information can be shared. Examples of entities with which information can be shared may include other users applications third party websites or any entity that can potentially access the information. The information that can be shared by a user comprises user profile information like profile photo phone numbers associated with the user user s connections actions taken by the user such as adding a connection changing user profile information and the like.

The privacy setting specification may be provided at different levels of granularity. For example the privacy setting may identify specific information to be shared with other users. For example the privacy setting identifies a work phone number or a specific set of related information such as personal information including profile photo home phone number and status. Alternatively the privacy setting may apply to all the information associated with the user. The specification of the set of entities that can access particular information can also be specified at various levels of granularity. Various sets of entities with which information can be shared may include for example all friends of the user all friends of friends all applications all third party websites specific third party websites or all external systems. One embodiment allows the specification of the set of entries comprise an enumeration of entities for example the user may select a list of third party websites that are allowed to access certain information. Another embodiment allows the specification to comprise a set of entities along with exceptions that are not allowed to access the information. For example a user may allow all third party websites to access the user s work information but specify a list of third party websites that are not allowed to access the work information. Certain embodiments call the list of exceptions that are not allowed to access certain information a block list. External systems such as third party websites belonging to a block list specified by a user are blocked from accessing the information specified in the privacy setting. Note that the various combinations of granularity of specification of information and the granularity of specification of entities with which information is shared are possible i.e. all personal information may be shared with friends whereas all work information may be shared with friends of friends.

For example a user s privacy setting indicates that a first friend is allowed to access the user s work phone number and the user s mobile phone number while preventing the first friend from accessing other information about the user such as the user s profile photo or the user s list of friends. However the user s privacy setting indicates that a second friend is allowed to access the user s friend list. The information associated with a user includes actions taken by a user such as the action of adding a new friend . The user can completely block another user or an application from accessing any information associated with the user . A user or an application that is blocked by the user does not have access to any information associated with user .

The authorization server contains logic to determine if certain information associated with a user can be accessed by a user s friends third party websites and or other applications and entities. For example a third party website that attempts to access a user s comment about a URL associated with the third party website must get authorization from the authorization server to access the user s work phone number. Based on the user s privacy settings the authorization server determines if another user a third party website an application or another entity is allowed to access information associated with the user including information about actions taken by the user. For example the authorization server uses a users privacy setting to determine if the user s comment about a URL associated with the third party website can be accessed by the third party website . This enables a user s privacy setting to specify which other users or other entities are allowed to receive data about the user s actions or other data associated with the user.

Additionally the social networking system maintains data about objects with which a user may interact with using the social networking system . To maintain this data the user profile store and the connection store store instances of the corresponding type of objects maintained by the social networking system . Each object type has information fields that are suitable for storing information appropriate to the type of object. For example the user profile store contains data structures with fields suitable for describing a user s profile. When a new object of a particular type is created the social networking system initializes a new data structure of the corresponding type assigns a unique object identifier to it and begins to add data to the object as needed. This might occur for example when a user becomes a user of the social networking system the social networking system generates a new instance of a user profile in the user profile store assigns a unique identifier to the user profile and begins to populate the fields of the user profile with information provided by the user.

The connection store includes data structures suitable for describing a user s connections to other users connections to third party websites or connections to other entities. The connection stores may also associate a connection type with a user s connections which may be used in conjunction with the user s privacy setting further described above to regulate access to information about the user.

After receiving the request for the web page the third party website generates the requested web page using locally stored data. For example the third party website generates a markup language document describing the content and formatting of the web page based on stored data. The third party website includes a widget comprising instructions that when executed by a browser application of a user device retrieve data from the social networking system and display the information retrieved from the social networking system . For example the widget comprises one or more instructions that when executed by the browser retrieve information from the social networking system and generate a frame within the web page including the retrieved information. In one embodiment the widget comprises code that generates an iframe within the web page . The widget includes a uniform resource locator URL or other web page identifier associated with the social networking system and may also include one or more parameters describing presentation of the frame or iframe by the browser of the user device .

For example the widget may comprise an instruction such as which generates an iframe including data from the URL www.socialnetwork.com widgets recommendations.php and identifier parameters such as height width and border style of the iframe. The widget may also include one or more filter criteria used by the social networking system to generate content for display in the iframe. In the example widget above the filter criteria is the site externalwebsite.com parameter. Use of the filter criteria by the social networking system is further described below.

Then third party website then sends the markup language document describing the generated web page and including the widget to the user device through the network . After receiving the markup language document the browser renders the web page based on the content and formatting instructions included in the markup language document . In addition to rendering the web page the browser in the user device executes the widget to create a frame in the web page . Execution of the widget also causes the browser to request information from the social networking system for inclusion in the frame via the network . In one embodiment the browser identifies one or more parameters from the widget and transmits the identified parameters to the social networking system when requesting information for inclusion in the frame. For example one or more filter criteria are identified from the widget and transmitted to the social networking system when information is requested allowing customization of the requested information.

Responsive to receiving the request for information from the browser the social networking system checks the user device for a cookie . In response to the social networking system checking for the cookie the user device sends the cookie or a message associated with the cookie to the social networking system . In one embodiment the existence of cookie indicates whether the user of the computing device is a user of the social networking system e.g. whether the user has a valid account with the social networking system . If the user of the computing device is a user of the social networking system the cookie may contain information indicating whether the user is logged into the social networking system e.g. whether the user has a current valid session with the social networking system . Checking the user device for a cookie thus allows the social networking system to authenticate the user session. In other embodiments the social networking system may just determine whether the user is a user of the social networking system e.g. by checking for an existence of a cookie without determining whether the user is logged into the social networking system . Although cookies are described herein for authenticating the user and or the user session any other methods of user or session identification or authentication may be used such as recognizing a physical token .

If the user associated with the received cookie has been authenticated the social networking system generates information for personalization for the user associated with the received cookie . For example the social networking system generates a recent activity window including a selection of actions associated with a third party website identified by a parameter from the widget . Examples of actions associated with a third party website may be a friend of the user expressing an interest in a web page associated with the third party website or a friend of the user posting a comment including a uniform resource locator URL associated with the third party website . Generation of a recent activity window by the social networking system is further described below in conjunction with .

As another example the social networking system generates a recommendations window that identifies a set of third party websites or web pages associated with third party websites based on social information about the user. Generation of the recommendations window is further described below in conjunction with . The recommended web pages may be associated with a domain specified by a parameter of the widget . In one embodiment the domain specified by the parameter of the widget is the domain associated with the third party website from which the web page was requested . However in an alternative embodiment the domain specified by the parameter of the widget differs from the domain associated with the third party website from which the web page is requested. In another embodiment the parameter of the widget may identify multiple domains allowing the widget to retrieve and present information from the multiple domains identified by the parameter of the widget for example a news web site may use the widget to present information from itself along with information from other affiliated web sites such as a weather web site and a spots news web site.

For example the widget may comprise an instruction such as and the parameter site externalwebsite.com is transmitted by the browser of the user device when requesting information for inclusion in the frame. When generating personalized content for a user associated with a cookie the social networking system uses the domain externalwebsite.com to limit the generated information to actions or other information associated with the domain externalwebsite.com. For example the social networking system generates a list of all actions by friends or connections of the user associated with the cookie associated with externalwebsite.com and generates information for inclusion in the frame from the list of actions associated with externalwebsite.com performed by friends or connections of the user associated with the cookie .

However if the social networking system is unable to authenticate the user associated with the received cookie the social networking system communicates a prompt for the user to enter authentication information into the user device and generates information for inclusion in the frame based on actions taken by all users of the social networking system . Thus until the social networking system receives authentication information associated with the user associated with the received cookie the information generated by the social networking system may be global information based on actions performed by all users of the social networking system rather than on actions performed by friends or connections of the user associated with the received cookie . After receiving and verifying authentication information associated with the user associated with the cookie the social networking system generates information for inclusion in the frame that is personalized for the user associated with the cookie as described above.

Similarly if the user device does not send a cookie to the social networking system it generates information for inclusion in the frame based on actions taken by all users of the social networking system i.e. global information rather than personalized content . In one embodiment the social networking system also includes in the frame a prompt for joining or otherwise using the social networking system . Alternatively the social networking system generates information for inclusion in the frame based on actions taken by all users of the social networking system in response to receiving a message from the user device indicating that no cookie is stored. For example the social networking system generates information from actions associated with a domain identified by the widget performed by all users of the social networking system .

The social networking system then sends the frame content to the user device through the network . The browser application included on the user device then renders using the frame using the information received from the social networking system and in some embodiments information generated by the website and displays the web page and the frame with the information from the social networking system displayed in the frame. By including the widget in the markup language document describing a web page the third party website allows information from the social networking system to personalize content for a user to be displayed along with the web page . Because the widget requests information from the social networking system for inclusion in the frame the third party website does not maintain or even access a user s social information as the social networking system personalizes and filters content after determining the user s personal information from the cookie stored on the user device .

Once the social networking system receives the request for information from the user device the social networking system identifies one or more parameters included in the request and retrieves content items associated with the one or more parameters. For example one parameter is a uniform resource locator URL or other web identifier that specifies a web page or a domain. In one embodiment the URL or web identifier specifies a domain associated with the third party website providing the web page including the widget requesting information. Alternatively the URL or web identifier specifies a domain different than the domain associated with the third party website providing the web page including the widget requesting information. In another embodiment a plurality of URLs or domains are included as parameters in the request in which case information is retrieved from multiple web pages websites and or domains. For example specifying a plurality of domains or URLs allows retrieval of information from websites associated with multiple domains or retrieval of information from multiple web pages within a domain. Hence the social networking system may retrieve content items associated with one or more URLs or web identifier associated with the received request for information. For example the social networking system retrieves content items where users express an interest in the URL or web identifier from the request for information content items where users post a comment to the social networking system discussing the URL or web identifier from the request for information content items where users post the URL or web identifier from the request for information content items where users attend an event associated with the URL or web identifier from the request for information or any other action by users logged by the social networking system that is related to the URL or web identifier from the request for information.

In response to receiving a cookie or other form of user identification and authentication from the user device the social networking system filters the retrieved content items. In one embodiment responsive to the cookie identifying a user of the social networking system or otherwise authenticating the user and or user session the retrieved data is filtered so that content items associated with the URL or web identifier from the request for information and also associated with friends of the user identified by the cookie remain. This filtering allows the social networking system to remove content items associated with users that are not connected to the user identified by the cookie . When filtering to identify content items associated with users connected to the user identified by the cookie the social networking system accounts for a privacy setting associated with each user which determines whether or not the user identified by the cookie is able to view or access a content item.

In one embodiment the remaining content items i.e. the content items associated with both the URL or web identifier from the request for information and with users connected to an identified user are again filtered according to one or more additional parameters. For example the filtered content items may be again filtered based on the interests of the user identified by the cookie demographic information of the user identified by the cookie the affinity of the user identified by the cookie for other objects in the social networking system location information of the user identified by the cookie keywords or tags dictated by the third party website or the user a decay factor or any other suitable parameter. In one embodiment the social networking system receives the additional parameters with the request for information allowing the third party website to specify the criteria by which content items are filtered by the social networking system . For example the request for information includes a parameter specified by the third party website indicating whether or not to apply a decay factor to the content items allowing different third party websites to remove or maintain content items based on the age of the content items. Alternatively the additional parameters may be locally maintained or determined by the social networking system and or by the user. For example the social networking system additionally filters content items by applying an affinity function associated with the user identified by the cookie to the content items allowing the social networking system to provide content items most likely to be relevant to the user identified by the cookie .

A subset of the filtered content items is selected and used to prepare an activity display including the subset of selected content items. For example content items occurring most recently or occurring within a specified time interval are selected and used to prepare an activity display including the most recent content items or the content items occurring within a specified time interval. However in different embodiments various criteria may be used by the social networking system to select a subset of the filtered content items used to prepare an activity display. In one embodiment content items in the activity display may be aggregated so if a content item is associated with multiple users connected to the identified user the content items are aggregated and displayed as a single content item. Additionally if a limited number of content items are associated with the URL or website identifier and also associated with users connected with the user identified by the cookie the activity display may also include content items associated with any user of the social networking system and associated with the URL or website identifier. For example if less than a threshold number of content items are associated with the URL or website identifier and also associated with users connected with the user identified by the cookie additional content items associated with the URL or website identifier are selected from any content items associated with the URL or website identifier.

However if the received cookie or other authentication information identifies a user of the social networking system that is not logged into or otherwise has a valid session with the social networking system or if no cookie or other authentication information is received by the social networking system the retrieved content items associated with the URL or web identifier associated with the received request for content are not additionally filtered. Hence if an identified user is not logged into or otherwise has a valid session with the social networking system or if no user is identified content items are selected from all content items in the social networking system associated with the URL or web identifier associated with the received request for content. When preparing the activity display from the content items the social networking system includes a prompt for authentication information in the activity display. For example the activity display includes a request for a login and password in addition to content items selected from all content items associated with the URL or web identifier associated with the received request for content. This allows the web page to present information from the social networking system even though the information is based on content items provided by users of the social networking system that are not necessarily connected to an identified user.

In one embodiment the social networking system aggregates the content items in the activity display. The aggregation may be based on a common element of the content items such as by URL. For example the frame may include an aggregation of a plurality of content items that are each associated with the same URL such as 5 of your friends comments on this URL. The aggregation may also be for a given time period which may exclude older content items such as 6 people liked this in the last minute. In this way the social networking system determines content items for the personalized content in the frame while preventing redundant stories. This may also beneficially show trends in a particular user s social information.

Once the social networking system receives the request for information from the user device the social networking system obtains a set of uniform resource locators URLs or other web page identifiers associated with a uniform resource locator URL or other web identifier that specifies a web page or a domain included in the request for information. For example the social networking system obtains all URLs included in a domain identified by the URL included in the request for information. Based on activity associated with the obtained URLs the social networking system selects a subset of the most active obtained URLs. In one embodiment the social networking system counts the number of content items associated with each of the obtained URLs and identifies a predetermined number of URLs having the largest number of associated content items as the most active URLs. For example the social networking system selects a predetermined number of obtained URLs based on the number of content items where users express an interest in an obtained URL the number of content items where users post a comment in the social networking system discussing an obtained URL the number of content items where users post an obtained URL the number of content items where users attend an event associated with an obtained URL and or the number of any other actions by users that are related to the obtained URL.

The social networking system ranks the predetermined number of obtained URLs according to social information associated with a user. The social networking system identifies the user using a cookie received from the user device . In one embodiment responsive to the cookie identifying a user of the social networking system and that the user is logged into or otherwise has a valid session with the social networking system the social networking system ranks the predetermined number of obtained URLs according to social information of the identified user. For example the number of interactions with an obtained URL by friends of the identified user application of an affinity function associated with the identified user to an obtained URL a time decay and a popularity of an obtained URL among all users of the social networking system is used to rank the predetermined number of obtained URLs.

In one embodiment after ranking the predetermined number of obtained URLs the social networking system filters the ranked URLs using one or more additional parameters. For example the ranked URLs items may be filtered based on the interests of the identified user an affinity of the identified user location information of the identified user keyword or tag or any other suitable parameter. In one embodiment the social networking system receives the additional parameters with the request for information allowing the third party website to specify the criteria by which URLs are filtered. Alternatively the additional parameters may be locally maintained or determined by the social networking system .

The social networking system then selects the highest ranked URLs and prepares a recommendations display including the selected URLs. If the ranked URLs are filtered by one or more additional parameters the highest ranked URLs remaining after the filtering are selected and used to prepare the recommendations display.

However if the social networking system does not identify a user that is logged into or otherwise has a valid session with the social networking system the social networking system selects a predetermined number of most active URLs and selects a number of the most active URLs. For example the social networking system selects a predetermined number of obtained URLs based on the number of content items where users express an interest in an obtained URL the number of content items where users post a comment to the social networking system discussing an obtained URL the number of content items where users post an obtained URL the number of content items where users attend an event associated with an obtained URL and or the number of any other actions by users that are related to the obtained URL. When the social networking system is unable to identify a user or is unable to identify a user that is logged into or otherwise has a valid session with the social networking system URLs are selected from the most active URLs and used to prepare the recommendations display. Hence the URLs included in the recommendations display are based on activity associated with URLs performed by all users of the social networking systems rather than based on social information associated with an identified user.

In one example the social networking system identifies the domain externalwebsite.com from a request for content from the user device . The social networking system then obtains a set of uniform resource locators URLs or other web page identifiers associated with externalwebsite.com. For example the social networking system obtains URLs of web pages included in externalwebsite.com. The social networking system then selects a subset of the URLs included in externalwebsite.com based on activities by users of the social networking system associated with the URLs included in externalwebiste.com. For example for each URL included in externalwebsite.com the social networking system determines a total of number of users indicating an interest in a URL the number of users sharing the URL and the number of comments associated with the URL made by users and selects a subset of URLs having the largest total.

After selecting the subset of URLs if the social networking system determines that the user device includes a cookie or other authenticating data identifying a user of the social networking system the selected URLs may be ranked according to social information of the identified user. For example the subset of URLs are ranked according to the number of interactions with a URL by friends of the identified user. If no cookie or other authenticating information is stored by the user device the social networking system does not rank the subset of the URLs.

The subset of URLs are then filtered by one or more additional parameters. In one embodiment the criteria used for filtering the URLs are influenced by the URL included in the request for content. For example if externalwebsite.com is a news website the subset of URLs are filtered using a time decay to remove URLs outside of a specified time interval or to identify more recent URLs. As another example if externalwebsite.com supplies local reviews an affinity function associated with an identified user filters the URLs to identify URLs likely to be aligned with the identified user s interests and the URLs may be further filtered by location information to remove URLs associated with locations that are not near the user s location. After filtering the highest ranked URLs are selected and included in a recommendations display. If the social networking system is unable to identify a cookie or other authenticating data stored by the user device the recommendations display also includes a login portion as illustrated below in conjunction with .

The foregoing description of the embodiments of the invention has been presented for the purpose of illustration it is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Persons skilled in the relevant art can appreciate that many modifications and variations are possible in light of the above disclosure.

Some portions of this description describe the embodiments of the invention in terms of algorithms and symbolic representations of operations on information. These algorithmic descriptions and representations are commonly used by those skilled in the data processing arts to convey the substance of their work effectively to others skilled in the art. These operations while described functionally computationally or logically are understood to be implemented by computer programs or equivalent electrical circuits microcode or the like. Furthermore it has also proven convenient at times to refer to these arrangements of operations as modules without loss of generality. The described operations and their associated modules may be embodied in software firmware hardware or any combinations thereof.

Any of the steps operations or processes described herein may be performed or implemented with one or more hardware or software modules alone or in combination with other devices. In one embodiment a software module is implemented with a computer program product comprising a computer readable medium containing computer program code which can be executed by a computer processor for performing any or all of the steps operations or processes described.

Embodiments of the invention may also relate to an apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes and or it may comprise a general purpose computing device selectively activated or reconfigured by a computer program stored in the computer. Such a computer program may be stored in a non transitory tangible computer readable storage medium or any type of media suitable for storing electronic instructions which may be coupled to a computer system bus. Furthermore any computing systems referred to in the specification may include a single processor or may be architectures employing multiple processor designs for increased computing capability.

Embodiments of the invention may also relate to a product that is produced by a computing process described herein. Such a product may comprise information resulting from a computing process where the information is stored on a non transitory tangible computer readable storage medium and may include any embodiment of a computer program product or other data combination described herein. For example in one embodiment the computer readable storage medium contains a markup language document for being rendered by a web browser application executing on a computer system. In this embodiment the markup language document comprises information items encoded in a markup language comprising instructions for rendering information from a third party website in a web browser application as well as instructions to a web browser application to retrieve information associated with a user of a social networking system as described herein.

Finally the language used in the specification has been principally selected for readability and instructional purposes and it may not have been selected to delineate or circumscribe the inventive subject matter. It is therefore intended that the scope of the invention be limited not by this detailed description but rather by any claims that issue on an application based hereon. Accordingly the disclosure of the embodiments of the invention is intended to be illustrative but not limiting of the scope of the invention which is set forth in the following claims.

